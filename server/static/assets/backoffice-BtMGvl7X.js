import{d as G,c as R,a as Q,F as te,b as e,w as t,V as Vl,e as y,f as kl,g as h,h as V,i as _l,t as M,r as Cl,j as E,o as b,k as D,l as N,m as B,n as xl,p as lt,q as F,s as re,u as Pl,v as Se,x as we,y as w,z as Le,A as Re,B as We,C as he,D as xt,E as Ce,I as Be,G as Gt,M as Kt,H as Xt,J as at,K as wl,L as Je,N as Ue,O as rt,P as et,Q as Fe,R as $e,S as He,T as Dl,U as Te,W as Zt,X as se,Y as St,Z as Sl,_ as Il,$ as el,a0 as Al,a1 as U,a2 as tl,a3 as W,a4 as me,a5 as xe,a6 as pe,a7 as Pe,a8 as nt,a9 as ll,aa as Me,ab as De,ac as Ml,ad as dt,ae as Ee,af as $l,ag as Ul,ah as Rl,ai as Fl,aj as mt,ak as Qe,al as Ll,am as It,an as hl,ao as El,ap as Tl,aq as At,ar as Ol,as as Nl,at as Bl,au as jl,av as ql,aw as Hl,ax as Yl,ay as zl,az as Ql,aA as Wl,aB as Mt,aC as $t,aD as gt,aE as al,aF as Jl,aG as Gl,aH as Vt,aI as Kl,aJ as Xl,aK as Oe,aL as Zl,aM as tt,aN as ea,aO as ta,aP as la,aQ as aa,aR as na,aS as ua,aT as Ut,aU as ia,aV as sa,aW as oa,aX as ra,aY as Rt,aZ as Ft,a_ as da,a$ as ma,b0 as ft,b1 as ca,b2 as Lt,b3 as va,b4 as pa,b5 as ht,b6 as fa,b7 as ya,b8 as ba}from"./VSnackbar-C1zeR_hy.js";import{u as ut,c as ga,a as Va}from"./vue-router-Bjp2U_rB.js";import{c as C,V as ka,a as ct,m as nl,b as kt,_ as it,d as _a,i as Et,e as Ca,f as ul,g as xa,h as st,j as Pa,k as wa,l as Da,n as Sa,o as il,p as Ia,q as Aa}from"./InscriptionRow.vue_vue_type_script_setup_true_lang-O8JV-zDU.js";import{V as Y,a as ue,b as ve,c as oe,d as Ye,e as Ie,f as ee,g as ke,h as be,i as Ne,j as vt,k as Tt,l as sl,m as ol,n as rl}from"./VTextarea-eCyX6YWb.js";import{_ as Ge,a as Ma,V as $a,b as Ua,c as Ra,d as Ot,e as Nt}from"./VTabs-Dh3TZuDW.js";import{_ as Ke,V as Fa,a as La}from"./EventSwitch.vue_vue_type_script_setup_true_lang-Cx3_tJTV.js";import{_ as Pt}from"./_plugin-vue_export-helper-DlAUqK2U.js";import{V as je}from"./FileCard.vue_vue_type_script_setup_true_lang-D5fXyTCi.js";import{V as Bt,_ as ha,a as Ea,b as Ta}from"./SexeField.vue_vue_type_script_setup_true_lang-CMx3UlBf.js";import{_ as Oa}from"./FilesRow.vue_vue_type_script_setup_true_lang-DWO9v_fQ.js";import{V as Na}from"./VForm-Cuurd_1F.js";import"./VSheet-DvA0-ZbV.js";import"./VWindowItem-BckJrY0L.js";const yt=G({__name:"NavBar",props:{title:{},hideMenu:{type:Boolean}},setup(l){const s="/static/repere/logo.png",o="v0.6.5",c=l,a=R(()=>C.isFondsSoutien);return(u,m)=>(b(),Q(te,null,[e(ka,{app:"","model-value":!c.hideMenu,"expand-on-hover":"",permanent:"",rail:""},{append:t(()=>[e(Y,{"prepend-icon":"mdi-account-circle-outline",title:a.value?"Fonds de soutien":"Administrateur"},null,8,["title"]),e(Y,{"prepend-icon":"mdi-logout",link:"",to:{path:"/"},color:"primary"},{default:t(()=>[...m[3]||(m[3]=[y(" Se déconnecter ",-1)])]),_:1})]),default:t(()=>[e(Y,{"prepend-icon":"mdi-menu",title:`Registro ${o}`},null,8,["title"]),e(ue),e(Y,{"prepend-icon":"mdi-bed",link:"",to:{path:"/camps"},color:"primary"},{default:t(()=>[...m[0]||(m[0]=[y(" Séjours ",-1)])]),_:1}),e(Y,{"prepend-icon":"mdi-calendar-multiple-check",link:"",to:{path:"/inscriptions"},color:"primary"},{default:t(()=>[...m[1]||(m[1]=[y(" Inscriptions ",-1)])]),_:1}),e(ue),e(Y,{"prepend-icon":"mdi-account-multiple",link:"",to:{path:"/annuaire"},color:"primary"},{default:t(()=>[...m[2]||(m[2]=[y(" Annuaire ",-1)])]),_:1}),e(ue)]),_:1},8,["model-value"]),e(Vl,{rounded:"",elevation:"4",color:"secondary"},{append:t(()=>[Cl(u.$slots,"default"),m[4]||(m[4]=E("div",{class:"mr-2"},null,-1))]),default:t(()=>[e(kl,null,{default:t(()=>[e(h,null,{default:t(()=>[e(V,{"align-self":"center",cols:"auto"},{default:t(()=>[e(_l,{width:"60",src:s})]),_:1}),e(V,{"align-self":"center"},{default:t(()=>[y(M(c.title),1)]),_:1})]),_:1})]),_:1})]),_:3})],64))}}),Ba=G({__name:"index",setup(l){const s=ut(),o=D(!1),c=D(""),a=D([]);async function u(){const m=await C.Loggin({password:c.value});m!==void 0&&(m.IsValid?(C.setToken(m.Token,m.IsFondSoutien),C.showMessage("Bienvenue !"),s.push({path:"/inscriptions"})):a.value=["Clé de connection incorrecte."])}return(m,n)=>(b(),Q(te,null,[e(yt,{title:"Connection au backoffice","hide-menu":""}),e(Pl,{class:"fill-height"},{default:t(()=>[e(N,{class:"mx-auto",width:"400px"},{default:t(()=>[e(B,null,{default:t(()=>[e(ve,{label:"Clé de connection",modelValue:c.value,"onUpdate:modelValue":n[1]||(n[1]=d=>c.value=d),"error-messages":a.value,type:o.value?void 0:"password",name:"password",onKeydown:n[2]||(n[2]=xl(lt(()=>c.value.length==0?null:u(),["prevent"]),["enter"]))},{"append-inner":t(()=>[e(F,{class:"ml-2",size:"small",icon:o.value?"mdi-eye":"mdi-eye-off",flat:"",onClick:n[0]||(n[0]=d=>o.value=!o.value)},null,8,["icon"])]),_:1},8,["modelValue","error-messages","type"])]),_:1}),e(re,null,{default:t(()=>[e(oe),e(F,{disabled:!c.value.length,onClick:u},{default:t(()=>[...n[3]||(n[3]=[y("Se connecter",-1)])]),_:1},8,["disabled"])]),_:1})]),_:1})]),_:1})],64))}}),wt=G({__name:"BoolField",props:Se({label:{},hideDetails:{type:Boolean},readonly:{type:Boolean},density:{},persistentHint:{type:Boolean},hint:{}},{modelValue:{type:Boolean,required:!0},modelModifiers:{}}),emits:["update:modelValue"],setup(l){const s=l,o=we(l,"modelValue");return(c,a)=>(b(),w(Ye,{label:s.label,"model-value":o.value,"onUpdate:modelValue":a[0]||(a[0]=u=>o.value=u||!1),"hide-details":s.hideDetails,readonly:s.readonly,density:s.density,"persistent-hint":s.persistentHint,hint:s.hint},null,8,["label","model-value","hide-details","readonly","density","persistent-hint","hint"]))}}),dl=Re({active:{type:[String,Array],default:void 0},controlHeight:[Number,String],disabled:{type:[Boolean,String,Array],default:null},nextIcon:{type:Be,default:"$next"},prevIcon:{type:Be,default:"$prev"},modeIcon:{type:Be,default:"$subgroup"},text:String,viewMode:{type:String,default:"month"}},"VDatePickerControls"),jt=Le()({name:"VDatePickerControls",props:dl(),emits:{"click:year":()=>!0,"click:month":()=>!0,"click:prev":()=>!0,"click:next":()=>!0,"click:text":()=>!0},setup(l,s){let{emit:o}=s;const{t:c}=We(),a=R(()=>Array.isArray(l.disabled)?l.disabled.includes("text"):!!l.disabled),u=R(()=>Array.isArray(l.disabled)?l.disabled.includes("mode"):!!l.disabled),m=R(()=>Array.isArray(l.disabled)?l.disabled.includes("prev"):!!l.disabled),n=R(()=>Array.isArray(l.disabled)?l.disabled.includes("next"):!!l.disabled);function d(){o("click:prev")}function i(){o("click:next")}function r(){o("click:year")}function v(){o("click:month")}return he(()=>E("div",{class:Ce(["v-date-picker-controls"]),style:{"--v-date-picker-controls-height":xt(l.controlHeight)}},[e(F,{class:"v-date-picker-controls__month-btn","data-testid":"month-btn",disabled:a.value,text:l.text,variant:"text",rounded:!0,onClick:v},null),e(F,{class:"v-date-picker-controls__mode-btn","data-testid":"year-btn",disabled:u.value,density:"comfortable",icon:l.modeIcon,variant:"text","aria-label":c("$vuetify.datePicker.ariaLabel.selectYear"),onClick:r},null),e(oe,null,null),E("div",{class:"v-date-picker-controls__month"},[e(F,{"data-testid":"prev-month",disabled:m.value,density:"comfortable",icon:l.prevIcon,variant:"text","aria-label":c("$vuetify.datePicker.ariaLabel.previousMonth"),onClick:d},null),e(F,{"data-testid":"next-month",disabled:n.value,icon:l.nextIcon,density:"comfortable",variant:"text","aria-label":c("$vuetify.datePicker.ariaLabel.nextMonth"),onClick:i},null)])])),{}}}),ja=Re({appendIcon:Be,color:String,header:String,transition:String,onClick:wl()},"VDatePickerHeader"),qt=Le()({name:"VDatePickerHeader",props:ja(),emits:{click:()=>!0,"click:append":()=>!0},setup(l,s){let{emit:o,slots:c}=s;const{backgroundColorClasses:a,backgroundColorStyles:u}=Gt(()=>l.color);function m(){o("click")}function n(){o("click:append")}return he(()=>{const d=!!(c.default||l.header),i=!!(c.append||l.appendIcon);return E("div",{class:Ce(["v-date-picker-header",{"v-date-picker-header--clickable":!!l.onClick},a.value]),style:at(u.value),onClick:m},[c.prepend&&E("div",{key:"prepend",class:"v-date-picker-header__prepend"},[c.prepend()]),d&&e(Kt,{key:"content",name:l.transition},{default:()=>[E("div",{key:l.header,class:"v-date-picker-header__content"},[c.default?.()??l.header])]}),i&&E("div",{class:"v-date-picker-header__append"},[c.append?e(Xt,{key:"append-defaults",disabled:!l.appendIcon,defaults:{VBtn:{icon:l.appendIcon,variant:"text"}}},{default:()=>[c.append?.()]}):e(F,{key:"append-btn",icon:l.appendIcon,variant:"text",onClick:n},null)])])}),{}}}),qa=Re({allowedDates:[Array,Function],disabled:{type:Boolean,default:null},displayValue:null,modelValue:Array,month:[Number,String],max:null,min:null,showAdjacentMonths:Boolean,year:[Number,String],weekdays:{type:Array,default:()=>[0,1,2,3,4,5,6]},weeksInMonth:{type:String,default:"dynamic"},firstDayOfWeek:{type:[Number,String],default:void 0},firstDayOfYear:{type:[Number,String],default:void 0},weekdayFormat:String},"calendar");function Ha(l){const s=Je(),o=Ue(l,"modelValue",[],k=>rt(k).map(x=>s.date(x))),c=R(()=>l.displayValue?s.date(l.displayValue):o.value.length>0?s.date(o.value[0]):l.min?s.date(l.min):Array.isArray(l.allowedDates)?s.date(l.allowedDates[0]):s.date()),a=Ue(l,"year",void 0,k=>{const x=k!=null?Number(k):s.getYear(c.value);return s.startOfYear(s.setYear(s.date(),x))},k=>s.getYear(k)),u=Ue(l,"month",void 0,k=>{const x=k!=null?Number(k):s.getMonth(c.value),_=s.setYear(s.startOfMonth(s.date()),s.getYear(a.value));return s.setMonth(_,x)},k=>s.getMonth(k)),m=R(()=>{const k=s.toJsDate(s.startOfWeek(s.date(),l.firstDayOfWeek)).getDay();return s.getWeekdays(l.firstDayOfWeek,l.weekdayFormat).filter((x,_)=>l.weekdays.includes((_+k)%7))}),n=R(()=>{const k=s.getWeekArray(u.value,l.firstDayOfWeek),x=k.flat(),_=6*7;if(l.weeksInMonth==="static"&&x.length<_){const P=x[x.length-1];let A=[];for(let z=1;z<=_-x.length;z++)A.push(s.addDays(P,z)),z%7===0&&(k.push(A),A=[])}return k});function d(k,x){return k.filter(_=>l.weekdays.includes(s.toJsDate(_).getDay())).map((_,P)=>{const A=s.toISO(_),z=!s.isSameMonth(_,u.value),Z=s.isSameDay(_,s.startOfMonth(u.value)),S=s.isSameDay(_,s.endOfMonth(u.value)),f=s.isSameDay(_,u.value),K=l.weekdays.length;return{date:_,formatted:s.format(_,"keyboardDate"),isAdjacent:z,isDisabled:p(_),isEnd:S,isHidden:z&&!l.showAdjacentMonths,isSame:f,isSelected:o.value.some(ge=>s.isSameDay(_,ge)),isStart:Z,isToday:s.isSameDay(_,x),isWeekEnd:P%K===K-1,isWeekStart:P%K===0,isoDate:A,localized:s.format(_,"dayOfMonth"),month:s.getMonth(_),year:s.getYear(_)}})}const i=R(()=>{const k=s.startOfWeek(c.value,l.firstDayOfWeek),x=[];for(let P=0;P<=6;P++)x.push(s.addDays(k,P));const _=s.date();return d(x,_)}),r=R(()=>{const k=n.value.flat(),x=s.date();return d(k,x)}),v=R(()=>n.value.map(k=>k.length?s.getWeek(k[0],l.firstDayOfWeek,l.firstDayOfYear):null));function p(k){if(l.disabled)return!0;const x=s.date(k);return l.min&&s.isBefore(s.endOfDay(x),s.date(l.min))||l.max&&s.isAfter(x,s.date(l.max))?!0:Array.isArray(l.allowedDates)&&l.allowedDates.length>0?!l.allowedDates.some(_=>s.isSameDay(s.date(_),x)):typeof l.allowedDates=="function"?!l.allowedDates(x):!1}return{displayValue:c,daysInMonth:r,daysInWeek:i,genDays:d,model:o,weeksInMonth:n,weekdayLabels:m,weekNumbers:v}}const ml=Re({color:String,hideWeekdays:Boolean,multiple:[Boolean,Number,String],showWeek:Boolean,transition:{type:String,default:"picker-transition"},reverseTransition:{type:String,default:"picker-reverse-transition"},...He(qa(),["displayValue"])},"VDatePickerMonth"),Ht=Le()({name:"VDatePickerMonth",props:ml(),emits:{"update:modelValue":l=>!0,"update:month":l=>!0,"update:year":l=>!0},setup(l,s){let{emit:o,slots:c}=s;const a=D(),{t:u}=We(),{daysInMonth:m,model:n,weekNumbers:d,weekdayLabels:i}=Ha(l),r=Je(),v=et(),p=et(),k=et(!1),x=Fe(()=>k.value?l.reverseTransition:l.transition);l.multiple==="range"&&n.value.length>0&&(v.value=n.value[0],n.value.length>1&&(p.value=n.value[n.value.length-1]));const _=R(()=>{const S=["number","string"].includes(typeof l.multiple)?Number(l.multiple):1/0;return n.value.length>=S});$e(m,(S,f)=>{f&&(k.value=r.isBefore(S[0].date,f[0].date))});function P(S){const f=r.startOfDay(S);if(n.value.length===0?v.value=void 0:n.value.length===1&&(v.value=n.value[0],p.value=void 0),!v.value)v.value=f,n.value=[v.value];else if(p.value)v.value=S,p.value=void 0,n.value=[v.value];else{if(r.isSameDay(f,v.value)){v.value=void 0,n.value=[];return}else r.isBefore(f,v.value)?(p.value=r.endOfDay(v.value),v.value=f):p.value=r.endOfDay(f);n.value=Dl(r,v.value,p.value)}}function A(S){const f=r.format(S.date,"fullDateWithWeekday"),K=S.isToday?"currentDate":"selectDate";return u(`$vuetify.datePicker.ariaLabel.${K}`,f)}function z(S){const f=n.value.findIndex(K=>r.isSameDay(K,S));if(f===-1)n.value=[...n.value,S];else{const K=[...n.value];K.splice(f,1),n.value=K}}function Z(S){l.multiple==="range"?P(S):l.multiple?z(S):n.value=[S]}he(()=>E("div",{class:"v-date-picker-month",style:{"--v-date-picker-days-in-week":l.weekdays.length}},[l.showWeek&&E("div",{key:"weeks",class:"v-date-picker-month__weeks"},[!l.hideWeekdays&&E("div",{key:"hide-week-days",class:"v-date-picker-month__day"},[y(" ")]),d.value.map(S=>E("div",{class:Ce(["v-date-picker-month__day","v-date-picker-month__day--adjacent"])},[S]))]),e(Kt,{name:x.value},{default:()=>[E("div",{ref:a,key:m.value[0].date?.toString(),class:"v-date-picker-month__days"},[!l.hideWeekdays&&i.value.map(S=>E("div",{class:Ce(["v-date-picker-month__day","v-date-picker-month__weekday"])},[S])),m.value.map((S,f)=>{const K={props:{class:"v-date-picker-month__day-btn",color:S.isSelected||S.isToday?l.color:void 0,disabled:S.isDisabled,icon:!0,ripple:!1,text:S.localized,variant:S.isSelected?"flat":S.isToday?"outlined":"text","aria-label":A(S),"aria-current":S.isToday?"date":void 0,onClick:()=>Z(S.date)},item:S,i:f};return _.value&&!S.isSelected&&(S.isDisabled=!0),E("div",{class:Ce(["v-date-picker-month__day",{"v-date-picker-month__day--adjacent":S.isAdjacent,"v-date-picker-month__day--hide-adjacent":S.isHidden,"v-date-picker-month__day--selected":S.isSelected,"v-date-picker-month__day--week-end":S.isWeekEnd,"v-date-picker-month__day--week-start":S.isWeekStart}]),"data-v-date":S.isDisabled?void 0:S.isoDate},[(l.showAdjacentMonths||!S.isAdjacent)&&(c.day?.(K)??e(F,K.props,null))])})])]})]))}}),cl=Re({color:String,height:[String,Number],min:null,max:null,modelValue:Number,year:Number,allowedMonths:[Array,Function]},"VDatePickerMonths"),Yt=Le()({name:"VDatePickerMonths",props:cl(),emits:{"update:modelValue":l=>!0},setup(l,s){let{emit:o,slots:c}=s;const a=Je(),u=Ue(l,"modelValue"),m=R(()=>{let d=a.startOfYear(a.date());return l.year&&(d=a.setYear(d,l.year)),Te(12).map(i=>{const r=a.format(d,"monthShort"),v=a.format(d,"month"),p=!!(!n(i)||l.min&&a.isAfter(a.startOfMonth(a.date(l.min)),d)||l.max&&a.isAfter(d,a.startOfMonth(a.date(l.max))));return d=a.getNextMonth(d),{isDisabled:p,text:r,label:v,value:i}})});Zt(()=>{u.value=u.value??a.getMonth(a.date())});function n(d){return Array.isArray(l.allowedMonths)&&l.allowedMonths.length?l.allowedMonths.includes(d):typeof l.allowedMonths=="function"?l.allowedMonths(d):!0}return he(()=>E("div",{class:"v-date-picker-months",style:{height:xt(l.height)}},[E("div",{class:"v-date-picker-months__content"},[m.value.map((d,i)=>{const r={active:u.value===i,ariaLabel:d.label,color:u.value===i?l.color:void 0,disabled:d.isDisabled,rounded:!0,text:d.text,variant:u.value===d.value?"flat":"text",onClick:()=>v(i)};function v(p){if(u.value===p){o("update:modelValue",u.value);return}u.value=p}return c.month?.({month:d,i,props:r})??e(F,se({key:"month"},r),null)})])])),{}}}),vl=Re({color:String,height:[String,Number],min:null,max:null,modelValue:Number,allowedYears:[Array,Function]},"VDatePickerYears"),zt=Le()({name:"VDatePickerYears",props:vl(),directives:{vIntersect:St},emits:{"update:modelValue":l=>!0},setup(l,s){let{emit:o,slots:c}=s;const a=Je(),u=Ue(l,"modelValue"),m=R(()=>{const r=a.getYear(a.date());let v=r-100,p=r+52;l.min&&(v=a.getYear(a.date(l.min))),l.max&&(p=a.getYear(a.date(l.max)));let k=a.startOfYear(a.date());return k=a.setYear(k,v),Te(p-v+1,v).map(x=>{const _=a.format(k,"year");return k=a.setYear(k,a.getYear(k)+1),{text:_,value:x,isDisabled:!i(x)}})});Zt(()=>{u.value=u.value??a.getYear(a.date())});const n=Sl();function d(){n.el?.focus(),n.el?.scrollIntoView({block:"center"})}function i(r){return Array.isArray(l.allowedYears)&&l.allowedYears.length?l.allowedYears.includes(r):typeof l.allowedYears=="function"?l.allowedYears(r):!0}return he(()=>Il(E("div",{class:"v-date-picker-years",style:{height:xt(l.height)}},[E("div",{class:"v-date-picker-years__content"},[m.value.map((r,v)=>{const p={ref:u.value===r.value?n:void 0,active:u.value===r.value,color:u.value===r.value?l.color:void 0,rounded:!0,text:r.text,disabled:r.isDisabled,variant:u.value===r.value?"flat":"text",onClick:()=>{if(u.value===r.value){o("update:modelValue",u.value);return}u.value=r.value}};return c.year?.({year:r,i:v,props:p})??e(F,se({key:"month"},p),null)})])]),[[St,{handler:d},null,{once:!0}]])),{}}}),Ya=Re({header:{type:String,default:"$vuetify.datePicker.header"},headerColor:String,...dl(),...ml({weeksInMonth:"static"}),...He(cl(),["modelValue"]),...He(vl(),["modelValue"]),...nl({title:"$vuetify.datePicker.title"}),modelValue:null},"VDatePicker"),za=Le()({name:"VDatePicker",props:Ya(),emits:{"update:modelValue":l=>!0,"update:month":l=>!0,"update:year":l=>!0,"update:viewMode":l=>!0},setup(l,s){let{emit:o,slots:c}=s;const a=Je(),{t:u}=We(),{rtlClasses:m}=el(),n=Ue(l,"modelValue",void 0,$=>rt($).map(g=>a.date(g)),$=>l.multiple?$:$[0]),d=Ue(l,"viewMode"),i=R(()=>{const $=a.date(l.min);return l.min&&a.isValid($)?$:null}),r=R(()=>{const $=a.date(l.max);return l.max&&a.isValid($)?$:null}),v=R(()=>{const $=a.date();let g=$;return n.value?.[0]?g=a.date(n.value[0]):i.value&&a.isBefore($,i.value)?g=i.value:r.value&&a.isAfter($,r.value)&&(g=r.value),g&&a.isValid(g)?g:$}),p=Fe(()=>l.headerColor??l.color),k=Ue(l,"month"),x=R({get:()=>Number(k.value??a.getMonth(a.startOfMonth(v.value))),set:$=>k.value=$}),_=Ue(l,"year"),P=R({get:()=>Number(_.value??a.getYear(a.startOfYear(a.setMonth(v.value,x.value)))),set:$=>_.value=$}),A=et(!1),z=R(()=>l.multiple&&n.value.length>1?u("$vuetify.datePicker.itemsSelected",n.value.length):n.value[0]&&a.isValid(n.value[0])?a.format(a.date(n.value[0]),"normalDateWithWeekday"):u(l.header)),Z=R(()=>{let $=a.date();return $=a.setDate($,1),$=a.setMonth($,x.value),$=a.setYear($,P.value),a.format($,"monthAndYear")}),S=Fe(()=>`date-picker-header${A.value?"-reverse":""}-transition`),f=R(()=>{if(l.disabled)return!0;const $=[];if(d.value!=="month")$.push("prev","next");else{let g=a.date();if(g=a.startOfMonth(g),g=a.setMonth(g,x.value),g=a.setYear(g,P.value),i.value){const T=a.addDays(a.startOfMonth(g),-1);a.isAfter(i.value,T)&&$.push("prev")}if(r.value){const T=a.addDays(a.endOfMonth(g),1);a.isAfter(T,r.value)&&$.push("next")}}return $}),K=R(()=>l.allowedYears||I),ge=R(()=>l.allowedMonths||le);function J($,g){const T=l.allowedDates;if(typeof T!="function")return!0;const L=a.getDiff(g,$,"days");for(let ye=0;ye<L;ye++)if(T(a.addDays($,ye)))return!0;return!1}function I($){if(typeof l.allowedDates=="function"){const g=a.parseISO(`${$}-01-01`);return J(g,a.endOfYear(g))}if(Array.isArray(l.allowedDates)&&l.allowedDates.length){for(const g of l.allowedDates)if(a.getYear(a.date(g))===$)return!0;return!1}return!0}function le($){if(typeof l.allowedDates=="function"){const g=String($+1).padStart(2,"0"),T=a.parseISO(`${P.value}-${g}-01`);return J(T,a.endOfMonth(T))}if(Array.isArray(l.allowedDates)&&l.allowedDates.length){for(const g of l.allowedDates)if(a.getYear(a.date(g))===P.value&&a.getMonth(a.date(g))===$)return!0;return!1}return!0}function ae(){x.value<11?x.value++:(P.value++,x.value=0,Ve()),fe()}function O(){x.value>0?x.value--:(P.value--,x.value=11,Ve()),fe()}function j(){d.value="month"}function ie(){d.value=d.value==="months"?"month":"months"}function X(){d.value=d.value==="year"?"month":"year"}function fe(){d.value==="months"&&ie()}function Ve(){d.value==="year"&&X()}return $e(n,($,g)=>{const T=rt(g),L=rt($);if(!L.length)return;const ye=a.date(T[T.length-1]),ne=a.date(L[L.length-1]),Ae=a.getMonth(ne),_e=a.getYear(ne);Ae!==x.value&&(x.value=Ae,fe()),_e!==P.value&&(P.value=_e,Ve()),A.value=a.isBefore(ye,ne)}),he(()=>{const $=ct.filterProps(l),g=jt.filterProps(l),T=qt.filterProps(l),L=Ht.filterProps(l),ye=He(Yt.filterProps(l),["modelValue"]),ne=He(zt.filterProps(l),["modelValue"]),Ae={color:p.value,header:z.value,transition:S.value};return e(ct,se($,{color:p.value,class:["v-date-picker",`v-date-picker--${d.value}`,{"v-date-picker--show-week":l.showWeek},m.value,l.class],style:l.style}),{title:()=>c.title?.()??E("div",{class:"v-date-picker__title"},[u(l.title)]),header:()=>c.header?e(Xt,{defaults:{VDatePickerHeader:{...Ae}}},{default:()=>[c.header?.(Ae)]}):e(qt,se({key:"header"},T,Ae,{onClick:d.value!=="month"?j:void 0}),{prepend:c.prepend,append:c.append}),default:()=>E(te,null,[e(jt,se(g,{disabled:f.value,text:Z.value,"onClick:next":ae,"onClick:prev":O,"onClick:month":ie,"onClick:year":X}),null),e(Al,{hideOnLeave:!0},{default:()=>[d.value==="months"?e(Yt,se({key:"date-picker-months"},ye,{modelValue:x.value,"onUpdate:modelValue":[_e=>x.value=_e,fe],min:i.value,max:r.value,year:P.value,allowedMonths:ge.value}),{month:c.month}):d.value==="year"?e(zt,se({key:"date-picker-years"},ne,{modelValue:P.value,"onUpdate:modelValue":[_e=>P.value=_e,Ve],min:i.value,max:r.value,allowedYears:K.value}),{year:c.year}):e(Ht,se({key:"date-picker-month"},L,{modelValue:n.value,"onUpdate:modelValue":_e=>n.value=_e,month:x.value,"onUpdate:month":[_e=>x.value=_e,fe],year:P.value,"onUpdate:year":[_e=>P.value=_e,Ve],min:i.value,max:r.value}),{day:c.day})]})]),actions:c.actions})}),{}}}),Qa=G({__name:"DateField",props:Se({label:{},hideDetails:{type:Boolean},readonly:{type:Boolean}},{modelValue:{required:!0},modelModifiers:{}}),emits:["update:modelValue"],setup(l){const s=l,o=we(l,"modelValue"),c=Je();function a(m){u.value=!1,o.value=tl(m)}const u=D(!1);return(m,n)=>s.readonly?(b(),w(ve,{key:0,class:"center-text",variant:"outlined",density:"compact","hide-details":s.hideDetails,label:s.label,"model-value":U(c).parseISO(o.value).toLocaleDateString(),readonly:""},null,8,["hide-details","label","model-value"])):(b(),w(Ie,{key:1,"close-on-content-click":!1,modelValue:u.value,"onUpdate:modelValue":n[1]||(n[1]=d=>u.value=d)},{activator:t(({props:d})=>[e(ve,se({class:"center-text"},d,{variant:"outlined",density:"compact","hide-details":s.hideDetails,label:s.label,"model-value":U(c).parseISO(o.value).toLocaleDateString()}),null,16,["hide-details","label","model-value"])]),default:t(()=>[e(za,{"model-value":U(c).parseISO(o.value),"onUpdate:modelValue":n[0]||(n[0]=d=>a(d))},null,8,["model-value"])]),_:1},8,["modelValue"]))}}),pl=Pt(Qa,[["__scopeId","data-v-1e184428"]]),Wa=G({__name:"OptionStatut",props:Se({camp:{}},{modelValue:{required:!0},modelModifiers:{}}),emits:["update:modelValue"],setup(l){const s=l,o=we(l,"modelValue");function c(){const m=o.value?.length?o.value.map(i=>i.Id):[0],d={Id:Math.max(...m)+1,Label:"",Description:"",Prix:s.camp.Prix.Cent};o.value=(o.value||[]).concat(d),a.value=d}const a=D(null);function u(m){o.value=(o.value||[]).filter(n=>n.Id!=m.Id)}return(m,n)=>{const d=Ke;return b(),w(N,{subtitle:"Le prix dépend du statut du participant, à choisir parmi la liste ci-dessous."},{append:t(()=>[e(F,{icon:"",size:"x-small",onClick:c},{default:t(()=>[e(pe,{color:"green"},{default:t(()=>[...n[4]||(n[4]=[y("mdi-plus",-1)])]),_:1})]),_:1})]),default:t(()=>[a.value!=null?(b(),w(ee,{key:0,"model-value":a.value!=null,"onUpdate:modelValue":n[3]||(n[3]=i=>a.value=null),"max-width":"500px"},{default:t(()=>[e(N,{title:"Modifier le statut"},{default:t(()=>[e(B,null,{default:t(()=>[e(h,null,{default:t(()=>[e(V,{cols:"12"},{default:t(()=>[e(ve,{autofocus:"",label:"Statut",modelValue:a.value.Label,"onUpdate:modelValue":n[0]||(n[0]=i=>a.value.Label=i),density:"compact",variant:"outlined","hide-details":""},null,8,["modelValue"])]),_:1}),e(V,{cols:"12"},{default:t(()=>[e(ve,{label:"Description",modelValue:a.value.Description,"onUpdate:modelValue":n[1]||(n[1]=i=>a.value.Description=i),density:"compact",variant:"outlined","hide-details":""},null,8,["modelValue"])]),_:1}),e(V,{cols:"12"},{default:t(()=>[e(d,{"model-value":{Cent:a.value.Prix,Currency:s.camp.Prix.Currency},"onUpdate:modelValue":n[2]||(n[2]=i=>a.value.Prix=i.Cent),label:"Prix","readonly-currency":""},null,8,["model-value"])]),_:1})]),_:1})]),_:1})]),_:1})]),_:1},8,["model-value"])):W("",!0),e(B,{class:"py-0"},{default:t(()=>[e(ke,null,{default:t(()=>[o.value?.length?W("",!0):(b(),w(Y,{key:0},{default:t(()=>[...n[5]||(n[5]=[E("i",null,"Aucun statut n'est encore défini.",-1)])]),_:1})),(b(!0),Q(te,null,me(o.value,i=>(b(),w(Y,{title:i.Label,subtitle:i.Description,onClick:r=>a.value=i},{append:t(()=>[e(h,null,{default:t(()=>[e(V,{"align-self":"center"},{default:t(()=>[e(be,null,{default:t(()=>[y(M(U(xe).montant({Cent:i.Prix,Currency:l.camp.Prix.Currency})),1)]),_:2},1024)]),_:2},1024),e(V,{"align-self":"center",cols:"auto"},{default:t(()=>[e(F,{icon:"",size:"x-small",class:"my-1",onClick:lt(r=>u(i),["stop"])},{default:t(()=>[e(pe,{color:"red"},{default:t(()=>[...n[6]||(n[6]=[y("mdi-delete",-1)])]),_:1})]),_:1},8,["onClick"])]),_:2},1024)]),_:2},1024)]),_:2},1032,["title","subtitle","onClick"]))),256))]),_:1})]),_:1})]),_:1})}}}),Ja=G({__name:"OptionJournee",props:Se({camp:{}},{modelValue:{required:!0},modelModifiers:{}}),emits:["update:modelValue"],setup(l){const s=l,o=we(l,"modelValue");$e(()=>o.value,c,{immediate:!0});function c(){const u=s.camp.Duree;o.value?.length!=u&&(o.value=Array.from({length:u}).map(m=>0))}function a(){const u=o.value,m=u[0];for(let n=0;n<u.length;n++)u[n]=m}return(u,m)=>{const n=Ke;return b(),w(N,{subtitle:"Le prix est variable en fonction des jours de participation au camp."},{append:t(()=>[e(je,{text:"Appliquer le prix du premier jour à tous."},{activator:t(({props:d})=>[e(F,se(d,{icon:"mdi-arrow-expand",size:"x-small",disabled:!(o.value||[])[0],onClick:a}),null,16,["disabled"])]),_:1})]),default:t(()=>[e(B,null,{default:t(()=>[e(h,null,{default:t(()=>[(b(!0),Q(te,null,me(o.value,(d,i)=>(b(),w(V,{cols:"3"},{default:t(()=>[e(n,{label:`Jour ${i+1}`,"model-value":{Cent:d,Currency:s.camp.Prix.Currency},"onUpdate:modelValue":r=>o.value[i]=r.Cent,"readonly-currency":""},null,8,["label","model-value","onUpdate:modelValue"])]),_:2},1024))),256))]),_:1})]),_:1})]),_:1})}}}),Ga={key:0,class:"text-center"},Ka=G({__name:"CampOptionsPrix",props:Se({camp:{}},{optionPrix:{required:!0},optionPrixModifiers:{},optionQf:{required:!0},optionQfModifiers:{}}),emits:["update:optionPrix","update:optionQf"],setup(l){const s=l,o=we(l,"optionPrix"),c=we(l,"optionQf"),a=R(()=>Pe.isQuotientFamilialActive(c.value)),u=nt(ll);return(m,n)=>{const d=Ge;return b(),w(N,{title:"Options sur le prix",subtitle:"Permet de modifier le prix de base du séjour",width:"1000px"},{default:t(()=>[e(B,null,{default:t(()=>[e(h,null,{default:t(()=>[e(V,{"align-self":"center"},{default:t(()=>[e(Ye,{"model-value":a.value,"onUpdate:modelValue":n[0]||(n[0]=i=>c.value[3]=i?100:0),"hide-details":"",label:"Prix au quotient familial"},null,8,["model-value"])]),_:1}),e(V,{"align-self":"center"},{default:t(()=>[e(d,{suffix:"%",min:0,max:100,disabled:!a.value,"hide-details":"","readonly-currency":"",label:"entre 1 et 359",modelValue:c.value[0],"onUpdate:modelValue":n[1]||(n[1]=i=>c.value[0]=i)},null,8,["disabled","modelValue"])]),_:1}),e(V,{"align-self":"center"},{default:t(()=>[e(d,{suffix:"%",min:0,max:100,disabled:!a.value,"hide-details":"","readonly-currency":"",label:"entre 360 et 564",modelValue:c.value[1],"onUpdate:modelValue":n[2]||(n[2]=i=>c.value[1]=i)},null,8,["disabled","modelValue"])]),_:1}),e(V,{"align-self":"center"},{default:t(()=>[e(d,{suffix:"%",min:0,max:100,disabled:!a.value,"hide-details":"","readonly-currency":"",label:"entre 565 et 714",modelValue:c.value[2],"onUpdate:modelValue":n[3]||(n[3]=i=>c.value[2]=i)},null,8,["disabled","modelValue"])]),_:1}),e(V,{"align-self":"center"},{default:t(()=>[e(d,{suffix:"%",min:0,max:100,disabled:!0,"hide-details":"","readonly-currency":"",label:"plus de 715",modelValue:c.value[3],"onUpdate:modelValue":n[4]||(n[4]=i=>c.value[3]=i)},null,8,["modelValue"])]),_:1})]),_:1}),e(ue,{thickness:"1",class:"my-2"}),e(h,{class:"my-2"},{default:t(()=>[e(V,{"align-self":"center",cols:"4"},{default:t(()=>[e(Ne,{variant:"outlined",density:"comfortable","hide-details":"",items:U(u),label:"Option sur le prix",modelValue:o.value.Active,"onUpdate:modelValue":n[5]||(n[5]=i=>o.value.Active=i)},null,8,["items","modelValue"])]),_:1}),e(V,{"align-self":"center"},{default:t(()=>[o.value.Active==U(Me).NoOption?(b(),Q("div",Ga,[...n[8]||(n[8]=[E("i",null,"Aucune modification sur le prix de base.",-1)])])):o.value.Active==U(Me).PrixStatut?(b(),w(Wa,{key:1,camp:s.camp,modelValue:o.value.Statuts,"onUpdate:modelValue":n[6]||(n[6]=i=>o.value.Statuts=i)},null,8,["camp","modelValue"])):o.value.Active==U(Me).PrixJour?(b(),w(Ja,{key:2,camp:s.camp,modelValue:o.value.Jours,"onUpdate:modelValue":n[7]||(n[7]=i=>o.value.Jours=i)},null,8,["camp","modelValue"])):W("",!0)]),_:1})]),_:1})]),_:1})]),_:1})}}}),Xa=G({__name:"CampMetaEdit",props:Se({metaEntriesHints:{}},{modelValue:{required:!0},modelModifiers:{}}),emits:["update:modelValue"],setup(l){const s=l,o=we(l,"modelValue"),c=D(Object.entries(o.value||{}));function a(){const u=Object.fromEntries(c.value);o.value=u}return R(()=>{const u=c.value.map(n=>n[0]);return u.includes("")?!0:new Set(u).size!=c.value.length}),(u,m)=>(b(),w(N,{subtitle:"Métadonnées exposées sur l'API publique"},{append:t(()=>[e(F,{size:"small",class:"ml-2",onClick:m[0]||(m[0]=n=>{c.value.push(["",""]),a()})},{prepend:t(()=>[e(pe,{color:"green"},{default:t(()=>[...m[1]||(m[1]=[y("mdi-plus",-1)])]),_:1})]),default:t(()=>[m[2]||(m[2]=y(" Ajouter une valeur",-1))]),_:1})]),default:t(()=>[e(B,{class:"pt-2"},{default:t(()=>[(b(!0),Q(te,null,me(c.value,(n,d)=>(b(),w(h,null,{default:t(()=>[e(V,{cols:"4"},{default:t(()=>[e(Bt,{variant:"outlined",density:"compact","hide-details":"",label:"Clé",modelValue:n[0],"onUpdate:modelValue":[i=>n[0]=i,a],autofocus:"",items:s.metaEntriesHints.keys},null,8,["modelValue","onUpdate:modelValue","items"])]),_:2},1024),e(V,null,{default:t(()=>[e(Bt,{variant:"outlined",density:"compact","hide-details":"",label:"Valeur",modelValue:n[1],"onUpdate:modelValue":[i=>n[1]=i,a],items:s.metaEntriesHints.values},null,8,["modelValue","onUpdate:modelValue","items"])]),_:2},1024),e(V,{cols:"auto"},{default:t(()=>[e(F,{icon:"",size:"small",flat:"",onClick:i=>{c.value.splice(d,1),a()}},{default:t(()=>[e(pe,{color:"red"},{default:t(()=>[...m[3]||(m[3]=[y("mdi-close",-1)])]),_:1})]),_:1},8,["onClick"])]),_:2},1024)]),_:2},1024))),256))]),_:1})]),_:1}))}}),Za=G({__name:"CampEdit",props:{camp:{},preselectionUrl:{},metaEntriesHints:{}},emits:["save"],setup(l,{emit:s}){const o=l,c=s,a=D(De(o.camp)),u=R(()=>new Date(a.value.DateDebut).getFullYear()>=2020&&a.value.Places>=1&&a.value.Nom!=""&&a.value.AgeMax>=a.value.AgeMin&&a.value.OptionQuotientFamilial.every(i=>0<=i&&i<=100)&&!(a.value.OptionPrix.Active==Me.PrixStatut&&!a.value.OptionPrix.Statuts?.length)&&!(a.value.OptionPrix.Active==Me.PrixJour&&a.value.OptionPrix.Jours?.length!=a.value.Duree)),m=nt(Ml);function n(i){const r=Pe.isQuotientFamilialActive(i.OptionQuotientFamilial),v=i.OptionPrix.Active!=Me.NoOption;if(!r&&!v)return"Aucune";const p=[];return Pe.isQuotientFamilialActive(i.OptionQuotientFamilial)&&p.push("Quotient familial"),i.OptionPrix.Active!=Me.NoOption&&p.push(ll[i.OptionPrix.Active]),p.join(", ")}async function d(){await dt(o.preselectionUrl),C.showMessage("URL copiée dans le presse-papier.")}return(i,r)=>{const v=pl,p=Ge,k=Ke,x=wt;return b(),w(N,{title:"Paramètres du séjour",subtitle:U(Pe).label(o.camp)},{default:t(()=>[e(B,null,{default:t(()=>[e(N,{class:"my-2",subtitle:"Général"},{default:t(()=>[e(B,null,{default:t(()=>[e(h,null,{default:t(()=>[e(V,null,{default:t(()=>[e(ve,{autofocus:"","hide-details":"",label:"Nom",density:"compact",variant:"outlined",modelValue:a.value.Nom,"onUpdate:modelValue":r[0]||(r[0]=_=>a.value.Nom=_)},null,8,["modelValue"])]),_:1}),e(V,null,{default:t(()=>[e(ve,{"hide-details":"",label:"Lieu",density:"compact",variant:"outlined",modelValue:a.value.Lieu,"onUpdate:modelValue":r[1]||(r[1]=_=>a.value.Lieu=_)},null,8,["modelValue"])]),_:1}),e(V,null,{default:t(()=>[e(ve,{"hide-details":"",label:"Numéro d'agrément",density:"compact",variant:"outlined",modelValue:a.value.Agrement,"onUpdate:modelValue":r[2]||(r[2]=_=>a.value.Agrement=_)},null,8,["modelValue"])]),_:1})]),_:1}),e(h,null,{default:t(()=>[e(V,{"align-self":"center"},{default:t(()=>[e(v,{modelValue:a.value.DateDebut,"onUpdate:modelValue":r[3]||(r[3]=_=>a.value.DateDebut=_),label:"Date de début","hide-details":""},null,8,["modelValue"])]),_:1}),e(V,{"align-self":"center"},{default:t(()=>[e(p,{label:"Durée (en jours)",modelValue:a.value.Duree,"onUpdate:modelValue":r[4]||(r[4]=_=>a.value.Duree=_),"hide-details":""},null,8,["modelValue"])]),_:1}),e(V,{"align-self":"center"},{default:t(()=>[e(v,{"model-value":U(Pe).dateFin(a.value),label:"Date de fin",readonly:"","hide-details":""},null,8,["model-value"])]),_:1})]),_:1})]),_:1})]),_:1}),e(N,{class:"my-2",subtitle:"Prix"},{default:t(()=>[e(B,null,{default:t(()=>[e(h,null,{default:t(()=>[e(V,{"align-self":"center",cols:"6"},{default:t(()=>[e(k,{label:"Prix",modelValue:a.value.Prix,"onUpdate:modelValue":r[5]||(r[5]=_=>a.value.Prix=_),"hide-details":""},null,8,["modelValue"])]),_:1}),e(V,{"align-self":"center",cols:"6",class:"text-center"},{default:t(()=>[e(Ie,{"close-on-content-click":!1},{activator:t(({props:_})=>[e(ve,se(_,{readonly:"",label:"Option sur le prix",variant:"outlined",density:"compact","hide-details":"","model-value":n(a.value)}),null,16,["model-value"])]),default:t(()=>[e(Ka,{camp:a.value,"option-prix":a.value.OptionPrix,"onUpdate:optionPrix":r[6]||(r[6]=_=>a.value.OptionPrix=_),"option-qf":a.value.OptionQuotientFamilial,"onUpdate:optionQf":r[7]||(r[7]=_=>a.value.OptionQuotientFamilial=_)},null,8,["camp","option-prix","option-qf"])]),_:1})]),_:1})]),_:1})]),_:1})]),_:1}),e(N,{class:"my-2",subtitle:"Visibilité et inscriptions"},{default:t(()=>[e(B,null,{default:t(()=>[e(h,null,{default:t(()=>[e(V,{"align-self":"center"},{default:t(()=>[e(Ne,{label:"Ouverture aux inscriptions",variant:"outlined",density:"compact",items:U(m),"hide-details":"",modelValue:a.value.Statut,"onUpdate:modelValue":r[8]||(r[8]=_=>a.value.Statut=_)},null,8,["items","modelValue"])]),_:1}),e(V,{"align-self":"center"},{default:t(()=>[e(kt,{label:"Camp sans inscription",modelValue:a.value.WithoutInscription,"onUpdate:modelValue":r[9]||(r[9]=_=>a.value.WithoutInscription=_),color:"primary",density:"compact","persistent-hint":"",hint:a.value.WithoutInscription?"Camp externe, uniquement visible sur l'API publique.":""},null,8,["modelValue","hint"])]),_:1})]),_:1})]),_:1})]),_:1}),e(N,{class:"my-2",subtitle:"Filtres sur les inscrits"},{default:t(()=>[e(B,null,{default:t(()=>[e(h,null,{default:t(()=>[e(V,{"align-self":"center"},{default:t(()=>[e(p,{modelValue:a.value.Places,"onUpdate:modelValue":r[10]||(r[10]=_=>a.value.Places=_),label:"Nombre de places"},null,8,["modelValue"])]),_:1}),e(V,{"align-self":"center"},{default:t(()=>[e(p,{modelValue:a.value.AgeMin,"onUpdate:modelValue":r[11]||(r[11]=_=>a.value.AgeMin=_),label:"Âge minimum"},null,8,["modelValue"])]),_:1}),e(V,{"align-self":"center"},{default:t(()=>[e(p,{modelValue:a.value.AgeMax,"onUpdate:modelValue":r[12]||(r[12]=_=>a.value.AgeMax=_),label:"Âge maximum"},null,8,["modelValue"])]),_:1})]),_:1}),e(h,null,{default:t(()=>[e(V,null,{default:t(()=>[e(x,{modelValue:a.value.NeedEquilibreGF,"onUpdate:modelValue":r[13]||(r[13]=_=>a.value.NeedEquilibreGF=_),label:"Equilibre G/F demandé",density:"compact","persistent-hint":"",hint:"Place un inscrit en liste d'attente en cas de déséquilibre Garçons/Filles"},null,8,["modelValue"])]),_:1})]),_:1})]),_:1})]),_:1}),e(N,{class:"my-2",subtitle:"Formulaire d'inscription"},{default:t(()=>[e(B,null,{default:t(()=>[e(h,null,{default:t(()=>[e(V,null,{default:t(()=>[e(ve,{label:"Image",density:"compact",variant:"outlined",hint:"URL d'une image affichée sur le formulaire d'inscription","persistent-hint":"",modelValue:a.value.ImageURL,"onUpdate:modelValue":r[14]||(r[14]=_=>a.value.ImageURL=_)},null,8,["modelValue"])]),_:1})]),_:1}),e(h,null,{default:t(()=>[e(V,null,{default:t(()=>[e(vt,{variant:"outlined",density:"compact",label:"Description",hint:"Ce texte est affiché sur le formulaire d'inscription.","persistent-hint":"",rows:"3",modelValue:a.value.Description,"onUpdate:modelValue":r[15]||(r[15]=_=>a.value.Description=_)},null,8,["modelValue"])]),_:1}),e(V,{cols:"2"},{default:t(()=>[e(x,{label:"Navette",modelValue:a.value.Navette.Actif,"onUpdate:modelValue":r[16]||(r[16]=_=>a.value.Navette.Actif=_)},null,8,["modelValue"])]),_:1}),e(V,null,{default:t(()=>[e(vt,{variant:"outlined",density:"compact",label:"Navette",hint:"Ce texte est affiché sur l'espace personnel de suivi.","persistent-hint":"",rows:"3",disabled:!a.value.Navette.Actif,modelValue:a.value.Navette.Commentaire,"onUpdate:modelValue":r[17]||(r[17]=_=>a.value.Navette.Commentaire=_)},null,8,["disabled","modelValue"])]),_:1})]),_:1}),e(h,null,{default:t(()=>[e(V,null,{default:t(()=>[e(ve,{density:"compact",variant:"outlined",label:"URL de préselection",hint:"Cette URL permet de sélectionner automatiquement le séjour sur le formulaire d'inscription.","persistent-hint":"",readonly:"","model-value":o.preselectionUrl},{append:t(()=>[e(F,{icon:"mdi-content-copy",size:"small",onClick:d})]),_:1},8,["model-value"])]),_:1})]),_:1})]),_:1})]),_:1}),e(N,{class:"my-2",subtitle:"Autre"},{default:t(()=>[e(B,null,{default:t(()=>[e(h,null,{default:t(()=>[e(V,null,{default:t(()=>[e(ve,{label:"Mot de passe",density:"compact",variant:"outlined",hint:"Mot de passe d'accès à la page Directeur","persistent-hint":"",modelValue:a.value.Password,"onUpdate:modelValue":r[18]||(r[18]=_=>a.value.Password=_)},null,8,["modelValue"])]),_:1})]),_:1})]),_:1})]),_:1}),e(Xa,{"meta-entries-hints":l.metaEntriesHints,modelValue:a.value.Meta,"onUpdate:modelValue":r[19]||(r[19]=_=>a.value.Meta=_)},null,8,["meta-entries-hints","modelValue"])]),_:1}),e(re,null,{default:t(()=>[e(oe),e(F,{disabled:!u.value,onClick:r[20]||(r[20]=_=>c("save",a.value))},{default:t(()=>[...r[21]||(r[21]=[y("Enregistrer",-1)])]),_:1},8,["disabled"])]),_:1})]),_:1},8,["subtitle"])}}}),Qt=G({__name:"TauxSelect",props:{modelValue:{required:!0},modelModifiers:{}},emits:["update:modelValue"],setup(l){Ee(u);const s=we(l,"modelValue"),o=D(null),c=R(()=>{const i=Array.from(a.value.values()).map(r=>({title:r.Label,value:r.Id}));return i.sort((r,v)=>r.title.localeCompare(v.title)),i}),a=D(new Map);async function u(){const i=await C.CampsGetTaux();i!==void 0&&(a.value=$l(i),s.value.Id>0&&(s.value=De(a.value.get(s.value.Id)),o.value=s.value.Id))}function m(){s.value.Id<=0?(o.value==null&&(o.value=1),s.value=De(a.value.get(o.value))):(o.value=null,s.value.Id=0,s.value.Label="")}function n(i){s.value=De(a.value.get(i))}const d=R(()=>{if(s.value.Id>0)return null;const i=s.value.Label;return Array.from(a.value.values()).map(v=>v.Label).includes(i)?"Ce label est déjà utilisé.":null});return(i,r)=>(b(),w(h,null,{default:t(()=>[e(V,{"align-self":"center"},{default:t(()=>[s.value.Id>0?(b(),w(Ne,{key:0,variant:"outlined",density:"compact","hide-details":"",label:"Taux",items:c.value,modelValue:o.value,"onUpdate:modelValue":[r[0]||(r[0]=v=>o.value=v),n]},null,8,["items","modelValue"])):(b(),w(h,{key:1},{default:t(()=>[e(V,{cols:"12"},{default:t(()=>[e(ve,{variant:"outlined",density:"compact",label:"Label",modelValue:s.value.Label,"onUpdate:modelValue":r[1]||(r[1]=v=>s.value.Label=v),disabled:s.value.Id>0,"error-messages":d.value},null,8,["modelValue","disabled","error-messages"])]),_:1}),e(V,null,{default:t(()=>[e(ve,{label:`Valeur d'un ${U(Rl)[U(Fl).FrancsSuisse]}`,density:"compact",variant:"outlined",type:"number",min:"0.001",suffix:"€",hint:"Valeur en € d'une unité de la monnaie.","persistent-hint":"","model-value":s.value.FrancsSuisse/1e3,"onUpdate:modelValue":r[2]||(r[2]=v=>s.value.FrancsSuisse=U(Ul)(Number(v)*1e3)),disabled:s.value.Id>0},null,8,["label","model-value","disabled"])]),_:1})]),_:1}))]),_:1}),e(V,{cols:"auto"},{default:t(()=>[e(ue,{thickness:"2",vertical:"",class:"py-4"},{default:t(()=>[...r[3]||(r[3]=[y("ou",-1)])]),_:1})]),_:1}),e(V,{"align-self":"center",cols:"auto"},{default:t(()=>[e(F,{onClick:m},{prepend:t(()=>[e(pe,null,{default:t(()=>[...r[4]||(r[4]=[y("mdi-toggle-switch",-1)])]),_:1})]),default:t(()=>[y(" "+M(s.value.Id>0?"Créer un taux":"Utiliser un taux"),1)]),_:1})]),_:1})]),_:1}))}}),en=G({__name:"CampStats",props:{stats:{}},setup(l){const s=l;function o(c,a){return`(${xe.pourcent(c,a)} %)`}return(c,a)=>(b(),w(N,{title:"Statut des inscriptions"},{default:t(()=>[e(B,null,{default:t(()=>[e(ke,{density:"compact"},{default:t(()=>[e(Y,{title:"Demandes d'inscriptions"},{append:t(()=>[y(M(s.stats.Inscriptions),1)]),_:1}),e(Y,{title:"Filles",subtitle:"Parmi toutes les demandes d'inscription"},{append:t(()=>[y(M(s.stats.InscriptionsFilles)+" "+M(o(s.stats.InscriptionsFilles,s.stats.Inscriptions)),1)]),_:1}),e(Y,{title:"Suisses",subtitle:"Parmi toutes les demandes d'inscription"},{append:t(()=>[y(M(s.stats.InscriptionsSuisses)+" "+M(o(s.stats.InscriptionsSuisses,s.stats.Inscriptions)),1)]),_:1}),e(Y,{title:"Inscriptions confirmées"},{append:t(()=>[y(M(s.stats.Valides)+" "+M(o(s.stats.Valides,s.stats.Inscriptions)),1)]),_:1}),e(Y,{title:"Filles",subtitle:"Parmi les inscriptions confirmées"},{append:t(()=>[y(M(s.stats.ValidesFilles)+" "+M(o(s.stats.ValidesFilles,s.stats.Valides)),1)]),_:1}),e(Y,{title:"Suisses",subtitle:"Parmi les inscriptions confirmées"},{append:t(()=>[y(M(s.stats.ValidesSuisses)+" "+M(o(s.stats.ValidesSuisses,s.stats.Valides)),1)]),_:1}),e(Y,{title:"A statuer"},{append:t(()=>[y(M(s.stats.AStatuer)+" "+M(o(s.stats.AStatuer,s.stats.Inscriptions)),1)]),_:1}),e(Y,{title:"Demandes d'exception"},{append:t(()=>[y(M(s.stats.Exceptions)+" "+M(o(s.stats.Exceptions,s.stats.Inscriptions)),1)]),_:1}),e(Y,{title:"Refus"},{append:t(()=>[y(M(s.stats.Refus)+" "+M(o(s.stats.Refus,s.stats.Inscriptions)),1)]),_:1})]),_:1})]),_:1})]),_:1}))}}),tn={key:0},ln=G({__name:"CampHeaderRow",props:{camp:{}},emits:["click","edit","edit-taux","delete","show-documents","send-sondage","add-directeur"],setup(l,{emit:s}){const o=l,c=s,a=R(()=>o.camp.Stats.Inscriptions-o.camp.Stats.Valides),u=D(!1),m=R(()=>{switch(new Date(o.camp.Camp.Camp.DateDebut).getUTCMonth()+1){case 7:case 8:return"rgb(45, 185, 187)";case 9:case 10:case 11:return"rgb(190, 150, 60)";case 12:case 1:case 2:case 3:return"rgb(240, 240, 240)";case 4:case 5:case 6:default:return"rgb(190, 228, 100)"}}),n=D(!1),d=D(0),i=R(()=>{const r=o.camp.ParticipantsFiles||[];if(r.length==0)return 0;let v=0;for(const p of r)p.InscritsCount!=0&&(v+=p.UploadedCount/p.InscritsCount);return Math.round(v/r.length*100)});return(r,v)=>{const p=it;return b(),Q(te,null,[e(N,{color:m.value,"no-gutters":"",onClick:v[6]||(v[6]=k=>c("click")),class:"my-1"},{default:t(()=>[e(h,{style:at({"background-color":m.value}),class:"px-1","no-gutters":"",justify:"space-between"},{default:t(()=>[e(V,null,{default:t(()=>[e(Y,{title:U(Pe).label(o.camp.Camp.Camp),subtitle:`ID : ${o.camp.Camp.Camp.Id}`},null,8,["title","subtitle"])]),_:1}),e(V,{"align-self":"center"},{default:t(()=>[y(M(U(Pe).formatPlage(l.camp.Camp.Camp)),1)]),_:1}),e(V,{cols:"2","align-self":"center"},{default:t(()=>[e(je,{width:"450px",location:"left","content-class":"pa-0"},{activator:t(({props:k})=>[e(mt,se({class:"bg-white border-md border-primary"},k,{max:o.camp.Camp.Camp.Places,"model-value":o.camp.Stats.Valides,height:"36",rounded:"",color:"primary"}),{default:t(()=>[E("strong",null,[y(M(o.camp.Stats.Valides)+"/"+M(o.camp.Camp.Camp.Places)+" ",1),a.value>0?(b(),Q("span",tn," (+ "+M(a.value)+")",1)):W("",!0)]),e(pe,{class:"ml-2"},{default:t(()=>[...v[12]||(v[12]=[y("mdi-account-multiple",-1)])]),_:1})]),_:1},16,["max","model-value"])]),default:t(()=>[e(en,{stats:o.camp.Stats},null,8,["stats"])]),_:1})]),_:1}),e(V,{cols:"1","align-self":"center",class:"px-2"},{default:t(()=>[e(je,{width:"600",location:"left","content-class":"pa-0"},{activator:t(({props:k})=>[e(mt,se({class:"bg-white border-md border-primary"},k,{max:100,"model-value":i.value,height:"36",rounded:"",color:"primary"}),{default:t(()=>[E("strong",null,M(i.value)+" % ",1),e(pe,{class:"ml-2"},{default:t(()=>[...v[13]||(v[13]=[y("mdi-file-upload",-1)])]),_:1})]),_:1},16,["model-value"])]),default:t(()=>[e(N,{title:"Pièces justificatives"},{default:t(()=>[e(B,null,{default:t(()=>[e(ke,null,{default:t(()=>[(b(!0),Q(te,null,me(o.camp.ParticipantsFiles,k=>(b(),w(Y,{title:k.Title},{append:t(()=>[y(M(k.UploadedCount)+" / "+M(k.InscritsCount)+" ("+M(U(xe).pourcent(k.UploadedCount,k.InscritsCount))+" %) ",1)]),_:2},1032,["title"]))),256))]),_:1})]),_:1})]),_:1})]),_:1})]),_:1}),e(V,{cols:"1"}),e(V,{cols:"auto","align-self":"center"},{default:t(()=>[e(Ie,null,{activator:t(({props:k})=>[e(F,se(k,{size:"x-small",class:"mx-1",icon:"mdi-dots-vertical"}),null,16)]),default:t(()=>[e(ke,{density:"compact"},{default:t(()=>[e(Y,{"prepend-icon":"mdi-pencil",onClick:v[0]||(v[0]=k=>c("edit"))},{default:t(()=>[...v[14]||(v[14]=[y("Modifier les paramètres",-1)])]),_:1}),e(Y,{"prepend-icon":"mdi-currency-eur",onClick:v[1]||(v[1]=k=>c("edit-taux"))},{default:t(()=>[...v[15]||(v[15]=[y("Taux de conversion",-1)])]),_:1}),e(ue,{thickness:"1"}),e(Y,{"prepend-icon":"mdi-mail",onClick:v[2]||(v[2]=k=>c("show-documents")),title:"Documents"}),e(ue,{thickness:"1"}),e(Y,{"prepend-icon":"mdi-plus",onClick:v[3]||(v[3]=k=>n.value=!0),title:"Ajouter un directeur...",disabled:o.camp.HasDirecteur},null,8,["disabled"]),e(ue,{thickness:"1"}),e(Y,{title:"Se connecter à l'espace directeur","prepend-icon":"mdi-open-in-new",href:o.camp.URLDirecteur,target:"_blank"},null,8,["href"]),e(ue,{thickness:"1"}),e(Y,{title:"Envoyer le sondage",subtitle:"de fin de séjour","prepend-icon":"mdi-comment-quote",onClick:v[4]||(v[4]=k=>c("send-sondage"))}),e(ue,{thickness:"1"}),e(Y,{"prepend-icon":"mdi-delete",disabled:o.camp.Stats.Inscriptions>0,onClick:v[5]||(v[5]=k=>u.value=!0)},{default:t(()=>[...v[16]||(v[16]=[y("Supprimer",-1)])]),_:1},8,["disabled"])]),_:1})]),_:1})]),_:1})]),_:1},8,["style"])]),_:1},8,["color"]),e(ee,{modelValue:u.value,"onUpdate:modelValue":v[8]||(v[8]=k=>u.value=k),"max-width":"600"},{default:t(()=>[e(N,{title:"Confirmer la suppression"},{default:t(()=>[e(B,null,{default:t(()=>[v[17]||(v[17]=y(" Etes vous certain de supprimer le séjour ",-1)),E("b",null,M(U(Pe).label(o.camp.Camp.Camp)),1),v[18]||(v[18]=y(" ? ",-1)),v[19]||(v[19]=E("br",null,null,-1)),v[20]||(v[20]=E("br",null,null,-1)),v[21]||(v[21]=y(" Les éventuels ",-1)),v[22]||(v[22]=E("i",null,"équipiers",-1)),v[23]||(v[23]=y(" déclarés sur ce séjour seront aussi supprimés. ",-1)),v[24]||(v[24]=E("br",null,null,-1)),v[25]||(v[25]=E("br",null,null,-1)),v[26]||(v[26]=y(" Attention, cette opération est irréversible. ",-1))]),_:1}),e(re,null,{default:t(()=>[e(oe),e(F,{color:"red",onClick:v[7]||(v[7]=k=>{u.value=!1,c("delete")})},{default:t(()=>[...v[27]||(v[27]=[y("Supprimer",-1)])]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"]),e(ee,{modelValue:n.value,"onUpdate:modelValue":v[11]||(v[11]=k=>n.value=k),"max-width":"400px"},{default:t(()=>[e(N,{title:"Ajouter un directeur"},{default:t(()=>[e(B,null,{default:t(()=>[e(p,{"initial-personne":"",label:"Directeur",modelValue:d.value,"onUpdate:modelValue":v[9]||(v[9]=k=>d.value=k),api:U(C)},null,8,["modelValue","api"])]),_:1}),e(re,null,{default:t(()=>[e(oe),e(F,{disabled:!d.value,onClick:v[10]||(v[10]=k=>{n.value=!1,c("add-directeur",d.value)})},{default:t(()=>[...v[28]||(v[28]=[y("Ajouter",-1)])]),_:1},8,["disabled"])]),_:1})]),_:1})]),_:1},8,["modelValue"])],64)}}}),an=G({__name:"CampsSelector",props:Se({allCamps:{}},{modelValue:{required:!0},modelModifiers:{}}),emits:["update:modelValue"],setup(l,{emit:s}){const o=l,c=we(l,"modelValue"),a=R(()=>o.allCamps.map(u=>({title:u.Label,value:u.Id})));return(u,m)=>(b(),w(_a,{multiple:"",chips:"","closable-chips":"",items:a.value,modelValue:c.value,"onUpdate:modelValue":m[0]||(m[0]=n=>c.value=n)},null,8,["items","modelValue"]))}}),nn=G({__name:"DocumentsCard",props:{camp:{}},setup(l){const s=l;Ee(c);const o=D(null);async function c(){const a=await C.CampsDocuments({idCamp:s.camp.Camp.Camp.Id});a!==void 0&&(o.value=a)}return(a,u)=>{const m=Ma;return o.value!=null?(b(),w(N,{key:0,title:"Documents"},{default:t(()=>[e(B,null,{default:t(()=>[e(ke,null,{default:t(()=>[e(Tt,null,{default:t(()=>[...u[0]||(u[0]=[y("Préférences d'affichage",-1)])]),_:1}),e(Y,null,{default:t(()=>[e(h,{class:"mb-2"},{default:t(()=>[e(V,null,{default:t(()=>[e(be,{color:o.value.ToShow.LettreDirecteur?"green":"grey","append-icon":o.value.ToShow.LettreDirecteur?"mdi-check":""},{default:t(()=>[...u[1]||(u[1]=[y("Lettre du directeur",-1)])]),_:1},8,["color","append-icon"])]),_:1}),e(V,null,{default:t(()=>[e(be,{color:o.value.ToShow.ListeVetements?"green":"grey","append-icon":o.value.ToShow.ListeVetements?"mdi-check":""},{default:t(()=>[...u[2]||(u[2]=[y(" Liste de vêtements",-1)])]),_:1},8,["color","append-icon"])]),_:1}),e(V,null,{default:t(()=>[e(be,{color:o.value.ToShow.ListeParticipants?"green":"grey","append-icon":o.value.ToShow.ListeParticipants?"mdi-check":""},{default:t(()=>[...u[3]||(u[3]=[y("Liste des participants ",-1)])]),_:1},8,["color","append-icon"])]),_:1})]),_:1})]),_:1}),e(Tt,null,{default:t(()=>[...u[4]||(u[4]=[y("Documents du séjour",-1)])]),_:1}),(b(!0),Q(te,null,me(o.value.Generated,n=>(b(),w(Y,{title:n.NomClient},{append:t(()=>[e(m,{"file-key":n.Key,"is-generated-doc":!0},null,8,["file-key"])]),_:2},1032,["title"]))),256)),(b(!0),Q(te,null,me(o.value.ToRead,n=>(b(),w(Y,{title:n.NomClient},{append:t(()=>[e(m,{"file-key":n.Key,"is-generated-doc":!1},null,8,["file-key"])]),_:2},1032,["title"]))),256)),(b(!0),Q(te,null,me(o.value.ToUploadModeles,n=>(b(),w(Y,{title:n.NomClient,subtitle:"Document à remplir"},{append:t(()=>[e(m,{"file-key":n.Key,"is-generated-doc":!1},null,8,["file-key"])]),_:2},1032,["title"]))),256))]),_:1})]),_:1})]),_:1})):(b(),w(Qe,{key:1,type:"card"}))}}}),_t=G({__name:"RequestProgressCard",props:{title:{},current:{},total:{}},setup(l){const s=l;return(o,c)=>(b(),w(N,{title:s.title},{default:t(()=>[e(B,null,{default:t(()=>[e(mt,{max:s.total,"model-value":s.current,color:"primary",height:"24"},{default:t(()=>[y(M(s.current)+" / "+M(s.total),1)]),_:1},8,["max","model-value"])]),_:1})]),_:1},8,["title"]))}}),un={key:0,class:"text-center my-4"},sn=G({__name:"JoomeoPannel",emits:["save"],setup(l,{emit:s}){Ee(a);const o=D(null),c=D([]);async function a(){const p=await C.CampsLoadAlbums();p!==void 0&&(o.value=p||[],c.value=[])}function u(p){return o.value.find(k=>k.Camp.Id==p)}const m=D(!1),n=R(()=>m.value||!c.value.length||!o.value?!1:c.value.every(p=>u(p).Camp.JoomeoID==""));async function d(){m.value=!0;const p=await C.CampsCreateAlbums({IdCamps:c.value});m.value=!1,p!==void 0&&(It(p).forEach(([k,x])=>{u(k).Album=x}),C.showMessage("Albums Joomeo créés avec succès."))}const i=R(()=>m.value||!c.value.length||!o.value?!1:c.value.every(p=>u(p).Camp.JoomeoID!=""&&u(p).HasDirecteur));async function r(){m.value=!0;const p=await C.CampsAddDirecteursToAlbums({IdCamps:c.value,SendMail:!0});m.value=!1,p!==void 0&&(It(p).forEach(([k,x])=>{u(k).DirecteurPermission=x}),C.showMessage("Directeurs ajoutés avec succès."))}function v(p){return p.type==1&&p.albumAccessRules.allowDownload&&p.albumAccessRules.allowUpload&&p.accessRules.allowDeleteFile&&p.accessRules.allowEditFileCaption}return(p,k)=>(b(),w(N,{title:"Albums Joomeo",subtitle:"Seuls les camps en cours sont affichés."},{append:t(()=>[e(F,{disabled:!n.value,onClick:d},{prepend:t(()=>[e(pe,{color:"green"},{default:t(()=>[...k[1]||(k[1]=[y("mdi-plus",-1)])]),_:1})]),default:t(()=>[k[2]||(k[2]=y(" Créer les albums",-1))]),_:1},8,["disabled"]),e(F,{disabled:!i.value,onClick:r,class:"ml-2"},{prepend:t(()=>[e(pe,null,{default:t(()=>[...k[3]||(k[3]=[y("mdi-account-eye",-1)])]),_:1})]),default:t(()=>[k[4]||(k[4]=y(" Ajouter les directeurs",-1))]),_:1},8,["disabled"])]),default:t(()=>[m.value?(b(),w(mt,{key:0,indeterminate:""})):W("",!0),e(B,null,{default:t(()=>[o.value==null?(b(),Q("div",un,[e(Ll,{indeterminate:""})])):(b(),w(ke,{key:1,selected:c.value,"onUpdate:selected":k[0]||(k[0]=x=>c.value=x),"select-strategy":"leaf"},{default:t(()=>[(b(!0),Q(te,null,me(o.value,x=>(b(),w(Y,{value:x.Camp.Id,title:U(Pe).label(x.Camp),rounded:"",class:"my-1"},{append:t(()=>[e(h,null,{default:t(()=>[e(V,null,{default:t(()=>[e(be,{color:x.Album.Id?"primary":void 0},{default:t(()=>[x.Album.Id?(b(),w(je,{key:0,activator:"parent","content-class":"pa-0"},{default:t(()=>[e(N,{title:"Album Joomeo","min-width":"400px"},{default:t(()=>[e(B,null,{default:t(()=>[e(h,null,{default:t(()=>[e(V,{cols:"auto"},{default:t(()=>[...k[5]||(k[5]=[y("Nom",-1)])]),_:1}),e(V,{class:"text-right"},{default:t(()=>[y(M(x.Album.Label),1)]),_:2},1024)]),_:2},1024),e(h,null,{default:t(()=>[e(V,{cols:"auto"},{default:t(()=>[...k[6]||(k[6]=[y("ID",-1)])]),_:1}),e(V,{class:"text-right"},{default:t(()=>[y(M(x.Album.Id),1)]),_:2},1024)]),_:2},1024),e(h,null,{default:t(()=>[e(V,{cols:"auto"},{default:t(()=>[...k[7]||(k[7]=[y("Date de création",-1)])]),_:1}),e(V,{class:"text-right"},{default:t(()=>[y(M(new Date(x.Album.Date).toLocaleDateString("fr")),1)]),_:2},1024)]),_:2},1024),e(h,null,{default:t(()=>[e(V,{cols:"auto"},{default:t(()=>[...k[8]||(k[8]=[y("Nombre de photos",-1)])]),_:1}),e(V,{class:"text-right"},{default:t(()=>[y(M(x.Album.FilesCount),1)]),_:2},1024)]),_:2},1024)]),_:2},1024)]),_:2},1024)]),_:2},1024)):W("",!0),y(" "+M(x.Album.Id==""?"Pas d'album":`Album créé le ${U(xe).date(x.Album.Date)}`),1)]),_:2},1032,["color"])]),_:2},1024),x.Album.Id?(b(),w(V,{key:0},{default:t(()=>[e(be,{color:x.HasDirecteur?x.DirecteurPermission.contactid!=""?"green":"orange":"red"},{default:t(()=>[x.DirecteurPermission.contactid?(b(),w(je,{key:0,activator:"parent","content-class":"pa-0"},{default:t(()=>[e(N,{title:"Accès à l'album",subtitle:"Le directeur a accès à l'album."},{default:t(()=>[e(B,null,{default:t(()=>[e(h,null,{default:t(()=>[e(V,null,{default:t(()=>[...k[9]||(k[9]=[y("Email",-1)])]),_:1}),e(V,{class:"text-right"},{default:t(()=>[y(M(x.DirecteurPermission.email),1)]),_:2},1024)]),_:2},1024),e(h,null,{default:t(()=>[e(V,null,{default:t(()=>[...k[10]||(k[10]=[y("Login",-1)])]),_:1}),e(V,{class:"text-right"},{default:t(()=>[y(M(x.DirecteurPermission.login),1)]),_:2},1024)]),_:2},1024),e(h,null,{default:t(()=>[e(V,null,{default:t(()=>[...k[11]||(k[11]=[y("Mot de passe",-1)])]),_:1}),e(V,{class:"text-right"},{default:t(()=>[y(M(x.DirecteurPermission.password),1)]),_:2},1024)]),_:2},1024),e(h,null,{default:t(()=>[e(V,null,{default:t(()=>[...k[12]||(k[12]=[y("Permissions (écriture)",-1)])]),_:1}),e(V,{class:"text-right"},{default:t(()=>[e(pe,{icon:v(x.DirecteurPermission)?"mdi-check":"mdi-warning",color:v(x.DirecteurPermission)?"green":"orange"},null,8,["icon","color"])]),_:2},1024)]),_:2},1024)]),_:2},1024)]),_:2},1024)]),_:2},1024)):W("",!0),y(" "+M(x.HasDirecteur?x.DirecteurPermission.contactid!=""?"Directeur ajouté":"Directeur à ajouter":"Aucun directeur"),1)]),_:2},1032,["color"])]),_:2},1024)):W("",!0)]),_:2},1024)]),_:2},1032,["value","title"]))),256))]),_:1},8,["selected"]))]),_:1}),e(re,null,{default:t(()=>[e(oe)]),_:1})]),_:1}))}});function on(){const l=D([]);hl(()=>l.value=[]);function s(o,c){l.value[c]=o}return{refs:l,updateRef:s}}const rn=Re({activeColor:String,start:{type:[Number,String],default:1},modelValue:{type:Number,default:l=>l.start},disabled:Boolean,length:{type:[Number,String],default:1,validator:l=>l%1===0},totalVisible:[Number,String],firstIcon:{type:Be,default:"$first"},prevIcon:{type:Be,default:"$prev"},nextIcon:{type:Be,default:"$next"},lastIcon:{type:Be,default:"$last"},ariaLabel:{type:String,default:"$vuetify.pagination.ariaLabel.root"},pageAriaLabel:{type:String,default:"$vuetify.pagination.ariaLabel.page"},currentPageAriaLabel:{type:String,default:"$vuetify.pagination.ariaLabel.currentPage"},firstAriaLabel:{type:String,default:"$vuetify.pagination.ariaLabel.first"},previousAriaLabel:{type:String,default:"$vuetify.pagination.ariaLabel.previous"},nextAriaLabel:{type:String,default:"$vuetify.pagination.ariaLabel.next"},lastAriaLabel:{type:String,default:"$vuetify.pagination.ariaLabel.last"},ellipsis:{type:String,default:"..."},showFirstLastPage:Boolean,...Wl(),...Ql(),...zl(),...Yl(),...Hl(),...ql(),...jl({tag:"nav"}),...Bl(),...Nl({variant:"text"})},"VPagination"),dn=Le()({name:"VPagination",props:rn(),emits:{"update:modelValue":l=>!0,first:l=>!0,prev:l=>!0,next:l=>!0,last:l=>!0},setup(l,s){let{slots:o,emit:c}=s;const a=Ue(l,"modelValue"),{t:u,n:m}=We(),{isRtl:n}=el(),{themeClasses:d}=El(l),{width:i}=Tl(),r=et(-1);At(void 0,{scoped:!0});const{resizeRef:v}=Ol(J=>{if(!J.length)return;const{target:I,contentRect:le}=J[0],ae=I.querySelector(".v-pagination__list > *");if(!ae)return;const O=le.width,j=ae.offsetWidth+parseFloat(getComputedStyle(ae).marginRight)*2;r.value=_(O,j)}),p=R(()=>parseInt(l.length,10)),k=R(()=>parseInt(l.start,10)),x=R(()=>l.totalVisible!=null?parseInt(l.totalVisible,10):r.value>=0?r.value:_(i.value,58));function _(J,I){const le=l.showFirstLastPage?5:3;return Math.max(0,Math.floor(Number(((J-I*le)/I).toFixed(2))))}const P=R(()=>{if(p.value<=0||isNaN(p.value)||p.value>Number.MAX_SAFE_INTEGER)return[];if(x.value<=0)return[];if(x.value===1)return[a.value];if(p.value<=x.value)return Te(p.value,k.value);const J=x.value%2===0,I=J?x.value/2:Math.floor(x.value/2),le=J?I:I+1,ae=p.value-I;if(le-a.value>=0)return[...Te(Math.max(1,x.value-1),k.value),l.ellipsis,p.value];if(a.value-ae>=(J?1:0)){const O=x.value-1,j=p.value-O+k.value;return[k.value,l.ellipsis,...Te(O,j)]}else{const O=Math.max(1,x.value-2),j=O===1?a.value:a.value-Math.ceil(O/2)+k.value;return[k.value,l.ellipsis,...Te(O,j),l.ellipsis,p.value]}});function A(J,I,le){J.preventDefault(),a.value=I,le&&c(le,I)}const{refs:z,updateRef:Z}=on();At({VPaginationBtn:{color:Fe(()=>l.color),border:Fe(()=>l.border),density:Fe(()=>l.density),size:Fe(()=>l.size),variant:Fe(()=>l.variant),rounded:Fe(()=>l.rounded),elevation:Fe(()=>l.elevation)}});const S=R(()=>P.value.map((J,I)=>{const le=ae=>Z(ae,I);if(typeof J=="string")return{isActive:!1,key:`ellipsis-${I}`,page:J,props:{ref:le,ellipsis:!0,icon:!0,disabled:!0}};{const ae=J===a.value;return{isActive:ae,key:J,page:m(J),props:{ref:le,ellipsis:!1,icon:!0,disabled:!!l.disabled||Number(l.length)<2,color:ae?l.activeColor:l.color,"aria-current":ae,"aria-label":u(ae?l.currentPageAriaLabel:l.pageAriaLabel,J),onClick:O=>A(O,J)}}}})),f=R(()=>{const J=!!l.disabled||a.value<=k.value,I=!!l.disabled||a.value>=k.value+p.value-1;return{first:l.showFirstLastPage?{icon:n.value?l.lastIcon:l.firstIcon,onClick:le=>A(le,k.value,"first"),disabled:J,"aria-label":u(l.firstAriaLabel),"aria-disabled":J}:void 0,prev:{icon:n.value?l.nextIcon:l.prevIcon,onClick:le=>A(le,a.value-1,"prev"),disabled:J,"aria-label":u(l.previousAriaLabel),"aria-disabled":J},next:{icon:n.value?l.prevIcon:l.nextIcon,onClick:le=>A(le,a.value+1,"next"),disabled:I,"aria-label":u(l.nextAriaLabel),"aria-disabled":I},last:l.showFirstLastPage?{icon:n.value?l.firstIcon:l.lastIcon,onClick:le=>A(le,k.value+p.value-1,"last"),disabled:I,"aria-label":u(l.lastAriaLabel),"aria-disabled":I}:void 0}});function K(){const J=a.value-k.value;z.value[J]?.$el.focus()}function ge(J){J.key===Mt.left&&!l.disabled&&a.value>Number(l.start)?(a.value=a.value-1,$t(K)):J.key===Mt.right&&!l.disabled&&a.value<k.value+p.value-1&&(a.value=a.value+1,$t(K))}return he(()=>e(l.tag,{ref:v,class:Ce(["v-pagination",d.value,l.class]),style:at(l.style),role:"navigation","aria-label":u(l.ariaLabel),onKeydown:ge,"data-test":"v-pagination-root"},{default:()=>[E("ul",{class:"v-pagination__list"},[l.showFirstLastPage&&E("li",{key:"first",class:"v-pagination__first","data-test":"v-pagination-first"},[o.first?o.first(f.value.first):e(F,se({_as:"VPaginationBtn"},f.value.first),null)]),E("li",{key:"prev",class:"v-pagination__prev","data-test":"v-pagination-prev"},[o.prev?o.prev(f.value.prev):e(F,se({_as:"VPaginationBtn"},f.value.prev),null)]),S.value.map((J,I)=>E("li",{key:J.key,class:Ce(["v-pagination__item",{"v-pagination__item--is-active":J.isActive}]),"data-test":"v-pagination-item"},[o.item?o.item(J):e(F,se({_as:"VPaginationBtn"},J.props),{default:()=>[J.page]})])),E("li",{key:"next",class:"v-pagination__next","data-test":"v-pagination-next"},[o.next?o.next(f.value.next):e(F,se({_as:"VPaginationBtn"},f.value.next),null)]),l.showFirstLastPage&&E("li",{key:"last",class:"v-pagination__last","data-test":"v-pagination-last"},[o.last?o.last(f.value.last):e(F,se({_as:"VPaginationBtn"},f.value.last),null)])])]})),{}}}),mn={key:2},bt=16,cn=G({__name:"CampsList",emits:["show-participants"],setup(l,{emit:s}){const o=s;Ee(r);const c=gt(new Map),a=D(!1),u=gt({pattern:"",openOnly:!1}),m=R(()=>{const $=new Set,g=new Set;for(const T of c.values())for(const L of Object.entries(T.Camp.Camp.Meta||{}))$.add(L[0]),g.add(L[1]);return{keys:Array.from($.keys()).sort(),values:Array.from(g.keys()).sort()}}),n=R(()=>{const $=al(u.pattern),g=Array.from(c.values()).filter(T=>Pe.match(T.Camp.Camp,$)&&(!u.openOnly||Et(T.Camp)));return g.sort((T,L)=>{const ye=new Date(L.Camp.Camp.DateDebut).valueOf(),ne=new Date(T.Camp.Camp.DateDebut).valueOf();return ye==ne?T.Camp.Camp.Id-L.Camp.Camp.Id:ye-ne}),g}),d=R(()=>n.value.slice((k.value-1)*bt,k.value*bt));function i(){k.value>p.value&&(k.value=p.value)}async function r(){a.value=!0;const $=await C.CampsGet();a.value=!1,$!==void 0&&(c.clear(),$?.forEach(g=>c.set(g.Camp.Camp.Id,g)))}async function v(){a.value=!0;const $=await C.CampsCreate();a.value=!1,$!==void 0&&(C.showMessage("Camp ajouté avec succès."),c.set($.Camp.Camp.Id,$),x.value=$)}const p=R(()=>Math.max(Math.ceil(n.value.length/bt),1)),k=D(1),x=D(null);async function _($){x.value=null,a.value=!0;const g=await C.CampsUpdate($);a.value=!1,g!==void 0&&(C.showMessage("Séjour modifié avec succès."),c.get(g.Camp.Id).Camp=g,i())}const P=D(null);async function A(){const $=P.value;if($==null)return;P.value=null,a.value=!0;const g=await C.CampsSetTaux({IdCamp:$.Camp.Camp.Id,Taux:$.Taux});if(a.value=!1,g===void 0)return;C.showMessage("Taux modifié avec succès.");const T=c.get($.Camp.Camp.Id);T.Camp.Camp.IdTaux=g.Id,T.Taux=g}const z=D(!1),Z=D(5),S=D({Id:1,Label:"",Euros:0,FrancsSuisse:0}),f=R(()=>S.value.Id>0||S.value.Label!=""),K=R(()=>new Set(Array.from(c.values()).filter(g=>Et(g.Camp)).map(g=>g.Camp.Camp.IdTaux)).size<=1);async function ge(){z.value=!1,a.value=!0;const $=await C.CampsCreateMany({Count:Z.value,Taux:S.value});a.value=!1,$!==void 0&&(C.showMessage("Séjours créés avec succès."),$?.forEach(g=>c.set(g.Camp.Camp.Id,g)))}async function J($){a.value=!0;const g=await C.CampsDelete({id:$.Camp.Camp.Id});a.value=!1,g!==void 0&&(C.showMessage("Séjour supprimé avec succès."),c.delete($.Camp.Camp.Id),i())}const I=D(!1);function le(){ae.value=Array.from(c.values()).filter($=>$.Camp.Camp.Statut!=Gl.Ouvert).map($=>$.Camp.Camp.Id),I.value=!0}const ae=D([]);async function O(){I.value=!1,!(!ae.value.length||await C.CampsOuvreInscriptions({Camps:ae.value})===void 0)&&(C.showMessage("Séjours ouverts aux inscriptions avec succès."),r())}const j=D(null),ie=D(null);async function X($){ie.value={Current:0,Total:10};const g=await C.EventsSendSondages({idCamp:$});if(g===void 0){ie.value=null;return}await Vt(g,T=>ie.value=T,T=>C.onError("Envoi du sondage",T)),ie.value=null,C.showMessage("Sondage envoyé avec succès.")}async function fe($,g){await C.CampsCreateEquipier({IdPersonne:$,IdCamp:g,Roles:[Kl.Direction]})!==void 0&&(c.get(g).HasDirecteur=!0,C.showMessage("Directeur ajouté avec succès."))}const Ve=D(!1);return($,g)=>{const T=Ge;return b(),Q(te,null,[e(N,{title:"Séjours",subtitle:c.size},{append:t(()=>[e(h,null,{default:t(()=>[e(V,{"align-self":"center",style:{width:"240px"}},{default:t(()=>[e(ve,{label:"Rechercher",variant:"filled",density:"comfortable","hide-details":"","prepend-inner-icon":"mdi-magnify",clearable:"",modelValue:u.pattern,"onUpdate:modelValue":[g[0]||(g[0]=L=>u.pattern=L),g[2]||(g[2]=L=>i())],"onClick:clear":g[1]||(g[1]=L=>{u.pattern="",i()})},null,8,["modelValue"])]),_:1}),e(ue,{vertical:"",thickness:"1"}),e(V,{"align-self":"center",cols:"auto"},{default:t(()=>[e(Ie,null,{activator:t(({props:L})=>[e(F,se(L,{color:"success",disabled:a.value}),{prepend:t(()=>[e(pe,null,{default:t(()=>[...g[18]||(g[18]=[y("mdi-plus",-1)])]),_:1})]),default:t(()=>[g[19]||(g[19]=y(" Créer un séjour ",-1))]),_:1},16,["disabled"])]),default:t(()=>[e(ke,{density:"compact"},{default:t(()=>[e(Y,{onClick:v,title:"Créer un séjour"}),e(Y,{title:"Créer plusieurs séjours...",subtitle:"Permet de choisir les taux de conversion",onClick:g[3]||(g[3]=L=>z.value=!0)})]),_:1})]),_:1})]),_:1}),e(V,{"align-self":"center",cols:"auto"},{default:t(()=>[e(F,{flat:"",icon:"",size:"small"},{default:t(()=>[e(pe,{icon:"mdi-dots-vertical"}),e(Ie,{activator:"parent"},{default:t(()=>[e(ke,{density:"compact"},{default:t(()=>[e(Y,{title:"Masquer les camps fermés",subtitle:"N'afficher que les camps ouverts aux inscriptions",onClick:g[5]||(g[5]=L=>u.openOnly=!u.openOnly)},{prepend:t(()=>[e(Ye,{class:"mr-2",modelValue:u.openOnly,"onUpdate:modelValue":g[4]||(g[4]=L=>u.openOnly=L),density:"compact","hide-details":""},null,8,["modelValue"])]),_:1}),e(ue,{thickness:"1"}),e(Y,{onClick:g[6]||(g[6]=L=>Ve.value=!0),title:"Configurer les albums Joomeo...","prepend-icon":"mdi-image-album"}),e(ue,{thickness:"1"}),e(Y,{onClick:le,title:"Ouvrir les inscriptions...",subtitle:"sur plusieurs séjours","prepend-icon":"mdi-lock-open"}),e(ue,{thickness:"1"}),e(Y,{"prepend-icon":"mdi-file-excel",title:"Exporter",subtitle:"Participants de l'année courante (format Excel)",link:"",href:U(C).CampsDownloadParticipants(new Date().getFullYear(),U(C).authToken)},null,8,["href"])]),_:1})]),_:1})]),_:1})]),_:1})]),_:1})]),default:t(()=>[e(B,{class:"mt-4"},{default:t(()=>[K.value?W("",!0):(b(),w(Jl,{key:0,type:"warning"},{default:t(()=>[...g[20]||(g[20]=[y(" Attention, les séjours ouverts aux inscriptions ont des taux de conversion incompatibles ! ",-1)])]),_:1})),a.value?(b(),w(Qe,{key:1})):n.value.length==0?(b(),Q("i",mn," Aucun camp ne correspond aux filtres actuels. ")):W("",!0),(b(!0),Q(te,null,me(d.value,(L,ye)=>(b(),w(ln,{key:ye,camp:L,onClick:ne=>o("show-participants",L),onEdit:ne=>x.value=L,onEditTaux:ne=>P.value=L,onDelete:ne=>J(L),onShowDocuments:ne=>j.value=L,onSendSondage:ne=>X(L.Camp.Camp.Id),onAddDirecteur:ne=>fe(ne,L.Camp.Camp.Id)},null,8,["camp","onClick","onEdit","onEditTaux","onDelete","onShowDocuments","onSendSondage","onAddDirecteur"]))),128)),e(dn,{length:p.value,modelValue:k.value,"onUpdate:modelValue":g[7]||(g[7]=L=>k.value=L)},null,8,["length","modelValue"])]),_:1})]),_:1},8,["subtitle"]),e(ee,{"model-value":x.value!=null,"onUpdate:modelValue":g[8]||(g[8]=L=>x.value=null),"max-width":"800px"},{default:t(()=>[x.value!=null?(b(),w(Za,{key:0,camp:x.value.Camp.Camp,"preselection-url":x.value.URLPreselection,"meta-entries-hints":m.value,onSave:_},null,8,["camp","preselection-url","meta-entries-hints"])):W("",!0)]),_:1},8,["model-value"]),e(ee,{"model-value":P.value!=null,"onUpdate:modelValue":g[10]||(g[10]=L=>P.value=null),"max-width":"600"},{default:t(()=>[P.value!=null?(b(),w(N,{key:0,title:"Modifier le taux",subtitle:"La modification n'est possible que si aucun participant n'est enregistré."},{default:t(()=>[e(B,null,{default:t(()=>[e(Qt,{modelValue:P.value.Taux,"onUpdate:modelValue":g[9]||(g[9]=L=>P.value.Taux=L)},null,8,["modelValue"])]),_:1}),e(re,null,{default:t(()=>[e(oe),e(F,{disabled:P.value.Stats.Inscriptions>0,onClick:A},{default:t(()=>[...g[21]||(g[21]=[y("Modifier",-1)])]),_:1},8,["disabled"])]),_:1})]),_:1})):W("",!0)]),_:1},8,["model-value"]),e(ee,{modelValue:z.value,"onUpdate:modelValue":g[13]||(g[13]=L=>z.value=L),"max-width":"600"},{default:t(()=>[e(N,{title:"Créer plusieurs séjours",subtitle:"Les séjours seront liés au même taux de conversion"},{default:t(()=>[e(B,null,{default:t(()=>[e(h,null,{default:t(()=>[e(V,null,{default:t(()=>[e(T,{label:"Nombre de séjours",modelValue:Z.value,"onUpdate:modelValue":g[11]||(g[11]=L=>Z.value=L)},null,8,["modelValue"])]),_:1})]),_:1}),e(ue,{thickness:"2",class:"my-2"}),e(Qt,{modelValue:S.value,"onUpdate:modelValue":g[12]||(g[12]=L=>S.value=L)},null,8,["modelValue"])]),_:1}),e(re,null,{default:t(()=>[e(oe),e(F,{color:"success",onClick:ge,disabled:!f.value},{default:t(()=>[...g[22]||(g[22]=[y("Créer",-1)])]),_:1},8,["disabled"])]),_:1})]),_:1})]),_:1},8,["modelValue"]),e(ee,{modelValue:I.value,"onUpdate:modelValue":g[15]||(g[15]=L=>I.value=L),"max-width":"600"},{default:t(()=>[e(N,{title:"Ouvrir les inscriptions",subtitle:"Ouvre les inscriptions sur les séjours ci-dessous"},{default:t(()=>[e(B,null,{default:t(()=>[e(an,{"all-camps":Array.from(c.values()).map(L=>U(Pe).toItem(L.Camp)),modelValue:ae.value,"onUpdate:modelValue":g[14]||(g[14]=L=>ae.value=L)},null,8,["all-camps","modelValue"])]),_:1}),e(re,null,{default:t(()=>[e(oe),e(F,{onClick:O,disabled:!ae.value.length},{default:t(()=>[...g[23]||(g[23]=[y("Ouvrir",-1)])]),_:1},8,["disabled"])]),_:1})]),_:1})]),_:1},8,["modelValue"]),e(ee,{"model-value":j.value!=null,"onUpdate:modelValue":g[16]||(g[16]=L=>j.value=null),"max-width":"800px"},{default:t(()=>[j.value?(b(),w(nn,{key:0,camp:j.value},null,8,["camp"])):W("",!0)]),_:1},8,["model-value"]),e(ee,{"model-value":ie.value!=null,"max-width":"400px",persistent:""},{default:t(()=>[ie.value?(b(),w(_t,{key:0,title:"Envoi du sondage en cours",current:ie.value.Current,total:ie.value.Total},null,8,["current","total"])):W("",!0)]),_:1},8,["model-value"]),e(ee,{modelValue:Ve.value,"onUpdate:modelValue":g[17]||(g[17]=L=>Ve.value=L)},{default:t(()=>[e(sn)]),_:1},8,["modelValue"])],64)}}}),vn={key:1},pn={key:0,class:"text-center font-italic"},fn=G({__name:"CampParticipants",props:{id:{},idParticipant:{}},setup(l){const s=l;Ee(async()=>{a(),await n(),d()}),$e(()=>s.id,n),$e(()=>s.idParticipant,d);const o=D(!1),c=D([]);async function a(){const S=await C.GetCamps();S!==void 0&&(c.value=S||[])}const u=R(()=>{const S=(m.value?.Participants||[]).map(f=>f);return S.sort(Xl.cmp),S}),m=D(null);async function n(){o.value=!0;const S=await C.CampsLoad({idCamp:s.id});o.value=!1,S!==void 0&&(m.value=S)}function d(){if(s.idParticipant===void 0)return;const S=(m.value?.Participants||[]).find(f=>f.Participant.Id==s.idParticipant);S&&(v.value=De(S))}const i=D(null);async function r(){if(i.value==null||m.value==null)return;const S=await C.ParticipantsCreate(i.value);i.value=null,S!==void 0&&(C.showMessage("Participant créé avec succès."),m.value.Participants=(m.value.Participants||[]).concat(S),v.value=De(S))}const v=D(null);async function p(S){if(v.value==null||m.value==null)return;const f=await C.ParticipantsUpdate(S);v.value=null,f!==void 0&&(C.showMessage("Participant modifié avec succès."),n())}const k=D(null);async function x(){if(k.value==null||m.value==null)return;const S=k.value.Participant.Id,f=await C.ParticipantsDelete({id:S});k.value=null,f!==void 0&&(C.showMessage("Participant supprimé avec succès."),m.value.Participants=(m.value.Participants||[]).filter(K=>K.Participant.Id!=S))}const _=D(null);async function P(){const S=_.value;S==null||m.value==null||(_.value=null,await C.ParticipantsMove(S)===void 0)||(C.showMessage("Participant déplacé avec succès.",void 0,{title:"Aller au nouveau séjour",action:()=>Dt({IdCamp:S.Target,Id:S.Id})}),m.value.Participants=(m.value.Participants||[]).filter(K=>K.Participant.Id!=S.Id))}const A=D(null);async function z(){if(A.value==null)return;const S=A.value.Participant.Id;A.value=null;const f=await C.ParticipantsSetPlaceLiberee({id:S});if(f===void 0||(C.showMessage("Notification de place libérée envoyée avec succès."),m.value==null))return;const K=m.value.Participants?.find(ge=>ge.Participant.Id==S);K.Participant=f}const Z=D(!1);return(S,f)=>{const K=Ca,ge=wa,J=it,I=ul,le=xa,ae=st,O=Pa;return m.value!=null?(b(),w(N,{key:0,title:"Participants",subtitle:U(Pe).label(m.value.Camp.Camp)},{append:t(()=>[e(F,{color:"green",onClick:f[0]||(f[0]=j=>i.value={IdCamp:s.id,IdDossier:0,IdPersonne:0})},{prepend:t(()=>[e(pe,null,{default:t(()=>[...f[11]||(f[11]=[y("mdi-plus",-1)])]),_:1})]),default:t(()=>[f[12]||(f[12]=y(" Ajouter un participant",-1))]),_:1}),e(ue,{thickness:"1",class:"mx-1"}),e(F,{icon:"",size:"small",flat:""},{default:t(()=>[e(pe,null,{default:t(()=>[...f[13]||(f[13]=[y("mdi-dots-vertical",-1)])]),_:1}),e(Ie,{activator:"parent"},{default:t(()=>[e(ke,null,{default:t(()=>[e(Y,{"prepend-icon":"mdi-currency-eur",title:"Suivi du règlement",onClick:f[1]||(f[1]=j=>Z.value=!0)})]),_:1})]),_:1})]),_:1})]),default:t(()=>[e(B,{class:"mt-4"},{default:t(()=>[o.value?(b(),w(Qe,{key:0,type:"table"})):(b(),Q("div",vn,[e(K),u.value.length?W("",!0):(b(),Q("div",pn," Aucun participant n'est encore inscrit sur ce séjour. ")),(b(!0),Q(te,null,me(u.value,(j,ie)=>(b(),w(ge,{participant:j,index:ie},{actions:t(()=>[e(ke,{density:"comfortable"},{default:t(()=>[e(Y,{title:"Modifier","prepend-icon":"mdi-pencil",onClick:X=>v.value=j},null,8,["onClick"]),e(ue),e(Y,{title:"Changer de camp...","prepend-icon":"mdi-file-move",onClick:X=>_.value={Id:j.Participant.Id,Target:0}},null,8,["onClick"]),e(Y,{title:"Notifier d'une place disponible.",subtitle:"Envoi un email","prepend-icon":"mdi-email-alert",disabled:j.Participant.Statut==U(tt).Inscrit||j.Participant.Statut==U(tt).EnAttenteReponse,onClick:X=>A.value=j},null,8,["disabled","onClick"]),e(ue),e(Y,{title:"Aller à la personne",subtitle:`(ID : ${j.Personne.Id})`,onClick:X=>U(Ze)(j.Personne.Id)},null,8,["subtitle","onClick"]),e(Y,{title:"Aller au dossier",subtitle:`(ID : ${j.Participant.IdDossier})`,onClick:X=>U(Ct)(j.Participant.IdDossier)},null,8,["subtitle","onClick"]),e(ue),e(Y,{title:"Supprimer","prepend-icon":"mdi-delete",onClick:X=>k.value=j},null,8,["onClick"])]),_:2},1024)]),_:2},1032,["participant","index"]))),256))]))]),_:1}),i.value!=null?(b(),w(ee,{key:0,"model-value":i.value!=null,"onUpdate:modelValue":f[4]||(f[4]=j=>i.value=null),"max-width":"600px"},{default:t(()=>[e(N,{title:"Créer un participant"},{default:t(()=>[e(B,null,{default:t(()=>[e(h,null,{default:t(()=>[e(V,{cols:"12"},{default:t(()=>[e(J,{label:"Participant",modelValue:i.value.IdPersonne,"onUpdate:modelValue":f[2]||(f[2]=j=>i.value.IdPersonne=j),"initial-personne":"",api:{SelectPersonne:U(C).SelectPersonne.bind(U(C))}},null,8,["modelValue","api"])]),_:1}),e(V,{cols:"12"},{default:t(()=>[e(I,{modelValue:i.value.IdDossier,"onUpdate:modelValue":f[3]||(f[3]=j=>i.value.IdDossier=j)},null,8,["modelValue"])]),_:1})]),_:1})]),_:1}),e(re,null,{default:t(()=>[e(oe),e(F,{color:"green",onClick:r,disabled:!(i.value.IdDossier&&i.value.IdPersonne)},{default:t(()=>[...f[14]||(f[14]=[y("Créer",-1)])]),_:1},8,["disabled"])]),_:1})]),_:1})]),_:1},8,["model-value"])):W("",!0),v.value!=null?(b(),w(ee,{key:1,"model-value":v.value!=null,"onUpdate:modelValue":f[5]||(f[5]=j=>v.value=null),"max-width":"800px"},{default:t(()=>[e(le,{participant:v.value.Participant,personne:v.value.Personne,api:{SelectPersonne:U(C).SelectPersonne.bind(U(C))},onSave:p},null,8,["participant","personne","api"])]),_:1},8,["model-value"])):W("",!0),k.value!=null?(b(),w(ee,{key:2,"model-value":k.value!=null,"onUpdate:modelValue":f[6]||(f[6]=j=>k.value=null),"max-width":"600px"},{default:t(()=>[e(N,{title:"Supprimer le participant"},{default:t(()=>[e(B,null,{default:t(()=>[f[15]||(f[15]=y(" Confirmez-vous la suppression du participant ",-1)),E("b",null,M(U(Oe).label(k.value.Personne)),1),f[16]||(f[16]=y(" ? ",-1)),f[17]||(f[17]=E("br",null,null,-1)),f[18]||(f[18]=E("br",null,null,-1)),f[19]||(f[19]=y(" Attention, cette opération est irréversible. ",-1))]),_:1}),e(re,null,{default:t(()=>[e(oe),e(F,{color:"red",onClick:x},{default:t(()=>[...f[20]||(f[20]=[y("Supprimer",-1)])]),_:1})]),_:1})]),_:1})]),_:1},8,["model-value"])):W("",!0),_.value!=null?(b(),w(ee,{key:3,"model-value":_.value!=null,"onUpdate:modelValue":f[8]||(f[8]=j=>_.value=null),"max-width":"500px"},{default:t(()=>[e(N,{title:"Déplacer le participant"},{default:t(()=>[e(B,null,{default:t(()=>[e(ae,{label:"Nouveau séjour",camps:c.value,modelValue:_.value.Target,"onUpdate:modelValue":f[7]||(f[7]=j=>_.value.Target=j)},null,8,["camps","modelValue"])]),_:1}),e(re,null,{default:t(()=>[e(oe),e(F,{onClick:P,disabled:_.value.Target==s.id||!_.value.Target},{default:t(()=>[...f[21]||(f[21]=[y("Déplacer",-1)])]),_:1},8,["disabled"])]),_:1})]),_:1})]),_:1},8,["model-value"])):W("",!0),A.value!=null?(b(),w(ee,{key:4,"model-value":A.value!=null,"onUpdate:modelValue":f[9]||(f[9]=j=>A.value=null),"max-width":"500px"},{default:t(()=>[e(N,{title:"Notifier d'une place disponible"},{default:t(()=>[e(B,null,{default:t(()=>[y(" Confirmez-vous l'envoi d'une notification au responsable de "+M(U(Oe).label(A.value.Personne))+" indiquant qu'une place est disponible ? ",1),f[22]||(f[22]=E("br",null,null,-1)),f[23]||(f[23]=E("br",null,null,-1)),y(" Le nouveau statut de "+M(A.value.Personne.Prenom)+" sera : ",1),E("i",null,M(U(Zl)[U(tt).EnAttenteReponse]),1),f[24]||(f[24]=y(". ",-1))]),_:1}),e(re,null,{default:t(()=>[e(oe),e(F,{onClick:z},{default:t(()=>[...f[25]||(f[25]=[y("Notifier",-1)])]),_:1})]),_:1})]),_:1})]),_:1},8,["model-value"])):W("",!0),e(ee,{modelValue:Z.value,"onUpdate:modelValue":f[10]||(f[10]=j=>Z.value=j),"max-width":"700px"},{default:t(()=>[e(O,{data:m.value},null,8,["data"])]),_:1},8,["modelValue"])]),_:1},8,["subtitle"])):(b(),w(Qe,{key:1,type:"card"}))}}}),yn=G({__name:"camps",setup(l){const s=ut(),o=R(()=>pu(s.currentRoute.value.query)),c=R(()=>o.value.idCamp);function a(m){const n=s.currentRoute.value;s.push({path:n.path,query:{idCamp:m.Camp.Camp.Id}})}function u(){const m=s.currentRoute.value;s.push({path:m.path,query:{}})}return(m,n)=>(b(),Q(te,null,[e(yt,{title:"Gestion des séjours"},{default:t(()=>[c.value!==null?(b(),w(F,{key:0,onClick:u},{prepend:t(()=>[e(pe,null,{default:t(()=>[...n[0]||(n[0]=[y("mdi-view-list",-1)])]),_:1})]),default:t(()=>[n[1]||(n[1]=y(" Retour à la liste",-1))]),_:1})):W("",!0)]),_:1}),c.value===void 0?(b(),w(cn,{key:0,onShowParticipants:a})):(b(),w(fn,{key:1,id:c.value,"id-participant":o.value.idParticipant},null,8,["id","id-participant"]))],64))}}),fl=G({__name:"MergeCard",props:{from:{}},emits:["merge"],setup(l,{emit:s}){const o=l,c=s,a=D(0),u=D(!0);return(m,n)=>{const d=ul;return b(),w(N,{title:"Fusionner le dossier vers",subtitle:"Les participants, paiements et messages seront copiés vers le dossier cible."},{default:t(()=>[e(B,null,{default:t(()=>[e(h,null,{default:t(()=>[e(V,{cols:"12"},{default:t(()=>[e(d,{modelValue:a.value,"onUpdate:modelValue":n[0]||(n[0]=i=>a.value=i)},null,8,["modelValue"])]),_:1}),e(V,{cols:"12"},{default:t(()=>[e(Ye,{density:"compact",label:"Notifier par email",hint:"Le reponsable du dossier absorbé sera averti du changement d'espace personnel.","persistent-hint":"",modelValue:u.value,"onUpdate:modelValue":n[1]||(n[1]=i=>u.value=i)},null,8,["modelValue"])]),_:1})]),_:1})]),_:1}),e(re,null,{default:t(()=>[e(oe),e(F,{disabled:a.value==0||a.value==o.from,onClick:n[2]||(n[2]=i=>c("merge",{From:o.from,To:a.value,Notifie:u.value}))},{default:t(()=>[...n[3]||(n[3]=[y("Fusionner",-1)])]),_:1},8,["disabled"])]),_:1})]),_:1})}}}),bn={key:1,class:"text-center font-italic"},gn={key:2},Vn=G({__name:"PannelInscriptions",emits:["goTo","empty"],setup(l,{emit:s}){const o=s,c=D(!1);Ee(async()=>{await u(),a.value.length||o("empty")});const a=D([]);async function u(){c.value=!0;const _=await C.InscriptionsGet();c.value=!1,_!==void 0&&(a.value=_||[])}const m=D(""),n=R(()=>{const _=al(m.value);return a.value.filter(P=>Oe.match(P.Responsable,_)||P.Participants?.some(A=>Oe.match(A.Personne,_)||Pe.match(A.Camp,_)))});async function d(_,P){const A=await C.InscriptionsIdentifiePersonne({IdDossier:_,Target:P});if(A===void 0)return;C.showMessage("Profil identifié avec succès.");const z=a.value.findIndex(Z=>Z.Dossier.Id==_);a.value[z]=A}const i=D(null);async function r(_,P){if(!i.value)return;const A=i.value.inscription.Dossier.Id;i.value=null;const z=await C.InscriptionsValide({IdDossier:A,Statuts:_,SendMail:P});if(z!==void 0)if(z.Dossier.IsValidated)C.showMessage("Inscription validée avec succès.","",{title:"Aller au dossier",action:()=>o("goTo",A)}),a.value=a.value.filter(Z=>Z.Dossier.Id!=A);else{C.showMessage("Participant validé avec succès.");const Z=a.value.findIndex(S=>S.Dossier.Id==A);a.value[Z]=z}}async function v(_){await C.DossiersDelete({id:_.Dossier.Id})!==void 0&&(C.showMessage("Inscription supprimée avec succès."),a.value=a.value.filter(A=>A.Dossier.Id!=_.Dossier.Id))}async function p(_,P){if(await C.ParticipantsDelete({id:P})===void 0)return;C.showMessage("Participant supprimé avec succès.");const z=a.value.find(Z=>Z.Dossier.Id==_);z.Participants=(z.Participants||[]).filter(Z=>Z.Participant.Id!=P)}const k=D(null);async function x(_){k.value=null,await C.DossiersMerge(_)!==void 0&&(C.showMessage("Inscriptions fusionnées avec succès."),u())}return(_,P)=>{const A=Sa;return b(),w(N,{title:"Inscriptions",subtitle:"En attente de validation",class:"ma-2"},{append:t(()=>[e(ve,{width:"300","append-inner-icon":"mdi-magnify",label:"Rechercher","hide-details":"",modelValue:m.value,"onUpdate:modelValue":P[0]||(P[0]=z=>m.value=z)},null,8,["modelValue"])]),default:t(()=>[e(B,null,{default:t(()=>[c.value?(b(),w(Qe,{key:0})):a.value.length?(b(),Q("div",gn,[(b(!0),Q(te,null,me(n.value,(z,Z)=>(b(),w(Da,{class:"my-1",user:null,key:Z,inscription:z,onIdentifie:S=>d(z.Dossier.Id,S),onValide:S=>i.value={inscription:z,participants:S===void 0?void 0:[S]},onMerge:S=>k.value=z.Dossier.Id,onDelete:S=>v(z),onDeleteParticipant:S=>p(z.Dossier.Id,S),api:{SearchSimilaires:U(C).InscriptionsSearchSimilaires.bind(U(C)),SelectPersonne:U(C).SelectPersonne.bind(U(C))}},null,8,["inscription","onIdentifie","onValide","onMerge","onDelete","onDeleteParticipant","api"]))),128))])):(b(),Q("div",bn," Il n'y a aucune inscription à valider. "))]),_:1}),e(ee,{"model-value":k.value!=null,"onUpdate:modelValue":P[1]||(P[1]=z=>k.value=null),"max-width":"600px"},{default:t(()=>[k.value!=null?(b(),w(fl,{key:0,from:k.value,onMerge:x},null,8,["from"])):W("",!0)]),_:1},8,["model-value"]),e(ee,{"model-value":i.value!=null,"onUpdate:modelValue":P[2]||(P[2]=z=>i.value=null),"max-width":"800px"},{default:t(()=>[i.value?(b(),w(A,{key:0,inscription:i.value.inscription,"id-participants":i.value.participants,onValide:r},null,8,["inscription","id-participants"])):W("",!0)]),_:1},8,["model-value"])]),_:1})}}}),kn={class:"text-grey"},_n={class:"text-grey"},Cn={key:0},xn=G({__name:"FactureCard",props:{dossier:{}},setup(l){const s=l,o=R(()=>(s.dossier.Participants||[]).filter(n=>n.Participant.Statut!=tt.Inscrit).map(n=>Oe.label(n.Personne))),c=R(()=>(s.dossier.Participants||[]).filter(n=>n.Participant.Statut==tt.Inscrit).map(n=>({Label:Oe.label(n.Personne),Camp:Pe.label(n.Camp),Prix:xe.montant(n.Camp.Prix),Bilan:s.dossier.Bilan.Inscrits[n.Participant.Id]})));function a(n){return!!(n.Remises.ReducInscrits||n.Remises.ReducEquipiers||n.Remises.ReducSpeciale.Cent)}function u(n){const d=[];return n.ReducInscrits&&d.push(`Enfants : ${n.ReducInscrits}%`),n.ReducEquipiers&&d.push(`Enfants : ${n.ReducEquipiers}%`),n.ReducSpeciale.Cent&&d.push(`Remise : ${xe.montant(n.ReducSpeciale)}`),d.join("  ;  ")}const m=R(()=>{const n=Object.values(s.dossier.Paiements||{});return n.sort((d,i)=>new Date(d.Time).valueOf()-new Date(i.Time).valueOf()),n});return(n,d)=>(b(),w(N,{title:"Suivi financier",subtitle:o.value.length?`Les participants en liste d'attente (${o.value.join(", ")}) ne sont pas pris en compte.`:"","min-width":"900px"},{default:t(()=>[e(B,null,{default:t(()=>[e(h,null,{default:t(()=>[e(V,{cols:"3"},{default:t(()=>[...d[0]||(d[0]=[y("Participant",-1)])]),_:1}),e(V,{cols:"2",class:"text-center"},{default:t(()=>[...d[1]||(d[1]=[y("Prix du séjour",-1)])]),_:1}),e(V,{cols:"2",class:"text-center"},{default:t(()=>[...d[2]||(d[2]=[y("Prix avec option",-1)])]),_:1}),e(V,{cols:"3",class:"text-center"},{default:t(()=>[...d[3]||(d[3]=[y("Aides extérieures",-1)])]),_:1}),e(V,{cols:"2",class:"text-right"},{default:t(()=>[...d[4]||(d[4]=[y("Sous-total",-1)])]),_:1})]),_:1}),e(ue,{thickness:"1",class:"my-2"}),(b(!0),Q(te,null,me(c.value,i=>(b(),Q(te,null,[e(h,null,{default:t(()=>[e(V,{"align-self":"center",cols:"3"},{default:t(()=>[y(M(i.Label)+" ",1),d[5]||(d[5]=E("br",null,null,-1)),E("span",kn,M(i.Camp),1)]),_:2},1024),e(V,{"align-self":"center",cols:"2",class:"text-center"},{default:t(()=>[y(M(i.Prix),1)]),_:2},1024),e(V,{"align-self":"center",cols:"2",class:"text-center"},{default:t(()=>[y(M(U(xe).montant(i.Bilan.AvecOption))+" ",1),d[6]||(d[6]=E("br",null,null,-1)),E("span",_n,M(i.Bilan.AvecOptionDescription),1)]),_:2},1024),e(V,{"align-self":"center",cols:"3",class:"text-center"},{default:t(()=>[i.Bilan.Aides?.length?W("",!0):(b(),Q("span",Cn,"-")),(b(!0),Q(te,null,me(i.Bilan.Aides,r=>(b(),w(be,null,{default:t(()=>[y(M(r.Structure)+" : "+M(U(xe).montant(r.Montant)),1)]),_:2},1024))),256))]),_:2},1024),e(V,{"align-self":"center",cols:"2",class:"text-right"},{default:t(()=>[y(M(i.Bilan.AvecAides),1)]),_:2},1024)]),_:2},1024),a(i.Bilan)?(b(),w(h,{key:0,"no-gutters":""},{default:t(()=>[e(V,{cols:"10",class:"text-right"},{default:t(()=>[E("i",null,M(u(i.Bilan.Remises)),1)]),_:2},1024),e(V,{cols:"2",class:"text-right"},{default:t(()=>[y(M(i.Bilan.Net),1)]),_:2},1024)]),_:2},1024)):W("",!0)],64))),256)),e(ue,{thickness:"1",class:"my-2"}),e(h,null,{default:t(()=>[e(V,{cols:"10",class:"text-right"},{default:t(()=>[...d[7]||(d[7]=[y("Total demandé",-1)])]),_:1}),e(V,{cols:"2",class:"text-right"},{default:t(()=>[y(M(s.dossier.Bilan.Demande),1)]),_:1})]),_:1}),e(ue,{thickness:"1",class:"my-2"}),(b(!0),Q(te,null,me(m.value,i=>(b(),w(h,null,{default:t(()=>[e(V,null,{default:t(()=>[y(" Paiement de "+M(i.Payeur)+", le "+M(U(xe).date(i.Time)),1)]),_:2},1024),e(V,{cols:"2",class:"text-right"},{default:t(()=>[y(M(i.IsRemboursement?"+":"-")+M(U(xe).montant(i.Montant)),1)]),_:2},1024)]),_:2},1024))),256)),e(h,null,{default:t(()=>[e(V,{cols:"10",class:"text-right"},{default:t(()=>[...d[8]||(d[8]=[y("Solde",-1)])]),_:1}),e(V,{cols:"2",class:"text-right"},{default:t(()=>[E("b",null,M(s.dossier.Bilan.Restant),1)]),_:1})]),_:1})]),_:1})]),_:1},8,["subtitle"]))}});function qe(l){let s=arguments.length>1&&arguments[1]!==void 0?arguments[1]:2;return String(l).padStart(s,"0")}const Pn=Re({allowedValues:Function,ampm:Boolean,color:String,disabled:Boolean,displayedValue:null,double:Boolean,format:{type:Function,default:l=>l},max:{type:Number,required:!0},min:{type:Number,required:!0},scrollable:Boolean,readonly:Boolean,rotate:{type:Number,default:0},step:{type:Number,default:1},modelValue:{type:Number}},"VTimePickerClock"),Wt=Le()({name:"VTimePickerClock",props:Pn(),emits:{change:l=>!0,input:l=>!0},setup(l,s){let{emit:o}=s;const c=D(null),a=D(null),u=D(void 0),m=D(!1),n=D(null),d=D(null),i=ea(g=>o("change",g),750),{textColorClasses:r,textColorStyles:v}=ta(()=>l.color),{backgroundColorClasses:p,backgroundColorStyles:k}=Gt(()=>l.color),x=R(()=>l.max-l.min+1),_=R(()=>l.double?x.value/2:x.value),P=R(()=>360/_.value),A=R(()=>P.value*Math.PI/180),z=R(()=>l.modelValue==null?l.min:l.modelValue),Z=R(()=>.62),S=R(()=>{const g=[];for(let T=l.min;T<=l.max;T=T+l.step)g.push(T);return g});$e(()=>l.modelValue,g=>{u.value=g});function f(g){u.value!==g&&(u.value=g),o("input",g)}function K(g){return!l.allowedValues||l.allowedValues(g)}function ge(g){if(!l.scrollable||l.disabled)return;g.preventDefault();const T=Math.sign(-g.deltaY||1);let L=z.value;do L=L+T,L=(L-l.min+x.value)%x.value+l.min;while(!K(L)&&L!==z.value);L!==l.displayedValue&&f(L),i(L)}function J(g){return l.double&&g-l.min>=_.value}function I(g){return J(g)?Z.value:1}function le(g){const T=l.rotate*Math.PI/180;return{x:Math.sin((g-l.min)*A.value+T)*I(g),y:-Math.cos((g-l.min)*A.value+T)*I(g)}}function ae(g,T){const L=(Math.round(g/P.value)+(T?_.value:0))%x.value+l.min;return g<360-P.value/2?L:T?l.max-_.value+1:l.min}function O(g){const{x:T,y:L}=le(g);return{left:`${Math.round(50+T*50)}%`,top:`${Math.round(50+L*50)}%`}}function j(g,T){const L=T.x-g.x,ye=T.y-g.y;return Math.sqrt(L*L+ye*ye)}function ie(g,T){const L=2*Math.atan2(T.y-g.y-j(g,T),T.x-g.x);return Math.abs(L*180/Math.PI)}function X(g){n.value===null&&(n.value=g),d.value=g,f(g)}function fe(g){if(g.preventDefault(),!m.value&&g.type!=="click"||!c.value)return;const{width:T,top:L,left:ye}=c.value?.getBoundingClientRect(),{width:ne}=a.value?.getBoundingClientRect()??{width:0},{clientX:Ae,clientY:_e}="touches"in g?g.touches[0]:g,q={x:T/2,y:-T/2},H={x:Ae-ye,y:L-_e},de=Math.round(ie(q,H)-l.rotate+360)%360,ce=l.double&&j(q,H)<(ne+ne*Z.value)/4,gl=Math.ceil(15/P.value);let ze;for(let ot=0;ot<gl;ot++)if(ze=ae(de+ot*P.value,ce),K(ze)||(ze=ae(de-ot*P.value,ce),K(ze)))return X(ze)}function Ve(g){l.disabled||(g.preventDefault(),window.addEventListener("mousemove",fe),window.addEventListener("touchmove",fe),window.addEventListener("mouseup",$),window.addEventListener("touchend",$),n.value=null,d.value=null,m.value=!0,fe(g))}function $(g){g.stopPropagation(),window.removeEventListener("mousemove",fe),window.removeEventListener("touchmove",fe),window.removeEventListener("mouseup",$),window.removeEventListener("touchend",$),m.value=!1,d.value!==null&&K(d.value)&&o("change",d.value)}he(()=>E("div",{class:Ce([{"v-time-picker-clock":!0,"v-time-picker-clock--indeterminate":l.modelValue==null,"v-time-picker-clock--readonly":l.readonly}]),onMousedown:Ve,onTouchstart:Ve,onWheel:ge,ref:c},[E("div",{class:"v-time-picker-clock__inner",ref:a},[E("div",{class:Ce([{"v-time-picker-clock__hand":!0,"v-time-picker-clock__hand--inner":J(l.modelValue)},r.value]),style:at([{transform:`rotate(${l.rotate+P.value*(z.value-l.min)}deg) scaleY(${I(z.value)})`},v.value])},null),S.value.map(g=>{const T=g===z.value;return E("div",{class:Ce([{"v-time-picker-clock__item":!0,"v-time-picker-clock__item--active":T,"v-time-picker-clock__item--disabled":l.disabled||!K(g)},T&&p.value]),style:at([O(g),T&&k.value])},[E("span",null,[l.format(g)])])})])]))}}),wn=Re({ampm:Boolean,color:String,disabled:Boolean,hour:Number,minute:Number,second:Number,period:String,readonly:Boolean,useSeconds:Boolean,value:Number,viewMode:String},"VTimePickerControls"),Jt=Le()({name:"VTimePickerControls",props:wn(),emits:{"update:period":l=>!0,"update:viewMode":l=>!0},setup(l,s){let{emit:o,slots:c}=s;const{t:a}=We();return he(()=>{let u=l.hour;return l.ampm&&(u=u?(u-1)%12+1:12),E("div",{class:"v-time-picker-controls"},[E("div",{class:Ce({"v-time-picker-controls__time":!0,"v-time-picker-controls__time--with-seconds":l.useSeconds})},[e(F,{active:l.viewMode==="hour",color:l.viewMode==="hour"?l.color:void 0,disabled:l.disabled,variant:"tonal",class:Ce({"v-time-picker-controls__time__btn":!0,"v-time-picker-controls__time--with-ampm__btn":l.ampm,"v-time-picker-controls__time--with-seconds__btn":l.useSeconds}),text:l.hour==null?"--":qe(`${u}`),onClick:()=>o("update:viewMode","hour")},null),E("span",{class:Ce(["v-time-picker-controls__time__separator",{"v-time-picker-controls--with-seconds__time__separator":l.useSeconds}])},[y(":")]),e(F,{active:l.viewMode==="minute",color:l.viewMode==="minute"?l.color:void 0,class:Ce({"v-time-picker-controls__time__btn":!0,"v-time-picker-controls__time__btn__active":l.viewMode==="minute","v-time-picker-controls__time--with-ampm__btn":l.ampm,"v-time-picker-controls__time--with-seconds__btn":l.useSeconds}),disabled:l.disabled,variant:"tonal",text:l.minute==null?"--":qe(l.minute),onClick:()=>o("update:viewMode","minute")},null),l.useSeconds&&E("span",{class:Ce(["v-time-picker-controls__time__separator",{"v-time-picker-controls--with-seconds__time__separator":l.useSeconds}]),key:"secondsDivider"},[y(":")]),l.useSeconds&&e(F,{key:"secondsVal",active:l.viewMode==="second",color:l.viewMode==="second"?l.color:void 0,variant:"tonal",onClick:()=>o("update:viewMode","second"),class:Ce({"v-time-picker-controls__time__btn":!0,"v-time-picker-controls__time__btn__active":l.viewMode==="second","v-time-picker-controls__time--with-seconds__btn":l.useSeconds}),disabled:l.disabled,text:l.second==null?"--":qe(l.second)},null),l.ampm&&E("div",{class:"v-time-picker-controls__ampm"},[e(F,{active:l.period==="am",color:l.period==="am"?l.color:void 0,class:Ce({"v-time-picker-controls__ampm__am":!0,"v-time-picker-controls__ampm__btn":!0,"v-time-picker-controls__ampm__btn__active":l.period==="am"}),disabled:l.disabled,text:a("$vuetify.timePicker.am"),variant:l.disabled&&l.period==="am"?"elevated":"tonal",onClick:()=>l.period!=="am"?o("update:period","am"):null},null),e(F,{active:l.period==="pm",color:l.period==="pm"?l.color:void 0,class:Ce({"v-time-picker-controls__ampm__pm":!0,"v-time-picker-controls__ampm__btn":!0,"v-time-picker-controls__ampm__btn__active":l.period==="pm"}),disabled:l.disabled,text:a("$vuetify.timePicker.pm"),variant:l.disabled&&l.period==="pm"?"elevated":"tonal",onClick:()=>l.period!=="pm"?o("update:period","pm"):null},null)])])])}),{}}}),Dn=Te(24),yl=Te(12),Sn=yl.map(l=>l+12);Te(60);const In=Re({allowedHours:[Function,Array],allowedMinutes:[Function,Array],allowedSeconds:[Function,Array],disabled:Boolean,format:{type:String,default:"ampm"},max:String,min:String,viewMode:{type:String,default:"hour"},period:{type:String,default:"am",validator:l=>["am","pm"].includes(l)},modelValue:null,readonly:Boolean,scrollable:Boolean,useSeconds:Boolean,...He(nl({title:"$vuetify.timePicker.title"}),["landscape"])},"VTimePicker"),An=Le()({name:"VTimePicker",props:In(),emits:{"update:hour":l=>!0,"update:minute":l=>!0,"update:period":l=>!0,"update:second":l=>!0,"update:modelValue":l=>!0,"update:viewMode":l=>!0},setup(l,s){let{emit:o,slots:c}=s;const{t:a}=We(),u=D(null),m=D(null),n=D(null),d=D(null),i=D(null),r=D(null),v=Ue(l,"period","am"),p=Ue(l,"viewMode","hour"),k=D(null),x=D(null),_=R(()=>{let O;if(l.allowedHours instanceof Array?O=X=>l.allowedHours.includes(X):O=l.allowedHours,!l.min&&!l.max)return O;const j=l.min?Number(l.min.split(":")[0]):0,ie=l.max?Number(l.max.split(":")[0]):23;return X=>X>=Number(j)&&X<=Number(ie)&&(!O||O(X))}),P=R(()=>{let O;const j=!_.value||u.value===null||_.value(u.value);if(l.allowedMinutes instanceof Array?O=T=>l.allowedMinutes.includes(T):O=l.allowedMinutes,!l.min&&!l.max)return j?O:()=>!1;const[ie,X]=l.min?l.min.split(":").map(Number):[0,0],[fe,Ve]=l.max?l.max.split(":").map(Number):[23,59],$=ie*60+Number(X),g=fe*60+Number(Ve);return T=>{const L=60*u.value+T;return L>=$&&L<=g&&j&&(!O||O(T))}}),A=R(()=>{let O;const ie=(!_.value||u.value===null||_.value(u.value))&&(!P.value||m.value===null||P.value(m.value));if(l.allowedSeconds instanceof Array?O=ne=>l.allowedSeconds.includes(ne):O=l.allowedSeconds,!l.min&&!l.max)return ie?O:()=>!1;const[X,fe,Ve]=l.min?l.min.split(":").map(Number):[0,0,0],[$,g,T]=l.max?l.max.split(":").map(Number):[23,59,59],L=X*3600+fe*60+Number(Ve||0),ye=$*3600+g*60+Number(T||0);return ne=>{const Ae=3600*u.value+60*m.value+ne;return Ae>=L&&Ae<=ye&&ie&&(!O||O(ne))}}),z=R(()=>l.format==="ampm");$e(()=>l.period,O=>I(O)),$e(()=>l.modelValue,O=>ge(O)),Ee(()=>{ge(l.modelValue)});function Z(){return u.value!=null&&m.value!=null&&(!l.useSeconds||n.value!=null)?`${qe(u.value)}:${qe(m.value)}`+(l.useSeconds?`:${qe(n.value)}`:""):null}function S(){const O=Z();O!==null&&o("update:modelValue",O)}function f(O){return O?(O-1)%12+1:12}function K(O,j){return O%12+(j==="pm"?12:0)}function ge(O){if(O==null||O==="")u.value=null,m.value=null,n.value=null;else if(O instanceof Date)u.value=O.getHours(),m.value=O.getMinutes(),n.value=O.getSeconds();else{const[j,,ie,,X,fe]=O.trim().toLowerCase().match(/^(\d+):(\d+)(:(\d+))?([ap]m)?$/)||new Array(6);u.value=fe?K(parseInt(j,10),fe):parseInt(j,10),m.value=parseInt(ie,10),n.value=parseInt(X||0,10)}v.value=u.value==null||u.value<12?"am":"pm"}function J(O,j){const ie=_.value;if(!ie)return j;const X=z.value?j<12?yl:Sn:Dn;return((X.find(Ve=>ie((Ve+j)%X.length+X[0]))||0)+j)%X.length+X[0]}function I(O){if(v.value=O,u.value!=null){const j=u.value+(v.value==="am"?-12:12);u.value=J("hour",j)}return o("update:period",O),S(),!0}function le(O){p.value==="hour"?u.value=z.value?K(O,v.value):O:p.value==="minute"?m.value=O:n.value=O}function ae(O){switch(p.value||"hour"){case"hour":o("update:hour",O);break;case"minute":o("update:minute",O);break;case"second":o("update:second",O);break}const j=u.value!==null&&m.value!==null&&(l.useSeconds?n.value!==null:!0);p.value==="hour"?p.value="minute":l.useSeconds&&p.value==="minute"&&(p.value="second"),!(u.value===d.value&&m.value===i.value&&(!l.useSeconds||n.value===r.value)||Z()===null)&&(d.value=u.value,i.value=m.value,l.useSeconds&&(r.value=n.value),j&&S())}he(()=>{const O=ct.filterProps(l),j=Jt.filterProps(l),ie=Wt.filterProps(He(l,["format","modelValue","min","max"]));return e(ct,se(O,{color:void 0,class:["v-time-picker",l.class],style:l.style}),{title:()=>c.title?.()??E("div",{class:"v-time-picker__title"},[a(l.title)]),header:()=>e(Jt,se(j,{ampm:z.value,hour:u.value,minute:m.value,period:v.value,second:n.value,viewMode:p.value,"onUpdate:period":X=>I(X),"onUpdate:viewMode":X=>p.value=X,ref:k}),null),default:()=>e(Wt,se(ie,{allowedValues:p.value==="hour"?_.value:p.value==="minute"?P.value:A.value,double:p.value==="hour"&&!z.value,format:p.value==="hour"?z.value?f:X=>X:X=>qe(X,2),max:p.value==="hour"?z.value&&v.value==="am"?11:23:59,min:p.value==="hour"&&z.value&&v.value==="pm"?12:0,size:20,step:p.value==="hour"?1:5,modelValue:p.value==="hour"?u.value:p.value==="minute"?m.value:n.value,onChange:ae,onInput:le,ref:x}),null),actions:c.actions})})}}),Mn=G({__name:"TimeField",props:Se({hideDetails:{type:Boolean},readonly:{type:Boolean}},{modelValue:{required:!0},modelModifiers:{}}),emits:["update:modelValue"],setup(l){const s=l,o=we(l,"modelValue"),c=R(()=>new Date(o.value).toLocaleTimeString(void 0,{hour:"numeric",minute:"numeric"}));function a(n){const[d,i]=n.split(":"),r=new Date(o.value);r.setHours(Number(d),Number(i)),o.value=r.toISOString()}function u(n){const d=new Date(n),i=new Date(o.value);d.setHours(i.getHours(),i.getMinutes(),i.getSeconds()),o.value=d.toISOString()}const m=D(!1);return(n,d)=>{const i=pl;return b(),w(h,{"no-gutters":""},{default:t(()=>[e(V,null,{default:t(()=>[e(i,{class:"mr-2",label:"Date","model-value":U(tl)(new Date(o.value)),"onUpdate:modelValue":u,"hide-details":s.hideDetails,readonly:s.readonly},null,8,["model-value","hide-details","readonly"])]),_:1}),e(V,{cols:"auto"},{default:t(()=>[...d[1]||(d[1]=[E("div",{class:"ma-2"},null,-1)])]),_:1}),e(V,null,{default:t(()=>[e(Ie,{"close-on-content-click":!1,modelValue:m.value,"onUpdate:modelValue":d[0]||(d[0]=r=>m.value=r)},{activator:t(({props:r})=>[e(ve,se({class:"center-text"},r,{variant:"outlined",density:"compact","hide-details":s.hideDetails,label:"Moment","model-value":c.value}),null,16,["hide-details","model-value"])]),default:t(()=>[e(An,{"model-value":new Date(o.value),"onUpdate:modelValue":a,format:"24hr"},null,8,["model-value"])]),_:1},8,["modelValue"])]),_:1})]),_:1})}}}),$n=Pt(Mn,[["__scopeId","data-v-32955f86"]]),Un=G({__name:"ModePaiementField",props:Se({hideDetails:{type:Boolean},readonly:{type:Boolean},rules:{}},{modelValue:{required:!0},modelModifiers:{}}),emits:["update:modelValue"],setup(l){const s=l,o=we(l,"modelValue"),c=nt(la);return(a,u)=>(b(),w(Ne,{label:"Mode de paiement",variant:"outlined",density:"compact",items:U(c),readonly:s.readonly,"hide-details":s.hideDetails,modelValue:o.value,"onUpdate:modelValue":u[0]||(u[0]=m=>o.value=m),rules:s.rules},null,8,["items","readonly","hide-details","modelValue","rules"]))}}),Rn=G({__name:"PaiementEditCard",props:{paiement:{}},emits:["update","delete"],setup(l,{emit:s}){const o=l,c=s,a=D(De(o.paiement)),u=R(()=>!0),m=D(!1);return(n,d)=>{const i=Un,r=Ke,v=$n;return b(),w(N,{title:"Modifier le paiement"},{default:t(()=>[e(ee,{modelValue:m.value,"onUpdate:modelValue":d[1]||(d[1]=p=>m.value=p),"max-width":"400px"},{default:t(()=>[e(N,{title:"Confirmation"},{default:t(()=>[e(B,null,{default:t(()=>[...d[11]||(d[11]=[y(" Confirmez-vous la suppression de ce paiement ? ",-1),E("br",null,null,-1),E("br",null,null,-1),y(" Attention, cette opération est irréversible. ",-1)])]),_:1}),e(re,null,{default:t(()=>[e(oe),e(F,{color:"red",onClick:d[0]||(d[0]=p=>{m.value=!1,c("delete")})},{default:t(()=>[...d[12]||(d[12]=[y("Supprimer",-1)])]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"]),e(B,null,{default:t(()=>[e(h,null,{default:t(()=>[e(V,null,{default:t(()=>[e(ve,{density:"compact",variant:"outlined","hide-details":"",label:"Payé par",modelValue:a.value.Payeur,"onUpdate:modelValue":d[2]||(d[2]=p=>a.value.Payeur=p)},null,8,["modelValue"])]),_:1}),e(V,null,{default:t(()=>[e(ve,{density:"compact",variant:"outlined","hide-details":"",label:"Description (optionelle)",modelValue:a.value.Label,"onUpdate:modelValue":d[3]||(d[3]=p=>a.value.Label=p)},null,8,["modelValue"])]),_:1})]),_:1}),e(h,null,{default:t(()=>[e(V,null,{default:t(()=>[e(i,{modelValue:a.value.Mode,"onUpdate:modelValue":d[4]||(d[4]=p=>a.value.Mode=p),"hide-details":""},null,8,["modelValue"])]),_:1}),e(V,null,{default:t(()=>[e(r,{label:"Montant",modelValue:a.value.Montant,"onUpdate:modelValue":d[5]||(d[5]=p=>a.value.Montant=p),"hide-details":""},null,8,["modelValue"])]),_:1})]),_:1}),e(h,null,{default:t(()=>[e(V,null,{default:t(()=>[e(Ye,{"hide-details":"",density:"compact",label:"Remboursement ?",modelValue:a.value.IsRemboursement,"onUpdate:modelValue":d[6]||(d[6]=p=>a.value.IsRemboursement=p)},null,8,["modelValue"])]),_:1})]),_:1}),e(h,null,{default:t(()=>[e(V,null,{default:t(()=>[e(v,{modelValue:a.value.Time,"onUpdate:modelValue":d[7]||(d[7]=p=>a.value.Time=p),"hide-details":""},null,8,["modelValue"])]),_:1})]),_:1}),e(h,null,{default:t(()=>[e(V,null,{default:t(()=>[e(ve,{density:"compact",variant:"outlined",label:"Détails (optionnel)",modelValue:a.value.Details,"onUpdate:modelValue":d[8]||(d[8]=p=>a.value.Details=p)},null,8,["modelValue"])]),_:1})]),_:1})]),_:1}),e(re,null,{default:t(()=>[e(F,{color:"red",onClick:d[9]||(d[9]=p=>m.value=!0)},{default:t(()=>[...d[13]||(d[13]=[y("Supprimer le paiement",-1)])]),_:1}),e(oe),e(F,{onClick:d[10]||(d[10]=p=>c("update",a.value)),disabled:!u.value},{default:t(()=>[...d[14]||(d[14]=[y("Enregistrer",-1)])]),_:1},8,["disabled"])]),_:1})]),_:1})}}}),Fn=G({__name:"DossierEditCard",props:{responsable:{},dossier:{}},emits:["save"],setup(l,{emit:s}){const o=l,c=s,a=D(De(o.dossier));return(u,m)=>{const n=it,d=ha,i=wt;return b(),w(N,null,{default:t(()=>[e(B,null,{default:t(()=>[e(h,null,{default:t(()=>[e(V,null,{default:t(()=>[e(n,{label:"Responsable","initial-personne":o.responsable,"model-value":a.value.IdResponsable,"onUpdate:modelValue":m[0]||(m[0]=r=>r?a.value.IdResponsable=r:void 0),api:{SelectPersonne:U(C).SelectPersonne.bind(U(C))}},null,8,["initial-personne","model-value","api"])]),_:1})]),_:1}),e(h,null,{default:t(()=>[e(V,null,{default:t(()=>[e(d,{label:"Adresses mail en copie",modelValue:a.value.CopiesMails,"onUpdate:modelValue":m[1]||(m[1]=r=>a.value.CopiesMails=r),rule:U(aa).validMails()},null,8,["modelValue","rule"])]),_:1})]),_:1}),e(h,null,{default:t(()=>[e(V,null,{default:t(()=>[e(i,{"hide-details":"",modelValue:a.value.PartageAdressesOK,"onUpdate:modelValue":m[2]||(m[2]=r=>a.value.PartageAdressesOK=r),label:"Partage des coordonnées"},null,8,["modelValue"])]),_:1})]),_:1}),e(h,null,{default:t(()=>[e(V,null,{default:t(()=>[e(i,{"hide-details":"",modelValue:a.value.DemandeFondSoutien,"onUpdate:modelValue":m[3]||(m[3]=r=>a.value.DemandeFondSoutien=r),label:"Demande le fonds de soutien"},null,8,["modelValue"])]),_:1})]),_:1})]),_:1}),e(re,null,{default:t(()=>[e(oe),e(F,{onClick:m[4]||(m[4]=r=>c("save",a.value))},{default:t(()=>[...m[5]||(m[5]=[y("Enregistrer",-1)])]),_:1})]),_:1})]),_:1})}}}),Ln=G({__name:"OptionJournee",props:Se({camp:{}},{modelValue:{required:!0},modelModifiers:{}}),emits:["update:modelValue"],setup(l){const s=l,o=we(l,"modelValue"),c=R(()=>(s.camp.OptionPrix.Jours||[]).map((a,u)=>u));return(a,u)=>(b(),w(N,null,{default:t(()=>[e(B,null,{default:t(()=>[u[1]||(u[1]=E("div",{class:"text-grey mb-2"}," Le prix est variable en fonction des jours de participation au camp. ",-1)),e(na,{class:"overflow-x-auto",color:"secondary",multiple:"","model-value":o.value?.length?o.value:c.value,"onUpdate:modelValue":u[0]||(u[0]=m=>o.value=m.length==c.value.length?[]:m)},{default:t(()=>[(b(!0),Q(te,null,me(s.camp.OptionPrix.Jours,(m,n)=>(b(),w(F,null,{default:t(()=>[y("J "+M(n+1),1)]),_:2},1024))),256))]),_:1},8,["model-value"])]),_:1})]),_:1}))}}),hn=G({__name:"OptionStatut",props:Se({camp:{}},{modelValue:{required:!0},modelModifiers:{}}),emits:["update:modelValue"],setup(l){const s=l,o=we(l,"modelValue"),c=R(()=>(s.camp.OptionPrix.Statuts||[]).map(u=>({value:u.Id,title:u.Label,subtitle:u.Description}))),a=R(()=>c.value.map(u=>u.value).includes(o.value));return(u,m)=>(b(),w(N,null,{default:t(()=>[e(B,null,{default:t(()=>[m[1]||(m[1]=E("div",{class:"text-grey mb-4"},"Le prix dépend du statut du participant.",-1)),e(Ne,{clearable:"",items:c.value,label:"Statut","model-value":a.value?o.value:null,"onUpdate:modelValue":m[0]||(m[0]=n=>o.value=n??0),variant:"outlined",density:"comfortable","hide-details":""},{item:t(({item:n,props:d})=>[e(Y,se(d,{title:n.title,subtitle:n.raw.subtitle}),null,16,["title","subtitle"])]),_:1},8,["items","model-value"])]),_:1})]),_:1}))}}),En={key:2},Tn=G({__name:"ParticipantOptionPrix",props:{camp:{},optionAndQf:{}},emits:["update"],setup(l,{emit:s}){const o=l,c=s,a=D(De(o.optionAndQf));return $e(()=>o.optionAndQf,()=>a.value=De(o.optionAndQf)),(u,m)=>{const n=Ge;return b(),w(N,{title:"Prix variable",width:"800px"},{default:t(()=>[e(B,null,{default:t(()=>[e(h,{justify:"space-evenly"},{default:t(()=>[e(V,{"align-self":"center",cols:"3"},{default:t(()=>[e(n,{modelValue:a.value.quotientFamilial,"onUpdate:modelValue":m[0]||(m[0]=d=>a.value.quotientFamilial=d),label:"Quotient familial","hide-details":""},null,8,["modelValue"])]),_:1}),e(ue,{thickness:"2",vertical:""}),e(V,{"align-self":"center",cols:"8"},{default:t(()=>[o.camp.OptionPrix.Active==U(Me).PrixJour?(b(),w(Ln,{key:0,camp:o.camp,modelValue:a.value.options.Jour,"onUpdate:modelValue":m[1]||(m[1]=d=>a.value.options.Jour=d)},null,8,["camp","modelValue"])):o.camp.OptionPrix.Active==U(Me).PrixStatut?(b(),w(hn,{key:1,camp:o.camp,modelValue:a.value.options.IdStatut,"onUpdate:modelValue":m[2]||(m[2]=d=>a.value.options.IdStatut=d)},null,8,["camp","modelValue"])):(b(),Q("div",En,"Le camp ne propose pas d'option sur le prix."))]),_:1})]),_:1})]),_:1}),e(re,null,{default:t(()=>[e(oe),e(F,{onClick:m[3]||(m[3]=d=>c("update",a.value))},{default:t(()=>[...m[4]||(m[4]=[y("Enregistrer",-1)])]),_:1})]),_:1})]),_:1})}}}),On={key:1,class:"mx-1"},Nn={key:2,class:"mx-1"},Bn={key:3},jn={key:4,class:"mx-1"},qn=G({__name:"RemisesChip",props:{remises:{}},emits:["update"],setup(l,{emit:s}){const o=l,c=s,a=R(()=>u.value.ReducInscrits!=0||u.value.ReducEquipiers!=0||u.value.ReducSpeciale.Cent!=0),u=D(De(o.remises));$e(()=>o.remises,()=>u.value=De(o.remises));const m=D(!1);return(n,d)=>{const i=Ge,r=Ke;return b(),w(Ie,{"close-on-content-click":!1,location:"bottom",modelValue:m.value,"onUpdate:modelValue":d[4]||(d[4]=v=>m.value=v)},{activator:t(({props:v})=>[e(N,se(v,{elevation:"1",color:"grey-lighten-2"}),{default:t(()=>[e(B,{class:"py-1 px-1"},{default:t(()=>[a.value?W("",!0):(b(),Q(te,{key:0},[y(" Pas de remises ")],64)),u.value.ReducInscrits?(b(),Q("span",On," Inscrits : "+M(u.value.ReducInscrits)+"% ",1)):W("",!0),u.value.ReducEquipiers?(b(),Q("span",Nn," Equipiers : "+M(u.value.ReducEquipiers)+"% ",1)):W("",!0),(u.value.ReducInscrits||u.value.ReducEquipiers)&&u.value.ReducSpeciale.Cent?(b(),Q("br",Bn)):W("",!0),u.value.ReducSpeciale.Cent?(b(),Q("span",jn," Remise : "+M(U(xe).montant(u.value.ReducSpeciale)),1)):W("",!0)]),_:1})]),_:1},16)]),default:t(()=>[e(N,{title:"Modifier les remises",width:"400px"},{default:t(()=>[e(B,null,{default:t(()=>[e(h,null,{default:t(()=>[e(V,null,{default:t(()=>[e(i,{modelValue:u.value.ReducInscrits,"onUpdate:modelValue":d[0]||(d[0]=v=>u.value.ReducInscrits=v),label:"Remise inscrits","hide-details":"",suffix:"%"},null,8,["modelValue"])]),_:1}),e(V,null,{default:t(()=>[e(i,{modelValue:u.value.ReducEquipiers,"onUpdate:modelValue":d[1]||(d[1]=v=>u.value.ReducEquipiers=v),label:"Remise équipiers","hide-details":"",suffix:"%"},null,8,["modelValue"])]),_:1})]),_:1}),e(h,null,{default:t(()=>[e(V,null,{default:t(()=>[e(r,{class:"mt-2",modelValue:u.value.ReducSpeciale,"onUpdate:modelValue":d[2]||(d[2]=v=>u.value.ReducSpeciale=v),label:"Remise spéciale","hide-details":""},null,8,["modelValue"])]),_:1})]),_:1})]),_:1}),e(re,null,{default:t(()=>[e(oe),e(F,{onClick:d[3]||(d[3]=v=>{c("update",u.value),m.value=!1})},{default:t(()=>[...d[5]||(d[5]=[y("Enregistrer",-1)])]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"])}}}),Hn=Pt(qn,[["__scopeId","data-v-cc911118"]]),Yn=G({__name:"AideEditCard",props:{aide:{},file:{},structures:{},participant:{}},emits:["save","deleteFile","uploadFile","showStructureaides"],setup(l,{emit:s}){const o=l,c=s,a=D(De(o.aide)),u=R(()=>Object.values(o.structures).map(m=>({value:m.Id,title:m.Nom})));return(m,n)=>{const d=wt,i=Ke,r=Ge,v=Oa;return b(),w(N,{title:"Modifier l'aide extérieure",subtitle:`pour ${U(Oe).label(o.participant.Personne)} - ${U(Pe).label(o.participant.Camp)}`},{append:t(()=>[e(F,{onClick:n[0]||(n[0]=p=>c("showStructureaides"))},{default:t(()=>[e(pe,null,{default:t(()=>[...n[9]||(n[9]=[y("mdi-view-list",-1)])]),_:1}),n[10]||(n[10]=y(" Structures",-1))]),_:1})]),default:t(()=>[e(B,null,{default:t(()=>[e(h,null,{default:t(()=>[e(V,null,{default:t(()=>[e(Ne,{variant:"outlined",density:"comfortable",label:"Structure",items:u.value,modelValue:a.value.IdStructureaide,"onUpdate:modelValue":n[1]||(n[1]=p=>a.value.IdStructureaide=p)},null,8,["items","modelValue"])]),_:1}),e(V,null,{default:t(()=>[e(d,{modelValue:a.value.Valide,"onUpdate:modelValue":n[2]||(n[2]=p=>a.value.Valide=p),label:"Aide validée","hide-details":""},null,8,["modelValue"])]),_:1})]),_:1}),e(h,null,{default:t(()=>[e(V,{"align-self":"center"},{default:t(()=>[e(i,{modelValue:a.value.Valeur,"onUpdate:modelValue":n[3]||(n[3]=p=>a.value.Valeur=p),label:"Montant","hide-details":""},null,8,["modelValue"])]),_:1}),e(V,{"align-self":"center",cols:"auto"},{default:t(()=>[e(d,{"hide-details":"",label:"Par jour",modelValue:a.value.ParJour,"onUpdate:modelValue":n[4]||(n[4]=p=>a.value.ParJour=p)},null,8,["modelValue"])]),_:1}),e(V,{"align-self":"center"},{default:t(()=>[e(r,{label:"Limite",suffix:"jours",modelValue:a.value.NbJoursMax,"onUpdate:modelValue":n[5]||(n[5]=p=>a.value.NbJoursMax=p),disabled:!a.value.ParJour,hint:"0 pour ne pas limiter",min:0,"persistent-hint":""},null,8,["modelValue","disabled"])]),_:1})]),_:1}),e(v,{class:"mt-4",files:o.file?[o.file]:[],title:"Document justificatif","max-docs":1,"in-upload":!1,onDelete:n[6]||(n[6]=p=>c("deleteFile")),onUpload:n[7]||(n[7]=p=>c("uploadFile",p))},null,8,["files"])]),_:1}),e(re,null,{default:t(()=>[e(oe),e(F,{onClick:n[8]||(n[8]=p=>c("save",a.value))},{default:t(()=>[...n[11]||(n[11]=[y("Enregistrer",-1)])]),_:1})]),_:1})]),_:1},8,["subtitle"])}}}),zn=G({__name:"StructuresPannel",props:{modelValue:{required:!0},modelModifiers:{}},emits:["update:modelValue"],setup(l){const s=we(l,"modelValue"),o=R(()=>Object.values(s.value||{}).sort((d,i)=>d.Nom.localeCompare(i.Nom)));async function c(){const d=await C.StructureaideCreate();if(d===void 0)return;C.showMessage("Structure créée avec succès.");const i=s.value||{};i[d.Id]=d,s.value=i,a.value=d}const a=D(null);async function u(){const d=a.value;if(d==null||(a.value=null,await C.StructureaideUpdate(d)===void 0))return;C.showMessage("Structure modifiée avec succès.");const r=s.value||{};r[d.Id]=d,s.value=r}const m=D(null);async function n(){const d=m.value;if(d==null||(m.value=null,await C.StructureaideDelete({id:d.Id})===void 0))return;const r=s.value||{};delete r[d.Id],s.value=r,C.showMessage("Structure supprimée avec succès.")}return(d,i)=>(b(),w(N,{title:"Structures d'aide",subtitle:"Organismes pouvant distribuer une aide extérieure"},{append:t(()=>[e(F,{onClick:c},{prepend:t(()=>[e(pe,{color:"green"},{default:t(()=>[...i[5]||(i[5]=[y("mdi-plus",-1)])]),_:1})]),default:t(()=>[i[6]||(i[6]=y(" Ajouter une structure ",-1))]),_:1})]),default:t(()=>[e(B,{class:"overflow-y-auto"},{default:t(()=>[(b(!0),Q(te,null,me(o.value,r=>(b(),w(h,null,{default:t(()=>[e(V,{"align-self":"center"},{default:t(()=>[e(sl,null,{default:t(()=>[y(M(r.Nom),1)]),_:2},1024),e(ol,null,{default:t(()=>[y(M(r.Immatriculation),1)]),_:2},1024)]),_:2},1024),e(V,{"align-self":"center",style:{"font-size":"smaller"}},{default:t(()=>[(b(!0),Q(te,null,me(r.Info.split(`
`),v=>(b(),Q("div",null,M(v),1))),256))]),_:2},1024),e(V,{"align-self":"center",cols:"auto"},{default:t(()=>[e(Ie,null,{activator:t(({props:v})=>[e(F,se({icon:"mdi-dots-vertical"},{ref_for:!0},v,{size:"x-small"}),null,16)]),default:t(()=>[e(ke,null,{default:t(()=>[e(Y,{title:"Modifier","prepend-icon":"mdi-pencil",onClick:v=>a.value=U(De)(r)},null,8,["onClick"]),e(Y,{title:"Supprimer","prepend-icon":"mdi-delete",onClick:v=>m.value=r},null,8,["onClick"])]),_:2},1024)]),_:2},1024)]),_:2},1024)]),_:2},1024))),256))]),_:1}),e(ee,{"model-value":a.value!=null,"onUpdate:modelValue":i[3]||(i[3]=r=>a.value=null),"max-width":"600px"},{default:t(()=>[a.value!=null?(b(),w(N,{key:0,title:"Modifier la structure"},{default:t(()=>[e(B,null,{default:t(()=>[e(h,null,{default:t(()=>[e(V,null,{default:t(()=>[e(ve,{variant:"outlined",density:"compact",label:"Nom",modelValue:a.value.Nom,"onUpdate:modelValue":i[0]||(i[0]=r=>a.value.Nom=r),"hide-details":""},null,8,["modelValue"])]),_:1}),e(V,null,{default:t(()=>[e(ve,{variant:"outlined",density:"compact",label:"Immatriculation",modelValue:a.value.Immatriculation,"onUpdate:modelValue":i[1]||(i[1]=r=>a.value.Immatriculation=r),"hide-details":""},null,8,["modelValue"])]),_:1})]),_:1}),e(h,null,{default:t(()=>[e(V,null,{default:t(()=>[e(vt,{variant:"outlined",density:"compact",label:"Informations",modelValue:a.value.Info,"onUpdate:modelValue":i[2]||(i[2]=r=>a.value.Info=r),"hide-details":""},null,8,["modelValue"])]),_:1})]),_:1})]),_:1}),e(re,null,{default:t(()=>[e(oe),e(F,{onClick:u},{default:t(()=>[...i[7]||(i[7]=[y("Enregistrer",-1)])]),_:1})]),_:1})]),_:1})):W("",!0)]),_:1},8,["model-value"]),e(ee,{"model-value":m.value!=null,"onUpdate:modelValue":i[4]||(i[4]=r=>m.value=null),"max-width":"450px"},{default:t(()=>[m.value!=null?(b(),w(N,{key:0,title:"Confirmation"},{default:t(()=>[e(B,null,{default:t(()=>[y(" Confirmez-vous la suppression de la structure "+M(m.value.Nom)+" ? ",1),i[8]||(i[8]=E("br",null,null,-1)),i[9]||(i[9]=E("br",null,null,-1)),i[10]||(i[10]=y(" Attention, cette opération est irréversible. ",-1))]),_:1}),e(re,null,{default:t(()=>[e(oe),e(F,{color:"red",onClick:n},{default:t(()=>[...i[11]||(i[11]=[y("Supprimer",-1)])]),_:1})]),_:1})]),_:1})):W("",!0)]),_:1},8,["model-value"])]),_:1}))}}),Qn={key:0},Wn={key:1},Jn=G({__name:"DossierParticipantRow",props:Se({participant:{},aides:{},aidesFiles:{},hasManyParticipants:{type:Boolean}},{structures:{required:!0},structuresModifiers:{}}),emits:Se(["update","delete","createAide","updateAide","deleteAide","deleteFileAide","uploadFileAide","expand"],["update:structures"]),setup(l,{emit:s}){const o=l,c=we(l,"structures"),a=s,u=R(()=>{const _=Object.values(o.aides||{});return _.sort((P,A)=>P.Id-A.Id),_}),m=R(()=>o.participant.Camp.OptionPrix.Active==Me.NoOption&&!Pe.isQuotientFamilialActive(o.participant.Camp.OptionQuotientFamilial));function n(_){switch(o.participant.Camp.OptionPrix.Active){case Me.NoOption:return"Séjour sans option";case Me.PrixJour:const P=_.Jour?.length||0;return P==0?"Présent tous les jours":`Présent ${P} jour${P>1?"s":""}`;case Me.PrixStatut:const A=o.participant.Camp.OptionPrix.Statuts?.find(z=>z.Id==_.IdStatut);return A?`Statut ${A.Label}`:"Pas d'option."}}const d=D(!1),i=D(!1),r=R(()=>Object.values(c.value).map(_=>({value:_.Id,title:_.Nom})).sort((_,P)=>_.title.localeCompare(P.title))),v=D(null),p=D(null),k=D(null),x=D(!1);return(_,P)=>(b(),w(h,null,{default:t(()=>[e(V,{"align-self":"center",cols:"3"},{default:t(()=>[e(sl,null,{default:t(()=>[E("a",{href:"/camps",onClick:P[0]||(P[0]=lt(A=>U(Dt)(o.participant.Participant),["prevent"]))},M(U(Oe).label(o.participant.Personne)),1)]),_:1}),e(ol,null,{default:t(()=>[y(M(U(Pe).label(o.participant.Camp)),1)]),_:1})]),_:1}),e(V,{"align-self":"center",cols:"2",class:"text-center"},{default:t(()=>[e(Ie,{disabled:m.value,"close-on-content-click":!1,modelValue:d.value,"onUpdate:modelValue":P[2]||(P[2]=A=>d.value=A)},{activator:t(({props:A})=>[e(N,se(A,{elevation:m.value?0:1,color:"grey-lighten-2"}),{default:t(()=>[e(B,{class:"py-1 px-1"},{default:t(()=>[m.value?(b(),Q("div",Qn,"Camp sans option")):(b(),Q("div",Wn,[y(M(o.participant.Participant.QuotientFamilial?`QF ${o.participant.Participant.QuotientFamilial}.`:"Pas de QF.")+" ",1),P[22]||(P[22]=E("br",null,null,-1)),y(" "+M(n(o.participant.Participant.OptionPrix)),1)]))]),_:1})]),_:1},16,["elevation"])]),default:t(()=>[e(Tn,{camp:o.participant.Camp,"option-and-qf":{options:o.participant.Participant.OptionPrix,quotientFamilial:o.participant.Participant.QuotientFamilial},onUpdate:P[1]||(P[1]=A=>{o.participant.Participant.OptionPrix=A.options,o.participant.Participant.QuotientFamilial=A.quotientFamilial,d.value=!1,a("update",o.participant.Participant)})},null,8,["camp","option-and-qf"])]),_:1},8,["disabled","modelValue"])]),_:1}),e(V,{"align-self":"center",class:"text-center"},{default:t(()=>[u.value.length?W("",!0):(b(),w(be,{key:0,label:""},{default:t(()=>[...P[23]||(P[23]=[y("Aucune aide",-1)])]),_:1})),(b(!0),Q(te,null,me(u.value,A=>(b(),w(be,{class:"my-1","prepend-icon":"mdi-cash-plus",color:A.Valide?"green":"orange",onClick:z=>p.value=A},{close:t(()=>[e(pe,{icon:"mdi-close-circle",onClick:lt(z=>k.value=A,["stop"])},null,8,["onClick"])]),default:t(()=>[y(" "+M(c.value[A.IdStructureaide].Nom)+" : "+M(U(xe).montant(A.Valeur)),1)]),_:2},1032,["color","onClick"]))),256))]),_:1}),e(V,{"align-self":"center",class:"text-center",cols:"3"},{default:t(()=>[e(Hn,{remises:o.participant.Participant.Remises,onUpdate:P[3]||(P[3]=A=>{o.participant.Participant.Remises=A,a("update",o.participant.Participant)})},null,8,["remises"])]),_:1}),e(V,{"align-self":"center",cols:"auto"},{default:t(()=>[e(Ie,{location:"left"},{activator:t(({props:A})=>[e(F,se(A,{icon:"mdi-dots-vertical",size:"small"}),null,16)]),default:t(()=>[e(ke,{density:"comfortable"},{default:t(()=>[e(Y,{title:"Ajouter une aide","prepend-icon":"mdi-cash-plus",onClick:P[4]||(P[4]=A=>v.value={IdParticipant:o.participant.Participant.Id,IdStructure:0})}),e(ue),o.hasManyParticipants?(b(),w(Y,{key:0,"prepend-icon":"mdi-arrow-expand",title:"Étendre les options et remises",subtitle:"... au reste du dossier",onClick:P[5]||(P[5]=A=>a("expand"))})):W("",!0),e(ue),e(Y,{title:"Supprimer","prepend-icon":"mdi-delete",onClick:P[6]||(P[6]=A=>i.value=!0)})]),_:1})]),_:1})]),_:1}),e(ee,{modelValue:i.value,"onUpdate:modelValue":P[8]||(P[8]=A=>i.value=A),"max-width":"600px"},{default:t(()=>[e(N,{title:"Supprimer le participant"},{default:t(()=>[e(B,null,{default:t(()=>[...P[24]||(P[24]=[y(" Confirmez-vous la suppression de ce participant ? ",-1),E("br",null,null,-1),y(" Attention, cette opération est irréversible. ",-1)])]),_:1}),e(re,null,{default:t(()=>[e(oe),e(F,{color:"red",onClick:P[7]||(P[7]=A=>{a("delete"),i.value=!1})},{default:t(()=>[...P[25]||(P[25]=[y("Supprimer",-1)])]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"]),e(ee,{modelValue:x.value,"onUpdate:modelValue":P[10]||(P[10]=A=>x.value=A),"max-width":"650px"},{default:t(()=>[e(zn,{modelValue:c.value,"onUpdate:modelValue":P[9]||(P[9]=A=>c.value=A)},null,8,["modelValue"])]),_:1},8,["modelValue"]),v.value!=null?(b(),w(ee,{key:0,"model-value":v.value!=null,"onUpdate:modelValue":P[14]||(P[14]=A=>v.value=null),width:"600px"},{default:t(()=>[e(N,{title:"Ajouter une aide extérieure"},{append:t(()=>[e(F,{onClick:P[11]||(P[11]=A=>x.value=!0)},{default:t(()=>[e(pe,null,{default:t(()=>[...P[26]||(P[26]=[y("mdi-view-list",-1)])]),_:1}),P[27]||(P[27]=y(" Structures",-1))]),_:1})]),default:t(()=>[e(B,null,{default:t(()=>[e(Ne,{variant:"outlined",density:"comfortable",label:"Structure",items:r.value,"model-value":v.value.IdStructure==0?null:v.value.IdStructure,"onUpdate:modelValue":P[12]||(P[12]=A=>v.value.IdStructure=A)},null,8,["items","model-value"])]),_:1}),e(re,null,{default:t(()=>[e(oe),e(F,{color:"green",onClick:P[13]||(P[13]=A=>{a("createAide",v.value),v.value=null}),disabled:v.value.IdStructure==0},{default:t(()=>[...P[28]||(P[28]=[y("Créer",-1)])]),_:1},8,["disabled"])]),_:1})]),_:1})]),_:1},8,["model-value"])):W("",!0),p.value!=null?(b(),w(ee,{key:1,"model-value":p.value!=null,"onUpdate:modelValue":P[19]||(P[19]=A=>p.value=null),"max-width":"800px"},{default:t(()=>[e(Yn,{aide:p.value,file:l.aidesFiles[p.value.Id],structures:c.value,participant:o.participant,onShowStructureaides:P[15]||(P[15]=A=>x.value=!0),onSave:P[16]||(P[16]=A=>{a("updateAide",A),p.value=null}),onDeleteFile:P[17]||(P[17]=A=>a("deleteFileAide",p.value.Id)),onUploadFile:P[18]||(P[18]=A=>a("uploadFileAide",A,p.value.Id))},null,8,["aide","file","structures","participant"])]),_:1},8,["model-value"])):W("",!0),k.value!=null?(b(),w(ee,{key:2,"model-value":k.value!=null,"onUpdate:modelValue":P[21]||(P[21]=A=>k.value=null),"max-width":"600px"},{default:t(()=>[e(N,{title:"Supprimer l'aide"},{default:t(()=>[e(B,null,{default:t(()=>[...P[29]||(P[29]=[y(" Confirmez-vous la suppression de l'aide extérieure ? ",-1),E("br",null,null,-1),y(" Attention, cette opération est irréversible. ",-1)])]),_:1}),e(re,null,{default:t(()=>[e(oe),e(F,{color:"red",onClick:P[20]||(P[20]=A=>{a("deleteAide",k.value.Id),k.value=null})},{default:t(()=>[...P[30]||(P[30]=[y("Supprimer",-1)])]),_:1})]),_:1})]),_:1})]),_:1},8,["model-value"])):W("",!0)]),_:1}))}}),Gn=G({__name:"DossierEditor",props:{dossier:{},camps:{}},emits:["updateDossier","createParticipant","updateParticipant","deleteParticipant","expandParticipant","createAide","updateAide","deleteAide","deleteFileAide","uploadFileAide"],setup(l,{emit:s}){const o=l,c=s,a=D(null);Ee(n);const u=D(!0),m=D({});async function n(){const d=await C.StructureaidesGet();d!==void 0&&(u.value=!1,m.value=d||{})}return(d,i)=>(b(),w(N,{title:"Modifier le dossier"},{append:t(()=>[e(F,{onClick:i[0]||(i[0]=r=>a.value={IdCamp:0,IdPersonne:0,IdDossier:o.dossier.Dossier.Dossier.Id})},{prepend:t(()=>[e(pe,{color:"green"},{default:t(()=>[...i[9]||(i[9]=[y("mdi-plus",-1)])]),_:1})]),default:t(()=>[i[10]||(i[10]=y(" Ajouter un participant",-1))]),_:1})]),default:t(()=>[e(B,null,{default:t(()=>[e(h,null,{default:t(()=>[e(V,{cols:"3"},{default:t(()=>[e(Fn,{responsable:o.dossier.Dossier.Responsable,dossier:o.dossier.Dossier.Dossier,onSave:i[1]||(i[1]=r=>c("updateDossier",r))},null,8,["responsable","dossier"])]),_:1}),e(ue,{thickness:"2",vertical:""}),u.value?W("",!0):(b(),w(V,{key:0},{default:t(()=>[i[11]||(i[11]=E("div",{class:"my-1"},null,-1)),(b(!0),Q(te,null,me(o.dossier.Dossier.Participants,r=>(b(),w(Jn,{participant:r,aides:(o.dossier.Dossier.Aides||{})[r.Participant.Id],"aides-files":o.dossier.Dossier.AidesFiles||{},"has-many-participants":(o.dossier.Dossier.Participants?.length||0)>1,structures:m.value,"onUpdate:structures":i[2]||(i[2]=v=>m.value=v),onCreateAide:i[3]||(i[3]=v=>c("createAide",v)),onDeleteAide:i[4]||(i[4]=v=>c("deleteAide",v)),onUpdateAide:i[5]||(i[5]=v=>c("updateAide",v)),onDeleteFileAide:i[6]||(i[6]=v=>c("deleteFileAide",v)),onUploadFileAide:i[7]||(i[7]=(v,p)=>c("uploadFileAide",v,p)),onUpdate:i[8]||(i[8]=v=>c("updateParticipant",v)),onDelete:v=>c("deleteParticipant",r.Participant.Id),onExpand:v=>c("expandParticipant",r.Participant)},null,8,["participant","aides","aides-files","has-many-participants","structures","onDelete","onExpand"]))),256))]),_:1}))]),_:1})]),_:1})]),_:1}))}}),Kn={class:"mr-1"},Xn=["onClick"],Zn={class:"overflow-y-auto",style:{"max-height":"65vh"}},eu=["href"],tu=G({__name:"DossierDetailsPannel",props:{dossier:{},camps:{}},emits:["updateDossier","deleteDossier","mergeDossier","createParticipant","updateParticipant","deleteParticipant","expandParticipant","createAide","updateAide","deleteAide","deleteFileAide","uploadFileAide","createPaiement","updatePaiement","deletePaiement","sendMessage","deleteMessage","sendFacture"],setup(l,{expose:s,emit:o}){const c=l,a=o;s({showEditPaiement:v,showEditDossier:d});const u=R(()=>ua(c.dossier.Dossier,C.isFondsSoutien?Ut.FondSoutien:Ut.Backoffice)),m=D(!1),n=D(!1);function d(){n.value=!0}const i=D(null),r=D(null);function v(S){r.value=S}const p="Repère",k=D(!1);async function x(){await dt(c.dossier.EspacepersoURL),C.showMessage("Lien vers l'espace personnel copié.")}async function _(){await dt(c.dossier.VirementCode),C.showMessage("Identifiant de virement copié.")}async function P(S){await dt(S),C.showMessage("IBAN copié.")}const A=D(!1),z=D(!1),Z=D("");return(S,f)=>{const K=La,ge=st,J=it;return b(),w(N,{title:`Dossier de ${c.dossier.Dossier.Responsable}`,class:"ml-2"},{subtitle:t(()=>[(b(!0),Q(te,null,me(c.dossier.Dossier.Participants,I=>(b(),Q("span",Kn,[E("a",{href:"/camps",onClick:lt(le=>U(Dt)(I.Participant),["prevent"])},M(U(Oe).label(I.Personne)),9,Xn)]))),256))]),append:t(()=>[e(F,{icon:"mdi-pencil",onClick:f[0]||(f[0]=I=>n.value=!0),class:"mx-1"}),e(Ie,null,{activator:t(({props:I})=>[e(F,se(I,{icon:"mdi-dots-vertical",size:"small",class:"mx-1"}),null,16)]),default:t(()=>[e(ke,{density:"compact"},{default:t(()=>[e(Y,{"prepend-icon":"mdi-email",onClick:f[1]||(f[1]=I=>z.value=!0),title:"Envoyer un message",subtitle:"Notification par email"}),e(Y,{"prepend-icon":"mdi-invoice-send",onClick:f[2]||(f[2]=I=>a("sendFacture")),title:"Envoyer une demande de règlement",subtitle:"Notification par email"}),e(ue),e(Y,{"prepend-icon":"mdi-cash-plus",onClick:f[3]||(f[3]=I=>a("createPaiement")),title:"Ajouter un paiement"}),e(ue),e(Y,{"prepend-icon":"mdi-link",onClick:f[4]||(f[4]=I=>k.value=!0),title:"Afficher les identifiants"}),e(ue),e(Y,{"prepend-icon":"mdi-file-move",onClick:f[5]||(f[5]=I=>A.value=!0),title:"Fusionner vers ..."}),e(ue),e(Y,{onClick:f[6]||(f[6]=I=>m.value=!0),title:"Supprimer"},{prepend:t(()=>[e(pe,{color:"red"},{default:t(()=>[...f[35]||(f[35]=[y("mdi-delete",-1)])]),_:1})]),_:1})]),_:1})]),_:1})]),default:t(()=>[e(B,null,{default:t(()=>[e(h,null,{default:t(()=>[e(V,{class:"ml-2 mb-1 text-center"},{default:t(()=>[e(Ie,null,{activator:t(({props:I})=>[e(be,se(I,{"prepend-icon":"mdi-currency-eur",color:U(xe).colorStatutPaiement(c.dossier.Dossier.Bilan.Statut)}),{default:t(()=>[y(M(c.dossier.Dossier.Bilan.Recu)+" payé sur "+M(c.dossier.Dossier.Bilan.Demande),1)]),_:1},16,["color"])]),default:t(()=>[e(xn,{dossier:c.dossier.Dossier},null,8,["dossier"])]),_:1})]),_:1})]),_:1}),E("div",Zn,[e(Fa,{side:"end",class:"mt-4",density:"compact"},{default:t(()=>[(b(!0),Q(te,null,me(u.value,(I,le)=>(b(),w(K,{event:I,key:le,onEditPaiement:f[7]||(f[7]=ae=>r.value=ae),onDeleteMessage:f[8]||(f[8]=ae=>a("deleteMessage",ae))},null,8,["event"]))),128))]),_:1})])]),_:1}),e(ee,{modelValue:m.value,"onUpdate:modelValue":f[10]||(f[10]=I=>m.value=I),"max-width":"600px"},{default:t(()=>[e(N,{title:"Supprimer le dossier"},{default:t(()=>[e(B,null,{default:t(()=>[...f[36]||(f[36]=[y(" Confirmez-vous la suppression du dossier et de ses participants ? ",-1),E("br",null,null,-1),E("br",null,null,-1),y(" Attention, cette opération est irréversible. ",-1)])]),_:1}),e(re,null,{default:t(()=>[e(oe),e(F,{color:"red",onClick:f[9]||(f[9]=I=>{a("deleteDossier"),m.value=!1})},{default:t(()=>[...f[37]||(f[37]=[y("Supprimer",-1)])]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"]),i.value!=null?(b(),w(ee,{key:0,"model-value":i.value!=null,"onUpdate:modelValue":f[14]||(f[14]=I=>i.value=null),"max-width":"600px"},{default:t(()=>[e(N,{title:"Ajouter un participant"},{default:t(()=>[e(B,null,{default:t(()=>[e(h,null,{default:t(()=>[e(V,{cols:"12"},{default:t(()=>[e(ge,{label:"Camp",camps:c.camps,modelValue:i.value.IdCamp,"onUpdate:modelValue":f[11]||(f[11]=I=>i.value.IdCamp=I)},null,8,["camps","modelValue"])]),_:1}),e(V,{cols:"12"},{default:t(()=>[e(J,{label:"Personne","initial-personne":"",modelValue:i.value.IdPersonne,"onUpdate:modelValue":f[12]||(f[12]=I=>i.value.IdPersonne=I),api:{SelectPersonne:U(C).SelectPersonne.bind(U(C))}},null,8,["modelValue","api"])]),_:1})]),_:1})]),_:1}),e(re,null,{default:t(()=>[e(oe),e(F,{color:"green",disabled:i.value.IdPersonne==0||i.value.IdCamp==0,onClick:f[13]||(f[13]=I=>{a("createParticipant",i.value),i.value=null})},{default:t(()=>[...f[38]||(f[38]=[y("Ajouter",-1)])]),_:1},8,["disabled"])]),_:1})]),_:1})]),_:1},8,["model-value"])):W("",!0),e(ee,{modelValue:n.value,"onUpdate:modelValue":f[25]||(f[25]=I=>n.value=I)},{default:t(()=>[e(Gn,{dossier:c.dossier,camps:c.camps,onUpdateDossier:f[15]||(f[15]=I=>a("updateDossier",I)),onCreateParticipant:f[16]||(f[16]=I=>a("createParticipant",I)),onUpdateParticipant:f[17]||(f[17]=I=>a("updateParticipant",I)),onDeleteParticipant:f[18]||(f[18]=I=>a("deleteParticipant",I)),onExpandParticipant:f[19]||(f[19]=I=>a("expandParticipant",I)),onCreateAide:f[20]||(f[20]=I=>a("createAide",I)),onUpdateAide:f[21]||(f[21]=I=>a("updateAide",I)),onDeleteAide:f[22]||(f[22]=I=>a("deleteAide",I)),onDeleteFileAide:f[23]||(f[23]=I=>a("deleteFileAide",I)),onUploadFileAide:f[24]||(f[24]=(I,le)=>a("uploadFileAide",I,le))},null,8,["dossier","camps"])]),_:1},8,["modelValue"]),r.value!=null?(b(),w(ee,{key:1,"model-value":r.value!=null,"onUpdate:modelValue":f[28]||(f[28]=I=>r.value=null),"max-width":"600px"},{default:t(()=>[e(Rn,{paiement:r.value,onUpdate:f[26]||(f[26]=I=>{a("updatePaiement",I),r.value=null}),onDelete:f[27]||(f[27]=I=>{a("deletePaiement",r.value),r.value=null})},null,8,["paiement"])]),_:1},8,["model-value"])):W("",!0),e(ee,{modelValue:k.value,"onUpdate:modelValue":f[29]||(f[29]=I=>k.value=I),"max-width":"800px"},{default:t(()=>[e(N,{title:"Liens et identifiants"},{default:t(()=>[e(B,null,{default:t(()=>[e(h,null,{default:t(()=>[e(V,{cols:"3"},{default:t(()=>[...f[39]||(f[39]=[y("Espace personnel",-1)])]),_:1}),e(V,{class:"text-truncate"},{default:t(()=>[E("a",{href:c.dossier.EspacepersoURL,target:"_blank"},M(c.dossier.EspacepersoURL),9,eu)]),_:1}),e(V,{"align-self":"center",cols:"auto"},{default:t(()=>[e(F,{size:"small",icon:"mdi-content-copy",onClick:x})]),_:1})]),_:1}),(b(!0),Q(te,null,me(c.dossier.BankAccounts,I=>(b(),w(h,null,{default:t(()=>[e(V,{cols:"3"},{default:t(()=>[y("RIB ("+M(U(p))+")",1)]),_:1}),e(V,{cols:"3"},{default:t(()=>[y(M(I[0]),1)]),_:2},1024),e(V,null,{default:t(()=>[y(M(I[1]),1)]),_:2},1024),e(V,{"align-self":"center",cols:"auto"},{default:t(()=>[e(F,{size:"small",icon:"mdi-content-copy",onClick:()=>P(I[1])},null,8,["onClick"])]),_:2},1024)]),_:2},1024))),256)),e(h,null,{default:t(()=>[e(V,{cols:"3"},{default:t(()=>[...f[40]||(f[40]=[y("Identification de virement",-1)])]),_:1}),e(V,null,{default:t(()=>[y(M(c.dossier.VirementCode),1)]),_:1}),e(V,{"align-self":"center",cols:"auto"},{default:t(()=>[e(F,{size:"small",icon:"mdi-content-copy",onClick:_})]),_:1})]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"]),e(ee,{modelValue:A.value,"onUpdate:modelValue":f[31]||(f[31]=I=>A.value=I),"max-width":"600px"},{default:t(()=>[e(fl,{from:c.dossier.Dossier.Dossier.Id,onMerge:f[30]||(f[30]=I=>{a("mergeDossier",I),A.value=!1})},null,8,["from"])]),_:1},8,["modelValue"]),e(ee,{modelValue:z.value,"onUpdate:modelValue":f[34]||(f[34]=I=>z.value=I),"max-width":"600px"},{default:t(()=>[e(N,{title:"Nouveau message",subtitle:"Envoie un message sur le fil de suivi et une notification par mail."},{default:t(()=>[e(B,null,{default:t(()=>[e(h,null,{default:t(()=>[e(V,null,{default:t(()=>[e(vt,{rows:"5",variant:"outlined",modelValue:Z.value,"onUpdate:modelValue":f[32]||(f[32]=I=>Z.value=I)},null,8,["modelValue"])]),_:1})]),_:1})]),_:1}),e(re,null,{default:t(()=>[e(oe),e(F,{disabled:!Z.value.length,onClickOnce:f[33]||(f[33]=I=>{a("sendMessage",Z.value),z.value=!1})},{default:t(()=>[...f[41]||(f[41]=[y("Envoyer",-1)])]),_:1},8,["disabled"])]),_:1})]),_:1})]),_:1},8,["modelValue"])]),_:1},8,["title"])}}}),lu=G({__name:"CreateDossierCard",emits:["create"],setup(l,{emit:s}){const o=s,c=D(0);return(a,u)=>{const m=it;return b(),w(N,{title:"Créer un dossier"},{default:t(()=>[e(B,null,{default:t(()=>[e(h,null,{default:t(()=>[e(V,null,{default:t(()=>[e(m,{label:"Responsable légal",modelValue:c.value,"onUpdate:modelValue":u[0]||(u[0]=n=>c.value=n),"initial-personne":"",api:{SelectPersonne:U(C).SelectPersonne.bind(U(C))}},null,8,["modelValue","api"])]),_:1})]),_:1})]),_:1}),e(re,null,{default:t(()=>[e(oe),e(F,{color:"green",disabled:c.value==0,onClick:u[1]||(u[1]=n=>o("create",c.value))},{default:t(()=>[...u[2]||(u[2]=[y("Créer",-1)])]),_:1},8,["disabled"])]),_:1})]),_:1})}}}),au=G({__name:"DossierList",props:Se({camps:{},allowFondsSoutien:{type:Boolean},selected:{}},{query:{required:!0},queryModifiers:{}}),emits:Se(["click","update"],["update:query"]),setup(l,{expose:s,emit:o}){const c=l,a=o,u=we(l,"query");s({searchDossiers:n}),$e(()=>u.value,n,{immediate:!0});const m=D(null);async function n(){const d=await C.DossiersSearch(u.value);d!==void 0&&(m.value=d,a("update",d))}return(d,i)=>{const r=st,v=il;return b(),Q("div",null,[e(h,null,{default:t(()=>[e(V,{"align-self":"center"},{default:t(()=>[e(v,{density:"compact",variant:"outlined","prepend-inner-icon":"mdi-magnify",label:"Rechercher un dossier","hide-details":"",clearable:"",modelValue:u.value.Pattern,"onUpdate:modelValue":[i[5]||(i[5]=p=>u.value.Pattern=p),n]},{"append-inner":t(()=>[u.value.IdCamp.Valid?(b(),w(be,{key:0,class:"ml-1",size:"small","prepend-icon":"mdi-bed"},{default:t(()=>[y(M(c.camps.find(p=>p.Id==u.value.IdCamp.Id)?.Label),1)]),_:1})):W("",!0),u.value.Attente!=U(da).EmptyQA?(b(),w(be,{key:1,class:"ml-1",size:"small","prepend-icon":"mdi-clock"},{default:t(()=>[y(M(U(Rt)[u.value.Attente]),1)]),_:1})):W("",!0),u.value.Reglement!=U(ma).EmptyQR?(b(),w(be,{key:2,class:"ml-1",size:"small","prepend-icon":"mdi-currency-eur"},{default:t(()=>[y(M(U(Ft)[u.value.Reglement]),1)]),_:1})):W("",!0),u.value.OnlyFondSoutien?(b(),w(be,{key:3,class:"ml-1",size:"small"},{default:t(()=>[...i[6]||(i[6]=[y(" Fonds de soutien ",-1)])]),_:1})):W("",!0)]),append:t(()=>[e(Ie,{location:"left top","close-on-content-click":!1},{activator:t(({props:p})=>[e(F,se(p,{size:"small",variant:"flat",icon:""}),{default:t(()=>[e(pe,null,{default:t(()=>[...i[7]||(i[7]=[y("mdi-filter-cog",-1)])]),_:1}),e(je,{activator:"parent",text:"Autres critères de recherche"})]),_:1},16)]),default:t(()=>[e(N,{"min-width":"400px",title:"Filtrer les dossiers"},{default:t(()=>[e(B,null,{default:t(()=>[e(h,null,{default:t(()=>[e(V,null,{default:t(()=>[e(r,{label:"Camp",camps:c.camps,"model-value":U(oa)(U(ra)(u.value.IdCamp)),"onUpdate:modelValue":i[0]||(i[0]=p=>{u.value.IdCamp=U(ia)(U(sa)(p)),n()})},null,8,["camps","model-value"])]),_:1})]),_:1}),e(h,null,{default:t(()=>[e(V,null,{default:t(()=>[e(Ne,{density:"compact",variant:"outlined",label:"Liste d'attente",modelValue:u.value.Attente,"onUpdate:modelValue":[i[1]||(i[1]=p=>u.value.Attente=p),n],items:U(nt)(U(Rt)),"hide-details":""},null,8,["modelValue","items"])]),_:1})]),_:1}),e(h,null,{default:t(()=>[e(V,null,{default:t(()=>[e(Ne,{density:"compact",variant:"outlined",label:"Réglement",modelValue:u.value.Reglement,"onUpdate:modelValue":[i[2]||(i[2]=p=>u.value.Reglement=p),n],items:U(nt)(U(Ft)),"hide-details":""},null,8,["modelValue","items"])]),_:1})]),_:1}),e(h,null,{default:t(()=>[e(V,null,{default:t(()=>[e(kt,{label:"Trier selon les nouveaux messages",hint:"Affiche les nouveaux messages en premier.","persistent-hint":"",density:"compact",color:"light-blue-darken-3",modelValue:u.value.SortByNewMessages,"onUpdate:modelValue":[i[3]||(i[3]=p=>u.value.SortByNewMessages=p),n]},null,8,["modelValue"])]),_:1})]),_:1}),c.allowFondsSoutien?(b(),w(h,{key:0},{default:t(()=>[e(V,null,{default:t(()=>[e(kt,{label:"Fonds de soutien",hint:"N'affiche que les dossiers demandant le fonds de soutien.","persistent-hint":"",density:"compact",color:"orange",modelValue:u.value.OnlyFondSoutien,"onUpdate:modelValue":[i[4]||(i[4]=p=>u.value.OnlyFondSoutien=p),n]},null,8,["modelValue"])]),_:1})]),_:1})):W("",!0)]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"])]),_:1})]),_:1}),m.value!=null?(b(),w(ke,{key:0,class:"mt-2",selected:c.selected?[c.selected]:void 0},{default:t(()=>[m.value.Dossiers?.length?W("",!0):(b(),w(Y,{key:0,class:"text-center"},{default:t(()=>[...i[8]||(i[8]=[E("i",null,"Aucun dossier ne correspond à votre recherche.",-1)])]),_:1})),(b(!0),Q(te,null,me(m.value.Dossiers,(p,k)=>(b(),w(Y,{rounded:"",key:k,title:p.Responsable,subtitle:p.Participants,value:p.Id,onClick:x=>a("click",p),class:"my-1"},ft({_:2},[p.NewMessages?{name:"append",fn:t(()=>[e($a,{color:"light-blue-darken-3",content:p.NewMessages},null,8,["content"])]),key:"0"}:void 0]),1032,["title","subtitle","value","onClick"]))),128))]),_:1},8,["selected"])):W("",!0)])}}}),nu=G({__name:"SendDocumentsCampCard",props:{camps:{}},emits:["send"],setup(l,{emit:s}){const o=l,c=s,a=D(0),u=D(null);async function m(){const i=await C.EventsSendDocumentsCampPreview({idCamp:a.value});i!==void 0&&(u.value=i,n.value=(i.Dossiers||[]).filter(r=>!r.DocumentsSent).map(r=>r.Id))}const n=D([]),d=R(()=>n.value.length==(u.value?.Dossiers||[]).length);return(i,r)=>{const v=st;return b(),w(N,{title:"Envoyer les documents d'un séjour"},{default:t(()=>[e(B,null,{default:t(()=>[e(h,null,{default:t(()=>[e(V,{"align-self":"center",cols:"5"},{default:t(()=>[e(v,{camps:o.camps,label:"Séjour",modelValue:a.value,"onUpdate:modelValue":[r[0]||(r[0]=p=>a.value=p),m]},null,8,["camps","modelValue"])]),_:1}),e(V,{"align-self":"center"},{default:t(()=>[u.value?(b(),w(N,{key:0,subtitle:"Dossiers à contacter"},ft({default:t(()=>[e(B,null,{default:t(()=>[e(ke,{selectable:"",selected:n.value,"onUpdate:selected":r[2]||(r[2]=p=>n.value=p),"select-strategy":"leaf"},{default:t(()=>[(b(!0),Q(te,null,me(u.value.Dossiers,p=>(b(),w(Y,{title:p.Responsable,subtitle:p.Participants,value:p.Id,rounded:"",class:"my-1"},{append:t(({isSelected:k,select:x})=>[e(h,null,{default:t(()=>[e(V,null,{default:t(()=>[p.DocumentsSent?(b(),w(be,{key:0,color:"green",class:"mr-2"},{default:t(()=>[...r[4]||(r[4]=[y("Envoyés",-1)])]),_:1})):W("",!0)]),_:2},1024),e(V,null,{default:t(()=>[e(rl,{density:"compact","hide-details":"","model-value":k,"onUpdate:modelValue":x},null,8,["model-value","onUpdate:modelValue"])]),_:2},1024)]),_:2},1024)]),_:2},1032,["title","subtitle","value"]))),256))]),_:1},8,["selected"])]),_:1})]),_:2},[u.value.Dossiers?.length?{name:"append",fn:t(()=>[e(Ye,{label:"Tout sélectionner",density:"compact","hide-details":"",indeterminate:!!n.value.length&&n.value.length!=(u.value.Dossiers||[]).length,"model-value":n.value.length==(u.value.Dossiers||[]).length,"onUpdate:modelValue":r[1]||(r[1]=p=>n.value=d.value?[]:(u.value.Dossiers||[]).map(k=>k.Id))},null,8,["indeterminate","model-value"])]),key:"0"}:void 0]),1024)):W("",!0)]),_:1})]),_:1})]),_:1}),e(re,null,{default:t(()=>[e(oe),e(F,{disabled:!a.value||!n.value.length,onClick:r[3]||(r[3]=p=>c("send",a.value,n.value))},{append:t(()=>[e(pe,null,{default:t(()=>[...r[5]||(r[5]=[y("mdi-send",-1)])]),_:1})]),default:t(()=>[r[6]||(r[6]=y(" Envoyer ",-1))]),_:1},8,["disabled"])]),_:1})]),_:1})}}}),uu=G({__name:"SendRelancePaiementCard",props:{camps:{}},emits:["send"],setup(l,{emit:s}){const o=l,c=s,a=D(0),u=D([]);async function m(){const i=await C.EventsSendRelancePaiementPreview({idCamp:a.value});i!==void 0&&(u.value=i||[],n.value=(i||[]).map(r=>r.Id))}const n=D([]),d=R(()=>n.value.length==u.value.length);return(i,r)=>{const v=st;return b(),w(N,{title:"Envoyer une relance de paiement"},{default:t(()=>[e(B,null,{default:t(()=>[e(h,null,{default:t(()=>[e(V,{"align-self":"center",cols:"5"},{default:t(()=>[e(v,{camps:o.camps,label:"Séjour",modelValue:a.value,"onUpdate:modelValue":[r[0]||(r[0]=p=>a.value=p),m]},null,8,["camps","modelValue"])]),_:1}),e(V,{"align-self":"center"},{default:t(()=>[u.value?(b(),w(N,{key:0,subtitle:"Dossiers à relancer"},ft({default:t(()=>[e(B,null,{default:t(()=>[e(ke,{selectable:"",selected:n.value,"onUpdate:selected":r[2]||(r[2]=p=>n.value=p),"select-strategy":"leaf",density:"comfortable"},{default:t(()=>[(b(!0),Q(te,null,me(u.value,(p,k)=>(b(),w(Y,{key:p.Id,title:p.Responsable,subtitle:U(ca)(p.LastEventFacture)?"":`Dernière demande : ${U(xe).time(p.LastEventFacture)}`,value:p.Id,rounded:"",class:"my-1"},{append:t(({isSelected:x,select:_})=>[e(h,null,{default:t(()=>[e(V,{"align-self":"center"},{default:t(()=>[e(be,{class:"mr-2",color:U(xe).colorStatutPaiement(p.Bilan.Statut)},{default:t(()=>[y(M(p.Bilan.Recu)+" / "+M(p.Bilan.Demande),1)]),_:2},1032,["color"])]),_:2},1024),e(V,{"align-self":"center"},{default:t(()=>[e(rl,{density:"compact","hide-details":"","model-value":x,"onUpdate:modelValue":_},null,8,["model-value","onUpdate:modelValue"])]),_:2},1024)]),_:2},1024)]),_:2},1032,["title","subtitle","value"]))),128))]),_:1},8,["selected"])]),_:1})]),_:2},[u.value.length?{name:"append",fn:t(()=>[e(Ye,{label:"Tout sélectionner",density:"compact","hide-details":"",indeterminate:!!n.value.length&&n.value.length!=u.value.length,"model-value":n.value.length==u.value.length,"onUpdate:modelValue":r[1]||(r[1]=p=>n.value=d.value?[]:u.value.map(k=>k.Id))},null,8,["indeterminate","model-value"])]),key:"0"}:void 0]),1024)):W("",!0)]),_:1})]),_:1})]),_:1}),e(re,null,{default:t(()=>[e(oe),e(F,{disabled:!a.value||!n.value.length,onClick:r[3]||(r[3]=p=>c("send",a.value,n.value))},{append:t(()=>[e(pe,null,{default:t(()=>[...r[4]||(r[4]=[y("mdi-send",-1)])]),_:1})]),default:t(()=>[r[5]||(r[5]=y(" Envoyer ",-1))]),_:1},8,["disabled"])]),_:1})]),_:1})}}}),iu=G({__name:"RemisesHintsCard",setup(l){Ee(o);const s=D(null);async function o(){const u=await C.DossiersRemisesHint();u!==void 0&&(s.value=u||[])}const c=D([]);async function a(){const u=s.value;if(!c.value.length||!u)return;const m=c.value.map(d=>u[d]),n=await C.DossiersApplyRemisesHints(m);c.value=[],n!==void 0&&(C.showMessage("Remises appliquées avec succès."),o())}return(u,m)=>(b(),w(N,{title:"Estimer les remises",subtitle:"Seuls les séjours de cette année et les nouvelles remises sont affichés."},{append:t(()=>[e(F,{disabled:!c.value.length,onClick:a},{default:t(()=>[...m[1]||(m[1]=[y("Appliquer les remises",-1)])]),_:1},8,["disabled"])]),default:t(()=>[e(B,null,{default:t(()=>[s.value==null?(b(),w(Qe,{key:0})):(b(),w(ke,{key:1,"select-strategy":"leaf",selected:c.value,"onUpdate:selected":m[0]||(m[0]=n=>c.value=n),color:"primary"},{default:t(()=>[s.value.length?W("",!0):(b(),w(Y,{key:0,class:"font-italic"},{default:t(()=>[...m[2]||(m[2]=[y(" Aucune nouvelle remise à appliquer. ",-1)])]),_:1})),(b(!0),Q(te,null,me(s.value,(n,d)=>(b(),w(Y,{title:n.Personne,subtitle:n.Camp,value:d,rounded:"",class:"my-1"},{append:t(()=>[e(h,{style:{width:"200px"}},{default:t(()=>[e(V,{cols:"6"},{default:t(()=>[n.Hint.ReducInscrits?(b(),w(be,{key:0,"prepend-icon":"mdi-account-multiple",class:"mx-1",elevation:"1"},{default:t(()=>[y(M(n.Hint.ReducInscrits)+" % ",1),e(je,{activator:"parent","content-class":"ma-0 pa-0"},{default:t(()=>[e(N,{subtitle:"Autres inscrits de la même famille"},{default:t(()=>[e(B,null,{default:t(()=>[(b(!0),Q(te,null,me(n.AutresInscrits,i=>(b(),w(be,{class:"mx-1"},{default:t(()=>[y(M(i.Personne)+" ("+M(i.Camp)+")",1)]),_:2},1024))),256))]),_:2},1024)]),_:2},1024)]),_:2},1024)]),_:2},1024)):W("",!0)]),_:2},1024),e(V,{cols:"6"},{default:t(()=>[n.Hint.ReducEquipiers?(b(),w(be,{key:0,"prepend-icon":"mdi-account-hard-hat",class:"mx-1",elevation:"1"},{default:t(()=>[y(M(n.Hint.ReducEquipiers)+" % ",1),e(je,{activator:"parent","content-class":"ma-0 pa-0"},{default:t(()=>[e(N,{subtitle:"Equipiers de la même famille"},{default:t(()=>[e(B,null,{default:t(()=>[(b(!0),Q(te,null,me(n.Equipiers,i=>(b(),w(be,{class:"mx-1"},{default:t(()=>[y(M(i.Personne)+" ("+M(i.Camp)+")",1)]),_:2},1024))),256))]),_:2},1024)]),_:2},1024)]),_:2},1024)]),_:2},1024)):W("",!0)]),_:2},1024)]),_:2},1024)]),_:2},1032,["title","subtitle","value"]))),256))]),_:1},8,["selected"]))]),_:1})]),_:1}))}}),su={key:1,class:"text-center font-italic my-6"},ou=G({__name:"PannelDossiers",props:{initialDossier:{}},setup(l){const s=l;Ee(()=>{m(),s.initialDossier!==void 0&&r(s.initialDossier)}),$e(()=>s.initialDossier,()=>{s.initialDossier!==void 0&&r(s.initialDossier)});const o=Lt("detailsPannel"),c=D(null),a=D(Ia()),u=D([]);async function m(){const q=await C.GetCamps();q!==void 0&&(u.value=q||[])}function n(q){c.value={length:q.Dossiers?.length||0,total:q.Total}}const d=Lt("dossierList");function i(){d.value?.searchDossiers()}async function r(q){await p(q),a.value=Aa(q)}const v=D(null);async function p(q){const H=await C.DossiersLoad({id:q});H!==void 0&&(v.value=H)}async function k(q){p(q.Id),await C.EventsMarkMessagesSeen({idDossier:q.Id})!==void 0&&i()}async function x(){v.value!=null&&p(v.value.Dossier.Dossier.Id)}const _=D(!1);async function P(q){_.value=!1;const H=await C.DossiersCreate({idResponsable:q});H!==void 0&&(C.showMessage("Dossier créé avec succès."),await r(H.Id),o.value?.showEditDossier())}async function A(q){const H=await C.DossiersUpdate(q);H!==void 0&&(C.showMessage("Dossier mis à jour avec succès."),v.value!=null&&(v.value.Dossier.Dossier=q,v.value.Dossier.Responsable=H.Responsable),i())}async function z(){if(v.value==null)return;const q=v.value.Dossier.Dossier.Id;await C.DossiersDelete({id:q})!==void 0&&(C.showMessage("Dossier supprimé avec succès."),v.value=null,i())}async function Z(q){await C.DossiersMerge(q)!==void 0&&(C.showMessage("Dossier fusionné avec succès."),i(),p(q.To))}async function S(q){await C.ParticipantsCreate(q)!==void 0&&(C.showMessage("Participant ajouté avec succès."),x())}async function f(q){await C.ParticipantsUpdate(q)!==void 0&&(C.showMessage("Réglages du participant modifiés avec succès."),x())}async function K(q){await C.ParticipantsDelete({id:q})!==void 0&&(C.showMessage("Participant supprimé avec succès."),x())}async function ge(q){if(v.value==null)return;const H=v.value.Dossier.Participants?.map(ce=>ce.Participant).filter(ce=>ce.Id!=q.Id)||[];!H.length||(H.forEach(ce=>{ce.Remises=q.Remises,ce.QuotientFamilial=q.QuotientFamilial,ce.IdCamp==q.IdCamp&&(ce.OptionPrix=q.OptionPrix)}),(await Promise.all(H.map(ce=>C.ParticipantsUpdate(ce)))).includes(void 0))||(C.showMessage("Réglages des participants modifiés avec succès."),x())}async function J(q){const H=await C.AidesCreate(q);if(H===void 0||(C.showMessage("Aide ajoutée avec succès."),v.value==null))return;const de=v.value.Dossier.Aides||{},ce=de[q.IdParticipant]||{};ce[H.Id]=H,de[q.IdParticipant]=ce,v.value.Dossier.Aides=de}async function I(q){await C.AidesUpdate(q)!==void 0&&(C.showMessage("Aide modifiée avec succès."),x())}async function le(q){await C.AidesJustificatifDelete({idAide:q})!==void 0&&(C.showMessage("Justificatif supprimé avec succès."),v.value!=null&&v.value.Dossier.AidesFiles&&delete v.value.Dossier.AidesFiles[q])}async function ae(q,H){const de=await C.AidesJustificatifUpload(q,{idAide:H});if(de!==void 0&&(C.showMessage("Justificatif téléversé avec succès."),v.value!=null)){const ce=v.value.Dossier.AidesFiles||{};ce[H]=de,v.value.Dossier.AidesFiles=ce}}async function O(q){await C.AidesDelete({id:q})!==void 0&&(C.showMessage("Aide supprimée avec succès."),x())}async function j(){if(v.value==null)return;const q=await C.PaiementsCreate({idDossier:v.value.Dossier.Dossier.Id});q!==void 0&&(C.showMessage("Paiement créé avec succès."),x(),o.value?.showEditPaiement(q))}async function ie(q){await C.PaiementsUpdate(q)!==void 0&&(C.showMessage("Paiement modifié avec succès."),x())}async function X(q){await C.PaiementsDelete({id:q.Id})!==void 0&&(C.showMessage("Paiement supprimé avec succès."),x())}async function fe(q){v.value==null||await C.EventsSendMessage({IdDossier:v.value.Dossier.Dossier.Id,Contenu:q})===void 0||(C.showMessage("Message envoyé avec succès."),x())}async function Ve(q){await C.EventsDelete({id:q.Id})!==void 0&&(C.showMessage("Message supprimé avec succès."),x())}async function $(){v.value==null||await C.EventsSendFacture({idDossier:v.value.Dossier.Dossier.Id})===void 0||(C.showMessage("Demande de règlement envoyé avec succès."),x())}const g=D(!1),T=D(null);async function L(q,H){T.value={Current:0,Total:H.length};const de=await C.EventsSendDocumentsCamp({IdCamp:q,IdDossiers:H});if(de===void 0){T.value=null;return}await Vt(de,ce=>T.value=ce,ce=>C.onError("Envoi des documents",ce)),T.value=null,x(),C.showMessage("Documents du séjour envoyés avec succès.")}const ye=D(!1),ne=D(null);async function Ae(q,H){ne.value={Current:0,Total:H.length};const de=await C.EventsSendRelancePaiement({IdDossiers:H});if(de===void 0){ne.value=null;return}await Vt(de,ce=>ne.value=ce,ce=>C.onError("Envoi de la relance",ce)),ne.value=null,x(),C.showMessage("Toutes les relances ont été envoyées avec succès.")}const _e=D(!1);return(q,H)=>(b(),w(h,{"no-gutters":"",class:"ma-2"},{default:t(()=>[e(V,{cols:"6"},{default:t(()=>[e(N,{title:"Dossiers",subtitle:c.value==null?"-":`${c.value.length} affiché(s) / ${c.value.total}`},{append:t(()=>[e(F,{icon:"",size:"small",onClick:H[0]||(H[0]=de=>_.value=!0)},{default:t(()=>[e(pe,{color:"green"},{default:t(()=>[...H[9]||(H[9]=[y("mdi-plus",-1)])]),_:1})]),_:1}),e(ue,{thickness:"1",vertical:"",class:"mx-2"}),e(F,{size:"small"},{prepend:t(()=>[e(pe,null,{default:t(()=>[...H[10]||(H[10]=[y("mdi-send-circle-outline",-1)])]),_:1})]),default:t(()=>[H[11]||(H[11]=y(" Actions ",-1)),e(Ie,{activator:"parent"},{default:t(()=>[e(ke,{density:"compact"},{default:t(()=>[e(Y,{title:"Estimation des remises","prepend-icon":"mdi-finance",onClick:H[1]||(H[1]=de=>_e.value=!0)}),e(ue),e(Y,{title:"Documents...",subtitle:"Paramétrer et envoyer les documents d'un séjour","prepend-icon":"mdi-mail",onClick:H[2]||(H[2]=de=>g.value=!0)}),e(ue),e(Y,{title:"Relance de paiement...",subtitle:"Paramétrer et envoyer une relance, pour un séjour","prepend-icon":"mdi-invoice-send",onClick:H[3]||(H[3]=de=>ye.value=!0)})]),_:1})]),_:1})]),_:1})]),default:t(()=>[e(B,null,{default:t(()=>[e(au,{camps:u.value,"allow-fonds-soutien":U(C).isFondsSoutien,selected:v.value?.Dossier.Dossier.Id,query:a.value,"onUpdate:query":H[4]||(H[4]=de=>a.value=de),onClick:k,onUpdate:n,ref_key:"dossierList",ref:d},null,8,["camps","allow-fonds-soutien","selected","query"])]),_:1})]),_:1},8,["subtitle"])]),_:1}),e(V,{cols:"6"},{default:t(()=>[v.value!=null?(b(),w(tu,{key:0,dossier:v.value,camps:u.value,onUpdateDossier:A,onDeleteDossier:z,onMergeDossier:Z,onCreateParticipant:S,onUpdateParticipant:f,onDeleteParticipant:K,onExpandParticipant:ge,onCreateAide:J,onDeleteAide:O,onUpdateAide:I,onDeleteFileAide:le,onUploadFileAide:ae,onCreatePaiement:j,onUpdatePaiement:ie,onDeletePaiement:X,onSendMessage:fe,onDeleteMessage:Ve,onSendFacture:$,ref_key:"detailsPannel",ref:o},null,8,["dossier","camps"])):(b(),Q("div",su," Sélectionner un dossier... "))]),_:1}),e(ee,{modelValue:_.value,"onUpdate:modelValue":H[5]||(H[5]=de=>_.value=de),"max-width":"400px"},{default:t(()=>[e(lu,{onCreate:P})]),_:1},8,["modelValue"]),e(ee,{modelValue:g.value,"onUpdate:modelValue":H[6]||(H[6]=de=>g.value=de),"max-width":"1000px"},{default:t(()=>[e(nu,{camps:u.value,onSend:L},null,8,["camps"])]),_:1},8,["modelValue"]),e(ee,{modelValue:ye.value,"onUpdate:modelValue":H[7]||(H[7]=de=>ye.value=de),"max-width":"1000px"},{default:t(()=>[e(uu,{camps:u.value,onSend:Ae},null,8,["camps"])]),_:1},8,["modelValue"]),e(ee,{"model-value":T.value!=null,"max-width":"400px",persistent:""},{default:t(()=>[T.value?(b(),w(_t,{key:0,title:"Envoi des documents en cours",current:T.value.Current,total:T.value.Total},null,8,["current","total"])):W("",!0)]),_:1},8,["model-value"]),e(ee,{"model-value":ne.value!=null,"max-width":"400px",persistent:""},{default:t(()=>[ne.value?(b(),w(_t,{key:0,title:"Envoi des relances en cours",current:ne.value.Current,total:ne.value.Total},null,8,["current","total"])):W("",!0)]),_:1},8,["model-value"]),e(ee,{modelValue:_e.value,"onUpdate:modelValue":H[8]||(H[8]=de=>_e.value=de),"max-width":"800px"},{default:t(()=>[e(iu)]),_:1},8,["modelValue"])]),_:1}))}}),ru=G({__name:"inscriptions",setup(l){const s=ut(),o=R(()=>fu(s.currentRoute.value.query)),c=R(()=>o.value.tab||"insc"),a=R(()=>o.value.idDossier);function u(m){const n=s.currentRoute.value;s.push({path:n.path,query:{tab:m}})}return(m,n)=>(b(),Q(te,null,[e(yt,{title:"Suivi des inscriptions"},{default:t(()=>[e(Ra,{"model-value":c.value,"onUpdate:modelValue":n[0]||(n[0]=d=>u(d))},{default:t(()=>[e(Ot,{value:"insc"},{default:t(()=>[...n[2]||(n[2]=[y("Inscriptions en attente",-1)])]),_:1}),e(Ot,{value:"doss"},{default:t(()=>[...n[3]||(n[3]=[y("Suivi des dossiers",-1)])]),_:1})]),_:1},8,["model-value"])]),_:1}),e(Ua,{"model-value":c.value},{default:t(()=>[e(Nt,{value:"insc"},{default:t(()=>[e(Vn,{onGoTo:U(Ct),onEmpty:n[1]||(n[1]=d=>U(Ct)())},null,8,["onGoTo"])]),_:1}),e(Nt,{value:"doss"},{default:t(()=>[e(ou,{"initial-dossier":a.value},null,8,["initial-dossier"])]),_:1})]),_:1},8,["model-value"])],64))}}),du=G({__name:"PersonneEdit",props:{personne:{}},emits:["save"],setup(l,{emit:s}){const o=l,c=s,a=D(De(o.personne)),u=R(()=>!!(a.value.Nom&&a.value.Prenom));return(m,n)=>{const d=Ea,i=Ta;return b(),w(N,{title:"Editer le profil"},{default:t(()=>[e(B,null,{default:t(()=>[e(Na,null,{default:t(()=>[e(h,null,{default:t(()=>[e(V,null,{default:t(()=>[e(ve,{autofocus:"","hide-details":"",label:"Nom",density:"compact",variant:"outlined",modelValue:a.value.Nom,"onUpdate:modelValue":n[0]||(n[0]=r=>a.value.Nom=r)},null,8,["modelValue"])]),_:1}),e(V,null,{default:t(()=>[e(ve,{"hide-details":"",label:"Prénom",density:"compact",variant:"outlined",modelValue:a.value.Prenom,"onUpdate:modelValue":n[1]||(n[1]=r=>a.value.Prenom=r)},null,8,["modelValue"])]),_:1}),e(V,null,{default:t(()=>[e(d,{modelValue:a.value.Sexe,"onUpdate:modelValue":n[2]||(n[2]=r=>a.value.Sexe=r)},null,8,["modelValue"])]),_:1}),e(V,null,{default:t(()=>[e(i,{modelValue:a.value.DateNaissance,"onUpdate:modelValue":n[3]||(n[3]=r=>a.value.DateNaissance=r)},null,8,["modelValue"])]),_:1})]),_:1}),e(h,null,{default:t(()=>[e(V,null,{default:t(()=>[e(ve,{"hide-details":"",label:"Adresse",density:"compact",variant:"outlined",modelValue:a.value.Adresse,"onUpdate:modelValue":n[4]||(n[4]=r=>a.value.Adresse=r)},null,8,["modelValue"])]),_:1}),e(V,null,{default:t(()=>[e(ve,{"hide-details":"",label:"Code postal",density:"compact",variant:"outlined",modelValue:a.value.CodePostal,"onUpdate:modelValue":n[5]||(n[5]=r=>a.value.CodePostal=r)},null,8,["modelValue"])]),_:1}),e(V,null,{default:t(()=>[e(ve,{"hide-details":"",label:"Ville",density:"compact",variant:"outlined",modelValue:a.value.Ville,"onUpdate:modelValue":n[6]||(n[6]=r=>a.value.Ville=r)},null,8,["modelValue"])]),_:1})]),_:1})]),_:1})]),_:1}),e(re,null,{default:t(()=>[e(oe),e(F,{disabled:!u.value,onClick:n[7]||(n[7]=r=>c("save",a.value))},{default:t(()=>[...n[8]||(n[8]=[y("Enregistrer",-1)])]),_:1},8,["disabled"])]),_:1})]),_:1})}}}),mu=G({__name:"annuaire",setup(l){const s=ut(),o=R(()=>yu(s.currentRoute.value.query)),c=R(()=>o.value.idPersonne);$e(()=>c.value,()=>c.value!==void 0?r(c.value):null,{immediate:!0});const a=D([]),u=D("");async function m(){if(!u.value)return;const v=await C.PersonnesGet({search:u.value});v!==void 0&&(a.value=v||[])}async function n(){const v=await C.PersonnesCreate();v!==void 0&&(C.showMessage("Profil créé avec succès."),a.value.push(v),Ze(v.Id))}const d=D(null);async function i(v){d.value=null;const p=await C.PersonnesUpdate(v);if(p===void 0)return;C.showMessage("Profil modifié avec succès."),Ze();const k=a.value.findIndex(x=>x.Id==v.Id);a.value[k]=p}async function r(v){const p=await C.PersonnesLoad({id:v});p!==void 0&&(d.value=p)}return(v,p)=>{const k=il;return b(),Q(te,null,[e(yt,{title:"Annuaire : personnes et organismes"},{default:t(()=>[...p[2]||(p[2]=[y(" TODO ",-1)])]),_:1}),e(N,{class:"ma-2"},{append:t(()=>[e(F,{color:"green",onClick:n},{default:t(()=>[...p[3]||(p[3]=[y("Créer un nouveau profil",-1)])]),_:1})]),default:t(()=>[e(B,null,{default:t(()=>[e(h,null,{default:t(()=>[e(V,null,{default:t(()=>[e(k,{"prepend-inner-icon":"mdi-magnify",label:"Recherche",modelValue:u.value,"onUpdate:modelValue":[p[0]||(p[0]=x=>u.value=x),m]},null,8,["modelValue"]),e(ke,null,{default:t(()=>[(b(!0),Q(te,null,me(a.value,x=>(b(),w(Y,{title:x.Label,subtitle:U(xe).dateNaissance(x.DateNaissance),"prepend-icon":U(xe).sexeIcon(x.Sexe),onClick:_=>U(Ze)(x.Id)},ft({_:2},[x.IsTemp?{name:"append",fn:t(()=>[e(be,{"prepend-icon":"mdi-alert",color:"warning"},{default:t(()=>[...p[4]||(p[4]=[y(" Ce profil est temporaire et devrait être identifié. ",-1)])]),_:1})]),key:"0"}:void 0]),1032,["title","subtitle","prepend-icon","onClick"]))),256))]),_:1})]),_:1}),e(V)]),_:1})]),_:1}),d.value!=null?(b(),w(ee,{key:0,"model-value":d.value!=null,"onUpdate:modelValue":p[1]||(p[1]=x=>{d.value=null,U(Ze)(void 0)}),"max-width":"800px"},{default:t(()=>[e(du,{personne:d.value,onSave:i},null,8,["personne"])]),_:1},8,["model-value"])):W("",!0)]),_:1})],64)}}}),cu=[{path:"/",component:Ba},{path:"/camps",component:yn},{path:"/inscriptions",component:ru},{path:"/annuaire",component:mu}],vu="/backoffice",Xe=ga({history:Va(vu),routes:cu});Xe.onError((l,s)=>{l?.message?.includes?.("Failed to fetch dynamically imported module")?localStorage.getItem("vuetify:dynamic-reload")?console.error("Dynamic import error, reloading page did not fix it",l):(console.log("Reloading page to fix dynamic import error"),localStorage.setItem("vuetify:dynamic-reload","true"),location.assign(s.fullPath)):console.error(l)});Xe.isReady().then(()=>{localStorage.removeItem("vuetify:dynamic-reload")});function pt(l){return l?Number(l):void 0}function pu(l){const s=l;return{idCamp:pt(s.idCamp),idParticipant:pt(s.idParticipant)}}function Dt(l){Xe.push({path:"/camps",query:{idCamp:l.IdCamp,idParticipant:l.Id}})}function fu(l){const s=l;return{tab:s.tab,idDossier:pt(s.idDossier)}}function Ct(l){Xe.push({path:"/inscriptions",query:{tab:"doss",idDossier:l}})}function yu(l){return{idPersonne:pt(l.idPersonne)}}function Ze(l){Xe.push({path:"/annuaire",query:{idPersonne:l}})}const bu=["innerHTML"],gu=G({__name:"App",setup(l){const s=gt({text:"",color:"secondary",action:void 0,timeout:4e3}),o=D(""),c=D("");return C.onError=(u,m)=>{o.value=u,c.value=m},C.showMessage=(u,m,n)=>{s.text=u,s.color=m||"success",s.action=n,s.timeout=1e4,s.timeout=4e3},ut().beforeEach(async(u,m)=>{if(!C.hasToken()&&u.path!=="/")return{path:"/"}}),(u,m)=>{const n=va("router-view");return b(),w(fa,null,{default:t(()=>[e(pa,null,{default:t(()=>[e(n),e(ht,{style:{"z-index":"10000"},app:"","model-value":s.text!="","onUpdate:modelValue":m[1]||(m[1]=d=>s.text=""),timeout:s.timeout,color:s.color,location:"bottom left","close-on-content-click":""},{default:t(()=>[y(M(s.text)+" ",1),s.action?(b(),w(F,{key:0,onClick:m[0]||(m[0]=d=>s.action.action()),class:"ml-2"},{default:t(()=>[y(M(s.action.title),1)]),_:1})):W("",!0)]),_:1},8,["model-value","timeout","color"]),e(ht,{app:"","model-value":o.value!="","onUpdate:modelValue":m[2]||(m[2]=d=>o.value=""),timeout:4e3,color:"red"},{default:t(()=>[E("b",null,M(o.value),1),E("div",{innerHTML:c.value},null,8,bu)]),_:1},8,["model-value"])]),_:1})]),_:1})}}}),bl=ya(gu);bl.use(ba).use(Xe);bl.mount("#app");
