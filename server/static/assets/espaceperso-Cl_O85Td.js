import{cx as J,b7 as Le,b9 as Ie,d as G,k as D,s as f,o,V as De,w as e,b as t,f as Me,g as h,h as v,i as Re,e as a,t as k,r as Ee,j as S,a as M,F as E,a1 as j,_ as P,a4 as ne,aG as be,n as T,a3 as N,c as H,T as fe,aT as Fe,aS as Te,a0 as A,aa as de,a2 as Q,bG as ye,bH as ke,B as me,ag as ve,aB as te,v as $e,x as Ne,y as qe,ak as je,J as Be,bx as ze,R as He,L as Oe,cg as Je,z as Ke,E as Ge,ap as Ze,aq as We,ar as Qe,au as Xe,av as Ye,I as Ce,q as et,u as tt,a_ as lt,az as we,a8 as at,aZ as Ue,Z as nt,bl as st,aQ as Se,aO as ot,p as ut,b1 as it,b2 as _e,b3 as rt,b4 as dt,b5 as mt}from"./VSnackbar-BDFFDPik.js";import{_ as ct,V as pt,a as ft}from"./EventSwitch.vue_vue_type_script_setup_true_lang-C3XAdpVQ.js";import{f as vt,_ as gt,c as bt,d as Vt,V as Ae,b as yt,e as kt,a as Ct}from"./VTabs-DC1K_KeP.js";import{b as R,c as I,k as X,d as le,e as ae,f as ce,l as Pe,V as q,g as St,h as pe,a as ge,i as W,m as se,j as ue,n as he}from"./VTextarea-BbtyCEWP.js";import{a as _t,V as Pt}from"./FileCard.vue_vue_type_script_setup_true_lang-BHMbK7fy.js";import{_ as ht}from"./FilesDemande.vue_vue_type_script_setup_true_lang-gdZXA4wU.js";import"./VWindowItem-C9T8cfIa.js";import"./FilesRow.vue_vue_type_script_setup_true_lang-Bgpi2W1v.js";const ie={CampDocs:"CampDocs",Facture:"Facture",PlaceLiberee:"PlaceLiberee",Sondage:"Sondage",Validation:"Validation"},re={Complet:3,EnCours:2,NonCommence:1};re.Complet+"",re.EnCours+"",re.NonCommence+"";const O={AStatuer:0,Refuse:1,AttenteProfilInvalide:2,AttenteCampComplet:3,EnAttenteReponse:4,Inscrit:5},wt={[O.AStatuer]:"En attente de validation",[O.Refuse]:"Refusé définitivement",[O.AttenteProfilInvalide]:"Profil limite",[O.AttenteCampComplet]:"Camp complet",[O.EnAttenteReponse]:"En attente de réponse",[O.Inscrit]:"Inscrit"},Ut={Euros:0},K={Cheque:0,EnLigne:1,Virement:2,Especes:3,Ancv:4,Helloasso:5},At={[K.Cheque]:"Chèque",[K.EnLigne]:"Carte bancaire (en ligne)",[K.Virement]:"Virement",[K.Especes]:"Espèces",[K.Ancv]:"ANCV",[K.Helloasso]:"Helloasso"},xt={Espaceperso:0},z={NoBuiltin:0,CarteId:1,Permis:2,SB:3,Secourisme:4,Bafa:5,Bafd:6,CarteVitale:7,Vaccins:8,Haccp:9,BafdEquiv:10,BafaEquiv:11,CertMedicalCuisine:12,Scolarite:13,Autre:14,nbCategorieEquipier:15};z.NoBuiltin+"",z.CarteId+"",z.Permis+"",z.SB+"",z.Secourisme+"",z.Bafa+"",z.Bafd+"",z.CarteVitale+"",z.Vaccins+"",z.Haccp+"",z.BafdEquiv+"",z.BafaEquiv+"",z.CertMedicalCuisine+"",z.Scolarite+"",z.Autre+"",z.nbCategorieEquipier+"";const oe={NoFiche:0,Outdated:1,UpToDate:2};oe.NoFiche+"",oe.Outdated+"",oe.UpToDate+"";class Lt{constructor(n,l){this.baseURL=n,this.authToken=l}getHeaders(){return{Authorization:"Bearer "+this.authToken}}DownloadAttestationPresence(n){return this.baseURL+`/api/v1/espaceperso/download/attestation?token=${n}`}DownloadFacture(n){return this.baseURL+`/api/v1/espaceperso/download/facture?token=${n}`}async Load(n){const l=this.baseURL+"/api/v1/espaceperso";this.startRequest();try{return(await J.get(l,{headers:this.getHeaders(),params:{token:n.token}})).data}catch(s){this.handleError(s)}}async SendMessage(n){const l=this.baseURL+"/api/v1/espaceperso/message";this.startRequest();try{return(await J.post(l,n,{headers:this.getHeaders()})).data}catch(s){this.handleError(s)}}async UpdateParticipants(n){const l=this.baseURL+"/api/v1/espaceperso/participants";this.startRequest();try{return await J.post(l,n,{headers:this.getHeaders()}),!0}catch(s){this.handleError(s)}}async CreateAide(n,l,s){const i=this.baseURL+"/api/v1/espaceperso/aide";this.startRequest();try{const c=new FormData;return c.append("document",n,n.name),c.append("aide",JSON.stringify(l)),await J.post(i,c,{headers:this.getHeaders(),params:{token:s.token}}),!0}catch(c){this.handleError(c)}}async GetStructureaides(){const n=this.baseURL+"/api/v1/espaceperso/structureaides";this.startRequest();try{return(await J.get(n,{headers:this.getHeaders()})).data}catch(l){this.handleError(l)}}async LoadJoomeo(n){const l=this.baseURL+"/api/v1/espaceperso/joomeo";this.startRequest();try{return(await J.get(l,{headers:this.getHeaders(),params:{token:n.token}})).data}catch(s){this.handleError(s)}}async UpdateFichesanitaire(n){const l=this.baseURL+"/api/v1/espaceperso/fichesanitaires";this.startRequest();try{return await J.post(l,n,{headers:this.getHeaders()}),!0}catch(s){this.handleError(s)}}async TransfertFicheSanitaire(n){const l=this.baseURL+"/api/v1/espaceperso/fichesanitaires/transfert";this.startRequest();try{return await J.put(l,null,{headers:this.getHeaders(),params:{token:n.token,idPersonne:String(n.idPersonne)}}),!0}catch(s){this.handleError(s)}}async AcceptePlaceLiberee(n){const l=this.baseURL+"/api/v1/espaceperso/events/accept-place-liberee";this.startRequest();try{return await J.post(l,null,{headers:this.getHeaders(),params:{token:n.token,idEvent:String(n.idEvent)}}),!0}catch(s){this.handleError(s)}}async LoadSondages(n){const l=this.baseURL+"/api/v1/espaceperso/sondages";this.startRequest();try{return(await J.get(l,{headers:this.getHeaders(),params:{token:n.token}})).data}catch(s){this.handleError(s)}}async UpdateSondages(n){const l=this.baseURL+"/api/v1/espaceperso/sondages";this.startRequest();try{return await J.post(l,n,{headers:this.getHeaders()}),!0}catch(s){this.handleError(s)}}async LoadDocuments(n){const l=this.baseURL+"/api/v1/espaceperso/documents";this.startRequest();try{return(await J.get(l,{headers:this.getHeaders(),params:{token:n.token}})).data}catch(s){this.handleError(s)}}async UploadDocument(n,l){const s=this.baseURL+"/api/v1/espaceperso/documents";this.startRequest();try{const i=new FormData;return i.append("file",n,n.name),(await J.post(s,i,{headers:this.getHeaders(),params:{token:l.token,idDemande:String(l.idDemande),idPersonne:String(l.idPersonne)}})).data}catch(i){this.handleError(i)}}async DeleteDocument(n){const l=this.baseURL+"/api/v1/espaceperso/documents";this.startRequest();try{return await J.delete(l,{headers:this.getHeaders(),params:{key:n.key}}),!0}catch(s){this.handleError(s)}}}class It extends Lt{constructor(n,l,s){super(s,""),this.onError=n,this.showMessage=l}handleError(n){const{kind:l,messageHtml:s}=Ie(n);this.onError(l,s)}startRequest(){}}const U=new It((r,n)=>{},(r,n)=>{},Le()),Dt=G({__name:"NavBar",props:{title:{},hideMenu:{type:Boolean}},setup(r){const n=r,l="/static/repere/logo.png";return D(!1),(s,i)=>(o(),f(De,{rounded:"",elevation:"4",color:"secondary"},{append:e(()=>[Ee(s.$slots,"default"),i[0]||(i[0]=S("div",{class:"mr-2"},null,-1))]),default:e(()=>[t(Me,null,{default:e(()=>[t(h,null,{default:e(()=>[t(v,{"align-self":"center",cols:"auto"},{default:e(()=>[t(Re,{width:"60",src:l})]),_:1}),t(v,{"align-self":"center"},{default:e(()=>[a(k(n.title),1)]),_:1})]),_:1})]),_:1})]),_:3}))}}),Mt=G({__name:"ParticipantsEditCard",props:{participants:{}},emits:["save"],setup(r,{emit:n}){const l=r,s=n,i=D(l.participants.map(c=>c.Participant));return(c,V)=>{const p=vt;return o(),f(R,{title:"Modifier les options"},{default:e(()=>[t(I,null,{default:e(()=>[t(h,null,{default:e(()=>[(o(!0),M(E,null,j(l.participants,(d,m)=>(o(),f(v,{cols:"6"},{default:e(()=>[t(R,{title:P(be).label(d.Personne),subtitle:P(ne).label(d.Camp)},{default:e(()=>[t(I,null,{default:e(()=>[t(h,null,{default:e(()=>[t(v,null,{default:e(()=>[d.Camp.Navette.Actif?(o(),f(p,{key:0,modelValue:i.value[m].Navette,"onUpdate:modelValue":g=>i.value[m].Navette=g,hint:d.Camp.Navette.Commentaire},null,8,["modelValue","onUpdate:modelValue","hint"])):(o(),f(X,{key:1},{default:e(()=>[...V[1]||(V[1]=[a("Ce séjour ne propose pas de navette.",-1)])]),_:1}))]),_:2},1024)]),_:2},1024),t(h,null,{default:e(()=>[t(v,null,{default:e(()=>[t(le,{modelValue:i.value[m].Commentaire,"onUpdate:modelValue":g=>i.value[m].Commentaire=g,label:"Information libre",density:"compact",variant:"outlined","hide-details":""},null,8,["modelValue","onUpdate:modelValue"])]),_:2},1024)]),_:2},1024),t(h,null,{default:e(()=>[t(v,null,{default:e(()=>[...V[2]||(V[2]=[a(" TODO: option prix ",-1)])]),_:1})]),_:1})]),_:2},1024)]),_:2},1032,["title","subtitle"])]),_:2},1024))),256))]),_:1})]),_:1}),t(ae,null,{default:e(()=>[t(ce),t(T,{onClick:V[0]||(V[0]=d=>s("save",i.value)),color:"green"},{prepend:e(()=>[t(N,null,{default:e(()=>[...V[3]||(V[3]=[a("mdi-content-save-cog",-1)])]),_:1})]),default:e(()=>[V[4]||(V[4]=a(" Enregistrer",-1))]),_:1})]),_:1})]),_:1})}}}),Rt=G({__name:"AideCard",props:{dossier:{},structureaides:{}},emits:["save"],setup(r,{emit:n}){const l=r,s=n,i=D({Id:0,IdStructureaide:0,IdParticipant:(l.dossier.Participants||[])[0].Participant.Id,Valide:!1,Valeur:{Currency:Ut.Euros,Cent:0},ParJour:!1,NbJoursMax:0}),c=D(null),V=H(()=>i.value?c.value!=null&&i.value.IdParticipant!=0&&i.value.IdStructureaide!=0&&i.value.Valeur.Cent!=0:!1),p=H(()=>(l.dossier.Participants||[]).map(m=>({title:be.label(m.Personne),subtitle:ne.label(m.Camp),value:m.Participant.Id}))),d=H(()=>Object.values(l.structureaides||{}).map(m=>({value:m.Id,title:m.Nom})));return(m,g)=>{const b=ct,y=gt,B=_t;return o(),f(R,{title:"Ajouter une aide extérieure",subtitle:"Cette aide sera vérifiée par le centre."},{default:e(()=>[t(I,null,{default:e(()=>[t(h,null,{default:e(()=>[t(v,null,{default:e(()=>[t(Pe,{variant:"outlined",density:"comfortable",label:"Participant concerné",modelValue:i.value.IdParticipant,"onUpdate:modelValue":g[0]||(g[0]=x=>i.value.IdParticipant=x),items:p.value},{item:e(({item:x,props:F})=>[t(q,fe(F,{title:x.raw.title,subtitle:x.raw.subtitle}),null,16,["title","subtitle"])]),_:1},8,["modelValue","items"])]),_:1})]),_:1}),t(h,null,{default:e(()=>[t(v,null,{default:e(()=>[t(Pe,{variant:"outlined",density:"comfortable",label:"Structure","model-value":P(Te)(i.value.IdStructureaide),"onUpdate:modelValue":g[1]||(g[1]=x=>i.value.IdStructureaide=P(Fe)(x)),items:d.value,"no-data-text":"Aucune structure n'est disponible."},null,8,["model-value","items"])]),_:1})]),_:1}),t(h,null,{default:e(()=>[t(v,{"align-self":"center"},{default:e(()=>[t(b,{label:"Valeur",modelValue:i.value.Valeur,"onUpdate:modelValue":g[2]||(g[2]=x=>i.value.Valeur=x),"hide-details":""},null,8,["modelValue"])]),_:1})]),_:1}),t(h,null,{default:e(()=>[t(v,{"align-self":"center"},{default:e(()=>[t(St,{modelValue:i.value.ParJour,"onUpdate:modelValue":g[3]||(g[3]=x=>i.value.ParJour=x),label:"Montant par jour","hide-details":""},null,8,["modelValue"])]),_:1}),t(v,{"align-self":"center"},{default:e(()=>[i.value.ParJour?(o(),f(y,{key:0,label:"Limite sur le nombre de jours",modelValue:i.value.NbJoursMax,"onUpdate:modelValue":g[4]||(g[4]=x=>i.value.NbJoursMax=x),min:0,hint:"0 pour ne pas limiter","persistent-hint":""},null,8,["modelValue"])):A("",!0)]),_:1})]),_:1}),t(h,null,{default:e(()=>[t(v,null,{default:e(()=>[t(B,{label:"Pièce justificative",onUpdate:g[5]||(g[5]=x=>c.value=x)})]),_:1})]),_:1})]),_:1}),t(ae,null,{default:e(()=>[t(ce),t(T,{color:"green",disabled:!V.value,onClick:g[6]||(g[6]=x=>s("save",i.value,c.value))},{default:e(()=>[...g[7]||(g[7]=[a(" Ajouter pour vérification ",-1)])]),_:1},8,["disabled"])]),_:1})]),_:1})}}}),Et={key:0},Ft=G({__name:"FinancesCard",props:{token:{},dossier:{},isPaiementOpen:{type:Boolean}},emits:["refresh","showReglement"],setup(r,{emit:n}){const l=r,s=n;de(m);const i=D(!1);async function c(g,b){i.value=!1,await U.CreateAide(b,g,{token:l.token})!==void 0&&(U.showMessage("Aide ajoutée avec succès (validation à venir). Merci !"),s("refresh"))}const V=H(()=>{const g=[];return Object.values(l.dossier.Aides||{}).forEach(b=>g.push(...Object.values(b||{}))),g}),p=H(()=>V.value.filter(g=>!g.Valide).length),d=D({});async function m(){const g=await U.GetStructureaides();g!==void 0&&(d.value=g||{})}return(g,b)=>(o(),f(R,{subtitle:"Réglement",class:"mt-2"},{append:e(()=>[t(T,{size:"small",class:"mr-1",onClick:b[0]||(b[0]=y=>s("showReglement")),disabled:!l.isPaiementOpen||l.dossier.Bilan.Statut==P(re).Complet},{prepend:e(()=>[t(N,null,{default:e(()=>[...b[3]||(b[3]=[a("mdi-cash-plus",-1)])]),_:1})]),default:e(()=>[b[4]||(b[4]=a(" Régler ",-1))]),_:1},8,["disabled"]),t(T,{size:"small",disabled:!l.dossier.Participants?.length,onClick:b[1]||(b[1]=y=>i.value=!0)},{prepend:e(()=>[t(N,{color:"green"},{default:e(()=>[...b[5]||(b[5]=[a("mdi-plus",-1)])]),_:1})]),default:e(()=>[b[6]||(b[6]=a(" Ajouter une aide ",-1))]),_:1},8,["disabled"])]),default:e(()=>[t(I,null,{default:e(()=>[t(h,{class:"mt-2"},{default:e(()=>[t(v,null,{default:e(()=>[...b[7]||(b[7]=[a("Prix des séjours",-1)])]),_:1}),t(v,{cols:"4",class:"text-right"},{default:e(()=>[a(k(r.dossier.Bilan.Demande),1)]),_:1})]),_:1}),r.dossier.Bilan.DemandeEnAttenteValidation?(o(),f(h,{key:0,class:"my-2"},{default:e(()=>[t(v,{class:"text-grey"},{default:e(()=>[...b[8]||(b[8]=[a("Séjours en attente de validation",-1)])]),_:1}),t(v,{cols:"4",class:"text-right text-grey"},{default:e(()=>[a(k(r.dossier.Bilan.DemandeEnAttenteValidation),1)]),_:1})]),_:1})):A("",!0),r.dossier.Bilan.Aides?(o(),f(h,{key:1,class:"my-0"},{default:e(()=>[t(v,{cols:"auto"},{default:e(()=>[t(pe,null,{activator:e(({props:y})=>[t(N,ye(ke(y)),{default:e(()=>[...b[9]||(b[9]=[a(" mdi-view-list ",-1)])]),_:1},16)]),default:e(()=>[d.value?(o(),f(R,{key:0,title:"Aides extérieures"},{default:e(()=>[t(I,null,{default:e(()=>[(o(!0),M(E,null,j(V.value,y=>(o(),f(X,{color:y.Valide?void 0:"orange",class:"mx-1"},{default:e(()=>[a(k(d.value[y.IdStructureaide].Nom)+" : "+k(P(Q).montant(y.Valeur)),1)]),_:2},1032,["color"]))),256))]),_:1})]),_:1})):A("",!0)]),_:1})]),_:1}),t(v,null,{default:e(()=>[b[11]||(b[11]=a(" Dont aides extérieures ",-1)),p.value?(o(),f(N,{key:0,color:"orange"},{default:e(()=>[...b[10]||(b[10]=[a("mdi-clock",-1)])]),_:1})):A("",!0)]),_:1}),t(v,{cols:"4",class:"text-right"},{default:e(()=>[a(k(r.dossier.Bilan.Aides),1)]),_:1})]),_:1})):A("",!0),t(ge,{thickness:"1"}),t(h,{class:"my-0"},{default:e(()=>[t(v,{cols:"auto"},{default:e(()=>[t(pe,null,{activator:e(({props:y})=>[t(N,ye(ke(y)),{default:e(()=>[...b[12]||(b[12]=[a(" mdi-view-list ",-1)])]),_:1},16)]),default:e(()=>[t(R,{title:"Paiements"},{default:e(()=>[t(I,null,{default:e(()=>[Object.values(l.dossier.Paiements||{}).length?A("",!0):(o(),M("i",Et," Aucun paiement n'a encore été enregistré. ")),(o(!0),M(E,null,j(l.dossier.Paiements,y=>(o(),f(X,{class:"mx-1"},{default:e(()=>[a(k(y.Payeur)+" : "+k(P(Q).montant(y.Montant)),1)]),_:2},1024))),256))]),_:1})]),_:1})]),_:1})]),_:1}),t(v,null,{default:e(()=>[...b[13]||(b[13]=[a(" Paiements ",-1)])]),_:1}),t(v,{cols:"4",class:"text-right"},{default:e(()=>[a(k(r.dossier.Bilan.Recu),1)]),_:1})]),_:1}),t(ge,{thickness:"1"}),t(h,{class:"my-0"},{default:e(()=>[t(v,null,{default:e(()=>[...b[14]||(b[14]=[a("Montant restant à régler",-1)])]),_:1}),t(v,{cols:"4",class:"text-right"},{default:e(()=>[S("b",{class:me(r.dossier.Bilan.Statut==P(re).Complet?"text-green":"text-orange")},k(r.dossier.Bilan.Restant),3)]),_:1})]),_:1})]),_:1}),t(W,{modelValue:i.value,"onUpdate:modelValue":b[2]||(b[2]=y=>i.value=y),"max-width":"450px"},{default:e(()=>[t(Rt,{dossier:l.dossier,structureaides:d.value,onSave:c},null,8,["dossier","structureaides"])]),_:1},8,["modelValue"])]),_:1}))}}),Tt={key:0},$t=G({__name:"JoomeoCard",props:{token:{}},setup(r){const n=r;de(s);const l=D(null);async function s(){const i=await U.LoadJoomeo({token:n.token});i!==void 0&&(l.value=i)}return(i,c)=>l.value==null?(o(),f(ve,{key:0,class:"mx-auto",width:"600px",type:"card"})):l.value.Loggin?(o(),f(R,{key:1,class:"mx-auto",title:"Identifiants et albums Joomeo",subtitle:"Retrouvez les photos prises dans nos séjours.","min-width":"600px"},{default:e(()=>[t(I,null,{default:e(()=>[t(h,null,{default:e(()=>[t(v,null,{default:e(()=>[c[0]||(c[0]=a(" Identifiant : ",-1)),S("b",null,k(l.value.Loggin),1)]),_:1}),t(v,null,{default:e(()=>[c[1]||(c[1]=a(" Mot de passe : ",-1)),S("b",null,k(l.value.Password),1)]),_:1})]),_:1}),t(h,null,{default:e(()=>[t(v,null,{default:e(()=>[l.value.Albums?.length?A("",!0):(o(),M("i",Tt,"Aucun album n'est encore disponible.")),(o(!0),M(E,null,j(l.value.Albums,V=>(o(),f(X,{class:"ma-1"},{default:e(()=>[a(k(V),1)]),_:2},1024))),256))]),_:1})]),_:1})]),_:1}),t(ae,null,{default:e(()=>[t(T,{block:"",color:"primary",variant:"outlined",href:l.value.SpaceURL,target:"_blank"},{default:e(()=>[...c[2]||(c[2]=[a(" Accéder à mon espace jooméo ",-1)])]),_:1},8,["href"])]),_:1})]),_:1})):(o(),f(te,{key:2,class:"mx-auto",type:"info"},{default:e(()=>[...c[3]||(c[3]=[a(" Il n'y a encore rien à voir... ",-1)])]),_:1}))}}),Nt=Ne({name:String,itemAriaLabel:{type:String,default:"$vuetify.rating.ariaLabel.item"},activeColor:String,color:String,clearable:Boolean,disabled:Boolean,emptyIcon:{type:Ce,default:"$ratingEmpty"},fullIcon:{type:Ce,default:"$ratingFull"},halfIncrements:Boolean,hover:Boolean,length:{type:[Number,String],default:5},readonly:Boolean,modelValue:{type:[Number,String],default:0},itemLabels:Array,itemLabelPosition:{type:String,default:"top",validator:r=>["top","bottom"].includes(r)},ripple:Boolean,...Ye(),...Xe(),...Qe(),...We(),...Ze()},"VRating"),qt=$e()({name:"VRating",props:Nt(),emits:{"update:modelValue":r=>!0},setup(r,n){let{slots:l}=n;const{t:s}=qe(),{themeClasses:i}=je(r),c=Be(r,"modelValue"),V=H(()=>ze(parseFloat(c.value),0,Number(r.length))),p=H(()=>He(Number(r.length),1)),d=H(()=>p.value.flatMap(_=>r.halfIncrements?[_-.5,_]:[_])),m=Oe(-1),g=H(()=>d.value.map(_=>{const w=r.hover&&m.value>-1,$=V.value>=_,L=m.value>=_,Y=(w?L:$)?r.fullIcon:r.emptyIcon,C=r.activeColor??r.color,Z=$||L?C:r.color;return{isFilled:$,isHovered:L,icon:Y,color:Z}})),b=H(()=>[0,...d.value].map(_=>{function w(){m.value=_}function $(){m.value=-1}function L(){r.disabled||r.readonly||(c.value=V.value===_&&r.clearable?0:_)}return{onMouseenter:r.hover?w:void 0,onMouseleave:r.hover?$:void 0,onClick:L}})),y=Je(),B=H(()=>r.name??`v-rating-${y}`);function x(_){let{value:w,index:$,showStar:L=!0}=_;const{onMouseenter:u,onMouseleave:Y,onClick:C}=b.value[$+1],Z=`${B.value}-${String(w).replace(".","-")}`,Ve={color:g.value[$]?.color,density:r.density,disabled:r.disabled,icon:g.value[$]?.icon,ripple:r.ripple,size:r.size,variant:"plain"};return S(E,null,[S("label",{for:Z,class:me({"v-rating__item--half":r.halfIncrements&&w%1>0,"v-rating__item--full":r.halfIncrements&&w%1===0}),onMouseenter:u,onMouseleave:Y,onClick:C},[S("span",{class:"v-rating__hidden"},[s(r.itemAriaLabel,w,r.length)]),L?l.item?l.item({...g.value[$],props:Ve,value:w,index:$,rating:V.value}):t(T,fe({"aria-label":s(r.itemAriaLabel,w,r.length)},Ve),null):void 0]),S("input",{class:"v-rating__hidden",name:B.value,id:Z,type:"radio",value:w,checked:V.value===w,tabindex:-1,readonly:r.readonly,disabled:r.disabled},null)])}function F(_){return l["item-label"]?l["item-label"](_):_.label?S("span",null,[_.label]):S("span",null,[a(" ")])}return Ke(()=>{const _=!!r.itemLabels?.length||l["item-label"];return t(r.tag,{class:me(["v-rating",{"v-rating--hover":r.hover,"v-rating--readonly":r.readonly},i.value,r.class]),style:Ge(r.style)},{default:()=>[t(x,{value:0,index:-1,showStar:!1},null),p.value.map((w,$)=>S("div",{class:"v-rating__wrapper"},[_&&r.itemLabelPosition==="top"?F({value:w,index:$,label:r.itemLabels?.[$]}):void 0,S("div",{class:"v-rating__item"},[r.halfIncrements?S(E,null,[t(x,{value:w-.5,index:$*2},null),t(x,{value:w,index:$*2+1},null)]):t(x,{value:w,index:$},null)]),_&&r.itemLabelPosition==="bottom"?F({value:w,index:$,label:r.itemLabels?.[$]}):void 0]))]})}),{}}}),ee=G({__name:"RatingField",props:et({label:{}},{modelValue:{required:!0},modelModifiers:{}}),emits:["update:modelValue"],setup(r){const n=r,l=tt(r,"modelValue");return(s,i)=>(o(),f(h,{"no-gutters":""},{default:e(()=>[t(v,{cols:"12"},{default:e(()=>[a(k(n.label),1)]),_:1}),t(v,{cols:"12"},{default:e(()=>[t(qt,{hover:"",color:"primary",length:4,modelValue:l.value,"onUpdate:modelValue":i[0]||(i[0]=c=>l.value=c),size:"32"},null,8,["modelValue"])]),_:1})]),_:1}))}}),jt={key:1},Bt=G({__name:"SondagesCard",props:{token:{},initialCamp:{}},setup(r){const n=r;de(i);const l=D(0),s=D(null);async function i(){const p=await U.LoadSondages({token:n.token});if(p===void 0)return;s.value=p||[];const d=(p||[]).filter(c);(p||[]).map(m=>m.Sondage.IdCamp).includes(n.initialCamp)?l.value=n.initialCamp:d.length?l.value=d[0].Sondage.IdCamp:l.value==0&&p?.length&&(l.value=p[0].Sondage.IdCamp)}function c(p){return lt(p.Sondage.Modified)}async function V(p){await U.UpdateSondages({Token:n.token,Id:p.Id,IdCamp:p.IdCamp,Reponse:p})!==void 0&&(i(),U.showMessage("Votre réponse a bien été enregistrée. Merci !"))}return(p,d)=>s.value==null?(o(),f(ve,{key:0,type:"card"})):s.value!=null?(o(),f(R,{key:1,title:"Enquête de satisfaction",width:s.value?.length?void 0:"600px",class:"mx-auto"},{default:e(()=>[t(I,null,{default:e(()=>[s.value.length?(o(),f(te,{key:0,color:"secondary",icon:"mdi-comment-quote"},{default:e(()=>[...d[1]||(d[1]=[a(" Afin d'améliorer nos prestations, nous avons à cœur de vous laisser la parole. Vos suggestions, remarques et ressentis nous aiderons à améliorer nos séjours. Merci d'avance de ce temps que vous réserverez pour répondre à cette courte enquête. ",-1)])]),_:1})):(o(),M("div",jt," L'enquête n'est pas encore ouverte. Vous pourrez revenir ici donner votre avis une fois le séjour terminé. ")),s.value.length?(o(),f(bt,{key:2,modelValue:l.value,"onUpdate:modelValue":d[0]||(d[0]=m=>l.value=m),grow:"",class:"mt-2"},{default:e(()=>[(o(!0),M(E,null,j(s.value,m=>(o(),f(Vt,{value:m.Sondage.IdCamp},{default:e(()=>[a(k(m.Camp)+" ",1),c(m)?(o(),f(Ae,{key:0,inline:"",content:"Nouveau",color:"pink"})):A("",!0)]),_:2},1032,["value"]))),256))]),_:1},8,["modelValue"])):A("",!0),t(yt,{"model-value":l.value,class:"mt-2"},{default:e(()=>[(o(!0),M(E,null,j(s.value,m=>(o(),f(kt,{value:m.Sondage.IdCamp},{default:e(()=>[t(R,{subtitle:"Vos impressions sur le séjour"},{default:e(()=>[t(I,null,{default:e(()=>[t(h,null,{default:e(()=>[t(v,{cols:"6"},{default:e(()=>[t(h,null,{default:e(()=>[t(v,null,{default:e(()=>[t(ee,{label:"Informations avant le séjour",modelValue:m.Sondage.InfosAvantSejour,"onUpdate:modelValue":g=>m.Sondage.InfosAvantSejour=g},null,8,["modelValue","onUpdate:modelValue"])]),_:2},1024),t(v,null,{default:e(()=>[t(ee,{label:"Informations pendant le séjour",modelValue:m.Sondage.InfosPendantSejour,"onUpdate:modelValue":g=>m.Sondage.InfosPendantSejour=g},null,8,["modelValue","onUpdate:modelValue"])]),_:2},1024),t(v,null,{default:e(()=>[t(ee,{label:"L'hébergement",modelValue:m.Sondage.Hebergement,"onUpdate:modelValue":g=>m.Sondage.Hebergement=g},null,8,["modelValue","onUpdate:modelValue"])]),_:2},1024)]),_:2},1024),t(h,null,{default:e(()=>[t(v,null,{default:e(()=>[t(ee,{label:"Les activités",modelValue:m.Sondage.Activites,"onUpdate:modelValue":g=>m.Sondage.Activites=g},null,8,["modelValue","onUpdate:modelValue"])]),_:2},1024),t(v,null,{default:e(()=>[t(ee,{label:"Le thème",modelValue:m.Sondage.Theme,"onUpdate:modelValue":g=>m.Sondage.Theme=g},null,8,["modelValue","onUpdate:modelValue"])]),_:2},1024),t(v,null,{default:e(()=>[t(ee,{label:"La nourriture",modelValue:m.Sondage.Nourriture,"onUpdate:modelValue":g=>m.Sondage.Nourriture=g},null,8,["modelValue","onUpdate:modelValue"])]),_:2},1024)]),_:2},1024),t(h,null,{default:e(()=>[t(v,null,{default:e(()=>[t(ee,{label:"L'hygiène corporelle et vestimentaire",modelValue:m.Sondage.Hygiene,"onUpdate:modelValue":g=>m.Sondage.Hygiene=g},null,8,["modelValue","onUpdate:modelValue"])]),_:2},1024),t(v,null,{default:e(()=>[t(ee,{label:"L'ambiance du groupe",modelValue:m.Sondage.Ambiance,"onUpdate:modelValue":g=>m.Sondage.Ambiance=g},null,8,["modelValue","onUpdate:modelValue"])]),_:2},1024),t(v,null,{default:e(()=>[t(ee,{label:"Le ressenti global de votre enfant",modelValue:m.Sondage.Ressenti,"onUpdate:modelValue":g=>m.Sondage.Ressenti=g},null,8,["modelValue","onUpdate:modelValue"])]),_:2},1024)]),_:2},1024)]),_:2},1024),t(v,{cols:"6"},{default:e(()=>[t(h,null,{default:e(()=>[t(v,{cols:"12"},{default:e(()=>[t(se,{rows:"3",label:"Message du participant",hint:"Le participant souhaite donner son avis : des regrets ? de bons souvenirs ? des propositions d'amélioration ?","persistent-hint":"",modelValue:m.Sondage.MessageEnfant,"onUpdate:modelValue":g=>m.Sondage.MessageEnfant=g},null,8,["modelValue","onUpdate:modelValue"])]),_:2},1024),t(v,null,{default:e(()=>[t(se,{rows:"3",label:"Message du responsable",hint:"En tant que responsable, vous avez une remarque, une suggestion, un ressenti à partager : avec plaisir ! Nous prendrons soin de vous apporter une réponse en cas de besoin.","persistent-hint":"",modelValue:m.Sondage.MessageResponsable,"onUpdate:modelValue":g=>m.Sondage.MessageResponsable=g},null,8,["modelValue","onUpdate:modelValue"])]),_:2},1024)]),_:2},1024)]),_:2},1024)]),_:2},1024)]),_:2},1024),t(ae,null,{default:e(()=>[t(T,{block:"",variant:"outlined",color:"success",onClick:g=>V(m.Sondage)},{prepend:e(()=>[t(N,null,{default:e(()=>[...d[2]||(d[2]=[a("mdi-content-save",-1)])]),_:1})]),default:e(()=>[a(" Enregistrer mon retour pour le séjour "+k(m.Camp),1)]),_:2},1032,["onClick"])]),_:2},1024)]),_:2},1024)]),_:2},1032,["value"]))),256))]),_:1},8,["model-value"])]),_:1})]),_:1},8,["width"])):A("",!0)}}),zt=G({__name:"FichesanitaireForm",props:{fiche:{}},emits:["save","transfert"],setup(r,{emit:n}){const l=r,s=n,i=we(at(l.fiche.Fichesanitaire)),c=H(()=>l.fiche.Fichesanitaire.Owners||[]),V=H(()=>l.fiche.State==oe.NoFiche?"A remplir":`Dernière modification : ${Q.time(l.fiche.Fichesanitaire.Modified)} / Propriétaire(s) :
         ${c.value.join(" ; ")}`);return(p,d)=>(o(),f(R,{title:`Fiche sanitaire de ${l.fiche.Personne}`,subtitle:V.value},Ue({default:e(()=>[t(I,null,{default:e(()=>[l.fiche.IsLocked?(o(),f(te,{key:0},{default:e(()=>[a(" Votre adresse mail n'est pas reconnu dans notre système comme celle du responsable de cette fiche sanitaire. Elle est actuellement liée "+k(c.value.length>=2?"aux adresses":"à l'adresse")+" ",1),S("b",null,k(c.value.join(" ; ")),1),d[12]||(d[12]=a(". ",-1)),d[13]||(d[13]=S("br",null,null,-1)),a(" Afin de protéger vos données, vous devez demander un transfert des droits de lecture et d'écriture. Un mail contenant un lien de transfert va être envoyé "+k(c.value.length>=2?"aux adresses":"à l'adresse")+" ",1),S("i",null,"("+k(c.value.join(" ; "))+")",1),d[14]||(d[14]=a(". ",-1)),t(T,{variant:"outlined",onClick:d[0]||(d[0]=m=>s("transfert",l.fiche.Fichesanitaire)),block:"",class:"mt-4"},{prepend:e(()=>[t(N,null,{default:e(()=>[...d[10]||(d[10]=[a("mdi-lock-open",-1)])]),_:1})]),default:e(()=>[d[11]||(d[11]=a(" Demander le transfert de la fiche sanitaire ",-1))]),_:1})]),_:1})):l.fiche.State==P(oe).Outdated?(o(),f(te,{key:1,type:"warning"},{default:e(()=>[...d[15]||(d[15]=[a(" Merci de bien vouloir vérifier que les données ci-dessous sont à jour et les valider. ",-1),S("br",null,null,-1),a("Nous avons besoin de votre consentement, décrit dans l'encart ",-1),S("b",null,"Validation",-1),a(" (en bas de page). ",-1)])]),_:1})):A("",!0),l.fiche.IsLocked?A("",!0):(o(),M(E,{key:2},[t(R,{class:"my-2",title:"Santé"},{default:e(()=>[t(I,null,{default:e(()=>[t(h,null,{default:e(()=>[t(v,null,{default:e(()=>[t(se,{label:"Difficultés de santé",rows:"3",variant:"outlined",modelValue:i.DifficultesSante,"onUpdate:modelValue":d[1]||(d[1]=m=>i.DifficultesSante=m),hint:"Préciser les problèmes de santé, allergies (non alimentaires), ou tout autre renseignement utile ...","persistent-hint":""},null,8,["modelValue"])]),_:1})]),_:1}),t(h,null,{default:e(()=>[t(v,null,{default:e(()=>[t(se,{label:"Allergies alimentaires",rows:"3",variant:"outlined",modelValue:i.AllergiesAlimentaires,"onUpdate:modelValue":d[2]||(d[2]=m=>i.AllergiesAlimentaires=m)},null,8,["modelValue"])]),_:1})]),_:1}),t(h,null,{default:e(()=>[t(v,null,{default:e(()=>[t(se,{label:"Traitement en cours et mesures proposées",rows:"3",variant:"outlined",modelValue:i.TraitementMedical,"onUpdate:modelValue":d[3]||(d[3]=m=>i.TraitementMedical=m)},null,8,["modelValue"]),t(nt,null,{default:e(()=>[t(te,{"model-value":i.TraitementMedical!="",color:"blue-lighten-4",type:"warning"},{default:e(()=>[...d[16]||(d[16]=[a(" Merci d'apporter les médicaments prescrits et leur posologie, ainsi que d'informer l'équipe à votre arrivée. ",-1)])]),_:1},8,["model-value"])]),_:1})]),_:1})]),_:1})]),_:1})]),_:1}),t(R,{title:"Médecin traitant",class:"my-2"},{default:e(()=>[t(I,null,{default:e(()=>[t(h,null,{default:e(()=>[t(v,null,{default:e(()=>[t(le,{variant:"outlined",density:"compact",label:"Nom",modelValue:i.Medecin.Nom,"onUpdate:modelValue":d[4]||(d[4]=m=>i.Medecin.Nom=m),"hide-details":""},null,8,["modelValue"])]),_:1}),t(v,null,{default:e(()=>[t(le,{variant:"outlined",density:"compact",label:"Téléphone","model-value":P(Q).tel(i.Medecin.Tel),"onUpdate:modelValue":d[5]||(d[5]=m=>i.Medecin.Tel=m),"hide-details":""},null,8,["model-value"])]),_:1})]),_:1})]),_:1})]),_:1}),t(R,{title:"Contacts",class:"my-2"},{default:e(()=>[t(I,null,{default:e(()=>[t(h,null,{default:e(()=>[t(v,null,{default:e(()=>[t(le,{variant:"outlined",density:"compact",readonly:"","hide-details":"","model-value":l.fiche.ResponsableNom,label:"Responsable légal"},null,8,["model-value"])]),_:1}),t(v,null,{default:e(()=>[t(le,{variant:"outlined",density:"compact",readonly:"","hide-details":"","model-value":P(Q).tels(l.fiche.ResponsableTels),label:"Téléphone"},null,8,["model-value"])]),_:1})]),_:1}),t(ge,{thickness:"2",class:"my-4"}),t(h,null,{default:e(()=>[t(v,null,{default:e(()=>[t(le,{variant:"outlined",density:"compact",readonly:"",modelValue:i.AutreContact.Nom,"onUpdate:modelValue":d[6]||(d[6]=m=>i.AutreContact.Nom=m),label:"Autre contact",hint:"Nom et prénom d'une autre personne à contacter en cas d'urgence.","persistent-hint":""},null,8,["modelValue"])]),_:1}),t(v,null,{default:e(()=>[t(le,{variant:"outlined",density:"compact",label:"Téléphone du contact","model-value":P(Q).tel(i.AutreContact.Tel),"onUpdate:modelValue":d[7]||(d[7]=m=>i.AutreContact.Tel=m)},null,8,["model-value"])]),_:1})]),_:1})]),_:1})]),_:1}),t(R,{class:"mt-4",variant:"outlined",color:"success",title:"Validation"},{default:e(()=>[t(I,{class:"text-black"},{default:e(()=>[...d[17]||(d[17]=[a(" Le responsable légal déclare ",-1),S("b",null,"exacts",-1),a(" les renseignements portés sur ce formulaire. ",-1),S("br",null,null,-1),a(" Il autorise le responsable du séjour à prendre des mesures urgentes de soin (traitements médicaux d'urgence, hospitalisation, interventions chirurgicales) rendues nécessaires par l’état du participant. ",-1),S("br",null,null,-1),a(" Il autorise également, si nécessaire, le responsable du séjour à faire sortir le participant de l’hôpital après une hospitalisation. ",-1)])]),_:1}),t(ae,null,{default:e(()=>[t(T,{block:"",color:"success",onClick:d[8]||(d[8]=m=>s("save",i))},{prepend:e(()=>[t(N,null,{default:e(()=>[...d[18]||(d[18]=[a("mdi-content-save",-1)])]),_:1})]),default:e(()=>[a(" Enregistrer la fiche sanitaire de "+k(l.fiche.Personne),1)]),_:1})]),_:1})]),_:1})],64))]),_:1})]),_:2},[l.fiche.State==P(oe).UpToDate?{name:"append",fn:e(()=>[t(X,{color:"green","prepend-icon":"mdi-check"},{default:e(()=>[...d[9]||(d[9]=[a(" Fiche à jour ",-1)])]),_:1})]),key:"0"}:void 0]),1032,["title","subtitle"]))}}),Ht=G({__name:"DocumentsCard",props:{token:{}},emits:["updateNotifs"],setup(r,{emit:n}){const l=r,s=n;de(c);const i=D(null);async function c(){const b=await U.LoadDocuments({token:l.token});if(b===void 0)return;i.value=b;const y=b.ToReadCount+b.ToFillCount+b.FichesToFillCount;s("updateNotifs",y)}async function V(b,y,B){await U.UploadDocument(B,{token:l.token,idPersonne:b,idDemande:y})!==void 0&&(U.showMessage("Document téléversé avec succès. Merci !"),await c())}async function p(b){await U.DeleteDocument({key:b.Key})!==void 0&&(U.showMessage("Document supprimé avec succès."),await c())}const d=D(null);async function m(b){d.value=null,await U.UpdateFichesanitaire({Token:l.token,Fichesanitaire:b})!==void 0&&(U.showMessage("La fiche sanitaire a bien été enregistrée. Merci !"),c())}async function g(b){d.value=null,await U.TransfertFicheSanitaire({token:l.token,idPersonne:b.IdPersonne})!==void 0&&U.showMessage("Mail de transfert envoyé avec succès.")}return(b,y)=>{const B=Ct,x=ht;return o(),f(R,{title:"Documents des séjours",subtitle:"Vous retrouvez ici les documents des séjours auxquels vous participez, à lire ou remplir."},{append:e(()=>[...y[1]||(y[1]=[])]),default:e(()=>[i.value!=null?(o(),f(I,{key:0},{default:e(()=>[t(ue,null,{default:e(()=>[t(he,null,{default:e(()=>[...y[2]||(y[2]=[a("À lire",-1)])]),_:1}),i.value.FilesToRead?.length?A("",!0):(o(),f(q,{key:0},{default:e(()=>[...y[3]||(y[3]=[S("i",null,"Aucun document à lire.",-1)])]),_:1})),(o(!0),M(E,null,j(i.value.FilesToRead,F=>(o(),M(E,null,[(o(!0),M(E,null,j(F.Files,_=>(o(),f(q,{title:_.NomClient,subtitle:F.Camp},{append:e(()=>[t(B,{fileKey:_.Key,isGeneratedDoc:!1},null,8,["fileKey"])]),_:2},1032,["title","subtitle"]))),256)),(o(!0),M(E,null,j(F.Generated,_=>(o(),f(q,{title:_.NomClient,subtitle:F.Camp},{append:e(()=>[t(B,{fileKey:_.Key,isGeneratedDoc:!0},null,8,["fileKey"])]),_:2},1032,["title","subtitle"]))),256))],64))),256)),t(he,null,{default:e(()=>[...y[4]||(y[4]=[a("À fournir",-1)])]),_:1}),i.value.FilesToUpload?.length||i.value.Fiches?.length?A("",!0):(o(),f(q,{key:1},{default:e(()=>[...y[5]||(y[5]=[S("i",null,"Aucun document à fournir.",-1)])]),_:1})),(o(!0),M(E,null,j(i.value.Fiches,F=>(o(),f(q,{title:"Fiche sanitaire",subtitle:F.Personne},{append:e(()=>[t(T,{size:"small",onClick:_=>d.value=F},{prepend:e(()=>[t(N,null,{default:e(()=>[...y[6]||(y[6]=[a("mdi-pencil",-1)])]),_:1})]),default:e(()=>[y[7]||(y[7]=a(" Remplir",-1))]),_:1},8,["onClick"])]),_:2},1032,["subtitle"]))),256)),(o(!0),M(E,null,j(i.value.FilesToUpload,F=>(o(),M(E,null,[(o(!0),M(E,null,j(F.Demandes,_=>(o(),f(x,{demande:_.Demande,files:_.Uploaded||[],subtitle:F.Personne,inUpload:!1,optionnelle:null,showUploadText:!0,onUpload:w=>V(F.IdPersonne,_.Demande.Id,w),onDelete:p},Ue({_:2},[_.Demande.Categorie==P(z).Vaccins?{name:"prepend",fn:e(()=>[t(T,{icon:"",size:"x-small",flat:"",class:"mr-2"},{default:e(()=>[t(N,null,{default:e(()=>[...y[8]||(y[8]=[a("mdi-help-circle-outline",-1)])]),_:1}),t(pe,{activator:"parent"},{default:e(()=>[t(R,{"max-width":"400px"},{default:e(()=>[t(I,null,{default:e(()=>[...y[9]||(y[9]=[a(" Merci de joindre le scan des pages « vaccinations » du carnet de santé du participant. ",-1),S("br",null,null,-1),a(" Seul le DTPolio est obligatoire pour être accueilli en séjour de vacances. ",-1),S("br",null,null,-1),S("i",null," Si le participant n’a pas les vaccins obligatoires, joindre un certificat médical de contre-indication. ",-1)])]),_:1})]),_:1})]),_:1})]),_:1})]),key:"0"}:void 0,_.Demande.IdFile.Valid?{name:"prepend",fn:e(()=>[t(Pt,{"content-class":"pa-1"},{activator:e(({props:w})=>[t(T,fe({ref_for:!0},w,{href:P(st).LoadDocument(_.DemandeFile.Key),class:"mr-2",size:"small"}),{prepend:e(()=>[t(N,null,{default:e(()=>[...y[10]||(y[10]=[a("mdi-download",-1)])]),_:1})]),default:e(()=>[y[11]||(y[11]=a(" Modèle",-1))]),_:1},16,["href"])]),default:e(()=>[t(B,{"file-key":_.DemandeFile.Key,isGeneratedDoc:!1,large:!0},null,8,["file-key"])]),_:2},1024)]),key:"1"}:void 0]),1032,["demande","files","subtitle","onUpload"]))),256))],64))),256))]),_:1})]),_:1})):(o(),f(ve,{key:1})),t(W,{"model-value":d.value!=null,"onUpdate:modelValue":y[0]||(y[0]=F=>d.value=null),"max-width":"800px"},{default:e(()=>[d.value?(o(),f(zt,{key:0,fiche:d.value,onSave:m,onTransfert:g},null,8,["fiche"])):A("",!0)]),_:1},8,["model-value"])]),_:1})}}}),Ot=G({__name:"FinancesReglementCard",props:{token:{},dossier:{},settings:{}},setup(r,{emit:n}){const l=r,s=D(l.settings.SupportPaiementEnLigne?K.EnLigne:K.Virement);async function i(V){await Se(V),U.showMessage("IBAN copié avec succès.")}async function c(V){await Se(V),U.showMessage("Identifiant de virement copié avec succès.")}return(V,p)=>(o(),f(R,{title:"Régler le séjour",class:"mt-2"},{default:e(()=>[t(I,null,{default:e(()=>[p[13]||(p[13]=a(" Le montant à régler est de ",-1)),S("b",null,k(l.dossier.Bilan.Restant),1),p[14]||(p[14]=a(". ",-1)),t(h,{class:"mt-4"},{default:e(()=>[t(v,{"align-self":"start",cols:"4"},{default:e(()=>[t(ue,{class:"py-0",selectable:"",selected:s.value,"onUpdate:selected":p[0]||(p[0]=d=>s.value=d)},{default:e(()=>[l.settings.SupportPaiementEnLigne?(o(),f(q,{key:0,rounded:"",class:"my-2",title:"Payer en ligne",subtitle:"par carte bancaire",value:P(K).EnLigne},{append:e(()=>[t(N,null,{default:e(()=>[...p[2]||(p[2]=[a("mdi-credit-card",-1)])]),_:1})]),_:1},8,["value"])):A("",!0),t(q,{rounded:"",class:"my-2",title:"Payer par virement",value:P(K).Virement},{append:e(()=>[t(N,null,{default:e(()=>[...p[3]||(p[3]=[a("mdi-bank",-1)])]),_:1})]),_:1},8,["value"]),l.settings.Cheques.IsValid?(o(),f(q,{key:1,rounded:"",class:"my-2",title:"Payer par chèque",value:P(K).Cheque},{append:e(()=>[t(N,null,{default:e(()=>[...p[4]||(p[4]=[a("mdi-checkbook",-1)])]),_:1})]),_:1},8,["value"])):A("",!0)]),_:1},8,["selected"])]),_:1}),t(v,{"align-self":"start",cols:"8"},{default:e(()=>[t(R,{title:P(At)[s.value]},{default:e(()=>[s.value==P(K).EnLigne?(o(),f(I,{key:0},{default:e(()=>[...p[5]||(p[5]=[a(" TODO: see https://github.com/benoitkugler/registro/issues/76 ",-1)])]),_:1})):s.value==P(K).Virement?(o(),f(I,{key:1},{default:e(()=>[a(" Vous pouvez effectuer votre virement vers "+k(l.settings.BankAccounts?.length?"l'un des comptes suivants":"le compte suivant")+" : ",1),t(ue,{class:"my-2"},{default:e(()=>[(o(!0),M(E,null,j(l.settings.BankAccounts,d=>(o(),f(q,{title:d[0],subtitle:d[1]},{append:e(()=>[t(T,{size:"x-small",icon:"mdi-content-copy",onClick:m=>i(d[1])},null,8,["onClick"])]),_:2},1032,["title","subtitle"]))),256))]),_:1}),t(te,{type:"info"},{default:e(()=>[p[6]||(p[6]=a(" Merci d'indiquer impérativement le ",-1)),p[7]||(p[7]=S("b",null,"label",-1)),p[8]||(p[8]=a(" suivant sur votre virement, qui nous permettra de l'identifier : ",-1)),t(h,{"no-gutters":"",class:"mt-2"},{default:e(()=>[t(v,{"align-self":"center",class:"text-center"},{default:e(()=>[t(X,{variant:"elevated"},{default:e(()=>[a(k(l.settings.VirementCode),1)]),_:1})]),_:1}),t(v,{"align-self":"center",cols:"auto"},{default:e(()=>[t(T,{class:"my-2",size:"x-small",icon:"mdi-content-copy",onClick:p[1]||(p[1]=d=>c(l.settings.VirementCode))})]),_:1})]),_:1})]),_:1})]),_:1})):s.value==P(K).Cheque?(o(),f(I,{key:2},{default:e(()=>[p[10]||(p[10]=a(" Merci d'envoyer votre chèque à l'ordre ",-1)),S("b",null,k(l.settings.Cheques.Ordre),1),p[11]||(p[11]=a(" à l'adresse suivante : ",-1)),t(h,{justify:"center"},{default:e(()=>[t(v,{cols:"auto"},{default:e(()=>[t(R,{class:"my-2"},{default:e(()=>[t(I,null,{default:e(()=>[a(k(l.settings.Cheques.Adresse[0])+" ",1),p[9]||(p[9]=S("br",null,null,-1)),a(" "+k(l.settings.Cheques.Adresse[1]),1)]),_:1})]),_:1})]),_:1})]),_:1}),p[12]||(p[12]=a(" Il sera encaissé environ une dizaine de jours avant le début du séjour. ",-1))]),_:1})):A("",!0)]),_:1},8,["title"])]),_:1})]),_:1})]),_:1})]),_:1}))}}),Jt=["href"],Kt=G({__name:"PresentationCard",props:{assoTitle:{},mailCentre:{}},setup(r){const n=r;return(l,s)=>(o(),f(R,{title:"Bienvenue sur votre espace de suivi !"},{default:e(()=>[t(I,null,{default:e(()=>[a(" Cette page regroupe toutes les informations liées à votre inscription et vous permet d'interagir avec les directeurs de séjour et l'association "+k(n.assoTitle)+", en utilisant le fil de messages. ",1),s[0]||(s[0]=S("br",null,null,-1)),s[1]||(s[1]=S("br",null,null,-1)),s[2]||(s[2]=a(" Cet espace évoluera au fil de l'inscription, et vous donnera accès au suivi de votre demande: ",-1)),t(ue,{class:"mb-2"},{default:e(()=>[t(q,{title:"Notification de validation",subtitle:"Après prise en compte de votre inscription par notre association.","append-icon":"mdi-check"}),t(q,{title:"Réglement des séjours","append-icon":"mdi-currency-eur"}),t(q,{title:"Documents des séjours",subtitle:"Lettre du directeur, fiches sanitaires, autres documents, ...","append-icon":"mdi-mail"}),t(q,{title:"Album photo",subtitle:"Accès vers une plateforme dédiée aux photos de vos séjours.","append-icon":"mdi-image-album"}),t(q,{title:"Justificatifs",subtitle:"Téléchargement d'une attestation de présence ou d'une facture acquittée.","append-icon":"mdi-download"}),t(q,{title:"Sondage",subtitle:"Un espace de commentaire ouvert à la fin des séjours.","append-icon":"mdi-comment-quote"})]),_:1}),s[3]||(s[3]=a(" La prochaine étape ? La confirmation de votre inscription vous sera donnée par le responsable du camp. Si un camp est déjà complet, vous serez mis sur liste d'attente. ",-1)),s[4]||(s[4]=S("br",null,null,-1)),s[5]||(s[5]=a(" Sans nouvelle d'ici 10 jours, veuillez contacter : ",-1)),S("a",{href:`mailto:${n.mailCentre}`},k(n.mailCentre),9,Jt)]),_:1})]),_:1}))}}),Gt=G({__name:"ValidationInscriptionCard",props:{dossier:{}},setup(r){const n=r,l=H(()=>(n.dossier.Participants||[]).filter(c=>c.Participant.Statut==O.Inscrit)),s=H(()=>(n.dossier.Participants||[]).filter(c=>c.Participant.Statut!=O.Inscrit&&c.Participant.Statut!=O.AStatuer)),i=H(()=>(n.dossier.Participants||[]).filter(c=>c.Participant.Statut==O.AStatuer));return(c,V)=>(o(),f(R,{title:"Inscription confirmée"},{default:e(()=>[t(I,null,{default:e(()=>[V[0]||(V[0]=S("div",{class:"mb-4"}," Nous avons bien reçu votre inscription, et nous vous en remercions. Voici son statut : ",-1)),l.value.length?(o(),f(te,{key:0,color:"lime-lighten-1",class:"my-2",elevation:"2",icon:P(Q).statutParticipant(P(O).Inscrit).icon},{default:e(()=>[t(h,null,{default:e(()=>[t(v,{"align-self":"center",class:"text-center"},{default:e(()=>[(o(!0),M(E,null,j(l.value,p=>(o(),f(X,{class:"my-1"},{default:e(()=>[a(k(p.Personne.Prenom)+" : "+k(P(ne).label(p.Camp)),1)]),_:2},1024))),256))]),_:1}),t(v,{cols:"7"},{default:e(()=>[a("Nous sommes ravis de vous confirmer "+k(l.value.length==1?"cette participation":"ces participations")+" et nous nous réjouissons des moments à passer ensemble !",1)]),_:1})]),_:1})]),_:1},8,["icon"])):A("",!0),s.value.length?(o(),f(te,{key:1,color:"orange-lighten-3",class:"my-2",elevation:"2",icon:P(Q).statutParticipant(P(O).AttenteCampComplet).icon},{default:e(()=>[t(h,null,{default:e(()=>[t(v,{"align-self":"center",class:"text-center"},{default:e(()=>[(o(!0),M(E,null,j(s.value,p=>(o(),f(X,{class:"my-1"},{default:e(()=>[a(k(p.Personne.Prenom)+" : "+k(P(ne).label(p.Camp)),1)]),_:2},1024))),256))]),_:1}),t(v,{cols:"7"},{default:e(()=>[a("Malheureusement, nous avons dû placer "+k(s.value.length==1?"cette demande":"ces demandes")+" en liste d'attente. Nous reviendrons vers vous si une place se libère.",1)]),_:1})]),_:1})]),_:1},8,["icon"])):A("",!0),i.value.length?(o(),f(te,{key:2,color:"grey-lighten-1",class:"my-2",elevation:"2",icon:P(Q).statutParticipant(P(O).AStatuer).icon},{default:e(()=>[t(h,null,{default:e(()=>[t(v,{"align-self":"center",class:"text-center"},{default:e(()=>[(o(!0),M(E,null,j(i.value,p=>(o(),f(X,{class:"my-1"},{default:e(()=>[a(k(p.Personne.Prenom)+" : "+k(P(ne).label(p.Camp)),1)]),_:2},1024))),256))]),_:1}),t(v,{cols:"7"},{default:e(()=>[a(" Nous n'avons pas encore statué pour "+k(i.value.length==1?"cette demande":"ces demandes")+" et nous reviendrons vers vous au plus vite. ",1)]),_:1})]),_:1})]),_:1},8,["icon"])):A("",!0)]),_:1})]),_:1}))}}),Zt={class:"overflow-y-auto",style:{"max-height":"75vh"}},Wt=G({__name:"Main",setup(r){const n=D("");de(async()=>{const L=new URLSearchParams(window.location.search),u=L.get("token")||"",Y=!!L.get("from-inscription"),C=Number(L.get("idEvent")||0);if(n.value=u,await s(),!!l.value){if(Y){_.value=!0;return}c(C)}});const l=D(null);async function s(){const L=await U.Load({token:n.value});L!==void 0&&(l.value=L)}const i=H(()=>l.value==null?[]:ot(l.value.Dossier,xt.Espaceperso));function c(L){if(!l.value)return;const u=(l.value.Dossier.Events||[]).find(Y=>Y.Id==L);if(u)switch(u.Content.Kind){case ie.Validation:F.value=!0;return;case ie.Facture:x.value=!0;return;case ie.PlaceLiberee:w.value=u;return;case ie.CampDocs:B.value=!0;return;case ie.Sondage:b.value=u.Content.Data.IdCamp;return;default:return}}const V=D(null);async function p(){if(!V.value||!l.value)return;const L={Token:n.value,Message:V.value.content,OnlyToFondSoutien:V.value.toFondSoutien};V.value=null;const u=await U.SendMessage(L);u!==void 0&&(U.showMessage("Message envoyé avec succès."),l.value.Dossier.Events=(l.value.Dossier.Events||[]).concat(u))}function d(L){return L.Participant.Statut==O.Inscrit?"bg-lime-lighten-2":L.Participant.Statut==O.AStatuer?"bg-grey-lighten-1":"bg-orange-lighten-3"}const m=D(!1);async function g(L){m.value=!1,await U.UpdateParticipants({Token:n.value,Participants:L})!==void 0&&U.showMessage("Modifications enregistrées avec succès. Merci !")}const b=D(null),y=D(!1),B=D(!1),x=D(!1),F=D(!1),_=D(!1),w=D(null);async function $(){const L=w.value;!L||(w.value=null,await U.AcceptePlaceLiberee({token:n.value,idEvent:L.Id})===void 0)||(s(),U.showMessage("Place acceptée avec succès."))}return(L,u)=>{const Y=ft;return o(),M(E,null,[t(Dt,{title:"Espace de suivi de votre inscription"},{default:e(()=>[t(T,{onClick:u[0]||(u[0]=C=>b.value=0)},{prepend:e(()=>[t(N,null,{default:e(()=>[...u[22]||(u[22]=[a("mdi-comment-quote",-1)])]),_:1})]),default:e(()=>[u[23]||(u[23]=a(" Avis ",-1))]),_:1}),t(T,{onClick:u[1]||(u[1]=C=>y.value=!0)},{prepend:e(()=>[t(N,null,{default:e(()=>[...u[24]||(u[24]=[a("mdi-image-album",-1)])]),_:1})]),default:e(()=>[u[25]||(u[25]=a(" Album photos ",-1))]),_:1}),t(pe,null,{activator:e(({props:C})=>[l.value?(o(),f(T,fe({key:0},C,{disabled:!l.value.EnableJustificatifs}),{prepend:e(()=>[t(N,null,{default:e(()=>[...u[26]||(u[26]=[a("mdi-download",-1)])]),_:1})]),default:e(()=>[u[27]||(u[27]=a(" Justificatifs ",-1))]),_:1},16,["disabled"])):A("",!0)]),default:e(()=>[t(ue,null,{default:e(()=>[t(q,{title:"Attestation de présence",subtitle:"Télécharger au format .pdf","prepend-icon":"mdi-file-document-check",link:"",href:P(U).DownloadAttestationPresence(n.value)},null,8,["href"]),t(q,{title:"Facture",subtitle:"Télécharger au format .pdf","prepend-icon":"mdi-invoice-list",href:P(U).DownloadFacture(n.value)},null,8,["href"])]),_:1})]),_:1})]),_:1}),l.value==null?(o(),f(ve,{key:0,type:"card"})):(o(),f(ut,{key:1,class:"fill-height",fluid:""},{default:e(()=>[t(h,null,{default:e(()=>[t(v,{"align-self":"center",cols:"5"},{default:e(()=>[t(R,{subtitle:"Participants"},{append:e(()=>[t(T,{size:"small",class:"mr-1",onClick:u[2]||(u[2]=C=>B.value=!0)},{prepend:e(()=>[t(N,null,{default:e(()=>[...u[28]||(u[28]=[a("mdi-folder",-1)])]),_:1})]),default:e(()=>[t(Ae,{color:l.value.DocumentsToReadOrFillCount?"pink":"transparent",content:l.value.DocumentsToReadOrFillCount||"",floating:""},{default:e(()=>[...u[29]||(u[29]=[a(" Documents ",-1)])]),_:1},8,["color","content"])]),_:1})]),default:e(()=>[t(I,null,{default:e(()=>[t(ue,{class:"pa-0"},{default:e(()=>[(o(!0),M(E,null,j(l.value.Dossier.Participants,C=>(o(),f(q,{title:P(be).label(C.Personne),subtitle:P(ne).label(C.Camp),rounded:"",class:me({"my-2":!0,[d(C)]:!0})},{append:e(()=>[t(X,{variant:"elevated",color:P(Q).statutParticipant(C.Participant.Statut).color,"prepend-icon":P(Q).statutParticipant(C.Participant.Statut).icon},{default:e(()=>[a(k(P(wt)[C.Participant.Statut]),1)]),_:2},1032,["color","prepend-icon"])]),_:2},1032,["title","subtitle","class"]))),256))]),_:1})]),_:1})]),_:1}),t(Ft,{token:n.value,dossier:l.value.Dossier,"is-paiement-open":l.value.IsPaiementOpen,settings:l.value.PaiementSettings,onRefresh:s,onShowReglement:u[3]||(u[3]=C=>x.value=!0)},null,8,["token","dossier","is-paiement-open","settings"])]),_:1}),t(v,{"align-self":"center"},{default:e(()=>[t(R,{subtitle:"Fil de suivi de votre inscription"},{append:e(()=>[t(T,{onClick:u[4]||(u[4]=C=>V.value={content:"",toFondSoutien:!1})},{prepend:e(()=>[t(N,null,{default:e(()=>[...u[30]||(u[30]=[a("mdi-email",-1)])]),_:1})]),default:e(()=>[u[31]||(u[31]=a(" Nous écrire",-1))]),_:1})]),default:e(()=>[t(I,null,{default:e(()=>[S("div",Zt,[t(pt,{side:"end",class:"mt-4",density:"compact"},{default:e(()=>[(o(!0),M(E,null,j(i.value,C=>(o(),f(Y,{event:C,onGoToSondage:u[5]||(u[5]=Z=>b.value=Z),onGoToDocuments:u[6]||(u[6]=Z=>B.value=!0),onGoToValidation:u[7]||(u[7]=Z=>F.value=!0),onAcceptPlaceLiberee:u[8]||(u[8]=Z=>c(Z)),onReplyFondSoutien:u[9]||(u[9]=Z=>V.value={content:"",toFondSoutien:!0})},null,8,["event"]))),256))]),_:1})])]),_:1})]),_:1})]),_:1})]),_:1}),t(W,{modelValue:m.value,"onUpdate:modelValue":u[10]||(u[10]=C=>m.value=C)},{default:e(()=>[t(Mt,{participants:l.value.Dossier.Participants||[],onSave:g},null,8,["participants"])]),_:1},8,["modelValue"])]),_:1})),t(W,{"model-value":V.value!=null,"onUpdate:modelValue":u[12]||(u[12]=C=>V.value=null),"max-width":"600px"},{default:e(()=>[V.value?(o(),f(R,{key:0,title:"Nouveau message",subtitle:V.value.toFondSoutien?"Ce message ne sera visible que par le fonds de soutien.":"Ce message sera visible par le centre et les directeurs."},{default:e(()=>[t(I,null,{default:e(()=>[t(se,{autofocus:"",placeholder:"Rédigez votre message...",modelValue:V.value.content,"onUpdate:modelValue":u[11]||(u[11]=C=>V.value.content=C),rows:"10"},null,8,["modelValue"])]),_:1}),t(ae,null,{default:e(()=>[t(ce),t(T,{disabled:!V.value.content.length,onClick:p},{prepend:e(()=>[t(N,null,{default:e(()=>[...u[32]||(u[32]=[a("mdi-send",-1)])]),_:1})]),default:e(()=>[u[33]||(u[33]=a(" Envoyer",-1))]),_:1},8,["disabled"])]),_:1})]),_:1},8,["subtitle"])):A("",!0)]),_:1},8,["model-value"]),t(W,{"model-value":b.value!=null,"onUpdate:modelValue":u[13]||(u[13]=C=>b.value=null)},{default:e(()=>[b.value!=null?(o(),f(Bt,{key:0,token:n.value,"initial-camp":b.value},null,8,["token","initial-camp"])):A("",!0)]),_:1},8,["model-value"]),t(W,{modelValue:y.value,"onUpdate:modelValue":u[14]||(u[14]=C=>y.value=C)},{default:e(()=>[t($t,{token:n.value},null,8,["token"])]),_:1},8,["modelValue"]),t(W,{modelValue:B.value,"onUpdate:modelValue":u[17]||(u[17]=C=>B.value=C),"max-width":"800px"},{default:e(()=>[t(Ht,{token:n.value,onClose:u[15]||(u[15]=C=>B.value=!1),onUpdateNotifs:u[16]||(u[16]=C=>l.value.DocumentsToReadOrFillCount=C)},null,8,["token"])]),_:1},8,["modelValue"]),l.value?(o(),f(W,{key:2,modelValue:x.value,"onUpdate:modelValue":u[18]||(u[18]=C=>x.value=C),"max-width":"800px"},{default:e(()=>[t(Ot,{token:n.value,dossier:l.value.Dossier,settings:l.value.PaiementSettings},null,8,["token","dossier","settings"])]),_:1},8,["modelValue"])):A("",!0),t(W,{modelValue:_.value,"onUpdate:modelValue":u[19]||(u[19]=C=>_.value=C),"max-width":"800px"},{default:e(()=>[l.value?(o(),f(Kt,{key:0,"asso-title":l.value.AssoTitle,"mail-centre":l.value.MailCentre},null,8,["asso-title","mail-centre"])):A("",!0)]),_:1},8,["modelValue"]),t(W,{modelValue:F.value,"onUpdate:modelValue":u[20]||(u[20]=C=>F.value=C),"max-width":"800px"},{default:e(()=>[l.value?(o(),f(Gt,{key:0,dossier:l.value.Dossier},null,8,["dossier"])):A("",!0)]),_:1},8,["modelValue"]),t(W,{"model-value":w.value!=null,"onUpdate:modelValue":u[21]||(u[21]=C=>w.value=null),"max-width":"600px"},{default:e(()=>[w.value?(o(),f(R,{key:0,title:"Accepter la place"},{default:e(()=>[t(I,null,{default:e(()=>[a(" Confirmez-vous l'inscription de "+k(w.value.Content.Data.ParticipantLabel)+" sur le séjour "+k(w.value.Content.Data.CampLabel)+" ? ",1),u[34]||(u[34]=S("br",null,null,-1)),u[35]||(u[35]=S("br",null,null,-1)),u[36]||(u[36]=S("span",{class:"text-grey"},"Un mail de notification sera envoyé automatiquement au centre.",-1))]),_:1}),t(ae,null,{default:e(()=>[t(ce),t(T,{color:"success",onClick:$},{default:e(()=>[...u[37]||(u[37]=[a("Confirmer",-1)])]),_:1})]),_:1})]),_:1})):A("",!0)]),_:1},8,["model-value"])],64)}}}),Qt=["innerHTML"],Xt=G({__name:"App",setup(r){const n=we({text:"",color:"secondary",action:void 0,timeout:4e3}),l=D(""),s=D("");return U.onError=(i,c)=>{l.value=i,s.value=c},U.showMessage=(i,c,V)=>{n.text=i,n.color=c||"success",n.action=V,n.timeout=1e4,n.timeout=4e3},(i,c)=>(o(),f(rt,null,{default:e(()=>[t(it,null,{default:e(()=>[t(Wt),t(_e,{style:{"z-index":"10000"},app:"","model-value":n.text!="","onUpdate:modelValue":c[1]||(c[1]=V=>n.text=""),timeout:n.timeout,color:n.color,location:"bottom left","close-on-content-click":""},{default:e(()=>[a(k(n.text)+" ",1),n.action?(o(),f(T,{key:0,onClick:c[0]||(c[0]=V=>n.action.action()),class:"ml-2"},{default:e(()=>[a(k(n.action.title),1)]),_:1})):A("",!0)]),_:1},8,["model-value","timeout","color"]),t(_e,{app:"","model-value":l.value!="","onUpdate:modelValue":c[2]||(c[2]=V=>l.value=""),timeout:4e3,color:"red"},{default:e(()=>[S("b",null,k(l.value),1),S("div",{innerHTML:s.value},null,8,Qt)]),_:1},8,["model-value"])]),_:1})]),_:1}))}}),xe=dt(Xt);xe.use(mt);xe.mount("#app");
