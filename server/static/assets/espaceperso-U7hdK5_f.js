import{c8 as j,bR as $e,bT as Ne,d as K,r as F,e as g,o as d,V as je,w as t,a as e,g as qe,h as P,i as f,j as He,b as o,t as S,k as Be,l as U,c as I,F as T,_ as N,Y as M,a2 as Ve,aw as be,m as $,a1 as x,s as q,O as _e,aL as Oe,aK as ze,f as B,au as J,aF as he,Q as ne,$ as Y,bd as ce,be as ve,A as re,ac as me,as as De,a6 as Ke,U as fe,aB as Je,p as Ge,q as We,S as Xe,ae as Ze,C as Qe,b4 as Ye,L as et,G as tt,bp as lt,u as at,v as nt,aj as st,ak as ot,al as it,ao as ut,ap as rt,I as Se,W as dt,X as mt,c4 as pt,aP as ge,bt as ft,aD as ct,n as vt,aT as gt,aU as Me,aV as Vt,aW as bt,aX as _t}from"./VSnackbar-4WS0ckTD.js";import{_ as yt,a as kt,V as Ct,b as Ut}from"./EventSwitch.vue_vue_type_script_setup_true_lang-BMci4H8s.js";import{p as ht,_ as St,a as Le,d as Fe,b as Ie,c as Te,V as ue,g as we}from"./VTabs-BL3VzwwU.js";import{b as L,c as R,k as ee,d as te,e as se,f as ye,l as Ae,V as O,h as H,j as le,g as de,a as Pe,i as Z,m as ae,n as Re}from"./VTextarea-vvA5kftK.js";import{a as Mt,V as wt}from"./FileCard.vue_vue_type_script_setup_true_lang-igzkYVuw.js";import{_ as xe}from"./FilesDemande.vue_vue_type_script_setup_true_lang-BPqgrtDS.js";import"./VWindowItem-B61QShv2.js";import"./FilesRow.vue_vue_type_script_setup_true_lang-LKee0-LZ.js";const At={CampDocs:"CampDocs"},oe={Complet:3,EnCours:2,NonCommence:1};oe.Complet+"",oe.EnCours+"",oe.NonCommence+"";const Q={AStatuer:0,Refuse:1,AttenteProfilInvalide:2,AttenteCampComplet:3,EnAttenteReponse:4,Inscrit:5},Pt={[Q.AStatuer]:"A statuer",[Q.Refuse]:"Refusé définitivement",[Q.AttenteProfilInvalide]:"Profil limite",[Q.AttenteCampComplet]:"Camp complet",[Q.EnAttenteReponse]:"En attente de réponse",[Q.Inscrit]:"Inscrit"},Rt={Euros:0},z={Cheque:0,EnLigne:1,Virement:2,Especes:3,Ancv:4,Helloasso:5},Dt={[z.Cheque]:"Chèque",[z.EnLigne]:"Carte bancaire (en ligne)",[z.Virement]:"Virement",[z.Especes]:"Espèces",[z.Ancv]:"ANCV",[z.Helloasso]:"Helloasso"},X={NoFiche:0,Outdated:1,UpToDate:2};X.NoFiche+"",X.Outdated+"",X.UpToDate+"";class Lt{constructor(i,a){this.baseURL=i,this.authToken=a}getHeaders(){return{Authorization:"Bearer "+this.authToken}}async Load(i){const a=this.baseURL+"/api/v1/espaceperso";this.startRequest();try{return(await j.get(a,{headers:this.getHeaders(),params:{token:i.token}})).data}catch(u){this.handleError(u)}}async SendMessage(i){const a=this.baseURL+"/api/v1/espaceperso/message";this.startRequest();try{return(await j.post(a,i,{headers:this.getHeaders()})).data}catch(u){this.handleError(u)}}async UpdateParticipants(i){const a=this.baseURL+"/api/v1/espaceperso/participants";this.startRequest();try{return await j.post(a,i,{headers:this.getHeaders()}),!0}catch(u){this.handleError(u)}}async CreateAide(i,a,u){const n=this.baseURL+"/api/v1/espaceperso/aide";this.startRequest();try{const c=new FormData;return c.append("document",i,i.name),c.append("aide",JSON.stringify(a)),await j.post(n,c,{headers:this.getHeaders(),params:{token:u.token}}),!0}catch(c){this.handleError(c)}}async GetStructureaides(){const i=this.baseURL+"/api/v1/espaceperso/structureaides";this.startRequest();try{return(await j.get(i,{headers:this.getHeaders()})).data}catch(a){this.handleError(a)}}async LoadJoomeo(i){const a=this.baseURL+"/api/v1/espaceperso/joomeo";this.startRequest();try{return(await j.get(a,{headers:this.getHeaders(),params:{token:i.token}})).data}catch(u){this.handleError(u)}}async LoadFichesanitaires(i){const a=this.baseURL+"/api/v1/espaceperso/fichesanitaires";this.startRequest();try{return(await j.get(a,{headers:this.getHeaders(),params:{token:i.token}})).data}catch(u){this.handleError(u)}}async UpdateFichesanitaire(i){const a=this.baseURL+"/api/v1/espaceperso/fichesanitaires";this.startRequest();try{return await j.post(a,i,{headers:this.getHeaders()}),!0}catch(u){this.handleError(u)}}async UploadVaccin(i,a){const u=this.baseURL+"/api/v1/espaceperso/fichesanitaires";this.startRequest();try{const n=new FormData;return n.append("file",i,i.name),(await j.put(u,n,{headers:this.getHeaders(),params:{token:a.token,idPersonne:String(a.idPersonne)}})).data}catch(n){this.handleError(n)}}async DeleteVaccin(i){const a=this.baseURL+"/api/v1/espaceperso/fichesanitaires";this.startRequest();try{return await j.delete(a,{headers:this.getHeaders(),params:{key:i.key}}),!0}catch(u){this.handleError(u)}}async TransfertFicheSanitaire(i){const a=this.baseURL+"/api/v1/espaceperso/fichesanitaires/transfert";this.startRequest();try{return await j.put(a,null,{headers:this.getHeaders(),params:{token:i.token,idPersonne:String(i.idPersonne)}}),!0}catch(u){this.handleError(u)}}async LoadSondages(i){const a=this.baseURL+"/api/v1/espaceperso/sondages";this.startRequest();try{return(await j.get(a,{headers:this.getHeaders(),params:{token:i.token}})).data}catch(u){this.handleError(u)}}async UpdateSondages(i){const a=this.baseURL+"/api/v1/espaceperso/sondages";this.startRequest();try{return await j.post(a,i,{headers:this.getHeaders()}),!0}catch(u){this.handleError(u)}}async LoadDocuments(i){const a=this.baseURL+"/api/v1/espaceperso/documents";this.startRequest();try{return(await j.get(a,{headers:this.getHeaders(),params:{token:i.token}})).data}catch(u){this.handleError(u)}}async UploadDocument(i,a){const u=this.baseURL+"/api/v1/espaceperso/documents";this.startRequest();try{const n=new FormData;return n.append("file",i,i.name),(await j.post(u,n,{headers:this.getHeaders(),params:{token:a.token,idDemande:String(a.idDemande),idPersonne:String(a.idPersonne)}})).data}catch(n){this.handleError(n)}}async DeleteDocument(i){const a=this.baseURL+"/api/v1/espaceperso/documents";this.startRequest();try{return await j.delete(a,{headers:this.getHeaders(),params:{key:i.key}}),!0}catch(u){this.handleError(u)}}}class Ft extends Lt{constructor(i,a,u){super(u,""),this.onError=i,this.showMessage=a}handleError(i){const{kind:a,messageHtml:u}=Ne(i);this.onError(a,u)}startRequest(){}}const A=new Ft((m,i)=>{},(m,i)=>{},$e()),It=K({__name:"NavBar",props:{title:{},hideMenu:{type:Boolean}},setup(m){const i=m,a="/static/repere/logo.png";return F(!1),(u,n)=>(d(),g(je,{rounded:"",elevation:"4",color:"secondary"},{append:t(()=>[Be(u.$slots,"default"),n[0]||(n[0]=U("div",{class:"mr-2"},null,-1))]),default:t(()=>[e(qe,null,{default:t(()=>[e(P,null,{default:t(()=>[e(f,{"align-self":"center",cols:"auto"},{default:t(()=>[e(He,{width:"60",src:a})]),_:1}),e(f,{"align-self":"center"},{default:t(()=>[o(S(i.title),1)]),_:1})]),_:1})]),_:1})]),_:3}))}}),Tt=K({__name:"ParticipantsEditCard",props:{participants:{}},emits:["save"],setup(m,{emit:i}){const a=m,u=i,n=F(a.participants.map(c=>c.Participant));return(c,y)=>{const p=ht;return d(),g(L,{title:"Modifier les options"},{default:t(()=>[e(R,null,{default:t(()=>[e(P,null,{default:t(()=>[(d(!0),I(T,null,N(a.participants,(_,V)=>(d(),g(f,{cols:"6"},{default:t(()=>[e(L,{title:M(be).label(_.Personne),subtitle:M(Ve).label(_.Camp)},{default:t(()=>[e(R,null,{default:t(()=>[e(P,null,{default:t(()=>[e(f,null,{default:t(()=>[_.Camp.Navette.Actif?(d(),g(p,{key:0,modelValue:n.value[V].Navette,"onUpdate:modelValue":l=>n.value[V].Navette=l,hint:_.Camp.Navette.Commentaire},null,8,["modelValue","onUpdate:modelValue","hint"])):(d(),g(ee,{key:1},{default:t(()=>y[1]||(y[1]=[o("Ce séjour ne propose pas de navette.")])),_:1,__:[1]}))]),_:2},1024)]),_:2},1024),e(P,null,{default:t(()=>[e(f,null,{default:t(()=>[e(te,{modelValue:n.value[V].Details,"onUpdate:modelValue":l=>n.value[V].Details=l,label:"Information libre",density:"compact",variant:"outlined","hide-details":""},null,8,["modelValue","onUpdate:modelValue"])]),_:2},1024)]),_:2},1024),e(P,null,{default:t(()=>[e(f,null,{default:t(()=>y[2]||(y[2]=[o(" TODO: option prix ")])),_:1,__:[2]})]),_:1})]),_:2},1024)]),_:2},1032,["title","subtitle"])]),_:2},1024))),256))]),_:1})]),_:1}),e(se,null,{default:t(()=>[e(ye),e($,{onClick:y[0]||(y[0]=_=>u("save",n.value)),color:"green"},{prepend:t(()=>[e(x,null,{default:t(()=>y[3]||(y[3]=[o("mdi-content-save-cog")])),_:1,__:[3]})]),default:t(()=>[y[4]||(y[4]=o(" Enregistrer"))]),_:1,__:[4]})]),_:1})]),_:1})}}}),xt=K({__name:"AideCard",props:{dossier:{},structureaides:{}},emits:["save"],setup(m,{emit:i}){const a=m,u=i,n=F({Id:0,IdStructureaide:0,IdParticipant:(a.dossier.Participants||[])[0].Participant.Id,Valide:!1,Valeur:{Currency:Rt.Euros,Cent:0},ParJour:!1,NbJoursMax:0}),c=F(null),y=q(()=>n.value?c.value!=null&&n.value.IdParticipant!=0&&n.value.IdStructureaide!=0&&n.value.Valeur.Cent!=0:!1),p=q(()=>(a.dossier.Participants||[]).map(V=>({title:be.label(V.Personne),subtitle:Ve.label(V.Camp),value:V.Participant.Id}))),_=q(()=>Object.values(a.structureaides||{}).map(V=>({value:V.Id,title:V.Nom})));return(V,l)=>{const v=yt,s=St,b=Mt;return d(),g(L,{title:"Ajouter une aide extérieure"},{default:t(()=>[e(R,null,{default:t(()=>[e(P,null,{default:t(()=>[e(f,null,{default:t(()=>[e(Ae,{variant:"outlined",density:"comfortable",label:"Participant",modelValue:n.value.IdParticipant,"onUpdate:modelValue":l[0]||(l[0]=k=>n.value.IdParticipant=k),items:p.value},{item:t(({item:k,props:D})=>[e(O,_e(D,{title:k.raw.title,subtitle:k.raw.subtitle}),null,16,["title","subtitle"])]),_:1},8,["modelValue","items"])]),_:1}),e(f,null,{default:t(()=>[e(Ae,{variant:"outlined",density:"comfortable",label:"Structure","model-value":M(ze)(n.value.IdStructureaide),"onUpdate:modelValue":l[1]||(l[1]=k=>n.value.IdStructureaide=M(Oe)(k)),items:_.value,"no-data-text":"Aucune structure n'est disponible."},null,8,["model-value","items"])]),_:1})]),_:1}),e(P,null,{default:t(()=>[e(f,{"align-self":"center",cols:"5"},{default:t(()=>[e(v,{label:"Valeur",modelValue:n.value.Valeur,"onUpdate:modelValue":l[2]||(l[2]=k=>n.value.Valeur=k),"hide-details":""},null,8,["modelValue"])]),_:1}),e(f,{"align-self":"center"},{default:t(()=>[e(H,{modelValue:n.value.ParJour,"onUpdate:modelValue":l[3]||(l[3]=k=>n.value.ParJour=k),label:"Montant par jour","hide-details":""},null,8,["modelValue"])]),_:1}),e(f,{"align-self":"center"},{default:t(()=>[n.value.ParJour?(d(),g(s,{key:0,label:"Limite sur le nombre de jours",modelValue:n.value.NbJoursMax,"onUpdate:modelValue":l[4]||(l[4]=k=>n.value.NbJoursMax=k),min:0,hint:"0 pour ne pas limiter","persistent-hint":""},null,8,["modelValue"])):B("",!0)]),_:1})]),_:1}),e(P,null,{default:t(()=>[e(f,null,{default:t(()=>[e(b,{label:"Pièce justificative",onUpdate:l[5]||(l[5]=k=>c.value=k)})]),_:1})]),_:1})]),_:1}),e(se,null,{default:t(()=>[e(ye),e($,{color:"green",disabled:!y.value,onClick:l[6]||(l[6]=k=>u("save",n.value,c.value))},{default:t(()=>l[7]||(l[7]=[o(" Ajouter ")])),_:1,__:[7]},8,["disabled"])]),_:1})]),_:1})}}}),Et=K({__name:"FinancesReglementCard",props:{token:{},dossier:{},settings:{}},emits:["refresh"],setup(m,{emit:i}){const a=m,u=F(z.EnLigne);async function n(y){await he(y),A.showMessage("IBAN copié avec succès.")}async function c(y){await he(y),A.showMessage("Identifiant de virement copié avec succès.")}return(y,p)=>(d(),g(L,{title:"Régler la pension",class:"mt-2"},{default:t(()=>[e(R,null,{default:t(()=>[p[13]||(p[13]=o(" Le montant de la pension à régler est de ")),U("b",null,S(a.dossier.Bilan.Restant),1),p[14]||(p[14]=o(". ")),e(P,{class:"mt-4"},{default:t(()=>[e(f,{"align-self":"start",cols:"4"},{default:t(()=>[e(le,{class:"py-0",selectable:"",selected:u.value,"onUpdate:selected":p[0]||(p[0]=_=>u.value=_)},{default:t(()=>[e(O,{rounded:"",class:"my-2",title:"Payer en ligne",subtitle:"par carte bancaire",value:M(z).EnLigne,disabled:!a.settings.SupportPaiementByCard},{append:t(()=>[e(x,null,{default:t(()=>p[2]||(p[2]=[o("mdi-credit-card")])),_:1,__:[2]})]),_:1},8,["value","disabled"]),e(O,{rounded:"",class:"my-2",title:"Payer par virement",value:M(z).Virement},{append:t(()=>[e(x,null,{default:t(()=>p[3]||(p[3]=[o("mdi-bank")])),_:1,__:[3]})]),_:1},8,["value"]),e(O,{rounded:"",class:"my-2",title:"Payer par chèque",value:M(z).Cheque},{append:t(()=>[e(x,null,{default:t(()=>p[4]||(p[4]=[o("mdi-checkbook")])),_:1,__:[4]})]),_:1},8,["value"])]),_:1},8,["selected"])]),_:1}),e(f,{"align-self":"start",cols:"8"},{default:t(()=>[e(L,{title:M(Dt)[u.value]},{default:t(()=>[u.value==M(z).EnLigne?(d(),g(R,{key:0},{default:t(()=>p[5]||(p[5]=[o(" TODO: see https://github.com/benoitkugler/registro/issues/76 ")])),_:1,__:[5]})):u.value==M(z).Virement?(d(),g(R,{key:1},{default:t(()=>{var _;return[o(" Vous pouvez effectuer votre virement vers "+S((_=a.settings.BankAccounts)!=null&&_.length?"l'un des comptes suivants":"le compte suivant")+" : ",1),e(le,{class:"my-2"},{default:t(()=>[(d(!0),I(T,null,N(a.settings.BankAccounts,V=>(d(),g(O,{title:V[0],subtitle:V[1]},{append:t(()=>[e($,{size:"x-small",icon:"mdi-content-copy",onClick:l=>n(V[1])},null,8,["onClick"])]),_:2},1032,["title","subtitle"]))),256))]),_:1}),e(J,{type:"info"},{default:t(()=>[p[6]||(p[6]=o(" Merci d'indiquer impérativement le ")),p[7]||(p[7]=U("b",null,"label",-1)),p[8]||(p[8]=o(" suivant sur votre virement, qui nous permettra de l'identifier : ")),e(P,{"no-gutters":"",class:"mt-2"},{default:t(()=>[e(f,{"align-self":"center",class:"text-center"},{default:t(()=>[e(ee,{variant:"elevated"},{default:t(()=>[o(S(a.settings.VirementCode),1)]),_:1})]),_:1}),e(f,{"align-self":"center",cols:"auto"},{default:t(()=>[e($,{class:"my-2",size:"x-small",icon:"mdi-content-copy",onClick:p[1]||(p[1]=V=>c(a.settings.VirementCode))})]),_:1})]),_:1})]),_:1,__:[6,7,8]})]}),_:1})):u.value==M(z).Cheque?(d(),g(R,{key:2},{default:t(()=>[p[10]||(p[10]=o(" Merci d'envoyer votre chèque à l'ordre ")),U("b",null,S(a.settings.Cheque.Ordre),1),p[11]||(p[11]=o(" à l'adresse suivante : ")),e(P,{justify:"center"},{default:t(()=>[e(f,{cols:"auto"},{default:t(()=>[e(L,{class:"my-2"},{default:t(()=>[e(R,null,{default:t(()=>[o(S(a.settings.Cheque.Adresse[0])+" ",1),p[9]||(p[9]=U("br",null,null,-1)),o(" "+S(a.settings.Cheque.Adresse[1]),1)]),_:1,__:[9]})]),_:1})]),_:1})]),_:1}),p[12]||(p[12]=o(" Il sera encaissé environ une dizaine de jours avant le début du séjour. "))]),_:1,__:[10,11,12]})):B("",!0)]),_:1},8,["title"])]),_:1})]),_:1})]),_:1,__:[13,14]})]),_:1}))}}),$t=K({__name:"FinancesCard",props:{token:{},dossier:{},isPaiementOpen:{type:Boolean},settings:{}},emits:["refresh"],setup(m,{emit:i}){const a=m,u=i;ne(V);const n=F(!1);async function c(v,s){n.value=!1,await A.CreateAide(s,v,{token:a.token})!==void 0&&(A.showMessage("Aide ajoutée avec succès (validation à venir). Merci !"),u("refresh"))}const y=q(()=>{const v=[];return Object.values(a.dossier.Aides||{}).forEach(s=>v.push(...Object.values(s||{}))),v}),p=q(()=>y.value.filter(v=>!v.Valide).length),_=F({});async function V(){const v=await A.GetStructureaides();v!==void 0&&(_.value=v||{})}const l=F(!1);return(v,s)=>(d(),g(L,{subtitle:"Réglement",class:"mt-2"},{append:t(()=>{var b;return[e($,{size:"small",class:"mr-1",onClick:s[0]||(s[0]=k=>l.value=!0),disabled:!a.isPaiementOpen||a.dossier.Bilan.Statut==M(oe).Complet},{prepend:t(()=>[e(x,null,{default:t(()=>s[4]||(s[4]=[o("mdi-cash-plus")])),_:1,__:[4]})]),default:t(()=>[s[5]||(s[5]=o(" Régler "))]),_:1,__:[5]},8,["disabled"]),e($,{size:"small",disabled:!((b=a.dossier.Participants)!=null&&b.length),onClick:s[1]||(s[1]=k=>n.value=!0)},{prepend:t(()=>[e(x,{color:"green"},{default:t(()=>s[6]||(s[6]=[o("mdi-plus")])),_:1,__:[6]})]),default:t(()=>[s[7]||(s[7]=o(" Ajouter une aide "))]),_:1,__:[7]},8,["disabled"])]}),default:t(()=>[e(R,null,{default:t(()=>[e(P,{class:"mt-2"},{default:t(()=>[e(f,null,{default:t(()=>s[8]||(s[8]=[o("Prix des séjours")])),_:1,__:[8]}),e(f,{cols:"4",class:"text-right"},{default:t(()=>[o(S(v.dossier.Bilan.Demande),1)]),_:1})]),_:1}),e(P,{class:"my-0"},{default:t(()=>[e(f,{cols:"auto"},{default:t(()=>[e(de,null,{activator:t(({props:b})=>[e(x,ce(ve(b)),{default:t(()=>s[9]||(s[9]=[o(" mdi-view-list ")])),_:2,__:[9]},1040)]),default:t(()=>[_.value?(d(),g(L,{key:0,title:"Aides extérieures"},{default:t(()=>[e(R,null,{default:t(()=>[(d(!0),I(T,null,N(y.value,b=>(d(),g(ee,{color:b.Valide?void 0:"orange",class:"mx-1"},{default:t(()=>[o(S(_.value[b.IdStructureaide].Nom)+" : "+S(M(Y).montant(b.Valeur)),1)]),_:2},1032,["color"]))),256))]),_:1})]),_:1})):B("",!0)]),_:1})]),_:1}),e(f,null,{default:t(()=>[s[11]||(s[11]=o(" Dont aides extérieures ")),p.value?(d(),g(x,{key:0,color:"orange"},{default:t(()=>s[10]||(s[10]=[o("mdi-clock")])),_:1,__:[10]})):B("",!0)]),_:1,__:[11]}),e(f,{cols:"4",class:"text-right"},{default:t(()=>[o(S(v.dossier.Bilan.Aides),1)]),_:1})]),_:1}),e(Pe,{thickness:"1"}),e(P,{class:"my-0"},{default:t(()=>[e(f,{cols:"auto"},{default:t(()=>[e(de,null,{activator:t(({props:b})=>[e(x,ce(ve(b)),{default:t(()=>s[12]||(s[12]=[o(" mdi-view-list ")])),_:2,__:[12]},1040)]),default:t(()=>[e(L,{title:"Paiements"},{default:t(()=>[e(R,null,{default:t(()=>[(d(!0),I(T,null,N(a.dossier.Paiements,b=>(d(),g(ee,{class:"mx-1"},{default:t(()=>[o(S(b.Payeur)+" : "+S(M(Y).montant(b.Montant)),1)]),_:2},1024))),256))]),_:1})]),_:1})]),_:1})]),_:1}),e(f,null,{default:t(()=>s[13]||(s[13]=[o(" Paiements ")])),_:1,__:[13]}),e(f,{cols:"4",class:"text-right"},{default:t(()=>[o(S(v.dossier.Bilan.Recu),1)]),_:1})]),_:1}),e(Pe,{thickness:"1"}),e(P,{class:"my-0"},{default:t(()=>[e(f,null,{default:t(()=>s[14]||(s[14]=[o("Montant restant à régler")])),_:1,__:[14]}),e(f,{cols:"4",class:"text-right"},{default:t(()=>[U("b",{class:re(v.dossier.Bilan.Statut==M(oe).Complet?"text-green":"text-orange")},S(v.dossier.Bilan.Restant),3)]),_:1})]),_:1})]),_:1}),e(Z,{modelValue:n.value,"onUpdate:modelValue":s[2]||(s[2]=b=>n.value=b),"max-width":"800px"},{default:t(()=>[e(xt,{dossier:a.dossier,structureaides:_.value,onSave:c},null,8,["dossier","structureaides"])]),_:1},8,["modelValue"]),e(Z,{modelValue:l.value,"onUpdate:modelValue":s[3]||(s[3]=b=>l.value=b),"max-width":"800px"},{default:t(()=>[e(Et,{token:a.token,dossier:a.dossier,settings:a.settings},null,8,["token","dossier","settings"])]),_:1},8,["modelValue"])]),_:1}))}}),Nt={key:0},jt=K({__name:"JoomeoCard",props:{token:{}},setup(m){const i=m;ne(u);const a=F(null);async function u(){const n=await A.LoadJoomeo({token:i.token});n!==void 0&&(a.value=n)}return(n,c)=>a.value==null?(d(),g(me,{key:0,class:"mx-auto",width:"600px",type:"card"})):a.value.Loggin?(d(),g(L,{key:1,class:"mx-auto",title:"Identifiants et albums Joomeo",subtitle:"Retrouvez les photos prises dans nos séjours.","min-width":"600px"},{default:t(()=>[e(R,null,{default:t(()=>[e(P,null,{default:t(()=>[e(f,null,{default:t(()=>[c[0]||(c[0]=o(" Identifiant : ")),U("b",null,S(a.value.Loggin),1)]),_:1,__:[0]}),e(f,null,{default:t(()=>[c[1]||(c[1]=o(" Mot de passe : ")),U("b",null,S(a.value.Password),1)]),_:1,__:[1]})]),_:1}),e(P,null,{default:t(()=>[e(f,null,{default:t(()=>{var y;return[(y=a.value.Albums)!=null&&y.length?B("",!0):(d(),I("i",Nt,"Aucun album n'est encore disponible.")),(d(!0),I(T,null,N(a.value.Albums,p=>(d(),g(ee,{class:"mx-1"},{default:t(()=>[o(S(p),1)]),_:2},1024))),256))]}),_:1})]),_:1})]),_:1}),e(se,null,{default:t(()=>[e($,{block:"",color:"primary",variant:"outlined",href:a.value.SpaceURL,target:"_blank"},{default:t(()=>c[2]||(c[2]=[o(" Accéder à mon espace jooméo ")])),_:1,__:[2]},8,["href"])]),_:1})]),_:1})):(d(),g(J,{key:2,class:"mx-auto",type:"info"},{default:t(()=>c[3]||(c[3]=[o(" Il n'y a encore rien à voir... ")])),_:1,__:[3]}))}}),qt={class:"pa-2"},Ht=K({__name:"FichesanitaireForm",props:{fiche:{}},emits:["save","uploadVaccin","deleteVaccin","transfert"],setup(m,{emit:i}){const a=m,u=i,n=De(Ke(a.fiche.Fichesanitaire)),c=F(a.fiche.RespoSecuriteSociale),y=q(()=>n.Allergies.Asthme||n.Allergies.Alimentaires||n.Allergies.Medicamenteuses||n.Allergies.Autres.length!=0),p=q(()=>a.fiche.Fichesanitaire.Mails||[]),_=q(()=>a.fiche.State==X.NoFiche?void 0:`Dernière modification : ${Y.time(a.fiche.Fichesanitaire.LastModif)} / Propriétaire(s) :
         ${p.value.join(" ; ")}`);return(V,l)=>{const v=xe;return d(),I("div",qt,[e(L,{title:a.fiche.Personne,subtitle:_.value},{default:t(()=>[e(R,null,{default:t(()=>{var s;return[a.fiche.IsLocked?(d(),g(J,{key:0},{default:t(()=>[o(" Votre adresse mail n'est pas reconnu dans notre système comme celle du responsable de cette fiche sanitaire. Elle est actuellement liée "+S(p.value.length>=2?"aux adresses":"à l'adresse")+" ",1),U("b",null,S(p.value.join(" ; ")),1),l[30]||(l[30]=o(". ")),l[31]||(l[31]=U("br",null,null,-1)),o(" Afin de protéger vos données, vous devez demander un transfert des droits de lecture et d'écriture. Un mail contenant un lien de transfert va être envoyé "+S(p.value.length>=2?"aux adresses":"à l'adresse")+" ",1),U("i",null,"("+S(p.value.join(" ; "))+")",1),l[32]||(l[32]=o(". ")),e($,{variant:"outlined",onClick:l[0]||(l[0]=b=>u("transfert")),block:"",class:"mt-4"},{prepend:t(()=>[e(x,null,{default:t(()=>l[28]||(l[28]=[o("mdi-lock-open")])),_:1,__:[28]})]),default:t(()=>[l[29]||(l[29]=o(" Demander le transfert de la fiche sanitaire "))]),_:1,__:[29]})]),_:1,__:[30,31,32]})):a.fiche.State==M(X).UpToDate&&((s=a.fiche.VaccinsFiles)!=null&&s.length)?(d(),g(J,{key:1,type:"success"},{default:t(()=>l[33]||(l[33]=[o(" La fiche sanitaire est à jour. Merci ! ")])),_:1,__:[33]})):a.fiche.State==M(X).UpToDate?(d(),g(J,{key:2,type:"warning"},{default:t(()=>l[34]||(l[34]=[o(" La fiche sanitaire est à jour, mais vous n'avez déposé aucun vaccin. ")])),_:1,__:[34]})):a.fiche.State==M(X).Outdated?(d(),g(J,{key:3,type:"warning"},{default:t(()=>l[35]||(l[35]=[o(" Merci de bien vouloir vérifier que les données ci-dessous sont à jour et les valider. "),U("br",null,null,-1),o("Nous avons besoin de votre consentement, décrit dans l'encart "),U("b",null,"Validation",-1),o(" (en bas de page). ")])),_:1,__:[35]})):(d(),g(J,{key:4,type:"info"},{default:t(()=>l[36]||(l[36]=[o(" Merci de compléter la fiche sanitaire ci-dessous. ")])),_:1,__:[36]}))]}),_:1})]),_:1},8,["title","subtitle"]),a.fiche.IsLocked?B("",!0):(d(),I(T,{key:0},[e(L,{subtitle:"Vaccinations",class:"my-2"},{default:t(()=>[e(R,null,{default:t(()=>[l[37]||(l[37]=o(" Merci de joindre le scan des pages « vaccinations » du carnet de santé du participant. Seul le DTPolio est obligatoire pour être accueilli en séjour de vacances. ")),l[38]||(l[38]=U("br",null,null,-1)),l[39]||(l[39]=U("i",null," Si le participant n’a pas les vaccins obligatoires, joindre un certificat médical de contre-indication. ",-1)),e(v,{class:"mt-2",demande:a.fiche.VaccinsDemande,files:a.fiche.VaccinsFiles||[],"in-upload":!1,optionnelle:null,"show-upload-text":"",onUpload:l[1]||(l[1]=s=>u("uploadVaccin",s)),onDelete:l[2]||(l[2]=s=>u("deleteVaccin",s))},null,8,["demande","files"])]),_:1,__:[37,38,39]})]),_:1}),e(L,{subtitle:"Handicap",class:"my-2"},{default:t(()=>[e(R,null,{default:t(()=>[e(H,{modelValue:n.Handicap,"onUpdate:modelValue":l[3]||(l[3]=s=>n.Handicap=s),color:"primary",label:"Le participant est porteur de handicap. ","hide-details":""},null,8,["modelValue"]),e(fe,null,{default:t(()=>[e(J,{modelValue:n.Handicap,"onUpdate:modelValue":l[4]||(l[4]=s=>n.Handicap=s),color:"blue-lighten-4"},{default:t(()=>l[40]||(l[40]=[o(" Merci de "),U("b",null,"contacter",-1),o(" au plus vite le directeur afin qu’un accueil individualisé puisse être mis en place. ")])),_:1,__:[40]},8,["modelValue"])]),_:1})]),_:1})]),_:1}),e(L,{subtitle:"Traitement",class:"my-2"},{default:t(()=>[e(R,null,{default:t(()=>[e(H,{modelValue:n.TraitementMedical,"onUpdate:modelValue":l[5]||(l[5]=s=>n.TraitementMedical=s),color:"primary",label:"Le participant suit un traitement médical pendant le séjour.","hide-details":""},null,8,["modelValue"]),e(fe,null,{default:t(()=>[e(J,{modelValue:n.TraitementMedical,"onUpdate:modelValue":l[6]||(l[6]=s=>n.TraitementMedical=s),color:"blue-lighten-4"},{default:t(()=>l[41]||(l[41]=[o(" Merci de joindre une "),U("b",null,"ordonnance",-1),o(" récente et les "),U("b",null,"médicaments",-1),o(" correspondants (avec la notice). Aucun médicament ne pourra être pris sans ordonnance. ")])),_:1,__:[41]},8,["modelValue"])]),_:1})]),_:1})]),_:1}),e(L,{subtitle:"Maladies",class:"my-2"},{default:t(()=>[e(R,null,{default:t(()=>[l[42]||(l[42]=o(" Le participant a-t-il déjà eu les maladies suivantes ? ")),e(P,{class:"mt-2"},{default:t(()=>[e(f,{cols:"3",class:"py-0"},{default:t(()=>[e(H,{modelValue:n.Maladies.Rubeole,"onUpdate:modelValue":l[7]||(l[7]=s=>n.Maladies.Rubeole=s),color:"primary",label:"Rubéole","hide-details":""},null,8,["modelValue"])]),_:1}),e(f,{cols:"3",class:"py-0"},{default:t(()=>[e(H,{modelValue:n.Maladies.Varicelle,"onUpdate:modelValue":l[8]||(l[8]=s=>n.Maladies.Varicelle=s),color:"primary",label:"Varicelle","hide-details":""},null,8,["modelValue"])]),_:1}),e(f,{cols:"3",class:"py-0"},{default:t(()=>[e(H,{modelValue:n.Maladies.Angine,"onUpdate:modelValue":l[9]||(l[9]=s=>n.Maladies.Angine=s),color:"primary",label:"Angine","hide-details":""},null,8,["modelValue"])]),_:1}),e(f,{cols:"3",class:"py-0"},{default:t(()=>[e(H,{modelValue:n.Maladies.Oreillons,"onUpdate:modelValue":l[10]||(l[10]=s=>n.Maladies.Oreillons=s),color:"primary",label:"Oreillons","hide-details":""},null,8,["modelValue"])]),_:1}),e(f,{cols:"3",class:"py-0"},{default:t(()=>[e(H,{modelValue:n.Maladies.Scarlatine,"onUpdate:modelValue":l[11]||(l[11]=s=>n.Maladies.Scarlatine=s),color:"primary",label:"Scarlatine","hide-details":""},null,8,["modelValue"])]),_:1}),e(f,{cols:"3",class:"py-0"},{default:t(()=>[e(H,{modelValue:n.Maladies.Coqueluche,"onUpdate:modelValue":l[12]||(l[12]=s=>n.Maladies.Coqueluche=s),color:"primary",label:"Coqueluche","hide-details":""},null,8,["modelValue"])]),_:1}),e(f,{cols:"3",class:"py-0"},{default:t(()=>[e(H,{modelValue:n.Maladies.Otite,"onUpdate:modelValue":l[13]||(l[13]=s=>n.Maladies.Otite=s),color:"primary",label:"Otite","hide-details":""},null,8,["modelValue"])]),_:1}),e(f,{cols:"3",class:"py-0"},{default:t(()=>[e(H,{modelValue:n.Maladies.Rougeole,"onUpdate:modelValue":l[14]||(l[14]=s=>n.Maladies.Rougeole=s),color:"primary",label:"Rougeole","hide-details":""},null,8,["modelValue"])]),_:1}),e(f,{cols:"3",class:"py-0"},{default:t(()=>[e(H,{modelValue:n.Maladies.Rhumatisme,"onUpdate:modelValue":l[15]||(l[15]=s=>n.Maladies.Rhumatisme=s),color:"primary",label:"Rhumatisme articulaire aigü ","hide-details":""},null,8,["modelValue"])]),_:1})]),_:1})]),_:1,__:[42]})]),_:1}),e(L,{subtitle:"Allergies",class:"my-2"},{default:t(()=>[e(R,null,{default:t(()=>[l[43]||(l[43]=o(" Le participant a-t-il une des allergies suivantes ? ")),e(P,{class:"mt-2"},{default:t(()=>[e(f,{"align-self":"center",cols:"3",class:"py-0"},{default:t(()=>[e(H,{modelValue:n.Allergies.Asthme,"onUpdate:modelValue":l[16]||(l[16]=s=>n.Allergies.Asthme=s),color:"primary",label:"Asthme","hide-details":""},null,8,["modelValue"])]),_:1}),e(f,{"align-self":"center",cols:"3",class:"py-0"},{default:t(()=>[e(H,{modelValue:n.Allergies.Alimentaires,"onUpdate:modelValue":l[17]||(l[17]=s=>n.Allergies.Alimentaires=s),color:"primary",label:"Alimentaires","hide-details":""},null,8,["modelValue"])]),_:1}),e(f,{"align-self":"center",cols:"3",class:"py-0"},{default:t(()=>[e(H,{modelValue:n.Allergies.Medicamenteuses,"onUpdate:modelValue":l[18]||(l[18]=s=>n.Allergies.Medicamenteuses=s),color:"primary",label:"Médicamenteuses","hide-details":""},null,8,["modelValue"])]),_:1}),e(f,{"align-self":"center",cols:"3",class:"py-0"},{default:t(()=>[e(te,{density:"compact",variant:"outlined","hide-details":"",label:"Autres allergies",modelValue:n.Allergies.Autres,"onUpdate:modelValue":l[19]||(l[19]=s=>n.Allergies.Autres=s)},null,8,["modelValue"])]),_:1})]),_:1}),e(fe,null,{default:t(()=>[y.value?(d(),g(P,{key:0},{default:t(()=>[e(f,null,{default:t(()=>[e(ae,{variant:"outlined",label:"Conduite à tenir",modelValue:n.Allergies.ConduiteATenir,"onUpdate:modelValue":l[20]||(l[20]=s=>n.Allergies.ConduiteATenir=s),hint:"Préciser la cause de l’allergie et la conduite à tenir (si automédication le signaler). Si un PAI a été mis en place durant le temps scolaire, merci de nous le signaler.","persistent-hint":"",rules:[M(Je).required("Merci de nous informer de la conduite à tenir en cas d'allergie.")]},null,8,["modelValue","rules"])]),_:1})]),_:1})):B("",!0)]),_:1})]),_:1,__:[43]})]),_:1}),e(L,{subtitle:"Divers",class:"my-2"},{default:t(()=>[e(R,null,{default:t(()=>[e(P,null,{default:t(()=>[e(f,null,{default:t(()=>[e(ae,{variant:"outlined",label:"Difficultés de santé",modelValue:n.DifficultesSante,"onUpdate:modelValue":l[21]||(l[21]=s=>n.DifficultesSante=s),hint:"Indiquer les difficultés de santé (maladie, accident, crises convulsives, hospitalisation, opération, rééducation) en précisant les dates et les précautions à prendre.","persistent-hint":""},null,8,["modelValue"])]),_:1}),e(f,null,{default:t(()=>[e(ae,{variant:"outlined",label:"Recommandations utiles",modelValue:n.Recommandations,"onUpdate:modelValue":l[22]||(l[22]=s=>n.Recommandations=s),hint:"Préciser si le participant porte des lunettes, des lentilles, des prothèses auditives, des prothèses dentaires...","persistent-hint":""},null,8,["modelValue"])]),_:1})]),_:1})]),_:1})]),_:1}),e(L,{subtitle:"Médecin traitant",class:"my-2"},{default:t(()=>[e(R,null,{default:t(()=>[e(P,null,{default:t(()=>[e(f,null,{default:t(()=>[e(te,{variant:"outlined",density:"compact",label:"Nom",modelValue:n.Medecin.Nom,"onUpdate:modelValue":l[23]||(l[23]=s=>n.Medecin.Nom=s),"hide-details":""},null,8,["modelValue"])]),_:1}),e(f,null,{default:t(()=>[e(te,{variant:"outlined",density:"compact",label:"Téléphone","model-value":M(Y).tel(n.Medecin.Tel),"onUpdate:modelValue":l[24]||(l[24]=s=>n.Medecin.Tel=s),"hide-details":""},null,8,["model-value"])]),_:1})]),_:1})]),_:1})]),_:1}),e(L,{subtitle:"Responsable légal",class:"my-2"},{default:t(()=>[e(R,null,{default:t(()=>[e(P,null,{default:t(()=>[e(f,{"align-self":"center"},{default:t(()=>{var s;return[l[45]||(l[45]=o(" Téléphone : ")),(s=a.fiche.RespoTels)!=null&&s.length?B("",!0):(d(),g(ee,{key:0,label:""},{default:t(()=>l[44]||(l[44]=[o("Aucun numéro")])),_:1,__:[44]})),(d(!0),I(T,null,N(a.fiche.RespoTels,b=>(d(),g(ee,{label:"",class:"mx-1"},{default:t(()=>[o(S(M(Y).tel(b)),1)]),_:2},1024))),256))]}),_:1,__:[45]}),e(f,{"align-self":"center"},{default:t(()=>[e(te,{variant:"outlined",density:"compact",label:"Numéro de contact","model-value":M(Y).tel(n.Tel),"onUpdate:modelValue":l[25]||(l[25]=s=>n.Tel=s),hint:"Numéro de téléphone supplémentaire (optionnel)","persistent-hint":""},null,8,["model-value"])]),_:1})]),_:1}),e(P,null,{default:t(()=>[e(f,null,{default:t(()=>[e(te,{variant:"outlined",density:"compact",label:"Sécurité sociale",modelValue:c.value,"onUpdate:modelValue":l[26]||(l[26]=s=>c.value=s),"hide-details":""},null,8,["modelValue"])]),_:1})]),_:1})]),_:1})]),_:1}),e(L,{class:"mt-4",variant:"outlined",color:"success",title:"Validation"},{default:t(()=>[e(R,{class:"text-black"},{default:t(()=>l[46]||(l[46]=[o(" Le responsable légal déclare "),U("b",null,"exacts",-1),o(" les renseignements portés sur ce formulaire et autorise le responsable du séjour à prendre, le cas échéant, "),U("b",null,"toutes mesures",-1),o(" (traitement médical, hospitalisation, intervention chirurgicale) rendues nécessaires par l'état du participant. Il autorise également, si nécessaire, le directeur du séjour à faire sortir le participant de l’hôpital après une hospitalisation. ")])),_:1,__:[46]}),e(se,null,{default:t(()=>[e($,{block:"",color:"success",onClick:l[27]||(l[27]=s=>u("save",n,c.value))},{prepend:t(()=>[e(x,null,{default:t(()=>l[47]||(l[47]=[o("mdi-content-save")])),_:1,__:[47]})]),default:t(()=>[o(" Enregistrer la fiche sanitaire de "+S(a.fiche.Personne),1)]),_:1})]),_:1})]),_:1})],64))])}}}),Bt=K({__name:"FichessanitairesCard",props:{token:{}},emits:["close","updateNotifs"],setup(m,{emit:i}){const a=m,u=i;ne(y);const n=F(0),c=F([]);async function y(){const v=await A.LoadFichesanitaires({token:a.token});v!==void 0&&(c.value=v.Fiches||[],c.value.length&&n.value==0&&(n.value=c.value[0].Fichesanitaire.IdPersonne),u("updateNotifs",v.ToFillCount))}async function p(v,s){await A.UpdateFichesanitaire({Token:a.token,Fichesanitaire:v,SecuriteSocialeResponsable:s})!==void 0&&(A.showMessage("La fiche sanitaire a bien été enregistrée. Merci !"),y())}async function _(v,s){const b=c.value[v];await A.UploadVaccin(s,{token:a.token,idPersonne:b.Fichesanitaire.IdPersonne})!==void 0&&(y(),A.showMessage("Le vaccin a bien été téléversé. Merci !"))}async function V(v,s){c.value[v],await A.DeleteVaccin({key:s.Key})!==void 0&&(y(),A.showMessage("Le vaccin a bien été supprimé."))}async function l(v){u("close"),await A.TransfertFicheSanitaire({token:a.token,idPersonne:v.IdPersonne})!==void 0&&A.showMessage("Mail de transfert envoyé avec succès.")}return(v,s)=>(d(),g(L,{title:"Fiches sanitaires et vaccins"},{append:t(()=>[e(Ie,{modelValue:n.value,"onUpdate:modelValue":s[0]||(s[0]=b=>n.value=b)},{default:t(()=>[(d(!0),I(T,null,N(c.value,b=>(d(),g(Te,{value:b.Fichesanitaire.IdPersonne},{default:t(()=>{var k;return[o(S(b.Personne)+" ",1),b.State==M(X).NoFiche||b.State==M(X).Outdated||!((k=b.VaccinsFiles)!=null&&k.length)?(d(),g(x,{key:0,class:"ml-2",color:"warning"},{default:t(()=>s[1]||(s[1]=[o(" mdi-alert ")])),_:1,__:[1]})):(d(),g(x,{key:1,class:"ml-2",color:"success"},{default:t(()=>s[2]||(s[2]=[o(" mdi-check ")])),_:1,__:[2]}))]}),_:2},1032,["value"]))),256))]),_:1},8,["modelValue"])]),default:t(()=>[e(R,null,{default:t(()=>[e(Le,{"model-value":n.value},{default:t(()=>[(d(!0),I(T,null,N(c.value,(b,k)=>(d(),g(Fe,{value:b.Fichesanitaire.IdPersonne},{default:t(()=>[e(Ht,{fiche:b,onSave:p,onUploadVaccin:D=>_(k,D),onDeleteVaccin:D=>V(k,D),onTransfert:D=>l(b.Fichesanitaire)},null,8,["fiche","onUploadVaccin","onDeleteVaccin","onTransfert"])]),_:2},1032,["value"]))),256))]),_:1},8,["model-value"])]),_:1})]),_:1}))}}),Ot=We({name:String,itemAriaLabel:{type:String,default:"$vuetify.rating.ariaLabel.item"},activeColor:String,color:String,clearable:Boolean,disabled:Boolean,emptyIcon:{type:Se,default:"$ratingEmpty"},fullIcon:{type:Se,default:"$ratingFull"},halfIncrements:Boolean,hover:Boolean,length:{type:[Number,String],default:5},readonly:Boolean,modelValue:{type:[Number,String],default:0},itemLabels:Array,itemLabelPosition:{type:String,default:"top",validator:m=>["top","bottom"].includes(m)},ripple:Boolean,...rt(),...ut(),...it(),...ot(),...st()},"VRating"),zt=Ge()({name:"VRating",props:Ot(),emits:{"update:modelValue":m=>!0},setup(m,i){let{slots:a}=i;const{t:u}=Xe(),{themeClasses:n}=Ze(m),c=Qe(m,"modelValue"),y=q(()=>Ye(parseFloat(c.value),0,Number(m.length))),p=q(()=>et(Number(m.length),1)),_=q(()=>p.value.flatMap(w=>m.halfIncrements?[w-.5,w]:[w])),V=tt(-1),l=q(()=>_.value.map(w=>{const h=m.hover&&V.value>-1,r=y.value>=w,E=V.value>=w,G=(h?E:r)?m.fullIcon:m.emptyIcon,pe=m.activeColor??m.color,ie=r||E?pe:m.color;return{isFilled:r,isHovered:E,icon:G,color:ie}})),v=q(()=>[0,..._.value].map(w=>{function h(){V.value=w}function r(){V.value=-1}function E(){m.disabled||m.readonly||(c.value=y.value===w&&m.clearable?0:w)}return{onMouseenter:m.hover?h:void 0,onMouseleave:m.hover?r:void 0,onClick:E}})),s=lt(),b=q(()=>m.name??`v-rating-${s}`);function k(w){var Ce,Ue;let{value:h,index:r,showStar:E=!0}=w;const{onMouseenter:C,onMouseleave:G,onClick:pe}=v.value[r+1],ie=`${b.value}-${String(h).replace(".","-")}`,ke={color:(Ce=l.value[r])==null?void 0:Ce.color,density:m.density,disabled:m.disabled,icon:(Ue=l.value[r])==null?void 0:Ue.icon,ripple:m.ripple,size:m.size,variant:"plain"};return U(T,null,[U("label",{for:ie,class:re({"v-rating__item--half":m.halfIncrements&&h%1>0,"v-rating__item--full":m.halfIncrements&&h%1===0}),onMouseenter:C,onMouseleave:G,onClick:pe},[U("span",{class:"v-rating__hidden"},[u(m.itemAriaLabel,h,m.length)]),E?a.item?a.item({...l.value[r],props:ke,value:h,index:r,rating:y.value}):e($,_e({"aria-label":u(m.itemAriaLabel,h,m.length)},ke),null):void 0]),U("input",{class:"v-rating__hidden",name:b.value,id:ie,type:"radio",value:h,checked:y.value===h,tabindex:-1,readonly:m.readonly,disabled:m.disabled},null)])}function D(w){return a["item-label"]?a["item-label"](w):w.label?U("span",null,[w.label]):U("span",null,[o(" ")])}return at(()=>{var h;const w=!!((h=m.itemLabels)!=null&&h.length)||a["item-label"];return e(m.tag,{class:re(["v-rating",{"v-rating--hover":m.hover,"v-rating--readonly":m.readonly},n.value,m.class]),style:nt(m.style)},{default:()=>[e(k,{value:0,index:-1,showStar:!1},null),p.value.map((r,E)=>{var C,G;return U("div",{class:"v-rating__wrapper"},[w&&m.itemLabelPosition==="top"?D({value:r,index:E,label:(C=m.itemLabels)==null?void 0:C[E]}):void 0,U("div",{class:"v-rating__item"},[m.halfIncrements?U(T,null,[e(k,{value:r-.5,index:E*2},null),e(k,{value:r,index:E*2+1},null)]):e(k,{value:r,index:E},null)]),w&&m.itemLabelPosition==="bottom"?D({value:r,index:E,label:(G=m.itemLabels)==null?void 0:G[E]}):void 0])})]})}),{}}}),W=K({__name:"RatingField",props:dt({label:{}},{modelValue:{required:!0},modelModifiers:{}}),emits:["update:modelValue"],setup(m){const i=m,a=mt(m,"modelValue");return(u,n)=>(d(),g(P,{"no-gutters":""},{default:t(()=>[e(f,{cols:"12"},{default:t(()=>[o(S(i.label),1)]),_:1}),e(f,{cols:"12"},{default:t(()=>[e(zt,{hover:"",color:"primary",length:4,modelValue:a.value,"onUpdate:modelValue":n[0]||(n[0]=c=>a.value=c),size:"32"},null,8,["modelValue"])]),_:1})]),_:1}))}}),Kt={key:1},Jt=K({__name:"SondagesCard",props:{token:{},initialCamp:{}},setup(m){const i=m;ne(n);const a=F(0),u=F(null);async function n(){const p=await A.LoadSondages({token:i.token});if(p===void 0)return;u.value=p||[];const _=(p||[]).filter(c);(p||[]).map(V=>V.Sondage.IdCamp).includes(i.initialCamp)?a.value=i.initialCamp:_.length?a.value=_[0].Sondage.IdCamp:a.value==0&&(p!=null&&p.length)&&(a.value=p[0].Sondage.IdCamp)}function c(p){return pt(p.Sondage.Modified)}async function y(p){await A.UpdateSondages({Token:i.token,Id:p.Id,IdCamp:p.IdCamp,Reponse:p})!==void 0&&(n(),A.showMessage("Votre réponse a bien été enregistrée. Merci !"))}return(p,_)=>{var V;return u.value==null?(d(),g(me,{key:0,type:"card"})):u.value!=null?(d(),g(L,{key:1,title:"Enquête de satisfaction",width:(V=u.value)!=null&&V.length?void 0:"600px",class:"mx-auto"},{default:t(()=>[e(R,null,{default:t(()=>[u.value.length?(d(),g(J,{key:0,color:"secondary",icon:"mdi-comment-quote"},{default:t(()=>_[1]||(_[1]=[o(" Afin d'améliorer nos prestations, nous avons à cœur de vous laisser la parole. Vos suggestions, remarques et ressentis nous aiderons à améliorer nos séjours. Merci d'avance de ce temps que vous réserverez pour répondre à cette courte enquête. ")])),_:1,__:[1]})):(d(),I("div",Kt," L'enquête n'est pas encore ouverte. Vous pouvez repasser à la fin du séjour. ")),u.value.length?(d(),g(Ie,{key:2,modelValue:a.value,"onUpdate:modelValue":_[0]||(_[0]=l=>a.value=l),grow:""},{default:t(()=>[(d(!0),I(T,null,N(u.value,l=>(d(),g(Te,{value:l.Sondage.IdCamp},{default:t(()=>[o(S(l.Camp)+" ",1),c(l)?(d(),g(ue,{key:0,inline:"",content:"Nouveau",color:"pink"})):B("",!0)]),_:2},1032,["value"]))),256))]),_:1},8,["modelValue"])):B("",!0),e(Le,{"model-value":a.value,class:"mt-2"},{default:t(()=>[(d(!0),I(T,null,N(u.value,l=>(d(),g(Fe,{value:l.Sondage.IdCamp},{default:t(()=>[e(L,{subtitle:"Vos impressions sur le séjour"},{default:t(()=>[e(R,null,{default:t(()=>[e(P,null,{default:t(()=>[e(f,null,{default:t(()=>[e(W,{label:"Informations avant le séjour",modelValue:l.Sondage.InfosAvantSejour,"onUpdate:modelValue":v=>l.Sondage.InfosAvantSejour=v},null,8,["modelValue","onUpdate:modelValue"])]),_:2},1024),e(f,null,{default:t(()=>[e(W,{label:"Informations pendant le séjour",modelValue:l.Sondage.InfosPendantSejour,"onUpdate:modelValue":v=>l.Sondage.InfosPendantSejour=v},null,8,["modelValue","onUpdate:modelValue"])]),_:2},1024),e(f,null,{default:t(()=>[e(W,{label:"L'hébergement",modelValue:l.Sondage.Hebergement,"onUpdate:modelValue":v=>l.Sondage.Hebergement=v},null,8,["modelValue","onUpdate:modelValue"])]),_:2},1024)]),_:2},1024),e(P,null,{default:t(()=>[e(f,null,{default:t(()=>[e(W,{label:"Les activités",modelValue:l.Sondage.Activites,"onUpdate:modelValue":v=>l.Sondage.Activites=v},null,8,["modelValue","onUpdate:modelValue"])]),_:2},1024),e(f,null,{default:t(()=>[e(W,{label:"Le thème",modelValue:l.Sondage.Theme,"onUpdate:modelValue":v=>l.Sondage.Theme=v},null,8,["modelValue","onUpdate:modelValue"])]),_:2},1024),e(f,null,{default:t(()=>[e(W,{label:"La nourriture",modelValue:l.Sondage.Nourriture,"onUpdate:modelValue":v=>l.Sondage.Nourriture=v},null,8,["modelValue","onUpdate:modelValue"])]),_:2},1024)]),_:2},1024),e(P,null,{default:t(()=>[e(f,null,{default:t(()=>[e(W,{label:"L'hygiène corporelle et vestimentaire",modelValue:l.Sondage.Hygiene,"onUpdate:modelValue":v=>l.Sondage.Hygiene=v},null,8,["modelValue","onUpdate:modelValue"])]),_:2},1024),e(f,null,{default:t(()=>[e(W,{label:"L'ambiance du groupe",modelValue:l.Sondage.Ambiance,"onUpdate:modelValue":v=>l.Sondage.Ambiance=v},null,8,["modelValue","onUpdate:modelValue"])]),_:2},1024),e(f,null,{default:t(()=>[e(W,{label:"Le ressenti global de votre enfant",modelValue:l.Sondage.Ressenti,"onUpdate:modelValue":v=>l.Sondage.Ressenti=v},null,8,["modelValue","onUpdate:modelValue"])]),_:2},1024)]),_:2},1024),e(P,null,{default:t(()=>[e(f,null,{default:t(()=>[e(ae,{rows:"3",label:"Message du participant",hint:"Si le participant souhaite donner son avis sur le séjour qu'il a vécu, la parole lui est donnée ci-dessus. Des regrets ? De bons souvenirs ? Des propositions d'amélioration ?","persistent-hint":"",modelValue:l.Sondage.MessageEnfant,"onUpdate:modelValue":v=>l.Sondage.MessageEnfant=v},null,8,["modelValue","onUpdate:modelValue"])]),_:2},1024),e(f,null,{default:t(()=>[e(ae,{rows:"3",label:"Message du responsable",hint:"En tant que responsable, vous avez une remarque, une suggestion, un ressenti à partager : avec plaisir ! N'hésitez pas à aborder tous les domaines : encadrement, activités, hébergement, repas, linge, etc. Nous prendrons soin de vous apporter une réponse en cas de besoin.","persistent-hint":"",modelValue:l.Sondage.MessageResponsable,"onUpdate:modelValue":v=>l.Sondage.MessageResponsable=v},null,8,["modelValue","onUpdate:modelValue"])]),_:2},1024)]),_:2},1024)]),_:2},1024),e(se,null,{default:t(()=>[e($,{block:"",variant:"outlined",color:"success",onClick:v=>y(l.Sondage)},{prepend:t(()=>[e(x,null,{default:t(()=>_[2]||(_[2]=[o("mdi-content-save")])),_:1,__:[2]})]),default:t(()=>[o(" Enregistrer mon retour pour le séjour "+S(l.Camp),1)]),_:2},1032,["onClick"])]),_:2},1024)]),_:2},1024)]),_:2},1032,["value"]))),256))]),_:1},8,["model-value"])]),_:1})]),_:1},8,["width"])):B("",!0)}}}),Gt=K({__name:"DocumentsCard",props:{token:{}},emits:["updateNotifs"],setup(m,{emit:i}){const a=m,u=i;ne(c);const n=F(null);async function c(){const _=await A.LoadDocuments({token:a.token});_!==void 0&&(n.value=_,u("updateNotifs",_.ToReadOrFillCount))}async function y(_,V,l){await A.UploadDocument(l,{token:a.token,idPersonne:_,idDemande:V})!==void 0&&(A.showMessage("Document téléversé avec succès. Merci !"),await c(),u("updateNotifs",n.value.ToReadOrFillCount))}async function p(_){await A.DeleteDocument({key:_.Key})!==void 0&&(A.showMessage("Document supprimé avec succès."),await c(),u("updateNotifs",n.value.ToReadOrFillCount))}return(_,V)=>{const l=kt,v=xe;return d(),g(L,{title:"Documents des séjours",subtitle:"Vous retrouvez ici les documents des séjours auxquels vous participez, à lire ou remplir."},{append:t(()=>V[0]||(V[0]=[])),default:t(()=>[n.value!=null?(d(),g(R,{key:0},{default:t(()=>[e(le,null,{default:t(()=>{var s,b;return[e(Re,null,{default:t(()=>V[1]||(V[1]=[o("À lire")])),_:1,__:[1]}),(s=n.value.FilesToRead)!=null&&s.length?B("",!0):(d(),g(O,{key:0},{default:t(()=>V[2]||(V[2]=[U("i",null,"Aucun document à lire.",-1)])),_:1,__:[2]})),(d(!0),I(T,null,N(n.value.FilesToRead,k=>(d(),I(T,null,[(d(!0),I(T,null,N(k.Files,D=>(d(),g(O,{title:D.NomClient,subtitle:k.Camp},{append:t(()=>[e(l,{fileKey:D.Key,isGeneratedDoc:!1},null,8,["fileKey"])]),_:2},1032,["title","subtitle"]))),256)),(d(!0),I(T,null,N(k.Generated,D=>(d(),g(O,{title:D.NomClient,subtitle:k.Camp},{append:t(()=>[e(l,{fileKey:D.Key,isGeneratedDoc:!0},null,8,["fileKey"])]),_:2},1032,["title","subtitle"]))),256))],64))),256)),e(Re,null,{default:t(()=>V[3]||(V[3]=[o("À fournir")])),_:1,__:[3]}),(b=n.value.FilesToUpload)!=null&&b.length?B("",!0):(d(),g(O,{key:1},{default:t(()=>V[4]||(V[4]=[U("i",null,"Aucun document à fournir.",-1)])),_:1,__:[4]})),(d(!0),I(T,null,N(n.value.FilesToUpload,k=>(d(),I(T,null,[(d(!0),I(T,null,N(k.Demandes,D=>(d(),g(v,{demande:D.Demande,files:D.Uploaded||[],inUpload:!1,title:`Document pour ${k.Personne}`,optionnelle:null,showUploadText:!0,onUpload:w=>y(k.IdPersonne,D.Demande.Id,w),onDelete:p},ge({_:2},[D.Demande.IdFile.Valid?{name:"prepend",fn:t(()=>[e(wt,{"content-class":"pa-1"},{activator:t(({props:w})=>[e($,_e({ref_for:!0},w,{href:M(ft)(D.DemandeFile.Key),class:"mr-2",size:"small"}),{prepend:t(()=>[e(x,null,{default:t(()=>V[5]||(V[5]=[o("mdi-download")])),_:1,__:[5]})]),default:t(()=>[V[6]||(V[6]=o(" Modèle"))]),_:2,__:[6]},1040,["href"])]),default:t(()=>[e(l,{"file-key":D.DemandeFile.Key,isGeneratedDoc:!1,large:!0},null,8,["file-key"])]),_:2},1024)]),key:"0"}:void 0]),1032,["demande","files","title","onUpload"]))),256))],64))),256))]}),_:1})]),_:1})):(d(),g(me,{key:1}))]),_:1})}}}),Wt={class:"overflow-y-auto",style:{"max-height":"75vh"}},Xt=K({__name:"Main",setup(m){const i=F("");ne(async()=>{const h=new URLSearchParams(window.location.search);i.value=h.get("token")||"";const r=Number(h.get("idEvent")||0);if(await u(),!a.value)return;const E=(a.value.Dossier.Events||[]).find(C=>C.Id==r);E&&y(E)});const a=F(null);async function u(){const h=await A.Load({token:i.value});h!==void 0&&(a.value=h)}const n=q(()=>a.value==null?[]:ct(a.value.Dossier,"espaceperso")),c=q(()=>a.value?a.value.DocumentsToReadOrFillCount+a.value.FichesanitaireToFillCount:0);function y(h){switch(h.Content.Kind){case At.CampDocs:w.value=!0;return;default:return}}const p=F(!1),_=F("");async function V(){if(!_.value.length||!a.value)return;p.value=!1;const h=await A.SendMessage({Token:i.value,Message:_.value});h!==void 0&&(A.showMessage("Message envoyé avec succès."),a.value.Dossier.Events=(a.value.Dossier.Events||[]).concat(h))}function l(h){return h.Participant.Statut==Q.Inscrit?"bg-lime-lighten-2":h.Participant.Statut==Q.AStatuer?"bg-grey-lighten-1":"bg-orange-lighten-3"}const v=F(!1);async function s(h){v.value=!1,await A.UpdateParticipants({Token:i.value,Participants:h})!==void 0&&A.showMessage("Modifications enregistrées avec succès. Merci !")}const b=F(null),k=F(!1),D=F(!1),w=F(!1);return(h,r)=>{const E=Ut;return d(),I(T,null,[e(It,{title:"Bienvenue sur votre espace de suivi"},{default:t(()=>[e($,{onClick:r[0]||(r[0]=C=>b.value=0)},{prepend:t(()=>[e(x,null,{default:t(()=>r[18]||(r[18]=[o("mdi-comment-quote")])),_:1,__:[18]})]),default:t(()=>[r[19]||(r[19]=o(" Avis "))]),_:1,__:[19]}),e($,{onClick:r[1]||(r[1]=C=>k.value=!0)},{prepend:t(()=>[e(x,null,{default:t(()=>r[20]||(r[20]=[o("mdi-image-album")])),_:1,__:[20]})]),default:t(()=>[r[21]||(r[21]=o(" Album photos "))]),_:1,__:[21]}),e(de,null,{activator:t(({props:C})=>[e($,ce(ve(C)),{prepend:t(()=>[e(x,null,{default:t(()=>r[22]||(r[22]=[o("mdi-download")])),_:1,__:[22]})]),default:t(()=>[r[23]||(r[23]=o(" Justificatifs "))]),_:2,__:[23]},1040)]),default:t(()=>[e(le,null,{default:t(()=>[e(O,{title:"Attestation de présence",subtitle:"Télécharger au format .pdf","prepend-icon":"mdi-file-document-check",link:"",href:M(we).DownloadAttestationPresence(i.value)},null,8,["href"]),e(O,{title:"Facture",subtitle:"Télécharger au format .pdf","prepend-icon":"mdi-invoice-list",href:M(we).DownloadFacture(i.value)},null,8,["href"])]),_:1})]),_:1})]),_:1}),a.value==null?(d(),g(me,{key:0,type:"card"})):(d(),g(vt,{key:1,class:"fill-height",fluid:""},{default:t(()=>[e(P,null,{default:t(()=>[e(f,{"align-self":"center",cols:"5"},{default:t(()=>[e(L,{subtitle:"Participants"},{append:t(()=>[e($,{size:"small",class:"mr-1"},{prepend:t(()=>[e(x,null,{default:t(()=>r[24]||(r[24]=[o("mdi-folder")])),_:1,__:[24]})]),default:t(()=>[e(ue,{color:c.value?"pink":"transparent",content:c.value||"",floating:""},{default:t(()=>r[25]||(r[25]=[o(" Documents ")])),_:1,__:[25]},8,["color","content"]),e(de,{activator:"parent"},{default:t(()=>[e(le,null,{default:t(()=>[e(O,{title:"Documents du séjour",subtitle:"Lettre du directeur, ...","prepend-icon":"mdi-mail",onClick:r[2]||(r[2]=C=>w.value=!0)},ge({_:2},[a.value.DocumentsToReadOrFillCount?{name:"append",fn:t(()=>[e(ue,{color:"pink",content:a.value.DocumentsToReadOrFillCount,inline:""},null,8,["content"])]),key:"0"}:void 0]),1024),e(O,{title:"Fiches sanitaires","prepend-icon":"mdi-pill",onClick:r[3]||(r[3]=C=>D.value=!0)},ge({_:2},[a.value.FichesanitaireToFillCount?{name:"append",fn:t(()=>[e(ue,{color:"pink",content:a.value.FichesanitaireToFillCount,inline:""},null,8,["content"])]),key:"0"}:void 0]),1024)]),_:1})]),_:1})]),_:1})]),default:t(()=>[e(R,null,{default:t(()=>[e(le,{class:"pa-0"},{default:t(()=>[(d(!0),I(T,null,N(a.value.Dossier.Participants,C=>(d(),g(O,{title:M(be).label(C.Personne),subtitle:M(Ve).label(C.Camp),rounded:"",class:re({"my-2":!0,[l(C)]:!0})},{append:t(()=>[e(ee,{variant:"elevated",color:M(Y).statutParticipant(C.Participant.Statut).color,"prepend-icon":M(Y).statutParticipant(C.Participant.Statut).icon},{default:t(()=>[o(S(M(Pt)[C.Participant.Statut]),1)]),_:2},1032,["color","prepend-icon"])]),_:2},1032,["title","subtitle","class"]))),256))]),_:1})]),_:1})]),_:1}),e($t,{token:i.value,dossier:a.value.Dossier,"is-paiement-open":a.value.IsPaiementOpen,settings:a.value.PaiementSettings,onRefresh:u},null,8,["token","dossier","is-paiement-open","settings"])]),_:1}),e(f,{"align-self":"center"},{default:t(()=>[e(L,{subtitle:"Suivi de votre inscription"},{append:t(()=>[e($,{onClick:r[4]||(r[4]=C=>p.value=!0)},{prepend:t(()=>[e(x,null,{default:t(()=>r[26]||(r[26]=[o("mdi-email")])),_:1,__:[26]})]),default:t(()=>[r[27]||(r[27]=o(" Nous écrire"))]),_:1,__:[27]})]),default:t(()=>[e(R,null,{default:t(()=>[U("div",Wt,[e(Ct,{side:"end",class:"mt-4",density:"compact"},{default:t(()=>[(d(!0),I(T,null,N(n.value,C=>(d(),g(E,{event:C,onGoToSondage:r[5]||(r[5]=G=>b.value=G),onGoToDocuments:r[6]||(r[6]=G=>w.value=!0)},null,8,["event"]))),256))]),_:1})])]),_:1})]),_:1})]),_:1})]),_:1}),e(Z,{modelValue:v.value,"onUpdate:modelValue":r[7]||(r[7]=C=>v.value=C)},{default:t(()=>[e(Tt,{participants:a.value.Dossier.Participants||[],onSave:s},null,8,["participants"])]),_:1},8,["modelValue"])]),_:1})),e(Z,{modelValue:p.value,"onUpdate:modelValue":r[9]||(r[9]=C=>p.value=C),"max-width":"600px"},{default:t(()=>[e(L,{title:"Nouveau message"},{default:t(()=>[e(R,null,{default:t(()=>[e(ae,{autofocus:"",placeholder:"Rédigez votre message...",modelValue:_.value,"onUpdate:modelValue":r[8]||(r[8]=C=>_.value=C),rows:"10"},null,8,["modelValue"])]),_:1}),e(se,null,{default:t(()=>[e(ye),e($,{disabled:!_.value.length,onClick:V},{prepend:t(()=>[e(x,null,{default:t(()=>r[28]||(r[28]=[o("mdi-send")])),_:1,__:[28]})]),default:t(()=>[r[29]||(r[29]=o(" Envoyer"))]),_:1,__:[29]},8,["disabled"])]),_:1})]),_:1})]),_:1},8,["modelValue"]),e(Z,{"model-value":b.value!=null,"onUpdate:modelValue":r[10]||(r[10]=C=>b.value=null)},{default:t(()=>[b.value!=null?(d(),g(Jt,{key:0,token:i.value,"initial-camp":b.value},null,8,["token","initial-camp"])):B("",!0)]),_:1},8,["model-value"]),e(Z,{modelValue:k.value,"onUpdate:modelValue":r[11]||(r[11]=C=>k.value=C)},{default:t(()=>[e(jt,{token:i.value},null,8,["token"])]),_:1},8,["modelValue"]),e(Z,{modelValue:D.value,"onUpdate:modelValue":r[14]||(r[14]=C=>D.value=C)},{default:t(()=>[e(Bt,{token:i.value,onClose:r[12]||(r[12]=C=>D.value=!1),onUpdateNotifs:r[13]||(r[13]=C=>a.value.FichesanitaireToFillCount=C)},null,8,["token"])]),_:1},8,["modelValue"]),e(Z,{modelValue:w.value,"onUpdate:modelValue":r[17]||(r[17]=C=>w.value=C),"max-width":"800px"},{default:t(()=>[e(Gt,{token:i.value,onClose:r[15]||(r[15]=C=>w.value=!1),onUpdateNotifs:r[16]||(r[16]=C=>a.value.DocumentsToReadOrFillCount=C)},null,8,["token"])]),_:1},8,["modelValue"])],64)}}}),Zt=["innerHTML"],Qt=K({__name:"App",setup(m){const i=De({text:"",color:"secondary",action:void 0,timeout:4e3}),a=F(""),u=F("");return A.onError=(n,c)=>{a.value=n,u.value=c},A.showMessage=(n,c,y)=>{i.text=n,i.color=c||"success",i.action=y,i.timeout=1e4,i.timeout=4e3},(n,c)=>(d(),g(Vt,null,{default:t(()=>[e(gt,null,{default:t(()=>[e(Xt),e(Me,{style:{"z-index":"10000"},app:"","model-value":i.text!="","onUpdate:modelValue":c[1]||(c[1]=y=>i.text=""),timeout:i.timeout,color:i.color,location:"bottom left","close-on-content-click":""},{default:t(()=>[o(S(i.text)+" ",1),i.action?(d(),g($,{key:0,onClick:c[0]||(c[0]=y=>i.action.action()),class:"ml-2"},{default:t(()=>[o(S(i.action.title),1)]),_:1})):B("",!0)]),_:1},8,["model-value","timeout","color"]),e(Me,{app:"","model-value":a.value!="","onUpdate:modelValue":c[2]||(c[2]=y=>a.value=""),timeout:4e3,color:"red"},{default:t(()=>[U("b",null,S(a.value),1),U("div",{innerHTML:u.value},null,8,Zt)]),_:1},8,["model-value"])]),_:1})]),_:1}))}}),Ee=bt(Qt);Ee.use(_t);Ee.mount("#app");
