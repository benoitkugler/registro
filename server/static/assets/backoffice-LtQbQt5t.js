import{d as G,c as F,a as Q,F as le,b as e,w as t,V as Vl,e as y,f as kl,g as h,h as V,i as _l,t as $,r as Cl,j as T,o as g,k as D,l as j,m as Y,n as Pl,p as et,q as L,s as re,u as xl,v as De,x as xe,y as w,z as Re,A as Ue,B as ze,C as Le,D as Ct,E as Ve,I as Ne,G as Gt,M as Kt,H as Xt,J as tt,K as wl,L as Qe,N as $e,O as ot,P as Xe,Q as Fe,R as Me,S as je,T as Dl,U as he,W as Zt,X as ie,Y as St,Z as Sl,_ as Il,$ as el,a0 as Al,a1 as U,a2 as tl,a3 as W,a4 as ce,a5 as _e,a6 as ve,a7 as Ce,a8 as lt,a9 as ll,aa as Ae,ab as we,ac as Ml,ad as rt,ae as Oe,af as $l,ag as Ul,ah as Fl,ai as Rl,aj as dt,ak as at,al as Ll,am as It,an as hl,ao as El,ap as Tl,aq as At,ar as Ol,as as Nl,at as Bl,au as jl,av as ql,aw as Yl,ax as Hl,ay as zl,az as Ql,aA as Wl,aB as Mt,aC as $t,aD as bt,aE as al,aF as Jl,aG as Gl,aH as gt,aI as Kl,aJ as Xl,aK as Ee,aL as Zl,aM as Ze,aN as ea,aO as ta,aP as la,aQ as aa,aR as na,aS as ua,aT as Ut,aU as ia,aV as sa,aW as oa,aX as ra,aY as Ft,aZ as Rt,a_ as da,a$ as ma,b0 as pt,b1 as ca,b2 as Lt,b3 as va,b4 as pa,b5 as ht,b6 as fa,b7 as ya,b8 as ba}from"./VSnackbar-CoLoRMBr.js";import{u as nt,c as ga,a as Va}from"./vue-router-CsmvXs2P.js";import{c as x,V as ka,a as mt,m as nl,b as Vt,_ as ut,d as _a,i as Et,e as Ca,f as ul,g as Pa,h as it,j as xa,k as wa,l as Da,n as Sa,o as il,p as Ia,q as Aa}from"./InscriptionRow.vue_vue_type_script_setup_true_lang-D9gxDQUh.js";import{V as z,a as oe,b as pe,c as se,d as qe,e as Se,f as ee,g as ke,h as Pe,i as Te,j as ct,k as Tt,l as sl,m as ol,n as rl}from"./VTextarea-p7qetQbe.js";import{_ as We,a as Ma,V as $a,b as Ua,c as Fa,d as Ot,e as Nt}from"./VTabs-B4Uxzzl_.js";import{_ as Je,V as Ra,a as La}from"./EventSwitch.vue_vue_type_script_setup_true_lang-DH3PwB7m.js";import{_ as Pt}from"./_plugin-vue_export-helper-DlAUqK2U.js";import{V as He}from"./FileCard.vue_vue_type_script_setup_true_lang-DaCyq3eR.js";import{V as Bt,_ as ha,a as Ea,b as Ta}from"./SexeField.vue_vue_type_script_setup_true_lang-DjdHkZ9A.js";import{_ as Oa}from"./FilesRow.vue_vue_type_script_setup_true_lang-Bln44dTy.js";import{V as Na}from"./VForm-DfUsynlk.js";import"./VSheet-3mzqFlWj.js";import"./VWindowItem-BYb5fLCT.js";const ft=G({__name:"NavBar",props:{title:{},hideMenu:{type:Boolean}},setup(l){const s="/static/repere/logo.png",o="v0.6.3",v=l,a=F(()=>x.isFondsSoutien);return(i,c)=>(g(),Q(le,null,[e(ka,{app:"","model-value":!v.hideMenu,"expand-on-hover":"",permanent:"",rail:""},{append:t(()=>[e(z,{"prepend-icon":"mdi-account-circle-outline",title:a.value?"Fonds de soutien":"Administrateur"},null,8,["title"]),e(z,{"prepend-icon":"mdi-logout",link:"",to:{path:"/"},color:"primary"},{default:t(()=>[...c[3]||(c[3]=[y(" Se déconnecter ",-1)])]),_:1})]),default:t(()=>[e(z,{"prepend-icon":"mdi-menu",title:`Registro ${o}`},null,8,["title"]),e(oe),e(z,{"prepend-icon":"mdi-bed",link:"",to:{path:"/camps"},color:"primary"},{default:t(()=>[...c[0]||(c[0]=[y(" Séjours ",-1)])]),_:1}),e(z,{"prepend-icon":"mdi-calendar-multiple-check",link:"",to:{path:"/inscriptions"},color:"primary"},{default:t(()=>[...c[1]||(c[1]=[y(" Inscriptions ",-1)])]),_:1}),e(oe),e(z,{"prepend-icon":"mdi-account-multiple",link:"",to:{path:"/annuaire"},color:"primary"},{default:t(()=>[...c[2]||(c[2]=[y(" Annuaire ",-1)])]),_:1}),e(oe)]),_:1},8,["model-value"]),e(Vl,{rounded:"",elevation:"4",color:"secondary"},{append:t(()=>[Cl(i.$slots,"default"),c[4]||(c[4]=T("div",{class:"mr-2"},null,-1))]),default:t(()=>[e(kl,null,{default:t(()=>[e(h,null,{default:t(()=>[e(V,{"align-self":"center",cols:"auto"},{default:t(()=>[e(_l,{width:"60",src:s})]),_:1}),e(V,{"align-self":"center"},{default:t(()=>[y($(v.title),1)]),_:1})]),_:1})]),_:1})]),_:3})],64))}}),Ba=G({__name:"index",setup(l){const s=nt(),o=D(!1),v=D(""),a=D([]);async function i(){const c=await x.Loggin({password:v.value});c!==void 0&&(c.IsValid?(x.setToken(c.Token,c.IsFondSoutien),x.showMessage("Bienvenue !"),s.push({path:"/inscriptions"})):a.value=["Clé de connection incorrecte."])}return(c,n)=>(g(),Q(le,null,[e(ft,{title:"Connection au backoffice","hide-menu":""}),e(xl,{class:"fill-height"},{default:t(()=>[e(j,{class:"mx-auto",width:"400px"},{default:t(()=>[e(Y,null,{default:t(()=>[e(pe,{label:"Clé de connection",modelValue:v.value,"onUpdate:modelValue":n[1]||(n[1]=d=>v.value=d),"error-messages":a.value,type:o.value?void 0:"password",name:"password",onKeydown:n[2]||(n[2]=Pl(et(()=>v.value.length==0?null:i(),["prevent"]),["enter"]))},{"append-inner":t(()=>[e(L,{class:"ml-2",size:"small",icon:o.value?"mdi-eye":"mdi-eye-off",flat:"",onClick:n[0]||(n[0]=d=>o.value=!o.value)},null,8,["icon"])]),_:1},8,["modelValue","error-messages","type"])]),_:1}),e(re,null,{default:t(()=>[e(se),e(L,{disabled:!v.value.length,onClick:i},{default:t(()=>[...n[3]||(n[3]=[y("Se connecter",-1)])]),_:1},8,["disabled"])]),_:1})]),_:1})]),_:1})],64))}}),xt=G({__name:"BoolField",props:De({label:{},hideDetails:{type:Boolean},readonly:{type:Boolean},density:{},persistentHint:{type:Boolean},hint:{}},{modelValue:{type:Boolean,required:!0},modelModifiers:{}}),emits:["update:modelValue"],setup(l){const s=l,o=xe(l,"modelValue");return(v,a)=>(g(),w(qe,{label:s.label,"model-value":o.value,"onUpdate:modelValue":a[0]||(a[0]=i=>o.value=i||!1),"hide-details":s.hideDetails,readonly:s.readonly,density:s.density,"persistent-hint":s.persistentHint,hint:s.hint},null,8,["label","model-value","hide-details","readonly","density","persistent-hint","hint"]))}}),dl=Ue({active:{type:[String,Array],default:void 0},controlHeight:[Number,String],disabled:{type:[Boolean,String,Array],default:null},nextIcon:{type:Ne,default:"$next"},prevIcon:{type:Ne,default:"$prev"},modeIcon:{type:Ne,default:"$subgroup"},text:String,viewMode:{type:String,default:"month"}},"VDatePickerControls"),jt=Re()({name:"VDatePickerControls",props:dl(),emits:{"click:year":()=>!0,"click:month":()=>!0,"click:prev":()=>!0,"click:next":()=>!0,"click:text":()=>!0},setup(l,s){let{emit:o}=s;const{t:v}=ze(),a=F(()=>Array.isArray(l.disabled)?l.disabled.includes("text"):!!l.disabled),i=F(()=>Array.isArray(l.disabled)?l.disabled.includes("mode"):!!l.disabled),c=F(()=>Array.isArray(l.disabled)?l.disabled.includes("prev"):!!l.disabled),n=F(()=>Array.isArray(l.disabled)?l.disabled.includes("next"):!!l.disabled);function d(){o("click:prev")}function u(){o("click:next")}function r(){o("click:year")}function m(){o("click:month")}return Le(()=>T("div",{class:Ve(["v-date-picker-controls"]),style:{"--v-date-picker-controls-height":Ct(l.controlHeight)}},[e(L,{class:"v-date-picker-controls__month-btn","data-testid":"month-btn",disabled:a.value,text:l.text,variant:"text",rounded:!0,onClick:m},null),e(L,{class:"v-date-picker-controls__mode-btn","data-testid":"year-btn",disabled:i.value,density:"comfortable",icon:l.modeIcon,variant:"text","aria-label":v("$vuetify.datePicker.ariaLabel.selectYear"),onClick:r},null),e(se,null,null),T("div",{class:"v-date-picker-controls__month"},[e(L,{"data-testid":"prev-month",disabled:c.value,density:"comfortable",icon:l.prevIcon,variant:"text","aria-label":v("$vuetify.datePicker.ariaLabel.previousMonth"),onClick:d},null),e(L,{"data-testid":"next-month",disabled:n.value,icon:l.nextIcon,density:"comfortable",variant:"text","aria-label":v("$vuetify.datePicker.ariaLabel.nextMonth"),onClick:u},null)])])),{}}}),ja=Ue({appendIcon:Ne,color:String,header:String,transition:String,onClick:wl()},"VDatePickerHeader"),qt=Re()({name:"VDatePickerHeader",props:ja(),emits:{click:()=>!0,"click:append":()=>!0},setup(l,s){let{emit:o,slots:v}=s;const{backgroundColorClasses:a,backgroundColorStyles:i}=Gt(()=>l.color);function c(){o("click")}function n(){o("click:append")}return Le(()=>{const d=!!(v.default||l.header),u=!!(v.append||l.appendIcon);return T("div",{class:Ve(["v-date-picker-header",{"v-date-picker-header--clickable":!!l.onClick},a.value]),style:tt(i.value),onClick:c},[v.prepend&&T("div",{key:"prepend",class:"v-date-picker-header__prepend"},[v.prepend()]),d&&e(Kt,{key:"content",name:l.transition},{default:()=>[T("div",{key:l.header,class:"v-date-picker-header__content"},[v.default?.()??l.header])]}),u&&T("div",{class:"v-date-picker-header__append"},[v.append?e(Xt,{key:"append-defaults",disabled:!l.appendIcon,defaults:{VBtn:{icon:l.appendIcon,variant:"text"}}},{default:()=>[v.append?.()]}):e(L,{key:"append-btn",icon:l.appendIcon,variant:"text",onClick:n},null)])])}),{}}}),qa=Ue({allowedDates:[Array,Function],disabled:{type:Boolean,default:null},displayValue:null,modelValue:Array,month:[Number,String],max:null,min:null,showAdjacentMonths:Boolean,year:[Number,String],weekdays:{type:Array,default:()=>[0,1,2,3,4,5,6]},weeksInMonth:{type:String,default:"dynamic"},firstDayOfWeek:{type:[Number,String],default:void 0},firstDayOfYear:{type:[Number,String],default:void 0},weekdayFormat:String},"calendar");function Ya(l){const s=Qe(),o=$e(l,"modelValue",[],k=>ot(k).map(C=>s.date(C))),v=F(()=>l.displayValue?s.date(l.displayValue):o.value.length>0?s.date(o.value[0]):l.min?s.date(l.min):Array.isArray(l.allowedDates)?s.date(l.allowedDates[0]):s.date()),a=$e(l,"year",void 0,k=>{const C=k!=null?Number(k):s.getYear(v.value);return s.startOfYear(s.setYear(s.date(),C))},k=>s.getYear(k)),i=$e(l,"month",void 0,k=>{const C=k!=null?Number(k):s.getMonth(v.value),_=s.setYear(s.startOfMonth(s.date()),s.getYear(a.value));return s.setMonth(_,C)},k=>s.getMonth(k)),c=F(()=>{const k=s.toJsDate(s.startOfWeek(s.date(),l.firstDayOfWeek)).getDay();return s.getWeekdays(l.firstDayOfWeek,l.weekdayFormat).filter((C,_)=>l.weekdays.includes((_+k)%7))}),n=F(()=>{const k=s.getWeekArray(i.value,l.firstDayOfWeek),C=k.flat(),_=6*7;if(l.weeksInMonth==="static"&&C.length<_){const P=C[C.length-1];let A=[];for(let q=1;q<=_-C.length;q++)A.push(s.addDays(P,q)),q%7===0&&(k.push(A),A=[])}return k});function d(k,C){return k.filter(_=>l.weekdays.includes(s.toJsDate(_).getDay())).map((_,P)=>{const A=s.toISO(_),q=!s.isSameMonth(_,i.value),Z=s.isSameDay(_,s.startOfMonth(i.value)),S=s.isSameDay(_,s.endOfMonth(i.value)),f=s.isSameDay(_,i.value),K=l.weekdays.length;return{date:_,formatted:s.format(_,"keyboardDate"),isAdjacent:q,isDisabled:p(_),isEnd:S,isHidden:q&&!l.showAdjacentMonths,isSame:f,isSelected:o.value.some(be=>s.isSameDay(_,be)),isStart:Z,isToday:s.isSameDay(_,C),isWeekEnd:P%K===K-1,isWeekStart:P%K===0,isoDate:A,localized:s.format(_,"dayOfMonth"),month:s.getMonth(_),year:s.getYear(_)}})}const u=F(()=>{const k=s.startOfWeek(v.value,l.firstDayOfWeek),C=[];for(let P=0;P<=6;P++)C.push(s.addDays(k,P));const _=s.date();return d(C,_)}),r=F(()=>{const k=n.value.flat(),C=s.date();return d(k,C)}),m=F(()=>n.value.map(k=>k.length?s.getWeek(k[0],l.firstDayOfWeek,l.firstDayOfYear):null));function p(k){if(l.disabled)return!0;const C=s.date(k);return l.min&&s.isBefore(s.endOfDay(C),s.date(l.min))||l.max&&s.isAfter(C,s.date(l.max))?!0:Array.isArray(l.allowedDates)&&l.allowedDates.length>0?!l.allowedDates.some(_=>s.isSameDay(s.date(_),C)):typeof l.allowedDates=="function"?!l.allowedDates(C):!1}return{displayValue:v,daysInMonth:r,daysInWeek:u,genDays:d,model:o,weeksInMonth:n,weekdayLabels:c,weekNumbers:m}}const ml=Ue({color:String,hideWeekdays:Boolean,multiple:[Boolean,Number,String],showWeek:Boolean,transition:{type:String,default:"picker-transition"},reverseTransition:{type:String,default:"picker-reverse-transition"},...je(qa(),["displayValue"])},"VDatePickerMonth"),Yt=Re()({name:"VDatePickerMonth",props:ml(),emits:{"update:modelValue":l=>!0,"update:month":l=>!0,"update:year":l=>!0},setup(l,s){let{emit:o,slots:v}=s;const a=D(),{t:i}=ze(),{daysInMonth:c,model:n,weekNumbers:d,weekdayLabels:u}=Ya(l),r=Qe(),m=Xe(),p=Xe(),k=Xe(!1),C=Fe(()=>k.value?l.reverseTransition:l.transition);l.multiple==="range"&&n.value.length>0&&(m.value=n.value[0],n.value.length>1&&(p.value=n.value[n.value.length-1]));const _=F(()=>{const S=["number","string"].includes(typeof l.multiple)?Number(l.multiple):1/0;return n.value.length>=S});Me(c,(S,f)=>{f&&(k.value=r.isBefore(S[0].date,f[0].date))});function P(S){const f=r.startOfDay(S);if(n.value.length===0?m.value=void 0:n.value.length===1&&(m.value=n.value[0],p.value=void 0),!m.value)m.value=f,n.value=[m.value];else if(p.value)m.value=S,p.value=void 0,n.value=[m.value];else{if(r.isSameDay(f,m.value)){m.value=void 0,n.value=[];return}else r.isBefore(f,m.value)?(p.value=r.endOfDay(m.value),m.value=f):p.value=r.endOfDay(f);n.value=Dl(r,m.value,p.value)}}function A(S){const f=r.format(S.date,"fullDateWithWeekday"),K=S.isToday?"currentDate":"selectDate";return i(`$vuetify.datePicker.ariaLabel.${K}`,f)}function q(S){const f=n.value.findIndex(K=>r.isSameDay(K,S));if(f===-1)n.value=[...n.value,S];else{const K=[...n.value];K.splice(f,1),n.value=K}}function Z(S){l.multiple==="range"?P(S):l.multiple?q(S):n.value=[S]}Le(()=>T("div",{class:"v-date-picker-month",style:{"--v-date-picker-days-in-week":l.weekdays.length}},[l.showWeek&&T("div",{key:"weeks",class:"v-date-picker-month__weeks"},[!l.hideWeekdays&&T("div",{key:"hide-week-days",class:"v-date-picker-month__day"},[y(" ")]),d.value.map(S=>T("div",{class:Ve(["v-date-picker-month__day","v-date-picker-month__day--adjacent"])},[S]))]),e(Kt,{name:C.value},{default:()=>[T("div",{ref:a,key:c.value[0].date?.toString(),class:"v-date-picker-month__days"},[!l.hideWeekdays&&u.value.map(S=>T("div",{class:Ve(["v-date-picker-month__day","v-date-picker-month__weekday"])},[S])),c.value.map((S,f)=>{const K={props:{class:"v-date-picker-month__day-btn",color:S.isSelected||S.isToday?l.color:void 0,disabled:S.isDisabled,icon:!0,ripple:!1,text:S.localized,variant:S.isSelected?"flat":S.isToday?"outlined":"text","aria-label":A(S),"aria-current":S.isToday?"date":void 0,onClick:()=>Z(S.date)},item:S,i:f};return _.value&&!S.isSelected&&(S.isDisabled=!0),T("div",{class:Ve(["v-date-picker-month__day",{"v-date-picker-month__day--adjacent":S.isAdjacent,"v-date-picker-month__day--hide-adjacent":S.isHidden,"v-date-picker-month__day--selected":S.isSelected,"v-date-picker-month__day--week-end":S.isWeekEnd,"v-date-picker-month__day--week-start":S.isWeekStart}]),"data-v-date":S.isDisabled?void 0:S.isoDate},[(l.showAdjacentMonths||!S.isAdjacent)&&(v.day?.(K)??e(L,K.props,null))])})])]})]))}}),cl=Ue({color:String,height:[String,Number],min:null,max:null,modelValue:Number,year:Number,allowedMonths:[Array,Function]},"VDatePickerMonths"),Ht=Re()({name:"VDatePickerMonths",props:cl(),emits:{"update:modelValue":l=>!0},setup(l,s){let{emit:o,slots:v}=s;const a=Qe(),i=$e(l,"modelValue"),c=F(()=>{let d=a.startOfYear(a.date());return l.year&&(d=a.setYear(d,l.year)),he(12).map(u=>{const r=a.format(d,"monthShort"),m=a.format(d,"month"),p=!!(!n(u)||l.min&&a.isAfter(a.startOfMonth(a.date(l.min)),d)||l.max&&a.isAfter(d,a.startOfMonth(a.date(l.max))));return d=a.getNextMonth(d),{isDisabled:p,text:r,label:m,value:u}})});Zt(()=>{i.value=i.value??a.getMonth(a.date())});function n(d){return Array.isArray(l.allowedMonths)&&l.allowedMonths.length?l.allowedMonths.includes(d):typeof l.allowedMonths=="function"?l.allowedMonths(d):!0}return Le(()=>T("div",{class:"v-date-picker-months",style:{height:Ct(l.height)}},[T("div",{class:"v-date-picker-months__content"},[c.value.map((d,u)=>{const r={active:i.value===u,ariaLabel:d.label,color:i.value===u?l.color:void 0,disabled:d.isDisabled,rounded:!0,text:d.text,variant:i.value===d.value?"flat":"text",onClick:()=>m(u)};function m(p){if(i.value===p){o("update:modelValue",i.value);return}i.value=p}return v.month?.({month:d,i:u,props:r})??e(L,ie({key:"month"},r),null)})])])),{}}}),vl=Ue({color:String,height:[String,Number],min:null,max:null,modelValue:Number,allowedYears:[Array,Function]},"VDatePickerYears"),zt=Re()({name:"VDatePickerYears",props:vl(),directives:{vIntersect:St},emits:{"update:modelValue":l=>!0},setup(l,s){let{emit:o,slots:v}=s;const a=Qe(),i=$e(l,"modelValue"),c=F(()=>{const r=a.getYear(a.date());let m=r-100,p=r+52;l.min&&(m=a.getYear(a.date(l.min))),l.max&&(p=a.getYear(a.date(l.max)));let k=a.startOfYear(a.date());return k=a.setYear(k,m),he(p-m+1,m).map(C=>{const _=a.format(k,"year");return k=a.setYear(k,a.getYear(k)+1),{text:_,value:C,isDisabled:!u(C)}})});Zt(()=>{i.value=i.value??a.getYear(a.date())});const n=Sl();function d(){n.el?.focus(),n.el?.scrollIntoView({block:"center"})}function u(r){return Array.isArray(l.allowedYears)&&l.allowedYears.length?l.allowedYears.includes(r):typeof l.allowedYears=="function"?l.allowedYears(r):!0}return Le(()=>Il(T("div",{class:"v-date-picker-years",style:{height:Ct(l.height)}},[T("div",{class:"v-date-picker-years__content"},[c.value.map((r,m)=>{const p={ref:i.value===r.value?n:void 0,active:i.value===r.value,color:i.value===r.value?l.color:void 0,rounded:!0,text:r.text,disabled:r.isDisabled,variant:i.value===r.value?"flat":"text",onClick:()=>{if(i.value===r.value){o("update:modelValue",i.value);return}i.value=r.value}};return v.year?.({year:r,i:m,props:p})??e(L,ie({key:"month"},p),null)})])]),[[St,{handler:d},null,{once:!0}]])),{}}}),Ha=Ue({header:{type:String,default:"$vuetify.datePicker.header"},headerColor:String,...dl(),...ml({weeksInMonth:"static"}),...je(cl(),["modelValue"]),...je(vl(),["modelValue"]),...nl({title:"$vuetify.datePicker.title"}),modelValue:null},"VDatePicker"),za=Re()({name:"VDatePicker",props:Ha(),emits:{"update:modelValue":l=>!0,"update:month":l=>!0,"update:year":l=>!0,"update:viewMode":l=>!0},setup(l,s){let{emit:o,slots:v}=s;const a=Qe(),{t:i}=ze(),{rtlClasses:c}=el(),n=$e(l,"modelValue",void 0,M=>ot(M).map(b=>a.date(b)),M=>l.multiple?M:M[0]),d=$e(l,"viewMode"),u=F(()=>{const M=a.date(l.min);return l.min&&a.isValid(M)?M:null}),r=F(()=>{const M=a.date(l.max);return l.max&&a.isValid(M)?M:null}),m=F(()=>{const M=a.date();let b=M;return n.value?.[0]?b=a.date(n.value[0]):u.value&&a.isBefore(M,u.value)?b=u.value:r.value&&a.isAfter(M,r.value)&&(b=r.value),b&&a.isValid(b)?b:M}),p=Fe(()=>l.headerColor??l.color),k=$e(l,"month"),C=F({get:()=>Number(k.value??a.getMonth(a.startOfMonth(m.value))),set:M=>k.value=M}),_=$e(l,"year"),P=F({get:()=>Number(_.value??a.getYear(a.startOfYear(a.setMonth(m.value,C.value)))),set:M=>_.value=M}),A=Xe(!1),q=F(()=>l.multiple&&n.value.length>1?i("$vuetify.datePicker.itemsSelected",n.value.length):n.value[0]&&a.isValid(n.value[0])?a.format(a.date(n.value[0]),"normalDateWithWeekday"):i(l.header)),Z=F(()=>{let M=a.date();return M=a.setDate(M,1),M=a.setMonth(M,C.value),M=a.setYear(M,P.value),a.format(M,"monthAndYear")}),S=Fe(()=>`date-picker-header${A.value?"-reverse":""}-transition`),f=F(()=>{if(l.disabled)return!0;const M=[];if(d.value!=="month")M.push("prev","next");else{let b=a.date();if(b=a.startOfMonth(b),b=a.setMonth(b,C.value),b=a.setYear(b,P.value),u.value){const O=a.addDays(a.startOfMonth(b),-1);a.isAfter(u.value,O)&&M.push("prev")}if(r.value){const O=a.addDays(a.endOfMonth(b),1);a.isAfter(O,r.value)&&M.push("next")}}return M}),K=F(()=>l.allowedYears||I),be=F(()=>l.allowedMonths||te);function J(M,b){const O=l.allowedDates;if(typeof O!="function")return!0;const R=a.getDiff(b,M,"days");for(let ye=0;ye<R;ye++)if(O(a.addDays(M,ye)))return!0;return!1}function I(M){if(typeof l.allowedDates=="function"){const b=a.parseISO(`${M}-01-01`);return J(b,a.endOfYear(b))}if(Array.isArray(l.allowedDates)&&l.allowedDates.length){for(const b of l.allowedDates)if(a.getYear(a.date(b))===M)return!0;return!1}return!0}function te(M){if(typeof l.allowedDates=="function"){const b=String(M+1).padStart(2,"0"),O=a.parseISO(`${P.value}-${b}-01`);return J(O,a.endOfMonth(O))}if(Array.isArray(l.allowedDates)&&l.allowedDates.length){for(const b of l.allowedDates)if(a.getYear(a.date(b))===P.value&&a.getMonth(a.date(b))===M)return!0;return!1}return!0}function ae(){C.value<11?C.value++:(P.value++,C.value=0,ge()),fe()}function N(){C.value>0?C.value--:(P.value--,C.value=11,ge()),fe()}function B(){d.value="month"}function ue(){d.value=d.value==="months"?"month":"months"}function X(){d.value=d.value==="year"?"month":"year"}function fe(){d.value==="months"&&ue()}function ge(){d.value==="year"&&X()}return Me(n,(M,b)=>{const O=ot(b),R=ot(M);if(!R.length)return;const ye=a.date(O[O.length-1]),ne=a.date(R[R.length-1]),Ie=a.getMonth(ne),E=a.getYear(ne);Ie!==C.value&&(C.value=Ie,fe()),E!==P.value&&(P.value=E,ge()),A.value=a.isBefore(ye,ne)}),Le(()=>{const M=mt.filterProps(l),b=jt.filterProps(l),O=qt.filterProps(l),R=Yt.filterProps(l),ye=je(Ht.filterProps(l),["modelValue"]),ne=je(zt.filterProps(l),["modelValue"]),Ie={color:p.value,header:q.value,transition:S.value};return e(mt,ie(M,{color:p.value,class:["v-date-picker",`v-date-picker--${d.value}`,{"v-date-picker--show-week":l.showWeek},c.value,l.class],style:l.style}),{title:()=>v.title?.()??T("div",{class:"v-date-picker__title"},[i(l.title)]),header:()=>v.header?e(Xt,{defaults:{VDatePickerHeader:{...Ie}}},{default:()=>[v.header?.(Ie)]}):e(qt,ie({key:"header"},O,Ie,{onClick:d.value!=="month"?B:void 0}),{prepend:v.prepend,append:v.append}),default:()=>T(le,null,[e(jt,ie(b,{disabled:f.value,text:Z.value,"onClick:next":ae,"onClick:prev":N,"onClick:month":ue,"onClick:year":X}),null),e(Al,{hideOnLeave:!0},{default:()=>[d.value==="months"?e(Ht,ie({key:"date-picker-months"},ye,{modelValue:C.value,"onUpdate:modelValue":[E=>C.value=E,fe],min:u.value,max:r.value,year:P.value,allowedMonths:be.value}),{month:v.month}):d.value==="year"?e(zt,ie({key:"date-picker-years"},ne,{modelValue:P.value,"onUpdate:modelValue":[E=>P.value=E,ge],min:u.value,max:r.value,allowedYears:K.value}),{year:v.year}):e(Yt,ie({key:"date-picker-month"},R,{modelValue:n.value,"onUpdate:modelValue":E=>n.value=E,month:C.value,"onUpdate:month":[E=>C.value=E,fe],year:P.value,"onUpdate:year":[E=>P.value=E,ge],min:u.value,max:r.value}),{day:v.day})]})]),actions:v.actions})}),{}}}),Qa=G({__name:"DateField",props:De({label:{},hideDetails:{type:Boolean},readonly:{type:Boolean}},{modelValue:{required:!0},modelModifiers:{}}),emits:["update:modelValue"],setup(l){const s=l,o=xe(l,"modelValue"),v=Qe();function a(c){i.value=!1,o.value=tl(c)}const i=D(!1);return(c,n)=>s.readonly?(g(),w(pe,{key:0,class:"center-text",variant:"outlined",density:"compact","hide-details":s.hideDetails,label:s.label,"model-value":U(v).parseISO(o.value).toLocaleDateString(),readonly:""},null,8,["hide-details","label","model-value"])):(g(),w(Se,{key:1,"close-on-content-click":!1,modelValue:i.value,"onUpdate:modelValue":n[1]||(n[1]=d=>i.value=d)},{activator:t(({props:d})=>[e(pe,ie({class:"center-text"},d,{variant:"outlined",density:"compact","hide-details":s.hideDetails,label:s.label,"model-value":U(v).parseISO(o.value).toLocaleDateString()}),null,16,["hide-details","label","model-value"])]),default:t(()=>[e(za,{"model-value":U(v).parseISO(o.value),"onUpdate:modelValue":n[0]||(n[0]=d=>a(d))},null,8,["model-value"])]),_:1},8,["modelValue"]))}}),pl=Pt(Qa,[["__scopeId","data-v-1e184428"]]),Wa=G({__name:"OptionStatut",props:De({camp:{}},{modelValue:{required:!0},modelModifiers:{}}),emits:["update:modelValue"],setup(l){const s=l,o=xe(l,"modelValue");function v(){const c=o.value?.length?o.value.map(u=>u.Id):[0],d={Id:Math.max(...c)+1,Label:"",Description:"",Prix:s.camp.Prix.Cent};o.value=(o.value||[]).concat(d),a.value=d}const a=D(null);function i(c){o.value=(o.value||[]).filter(n=>n.Id!=c.Id)}return(c,n)=>{const d=Je;return g(),w(j,{subtitle:"Le prix dépend du statut du participant, à choisir parmi la liste ci-dessous."},{append:t(()=>[e(L,{icon:"",size:"x-small",onClick:v},{default:t(()=>[e(ve,{color:"green"},{default:t(()=>[...n[4]||(n[4]=[y("mdi-plus",-1)])]),_:1})]),_:1})]),default:t(()=>[a.value!=null?(g(),w(ee,{key:0,"model-value":a.value!=null,"onUpdate:modelValue":n[3]||(n[3]=u=>a.value=null),"max-width":"500px"},{default:t(()=>[e(j,{title:"Modifier le statut"},{default:t(()=>[e(Y,null,{default:t(()=>[e(h,null,{default:t(()=>[e(V,{cols:"12"},{default:t(()=>[e(pe,{autofocus:"",label:"Statut",modelValue:a.value.Label,"onUpdate:modelValue":n[0]||(n[0]=u=>a.value.Label=u),density:"compact",variant:"outlined","hide-details":""},null,8,["modelValue"])]),_:1}),e(V,{cols:"12"},{default:t(()=>[e(pe,{label:"Description",modelValue:a.value.Description,"onUpdate:modelValue":n[1]||(n[1]=u=>a.value.Description=u),density:"compact",variant:"outlined","hide-details":""},null,8,["modelValue"])]),_:1}),e(V,{cols:"12"},{default:t(()=>[e(d,{"model-value":{Cent:a.value.Prix,Currency:s.camp.Prix.Currency},"onUpdate:modelValue":n[2]||(n[2]=u=>a.value.Prix=u.Cent),label:"Prix","readonly-currency":""},null,8,["model-value"])]),_:1})]),_:1})]),_:1})]),_:1})]),_:1},8,["model-value"])):W("",!0),e(Y,{class:"py-0"},{default:t(()=>[e(ke,null,{default:t(()=>[o.value?.length?W("",!0):(g(),w(z,{key:0},{default:t(()=>[...n[5]||(n[5]=[T("i",null,"Aucun statut n'est encore défini.",-1)])]),_:1})),(g(!0),Q(le,null,ce(o.value,u=>(g(),w(z,{title:u.Label,subtitle:u.Description,onClick:r=>a.value=u},{append:t(()=>[e(h,null,{default:t(()=>[e(V,{"align-self":"center"},{default:t(()=>[e(Pe,null,{default:t(()=>[y($(U(_e).montant({Cent:u.Prix,Currency:l.camp.Prix.Currency})),1)]),_:2},1024)]),_:2},1024),e(V,{"align-self":"center",cols:"auto"},{default:t(()=>[e(L,{icon:"",size:"x-small",class:"my-1",onClick:et(r=>i(u),["stop"])},{default:t(()=>[e(ve,{color:"red"},{default:t(()=>[...n[6]||(n[6]=[y("mdi-delete",-1)])]),_:1})]),_:1},8,["onClick"])]),_:2},1024)]),_:2},1024)]),_:2},1032,["title","subtitle","onClick"]))),256))]),_:1})]),_:1})]),_:1})}}}),Ja=G({__name:"OptionJournee",props:De({camp:{}},{modelValue:{required:!0},modelModifiers:{}}),emits:["update:modelValue"],setup(l){const s=l,o=xe(l,"modelValue");Me(()=>o.value,v,{immediate:!0});function v(){const i=s.camp.Duree;o.value?.length!=i&&(o.value=Array.from({length:i}).map(c=>0))}function a(){const i=o.value,c=i[0];for(let n=0;n<i.length;n++)i[n]=c}return(i,c)=>{const n=Je;return g(),w(j,{subtitle:"Le prix est variable en fonction des jours de participation au camp."},{append:t(()=>[e(He,{text:"Appliquer le prix du premier jour à tous."},{activator:t(({props:d})=>[e(L,ie(d,{icon:"mdi-arrow-expand",size:"x-small",disabled:!(o.value||[])[0],onClick:a}),null,16,["disabled"])]),_:1})]),default:t(()=>[e(Y,null,{default:t(()=>[e(h,null,{default:t(()=>[(g(!0),Q(le,null,ce(o.value,(d,u)=>(g(),w(V,{cols:"3"},{default:t(()=>[e(n,{label:`Jour ${u+1}`,"model-value":{Cent:d,Currency:s.camp.Prix.Currency},"onUpdate:modelValue":r=>o.value[u]=r.Cent,"readonly-currency":""},null,8,["label","model-value","onUpdate:modelValue"])]),_:2},1024))),256))]),_:1})]),_:1})]),_:1})}}}),Ga={key:0,class:"text-center"},Ka=G({__name:"CampOptionsPrix",props:De({camp:{}},{optionPrix:{required:!0},optionPrixModifiers:{},optionQf:{required:!0},optionQfModifiers:{}}),emits:["update:optionPrix","update:optionQf"],setup(l){const s=l,o=xe(l,"optionPrix"),v=xe(l,"optionQf"),a=F(()=>Ce.isQuotientFamilialActive(v.value)),i=lt(ll);return(c,n)=>{const d=We;return g(),w(j,{title:"Options sur le prix",subtitle:"Permet de modifier le prix de base du séjour",width:"1000px"},{default:t(()=>[e(Y,null,{default:t(()=>[e(h,null,{default:t(()=>[e(V,{"align-self":"center"},{default:t(()=>[e(qe,{"model-value":a.value,"onUpdate:modelValue":n[0]||(n[0]=u=>v.value[3]=u?100:0),"hide-details":"",label:"Prix au quotient familial"},null,8,["model-value"])]),_:1}),e(V,{"align-self":"center"},{default:t(()=>[e(d,{suffix:"%",min:0,max:100,disabled:!a.value,"hide-details":"","readonly-currency":"",label:"entre 1 et 359",modelValue:v.value[0],"onUpdate:modelValue":n[1]||(n[1]=u=>v.value[0]=u)},null,8,["disabled","modelValue"])]),_:1}),e(V,{"align-self":"center"},{default:t(()=>[e(d,{suffix:"%",min:0,max:100,disabled:!a.value,"hide-details":"","readonly-currency":"",label:"entre 360 et 564",modelValue:v.value[1],"onUpdate:modelValue":n[2]||(n[2]=u=>v.value[1]=u)},null,8,["disabled","modelValue"])]),_:1}),e(V,{"align-self":"center"},{default:t(()=>[e(d,{suffix:"%",min:0,max:100,disabled:!a.value,"hide-details":"","readonly-currency":"",label:"entre 565 et 714",modelValue:v.value[2],"onUpdate:modelValue":n[3]||(n[3]=u=>v.value[2]=u)},null,8,["disabled","modelValue"])]),_:1}),e(V,{"align-self":"center"},{default:t(()=>[e(d,{suffix:"%",min:0,max:100,disabled:!0,"hide-details":"","readonly-currency":"",label:"plus de 715",modelValue:v.value[3],"onUpdate:modelValue":n[4]||(n[4]=u=>v.value[3]=u)},null,8,["modelValue"])]),_:1})]),_:1}),e(oe,{thickness:"1",class:"my-2"}),e(h,{class:"my-2"},{default:t(()=>[e(V,{"align-self":"center",cols:"4"},{default:t(()=>[e(Te,{variant:"outlined",density:"comfortable","hide-details":"",items:U(i),label:"Option sur le prix",modelValue:o.value.Active,"onUpdate:modelValue":n[5]||(n[5]=u=>o.value.Active=u)},null,8,["items","modelValue"])]),_:1}),e(V,{"align-self":"center"},{default:t(()=>[o.value.Active==U(Ae).NoOption?(g(),Q("div",Ga,[...n[8]||(n[8]=[T("i",null,"Aucune modification sur le prix de base.",-1)])])):o.value.Active==U(Ae).PrixStatut?(g(),w(Wa,{key:1,camp:s.camp,modelValue:o.value.Statuts,"onUpdate:modelValue":n[6]||(n[6]=u=>o.value.Statuts=u)},null,8,["camp","modelValue"])):o.value.Active==U(Ae).PrixJour?(g(),w(Ja,{key:2,camp:s.camp,modelValue:o.value.Jours,"onUpdate:modelValue":n[7]||(n[7]=u=>o.value.Jours=u)},null,8,["camp","modelValue"])):W("",!0)]),_:1})]),_:1})]),_:1})]),_:1})}}}),Xa=G({__name:"CampMetaEdit",props:De({metaEntriesHints:{}},{modelValue:{required:!0},modelModifiers:{}}),emits:["update:modelValue"],setup(l){const s=l,o=xe(l,"modelValue"),v=D(Object.entries(o.value||{}));function a(){const i=Object.fromEntries(v.value);o.value=i}return F(()=>{const i=v.value.map(n=>n[0]);return i.includes("")?!0:new Set(i).size!=v.value.length}),(i,c)=>(g(),w(j,{subtitle:"Métadonnées exposées sur l'API publique"},{append:t(()=>[e(L,{size:"small",class:"ml-2",onClick:c[0]||(c[0]=n=>{v.value.push(["",""]),a()})},{prepend:t(()=>[e(ve,{color:"green"},{default:t(()=>[...c[1]||(c[1]=[y("mdi-plus",-1)])]),_:1})]),default:t(()=>[c[2]||(c[2]=y(" Ajouter une valeur",-1))]),_:1})]),default:t(()=>[e(Y,{class:"pt-2"},{default:t(()=>[(g(!0),Q(le,null,ce(v.value,(n,d)=>(g(),w(h,null,{default:t(()=>[e(V,{cols:"4"},{default:t(()=>[e(Bt,{variant:"outlined",density:"compact","hide-details":"",label:"Clé",modelValue:n[0],"onUpdate:modelValue":[u=>n[0]=u,a],autofocus:"",items:s.metaEntriesHints.keys},null,8,["modelValue","onUpdate:modelValue","items"])]),_:2},1024),e(V,null,{default:t(()=>[e(Bt,{variant:"outlined",density:"compact","hide-details":"",label:"Valeur",modelValue:n[1],"onUpdate:modelValue":[u=>n[1]=u,a],items:s.metaEntriesHints.values},null,8,["modelValue","onUpdate:modelValue","items"])]),_:2},1024),e(V,{cols:"auto"},{default:t(()=>[e(L,{icon:"",size:"small",flat:"",onClick:u=>{v.value.splice(d,1),a()}},{default:t(()=>[e(ve,{color:"red"},{default:t(()=>[...c[3]||(c[3]=[y("mdi-close",-1)])]),_:1})]),_:1},8,["onClick"])]),_:2},1024)]),_:2},1024))),256))]),_:1})]),_:1}))}}),Za=G({__name:"CampEdit",props:{camp:{},preselectionUrl:{},metaEntriesHints:{}},emits:["save"],setup(l,{emit:s}){const o=l,v=s,a=D(we(o.camp)),i=F(()=>new Date(a.value.DateDebut).getFullYear()>=2020&&a.value.Places>=1&&a.value.Nom!=""&&a.value.AgeMax>=a.value.AgeMin&&a.value.OptionQuotientFamilial.every(u=>0<=u&&u<=100)&&!(a.value.OptionPrix.Active==Ae.PrixStatut&&!a.value.OptionPrix.Statuts?.length)&&!(a.value.OptionPrix.Active==Ae.PrixJour&&a.value.OptionPrix.Jours?.length!=a.value.Duree)),c=lt(Ml);function n(u){const r=Ce.isQuotientFamilialActive(u.OptionQuotientFamilial),m=u.OptionPrix.Active!=Ae.NoOption;if(!r&&!m)return"Aucune";const p=[];return Ce.isQuotientFamilialActive(u.OptionQuotientFamilial)&&p.push("Quotient familial"),u.OptionPrix.Active!=Ae.NoOption&&p.push(ll[u.OptionPrix.Active]),p.join(", ")}async function d(){await rt(o.preselectionUrl),x.showMessage("URL copiée dans le presse-papier.")}return(u,r)=>{const m=pl,p=We,k=Je,C=xt;return g(),w(j,{title:"Paramètres du séjour",subtitle:U(Ce).label(o.camp)},{default:t(()=>[e(Y,null,{default:t(()=>[e(j,{class:"my-2",subtitle:"Général"},{default:t(()=>[e(Y,null,{default:t(()=>[e(h,null,{default:t(()=>[e(V,null,{default:t(()=>[e(pe,{autofocus:"","hide-details":"",label:"Nom",density:"compact",variant:"outlined",modelValue:a.value.Nom,"onUpdate:modelValue":r[0]||(r[0]=_=>a.value.Nom=_)},null,8,["modelValue"])]),_:1}),e(V,null,{default:t(()=>[e(pe,{"hide-details":"",label:"Lieu",density:"compact",variant:"outlined",modelValue:a.value.Lieu,"onUpdate:modelValue":r[1]||(r[1]=_=>a.value.Lieu=_)},null,8,["modelValue"])]),_:1}),e(V,null,{default:t(()=>[e(pe,{"hide-details":"",label:"Numéro d'agrément",density:"compact",variant:"outlined",modelValue:a.value.Agrement,"onUpdate:modelValue":r[2]||(r[2]=_=>a.value.Agrement=_)},null,8,["modelValue"])]),_:1})]),_:1}),e(h,null,{default:t(()=>[e(V,{"align-self":"center"},{default:t(()=>[e(m,{modelValue:a.value.DateDebut,"onUpdate:modelValue":r[3]||(r[3]=_=>a.value.DateDebut=_),label:"Date de début","hide-details":""},null,8,["modelValue"])]),_:1}),e(V,{"align-self":"center"},{default:t(()=>[e(p,{label:"Durée (en jours)",modelValue:a.value.Duree,"onUpdate:modelValue":r[4]||(r[4]=_=>a.value.Duree=_),"hide-details":""},null,8,["modelValue"])]),_:1}),e(V,{"align-self":"center"},{default:t(()=>[e(m,{"model-value":U(Ce).dateFin(a.value),label:"Date de fin",readonly:"","hide-details":""},null,8,["model-value"])]),_:1})]),_:1})]),_:1})]),_:1}),e(j,{class:"my-2",subtitle:"Prix"},{default:t(()=>[e(Y,null,{default:t(()=>[e(h,null,{default:t(()=>[e(V,{"align-self":"center",cols:"6"},{default:t(()=>[e(k,{label:"Prix",modelValue:a.value.Prix,"onUpdate:modelValue":r[5]||(r[5]=_=>a.value.Prix=_),"hide-details":""},null,8,["modelValue"])]),_:1}),e(V,{"align-self":"center",cols:"6",class:"text-center"},{default:t(()=>[e(Se,{"close-on-content-click":!1},{activator:t(({props:_})=>[e(pe,ie(_,{readonly:"",label:"Option sur le prix",variant:"outlined",density:"compact","hide-details":"","model-value":n(a.value)}),null,16,["model-value"])]),default:t(()=>[e(Ka,{camp:a.value,"option-prix":a.value.OptionPrix,"onUpdate:optionPrix":r[6]||(r[6]=_=>a.value.OptionPrix=_),"option-qf":a.value.OptionQuotientFamilial,"onUpdate:optionQf":r[7]||(r[7]=_=>a.value.OptionQuotientFamilial=_)},null,8,["camp","option-prix","option-qf"])]),_:1})]),_:1})]),_:1})]),_:1})]),_:1}),e(j,{class:"my-2",subtitle:"Visibilité et inscriptions"},{default:t(()=>[e(Y,null,{default:t(()=>[e(h,null,{default:t(()=>[e(V,{"align-self":"center"},{default:t(()=>[e(Te,{label:"Ouverture aux inscriptions",variant:"outlined",density:"compact",items:U(c),"hide-details":"",modelValue:a.value.Statut,"onUpdate:modelValue":r[8]||(r[8]=_=>a.value.Statut=_)},null,8,["items","modelValue"])]),_:1}),e(V,{"align-self":"center"},{default:t(()=>[e(Vt,{label:"Camp sans inscription",modelValue:a.value.WithoutInscription,"onUpdate:modelValue":r[9]||(r[9]=_=>a.value.WithoutInscription=_),color:"primary",density:"compact","persistent-hint":"",hint:a.value.WithoutInscription?"Camp externe, uniquement visible sur l'API publique.":""},null,8,["modelValue","hint"])]),_:1})]),_:1})]),_:1})]),_:1}),e(j,{class:"my-2",subtitle:"Filtres sur les inscrits"},{default:t(()=>[e(Y,null,{default:t(()=>[e(h,null,{default:t(()=>[e(V,{"align-self":"center"},{default:t(()=>[e(p,{modelValue:a.value.Places,"onUpdate:modelValue":r[10]||(r[10]=_=>a.value.Places=_),label:"Nombre de places"},null,8,["modelValue"])]),_:1}),e(V,{"align-self":"center"},{default:t(()=>[e(p,{modelValue:a.value.AgeMin,"onUpdate:modelValue":r[11]||(r[11]=_=>a.value.AgeMin=_),label:"Âge minimum"},null,8,["modelValue"])]),_:1}),e(V,{"align-self":"center"},{default:t(()=>[e(p,{modelValue:a.value.AgeMax,"onUpdate:modelValue":r[12]||(r[12]=_=>a.value.AgeMax=_),label:"Âge maximum"},null,8,["modelValue"])]),_:1})]),_:1}),e(h,null,{default:t(()=>[e(V,null,{default:t(()=>[e(C,{modelValue:a.value.NeedEquilibreGF,"onUpdate:modelValue":r[13]||(r[13]=_=>a.value.NeedEquilibreGF=_),label:"Equilibre G/F demandé",density:"compact","persistent-hint":"",hint:"Place un inscrit en liste d'attente en cas de déséquilibre Garçons/Filles"},null,8,["modelValue"])]),_:1})]),_:1})]),_:1})]),_:1}),e(j,{class:"my-2",subtitle:"Formulaire d'inscription"},{default:t(()=>[e(Y,null,{default:t(()=>[e(h,null,{default:t(()=>[e(V,null,{default:t(()=>[e(pe,{label:"Image",density:"compact",variant:"outlined",hint:"URL d'une image affichée sur le formulaire d'inscription","persistent-hint":"",modelValue:a.value.ImageURL,"onUpdate:modelValue":r[14]||(r[14]=_=>a.value.ImageURL=_)},null,8,["modelValue"])]),_:1})]),_:1}),e(h,null,{default:t(()=>[e(V,null,{default:t(()=>[e(ct,{variant:"outlined",density:"compact",label:"Description",hint:"Ce texte est affiché sur le formulaire d'inscription.","persistent-hint":"",rows:"3",modelValue:a.value.Description,"onUpdate:modelValue":r[15]||(r[15]=_=>a.value.Description=_)},null,8,["modelValue"])]),_:1}),e(V,{cols:"2"},{default:t(()=>[e(C,{label:"Navette",modelValue:a.value.Navette.Actif,"onUpdate:modelValue":r[16]||(r[16]=_=>a.value.Navette.Actif=_)},null,8,["modelValue"])]),_:1}),e(V,null,{default:t(()=>[e(ct,{variant:"outlined",density:"compact",label:"Navette",hint:"Ce texte est affiché sur l'espace personnel de suivi.","persistent-hint":"",rows:"3",disabled:!a.value.Navette.Actif,modelValue:a.value.Navette.Commentaire,"onUpdate:modelValue":r[17]||(r[17]=_=>a.value.Navette.Commentaire=_)},null,8,["disabled","modelValue"])]),_:1})]),_:1}),e(h,null,{default:t(()=>[e(V,null,{default:t(()=>[e(pe,{density:"compact",variant:"outlined",label:"URL de préselection",hint:"Cette URL permet de sélectionner automatiquement le séjour sur le formulaire d'inscription.","persistent-hint":"",readonly:"","model-value":o.preselectionUrl},{append:t(()=>[e(L,{icon:"mdi-content-copy",size:"small",onClick:d})]),_:1},8,["model-value"])]),_:1})]),_:1})]),_:1})]),_:1}),e(j,{class:"my-2",subtitle:"Autre"},{default:t(()=>[e(Y,null,{default:t(()=>[e(h,null,{default:t(()=>[e(V,null,{default:t(()=>[e(pe,{label:"Mot de passe",density:"compact",variant:"outlined",hint:"Mot de passe d'accès à la page Directeur","persistent-hint":"",modelValue:a.value.Password,"onUpdate:modelValue":r[18]||(r[18]=_=>a.value.Password=_)},null,8,["modelValue"])]),_:1})]),_:1})]),_:1})]),_:1}),e(Xa,{"meta-entries-hints":l.metaEntriesHints,modelValue:a.value.Meta,"onUpdate:modelValue":r[19]||(r[19]=_=>a.value.Meta=_)},null,8,["meta-entries-hints","modelValue"])]),_:1}),e(re,null,{default:t(()=>[e(se),e(L,{disabled:!i.value,onClick:r[20]||(r[20]=_=>v("save",a.value))},{default:t(()=>[...r[21]||(r[21]=[y("Enregistrer",-1)])]),_:1},8,["disabled"])]),_:1})]),_:1},8,["subtitle"])}}}),Qt=G({__name:"TauxSelect",props:{modelValue:{required:!0},modelModifiers:{}},emits:["update:modelValue"],setup(l){Oe(i);const s=xe(l,"modelValue"),o=D(null),v=F(()=>{const u=Array.from(a.value.values()).map(r=>({title:r.Label,value:r.Id}));return u.sort((r,m)=>r.title.localeCompare(m.title)),u}),a=D(new Map);async function i(){const u=await x.CampsGetTaux();u!==void 0&&(a.value=$l(u),s.value.Id>0&&(s.value=we(a.value.get(s.value.Id)),o.value=s.value.Id))}function c(){s.value.Id<=0?(o.value==null&&(o.value=1),s.value=we(a.value.get(o.value))):(o.value=null,s.value.Id=0,s.value.Label="")}function n(u){s.value=we(a.value.get(u))}const d=F(()=>{if(s.value.Id>0)return null;const u=s.value.Label;return Array.from(a.value.values()).map(m=>m.Label).includes(u)?"Ce label est déjà utilisé.":null});return(u,r)=>(g(),w(h,null,{default:t(()=>[e(V,{"align-self":"center"},{default:t(()=>[s.value.Id>0?(g(),w(Te,{key:0,variant:"outlined",density:"compact","hide-details":"",label:"Taux",items:v.value,modelValue:o.value,"onUpdate:modelValue":[r[0]||(r[0]=m=>o.value=m),n]},null,8,["items","modelValue"])):(g(),w(h,{key:1},{default:t(()=>[e(V,{cols:"12"},{default:t(()=>[e(pe,{variant:"outlined",density:"compact",label:"Label",modelValue:s.value.Label,"onUpdate:modelValue":r[1]||(r[1]=m=>s.value.Label=m),disabled:s.value.Id>0,"error-messages":d.value},null,8,["modelValue","disabled","error-messages"])]),_:1}),e(V,null,{default:t(()=>[e(pe,{label:`Valeur d'un ${U(Fl)[U(Rl).FrancsSuisse]}`,density:"compact",variant:"outlined",type:"number",min:"0.001",suffix:"€",hint:"Valeur en € d'une unité de la monnaie.","persistent-hint":"","model-value":s.value.FrancsSuisse/1e3,"onUpdate:modelValue":r[2]||(r[2]=m=>s.value.FrancsSuisse=U(Ul)(Number(m)*1e3)),disabled:s.value.Id>0},null,8,["label","model-value","disabled"])]),_:1})]),_:1}))]),_:1}),e(V,{cols:"auto"},{default:t(()=>[e(oe,{thickness:"2",vertical:"",class:"py-4"},{default:t(()=>[...r[3]||(r[3]=[y("ou",-1)])]),_:1})]),_:1}),e(V,{"align-self":"center",cols:"auto"},{default:t(()=>[e(L,{onClick:c},{prepend:t(()=>[e(ve,null,{default:t(()=>[...r[4]||(r[4]=[y("mdi-toggle-switch",-1)])]),_:1})]),default:t(()=>[y(" "+$(s.value.Id>0?"Créer un taux":"Utiliser un taux"),1)]),_:1})]),_:1})]),_:1}))}}),en=G({__name:"CampStats",props:{stats:{}},setup(l){const s=l;function o(v,a){return`(${_e.pourcent(v,a)} %)`}return(v,a)=>(g(),w(j,{title:"Statut des inscriptions"},{default:t(()=>[e(Y,null,{default:t(()=>[e(ke,{density:"compact"},{default:t(()=>[e(z,{title:"Demandes d'inscriptions"},{append:t(()=>[y($(s.stats.Inscriptions),1)]),_:1}),e(z,{title:"Filles",subtitle:"Parmi toutes les demandes d'inscription"},{append:t(()=>[y($(s.stats.InscriptionsFilles)+" "+$(o(s.stats.InscriptionsFilles,s.stats.Inscriptions)),1)]),_:1}),e(z,{title:"Suisses",subtitle:"Parmi toutes les demandes d'inscription"},{append:t(()=>[y($(s.stats.InscriptionsSuisses)+" "+$(o(s.stats.InscriptionsSuisses,s.stats.Inscriptions)),1)]),_:1}),e(z,{title:"Inscriptions confirmées"},{append:t(()=>[y($(s.stats.Valides)+" "+$(o(s.stats.Valides,s.stats.Inscriptions)),1)]),_:1}),e(z,{title:"Filles",subtitle:"Parmi les inscriptions confirmées"},{append:t(()=>[y($(s.stats.ValidesFilles)+" "+$(o(s.stats.ValidesFilles,s.stats.Valides)),1)]),_:1}),e(z,{title:"Suisses",subtitle:"Parmi les inscriptions confirmées"},{append:t(()=>[y($(s.stats.ValidesSuisses)+" "+$(o(s.stats.ValidesSuisses,s.stats.Valides)),1)]),_:1}),e(z,{title:"A statuer"},{append:t(()=>[y($(s.stats.AStatuer)+" "+$(o(s.stats.AStatuer,s.stats.Inscriptions)),1)]),_:1}),e(z,{title:"Demandes d'exception"},{append:t(()=>[y($(s.stats.Exceptions)+" "+$(o(s.stats.Exceptions,s.stats.Inscriptions)),1)]),_:1}),e(z,{title:"Refus"},{append:t(()=>[y($(s.stats.Refus)+" "+$(o(s.stats.Refus,s.stats.Inscriptions)),1)]),_:1})]),_:1})]),_:1})]),_:1}))}}),tn={key:0},ln=G({__name:"CampHeaderRow",props:{camp:{}},emits:["click","edit","edit-taux","delete","show-documents","send-sondage","add-directeur"],setup(l,{emit:s}){const o=l,v=s,a=F(()=>o.camp.Stats.Inscriptions-o.camp.Stats.Valides),i=D(!1),c=F(()=>{switch(new Date(o.camp.Camp.Camp.DateDebut).getUTCMonth()+1){case 7:case 8:return"rgb(45, 185, 187)";case 9:case 10:case 11:return"rgb(190, 150, 60)";case 12:case 1:case 2:case 3:return"rgb(240, 240, 240)";case 4:case 5:case 6:default:return"rgb(190, 228, 100)"}}),n=D(!1),d=D(0),u=F(()=>{const r=o.camp.ParticipantsFiles||[];if(r.length==0)return 0;let m=0;for(const p of r)p.InscritsCount!=0&&(m+=p.UploadedCount/p.InscritsCount);return Math.round(m/r.length*100)});return(r,m)=>{const p=ut;return g(),Q(le,null,[e(j,{color:c.value,"no-gutters":"",onClick:m[6]||(m[6]=k=>v("click")),class:"my-1"},{default:t(()=>[e(h,{style:tt({"background-color":c.value}),class:"px-1","no-gutters":"",justify:"space-between"},{default:t(()=>[e(V,null,{default:t(()=>[e(z,{title:U(Ce).label(o.camp.Camp.Camp),subtitle:`ID : ${o.camp.Camp.Camp.Id}`},null,8,["title","subtitle"])]),_:1}),e(V,{"align-self":"center"},{default:t(()=>[y($(U(Ce).formatPlage(l.camp.Camp.Camp)),1)]),_:1}),e(V,{cols:"2","align-self":"center"},{default:t(()=>[e(He,{width:"450px",location:"left","content-class":"pa-0"},{activator:t(({props:k})=>[e(dt,ie({class:"bg-white border-md border-primary"},k,{max:o.camp.Camp.Camp.Places,"model-value":o.camp.Stats.Valides,height:"36",rounded:"",color:"primary"}),{default:t(()=>[T("strong",null,[y($(o.camp.Stats.Valides)+"/"+$(o.camp.Camp.Camp.Places)+" ",1),a.value>0?(g(),Q("span",tn," (+ "+$(a.value)+")",1)):W("",!0)]),e(ve,{class:"ml-2"},{default:t(()=>[...m[12]||(m[12]=[y("mdi-account-multiple",-1)])]),_:1})]),_:1},16,["max","model-value"])]),default:t(()=>[e(en,{stats:o.camp.Stats},null,8,["stats"])]),_:1})]),_:1}),e(V,{cols:"1","align-self":"center",class:"px-2"},{default:t(()=>[e(He,{width:"600",location:"left","content-class":"pa-0"},{activator:t(({props:k})=>[e(dt,ie({class:"bg-white border-md border-primary"},k,{max:100,"model-value":u.value,height:"36",rounded:"",color:"primary"}),{default:t(()=>[T("strong",null,$(u.value)+" % ",1),e(ve,{class:"ml-2"},{default:t(()=>[...m[13]||(m[13]=[y("mdi-file-upload",-1)])]),_:1})]),_:1},16,["model-value"])]),default:t(()=>[e(j,{title:"Pièces justificatives"},{default:t(()=>[e(Y,null,{default:t(()=>[e(ke,null,{default:t(()=>[(g(!0),Q(le,null,ce(o.camp.ParticipantsFiles,k=>(g(),w(z,{title:k.Title},{append:t(()=>[y($(k.UploadedCount)+" / "+$(k.InscritsCount)+" ("+$(U(_e).pourcent(k.UploadedCount,k.InscritsCount))+" %) ",1)]),_:2},1032,["title"]))),256))]),_:1})]),_:1})]),_:1})]),_:1})]),_:1}),e(V,{cols:"1"}),e(V,{cols:"auto","align-self":"center"},{default:t(()=>[e(Se,null,{activator:t(({props:k})=>[e(L,ie(k,{size:"x-small",class:"mx-1",icon:"mdi-dots-vertical"}),null,16)]),default:t(()=>[e(ke,{density:"compact"},{default:t(()=>[e(z,{"prepend-icon":"mdi-pencil",onClick:m[0]||(m[0]=k=>v("edit"))},{default:t(()=>[...m[14]||(m[14]=[y("Modifier les paramètres",-1)])]),_:1}),e(z,{"prepend-icon":"mdi-currency-eur",onClick:m[1]||(m[1]=k=>v("edit-taux"))},{default:t(()=>[...m[15]||(m[15]=[y("Taux de conversion",-1)])]),_:1}),e(oe,{thickness:"1"}),e(z,{"prepend-icon":"mdi-mail",onClick:m[2]||(m[2]=k=>v("show-documents")),title:"Documents"}),e(oe,{thickness:"1"}),e(z,{"prepend-icon":"mdi-plus",onClick:m[3]||(m[3]=k=>n.value=!0),title:"Ajouter un directeur...",disabled:o.camp.HasDirecteur},null,8,["disabled"]),e(oe,{thickness:"1"}),e(z,{title:"Envoyer le sondage",subtitle:"de fin de séjour","prepend-icon":"mdi-comment-quote",onClick:m[4]||(m[4]=k=>v("send-sondage"))}),e(oe,{thickness:"1"}),e(z,{"prepend-icon":"mdi-delete",disabled:o.camp.Stats.Inscriptions>0,onClick:m[5]||(m[5]=k=>i.value=!0)},{default:t(()=>[...m[16]||(m[16]=[y("Supprimer",-1)])]),_:1},8,["disabled"])]),_:1})]),_:1})]),_:1})]),_:1},8,["style"])]),_:1},8,["color"]),e(ee,{modelValue:i.value,"onUpdate:modelValue":m[8]||(m[8]=k=>i.value=k),"max-width":"600"},{default:t(()=>[e(j,{title:"Confirmer la suppression"},{default:t(()=>[e(Y,null,{default:t(()=>[m[17]||(m[17]=y(" Etes vous certain de supprimer le séjour ",-1)),T("b",null,$(U(Ce).label(o.camp.Camp.Camp)),1),m[18]||(m[18]=y(" ? ",-1)),m[19]||(m[19]=T("br",null,null,-1)),m[20]||(m[20]=T("br",null,null,-1)),m[21]||(m[21]=y(" Les éventuels ",-1)),m[22]||(m[22]=T("i",null,"équipiers",-1)),m[23]||(m[23]=y(" déclarés sur ce séjour seront aussi supprimés. ",-1)),m[24]||(m[24]=T("br",null,null,-1)),m[25]||(m[25]=T("br",null,null,-1)),m[26]||(m[26]=y(" Attention, cette opération est irréversible. ",-1))]),_:1}),e(re,null,{default:t(()=>[e(se),e(L,{color:"red",onClick:m[7]||(m[7]=k=>{i.value=!1,v("delete")})},{default:t(()=>[...m[27]||(m[27]=[y("Supprimer",-1)])]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"]),e(ee,{modelValue:n.value,"onUpdate:modelValue":m[11]||(m[11]=k=>n.value=k),"max-width":"400px"},{default:t(()=>[e(j,{title:"Ajouter un directeur"},{default:t(()=>[e(Y,null,{default:t(()=>[e(p,{"initial-personne":"",label:"Directeur",modelValue:d.value,"onUpdate:modelValue":m[9]||(m[9]=k=>d.value=k),api:U(x)},null,8,["modelValue","api"])]),_:1}),e(re,null,{default:t(()=>[e(se),e(L,{disabled:!d.value,onClick:m[10]||(m[10]=k=>{n.value=!1,v("add-directeur",d.value)})},{default:t(()=>[...m[28]||(m[28]=[y("Ajouter",-1)])]),_:1},8,["disabled"])]),_:1})]),_:1})]),_:1},8,["modelValue"])],64)}}}),an=G({__name:"CampsSelector",props:De({allCamps:{}},{modelValue:{required:!0},modelModifiers:{}}),emits:["update:modelValue"],setup(l,{emit:s}){const o=l,v=xe(l,"modelValue"),a=F(()=>o.allCamps.map(i=>({title:i.Label,value:i.Id})));return(i,c)=>(g(),w(_a,{multiple:"",chips:"","closable-chips":"",items:a.value,modelValue:v.value,"onUpdate:modelValue":c[0]||(c[0]=n=>v.value=n)},null,8,["items","modelValue"]))}}),nn=G({__name:"DocumentsCard",props:{camp:{}},setup(l){const s=l;Oe(v);const o=D(null);async function v(){const a=await x.CampsDocuments({idCamp:s.camp.Camp.Camp.Id});a!==void 0&&(o.value=a)}return(a,i)=>{const c=Ma;return o.value!=null?(g(),w(j,{key:0,title:"Documents"},{default:t(()=>[e(Y,null,{default:t(()=>[e(ke,null,{default:t(()=>[e(Tt,null,{default:t(()=>[...i[0]||(i[0]=[y("Préférences d'affichage",-1)])]),_:1}),e(z,null,{default:t(()=>[e(h,{class:"mb-2"},{default:t(()=>[e(V,null,{default:t(()=>[e(Pe,{color:o.value.ToShow.LettreDirecteur?"green":"grey","append-icon":o.value.ToShow.LettreDirecteur?"mdi-check":""},{default:t(()=>[...i[1]||(i[1]=[y("Lettre du directeur",-1)])]),_:1},8,["color","append-icon"])]),_:1}),e(V,null,{default:t(()=>[e(Pe,{color:o.value.ToShow.ListeVetements?"green":"grey","append-icon":o.value.ToShow.ListeVetements?"mdi-check":""},{default:t(()=>[...i[2]||(i[2]=[y(" Liste de vêtements",-1)])]),_:1},8,["color","append-icon"])]),_:1}),e(V,null,{default:t(()=>[e(Pe,{color:o.value.ToShow.ListeParticipants?"green":"grey","append-icon":o.value.ToShow.ListeParticipants?"mdi-check":""},{default:t(()=>[...i[3]||(i[3]=[y("Liste des participants ",-1)])]),_:1},8,["color","append-icon"])]),_:1})]),_:1})]),_:1}),e(Tt,null,{default:t(()=>[...i[4]||(i[4]=[y("Documents du séjour",-1)])]),_:1}),(g(!0),Q(le,null,ce(o.value.Generated,n=>(g(),w(z,{title:n.NomClient},{append:t(()=>[e(c,{"file-key":n.Key,"is-generated-doc":!0},null,8,["file-key"])]),_:2},1032,["title"]))),256)),(g(!0),Q(le,null,ce(o.value.ToRead,n=>(g(),w(z,{title:n.NomClient},{append:t(()=>[e(c,{"file-key":n.Key,"is-generated-doc":!1},null,8,["file-key"])]),_:2},1032,["title"]))),256)),(g(!0),Q(le,null,ce(o.value.ToUploadModeles,n=>(g(),w(z,{title:n.NomClient,subtitle:"Document à remplir"},{append:t(()=>[e(c,{"file-key":n.Key,"is-generated-doc":!1},null,8,["file-key"])]),_:2},1032,["title"]))),256))]),_:1})]),_:1})]),_:1})):(g(),w(at,{key:1,type:"card"}))}}}),kt=G({__name:"RequestProgressCard",props:{title:{},current:{},total:{}},setup(l){const s=l;return(o,v)=>(g(),w(j,{title:s.title},{default:t(()=>[e(Y,null,{default:t(()=>[e(dt,{max:s.total,"model-value":s.current,color:"primary",height:"24"},{default:t(()=>[y($(s.current)+" / "+$(s.total),1)]),_:1},8,["max","model-value"])]),_:1})]),_:1},8,["title"]))}}),un={key:0,class:"text-center my-4"},sn=G({__name:"JoomeoPannel",emits:["save"],setup(l,{emit:s}){Oe(a);const o=D(null),v=D([]);async function a(){const p=await x.CampsLoadAlbums();p!==void 0&&(o.value=p||[],v.value=[])}function i(p){return o.value.find(k=>k.Camp.Id==p)}const c=D(!1),n=F(()=>c.value||!v.value.length||!o.value?!1:v.value.every(p=>i(p).Camp.JoomeoID==""));async function d(){c.value=!0;const p=await x.CampsCreateAlbums({IdCamps:v.value});c.value=!1,p!==void 0&&(It(p).forEach(([k,C])=>{i(k).Album=C}),x.showMessage("Albums Joomeo créés avec succès."))}const u=F(()=>c.value||!v.value.length||!o.value?!1:v.value.every(p=>i(p).Camp.JoomeoID!=""&&i(p).HasDirecteur));async function r(){c.value=!0;const p=await x.CampsAddDirecteursToAlbums({IdCamps:v.value,SendMail:!0});c.value=!1,p!==void 0&&(It(p).forEach(([k,C])=>{i(k).DirecteurPermission=C}),x.showMessage("Directeurs ajoutés avec succès."))}function m(p){return p.type==1&&p.albumAccessRules.allowDownload&&p.albumAccessRules.allowUpload&&p.accessRules.allowDeleteFile&&p.accessRules.allowEditFileCaption}return(p,k)=>(g(),w(j,{title:"Albums Joomeo",subtitle:"Seuls les camps en cours sont affichés."},{append:t(()=>[e(L,{disabled:!n.value,onClick:d},{prepend:t(()=>[e(ve,{color:"green"},{default:t(()=>[...k[1]||(k[1]=[y("mdi-plus",-1)])]),_:1})]),default:t(()=>[k[2]||(k[2]=y(" Créer les albums",-1))]),_:1},8,["disabled"]),e(L,{disabled:!u.value,onClick:r,class:"ml-2"},{prepend:t(()=>[e(ve,null,{default:t(()=>[...k[3]||(k[3]=[y("mdi-account-eye",-1)])]),_:1})]),default:t(()=>[k[4]||(k[4]=y(" Ajouter les directeurs",-1))]),_:1},8,["disabled"])]),default:t(()=>[c.value?(g(),w(dt,{key:0,indeterminate:""})):W("",!0),e(Y,null,{default:t(()=>[o.value==null?(g(),Q("div",un,[e(Ll,{indeterminate:""})])):(g(),w(ke,{key:1,selected:v.value,"onUpdate:selected":k[0]||(k[0]=C=>v.value=C),"select-strategy":"leaf"},{default:t(()=>[(g(!0),Q(le,null,ce(o.value,C=>(g(),w(z,{value:C.Camp.Id,title:U(Ce).label(C.Camp),rounded:"",class:"my-1"},{append:t(()=>[e(h,null,{default:t(()=>[e(V,null,{default:t(()=>[e(Pe,{color:C.Album.Id?"primary":void 0},{default:t(()=>[C.Album.Id?(g(),w(He,{key:0,activator:"parent","content-class":"pa-0"},{default:t(()=>[e(j,{title:"Album Joomeo","min-width":"400px"},{default:t(()=>[e(Y,null,{default:t(()=>[e(h,null,{default:t(()=>[e(V,{cols:"auto"},{default:t(()=>[...k[5]||(k[5]=[y("Nom",-1)])]),_:1}),e(V,{class:"text-right"},{default:t(()=>[y($(C.Album.Label),1)]),_:2},1024)]),_:2},1024),e(h,null,{default:t(()=>[e(V,{cols:"auto"},{default:t(()=>[...k[6]||(k[6]=[y("ID",-1)])]),_:1}),e(V,{class:"text-right"},{default:t(()=>[y($(C.Album.Id),1)]),_:2},1024)]),_:2},1024),e(h,null,{default:t(()=>[e(V,{cols:"auto"},{default:t(()=>[...k[7]||(k[7]=[y("Date de création",-1)])]),_:1}),e(V,{class:"text-right"},{default:t(()=>[y($(new Date(C.Album.Date).toLocaleDateString("fr")),1)]),_:2},1024)]),_:2},1024),e(h,null,{default:t(()=>[e(V,{cols:"auto"},{default:t(()=>[...k[8]||(k[8]=[y("Nombre de photos",-1)])]),_:1}),e(V,{class:"text-right"},{default:t(()=>[y($(C.Album.FilesCount),1)]),_:2},1024)]),_:2},1024)]),_:2},1024)]),_:2},1024)]),_:2},1024)):W("",!0),y(" "+$(C.Album.Id==""?"Pas d'album":`Album créé le ${U(_e).date(C.Album.Date)}`),1)]),_:2},1032,["color"])]),_:2},1024),C.Album.Id?(g(),w(V,{key:0},{default:t(()=>[e(Pe,{color:C.HasDirecteur?C.DirecteurPermission.contactid!=""?"green":"orange":"red"},{default:t(()=>[C.DirecteurPermission.contactid?(g(),w(He,{key:0,activator:"parent","content-class":"pa-0"},{default:t(()=>[e(j,{title:"Accès à l'album",subtitle:"Le directeur a accès à l'album."},{default:t(()=>[e(Y,null,{default:t(()=>[e(h,null,{default:t(()=>[e(V,null,{default:t(()=>[...k[9]||(k[9]=[y("Email",-1)])]),_:1}),e(V,{class:"text-right"},{default:t(()=>[y($(C.DirecteurPermission.email),1)]),_:2},1024)]),_:2},1024),e(h,null,{default:t(()=>[e(V,null,{default:t(()=>[...k[10]||(k[10]=[y("Login",-1)])]),_:1}),e(V,{class:"text-right"},{default:t(()=>[y($(C.DirecteurPermission.login),1)]),_:2},1024)]),_:2},1024),e(h,null,{default:t(()=>[e(V,null,{default:t(()=>[...k[11]||(k[11]=[y("Mot de passe",-1)])]),_:1}),e(V,{class:"text-right"},{default:t(()=>[y($(C.DirecteurPermission.password),1)]),_:2},1024)]),_:2},1024),e(h,null,{default:t(()=>[e(V,null,{default:t(()=>[...k[12]||(k[12]=[y("Permissions (écriture)",-1)])]),_:1}),e(V,{class:"text-right"},{default:t(()=>[e(ve,{icon:m(C.DirecteurPermission)?"mdi-check":"mdi-warning",color:m(C.DirecteurPermission)?"green":"orange"},null,8,["icon","color"])]),_:2},1024)]),_:2},1024)]),_:2},1024)]),_:2},1024)]),_:2},1024)):W("",!0),y(" "+$(C.HasDirecteur?C.DirecteurPermission.contactid!=""?"Directeur ajouté":"Directeur à ajouter":"Aucun directeur"),1)]),_:2},1032,["color"])]),_:2},1024)):W("",!0)]),_:2},1024)]),_:2},1032,["value","title"]))),256))]),_:1},8,["selected"]))]),_:1}),e(re,null,{default:t(()=>[e(se)]),_:1})]),_:1}))}});function on(){const l=D([]);hl(()=>l.value=[]);function s(o,v){l.value[v]=o}return{refs:l,updateRef:s}}const rn=Ue({activeColor:String,start:{type:[Number,String],default:1},modelValue:{type:Number,default:l=>l.start},disabled:Boolean,length:{type:[Number,String],default:1,validator:l=>l%1===0},totalVisible:[Number,String],firstIcon:{type:Ne,default:"$first"},prevIcon:{type:Ne,default:"$prev"},nextIcon:{type:Ne,default:"$next"},lastIcon:{type:Ne,default:"$last"},ariaLabel:{type:String,default:"$vuetify.pagination.ariaLabel.root"},pageAriaLabel:{type:String,default:"$vuetify.pagination.ariaLabel.page"},currentPageAriaLabel:{type:String,default:"$vuetify.pagination.ariaLabel.currentPage"},firstAriaLabel:{type:String,default:"$vuetify.pagination.ariaLabel.first"},previousAriaLabel:{type:String,default:"$vuetify.pagination.ariaLabel.previous"},nextAriaLabel:{type:String,default:"$vuetify.pagination.ariaLabel.next"},lastAriaLabel:{type:String,default:"$vuetify.pagination.ariaLabel.last"},ellipsis:{type:String,default:"..."},showFirstLastPage:Boolean,...Wl(),...Ql(),...zl(),...Hl(),...Yl(),...ql(),...jl({tag:"nav"}),...Bl(),...Nl({variant:"text"})},"VPagination"),dn=Re()({name:"VPagination",props:rn(),emits:{"update:modelValue":l=>!0,first:l=>!0,prev:l=>!0,next:l=>!0,last:l=>!0},setup(l,s){let{slots:o,emit:v}=s;const a=$e(l,"modelValue"),{t:i,n:c}=ze(),{isRtl:n}=el(),{themeClasses:d}=El(l),{width:u}=Tl(),r=Xe(-1);At(void 0,{scoped:!0});const{resizeRef:m}=Ol(J=>{if(!J.length)return;const{target:I,contentRect:te}=J[0],ae=I.querySelector(".v-pagination__list > *");if(!ae)return;const N=te.width,B=ae.offsetWidth+parseFloat(getComputedStyle(ae).marginRight)*2;r.value=_(N,B)}),p=F(()=>parseInt(l.length,10)),k=F(()=>parseInt(l.start,10)),C=F(()=>l.totalVisible!=null?parseInt(l.totalVisible,10):r.value>=0?r.value:_(u.value,58));function _(J,I){const te=l.showFirstLastPage?5:3;return Math.max(0,Math.floor(Number(((J-I*te)/I).toFixed(2))))}const P=F(()=>{if(p.value<=0||isNaN(p.value)||p.value>Number.MAX_SAFE_INTEGER)return[];if(C.value<=0)return[];if(C.value===1)return[a.value];if(p.value<=C.value)return he(p.value,k.value);const J=C.value%2===0,I=J?C.value/2:Math.floor(C.value/2),te=J?I:I+1,ae=p.value-I;if(te-a.value>=0)return[...he(Math.max(1,C.value-1),k.value),l.ellipsis,p.value];if(a.value-ae>=(J?1:0)){const N=C.value-1,B=p.value-N+k.value;return[k.value,l.ellipsis,...he(N,B)]}else{const N=Math.max(1,C.value-2),B=N===1?a.value:a.value-Math.ceil(N/2)+k.value;return[k.value,l.ellipsis,...he(N,B),l.ellipsis,p.value]}});function A(J,I,te){J.preventDefault(),a.value=I,te&&v(te,I)}const{refs:q,updateRef:Z}=on();At({VPaginationBtn:{color:Fe(()=>l.color),border:Fe(()=>l.border),density:Fe(()=>l.density),size:Fe(()=>l.size),variant:Fe(()=>l.variant),rounded:Fe(()=>l.rounded),elevation:Fe(()=>l.elevation)}});const S=F(()=>P.value.map((J,I)=>{const te=ae=>Z(ae,I);if(typeof J=="string")return{isActive:!1,key:`ellipsis-${I}`,page:J,props:{ref:te,ellipsis:!0,icon:!0,disabled:!0}};{const ae=J===a.value;return{isActive:ae,key:J,page:c(J),props:{ref:te,ellipsis:!1,icon:!0,disabled:!!l.disabled||Number(l.length)<2,color:ae?l.activeColor:l.color,"aria-current":ae,"aria-label":i(ae?l.currentPageAriaLabel:l.pageAriaLabel,J),onClick:N=>A(N,J)}}}})),f=F(()=>{const J=!!l.disabled||a.value<=k.value,I=!!l.disabled||a.value>=k.value+p.value-1;return{first:l.showFirstLastPage?{icon:n.value?l.lastIcon:l.firstIcon,onClick:te=>A(te,k.value,"first"),disabled:J,"aria-label":i(l.firstAriaLabel),"aria-disabled":J}:void 0,prev:{icon:n.value?l.nextIcon:l.prevIcon,onClick:te=>A(te,a.value-1,"prev"),disabled:J,"aria-label":i(l.previousAriaLabel),"aria-disabled":J},next:{icon:n.value?l.prevIcon:l.nextIcon,onClick:te=>A(te,a.value+1,"next"),disabled:I,"aria-label":i(l.nextAriaLabel),"aria-disabled":I},last:l.showFirstLastPage?{icon:n.value?l.firstIcon:l.lastIcon,onClick:te=>A(te,k.value+p.value-1,"last"),disabled:I,"aria-label":i(l.lastAriaLabel),"aria-disabled":I}:void 0}});function K(){const J=a.value-k.value;q.value[J]?.$el.focus()}function be(J){J.key===Mt.left&&!l.disabled&&a.value>Number(l.start)?(a.value=a.value-1,$t(K)):J.key===Mt.right&&!l.disabled&&a.value<k.value+p.value-1&&(a.value=a.value+1,$t(K))}return Le(()=>e(l.tag,{ref:m,class:Ve(["v-pagination",d.value,l.class]),style:tt(l.style),role:"navigation","aria-label":i(l.ariaLabel),onKeydown:be,"data-test":"v-pagination-root"},{default:()=>[T("ul",{class:"v-pagination__list"},[l.showFirstLastPage&&T("li",{key:"first",class:"v-pagination__first","data-test":"v-pagination-first"},[o.first?o.first(f.value.first):e(L,ie({_as:"VPaginationBtn"},f.value.first),null)]),T("li",{key:"prev",class:"v-pagination__prev","data-test":"v-pagination-prev"},[o.prev?o.prev(f.value.prev):e(L,ie({_as:"VPaginationBtn"},f.value.prev),null)]),S.value.map((J,I)=>T("li",{key:J.key,class:Ve(["v-pagination__item",{"v-pagination__item--is-active":J.isActive}]),"data-test":"v-pagination-item"},[o.item?o.item(J):e(L,ie({_as:"VPaginationBtn"},J.props),{default:()=>[J.page]})])),T("li",{key:"next",class:"v-pagination__next","data-test":"v-pagination-next"},[o.next?o.next(f.value.next):e(L,ie({_as:"VPaginationBtn"},f.value.next),null)]),l.showFirstLastPage&&T("li",{key:"last",class:"v-pagination__last","data-test":"v-pagination-last"},[o.last?o.last(f.value.last):e(L,ie({_as:"VPaginationBtn"},f.value.last),null)])])]})),{}}}),mn={key:2},yt=16,cn=G({__name:"CampsList",emits:["show-participants"],setup(l,{emit:s}){const o=s;Oe(r);const v=bt(new Map),a=D(!1),i=bt({pattern:"",openOnly:!1}),c=F(()=>{const M=new Set,b=new Set;for(const O of v.values())for(const R of Object.entries(O.Camp.Camp.Meta||{}))M.add(R[0]),b.add(R[1]);return{keys:Array.from(M.keys()).sort(),values:Array.from(b.keys()).sort()}}),n=F(()=>{const M=al(i.pattern),b=Array.from(v.values()).filter(O=>Ce.match(O.Camp.Camp,M)&&(!i.openOnly||Et(O.Camp)));return b.sort((O,R)=>{const ye=new Date(R.Camp.Camp.DateDebut).valueOf(),ne=new Date(O.Camp.Camp.DateDebut).valueOf();return ye==ne?O.Camp.Camp.Id-R.Camp.Camp.Id:ye-ne}),b}),d=F(()=>n.value.slice((k.value-1)*yt,k.value*yt));function u(){k.value>p.value&&(k.value=p.value)}async function r(){a.value=!0;const M=await x.CampsGet();a.value=!1,M!==void 0&&(v.clear(),M?.forEach(b=>v.set(b.Camp.Camp.Id,b)))}async function m(){a.value=!0;const M=await x.CampsCreate();a.value=!1,M!==void 0&&(x.showMessage("Camp ajouté avec succès."),v.set(M.Camp.Camp.Id,M),C.value=M)}const p=F(()=>Math.max(Math.ceil(n.value.length/yt),1)),k=D(1),C=D(null);async function _(M){C.value=null,a.value=!0;const b=await x.CampsUpdate(M);a.value=!1,b!==void 0&&(x.showMessage("Séjour modifié avec succès."),v.get(b.Camp.Id).Camp=b,u())}const P=D(null);async function A(){const M=P.value;if(M==null)return;P.value=null,a.value=!0;const b=await x.CampsSetTaux({IdCamp:M.Camp.Camp.Id,Taux:M.Taux});if(a.value=!1,b===void 0)return;x.showMessage("Taux modifié avec succès.");const O=v.get(M.Camp.Camp.Id);O.Camp.Camp.IdTaux=b.Id,O.Taux=b}const q=D(!1),Z=D(5),S=D({Id:1,Label:"",Euros:0,FrancsSuisse:0}),f=F(()=>S.value.Id>0||S.value.Label!=""),K=F(()=>new Set(Array.from(v.values()).filter(b=>Et(b.Camp)).map(b=>b.Camp.Camp.IdTaux)).size<=1);async function be(){q.value=!1,a.value=!0;const M=await x.CampsCreateMany({Count:Z.value,Taux:S.value});a.value=!1,M!==void 0&&(x.showMessage("Séjours créés avec succès."),M?.forEach(b=>v.set(b.Camp.Camp.Id,b)))}async function J(M){a.value=!0;const b=await x.CampsDelete({id:M.Camp.Camp.Id});a.value=!1,b!==void 0&&(x.showMessage("Séjour supprimé avec succès."),v.delete(M.Camp.Camp.Id),u())}const I=D(!1);function te(){ae.value=Array.from(v.values()).filter(M=>M.Camp.Camp.Statut!=Gl.Ouvert).map(M=>M.Camp.Camp.Id),I.value=!0}const ae=D([]);async function N(){I.value=!1,!(!ae.value.length||await x.CampsOuvreInscriptions({Camps:ae.value})===void 0)&&(x.showMessage("Séjours ouverts aux inscriptions avec succès."),r())}const B=D(null),ue=D(null);async function X(M){ue.value={Current:0,Total:10};const b=await x.EventsSendSondages({idCamp:M});if(b===void 0){ue.value=null;return}await gt(b,O=>ue.value=O,O=>x.onError("Envoi du sondage",O)),ue.value=null,x.showMessage("Sondage envoyé avec succès.")}async function fe(M,b){await x.CampsCreateEquipier({IdPersonne:M,IdCamp:b,Roles:[Kl.Direction]})!==void 0&&(v.get(b).HasDirecteur=!0,x.showMessage("Directeur ajouté avec succès."))}const ge=D(!1);return(M,b)=>{const O=We;return g(),Q(le,null,[e(j,{title:"Séjours",subtitle:v.size},{append:t(()=>[e(h,null,{default:t(()=>[e(V,{"align-self":"center",style:{width:"240px"}},{default:t(()=>[e(pe,{label:"Rechercher",variant:"filled",density:"comfortable","hide-details":"","prepend-inner-icon":"mdi-magnify",clearable:"",modelValue:i.pattern,"onUpdate:modelValue":[b[0]||(b[0]=R=>i.pattern=R),b[2]||(b[2]=R=>u())],"onClick:clear":b[1]||(b[1]=R=>{i.pattern="",u()})},null,8,["modelValue"])]),_:1}),e(oe,{vertical:"",thickness:"1"}),e(V,{"align-self":"center",cols:"auto"},{default:t(()=>[e(Se,null,{activator:t(({props:R})=>[e(L,ie(R,{color:"success",disabled:a.value}),{prepend:t(()=>[e(ve,null,{default:t(()=>[...b[18]||(b[18]=[y("mdi-plus",-1)])]),_:1})]),default:t(()=>[b[19]||(b[19]=y(" Créer un séjour ",-1))]),_:1},16,["disabled"])]),default:t(()=>[e(ke,{density:"compact"},{default:t(()=>[e(z,{onClick:m,title:"Créer un séjour"}),e(z,{title:"Créer plusieurs séjours...",subtitle:"Permet de choisir les taux de conversion",onClick:b[3]||(b[3]=R=>q.value=!0)})]),_:1})]),_:1})]),_:1}),e(V,{"align-self":"center",cols:"auto"},{default:t(()=>[e(L,{flat:"",icon:"",size:"small"},{default:t(()=>[e(ve,{icon:"mdi-dots-vertical"}),e(Se,{activator:"parent"},{default:t(()=>[e(ke,{density:"compact"},{default:t(()=>[e(z,{title:"Masquer les camps fermés",subtitle:"N'afficher que les camps ouverts aux inscriptions",onClick:b[5]||(b[5]=R=>i.openOnly=!i.openOnly)},{prepend:t(()=>[e(qe,{class:"mr-2",modelValue:i.openOnly,"onUpdate:modelValue":b[4]||(b[4]=R=>i.openOnly=R),density:"compact","hide-details":""},null,8,["modelValue"])]),_:1}),e(oe,{thickness:"1"}),e(z,{onClick:b[6]||(b[6]=R=>ge.value=!0),title:"Configurer les albums Joomeo...","prepend-icon":"mdi-image-album"}),e(oe,{thickness:"1"}),e(z,{onClick:te,title:"Ouvrir les inscriptions...",subtitle:"sur plusieurs séjours","prepend-icon":"mdi-lock-open"}),e(oe,{thickness:"1"}),e(z,{"prepend-icon":"mdi-file-excel",title:"Exporter",subtitle:"Participants de l'année courante (format Excel)",link:"",href:U(x).CampsDownloadParticipants(new Date().getFullYear(),U(x).authToken)},null,8,["href"])]),_:1})]),_:1})]),_:1})]),_:1})]),_:1})]),default:t(()=>[e(Y,{class:"mt-4"},{default:t(()=>[K.value?W("",!0):(g(),w(Jl,{key:0,type:"warning"},{default:t(()=>[...b[20]||(b[20]=[y(" Attention, les séjours ouverts aux inscriptions ont des taux de conversion incompatibles ! ",-1)])]),_:1})),a.value?(g(),w(at,{key:1})):n.value.length==0?(g(),Q("i",mn," Aucun camp ne correspond aux filtres actuels. ")):W("",!0),(g(!0),Q(le,null,ce(d.value,(R,ye)=>(g(),w(ln,{key:ye,camp:R,onClick:ne=>o("show-participants",R),onEdit:ne=>C.value=R,onEditTaux:ne=>P.value=R,onDelete:ne=>J(R),onShowDocuments:ne=>B.value=R,onSendSondage:ne=>X(R.Camp.Camp.Id),onAddDirecteur:ne=>fe(ne,R.Camp.Camp.Id)},null,8,["camp","onClick","onEdit","onEditTaux","onDelete","onShowDocuments","onSendSondage","onAddDirecteur"]))),128)),e(dn,{length:p.value,modelValue:k.value,"onUpdate:modelValue":b[7]||(b[7]=R=>k.value=R)},null,8,["length","modelValue"])]),_:1})]),_:1},8,["subtitle"]),e(ee,{"model-value":C.value!=null,"onUpdate:modelValue":b[8]||(b[8]=R=>C.value=null),"max-width":"800px"},{default:t(()=>[C.value!=null?(g(),w(Za,{key:0,camp:C.value.Camp.Camp,"preselection-url":C.value.URLPreselection,"meta-entries-hints":c.value,onSave:_},null,8,["camp","preselection-url","meta-entries-hints"])):W("",!0)]),_:1},8,["model-value"]),e(ee,{"model-value":P.value!=null,"onUpdate:modelValue":b[10]||(b[10]=R=>P.value=null),"max-width":"600"},{default:t(()=>[P.value!=null?(g(),w(j,{key:0,title:"Modifier le taux",subtitle:"La modification n'est possible que si aucun participant n'est enregistré."},{default:t(()=>[e(Y,null,{default:t(()=>[e(Qt,{modelValue:P.value.Taux,"onUpdate:modelValue":b[9]||(b[9]=R=>P.value.Taux=R)},null,8,["modelValue"])]),_:1}),e(re,null,{default:t(()=>[e(se),e(L,{disabled:P.value.Stats.Inscriptions>0,onClick:A},{default:t(()=>[...b[21]||(b[21]=[y("Modifier",-1)])]),_:1},8,["disabled"])]),_:1})]),_:1})):W("",!0)]),_:1},8,["model-value"]),e(ee,{modelValue:q.value,"onUpdate:modelValue":b[13]||(b[13]=R=>q.value=R),"max-width":"600"},{default:t(()=>[e(j,{title:"Créer plusieurs séjours",subtitle:"Les séjours seront liés au même taux de conversion"},{default:t(()=>[e(Y,null,{default:t(()=>[e(h,null,{default:t(()=>[e(V,null,{default:t(()=>[e(O,{label:"Nombre de séjours",modelValue:Z.value,"onUpdate:modelValue":b[11]||(b[11]=R=>Z.value=R)},null,8,["modelValue"])]),_:1})]),_:1}),e(oe,{thickness:"2",class:"my-2"}),e(Qt,{modelValue:S.value,"onUpdate:modelValue":b[12]||(b[12]=R=>S.value=R)},null,8,["modelValue"])]),_:1}),e(re,null,{default:t(()=>[e(se),e(L,{color:"success",onClick:be,disabled:!f.value},{default:t(()=>[...b[22]||(b[22]=[y("Créer",-1)])]),_:1},8,["disabled"])]),_:1})]),_:1})]),_:1},8,["modelValue"]),e(ee,{modelValue:I.value,"onUpdate:modelValue":b[15]||(b[15]=R=>I.value=R),"max-width":"600"},{default:t(()=>[e(j,{title:"Ouvrir les inscriptions",subtitle:"Ouvre les inscriptions sur les séjours ci-dessous"},{default:t(()=>[e(Y,null,{default:t(()=>[e(an,{"all-camps":Array.from(v.values()).map(R=>U(Ce).toItem(R.Camp)),modelValue:ae.value,"onUpdate:modelValue":b[14]||(b[14]=R=>ae.value=R)},null,8,["all-camps","modelValue"])]),_:1}),e(re,null,{default:t(()=>[e(se),e(L,{onClick:N,disabled:!ae.value.length},{default:t(()=>[...b[23]||(b[23]=[y("Ouvrir",-1)])]),_:1},8,["disabled"])]),_:1})]),_:1})]),_:1},8,["modelValue"]),e(ee,{"model-value":B.value!=null,"onUpdate:modelValue":b[16]||(b[16]=R=>B.value=null),"max-width":"800px"},{default:t(()=>[B.value?(g(),w(nn,{key:0,camp:B.value},null,8,["camp"])):W("",!0)]),_:1},8,["model-value"]),e(ee,{"model-value":ue.value!=null,"max-width":"400px",persistent:""},{default:t(()=>[ue.value?(g(),w(kt,{key:0,title:"Envoi du sondage en cours",current:ue.value.Current,total:ue.value.Total},null,8,["current","total"])):W("",!0)]),_:1},8,["model-value"]),e(ee,{modelValue:ge.value,"onUpdate:modelValue":b[17]||(b[17]=R=>ge.value=R)},{default:t(()=>[e(sn)]),_:1},8,["modelValue"])],64)}}}),vn={key:1},pn={key:0,class:"text-center font-italic"},fn=G({__name:"CampParticipants",props:{id:{},idParticipant:{}},setup(l){const s=l;Oe(async()=>{a(),await n(),d()}),Me(()=>s.id,n),Me(()=>s.idParticipant,d);const o=D(!1),v=D([]);async function a(){const S=await x.GetCamps();S!==void 0&&(v.value=S||[])}const i=F(()=>{const S=(c.value?.Participants||[]).map(f=>f);return S.sort(Xl.cmp),S}),c=D(null);async function n(){o.value=!0;const S=await x.CampsLoad({idCamp:s.id});o.value=!1,S!==void 0&&(c.value=S)}function d(){if(s.idParticipant===void 0)return;const S=(c.value?.Participants||[]).find(f=>f.Participant.Id==s.idParticipant);S&&(m.value=we(S))}const u=D(null);async function r(){if(u.value==null||c.value==null)return;const S=await x.ParticipantsCreate(u.value);u.value=null,S!==void 0&&(x.showMessage("Participant créé avec succès."),c.value.Participants=(c.value.Participants||[]).concat(S),m.value=we(S))}const m=D(null);async function p(S){if(m.value==null||c.value==null)return;const f=await x.ParticipantsUpdate(S);m.value=null,f!==void 0&&(x.showMessage("Participant modifié avec succès."),n())}const k=D(null);async function C(){if(k.value==null||c.value==null)return;const S=k.value.Participant.Id,f=await x.ParticipantsDelete({id:S});k.value=null,f!==void 0&&(x.showMessage("Participant supprimé avec succès."),c.value.Participants=(c.value.Participants||[]).filter(K=>K.Participant.Id!=S))}const _=D(null);async function P(){const S=_.value;S==null||c.value==null||(_.value=null,await x.ParticipantsMove(S)===void 0)||(x.showMessage("Participant déplacé avec succès.",void 0,{title:"Aller au nouveau séjour",action:()=>wt({IdCamp:S.Target,Id:S.Id})}),c.value.Participants=(c.value.Participants||[]).filter(K=>K.Participant.Id!=S.Id))}const A=D(null);async function q(){if(A.value==null)return;const S=A.value.Participant.Id;A.value=null;const f=await x.ParticipantsSetPlaceLiberee({id:S});if(f===void 0||(x.showMessage("Notification de place libérée envoyée avec succès."),c.value==null))return;const K=c.value.Participants?.find(be=>be.Participant.Id==S);K.Participant=f}const Z=D(!1);return(S,f)=>{const K=Ca,be=wa,J=ut,I=ul,te=Pa,ae=it,N=xa;return c.value!=null?(g(),w(j,{key:0,title:"Participants",subtitle:U(Ce).label(c.value.Camp.Camp)},{append:t(()=>[e(L,{color:"green",onClick:f[0]||(f[0]=B=>u.value={IdCamp:s.id,IdDossier:0,IdPersonne:0})},{prepend:t(()=>[e(ve,null,{default:t(()=>[...f[11]||(f[11]=[y("mdi-plus",-1)])]),_:1})]),default:t(()=>[f[12]||(f[12]=y(" Ajouter un participant",-1))]),_:1}),e(oe,{thickness:"1",class:"mx-1"}),e(L,{icon:"",size:"small",flat:""},{default:t(()=>[e(ve,null,{default:t(()=>[...f[13]||(f[13]=[y("mdi-dots-vertical",-1)])]),_:1}),e(Se,{activator:"parent"},{default:t(()=>[e(ke,null,{default:t(()=>[e(z,{"prepend-icon":"mdi-currency-eur",title:"Suivi du règlement",onClick:f[1]||(f[1]=B=>Z.value=!0)})]),_:1})]),_:1})]),_:1})]),default:t(()=>[e(Y,{class:"mt-4"},{default:t(()=>[o.value?(g(),w(at,{key:0,type:"table"})):(g(),Q("div",vn,[e(K),i.value.length?W("",!0):(g(),Q("div",pn," Aucun participant n'est encore inscrit sur ce séjour. ")),(g(!0),Q(le,null,ce(i.value,(B,ue)=>(g(),w(be,{participant:B,index:ue},{actions:t(()=>[e(ke,{density:"comfortable"},{default:t(()=>[e(z,{title:"Modifier","prepend-icon":"mdi-pencil",onClick:X=>m.value=B},null,8,["onClick"]),e(oe),e(z,{title:"Changer de camp...","prepend-icon":"mdi-file-move",onClick:X=>_.value={Id:B.Participant.Id,Target:0}},null,8,["onClick"]),e(z,{title:"Notifier d'une place disponible.",subtitle:"Envoi un email","prepend-icon":"mdi-email-alert",disabled:B.Participant.Statut==U(Ze).Inscrit||B.Participant.Statut==U(Ze).EnAttenteReponse,onClick:X=>A.value=B},null,8,["disabled","onClick"]),e(oe),e(z,{title:"Aller à la personne",subtitle:`(ID : ${B.Personne.Id})`,onClick:X=>U(Ke)(B.Personne.Id)},null,8,["subtitle","onClick"]),e(z,{title:"Aller au dossier",subtitle:`(ID : ${B.Participant.IdDossier})`,onClick:X=>U(_t)(B.Participant.IdDossier)},null,8,["subtitle","onClick"]),e(oe),e(z,{title:"Supprimer","prepend-icon":"mdi-delete",onClick:X=>k.value=B},null,8,["onClick"])]),_:2},1024)]),_:2},1032,["participant","index"]))),256))]))]),_:1}),u.value!=null?(g(),w(ee,{key:0,"model-value":u.value!=null,"onUpdate:modelValue":f[4]||(f[4]=B=>u.value=null),"max-width":"600px"},{default:t(()=>[e(j,{title:"Créer un participant"},{default:t(()=>[e(Y,null,{default:t(()=>[e(h,null,{default:t(()=>[e(V,{cols:"12"},{default:t(()=>[e(J,{label:"Participant",modelValue:u.value.IdPersonne,"onUpdate:modelValue":f[2]||(f[2]=B=>u.value.IdPersonne=B),"initial-personne":"",api:{SelectPersonne:U(x).SelectPersonne.bind(U(x))}},null,8,["modelValue","api"])]),_:1}),e(V,{cols:"12"},{default:t(()=>[e(I,{modelValue:u.value.IdDossier,"onUpdate:modelValue":f[3]||(f[3]=B=>u.value.IdDossier=B)},null,8,["modelValue"])]),_:1})]),_:1})]),_:1}),e(re,null,{default:t(()=>[e(se),e(L,{color:"green",onClick:r,disabled:!(u.value.IdDossier&&u.value.IdPersonne)},{default:t(()=>[...f[14]||(f[14]=[y("Créer",-1)])]),_:1},8,["disabled"])]),_:1})]),_:1})]),_:1},8,["model-value"])):W("",!0),m.value!=null?(g(),w(ee,{key:1,"model-value":m.value!=null,"onUpdate:modelValue":f[5]||(f[5]=B=>m.value=null),"max-width":"800px"},{default:t(()=>[e(te,{participant:m.value.Participant,personne:m.value.Personne,api:{SelectPersonne:U(x).SelectPersonne.bind(U(x))},onSave:p},null,8,["participant","personne","api"])]),_:1},8,["model-value"])):W("",!0),k.value!=null?(g(),w(ee,{key:2,"model-value":k.value!=null,"onUpdate:modelValue":f[6]||(f[6]=B=>k.value=null),"max-width":"600px"},{default:t(()=>[e(j,{title:"Supprimer le participant"},{default:t(()=>[e(Y,null,{default:t(()=>[f[15]||(f[15]=y(" Confirmez-vous la suppression du participant ",-1)),T("b",null,$(U(Ee).label(k.value.Personne)),1),f[16]||(f[16]=y(" ? ",-1)),f[17]||(f[17]=T("br",null,null,-1)),f[18]||(f[18]=T("br",null,null,-1)),f[19]||(f[19]=y(" Attention, cette opération est irréversible. ",-1))]),_:1}),e(re,null,{default:t(()=>[e(se),e(L,{color:"red",onClick:C},{default:t(()=>[...f[20]||(f[20]=[y("Supprimer",-1)])]),_:1})]),_:1})]),_:1})]),_:1},8,["model-value"])):W("",!0),_.value!=null?(g(),w(ee,{key:3,"model-value":_.value!=null,"onUpdate:modelValue":f[8]||(f[8]=B=>_.value=null),"max-width":"500px"},{default:t(()=>[e(j,{title:"Déplacer le participant"},{default:t(()=>[e(Y,null,{default:t(()=>[e(ae,{label:"Nouveau séjour",camps:v.value,modelValue:_.value.Target,"onUpdate:modelValue":f[7]||(f[7]=B=>_.value.Target=B)},null,8,["camps","modelValue"])]),_:1}),e(re,null,{default:t(()=>[e(se),e(L,{onClick:P,disabled:_.value.Target==s.id||!_.value.Target},{default:t(()=>[...f[21]||(f[21]=[y("Déplacer",-1)])]),_:1},8,["disabled"])]),_:1})]),_:1})]),_:1},8,["model-value"])):W("",!0),A.value!=null?(g(),w(ee,{key:4,"model-value":A.value!=null,"onUpdate:modelValue":f[9]||(f[9]=B=>A.value=null),"max-width":"500px"},{default:t(()=>[e(j,{title:"Notifier d'une place disponible"},{default:t(()=>[e(Y,null,{default:t(()=>[y(" Confirmez-vous l'envoi d'une notification au responsable de "+$(U(Ee).label(A.value.Personne))+" indiquant qu'une place est disponible ? ",1),f[22]||(f[22]=T("br",null,null,-1)),f[23]||(f[23]=T("br",null,null,-1)),y(" Le nouveau statut de "+$(A.value.Personne.Prenom)+" sera : ",1),T("i",null,$(U(Zl)[U(Ze).EnAttenteReponse]),1),f[24]||(f[24]=y(". ",-1))]),_:1}),e(re,null,{default:t(()=>[e(se),e(L,{onClick:q},{default:t(()=>[...f[25]||(f[25]=[y("Notifier",-1)])]),_:1})]),_:1})]),_:1})]),_:1},8,["model-value"])):W("",!0),e(ee,{modelValue:Z.value,"onUpdate:modelValue":f[10]||(f[10]=B=>Z.value=B),"max-width":"700px"},{default:t(()=>[e(N,{data:c.value},null,8,["data"])]),_:1},8,["modelValue"])]),_:1},8,["subtitle"])):(g(),w(at,{key:1,type:"card"}))}}}),yn=G({__name:"camps",setup(l){const s=nt(),o=F(()=>vu(s.currentRoute.value.query)),v=F(()=>o.value.idCamp);function a(c){const n=s.currentRoute.value;s.push({path:n.path,query:{idCamp:c.Camp.Camp.Id}})}function i(){const c=s.currentRoute.value;s.push({path:c.path,query:{}})}return(c,n)=>(g(),Q(le,null,[e(ft,{title:"Gestion des séjours"},{default:t(()=>[v.value!==null?(g(),w(L,{key:0,onClick:i},{prepend:t(()=>[e(ve,null,{default:t(()=>[...n[0]||(n[0]=[y("mdi-view-list",-1)])]),_:1})]),default:t(()=>[n[1]||(n[1]=y(" Retour à la liste",-1))]),_:1})):W("",!0)]),_:1}),v.value===void 0?(g(),w(cn,{key:0,onShowParticipants:a})):(g(),w(fn,{key:1,id:v.value,"id-participant":o.value.idParticipant},null,8,["id","id-participant"]))],64))}}),fl=G({__name:"MergeCard",props:{from:{}},emits:["merge"],setup(l,{emit:s}){const o=l,v=s,a=D(0),i=D(!0);return(c,n)=>{const d=ul;return g(),w(j,{title:"Fusionner le dossier vers",subtitle:"Les participants, paiements et messages seront copiés vers le dossier cible."},{default:t(()=>[e(Y,null,{default:t(()=>[e(h,null,{default:t(()=>[e(V,{cols:"12"},{default:t(()=>[e(d,{modelValue:a.value,"onUpdate:modelValue":n[0]||(n[0]=u=>a.value=u)},null,8,["modelValue"])]),_:1}),e(V,{cols:"12"},{default:t(()=>[e(qe,{density:"compact",label:"Notifier par email",hint:"Le reponsable du dossier absorbé sera averti du changement d'espace personnel.","persistent-hint":"",modelValue:i.value,"onUpdate:modelValue":n[1]||(n[1]=u=>i.value=u)},null,8,["modelValue"])]),_:1})]),_:1})]),_:1}),e(re,null,{default:t(()=>[e(se),e(L,{disabled:a.value==0||a.value==o.from,onClick:n[2]||(n[2]=u=>v("merge",{From:o.from,To:a.value,Notifie:i.value}))},{default:t(()=>[...n[3]||(n[3]=[y("Fusionner",-1)])]),_:1},8,["disabled"])]),_:1})]),_:1})}}}),bn={key:1,class:"text-center font-italic"},gn={key:2},Vn=G({__name:"PannelInscriptions",emits:["goTo","empty"],setup(l,{emit:s}){const o=s,v=D(!1);Oe(async()=>{await i(),a.value.length||o("empty")});const a=D([]);async function i(){v.value=!0;const _=await x.InscriptionsGet();v.value=!1,_!==void 0&&(a.value=_||[])}const c=D(""),n=F(()=>{const _=al(c.value);return a.value.filter(P=>Ee.match(P.Responsable,_)||P.Participants?.some(A=>Ee.match(A.Personne,_)||Ce.match(A.Camp,_)))});async function d(_,P){const A=await x.InscriptionsIdentifiePersonne({IdDossier:_,Target:P});if(A===void 0)return;x.showMessage("Profil identifié avec succès.");const q=a.value.findIndex(Z=>Z.Dossier.Id==_);a.value[q]=A}const u=D(null);async function r(_,P){if(!u.value)return;const A=u.value.inscription.Dossier.Id;u.value=null;const q=await x.InscriptionsValide({IdDossier:A,Statuts:_,SendMail:P});if(q!==void 0)if(q.Dossier.IsValidated)x.showMessage("Inscription validée avec succès.","",{title:"Aller au dossier",action:()=>o("goTo",A)}),a.value=a.value.filter(Z=>Z.Dossier.Id!=A);else{x.showMessage("Participant validé avec succès.");const Z=a.value.findIndex(S=>S.Dossier.Id==A);a.value[Z]=q}}async function m(_){await x.DossiersDelete({id:_.Dossier.Id})!==void 0&&(x.showMessage("Inscription supprimée avec succès."),a.value=a.value.filter(A=>A.Dossier.Id!=_.Dossier.Id))}async function p(_,P){if(await x.ParticipantsDelete({id:P})===void 0)return;x.showMessage("Participant supprimé avec succès.");const q=a.value.find(Z=>Z.Dossier.Id==_);q.Participants=(q.Participants||[]).filter(Z=>Z.Participant.Id!=P)}const k=D(null);async function C(_){k.value=null,await x.DossiersMerge(_)!==void 0&&(x.showMessage("Inscriptions fusionnées avec succès."),i())}return(_,P)=>{const A=Sa;return g(),w(j,{title:"Inscriptions",subtitle:"En attente de validation",class:"ma-2"},{append:t(()=>[e(pe,{width:"300","append-inner-icon":"mdi-magnify",label:"Rechercher","hide-details":"",modelValue:c.value,"onUpdate:modelValue":P[0]||(P[0]=q=>c.value=q)},null,8,["modelValue"])]),default:t(()=>[e(Y,null,{default:t(()=>[v.value?(g(),w(at,{key:0})):a.value.length?(g(),Q("div",gn,[(g(!0),Q(le,null,ce(n.value,(q,Z)=>(g(),w(Da,{class:"my-1",user:null,key:Z,inscription:q,onIdentifie:S=>d(q.Dossier.Id,S),onValide:S=>u.value={inscription:q,participants:S===void 0?void 0:[S]},onMerge:S=>k.value=q.Dossier.Id,onDelete:S=>m(q),onDeleteParticipant:S=>p(q.Dossier.Id,S),api:{SearchSimilaires:U(x).InscriptionsSearchSimilaires.bind(U(x)),SelectPersonne:U(x).SelectPersonne.bind(U(x))}},null,8,["inscription","onIdentifie","onValide","onMerge","onDelete","onDeleteParticipant","api"]))),128))])):(g(),Q("div",bn," Il n'y a aucune inscription à valider. "))]),_:1}),e(ee,{"model-value":k.value!=null,"onUpdate:modelValue":P[1]||(P[1]=q=>k.value=null),"max-width":"600px"},{default:t(()=>[k.value!=null?(g(),w(fl,{key:0,from:k.value,onMerge:C},null,8,["from"])):W("",!0)]),_:1},8,["model-value"]),e(ee,{"model-value":u.value!=null,"onUpdate:modelValue":P[2]||(P[2]=q=>u.value=null),"max-width":"800px"},{default:t(()=>[u.value?(g(),w(A,{key:0,inscription:u.value.inscription,"id-participants":u.value.participants,onValide:r},null,8,["inscription","id-participants"])):W("",!0)]),_:1},8,["model-value"])]),_:1})}}}),kn={class:"text-grey"},_n={class:"text-grey"},Cn={key:0},Pn=G({__name:"FactureCard",props:{dossier:{}},setup(l){const s=l,o=F(()=>(s.dossier.Participants||[]).filter(n=>n.Participant.Statut!=Ze.Inscrit).map(n=>Ee.label(n.Personne))),v=F(()=>(s.dossier.Participants||[]).filter(n=>n.Participant.Statut==Ze.Inscrit).map(n=>({Label:Ee.label(n.Personne),Camp:Ce.label(n.Camp),Prix:_e.montant(n.Camp.Prix),Bilan:s.dossier.Bilan.Inscrits[n.Participant.Id]})));function a(n){return!!(n.Remises.ReducEnfants||n.Remises.ReducEquipiers||n.Remises.ReducSpeciale.Cent)}function i(n){const d=[];return n.ReducEnfants&&d.push(`Enfants : ${n.ReducEnfants}%`),n.ReducEquipiers&&d.push(`Enfants : ${n.ReducEquipiers}%`),n.ReducSpeciale.Cent&&d.push(`Remise : ${_e.montant(n.ReducSpeciale)}`),d.join("  ;  ")}const c=F(()=>{const n=Object.values(s.dossier.Paiements||{});return n.sort((d,u)=>new Date(d.Time).valueOf()-new Date(u.Time).valueOf()),n});return(n,d)=>(g(),w(j,{title:"Suivi financier",subtitle:o.value.length?`Les participants en liste d'attente (${o.value.join(", ")}) ne sont pas pris en compte.`:"","min-width":"900px"},{default:t(()=>[e(Y,null,{default:t(()=>[e(h,null,{default:t(()=>[e(V,{cols:"3"},{default:t(()=>[...d[0]||(d[0]=[y("Participant",-1)])]),_:1}),e(V,{cols:"2",class:"text-center"},{default:t(()=>[...d[1]||(d[1]=[y("Prix du séjour",-1)])]),_:1}),e(V,{cols:"2",class:"text-center"},{default:t(()=>[...d[2]||(d[2]=[y("Prix avec option",-1)])]),_:1}),e(V,{cols:"3",class:"text-center"},{default:t(()=>[...d[3]||(d[3]=[y("Aides extérieures",-1)])]),_:1}),e(V,{cols:"2",class:"text-right"},{default:t(()=>[...d[4]||(d[4]=[y("Sous-total",-1)])]),_:1})]),_:1}),e(oe,{thickness:"1",class:"my-2"}),(g(!0),Q(le,null,ce(v.value,u=>(g(),Q(le,null,[e(h,null,{default:t(()=>[e(V,{"align-self":"center",cols:"3"},{default:t(()=>[y($(u.Label)+" ",1),d[5]||(d[5]=T("br",null,null,-1)),T("span",kn,$(u.Camp),1)]),_:2},1024),e(V,{"align-self":"center",cols:"2",class:"text-center"},{default:t(()=>[y($(u.Prix),1)]),_:2},1024),e(V,{"align-self":"center",cols:"2",class:"text-center"},{default:t(()=>[y($(U(_e).montant(u.Bilan.AvecOption))+" ",1),d[6]||(d[6]=T("br",null,null,-1)),T("span",_n,$(u.Bilan.AvecOptionDescription),1)]),_:2},1024),e(V,{"align-self":"center",cols:"3",class:"text-center"},{default:t(()=>[u.Bilan.Aides?.length?W("",!0):(g(),Q("span",Cn,"-")),(g(!0),Q(le,null,ce(u.Bilan.Aides,r=>(g(),w(Pe,null,{default:t(()=>[y($(r.Structure)+" : "+$(U(_e).montant(r.Montant)),1)]),_:2},1024))),256))]),_:2},1024),e(V,{"align-self":"center",cols:"2",class:"text-right"},{default:t(()=>[y($(u.Bilan.AvecAides),1)]),_:2},1024)]),_:2},1024),a(u.Bilan)?(g(),w(h,{key:0,"no-gutters":""},{default:t(()=>[e(V,{cols:"10",class:"text-right"},{default:t(()=>[T("i",null,$(i(u.Bilan.Remises)),1)]),_:2},1024),e(V,{cols:"2",class:"text-right"},{default:t(()=>[y($(u.Bilan.Net),1)]),_:2},1024)]),_:2},1024)):W("",!0)],64))),256)),e(oe,{thickness:"1",class:"my-2"}),e(h,null,{default:t(()=>[e(V,{cols:"10",class:"text-right"},{default:t(()=>[...d[7]||(d[7]=[y("Total demandé",-1)])]),_:1}),e(V,{cols:"2",class:"text-right"},{default:t(()=>[y($(s.dossier.Bilan.Demande),1)]),_:1})]),_:1}),e(oe,{thickness:"1",class:"my-2"}),(g(!0),Q(le,null,ce(c.value,u=>(g(),w(h,null,{default:t(()=>[e(V,null,{default:t(()=>[y(" Paiement de "+$(u.Payeur)+", le "+$(U(_e).date(u.Time)),1)]),_:2},1024),e(V,{cols:"2",class:"text-right"},{default:t(()=>[y($(u.IsRemboursement?"+":"-")+$(U(_e).montant(u.Montant)),1)]),_:2},1024)]),_:2},1024))),256)),e(h,null,{default:t(()=>[e(V,{cols:"10",class:"text-right"},{default:t(()=>[...d[8]||(d[8]=[y("Solde",-1)])]),_:1}),e(V,{cols:"2",class:"text-right"},{default:t(()=>[T("b",null,$(s.dossier.Bilan.Restant),1)]),_:1})]),_:1})]),_:1})]),_:1},8,["subtitle"]))}});function Be(l){let s=arguments.length>1&&arguments[1]!==void 0?arguments[1]:2;return String(l).padStart(s,"0")}const xn=Ue({allowedValues:Function,ampm:Boolean,color:String,disabled:Boolean,displayedValue:null,double:Boolean,format:{type:Function,default:l=>l},max:{type:Number,required:!0},min:{type:Number,required:!0},scrollable:Boolean,readonly:Boolean,rotate:{type:Number,default:0},step:{type:Number,default:1},modelValue:{type:Number}},"VTimePickerClock"),Wt=Re()({name:"VTimePickerClock",props:xn(),emits:{change:l=>!0,input:l=>!0},setup(l,s){let{emit:o}=s;const v=D(null),a=D(null),i=D(void 0),c=D(!1),n=D(null),d=D(null),u=ea(b=>o("change",b),750),{textColorClasses:r,textColorStyles:m}=ta(()=>l.color),{backgroundColorClasses:p,backgroundColorStyles:k}=Gt(()=>l.color),C=F(()=>l.max-l.min+1),_=F(()=>l.double?C.value/2:C.value),P=F(()=>360/_.value),A=F(()=>P.value*Math.PI/180),q=F(()=>l.modelValue==null?l.min:l.modelValue),Z=F(()=>.62),S=F(()=>{const b=[];for(let O=l.min;O<=l.max;O=O+l.step)b.push(O);return b});Me(()=>l.modelValue,b=>{i.value=b});function f(b){i.value!==b&&(i.value=b),o("input",b)}function K(b){return!l.allowedValues||l.allowedValues(b)}function be(b){if(!l.scrollable||l.disabled)return;b.preventDefault();const O=Math.sign(-b.deltaY||1);let R=q.value;do R=R+O,R=(R-l.min+C.value)%C.value+l.min;while(!K(R)&&R!==q.value);R!==l.displayedValue&&f(R),u(R)}function J(b){return l.double&&b-l.min>=_.value}function I(b){return J(b)?Z.value:1}function te(b){const O=l.rotate*Math.PI/180;return{x:Math.sin((b-l.min)*A.value+O)*I(b),y:-Math.cos((b-l.min)*A.value+O)*I(b)}}function ae(b,O){const R=(Math.round(b/P.value)+(O?_.value:0))%C.value+l.min;return b<360-P.value/2?R:O?l.max-_.value+1:l.min}function N(b){const{x:O,y:R}=te(b);return{left:`${Math.round(50+O*50)}%`,top:`${Math.round(50+R*50)}%`}}function B(b,O){const R=O.x-b.x,ye=O.y-b.y;return Math.sqrt(R*R+ye*ye)}function ue(b,O){const R=2*Math.atan2(O.y-b.y-B(b,O),O.x-b.x);return Math.abs(R*180/Math.PI)}function X(b){n.value===null&&(n.value=b),d.value=b,f(b)}function fe(b){if(b.preventDefault(),!c.value&&b.type!=="click"||!v.value)return;const{width:O,top:R,left:ye}=v.value?.getBoundingClientRect(),{width:ne}=a.value?.getBoundingClientRect()??{width:0},{clientX:Ie,clientY:E}="touches"in b?b.touches[0]:b,H={x:O/2,y:-O/2},de={x:Ie-ye,y:R-E},me=Math.round(ue(H,de)-l.rotate+360)%360,Dt=l.double&&B(H,de)<(ne+ne*Z.value)/4,gl=Math.ceil(15/P.value);let Ye;for(let st=0;st<gl;st++)if(Ye=ae(me+st*P.value,Dt),K(Ye)||(Ye=ae(me-st*P.value,Dt),K(Ye)))return X(Ye)}function ge(b){l.disabled||(b.preventDefault(),window.addEventListener("mousemove",fe),window.addEventListener("touchmove",fe),window.addEventListener("mouseup",M),window.addEventListener("touchend",M),n.value=null,d.value=null,c.value=!0,fe(b))}function M(b){b.stopPropagation(),window.removeEventListener("mousemove",fe),window.removeEventListener("touchmove",fe),window.removeEventListener("mouseup",M),window.removeEventListener("touchend",M),c.value=!1,d.value!==null&&K(d.value)&&o("change",d.value)}Le(()=>T("div",{class:Ve([{"v-time-picker-clock":!0,"v-time-picker-clock--indeterminate":l.modelValue==null,"v-time-picker-clock--readonly":l.readonly}]),onMousedown:ge,onTouchstart:ge,onWheel:be,ref:v},[T("div",{class:"v-time-picker-clock__inner",ref:a},[T("div",{class:Ve([{"v-time-picker-clock__hand":!0,"v-time-picker-clock__hand--inner":J(l.modelValue)},r.value]),style:tt([{transform:`rotate(${l.rotate+P.value*(q.value-l.min)}deg) scaleY(${I(q.value)})`},m.value])},null),S.value.map(b=>{const O=b===q.value;return T("div",{class:Ve([{"v-time-picker-clock__item":!0,"v-time-picker-clock__item--active":O,"v-time-picker-clock__item--disabled":l.disabled||!K(b)},O&&p.value]),style:tt([N(b),O&&k.value])},[T("span",null,[l.format(b)])])})])]))}}),wn=Ue({ampm:Boolean,color:String,disabled:Boolean,hour:Number,minute:Number,second:Number,period:String,readonly:Boolean,useSeconds:Boolean,value:Number,viewMode:String},"VTimePickerControls"),Jt=Re()({name:"VTimePickerControls",props:wn(),emits:{"update:period":l=>!0,"update:viewMode":l=>!0},setup(l,s){let{emit:o,slots:v}=s;const{t:a}=ze();return Le(()=>{let i=l.hour;return l.ampm&&(i=i?(i-1)%12+1:12),T("div",{class:"v-time-picker-controls"},[T("div",{class:Ve({"v-time-picker-controls__time":!0,"v-time-picker-controls__time--with-seconds":l.useSeconds})},[e(L,{active:l.viewMode==="hour",color:l.viewMode==="hour"?l.color:void 0,disabled:l.disabled,variant:"tonal",class:Ve({"v-time-picker-controls__time__btn":!0,"v-time-picker-controls__time--with-ampm__btn":l.ampm,"v-time-picker-controls__time--with-seconds__btn":l.useSeconds}),text:l.hour==null?"--":Be(`${i}`),onClick:()=>o("update:viewMode","hour")},null),T("span",{class:Ve(["v-time-picker-controls__time__separator",{"v-time-picker-controls--with-seconds__time__separator":l.useSeconds}])},[y(":")]),e(L,{active:l.viewMode==="minute",color:l.viewMode==="minute"?l.color:void 0,class:Ve({"v-time-picker-controls__time__btn":!0,"v-time-picker-controls__time__btn__active":l.viewMode==="minute","v-time-picker-controls__time--with-ampm__btn":l.ampm,"v-time-picker-controls__time--with-seconds__btn":l.useSeconds}),disabled:l.disabled,variant:"tonal",text:l.minute==null?"--":Be(l.minute),onClick:()=>o("update:viewMode","minute")},null),l.useSeconds&&T("span",{class:Ve(["v-time-picker-controls__time__separator",{"v-time-picker-controls--with-seconds__time__separator":l.useSeconds}]),key:"secondsDivider"},[y(":")]),l.useSeconds&&e(L,{key:"secondsVal",active:l.viewMode==="second",color:l.viewMode==="second"?l.color:void 0,variant:"tonal",onClick:()=>o("update:viewMode","second"),class:Ve({"v-time-picker-controls__time__btn":!0,"v-time-picker-controls__time__btn__active":l.viewMode==="second","v-time-picker-controls__time--with-seconds__btn":l.useSeconds}),disabled:l.disabled,text:l.second==null?"--":Be(l.second)},null),l.ampm&&T("div",{class:"v-time-picker-controls__ampm"},[e(L,{active:l.period==="am",color:l.period==="am"?l.color:void 0,class:Ve({"v-time-picker-controls__ampm__am":!0,"v-time-picker-controls__ampm__btn":!0,"v-time-picker-controls__ampm__btn__active":l.period==="am"}),disabled:l.disabled,text:a("$vuetify.timePicker.am"),variant:l.disabled&&l.period==="am"?"elevated":"tonal",onClick:()=>l.period!=="am"?o("update:period","am"):null},null),e(L,{active:l.period==="pm",color:l.period==="pm"?l.color:void 0,class:Ve({"v-time-picker-controls__ampm__pm":!0,"v-time-picker-controls__ampm__btn":!0,"v-time-picker-controls__ampm__btn__active":l.period==="pm"}),disabled:l.disabled,text:a("$vuetify.timePicker.pm"),variant:l.disabled&&l.period==="pm"?"elevated":"tonal",onClick:()=>l.period!=="pm"?o("update:period","pm"):null},null)])])])}),{}}}),Dn=he(24),yl=he(12),Sn=yl.map(l=>l+12);he(60);const In=Ue({allowedHours:[Function,Array],allowedMinutes:[Function,Array],allowedSeconds:[Function,Array],disabled:Boolean,format:{type:String,default:"ampm"},max:String,min:String,viewMode:{type:String,default:"hour"},period:{type:String,default:"am",validator:l=>["am","pm"].includes(l)},modelValue:null,readonly:Boolean,scrollable:Boolean,useSeconds:Boolean,...je(nl({title:"$vuetify.timePicker.title"}),["landscape"])},"VTimePicker"),An=Re()({name:"VTimePicker",props:In(),emits:{"update:hour":l=>!0,"update:minute":l=>!0,"update:period":l=>!0,"update:second":l=>!0,"update:modelValue":l=>!0,"update:viewMode":l=>!0},setup(l,s){let{emit:o,slots:v}=s;const{t:a}=ze(),i=D(null),c=D(null),n=D(null),d=D(null),u=D(null),r=D(null),m=$e(l,"period","am"),p=$e(l,"viewMode","hour"),k=D(null),C=D(null),_=F(()=>{let N;if(l.allowedHours instanceof Array?N=X=>l.allowedHours.includes(X):N=l.allowedHours,!l.min&&!l.max)return N;const B=l.min?Number(l.min.split(":")[0]):0,ue=l.max?Number(l.max.split(":")[0]):23;return X=>X>=Number(B)&&X<=Number(ue)&&(!N||N(X))}),P=F(()=>{let N;const B=!_.value||i.value===null||_.value(i.value);if(l.allowedMinutes instanceof Array?N=O=>l.allowedMinutes.includes(O):N=l.allowedMinutes,!l.min&&!l.max)return B?N:()=>!1;const[ue,X]=l.min?l.min.split(":").map(Number):[0,0],[fe,ge]=l.max?l.max.split(":").map(Number):[23,59],M=ue*60+Number(X),b=fe*60+Number(ge);return O=>{const R=60*i.value+O;return R>=M&&R<=b&&B&&(!N||N(O))}}),A=F(()=>{let N;const ue=(!_.value||i.value===null||_.value(i.value))&&(!P.value||c.value===null||P.value(c.value));if(l.allowedSeconds instanceof Array?N=ne=>l.allowedSeconds.includes(ne):N=l.allowedSeconds,!l.min&&!l.max)return ue?N:()=>!1;const[X,fe,ge]=l.min?l.min.split(":").map(Number):[0,0,0],[M,b,O]=l.max?l.max.split(":").map(Number):[23,59,59],R=X*3600+fe*60+Number(ge||0),ye=M*3600+b*60+Number(O||0);return ne=>{const Ie=3600*i.value+60*c.value+ne;return Ie>=R&&Ie<=ye&&ue&&(!N||N(ne))}}),q=F(()=>l.format==="ampm");Me(()=>l.period,N=>I(N)),Me(()=>l.modelValue,N=>be(N)),Oe(()=>{be(l.modelValue)});function Z(){return i.value!=null&&c.value!=null&&(!l.useSeconds||n.value!=null)?`${Be(i.value)}:${Be(c.value)}`+(l.useSeconds?`:${Be(n.value)}`:""):null}function S(){const N=Z();N!==null&&o("update:modelValue",N)}function f(N){return N?(N-1)%12+1:12}function K(N,B){return N%12+(B==="pm"?12:0)}function be(N){if(N==null||N==="")i.value=null,c.value=null,n.value=null;else if(N instanceof Date)i.value=N.getHours(),c.value=N.getMinutes(),n.value=N.getSeconds();else{const[B,,ue,,X,fe]=N.trim().toLowerCase().match(/^(\d+):(\d+)(:(\d+))?([ap]m)?$/)||new Array(6);i.value=fe?K(parseInt(B,10),fe):parseInt(B,10),c.value=parseInt(ue,10),n.value=parseInt(X||0,10)}m.value=i.value==null||i.value<12?"am":"pm"}function J(N,B){const ue=_.value;if(!ue)return B;const X=q.value?B<12?yl:Sn:Dn;return((X.find(ge=>ue((ge+B)%X.length+X[0]))||0)+B)%X.length+X[0]}function I(N){if(m.value=N,i.value!=null){const B=i.value+(m.value==="am"?-12:12);i.value=J("hour",B)}return o("update:period",N),S(),!0}function te(N){p.value==="hour"?i.value=q.value?K(N,m.value):N:p.value==="minute"?c.value=N:n.value=N}function ae(N){switch(p.value||"hour"){case"hour":o("update:hour",N);break;case"minute":o("update:minute",N);break;case"second":o("update:second",N);break}const B=i.value!==null&&c.value!==null&&(l.useSeconds?n.value!==null:!0);p.value==="hour"?p.value="minute":l.useSeconds&&p.value==="minute"&&(p.value="second"),!(i.value===d.value&&c.value===u.value&&(!l.useSeconds||n.value===r.value)||Z()===null)&&(d.value=i.value,u.value=c.value,l.useSeconds&&(r.value=n.value),B&&S())}Le(()=>{const N=mt.filterProps(l),B=Jt.filterProps(l),ue=Wt.filterProps(je(l,["format","modelValue","min","max"]));return e(mt,ie(N,{color:void 0,class:["v-time-picker",l.class],style:l.style}),{title:()=>v.title?.()??T("div",{class:"v-time-picker__title"},[a(l.title)]),header:()=>e(Jt,ie(B,{ampm:q.value,hour:i.value,minute:c.value,period:m.value,second:n.value,viewMode:p.value,"onUpdate:period":X=>I(X),"onUpdate:viewMode":X=>p.value=X,ref:k}),null),default:()=>e(Wt,ie(ue,{allowedValues:p.value==="hour"?_.value:p.value==="minute"?P.value:A.value,double:p.value==="hour"&&!q.value,format:p.value==="hour"?q.value?f:X=>X:X=>Be(X,2),max:p.value==="hour"?q.value&&m.value==="am"?11:23:59,min:p.value==="hour"&&q.value&&m.value==="pm"?12:0,size:20,step:p.value==="hour"?1:5,modelValue:p.value==="hour"?i.value:p.value==="minute"?c.value:n.value,onChange:ae,onInput:te,ref:C}),null),actions:v.actions})})}}),Mn=G({__name:"TimeField",props:De({hideDetails:{type:Boolean},readonly:{type:Boolean}},{modelValue:{required:!0},modelModifiers:{}}),emits:["update:modelValue"],setup(l){const s=l,o=xe(l,"modelValue"),v=F(()=>new Date(o.value).toLocaleTimeString(void 0,{hour:"numeric",minute:"numeric"}));function a(n){const[d,u]=n.split(":"),r=new Date(o.value);r.setHours(Number(d),Number(u)),o.value=r.toISOString()}function i(n){const d=new Date(n),u=new Date(o.value);d.setHours(u.getHours(),u.getMinutes(),u.getSeconds()),o.value=d.toISOString()}const c=D(!1);return(n,d)=>{const u=pl;return g(),w(h,{"no-gutters":""},{default:t(()=>[e(V,null,{default:t(()=>[e(u,{class:"mr-2",label:"Date","model-value":U(tl)(new Date(o.value)),"onUpdate:modelValue":i,"hide-details":s.hideDetails,readonly:s.readonly},null,8,["model-value","hide-details","readonly"])]),_:1}),e(V,{cols:"auto"},{default:t(()=>[...d[1]||(d[1]=[T("div",{class:"ma-2"},null,-1)])]),_:1}),e(V,null,{default:t(()=>[e(Se,{"close-on-content-click":!1,modelValue:c.value,"onUpdate:modelValue":d[0]||(d[0]=r=>c.value=r)},{activator:t(({props:r})=>[e(pe,ie({class:"center-text"},r,{variant:"outlined",density:"compact","hide-details":s.hideDetails,label:"Moment","model-value":v.value}),null,16,["hide-details","model-value"])]),default:t(()=>[e(An,{"model-value":new Date(o.value),"onUpdate:modelValue":a,format:"24hr"},null,8,["model-value"])]),_:1},8,["modelValue"])]),_:1})]),_:1})}}}),$n=Pt(Mn,[["__scopeId","data-v-32955f86"]]),Un=G({__name:"ModePaiementField",props:De({hideDetails:{type:Boolean},readonly:{type:Boolean},rules:{}},{modelValue:{required:!0},modelModifiers:{}}),emits:["update:modelValue"],setup(l){const s=l,o=xe(l,"modelValue"),v=lt(la);return(a,i)=>(g(),w(Te,{label:"Mode de paiement",variant:"outlined",density:"compact",items:U(v),readonly:s.readonly,"hide-details":s.hideDetails,modelValue:o.value,"onUpdate:modelValue":i[0]||(i[0]=c=>o.value=c),rules:s.rules},null,8,["items","readonly","hide-details","modelValue","rules"]))}}),Fn=G({__name:"PaiementEditCard",props:{paiement:{}},emits:["update","delete"],setup(l,{emit:s}){const o=l,v=s,a=D(we(o.paiement)),i=F(()=>!0),c=D(!1);return(n,d)=>{const u=Un,r=Je,m=$n;return g(),w(j,{title:"Modifier le paiement"},{default:t(()=>[e(ee,{modelValue:c.value,"onUpdate:modelValue":d[1]||(d[1]=p=>c.value=p),"max-width":"400px"},{default:t(()=>[e(j,{title:"Confirmation"},{default:t(()=>[e(Y,null,{default:t(()=>[...d[11]||(d[11]=[y(" Confirmez-vous la suppression de ce paiement ? ",-1),T("br",null,null,-1),T("br",null,null,-1),y(" Attention, cette opération est irréversible. ",-1)])]),_:1}),e(re,null,{default:t(()=>[e(se),e(L,{color:"red",onClick:d[0]||(d[0]=p=>{c.value=!1,v("delete")})},{default:t(()=>[...d[12]||(d[12]=[y("Supprimer",-1)])]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"]),e(Y,null,{default:t(()=>[e(h,null,{default:t(()=>[e(V,null,{default:t(()=>[e(pe,{density:"compact",variant:"outlined","hide-details":"",label:"Payé par",modelValue:a.value.Payeur,"onUpdate:modelValue":d[2]||(d[2]=p=>a.value.Payeur=p)},null,8,["modelValue"])]),_:1}),e(V,null,{default:t(()=>[e(pe,{density:"compact",variant:"outlined","hide-details":"",label:"Description (optionelle)",modelValue:a.value.Label,"onUpdate:modelValue":d[3]||(d[3]=p=>a.value.Label=p)},null,8,["modelValue"])]),_:1})]),_:1}),e(h,null,{default:t(()=>[e(V,null,{default:t(()=>[e(u,{modelValue:a.value.Mode,"onUpdate:modelValue":d[4]||(d[4]=p=>a.value.Mode=p),"hide-details":""},null,8,["modelValue"])]),_:1}),e(V,null,{default:t(()=>[e(r,{label:"Montant",modelValue:a.value.Montant,"onUpdate:modelValue":d[5]||(d[5]=p=>a.value.Montant=p),"hide-details":""},null,8,["modelValue"])]),_:1})]),_:1}),e(h,null,{default:t(()=>[e(V,null,{default:t(()=>[e(qe,{"hide-details":"",density:"compact",label:"Remboursement ?",modelValue:a.value.IsRemboursement,"onUpdate:modelValue":d[6]||(d[6]=p=>a.value.IsRemboursement=p)},null,8,["modelValue"])]),_:1})]),_:1}),e(h,null,{default:t(()=>[e(V,null,{default:t(()=>[e(m,{modelValue:a.value.Time,"onUpdate:modelValue":d[7]||(d[7]=p=>a.value.Time=p),"hide-details":""},null,8,["modelValue"])]),_:1})]),_:1}),e(h,null,{default:t(()=>[e(V,null,{default:t(()=>[e(pe,{density:"compact",variant:"outlined",label:"Détails (optionnel)",modelValue:a.value.Details,"onUpdate:modelValue":d[8]||(d[8]=p=>a.value.Details=p)},null,8,["modelValue"])]),_:1})]),_:1})]),_:1}),e(re,null,{default:t(()=>[e(L,{color:"red",onClick:d[9]||(d[9]=p=>c.value=!0)},{default:t(()=>[...d[13]||(d[13]=[y("Supprimer le paiement",-1)])]),_:1}),e(se),e(L,{onClick:d[10]||(d[10]=p=>v("update",a.value)),disabled:!i.value},{default:t(()=>[...d[14]||(d[14]=[y("Enregistrer",-1)])]),_:1},8,["disabled"])]),_:1})]),_:1})}}}),Rn=G({__name:"DossierEditCard",props:{responsable:{},dossier:{}},emits:["save"],setup(l,{emit:s}){const o=l,v=s,a=D(we(o.dossier));return(i,c)=>{const n=ut,d=ha,u=xt;return g(),w(j,null,{default:t(()=>[e(Y,null,{default:t(()=>[e(h,null,{default:t(()=>[e(V,null,{default:t(()=>[e(n,{label:"Responsable","initial-personne":o.responsable,"model-value":a.value.IdResponsable,"onUpdate:modelValue":c[0]||(c[0]=r=>r?a.value.IdResponsable=r:void 0),api:{SelectPersonne:U(x).SelectPersonne.bind(U(x))}},null,8,["initial-personne","model-value","api"])]),_:1})]),_:1}),e(h,null,{default:t(()=>[e(V,null,{default:t(()=>[e(d,{label:"Adresses mail en copie",modelValue:a.value.CopiesMails,"onUpdate:modelValue":c[1]||(c[1]=r=>a.value.CopiesMails=r),rule:U(aa).validMails()},null,8,["modelValue","rule"])]),_:1})]),_:1}),e(h,null,{default:t(()=>[e(V,null,{default:t(()=>[e(u,{"hide-details":"",modelValue:a.value.PartageAdressesOK,"onUpdate:modelValue":c[2]||(c[2]=r=>a.value.PartageAdressesOK=r),label:"Partage des coordonnées"},null,8,["modelValue"])]),_:1})]),_:1}),e(h,null,{default:t(()=>[e(V,null,{default:t(()=>[e(u,{"hide-details":"",modelValue:a.value.DemandeFondSoutien,"onUpdate:modelValue":c[3]||(c[3]=r=>a.value.DemandeFondSoutien=r),label:"Demande le fonds de soutien"},null,8,["modelValue"])]),_:1})]),_:1})]),_:1}),e(re,null,{default:t(()=>[e(se),e(L,{onClick:c[4]||(c[4]=r=>v("save",a.value))},{default:t(()=>[...c[5]||(c[5]=[y("Enregistrer",-1)])]),_:1})]),_:1})]),_:1})}}}),Ln=G({__name:"OptionJournee",props:De({camp:{}},{modelValue:{required:!0},modelModifiers:{}}),emits:["update:modelValue"],setup(l){const s=l,o=xe(l,"modelValue"),v=F(()=>(s.camp.OptionPrix.Jours||[]).map((a,i)=>i));return(a,i)=>(g(),w(j,null,{default:t(()=>[e(Y,null,{default:t(()=>[i[1]||(i[1]=T("div",{class:"text-grey mb-2"}," Le prix est variable en fonction des jours de participation au camp. ",-1)),e(na,{class:"overflow-x-auto",color:"secondary",multiple:"","model-value":o.value?.length?o.value:v.value,"onUpdate:modelValue":i[0]||(i[0]=c=>o.value=c.length==v.value.length?[]:c)},{default:t(()=>[(g(!0),Q(le,null,ce(s.camp.OptionPrix.Jours,(c,n)=>(g(),w(L,null,{default:t(()=>[y("J "+$(n+1),1)]),_:2},1024))),256))]),_:1},8,["model-value"])]),_:1})]),_:1}))}}),hn=G({__name:"OptionStatut",props:De({camp:{}},{modelValue:{required:!0},modelModifiers:{}}),emits:["update:modelValue"],setup(l){const s=l,o=xe(l,"modelValue"),v=F(()=>(s.camp.OptionPrix.Statuts||[]).map(i=>({value:i.Id,title:i.Label,subtitle:i.Description}))),a=F(()=>v.value.map(i=>i.value).includes(o.value));return(i,c)=>(g(),w(j,null,{default:t(()=>[e(Y,null,{default:t(()=>[c[1]||(c[1]=T("div",{class:"text-grey mb-4"},"Le prix dépend du statut du participant.",-1)),e(Te,{clearable:"",items:v.value,label:"Statut","model-value":a.value?o.value:null,"onUpdate:modelValue":c[0]||(c[0]=n=>o.value=n??0),variant:"outlined",density:"comfortable","hide-details":""},{item:t(({item:n,props:d})=>[e(z,ie(d,{title:n.title,subtitle:n.raw.subtitle}),null,16,["title","subtitle"])]),_:1},8,["items","model-value"])]),_:1})]),_:1}))}}),En={key:2},Tn=G({__name:"ParticipantOptionPrix",props:{camp:{},optionAndQf:{}},emits:["update"],setup(l,{emit:s}){const o=l,v=s,a=D(we(o.optionAndQf));return Me(()=>o.optionAndQf,()=>a.value=we(o.optionAndQf)),(i,c)=>{const n=We;return g(),w(j,{title:"Prix variable",width:"800px"},{default:t(()=>[e(Y,null,{default:t(()=>[e(h,{justify:"space-evenly"},{default:t(()=>[e(V,{"align-self":"center",cols:"3"},{default:t(()=>[e(n,{modelValue:a.value.quotientFamilial,"onUpdate:modelValue":c[0]||(c[0]=d=>a.value.quotientFamilial=d),label:"Quotient familial","hide-details":""},null,8,["modelValue"])]),_:1}),e(oe,{thickness:"2",vertical:""}),e(V,{"align-self":"center",cols:"8"},{default:t(()=>[o.camp.OptionPrix.Active==U(Ae).PrixJour?(g(),w(Ln,{key:0,camp:o.camp,modelValue:a.value.options.Jour,"onUpdate:modelValue":c[1]||(c[1]=d=>a.value.options.Jour=d)},null,8,["camp","modelValue"])):o.camp.OptionPrix.Active==U(Ae).PrixStatut?(g(),w(hn,{key:1,camp:o.camp,modelValue:a.value.options.IdStatut,"onUpdate:modelValue":c[2]||(c[2]=d=>a.value.options.IdStatut=d)},null,8,["camp","modelValue"])):(g(),Q("div",En,"Le camp ne propose pas d'option sur le prix."))]),_:1})]),_:1})]),_:1}),e(re,null,{default:t(()=>[e(se),e(L,{onClick:c[3]||(c[3]=d=>v("update",a.value))},{default:t(()=>[...c[4]||(c[4]=[y("Enregistrer",-1)])]),_:1})]),_:1})]),_:1})}}}),On={key:1,class:"mx-1"},Nn={key:2,class:"mx-1"},Bn={key:3},jn={key:4,class:"mx-1"},qn=G({__name:"RemisesChip",props:{remises:{}},emits:["update"],setup(l,{emit:s}){const o=l,v=s,a=F(()=>i.value.ReducEnfants!=0||i.value.ReducEquipiers!=0||i.value.ReducSpeciale.Cent!=0),i=D(we(o.remises));Me(()=>o.remises,()=>i.value=we(o.remises));const c=D(!1);return(n,d)=>{const u=We,r=Je;return g(),w(Se,{"close-on-content-click":!1,location:"bottom",modelValue:c.value,"onUpdate:modelValue":d[4]||(d[4]=m=>c.value=m)},{activator:t(({props:m})=>[e(j,ie(m,{elevation:"1",color:"grey-lighten-2"}),{default:t(()=>[e(Y,{class:"py-1 px-1"},{default:t(()=>[a.value?W("",!0):(g(),Q(le,{key:0},[y(" Pas de remises ")],64)),i.value.ReducEnfants?(g(),Q("span",On," Enfants : "+$(i.value.ReducEnfants)+"% ",1)):W("",!0),i.value.ReducEquipiers?(g(),Q("span",Nn," Equipiers : "+$(i.value.ReducEquipiers)+"% ",1)):W("",!0),(i.value.ReducEnfants||i.value.ReducEquipiers)&&i.value.ReducSpeciale.Cent?(g(),Q("br",Bn)):W("",!0),i.value.ReducSpeciale.Cent?(g(),Q("span",jn," Remise : "+$(U(_e).montant(i.value.ReducSpeciale)),1)):W("",!0)]),_:1})]),_:1},16)]),default:t(()=>[e(j,{title:"Modifier les remises",width:"400px"},{default:t(()=>[e(Y,null,{default:t(()=>[e(h,null,{default:t(()=>[e(V,null,{default:t(()=>[e(u,{modelValue:i.value.ReducEnfants,"onUpdate:modelValue":d[0]||(d[0]=m=>i.value.ReducEnfants=m),label:"Remise enfants","hide-details":"",suffix:"%"},null,8,["modelValue"])]),_:1}),e(V,null,{default:t(()=>[e(u,{modelValue:i.value.ReducEquipiers,"onUpdate:modelValue":d[1]||(d[1]=m=>i.value.ReducEquipiers=m),label:"Remise équipiers","hide-details":"",suffix:"%"},null,8,["modelValue"])]),_:1})]),_:1}),e(h,null,{default:t(()=>[e(V,null,{default:t(()=>[e(r,{class:"mt-2",modelValue:i.value.ReducSpeciale,"onUpdate:modelValue":d[2]||(d[2]=m=>i.value.ReducSpeciale=m),label:"Remise spéciale","hide-details":""},null,8,["modelValue"])]),_:1})]),_:1})]),_:1}),e(re,null,{default:t(()=>[e(se),e(L,{onClick:d[3]||(d[3]=m=>{v("update",i.value),c.value=!1})},{default:t(()=>[...d[5]||(d[5]=[y("Enregistrer",-1)])]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"])}}}),Yn=Pt(qn,[["__scopeId","data-v-01096379"]]),Hn=G({__name:"AideEditCard",props:{aide:{},file:{},structures:{},participant:{}},emits:["save","deleteFile","uploadFile","showStructureaides"],setup(l,{emit:s}){const o=l,v=s,a=D(we(o.aide)),i=F(()=>Object.values(o.structures).map(c=>({value:c.Id,title:c.Nom})));return(c,n)=>{const d=xt,u=Je,r=We,m=Oa;return g(),w(j,{title:"Modifier l'aide extérieure",subtitle:`pour ${U(Ee).label(o.participant.Personne)} - ${U(Ce).label(o.participant.Camp)}`},{append:t(()=>[e(L,{onClick:n[0]||(n[0]=p=>v("showStructureaides"))},{default:t(()=>[e(ve,null,{default:t(()=>[...n[9]||(n[9]=[y("mdi-view-list",-1)])]),_:1}),n[10]||(n[10]=y(" Structures",-1))]),_:1})]),default:t(()=>[e(Y,null,{default:t(()=>[e(h,null,{default:t(()=>[e(V,null,{default:t(()=>[e(Te,{variant:"outlined",density:"comfortable",label:"Structure",items:i.value,modelValue:a.value.IdStructureaide,"onUpdate:modelValue":n[1]||(n[1]=p=>a.value.IdStructureaide=p)},null,8,["items","modelValue"])]),_:1}),e(V,null,{default:t(()=>[e(d,{modelValue:a.value.Valide,"onUpdate:modelValue":n[2]||(n[2]=p=>a.value.Valide=p),label:"Aide validée","hide-details":""},null,8,["modelValue"])]),_:1})]),_:1}),e(h,null,{default:t(()=>[e(V,{"align-self":"center"},{default:t(()=>[e(u,{modelValue:a.value.Valeur,"onUpdate:modelValue":n[3]||(n[3]=p=>a.value.Valeur=p),label:"Montant","hide-details":""},null,8,["modelValue"])]),_:1}),e(V,{"align-self":"center",cols:"auto"},{default:t(()=>[e(d,{"hide-details":"",label:"Par jour",modelValue:a.value.ParJour,"onUpdate:modelValue":n[4]||(n[4]=p=>a.value.ParJour=p)},null,8,["modelValue"])]),_:1}),e(V,{"align-self":"center"},{default:t(()=>[e(r,{label:"Limite",suffix:"jours",modelValue:a.value.NbJoursMax,"onUpdate:modelValue":n[5]||(n[5]=p=>a.value.NbJoursMax=p),disabled:!a.value.ParJour,hint:"0 pour ne pas limiter",min:0,"persistent-hint":""},null,8,["modelValue","disabled"])]),_:1})]),_:1}),e(m,{class:"mt-4",files:o.file?[o.file]:[],title:"Document justificatif","max-docs":1,"in-upload":!1,onDelete:n[6]||(n[6]=p=>v("deleteFile")),onUpload:n[7]||(n[7]=p=>v("uploadFile",p))},null,8,["files"])]),_:1}),e(re,null,{default:t(()=>[e(se),e(L,{onClick:n[8]||(n[8]=p=>v("save",a.value))},{default:t(()=>[...n[11]||(n[11]=[y("Enregistrer",-1)])]),_:1})]),_:1})]),_:1},8,["subtitle"])}}}),zn=G({__name:"StructuresPannel",props:{modelValue:{required:!0},modelModifiers:{}},emits:["update:modelValue"],setup(l){const s=xe(l,"modelValue"),o=F(()=>Object.values(s.value||{}).sort((d,u)=>d.Nom.localeCompare(u.Nom)));async function v(){const d=await x.StructureaideCreate();if(d===void 0)return;x.showMessage("Structure créée avec succès.");const u=s.value||{};u[d.Id]=d,s.value=u,a.value=d}const a=D(null);async function i(){const d=a.value;if(d==null||(a.value=null,await x.StructureaideUpdate(d)===void 0))return;x.showMessage("Structure modifiée avec succès.");const r=s.value||{};r[d.Id]=d,s.value=r}const c=D(null);async function n(){const d=c.value;if(d==null||(c.value=null,await x.StructureaideDelete({id:d.Id})===void 0))return;const r=s.value||{};delete r[d.Id],s.value=r,x.showMessage("Structure supprimée avec succès.")}return(d,u)=>(g(),w(j,{title:"Structures d'aide",subtitle:"Organismes pouvant distribuer une aide extérieure"},{append:t(()=>[e(L,{onClick:v},{prepend:t(()=>[e(ve,{color:"green"},{default:t(()=>[...u[5]||(u[5]=[y("mdi-plus",-1)])]),_:1})]),default:t(()=>[u[6]||(u[6]=y(" Ajouter une structure ",-1))]),_:1})]),default:t(()=>[e(Y,{class:"overflow-y-auto"},{default:t(()=>[(g(!0),Q(le,null,ce(o.value,r=>(g(),w(h,null,{default:t(()=>[e(V,{"align-self":"center"},{default:t(()=>[e(sl,null,{default:t(()=>[y($(r.Nom),1)]),_:2},1024),e(ol,null,{default:t(()=>[y($(r.Immatriculation),1)]),_:2},1024)]),_:2},1024),e(V,{"align-self":"center",style:{"font-size":"smaller"}},{default:t(()=>[(g(!0),Q(le,null,ce(r.Info.split(`
`),m=>(g(),Q("div",null,$(m),1))),256))]),_:2},1024),e(V,{"align-self":"center",cols:"auto"},{default:t(()=>[e(Se,null,{activator:t(({props:m})=>[e(L,ie({icon:"mdi-dots-vertical"},{ref_for:!0},m,{size:"x-small"}),null,16)]),default:t(()=>[e(ke,null,{default:t(()=>[e(z,{title:"Modifier","prepend-icon":"mdi-pencil",onClick:m=>a.value=U(we)(r)},null,8,["onClick"]),e(z,{title:"Supprimer","prepend-icon":"mdi-delete",onClick:m=>c.value=r},null,8,["onClick"])]),_:2},1024)]),_:2},1024)]),_:2},1024)]),_:2},1024))),256))]),_:1}),e(ee,{"model-value":a.value!=null,"onUpdate:modelValue":u[3]||(u[3]=r=>a.value=null),"max-width":"600px"},{default:t(()=>[a.value!=null?(g(),w(j,{key:0,title:"Modifier la structure"},{default:t(()=>[e(Y,null,{default:t(()=>[e(h,null,{default:t(()=>[e(V,null,{default:t(()=>[e(pe,{variant:"outlined",density:"compact",label:"Nom",modelValue:a.value.Nom,"onUpdate:modelValue":u[0]||(u[0]=r=>a.value.Nom=r),"hide-details":""},null,8,["modelValue"])]),_:1}),e(V,null,{default:t(()=>[e(pe,{variant:"outlined",density:"compact",label:"Immatriculation",modelValue:a.value.Immatriculation,"onUpdate:modelValue":u[1]||(u[1]=r=>a.value.Immatriculation=r),"hide-details":""},null,8,["modelValue"])]),_:1})]),_:1}),e(h,null,{default:t(()=>[e(V,null,{default:t(()=>[e(ct,{variant:"outlined",density:"compact",label:"Informations",modelValue:a.value.Info,"onUpdate:modelValue":u[2]||(u[2]=r=>a.value.Info=r),"hide-details":""},null,8,["modelValue"])]),_:1})]),_:1})]),_:1}),e(re,null,{default:t(()=>[e(se),e(L,{onClick:i},{default:t(()=>[...u[7]||(u[7]=[y("Enregistrer",-1)])]),_:1})]),_:1})]),_:1})):W("",!0)]),_:1},8,["model-value"]),e(ee,{"model-value":c.value!=null,"onUpdate:modelValue":u[4]||(u[4]=r=>c.value=null),"max-width":"450px"},{default:t(()=>[c.value!=null?(g(),w(j,{key:0,title:"Confirmation"},{default:t(()=>[e(Y,null,{default:t(()=>[y(" Confirmez-vous la suppression de la structure "+$(c.value.Nom)+" ? ",1),u[8]||(u[8]=T("br",null,null,-1)),u[9]||(u[9]=T("br",null,null,-1)),u[10]||(u[10]=y(" Attention, cette opération est irréversible. ",-1))]),_:1}),e(re,null,{default:t(()=>[e(se),e(L,{color:"red",onClick:n},{default:t(()=>[...u[11]||(u[11]=[y("Supprimer",-1)])]),_:1})]),_:1})]),_:1})):W("",!0)]),_:1},8,["model-value"])]),_:1}))}}),Qn={key:0},Wn={key:1},Jn=G({__name:"DossierParticipantRow",props:De({participant:{},aides:{},aidesFiles:{},hasManyParticipants:{type:Boolean}},{structures:{required:!0},structuresModifiers:{}}),emits:De(["update","delete","createAide","updateAide","deleteAide","deleteFileAide","uploadFileAide","expand"],["update:structures"]),setup(l,{emit:s}){const o=l,v=xe(l,"structures"),a=s,i=F(()=>{const _=Object.values(o.aides||{});return _.sort((P,A)=>P.Id-A.Id),_}),c=F(()=>o.participant.Camp.OptionPrix.Active==Ae.NoOption&&!Ce.isQuotientFamilialActive(o.participant.Camp.OptionQuotientFamilial));function n(_){switch(o.participant.Camp.OptionPrix.Active){case Ae.NoOption:return"Séjour sans option";case Ae.PrixJour:const P=_.Jour?.length||0;return P==0?"Présent tous les jours":`Présent ${P} jour${P>1?"s":""}`;case Ae.PrixStatut:const A=o.participant.Camp.OptionPrix.Statuts?.find(q=>q.Id==_.IdStatut);return A?`Statut ${A.Label}`:"Pas d'option."}}const d=D(!1),u=D(!1),r=F(()=>Object.values(v.value).map(_=>({value:_.Id,title:_.Nom})).sort((_,P)=>_.title.localeCompare(P.title))),m=D(null),p=D(null),k=D(null),C=D(!1);return(_,P)=>(g(),w(h,null,{default:t(()=>[e(V,{"align-self":"center",cols:"3"},{default:t(()=>[e(sl,null,{default:t(()=>[T("a",{href:"/camps",onClick:P[0]||(P[0]=et(A=>U(wt)(o.participant.Participant),["prevent"]))},$(U(Ee).label(o.participant.Personne)),1)]),_:1}),e(ol,null,{default:t(()=>[y($(U(Ce).label(o.participant.Camp)),1)]),_:1})]),_:1}),e(V,{"align-self":"center",cols:"2",class:"text-center"},{default:t(()=>[e(Se,{disabled:c.value,"close-on-content-click":!1,modelValue:d.value,"onUpdate:modelValue":P[2]||(P[2]=A=>d.value=A)},{activator:t(({props:A})=>[e(j,ie(A,{elevation:c.value?0:1,color:"grey-lighten-2"}),{default:t(()=>[e(Y,{class:"py-1 px-1"},{default:t(()=>[c.value?(g(),Q("div",Qn,"Camp sans option")):(g(),Q("div",Wn,[y($(o.participant.Participant.QuotientFamilial?`QF ${o.participant.Participant.QuotientFamilial}.`:"Pas de QF.")+" ",1),P[22]||(P[22]=T("br",null,null,-1)),y(" "+$(n(o.participant.Participant.OptionPrix)),1)]))]),_:1})]),_:1},16,["elevation"])]),default:t(()=>[e(Tn,{camp:o.participant.Camp,"option-and-qf":{options:o.participant.Participant.OptionPrix,quotientFamilial:o.participant.Participant.QuotientFamilial},onUpdate:P[1]||(P[1]=A=>{o.participant.Participant.OptionPrix=A.options,o.participant.Participant.QuotientFamilial=A.quotientFamilial,d.value=!1,a("update",o.participant.Participant)})},null,8,["camp","option-and-qf"])]),_:1},8,["disabled","modelValue"])]),_:1}),e(V,{"align-self":"center",class:"text-center"},{default:t(()=>[i.value.length?W("",!0):(g(),w(Pe,{key:0,label:""},{default:t(()=>[...P[23]||(P[23]=[y("Aucune aide",-1)])]),_:1})),(g(!0),Q(le,null,ce(i.value,A=>(g(),w(Pe,{class:"my-1","prepend-icon":"mdi-cash-plus",color:A.Valide?"green":"orange",onClick:q=>p.value=A},{close:t(()=>[e(ve,{icon:"mdi-close-circle",onClick:et(q=>k.value=A,["stop"])},null,8,["onClick"])]),default:t(()=>[y(" "+$(v.value[A.IdStructureaide].Nom)+" : "+$(U(_e).montant(A.Valeur)),1)]),_:2},1032,["color","onClick"]))),256))]),_:1}),e(V,{"align-self":"center",class:"text-center",cols:"3"},{default:t(()=>[e(Yn,{remises:o.participant.Participant.Remises,onUpdate:P[3]||(P[3]=A=>{o.participant.Participant.Remises=A,a("update",o.participant.Participant)})},null,8,["remises"])]),_:1}),e(V,{"align-self":"center",cols:"auto"},{default:t(()=>[e(Se,{location:"left"},{activator:t(({props:A})=>[e(L,ie(A,{icon:"mdi-dots-vertical",size:"small"}),null,16)]),default:t(()=>[e(ke,{density:"comfortable"},{default:t(()=>[e(z,{title:"Ajouter une aide","prepend-icon":"mdi-cash-plus",onClick:P[4]||(P[4]=A=>m.value={IdParticipant:o.participant.Participant.Id,IdStructure:0})}),e(oe),o.hasManyParticipants?(g(),w(z,{key:0,"prepend-icon":"mdi-arrow-expand",title:"Étendre les options et remises",subtitle:"... au reste du dossier",onClick:P[5]||(P[5]=A=>a("expand"))})):W("",!0),e(oe),e(z,{title:"Supprimer","prepend-icon":"mdi-delete",onClick:P[6]||(P[6]=A=>u.value=!0)})]),_:1})]),_:1})]),_:1}),e(ee,{modelValue:u.value,"onUpdate:modelValue":P[8]||(P[8]=A=>u.value=A),"max-width":"600px"},{default:t(()=>[e(j,{title:"Supprimer le participant"},{default:t(()=>[e(Y,null,{default:t(()=>[...P[24]||(P[24]=[y(" Confirmez-vous la suppression de ce participant ? ",-1),T("br",null,null,-1),y(" Attention, cette opération est irréversible. ",-1)])]),_:1}),e(re,null,{default:t(()=>[e(se),e(L,{color:"red",onClick:P[7]||(P[7]=A=>{a("delete"),u.value=!1})},{default:t(()=>[...P[25]||(P[25]=[y("Supprimer",-1)])]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"]),e(ee,{modelValue:C.value,"onUpdate:modelValue":P[10]||(P[10]=A=>C.value=A),"max-width":"650px"},{default:t(()=>[e(zn,{modelValue:v.value,"onUpdate:modelValue":P[9]||(P[9]=A=>v.value=A)},null,8,["modelValue"])]),_:1},8,["modelValue"]),m.value!=null?(g(),w(ee,{key:0,"model-value":m.value!=null,"onUpdate:modelValue":P[14]||(P[14]=A=>m.value=null),width:"600px"},{default:t(()=>[e(j,{title:"Ajouter une aide extérieure"},{append:t(()=>[e(L,{onClick:P[11]||(P[11]=A=>C.value=!0)},{default:t(()=>[e(ve,null,{default:t(()=>[...P[26]||(P[26]=[y("mdi-view-list",-1)])]),_:1}),P[27]||(P[27]=y(" Structures",-1))]),_:1})]),default:t(()=>[e(Y,null,{default:t(()=>[e(Te,{variant:"outlined",density:"comfortable",label:"Structure",items:r.value,"model-value":m.value.IdStructure==0?null:m.value.IdStructure,"onUpdate:modelValue":P[12]||(P[12]=A=>m.value.IdStructure=A)},null,8,["items","model-value"])]),_:1}),e(re,null,{default:t(()=>[e(se),e(L,{color:"green",onClick:P[13]||(P[13]=A=>{a("createAide",m.value),m.value=null}),disabled:m.value.IdStructure==0},{default:t(()=>[...P[28]||(P[28]=[y("Créer",-1)])]),_:1},8,["disabled"])]),_:1})]),_:1})]),_:1},8,["model-value"])):W("",!0),p.value!=null?(g(),w(ee,{key:1,"model-value":p.value!=null,"onUpdate:modelValue":P[19]||(P[19]=A=>p.value=null),"max-width":"800px"},{default:t(()=>[e(Hn,{aide:p.value,file:l.aidesFiles[p.value.Id],structures:v.value,participant:o.participant,onShowStructureaides:P[15]||(P[15]=A=>C.value=!0),onSave:P[16]||(P[16]=A=>{a("updateAide",A),p.value=null}),onDeleteFile:P[17]||(P[17]=A=>a("deleteFileAide",p.value.Id)),onUploadFile:P[18]||(P[18]=A=>a("uploadFileAide",A,p.value.Id))},null,8,["aide","file","structures","participant"])]),_:1},8,["model-value"])):W("",!0),k.value!=null?(g(),w(ee,{key:2,"model-value":k.value!=null,"onUpdate:modelValue":P[21]||(P[21]=A=>k.value=null),"max-width":"600px"},{default:t(()=>[e(j,{title:"Supprimer l'aide"},{default:t(()=>[e(Y,null,{default:t(()=>[...P[29]||(P[29]=[y(" Confirmez-vous la suppression de l'aide extérieure ? ",-1),T("br",null,null,-1),y(" Attention, cette opération est irréversible. ",-1)])]),_:1}),e(re,null,{default:t(()=>[e(se),e(L,{color:"red",onClick:P[20]||(P[20]=A=>{a("deleteAide",k.value.Id),k.value=null})},{default:t(()=>[...P[30]||(P[30]=[y("Supprimer",-1)])]),_:1})]),_:1})]),_:1})]),_:1},8,["model-value"])):W("",!0)]),_:1}))}}),Gn=G({__name:"DossierEditor",props:{dossier:{},camps:{}},emits:["updateDossier","createParticipant","updateParticipant","deleteParticipant","expandParticipant","createAide","updateAide","deleteAide","deleteFileAide","uploadFileAide"],setup(l,{emit:s}){const o=l,v=s,a=D(null);Oe(n);const i=D(!0),c=D({});async function n(){const d=await x.StructureaidesGet();d!==void 0&&(i.value=!1,c.value=d||{})}return(d,u)=>(g(),w(j,{title:"Modifier le dossier"},{append:t(()=>[e(L,{onClick:u[0]||(u[0]=r=>a.value={IdCamp:0,IdPersonne:0,IdDossier:o.dossier.Dossier.Dossier.Id})},{prepend:t(()=>[e(ve,{color:"green"},{default:t(()=>[...u[9]||(u[9]=[y("mdi-plus",-1)])]),_:1})]),default:t(()=>[u[10]||(u[10]=y(" Ajouter un participant",-1))]),_:1})]),default:t(()=>[e(Y,null,{default:t(()=>[e(h,null,{default:t(()=>[e(V,{cols:"3"},{default:t(()=>[e(Rn,{responsable:o.dossier.Dossier.Responsable,dossier:o.dossier.Dossier.Dossier,onSave:u[1]||(u[1]=r=>v("updateDossier",r))},null,8,["responsable","dossier"])]),_:1}),e(oe,{thickness:"4",vertical:""}),i.value?W("",!0):(g(),w(V,{key:0},{default:t(()=>[u[11]||(u[11]=T("div",{class:"my-1"},null,-1)),(g(!0),Q(le,null,ce(o.dossier.Dossier.Participants,r=>(g(),w(Jn,{participant:r,aides:(o.dossier.Dossier.Aides||{})[r.Participant.Id],"aides-files":o.dossier.Dossier.AidesFiles||{},"has-many-participants":(o.dossier.Dossier.Participants?.length||0)>1,structures:c.value,"onUpdate:structures":u[2]||(u[2]=m=>c.value=m),onCreateAide:u[3]||(u[3]=m=>v("createAide",m)),onDeleteAide:u[4]||(u[4]=m=>v("deleteAide",m)),onUpdateAide:u[5]||(u[5]=m=>v("updateAide",m)),onDeleteFileAide:u[6]||(u[6]=m=>v("deleteFileAide",m)),onUploadFileAide:u[7]||(u[7]=(m,p)=>v("uploadFileAide",m,p)),onUpdate:u[8]||(u[8]=m=>v("updateParticipant",m)),onDelete:m=>v("deleteParticipant",r.Participant.Id),onExpand:m=>v("expandParticipant",r.Participant)},null,8,["participant","aides","aides-files","has-many-participants","structures","onDelete","onExpand"]))),256))]),_:1}))]),_:1})]),_:1})]),_:1}))}}),Kn={class:"mr-1"},Xn=["onClick"],Zn={class:"overflow-y-auto",style:{"max-height":"65vh"}},eu=["href"],tu=G({__name:"DossierDetailsPannel",props:{dossier:{},camps:{}},emits:["updateDossier","deleteDossier","mergeDossier","createParticipant","updateParticipant","deleteParticipant","expandParticipant","createAide","updateAide","deleteAide","deleteFileAide","uploadFileAide","createPaiement","updatePaiement","deletePaiement","sendMessage","deleteMessage","sendFacture"],setup(l,{expose:s,emit:o}){const v=l,a=o;s({showEditPaiement:m,showEditDossier:d});const i=F(()=>ua(v.dossier.Dossier,x.isFondsSoutien?Ut.FondSoutien:Ut.Backoffice)),c=D(!1),n=D(!1);function d(){n.value=!0}const u=D(null),r=D(null);function m(S){r.value=S}const p="Repère",k=D(!1);async function C(){await rt(v.dossier.EspacepersoURL),x.showMessage("Lien vers l'espace personnel copié.")}async function _(){await rt(v.dossier.VirementCode),x.showMessage("Identifiant de virement copié.")}async function P(S){await rt(S),x.showMessage("IBAN copié.")}const A=D(!1),q=D(!1),Z=D("");return(S,f)=>{const K=La,be=it,J=ut;return g(),w(j,{title:`Dossier de ${v.dossier.Dossier.Responsable}`,class:"ml-2"},{subtitle:t(()=>[(g(!0),Q(le,null,ce(v.dossier.Dossier.Participants,I=>(g(),Q("span",Kn,[T("a",{href:"/camps",onClick:et(te=>U(wt)(I.Participant),["prevent"])},$(U(Ee).label(I.Personne)),9,Xn)]))),256))]),append:t(()=>[e(L,{icon:"mdi-pencil",onClick:f[0]||(f[0]=I=>n.value=!0),class:"mx-1"}),e(Se,null,{activator:t(({props:I})=>[e(L,ie(I,{icon:"mdi-dots-vertical",size:"small",class:"mx-1"}),null,16)]),default:t(()=>[e(ke,{density:"compact"},{default:t(()=>[e(z,{"prepend-icon":"mdi-email",onClick:f[1]||(f[1]=I=>q.value=!0),title:"Envoyer un message",subtitle:"Notification par email"}),e(z,{"prepend-icon":"mdi-invoice-send",onClick:f[2]||(f[2]=I=>a("sendFacture")),title:"Envoyer une demande de règlement",subtitle:"Notification par email"}),e(oe),e(z,{"prepend-icon":"mdi-cash-plus",onClick:f[3]||(f[3]=I=>a("createPaiement")),title:"Ajouter un paiement"}),e(oe),e(z,{"prepend-icon":"mdi-link",onClick:f[4]||(f[4]=I=>k.value=!0),title:"Afficher les identifiants"}),e(oe),e(z,{"prepend-icon":"mdi-file-move",onClick:f[5]||(f[5]=I=>A.value=!0),title:"Fusionner vers ..."}),e(oe),e(z,{onClick:f[6]||(f[6]=I=>c.value=!0),title:"Supprimer"},{prepend:t(()=>[e(ve,{color:"red"},{default:t(()=>[...f[35]||(f[35]=[y("mdi-delete",-1)])]),_:1})]),_:1})]),_:1})]),_:1})]),default:t(()=>[e(Y,null,{default:t(()=>[e(h,null,{default:t(()=>[e(V,{class:"ml-2 mb-1 text-center"},{default:t(()=>[e(Se,null,{activator:t(({props:I})=>[e(Pe,ie(I,{"prepend-icon":"mdi-currency-eur",color:U(_e).colorStatutPaiement(v.dossier.Dossier.Bilan.Statut)}),{default:t(()=>[y($(v.dossier.Dossier.Bilan.Recu)+" payé sur "+$(v.dossier.Dossier.Bilan.Demande),1)]),_:1},16,["color"])]),default:t(()=>[e(Pn,{dossier:v.dossier.Dossier},null,8,["dossier"])]),_:1})]),_:1})]),_:1}),T("div",Zn,[e(Ra,{side:"end",class:"mt-4",density:"compact"},{default:t(()=>[(g(!0),Q(le,null,ce(i.value,(I,te)=>(g(),w(K,{event:I,key:te,onEditPaiement:f[7]||(f[7]=ae=>r.value=ae),onDeleteMessage:f[8]||(f[8]=ae=>a("deleteMessage",ae))},null,8,["event"]))),128))]),_:1})])]),_:1}),e(ee,{modelValue:c.value,"onUpdate:modelValue":f[10]||(f[10]=I=>c.value=I),"max-width":"600px"},{default:t(()=>[e(j,{title:"Supprimer le dossier"},{default:t(()=>[e(Y,null,{default:t(()=>[...f[36]||(f[36]=[y(" Confirmez-vous la suppression du dossier et de ses participants ? ",-1),T("br",null,null,-1),T("br",null,null,-1),y(" Attention, cette opération est irréversible. ",-1)])]),_:1}),e(re,null,{default:t(()=>[e(se),e(L,{color:"red",onClick:f[9]||(f[9]=I=>{a("deleteDossier"),c.value=!1})},{default:t(()=>[...f[37]||(f[37]=[y("Supprimer",-1)])]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"]),u.value!=null?(g(),w(ee,{key:0,"model-value":u.value!=null,"onUpdate:modelValue":f[14]||(f[14]=I=>u.value=null),"max-width":"600px"},{default:t(()=>[e(j,{title:"Ajouter un participant"},{default:t(()=>[e(Y,null,{default:t(()=>[e(h,null,{default:t(()=>[e(V,{cols:"12"},{default:t(()=>[e(be,{label:"Camp",camps:v.camps,modelValue:u.value.IdCamp,"onUpdate:modelValue":f[11]||(f[11]=I=>u.value.IdCamp=I)},null,8,["camps","modelValue"])]),_:1}),e(V,{cols:"12"},{default:t(()=>[e(J,{label:"Personne","initial-personne":"",modelValue:u.value.IdPersonne,"onUpdate:modelValue":f[12]||(f[12]=I=>u.value.IdPersonne=I),api:{SelectPersonne:U(x).SelectPersonne.bind(U(x))}},null,8,["modelValue","api"])]),_:1})]),_:1})]),_:1}),e(re,null,{default:t(()=>[e(se),e(L,{color:"green",disabled:u.value.IdPersonne==0||u.value.IdCamp==0,onClick:f[13]||(f[13]=I=>{a("createParticipant",u.value),u.value=null})},{default:t(()=>[...f[38]||(f[38]=[y("Ajouter",-1)])]),_:1},8,["disabled"])]),_:1})]),_:1})]),_:1},8,["model-value"])):W("",!0),e(ee,{modelValue:n.value,"onUpdate:modelValue":f[25]||(f[25]=I=>n.value=I)},{default:t(()=>[e(Gn,{dossier:v.dossier,camps:v.camps,onUpdateDossier:f[15]||(f[15]=I=>a("updateDossier",I)),onCreateParticipant:f[16]||(f[16]=I=>a("createParticipant",I)),onUpdateParticipant:f[17]||(f[17]=I=>a("updateParticipant",I)),onDeleteParticipant:f[18]||(f[18]=I=>a("deleteParticipant",I)),onExpandParticipant:f[19]||(f[19]=I=>a("expandParticipant",I)),onCreateAide:f[20]||(f[20]=I=>a("createAide",I)),onUpdateAide:f[21]||(f[21]=I=>a("updateAide",I)),onDeleteAide:f[22]||(f[22]=I=>a("deleteAide",I)),onDeleteFileAide:f[23]||(f[23]=I=>a("deleteFileAide",I)),onUploadFileAide:f[24]||(f[24]=(I,te)=>a("uploadFileAide",I,te))},null,8,["dossier","camps"])]),_:1},8,["modelValue"]),r.value!=null?(g(),w(ee,{key:1,"model-value":r.value!=null,"onUpdate:modelValue":f[28]||(f[28]=I=>r.value=null),"max-width":"600px"},{default:t(()=>[e(Fn,{paiement:r.value,onUpdate:f[26]||(f[26]=I=>{a("updatePaiement",I),r.value=null}),onDelete:f[27]||(f[27]=I=>{a("deletePaiement",r.value),r.value=null})},null,8,["paiement"])]),_:1},8,["model-value"])):W("",!0),e(ee,{modelValue:k.value,"onUpdate:modelValue":f[29]||(f[29]=I=>k.value=I),"max-width":"800px"},{default:t(()=>[e(j,{title:"Liens et identifiants"},{default:t(()=>[e(Y,null,{default:t(()=>[e(h,null,{default:t(()=>[e(V,{cols:"3"},{default:t(()=>[...f[39]||(f[39]=[y("Espace personnel",-1)])]),_:1}),e(V,{class:"text-truncate"},{default:t(()=>[T("a",{href:v.dossier.EspacepersoURL,target:"_blank"},$(v.dossier.EspacepersoURL),9,eu)]),_:1}),e(V,{"align-self":"center",cols:"auto"},{default:t(()=>[e(L,{size:"small",icon:"mdi-content-copy",onClick:C})]),_:1})]),_:1}),(g(!0),Q(le,null,ce(v.dossier.BankAccounts,I=>(g(),w(h,null,{default:t(()=>[e(V,{cols:"3"},{default:t(()=>[y("RIB ("+$(U(p))+")",1)]),_:1}),e(V,{cols:"3"},{default:t(()=>[y($(I[0]),1)]),_:2},1024),e(V,null,{default:t(()=>[y($(I[1]),1)]),_:2},1024),e(V,{"align-self":"center",cols:"auto"},{default:t(()=>[e(L,{size:"small",icon:"mdi-content-copy",onClick:()=>P(I[1])},null,8,["onClick"])]),_:2},1024)]),_:2},1024))),256)),e(h,null,{default:t(()=>[e(V,{cols:"3"},{default:t(()=>[...f[40]||(f[40]=[y("Identification de virement",-1)])]),_:1}),e(V,null,{default:t(()=>[y($(v.dossier.VirementCode),1)]),_:1}),e(V,{"align-self":"center",cols:"auto"},{default:t(()=>[e(L,{size:"small",icon:"mdi-content-copy",onClick:_})]),_:1})]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"]),e(ee,{modelValue:A.value,"onUpdate:modelValue":f[31]||(f[31]=I=>A.value=I),"max-width":"600px"},{default:t(()=>[e(fl,{from:v.dossier.Dossier.Dossier.Id,onMerge:f[30]||(f[30]=I=>{a("mergeDossier",I),A.value=!1})},null,8,["from"])]),_:1},8,["modelValue"]),e(ee,{modelValue:q.value,"onUpdate:modelValue":f[34]||(f[34]=I=>q.value=I),"max-width":"600px"},{default:t(()=>[e(j,{title:"Nouveau message",subtitle:"Envoie un message sur le fil de suivi et une notification par mail."},{default:t(()=>[e(Y,null,{default:t(()=>[e(h,null,{default:t(()=>[e(V,null,{default:t(()=>[e(ct,{rows:"5",variant:"outlined",modelValue:Z.value,"onUpdate:modelValue":f[32]||(f[32]=I=>Z.value=I)},null,8,["modelValue"])]),_:1})]),_:1})]),_:1}),e(re,null,{default:t(()=>[e(se),e(L,{disabled:!Z.value.length,onClickOnce:f[33]||(f[33]=I=>{a("sendMessage",Z.value),q.value=!1})},{default:t(()=>[...f[41]||(f[41]=[y("Envoyer",-1)])]),_:1},8,["disabled"])]),_:1})]),_:1})]),_:1},8,["modelValue"])]),_:1},8,["title"])}}}),lu=G({__name:"CreateDossierCard",emits:["create"],setup(l,{emit:s}){const o=s,v=D(0);return(a,i)=>{const c=ut;return g(),w(j,{title:"Créer un dossier"},{default:t(()=>[e(Y,null,{default:t(()=>[e(h,null,{default:t(()=>[e(V,null,{default:t(()=>[e(c,{label:"Responsable légal",modelValue:v.value,"onUpdate:modelValue":i[0]||(i[0]=n=>v.value=n),"initial-personne":"",api:{SelectPersonne:U(x).SelectPersonne.bind(U(x))}},null,8,["modelValue","api"])]),_:1})]),_:1})]),_:1}),e(re,null,{default:t(()=>[e(se),e(L,{color:"green",disabled:v.value==0,onClick:i[1]||(i[1]=n=>o("create",v.value))},{default:t(()=>[...i[2]||(i[2]=[y("Créer",-1)])]),_:1},8,["disabled"])]),_:1})]),_:1})}}}),au=G({__name:"DossierList",props:De({camps:{},allowFondsSoutien:{type:Boolean},selected:{}},{query:{required:!0},queryModifiers:{}}),emits:De(["click","update"],["update:query"]),setup(l,{expose:s,emit:o}){const v=l,a=o,i=xe(l,"query");s({searchDossiers:n}),Me(()=>i.value,n,{immediate:!0});const c=D(null);async function n(){const d=await x.DossiersSearch(i.value);d!==void 0&&(c.value=d,a("update",d))}return(d,u)=>{const r=it,m=il;return g(),Q("div",null,[e(h,null,{default:t(()=>[e(V,{"align-self":"center"},{default:t(()=>[e(m,{density:"compact",variant:"outlined","prepend-inner-icon":"mdi-magnify",label:"Rechercher un dossier","hide-details":"",clearable:"",modelValue:i.value.Pattern,"onUpdate:modelValue":[u[5]||(u[5]=p=>i.value.Pattern=p),n]},{"append-inner":t(()=>[i.value.IdCamp.Valid?(g(),w(Pe,{key:0,class:"ml-1",size:"small","prepend-icon":"mdi-bed"},{default:t(()=>[y($(v.camps.find(p=>p.Id==i.value.IdCamp.Id)?.Label),1)]),_:1})):W("",!0),i.value.Attente!=U(da).EmptyQA?(g(),w(Pe,{key:1,class:"ml-1",size:"small","prepend-icon":"mdi-clock"},{default:t(()=>[y($(U(Ft)[i.value.Attente]),1)]),_:1})):W("",!0),i.value.Reglement!=U(ma).EmptyQR?(g(),w(Pe,{key:2,class:"ml-1",size:"small","prepend-icon":"mdi-currency-eur"},{default:t(()=>[y($(U(Rt)[i.value.Reglement]),1)]),_:1})):W("",!0),i.value.OnlyFondSoutien?(g(),w(Pe,{key:3,class:"ml-1",size:"small"},{default:t(()=>[...u[6]||(u[6]=[y(" Fonds de soutien ",-1)])]),_:1})):W("",!0)]),append:t(()=>[e(Se,{location:"left top","close-on-content-click":!1},{activator:t(({props:p})=>[e(L,ie(p,{size:"small",variant:"flat",icon:""}),{default:t(()=>[e(ve,null,{default:t(()=>[...u[7]||(u[7]=[y("mdi-filter-cog",-1)])]),_:1}),e(He,{activator:"parent",text:"Autres critères de recherche"})]),_:1},16)]),default:t(()=>[e(j,{"min-width":"400px",title:"Filtrer les dossiers"},{default:t(()=>[e(Y,null,{default:t(()=>[e(h,null,{default:t(()=>[e(V,null,{default:t(()=>[e(r,{label:"Camp",camps:v.camps,"model-value":U(oa)(U(ra)(i.value.IdCamp)),"onUpdate:modelValue":u[0]||(u[0]=p=>{i.value.IdCamp=U(ia)(U(sa)(p)),n()})},null,8,["camps","model-value"])]),_:1})]),_:1}),e(h,null,{default:t(()=>[e(V,null,{default:t(()=>[e(Te,{density:"compact",variant:"outlined",label:"Liste d'attente",modelValue:i.value.Attente,"onUpdate:modelValue":[u[1]||(u[1]=p=>i.value.Attente=p),n],items:U(lt)(U(Ft)),"hide-details":""},null,8,["modelValue","items"])]),_:1})]),_:1}),e(h,null,{default:t(()=>[e(V,null,{default:t(()=>[e(Te,{density:"compact",variant:"outlined",label:"Réglement",modelValue:i.value.Reglement,"onUpdate:modelValue":[u[2]||(u[2]=p=>i.value.Reglement=p),n],items:U(lt)(U(Rt)),"hide-details":""},null,8,["modelValue","items"])]),_:1})]),_:1}),e(h,null,{default:t(()=>[e(V,null,{default:t(()=>[e(Vt,{label:"Trier selon les nouveaux messages",hint:"Affiche les nouveaux messages en premier.","persistent-hint":"",density:"compact",color:"light-blue-darken-3",modelValue:i.value.SortByNewMessages,"onUpdate:modelValue":[u[3]||(u[3]=p=>i.value.SortByNewMessages=p),n]},null,8,["modelValue"])]),_:1})]),_:1}),v.allowFondsSoutien?(g(),w(h,{key:0},{default:t(()=>[e(V,null,{default:t(()=>[e(Vt,{label:"Fonds de soutien",hint:"N'affiche que les dossiers demandant le fonds de soutien.","persistent-hint":"",density:"compact",color:"orange",modelValue:i.value.OnlyFondSoutien,"onUpdate:modelValue":[u[4]||(u[4]=p=>i.value.OnlyFondSoutien=p),n]},null,8,["modelValue"])]),_:1})]),_:1})):W("",!0)]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"])]),_:1})]),_:1}),c.value!=null?(g(),w(ke,{key:0,class:"mt-2",selected:v.selected?[v.selected]:void 0},{default:t(()=>[c.value.Dossiers?.length?W("",!0):(g(),w(z,{key:0,class:"text-center"},{default:t(()=>[...u[8]||(u[8]=[T("i",null,"Aucun dossier ne correspond à votre recherche.",-1)])]),_:1})),(g(!0),Q(le,null,ce(c.value.Dossiers,(p,k)=>(g(),w(z,{rounded:"",key:k,title:p.Responsable,subtitle:p.Participants,value:p.Id,onClick:C=>a("click",p),class:"my-1"},pt({_:2},[p.NewMessages?{name:"append",fn:t(()=>[e($a,{color:"light-blue-darken-3",content:p.NewMessages},null,8,["content"])]),key:"0"}:void 0]),1032,["title","subtitle","value","onClick"]))),128))]),_:1},8,["selected"])):W("",!0)])}}}),nu=G({__name:"SendDocumentsCampCard",props:{camps:{}},emits:["send"],setup(l,{emit:s}){const o=l,v=s,a=D(0),i=D(null);async function c(){const u=await x.EventsSendDocumentsCampPreview({idCamp:a.value});u!==void 0&&(i.value=u,n.value=(u.Dossiers||[]).filter(r=>!r.DocumentsSent).map(r=>r.Id))}const n=D([]),d=F(()=>n.value.length==(i.value?.Dossiers||[]).length);return(u,r)=>{const m=it;return g(),w(j,{title:"Envoyer les documents d'un séjour"},{default:t(()=>[e(Y,null,{default:t(()=>[e(h,null,{default:t(()=>[e(V,{"align-self":"center",cols:"5"},{default:t(()=>[e(m,{camps:o.camps,label:"Séjour",modelValue:a.value,"onUpdate:modelValue":[r[0]||(r[0]=p=>a.value=p),c]},null,8,["camps","modelValue"])]),_:1}),e(V,{"align-self":"center"},{default:t(()=>[i.value?(g(),w(j,{key:0,subtitle:"Dossiers à contacter"},pt({default:t(()=>[e(Y,null,{default:t(()=>[e(ke,{selectable:"",selected:n.value,"onUpdate:selected":r[2]||(r[2]=p=>n.value=p),"select-strategy":"leaf"},{default:t(()=>[(g(!0),Q(le,null,ce(i.value.Dossiers,p=>(g(),w(z,{title:p.Responsable,subtitle:p.Participants,value:p.Id,rounded:"",class:"my-1"},{append:t(({isSelected:k,select:C})=>[e(h,null,{default:t(()=>[e(V,null,{default:t(()=>[p.DocumentsSent?(g(),w(Pe,{key:0,color:"green",class:"mr-2"},{default:t(()=>[...r[4]||(r[4]=[y("Envoyés",-1)])]),_:1})):W("",!0)]),_:2},1024),e(V,null,{default:t(()=>[e(rl,{density:"compact","hide-details":"","model-value":k,"onUpdate:modelValue":C},null,8,["model-value","onUpdate:modelValue"])]),_:2},1024)]),_:2},1024)]),_:2},1032,["title","subtitle","value"]))),256))]),_:1},8,["selected"])]),_:1})]),_:2},[i.value.Dossiers?.length?{name:"append",fn:t(()=>[e(qe,{label:"Tout sélectionner",density:"compact","hide-details":"",indeterminate:!!n.value.length&&n.value.length!=(i.value.Dossiers||[]).length,"model-value":n.value.length==(i.value.Dossiers||[]).length,"onUpdate:modelValue":r[1]||(r[1]=p=>n.value=d.value?[]:(i.value.Dossiers||[]).map(k=>k.Id))},null,8,["indeterminate","model-value"])]),key:"0"}:void 0]),1024)):W("",!0)]),_:1})]),_:1})]),_:1}),e(re,null,{default:t(()=>[e(se),e(L,{disabled:!a.value||!n.value.length,onClick:r[3]||(r[3]=p=>v("send",a.value,n.value))},{append:t(()=>[e(ve,null,{default:t(()=>[...r[5]||(r[5]=[y("mdi-send",-1)])]),_:1})]),default:t(()=>[r[6]||(r[6]=y(" Envoyer ",-1))]),_:1},8,["disabled"])]),_:1})]),_:1})}}}),uu=G({__name:"SendRelancePaiementCard",props:{camps:{}},emits:["send"],setup(l,{emit:s}){const o=l,v=s,a=D(0),i=D([]);async function c(){const u=await x.EventsSendRelancePaiementPreview({idCamp:a.value});u!==void 0&&(i.value=u||[],n.value=(u||[]).map(r=>r.Id))}const n=D([]),d=F(()=>n.value.length==i.value.length);return(u,r)=>{const m=it;return g(),w(j,{title:"Envoyer une relance de paiement"},{default:t(()=>[e(Y,null,{default:t(()=>[e(h,null,{default:t(()=>[e(V,{"align-self":"center",cols:"5"},{default:t(()=>[e(m,{camps:o.camps,label:"Séjour",modelValue:a.value,"onUpdate:modelValue":[r[0]||(r[0]=p=>a.value=p),c]},null,8,["camps","modelValue"])]),_:1}),e(V,{"align-self":"center"},{default:t(()=>[i.value?(g(),w(j,{key:0,subtitle:"Dossiers à relancer"},pt({default:t(()=>[e(Y,null,{default:t(()=>[e(ke,{selectable:"",selected:n.value,"onUpdate:selected":r[2]||(r[2]=p=>n.value=p),"select-strategy":"leaf",density:"comfortable"},{default:t(()=>[(g(!0),Q(le,null,ce(i.value,(p,k)=>(g(),w(z,{key:p.Id,title:p.Responsable,subtitle:U(ca)(p.LastEventFacture)?"":`Dernière demande : ${U(_e).time(p.LastEventFacture)}`,value:p.Id,rounded:"",class:"my-1"},{append:t(({isSelected:C,select:_})=>[e(h,null,{default:t(()=>[e(V,{"align-self":"center"},{default:t(()=>[e(Pe,{class:"mr-2",color:U(_e).colorStatutPaiement(p.Bilan.Statut)},{default:t(()=>[y($(p.Bilan.Recu)+" / "+$(p.Bilan.Demande),1)]),_:2},1032,["color"])]),_:2},1024),e(V,{"align-self":"center"},{default:t(()=>[e(rl,{density:"compact","hide-details":"","model-value":C,"onUpdate:modelValue":_},null,8,["model-value","onUpdate:modelValue"])]),_:2},1024)]),_:2},1024)]),_:2},1032,["title","subtitle","value"]))),128))]),_:1},8,["selected"])]),_:1})]),_:2},[i.value.length?{name:"append",fn:t(()=>[e(qe,{label:"Tout sélectionner",density:"compact","hide-details":"",indeterminate:!!n.value.length&&n.value.length!=i.value.length,"model-value":n.value.length==i.value.length,"onUpdate:modelValue":r[1]||(r[1]=p=>n.value=d.value?[]:i.value.map(k=>k.Id))},null,8,["indeterminate","model-value"])]),key:"0"}:void 0]),1024)):W("",!0)]),_:1})]),_:1})]),_:1}),e(re,null,{default:t(()=>[e(se),e(L,{disabled:!a.value||!n.value.length,onClick:r[3]||(r[3]=p=>v("send",a.value,n.value))},{append:t(()=>[e(ve,null,{default:t(()=>[...r[4]||(r[4]=[y("mdi-send",-1)])]),_:1})]),default:t(()=>[r[5]||(r[5]=y(" Envoyer ",-1))]),_:1},8,["disabled"])]),_:1})]),_:1})}}}),iu={key:1,class:"text-center font-italic my-6"},su=G({__name:"PannelDossiers",props:{initialDossier:{}},setup(l){const s=l;Oe(()=>{c(),s.initialDossier!==void 0&&r(s.initialDossier)}),Me(()=>s.initialDossier,()=>{s.initialDossier!==void 0&&r(s.initialDossier)});const o=Lt("detailsPannel"),v=D(null),a=D(Ia()),i=D([]);async function c(){const E=await x.GetCamps();E!==void 0&&(i.value=E||[])}function n(E){v.value={length:E.Dossiers?.length||0,total:E.Total}}const d=Lt("dossierList");function u(){d.value?.searchDossiers()}async function r(E){await p(E),a.value=Aa(E)}const m=D(null);async function p(E){const H=await x.DossiersLoad({id:E});H!==void 0&&(m.value=H)}async function k(E){p(E.Id),await x.EventsMarkMessagesSeen({idDossier:E.Id})!==void 0&&u()}async function C(){m.value!=null&&p(m.value.Dossier.Dossier.Id)}const _=D(!1);async function P(E){_.value=!1;const H=await x.DossiersCreate({idResponsable:E});H!==void 0&&(x.showMessage("Dossier créé avec succès."),await r(H.Id),o.value?.showEditDossier())}async function A(E){const H=await x.DossiersUpdate(E);H!==void 0&&(x.showMessage("Dossier mis à jour avec succès."),m.value!=null&&(m.value.Dossier.Dossier=E,m.value.Dossier.Responsable=H.Responsable),u())}async function q(){if(m.value==null)return;const E=m.value.Dossier.Dossier.Id;await x.DossiersDelete({id:E})!==void 0&&(x.showMessage("Dossier supprimé avec succès."),m.value=null,u())}async function Z(E){await x.DossiersMerge(E)!==void 0&&(x.showMessage("Dossier fusionné avec succès."),u(),p(E.To))}async function S(E){await x.ParticipantsCreate(E)!==void 0&&(x.showMessage("Participant ajouté avec succès."),C())}async function f(E){await x.ParticipantsUpdate(E)!==void 0&&(x.showMessage("Réglages du participant modifiés avec succès."),C())}async function K(E){await x.ParticipantsDelete({id:E})!==void 0&&(x.showMessage("Participant supprimé avec succès."),C())}async function be(E){if(m.value==null)return;const H=m.value.Dossier.Participants?.map(me=>me.Participant).filter(me=>me.Id!=E.Id)||[];!H.length||(H.forEach(me=>{me.Remises=E.Remises,me.QuotientFamilial=E.QuotientFamilial,me.IdCamp==E.IdCamp&&(me.OptionPrix=E.OptionPrix)}),(await Promise.all(H.map(me=>x.ParticipantsUpdate(me)))).includes(void 0))||(x.showMessage("Réglages des participants modifiés avec succès."),C())}async function J(E){const H=await x.AidesCreate(E);if(H===void 0||(x.showMessage("Aide ajoutée avec succès."),m.value==null))return;const de=m.value.Dossier.Aides||{},me=de[E.IdParticipant]||{};me[H.Id]=H,de[E.IdParticipant]=me,m.value.Dossier.Aides=de}async function I(E){await x.AidesUpdate(E)!==void 0&&(x.showMessage("Aide modifiée avec succès."),C())}async function te(E){await x.AidesJustificatifDelete({idAide:E})!==void 0&&(x.showMessage("Justificatif supprimé avec succès."),m.value!=null&&m.value.Dossier.AidesFiles&&delete m.value.Dossier.AidesFiles[E])}async function ae(E,H){const de=await x.AidesJustificatifUpload(E,{idAide:H});if(de!==void 0&&(x.showMessage("Justificatif téléversé avec succès."),m.value!=null)){const me=m.value.Dossier.AidesFiles||{};me[H]=de,m.value.Dossier.AidesFiles=me}}async function N(E){await x.AidesDelete({id:E})!==void 0&&(x.showMessage("Aide supprimée avec succès."),C())}async function B(){if(m.value==null)return;const E=await x.PaiementsCreate({idDossier:m.value.Dossier.Dossier.Id});E!==void 0&&(x.showMessage("Paiement créé avec succès."),C(),o.value?.showEditPaiement(E))}async function ue(E){await x.PaiementsUpdate(E)!==void 0&&(x.showMessage("Paiement modifié avec succès."),C())}async function X(E){await x.PaiementsDelete({id:E.Id})!==void 0&&(x.showMessage("Paiement supprimé avec succès."),C())}async function fe(E){m.value==null||await x.EventsSendMessage({IdDossier:m.value.Dossier.Dossier.Id,Contenu:E})===void 0||(x.showMessage("Message envoyé avec succès."),C())}async function ge(E){await x.EventsDelete({id:E.Id})!==void 0&&(x.showMessage("Message supprimé avec succès."),C())}async function M(){m.value==null||await x.EventsSendFacture({idDossier:m.value.Dossier.Dossier.Id})===void 0||(x.showMessage("Demande de règlement envoyé avec succès."),C())}const b=D(!1),O=D(null);async function R(E,H){O.value={Current:0,Total:H.length};const de=await x.EventsSendDocumentsCamp({IdCamp:E,IdDossiers:H});if(de===void 0){O.value=null;return}await gt(de,me=>O.value=me,me=>x.onError("Envoi des documents",me)),O.value=null,C(),x.showMessage("Documents du séjour envoyés avec succès.")}const ye=D(!1),ne=D(null);async function Ie(E,H){ne.value={Current:0,Total:H.length};const de=await x.EventsSendRelancePaiement({IdDossiers:H});if(de===void 0){ne.value=null;return}await gt(de,me=>ne.value=me,me=>x.onError("Envoi de la relance",me)),ne.value=null,C(),x.showMessage("Toutes les relances ont été envoyées avec succès.")}return(E,H)=>(g(),w(h,{"no-gutters":"",class:"ma-2"},{default:t(()=>[e(V,{cols:"6"},{default:t(()=>[e(j,{title:"Dossiers",subtitle:v.value==null?"-":`${v.value.length} affiché(s) / ${v.value.total}`},{append:t(()=>[e(L,{icon:"",size:"small",onClick:H[0]||(H[0]=de=>_.value=!0)},{default:t(()=>[e(ve,{color:"green"},{default:t(()=>[...H[7]||(H[7]=[y("mdi-plus",-1)])]),_:1})]),_:1}),e(oe,{thickness:"1",vertical:"",class:"mx-2"}),e(L,{size:"small"},{prepend:t(()=>[e(ve,null,{default:t(()=>[...H[8]||(H[8]=[y("mdi-send-circle-outline",-1)])]),_:1})]),default:t(()=>[H[9]||(H[9]=y(" Actions ",-1)),e(Se,{activator:"parent"},{default:t(()=>[e(ke,null,{default:t(()=>[e(z,{title:"Documents...",subtitle:"Paramétrer et envoyer les documents d'un séjour","prepend-icon":"mdi-mail",onClick:H[1]||(H[1]=de=>b.value=!0)}),e(oe),e(z,{title:"Relance de paiement...",subtitle:"Paramétrer et envoyer une relance, pour un séjour","prepend-icon":"mdi-invoice-send",onClick:H[2]||(H[2]=de=>ye.value=!0)})]),_:1})]),_:1})]),_:1})]),default:t(()=>[e(Y,null,{default:t(()=>[e(au,{camps:i.value,"allow-fonds-soutien":U(x).isFondsSoutien,selected:m.value?.Dossier.Dossier.Id,query:a.value,"onUpdate:query":H[3]||(H[3]=de=>a.value=de),onClick:k,onUpdate:n,ref_key:"dossierList",ref:d},null,8,["camps","allow-fonds-soutien","selected","query"])]),_:1})]),_:1},8,["subtitle"])]),_:1}),e(V,{cols:"6"},{default:t(()=>[m.value!=null?(g(),w(tu,{key:0,dossier:m.value,camps:i.value,onUpdateDossier:A,onDeleteDossier:q,onMergeDossier:Z,onCreateParticipant:S,onUpdateParticipant:f,onDeleteParticipant:K,onExpandParticipant:be,onCreateAide:J,onDeleteAide:N,onUpdateAide:I,onDeleteFileAide:te,onUploadFileAide:ae,onCreatePaiement:B,onUpdatePaiement:ue,onDeletePaiement:X,onSendMessage:fe,onDeleteMessage:ge,onSendFacture:M,ref_key:"detailsPannel",ref:o},null,8,["dossier","camps"])):(g(),Q("div",iu," Sélectionner un dossier... "))]),_:1}),e(ee,{modelValue:_.value,"onUpdate:modelValue":H[4]||(H[4]=de=>_.value=de),"max-width":"400px"},{default:t(()=>[e(lu,{onCreate:P})]),_:1},8,["modelValue"]),e(ee,{modelValue:b.value,"onUpdate:modelValue":H[5]||(H[5]=de=>b.value=de),"max-width":"1000px"},{default:t(()=>[e(nu,{camps:i.value,onSend:R},null,8,["camps"])]),_:1},8,["modelValue"]),e(ee,{modelValue:ye.value,"onUpdate:modelValue":H[6]||(H[6]=de=>ye.value=de),"max-width":"1000px"},{default:t(()=>[e(uu,{camps:i.value,onSend:Ie},null,8,["camps"])]),_:1},8,["modelValue"]),e(ee,{"model-value":O.value!=null,"max-width":"400px",persistent:""},{default:t(()=>[O.value?(g(),w(kt,{key:0,title:"Envoi des documents en cours",current:O.value.Current,total:O.value.Total},null,8,["current","total"])):W("",!0)]),_:1},8,["model-value"]),e(ee,{"model-value":ne.value!=null,"max-width":"400px",persistent:""},{default:t(()=>[ne.value?(g(),w(kt,{key:0,title:"Envoi des relances en cours",current:ne.value.Current,total:ne.value.Total},null,8,["current","total"])):W("",!0)]),_:1},8,["model-value"])]),_:1}))}}),ou=G({__name:"inscriptions",setup(l){const s=nt(),o=F(()=>pu(s.currentRoute.value.query)),v=F(()=>o.value.tab||"insc"),a=F(()=>o.value.idDossier);function i(c){const n=s.currentRoute.value;s.push({path:n.path,query:{tab:c}})}return(c,n)=>(g(),Q(le,null,[e(ft,{title:"Suivi des inscriptions"},{default:t(()=>[e(Fa,{"model-value":v.value,"onUpdate:modelValue":n[0]||(n[0]=d=>i(d))},{default:t(()=>[e(Ot,{value:"insc"},{default:t(()=>[...n[2]||(n[2]=[y("Inscriptions en attente",-1)])]),_:1}),e(Ot,{value:"doss"},{default:t(()=>[...n[3]||(n[3]=[y("Suivi des dossiers",-1)])]),_:1})]),_:1},8,["model-value"])]),_:1}),e(Ua,{"model-value":v.value},{default:t(()=>[e(Nt,{value:"insc"},{default:t(()=>[e(Vn,{onGoTo:U(_t),onEmpty:n[1]||(n[1]=d=>U(_t)())},null,8,["onGoTo"])]),_:1}),e(Nt,{value:"doss"},{default:t(()=>[e(su,{"initial-dossier":a.value},null,8,["initial-dossier"])]),_:1})]),_:1},8,["model-value"])],64))}}),ru=G({__name:"PersonneEdit",props:{personne:{}},emits:["save"],setup(l,{emit:s}){const o=l,v=s,a=D(we(o.personne)),i=F(()=>!!(a.value.Nom&&a.value.Prenom));return(c,n)=>{const d=Ea,u=Ta;return g(),w(j,{title:"Editer le profil"},{default:t(()=>[e(Y,null,{default:t(()=>[e(Na,null,{default:t(()=>[e(h,null,{default:t(()=>[e(V,null,{default:t(()=>[e(pe,{autofocus:"","hide-details":"",label:"Nom",density:"compact",variant:"outlined",modelValue:a.value.Nom,"onUpdate:modelValue":n[0]||(n[0]=r=>a.value.Nom=r)},null,8,["modelValue"])]),_:1}),e(V,null,{default:t(()=>[e(pe,{"hide-details":"",label:"Prénom",density:"compact",variant:"outlined",modelValue:a.value.Prenom,"onUpdate:modelValue":n[1]||(n[1]=r=>a.value.Prenom=r)},null,8,["modelValue"])]),_:1}),e(V,null,{default:t(()=>[e(d,{modelValue:a.value.Sexe,"onUpdate:modelValue":n[2]||(n[2]=r=>a.value.Sexe=r)},null,8,["modelValue"])]),_:1}),e(V,null,{default:t(()=>[e(u,{modelValue:a.value.DateNaissance,"onUpdate:modelValue":n[3]||(n[3]=r=>a.value.DateNaissance=r)},null,8,["modelValue"])]),_:1})]),_:1})]),_:1})]),_:1}),e(re,null,{default:t(()=>[e(se),e(L,{disabled:!i.value,onClick:n[4]||(n[4]=r=>v("save",a.value))},{default:t(()=>[...n[5]||(n[5]=[y("Enregistrer",-1)])]),_:1},8,["disabled"])]),_:1})]),_:1})}}}),du=G({__name:"annuaire",setup(l){const s=nt(),o=F(()=>fu(s.currentRoute.value.query)),v=F(()=>o.value.idPersonne);Me(()=>v.value,()=>v.value!==void 0?r(v.value):null,{immediate:!0});const a=D([]),i=D("");async function c(){if(!i.value)return;const m=await x.PersonnesGet({search:i.value});m!==void 0&&(a.value=m||[])}async function n(){const m=await x.PersonnesCreate();m!==void 0&&(x.showMessage("Profil créé avec succès."),a.value.push(m),Ke(m.Id))}const d=D(null);async function u(m){d.value=null;const p=await x.PersonnesUpdate(m);if(p===void 0)return;x.showMessage("Profil modifié avec succès."),Ke();const k=a.value.findIndex(C=>C.Id==m.Id);a.value[k]=p}async function r(m){const p=await x.PersonnesLoad({id:m});p!==void 0&&(d.value=p)}return(m,p)=>{const k=il;return g(),Q(le,null,[e(ft,{title:"Annuaire : personnes et organismes"},{default:t(()=>[...p[2]||(p[2]=[y(" TODO ",-1)])]),_:1}),e(j,{class:"ma-2"},{append:t(()=>[e(L,{color:"green",onClick:n},{default:t(()=>[...p[3]||(p[3]=[y("Créer un nouveau profil",-1)])]),_:1})]),default:t(()=>[e(Y,null,{default:t(()=>[e(h,null,{default:t(()=>[e(V,null,{default:t(()=>[e(k,{"prepend-inner-icon":"mdi-magnify",label:"Recherche",modelValue:i.value,"onUpdate:modelValue":[p[0]||(p[0]=C=>i.value=C),c]},null,8,["modelValue"]),e(ke,null,{default:t(()=>[(g(!0),Q(le,null,ce(a.value,C=>(g(),w(z,{title:C.Label,subtitle:U(_e).dateNaissance(C.DateNaissance),"prepend-icon":U(_e).sexeIcon(C.Sexe),onClick:_=>U(Ke)(C.Id)},pt({_:2},[C.IsTemp?{name:"append",fn:t(()=>[e(Pe,{"prepend-icon":"mdi-alert",color:"warning"},{default:t(()=>[...p[4]||(p[4]=[y(" Ce profil est temporaire et devrait être identifié. ",-1)])]),_:1})]),key:"0"}:void 0]),1032,["title","subtitle","prepend-icon","onClick"]))),256))]),_:1})]),_:1}),e(V)]),_:1})]),_:1}),d.value!=null?(g(),w(ee,{key:0,"model-value":d.value!=null,"onUpdate:modelValue":p[1]||(p[1]=C=>{d.value=null,U(Ke)(void 0)}),"max-width":"800px"},{default:t(()=>[e(ru,{personne:d.value,onSave:u},null,8,["personne"])]),_:1},8,["model-value"])):W("",!0)]),_:1})],64)}}}),mu=[{path:"/",component:Ba},{path:"/camps",component:yn},{path:"/inscriptions",component:ou},{path:"/annuaire",component:du}],cu="/backoffice",Ge=ga({history:Va(cu),routes:mu});Ge.onError((l,s)=>{l?.message?.includes?.("Failed to fetch dynamically imported module")?localStorage.getItem("vuetify:dynamic-reload")?console.error("Dynamic import error, reloading page did not fix it",l):(console.log("Reloading page to fix dynamic import error"),localStorage.setItem("vuetify:dynamic-reload","true"),location.assign(s.fullPath)):console.error(l)});Ge.isReady().then(()=>{localStorage.removeItem("vuetify:dynamic-reload")});function vt(l){return l?Number(l):void 0}function vu(l){const s=l;return{idCamp:vt(s.idCamp),idParticipant:vt(s.idParticipant)}}function wt(l){Ge.push({path:"/camps",query:{idCamp:l.IdCamp,idParticipant:l.Id}})}function pu(l){const s=l;return{tab:s.tab,idDossier:vt(s.idDossier)}}function _t(l){Ge.push({path:"/inscriptions",query:{tab:"doss",idDossier:l}})}function fu(l){return{idPersonne:vt(l.idPersonne)}}function Ke(l){Ge.push({path:"/annuaire",query:{idPersonne:l}})}const yu=["innerHTML"],bu=G({__name:"App",setup(l){const s=bt({text:"",color:"secondary",action:void 0,timeout:4e3}),o=D(""),v=D("");return x.onError=(i,c)=>{o.value=i,v.value=c},x.showMessage=(i,c,n)=>{s.text=i,s.color=c||"success",s.action=n,s.timeout=1e4,s.timeout=4e3},nt().beforeEach(async(i,c)=>{if(!x.hasToken()&&i.path!=="/")return{path:"/"}}),(i,c)=>{const n=va("router-view");return g(),w(fa,null,{default:t(()=>[e(pa,null,{default:t(()=>[e(n),e(ht,{style:{"z-index":"10000"},app:"","model-value":s.text!="","onUpdate:modelValue":c[1]||(c[1]=d=>s.text=""),timeout:s.timeout,color:s.color,location:"bottom left","close-on-content-click":""},{default:t(()=>[y($(s.text)+" ",1),s.action?(g(),w(L,{key:0,onClick:c[0]||(c[0]=d=>s.action.action()),class:"ml-2"},{default:t(()=>[y($(s.action.title),1)]),_:1})):W("",!0)]),_:1},8,["model-value","timeout","color"]),e(ht,{app:"","model-value":o.value!="","onUpdate:modelValue":c[2]||(c[2]=d=>o.value=""),timeout:4e3,color:"red"},{default:t(()=>[T("b",null,$(o.value),1),T("div",{innerHTML:v.value},null,8,yu)]),_:1},8,["model-value"])]),_:1})]),_:1})}}}),bl=ya(bu);bl.use(ba).use(Ge);bl.mount("#app");
