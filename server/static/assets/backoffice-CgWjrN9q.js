import{d as Z,r as D,c as N,a as Q,F as le,b as e,w as t,V as gl,e as _,f as w,g as W,h as bl,i as q,j as f,k as Vl,t as T,l as kl,m as E,o as p,n as O,p as Cl,q as Ue,s as Ae,u as Fe,v as Oe,x as kt,I as he,y as Wt,M as Jt,z as Gt,A as fe,E as xl,B as Ye,C as Le,D as ut,G as Xe,H as $e,J as Ie,K as je,L as Re,N as Kt,O as ae,P as Pl,Q as Ee,R as yt,S as dt,T as Xt,U as wl,W as xe,X as ke,Y as F,Z as Zt,_ as me,$ as Ce,a0 as et,a1 as _e,a2 as be,a3 as it,a4 as el,a5 as De,a6 as Ve,a7 as Dl,a8 as Sl,a9 as Il,aa as Ml,ab as tl,ac as tt,ad as Al,ae as $l,af as Ul,ag as It,ah as Fl,ai as Rl,aj as Ll,ak as Tl,al as El,am as Nl,an as hl,ao as Ol,ap as Bl,aq as ql,ar as Mt,as as _t,at as ll,au as jl,av as gt,aw as zl,ax as Te,ay as Hl,az as Ze,aA as Ql,aB as Yl,aC as Wl,aD as Jl,aE as Gl,aF as At,aG as pt,aH as Kl,aI as Xl,aJ as Zl,aK as ea,aL as $t,aM as Ut,aN as ta,aO as la,aP as mt,aQ as aa,aR as Ft,aS as na,aT as ua,aU as Rt,aV as ia,aW as sa,aX as oa}from"./VSnackbar--Whjvjaq.js";import{c as k,V as ra,a as da,u as lt,b as st,m as al,d as ma,i as Lt,_ as ca,e as ct,f as nl,g as va,h as at,j as pa,k as fa,l as ya,n as ul,o as Tt,p as _a,q as ga,r as ba,s as Va}from"./VSwitch-DTaYwiPv.js";import{V as K,a as re,b as Y,c as J,d as ce,e as se,f as ie,g as Pe,h as ze,i as te,j as we,k as ye,l as Be,m as ot,n as Et,o as il,p as sl,q as ol}from"./VTextarea-CO0IE_yp.js";import{_ as We,V as ka,a as Ca,b as xa,c as Nt,d as ht}from"./VTabs-D_kyzDPx.js";import{_ as Je,a as Pa,V as wa,b as Da}from"./EventSwitch.vue_vue_type_script_setup_true_lang-CKZMyUU7.js";import{_ as Ct}from"./_plugin-vue_export-helper-DlAUqK2U.js";import{V as xt}from"./FileCard.vue_vue_type_script_setup_true_lang-C4k0psNR.js";import{V as rl}from"./filter-DH6O22m2.js";import{_ as Sa,a as Ia,b as Ma}from"./SexeField.vue_vue_type_script_setup_true_lang-D_Nd6Kg2.js";import{_ as Aa}from"./FilesRow.vue_vue_type_script_setup_true_lang-B4aTo-0Z.js";import"./VSheet-BH_ObSVw.js";import"./VWindowItem-DGtVTXXk.js";const vt=Z({__name:"NavBar",props:{title:{},hideMenu:{type:Boolean}},setup(l){const o="/static/repere/logo.png",r="v0.3.0",m=D(!1),a=l,s=N(()=>k.isFondSoutien);return(d,n)=>(p(),Q(le,null,[e(ra,{app:"",modelValue:m.value,"onUpdate:modelValue":n[0]||(n[0]=u=>m.value=u),temporary:""},{default:t(()=>[e(K,{title:s.value?"Registro - Fond de soutien":"Registro - Backoffice",subtitle:r},null,8,["title"]),e(re),e(K,{"prepend-icon":"mdi-bed",link:"",to:{path:"/camps"},color:"primary"},{default:t(()=>n[2]||(n[2]=[_(" Séjours ")])),_:1,__:[2]}),e(K,{"prepend-icon":"mdi-calendar-multiple-check",link:"",to:{path:"/inscriptions"},color:"primary"},{default:t(()=>n[3]||(n[3]=[_(" Inscriptions ")])),_:1,__:[3]}),e(re),e(K,{"prepend-icon":"mdi-account-multiple",link:"",to:{path:"/annuaire"},color:"primary"},{default:t(()=>n[4]||(n[4]=[_(" Annuaire ")])),_:1,__:[4]}),e(re),e(K,{"prepend-icon":"mdi-logout",link:"",to:{path:"/"},color:"primary"},{default:t(()=>n[5]||(n[5]=[_(" Se déconnecter ")])),_:1,__:[5]})]),_:1},8,["modelValue"]),e(gl,{rounded:"",elevation:"4",color:"secondary"},{append:t(()=>[kl(d.$slots,"default"),n[6]||(n[6]=E("div",{class:"mr-2"},null,-1))]),default:t(()=>[d.hideMenu?W("",!0):(p(),w(da,{key:0,onClick:n[1]||(n[1]=u=>m.value=!m.value)})),e(bl,null,{default:t(()=>[e(q,null,{default:t(()=>[e(f,{"align-self":"center",cols:"auto"},{default:t(()=>[e(Vl,{width:"60",src:o})]),_:1}),e(f,{"align-self":"center"},{default:t(()=>[_(T(a.title),1)]),_:1})]),_:1})]),_:1})]),_:3})],64))}}),$a=Z({__name:"index",setup(l){const o=lt(),r=D(!1),m=D(""),a=D([]);async function s(){const d=await k.Loggin({password:m.value});d!==void 0&&(d.IsValid?(k.setToken(d.Token,d.IsFondSoutien),k.showMessage("Bienvenue !"),o.push({path:"/camps"})):a.value=["Clé de connection incorrecte."])}return(d,n)=>(p(),Q(le,null,[e(vt,{title:"Connection au backoffice","hide-menu":""}),e(Cl,{class:"fill-height"},{default:t(()=>[e(Y,{class:"mx-auto",width:"400px"},{default:t(()=>[e(J,null,{default:t(()=>[e(ce,{label:"Clé de connection",modelValue:m.value,"onUpdate:modelValue":n[1]||(n[1]=u=>m.value=u),"error-messages":a.value,type:r.value?void 0:"password",name:"password"},{"append-inner":t(()=>[e(O,{class:"ml-2",size:"small",icon:r.value?"mdi-eye":"mdi-eye-off",flat:"",onClick:n[0]||(n[0]=u=>r.value=!r.value)},null,8,["icon"])]),_:1},8,["modelValue","error-messages","type"])]),_:1}),e(se,null,{default:t(()=>[e(ie),e(O,{disabled:!m.value.length,onClick:s},{default:t(()=>n[2]||(n[2]=[_("Se connecter")])),_:1,__:[2]},8,["disabled"])]),_:1})]),_:1})]),_:1})],64))}}),dl=Ae({active:{type:[String,Array],default:void 0},controlHeight:[Number,String],disabled:{type:[Boolean,String,Array],default:null},nextIcon:{type:he,default:"$next"},prevIcon:{type:he,default:"$prev"},modeIcon:{type:he,default:"$subgroup"},text:String,viewMode:{type:String,default:"month"}},"VDatePickerControls"),Ot=Ue()({name:"VDatePickerControls",props:dl(),emits:{"click:year":()=>!0,"click:month":()=>!0,"click:prev":()=>!0,"click:next":()=>!0,"click:text":()=>!0},setup(l,o){let{emit:r}=o;const m=N(()=>Array.isArray(l.disabled)?l.disabled.includes("text"):!!l.disabled),a=N(()=>Array.isArray(l.disabled)?l.disabled.includes("mode"):!!l.disabled),s=N(()=>Array.isArray(l.disabled)?l.disabled.includes("prev"):!!l.disabled),d=N(()=>Array.isArray(l.disabled)?l.disabled.includes("next"):!!l.disabled);function n(){r("click:prev")}function u(){r("click:next")}function i(){r("click:year")}function v(){r("click:month")}return Fe(()=>E("div",{class:["v-date-picker-controls"],style:Oe({"--v-date-picker-controls-height":kt(l.controlHeight)})},[e(O,{class:"v-date-picker-controls__month-btn","data-testid":"month-btn",disabled:m.value,text:l.text,variant:"text",rounded:!0,onClick:v},null),e(O,{class:"v-date-picker-controls__mode-btn","data-testid":"year-btn",disabled:a.value,density:"comfortable",icon:l.modeIcon,variant:"text",onClick:i},null),e(ie,null,null),E("div",{class:"v-date-picker-controls__month"},[e(O,{"data-testid":"prev-month",disabled:s.value,density:"comfortable",icon:l.prevIcon,variant:"text",onClick:n},null),e(O,{"data-testid":"next-month",disabled:d.value,icon:l.nextIcon,density:"comfortable",variant:"text",onClick:u},null)])])),{}}}),Ua=Ae({appendIcon:he,color:String,header:String,transition:String,onClick:xl()},"VDatePickerHeader"),Bt=Ue()({name:"VDatePickerHeader",props:Ua(),emits:{click:()=>!0,"click:append":()=>!0},setup(l,o){let{emit:r,slots:m}=o;const{backgroundColorClasses:a,backgroundColorStyles:s}=Wt(()=>l.color);function d(){r("click")}function n(){r("click:append")}return Fe(()=>{const u=!!(m.default||l.header),i=!!(m.append||l.appendIcon);return E("div",{class:fe(["v-date-picker-header",{"v-date-picker-header--clickable":!!l.onClick},a.value]),style:Oe(s.value),onClick:d},[m.prepend&&E("div",{key:"prepend",class:"v-date-picker-header__prepend"},[m.prepend()]),u&&e(Jt,{key:"content",name:l.transition},{default:()=>{var v;return[E("div",{key:l.header,class:"v-date-picker-header__content"},[((v=m.default)==null?void 0:v.call(m))??l.header])]}}),i&&E("div",{class:"v-date-picker-header__append"},[m.append?e(Gt,{key:"append-defaults",disabled:!l.appendIcon,defaults:{VBtn:{icon:l.appendIcon,variant:"text"}}},{default:()=>{var v;return[(v=m.append)==null?void 0:v.call(m)]}}):e(O,{key:"append-btn",icon:l.appendIcon,variant:"text",onClick:n},null)])])}),{}}}),Fa=Ae({allowedDates:[Array,Function],disabled:{type:Boolean,default:null},displayValue:null,modelValue:Array,month:[Number,String],max:null,min:null,showAdjacentMonths:Boolean,year:[Number,String],weekdays:{type:Array,default:()=>[0,1,2,3,4,5,6]},weeksInMonth:{type:String,default:"dynamic"},firstDayOfWeek:{type:[Number,String],default:void 0}},"calendar");function Ra(l){const o=Ye(),r=Le(l,"modelValue",[],V=>ut(V).map(P=>o.date(P))),m=N(()=>l.displayValue?o.date(l.displayValue):r.value.length>0?o.date(r.value[0]):l.min?o.date(l.min):Array.isArray(l.allowedDates)?o.date(l.allowedDates[0]):o.date()),a=Le(l,"year",void 0,V=>{const P=V!=null?Number(V):o.getYear(m.value);return o.startOfYear(o.setYear(o.date(),P))},V=>o.getYear(V)),s=Le(l,"month",void 0,V=>{const P=V!=null?Number(V):o.getMonth(m.value),M=o.setYear(o.startOfMonth(o.date()),o.getYear(a.value));return o.setMonth(M,P)},V=>o.getMonth(V)),d=N(()=>{const V=o.toJsDate(o.startOfWeek(o.date(),l.firstDayOfWeek)).getDay();return[0,1,2,3,4,5,6].map(P=>(P+V)%7)}),n=N(()=>{const V=o.getWeekArray(s.value,l.firstDayOfWeek),P=V.flat(),M=6*7;if(l.weeksInMonth==="static"&&P.length<M){const C=P[P.length-1];let b=[];for(let $=1;$<=M-P.length;$++)b.push(o.addDays(C,$)),$%7===0&&(V.push(b),b=[])}return V});function u(V,P){return V.filter(M=>d.value.includes(o.toJsDate(M).getDay())).map((M,C)=>{const b=o.toISO(M),$=!o.isSameMonth(M,s.value),R=o.isSameDay(M,o.startOfMonth(s.value)),I=o.isSameDay(M,o.endOfMonth(s.value)),g=o.isSameDay(M,s.value);return{date:M,formatted:o.format(M,"keyboardDate"),isAdjacent:$,isDisabled:c(M),isEnd:I,isHidden:$&&!l.showAdjacentMonths,isSame:g,isSelected:r.value.some(de=>o.isSameDay(M,de)),isStart:R,isToday:o.isSameDay(M,P),isWeekEnd:C%7===6,isWeekStart:C%7===0,isoDate:b,localized:o.format(M,"dayOfMonth"),month:o.getMonth(M),year:o.getYear(M)}})}const i=N(()=>{const V=o.startOfWeek(m.value,l.firstDayOfWeek),P=[];for(let C=0;C<=6;C++)P.push(o.addDays(V,C));const M=o.date();return u(P,M)}),v=N(()=>{const V=n.value.flat(),P=o.date();return u(V,P)}),y=N(()=>n.value.map(V=>V.length?o.getWeek(V[0],l.firstDayOfWeek):null));function c(V){if(l.disabled)return!0;const P=o.date(V);return l.min&&o.isAfter(o.date(l.min),P)||l.max&&o.isAfter(P,o.date(l.max))?!0:Array.isArray(l.allowedDates)&&l.allowedDates.length>0?!l.allowedDates.some(M=>o.isSameDay(o.date(M),P)):typeof l.allowedDates=="function"?!l.allowedDates(P):!l.weekdays.includes(o.toJsDate(P).getDay())}return{displayValue:m,daysInMonth:v,daysInWeek:i,genDays:u,model:r,weeksInMonth:n,weekDays:d,weekNumbers:y}}const ml=Ae({color:String,hideWeekdays:Boolean,multiple:[Boolean,Number,String],showWeek:Boolean,transition:{type:String,default:"picker-transition"},reverseTransition:{type:String,default:"picker-reverse-transition"},...je(Fa(),["displayValue"])},"VDatePickerMonth"),qt=Ue()({name:"VDatePickerMonth",props:ml(),emits:{"update:modelValue":l=>!0,"update:month":l=>!0,"update:year":l=>!0},setup(l,o){let{emit:r,slots:m}=o;const a=D(),{daysInMonth:s,model:d,weekNumbers:n}=Ra(l),u=Ye(),i=Xe(),v=Xe(),y=Xe(!1),c=$e(()=>y.value?l.reverseTransition:l.transition);l.multiple==="range"&&d.value.length>0&&(i.value=d.value[0],d.value.length>1&&(v.value=d.value[d.value.length-1]));const V=N(()=>{const b=["number","string"].includes(typeof l.multiple)?Number(l.multiple):1/0;return d.value.length>=b});Ie(s,(b,$)=>{$&&(y.value=u.isBefore(b[0].date,$[0].date))});function P(b){const $=u.startOfDay(b);if(d.value.length===0?i.value=void 0:d.value.length===1&&(i.value=d.value[0],v.value=void 0),!i.value)i.value=$,d.value=[i.value];else if(v.value)i.value=b,v.value=void 0,d.value=[i.value];else{if(u.isSameDay($,i.value)){i.value=void 0,d.value=[];return}else u.isBefore($,i.value)?(v.value=u.endOfDay(i.value),i.value=$):v.value=u.endOfDay($);const R=u.getDiff(v.value,i.value,"days"),I=[i.value];for(let g=1;g<R;g++){const de=u.addDays(i.value,g);I.push(de)}I.push(v.value),d.value=I}}function M(b){const $=d.value.findIndex(R=>u.isSameDay(R,b));if($===-1)d.value=[...d.value,b];else{const R=[...d.value];R.splice($,1),d.value=R}}function C(b){l.multiple==="range"?P(b):l.multiple?M(b):d.value=[b]}Fe(()=>E("div",{class:"v-date-picker-month"},[l.showWeek&&E("div",{key:"weeks",class:"v-date-picker-month__weeks"},[!l.hideWeekdays&&E("div",{key:"hide-week-days",class:"v-date-picker-month__day"},[_(" ")]),n.value.map(b=>E("div",{class:["v-date-picker-month__day","v-date-picker-month__day--adjacent"]},[b]))]),e(Jt,{name:c.value},{default:()=>{var b;return[E("div",{ref:a,key:(b=s.value[0].date)==null?void 0:b.toString(),class:"v-date-picker-month__days"},[!l.hideWeekdays&&u.getWeekdays(l.firstDayOfWeek).map($=>E("div",{class:["v-date-picker-month__day","v-date-picker-month__weekday"]},[$])),s.value.map(($,R)=>{var g;const I={props:{class:"v-date-picker-month__day-btn",color:$.isSelected||$.isToday?l.color:void 0,disabled:$.isDisabled,icon:!0,ripple:!1,text:$.localized,variant:$.isSelected?"flat":$.isToday?"outlined":"text",onClick:()=>C($.date)},item:$,i:R};return V.value&&!$.isSelected&&($.isDisabled=!0),E("div",{class:fe(["v-date-picker-month__day",{"v-date-picker-month__day--adjacent":$.isAdjacent,"v-date-picker-month__day--hide-adjacent":$.isHidden,"v-date-picker-month__day--selected":$.isSelected,"v-date-picker-month__day--week-end":$.isWeekEnd,"v-date-picker-month__day--week-start":$.isWeekStart}]),"data-v-date":$.isDisabled?void 0:$.isoDate},[(l.showAdjacentMonths||!$.isAdjacent)&&(((g=m.day)==null?void 0:g.call(m,I))??e(O,I.props,null))])})])]}})]))}}),cl=Ae({color:String,height:[String,Number],min:null,max:null,modelValue:Number,year:Number},"VDatePickerMonths"),jt=Ue()({name:"VDatePickerMonths",props:cl(),emits:{"update:modelValue":l=>!0},setup(l,o){let{emit:r,slots:m}=o;const a=Ye(),s=Le(l,"modelValue"),d=N(()=>{let n=a.startOfYear(a.date());return l.year&&(n=a.setYear(n,l.year)),Re(12).map(u=>{const i=a.format(n,"monthShort"),v=!!(l.min&&a.isAfter(a.startOfMonth(a.date(l.min)),n)||l.max&&a.isAfter(n,a.startOfMonth(a.date(l.max))));return n=a.getNextMonth(n),{isDisabled:v,text:i,value:u}})});return Kt(()=>{s.value=s.value??a.getMonth(a.date())}),Fe(()=>E("div",{class:"v-date-picker-months",style:Oe({height:kt(l.height)})},[E("div",{class:"v-date-picker-months__content"},[d.value.map((n,u)=>{var y;const i={active:s.value===u,color:s.value===u?l.color:void 0,disabled:n.isDisabled,rounded:!0,text:n.text,variant:s.value===n.value?"flat":"text",onClick:()=>v(u)};function v(c){if(s.value===c){r("update:modelValue",s.value);return}s.value=c}return((y=m.month)==null?void 0:y.call(m,{month:n,i:u,props:i}))??e(O,ae({key:"month"},i),null)})])])),{}}}),vl=Ae({color:String,height:[String,Number],min:null,max:null,modelValue:Number},"VDatePickerYears"),zt=Ue()({name:"VDatePickerYears",props:vl(),emits:{"update:modelValue":l=>!0},setup(l,o){let{emit:r,slots:m}=o;const a=Ye(),s=Le(l,"modelValue"),d=N(()=>{const u=a.getYear(a.date());let i=u-100,v=u+52;l.min&&(i=a.getYear(a.date(l.min))),l.max&&(v=a.getYear(a.date(l.max)));let y=a.startOfYear(a.date());return y=a.setYear(y,i),Re(v-i+1,i).map(c=>{const V=a.format(y,"year");return y=a.setYear(y,a.getYear(y)+1),{text:V,value:c}})});Kt(()=>{s.value=s.value??a.getYear(a.date())});const n=Pl();return Ee(async()=>{var u;await yt(),(u=n.el)==null||u.scrollIntoView({block:"center"})}),Fe(()=>E("div",{class:"v-date-picker-years",style:Oe({height:kt(l.height)})},[E("div",{class:"v-date-picker-years__content"},[d.value.map((u,i)=>{var y;const v={ref:s.value===u.value?n:void 0,active:s.value===u.value,color:s.value===u.value?l.color:void 0,rounded:!0,text:u.text,variant:s.value===u.value?"flat":"text",onClick:()=>{if(s.value===u.value){r("update:modelValue",s.value);return}s.value=u.value}};return((y=m.year)==null?void 0:y.call(m,{year:u,i,props:v}))??e(O,ae({key:"month"},v),null)})])])),{}}}),La=Ae({header:{type:String,default:"$vuetify.datePicker.header"},headerColor:String,...dl(),...ml({weeksInMonth:"static"}),...je(cl(),["modelValue"]),...je(vl(),["modelValue"]),...al({title:"$vuetify.datePicker.title"}),modelValue:null},"VDatePicker"),Ta=Ue()({name:"VDatePicker",props:La(),emits:{"update:modelValue":l=>!0,"update:month":l=>!0,"update:year":l=>!0,"update:viewMode":l=>!0},setup(l,o){let{emit:r,slots:m}=o;const a=Ye(),{t:s}=dt(),{rtlClasses:d}=Xt(),n=Le(l,"modelValue",void 0,L=>ut(L).map(A=>a.date(A)),L=>l.multiple?L:L[0]),u=Le(l,"viewMode"),i=N(()=>{const L=a.date(l.min);return l.min&&a.isValid(L)?L:null}),v=N(()=>{const L=a.date(l.max);return l.max&&a.isValid(L)?L:null}),y=N(()=>{var z;const L=a.date();let A=L;return(z=n.value)!=null&&z[0]?A=a.date(n.value[0]):i.value&&a.isBefore(L,i.value)?A=i.value:v.value&&a.isAfter(L,v.value)&&(A=v.value),A&&a.isValid(A)?A:L}),c=$e(()=>l.headerColor??l.color),V=D(Number(l.month??a.getMonth(a.startOfMonth(y.value)))),P=D(Number(l.year??a.getYear(a.startOfYear(a.setMonth(y.value,V.value))))),M=Xe(!1),C=N(()=>l.multiple&&n.value.length>1?s("$vuetify.datePicker.itemsSelected",n.value.length):n.value[0]&&a.isValid(n.value[0])?a.format(a.date(n.value[0]),"normalDateWithWeekday"):s(l.header)),b=N(()=>{let L=a.date();return L=a.setDate(L,1),L=a.setMonth(L,V.value),L=a.setYear(L,P.value),a.format(L,"monthAndYear")}),$=$e(()=>`date-picker-header${M.value?"-reverse":""}-transition`),R=N(()=>{if(l.disabled)return!0;const L=[];if(u.value!=="month")L.push("prev","next");else{let A=a.date();if(A=a.startOfMonth(A),A=a.setMonth(A,V.value),A=a.setYear(A,P.value),i.value){const z=a.addDays(a.startOfMonth(A),-1);a.isAfter(i.value,z)&&L.push("prev")}if(v.value){const z=a.addDays(a.endOfMonth(A),1);a.isAfter(z,v.value)&&L.push("next")}}return L});function I(){V.value<11?V.value++:(P.value++,V.value=0,G(P.value)),S(V.value)}function g(){V.value>0?V.value--:(P.value--,V.value=11,G(P.value)),S(V.value)}function de(){u.value="month"}function pe(){u.value=u.value==="months"?"month":"months"}function H(){u.value=u.value==="year"?"month":"year"}function S(L){u.value==="months"&&pe(),r("update:month",L)}function G(L){u.value==="year"&&H(),r("update:year",L)}return Ie(n,(L,A)=>{const z=ut(A),oe=ut(L);if(!oe.length)return;const h=a.date(z[z.length-1]),U=a.date(oe[oe.length-1]),ne=a.getMonth(U),x=a.getYear(U);ne!==V.value&&(V.value=ne,S(V.value)),x!==P.value&&(P.value=x,G(P.value)),M.value=a.isBefore(h,U)}),Fe(()=>{const L=st.filterProps(l),A=Ot.filterProps(l),z=Bt.filterProps(l),oe=qt.filterProps(l),h=je(jt.filterProps(l),["modelValue"]),U=je(zt.filterProps(l),["modelValue"]),ne={color:c.value,header:C.value,transition:$.value};return e(st,ae(L,{color:c.value,class:["v-date-picker",`v-date-picker--${u.value}`,{"v-date-picker--show-week":l.showWeek},d.value,l.class],style:l.style}),{title:()=>{var x;return((x=m.title)==null?void 0:x.call(m))??E("div",{class:"v-date-picker__title"},[s(l.title)])},header:()=>m.header?e(Gt,{defaults:{VDatePickerHeader:{...ne}}},{default:()=>{var x;return[(x=m.header)==null?void 0:x.call(m,ne)]}}):e(Bt,ae({key:"header"},z,ne,{onClick:u.value!=="month"?de:void 0}),{...m,default:void 0}),default:()=>E(le,null,[e(Ot,ae(A,{disabled:R.value,text:b.value,"onClick:next":I,"onClick:prev":g,"onClick:month":pe,"onClick:year":H}),null),e(wl,{hideOnLeave:!0},{default:()=>[u.value==="months"?e(jt,ae({key:"date-picker-months"},h,{modelValue:V.value,"onUpdate:modelValue":[x=>V.value=x,S],min:i.value,max:v.value,year:P.value}),null):u.value==="year"?e(zt,ae({key:"date-picker-years"},U,{modelValue:P.value,"onUpdate:modelValue":[x=>P.value=x,G],min:i.value,max:v.value}),null):e(qt,ae({key:"date-picker-month"},oe,{modelValue:n.value,"onUpdate:modelValue":x=>n.value=x,month:V.value,"onUpdate:month":[x=>V.value=x,S],year:P.value,"onUpdate:year":[x=>P.value=x,G],min:i.value,max:v.value}),null)]})]),actions:m.actions})}),{}}}),Ea=Z({__name:"DateField",props:xe({label:{},hideDetails:{type:Boolean},readonly:{type:Boolean}},{modelValue:{required:!0},modelModifiers:{}}),emits:["update:modelValue"],setup(l){const o=l,r=ke(l,"modelValue"),m=Ye();function a(d){s.value=!1,r.value=Zt(d)}const s=D(!1);return(d,n)=>o.readonly?(p(),w(ce,{key:0,class:"center-text",variant:"outlined",density:"compact","hide-details":o.hideDetails,label:o.label,"model-value":F(m).parseISO(r.value).toLocaleDateString(),readonly:""},null,8,["hide-details","label","model-value"])):(p(),w(Pe,{key:1,"close-on-content-click":!1,modelValue:s.value,"onUpdate:modelValue":n[1]||(n[1]=u=>s.value=u)},{activator:t(({props:u})=>[e(ce,ae({class:"center-text"},u,{variant:"outlined",density:"compact","hide-details":o.hideDetails,label:o.label,"model-value":F(m).parseISO(r.value).toLocaleDateString()}),null,16,["hide-details","label","model-value"])]),default:t(()=>[e(Ta,{"model-value":F(m).parseISO(r.value),"onUpdate:modelValue":n[0]||(n[0]=u=>a(u))},null,8,["model-value"])]),_:1},8,["modelValue"]))}}),pl=Ct(Ea,[["__scopeId","data-v-1e184428"]]),Pt=Z({__name:"BoolField",props:xe({label:{},hideDetails:{type:Boolean},readonly:{type:Boolean},density:{},persistentHint:{type:Boolean},hint:{}},{modelValue:{type:Boolean,required:!0},modelModifiers:{}}),emits:["update:modelValue"],setup(l){const o=l,r=ke(l,"modelValue");return(m,a)=>(p(),w(ze,{label:o.label,"model-value":r.value,"onUpdate:modelValue":a[0]||(a[0]=s=>r.value=s||!1),"hide-details":o.hideDetails,readonly:o.readonly,density:o.density,"persistent-hint":o.persistentHint,hint:o.hint},null,8,["label","model-value","hide-details","readonly","density","persistent-hint","hint"]))}}),Na=Z({__name:"OptionStatut",props:xe({camp:{}},{modelValue:{required:!0},modelModifiers:{}}),emits:["update:modelValue"],setup(l){const o=l,r=ke(l,"modelValue");function m(){var i;const d=(i=r.value)!=null&&i.length?r.value.map(v=>v.Id):[0],u={Id:Math.max(...d)+1,Label:"",Description:"",Prix:o.camp.Prix.Cent};r.value=(r.value||[]).concat(u),a.value=u}const a=D(null);function s(d){r.value=(r.value||[]).filter(n=>n.Id!=d.Id)}return(d,n)=>{const u=Je;return p(),w(Y,{subtitle:"Le prix dépend du statut du participant, à choisir parmi la liste ci-dessous."},{append:t(()=>[e(O,{icon:"",size:"x-small",onClick:m},{default:t(()=>[e(_e,{color:"green"},{default:t(()=>n[4]||(n[4]=[_("mdi-plus")])),_:1,__:[4]})]),_:1})]),default:t(()=>[a.value!=null?(p(),w(te,{key:0,"model-value":a.value!=null,"onUpdate:modelValue":n[3]||(n[3]=i=>a.value=null),"max-width":"500px"},{default:t(()=>[e(Y,{title:"Modifier le statut"},{default:t(()=>[e(J,null,{default:t(()=>[e(q,null,{default:t(()=>[e(f,{cols:"12"},{default:t(()=>[e(ce,{autofocus:"",label:"Statut",modelValue:a.value.Label,"onUpdate:modelValue":n[0]||(n[0]=i=>a.value.Label=i),density:"compact",variant:"outlined","hide-details":""},null,8,["modelValue"])]),_:1}),e(f,{cols:"12"},{default:t(()=>[e(ce,{label:"Description",modelValue:a.value.Description,"onUpdate:modelValue":n[1]||(n[1]=i=>a.value.Description=i),density:"compact",variant:"outlined","hide-details":""},null,8,["modelValue"])]),_:1}),e(f,{cols:"12"},{default:t(()=>[e(u,{"model-value":{Cent:a.value.Prix,Currency:o.camp.Prix.Currency},"onUpdate:modelValue":n[2]||(n[2]=i=>a.value.Prix=i.Cent),label:"Prix","readonly-currency":""},null,8,["model-value"])]),_:1})]),_:1})]),_:1})]),_:1})]),_:1},8,["model-value"])):W("",!0),e(J,{class:"py-0"},{default:t(()=>[e(we,null,{default:t(()=>{var i;return[(i=r.value)!=null&&i.length?W("",!0):(p(),w(K,{key:0},{default:t(()=>n[5]||(n[5]=[E("i",null,"Aucun statut n'est encore défini.",-1)])),_:1,__:[5]})),(p(!0),Q(le,null,me(r.value,v=>(p(),w(K,{title:v.Label,subtitle:v.Description,onClick:y=>a.value=v},{append:t(()=>[e(q,null,{default:t(()=>[e(f,{"align-self":"center"},{default:t(()=>[e(ye,null,{default:t(()=>[_(T(F(Ce).montant({Cent:v.Prix,Currency:d.camp.Prix.Currency})),1)]),_:2},1024)]),_:2},1024),e(f,{"align-self":"center",cols:"auto"},{default:t(()=>[e(O,{icon:"",size:"x-small",class:"my-1",onClick:et(y=>s(v),["stop"])},{default:t(()=>[e(_e,{color:"red"},{default:t(()=>n[6]||(n[6]=[_("mdi-delete")])),_:1,__:[6]})]),_:2},1032,["onClick"])]),_:2},1024)]),_:2},1024)]),_:2},1032,["title","subtitle","onClick"]))),256))]}),_:1})]),_:1})]),_:1})}}}),ha=Z({__name:"OptionJournee",props:xe({camp:{}},{modelValue:{required:!0},modelModifiers:{}}),emits:["update:modelValue"],setup(l){const o=l,r=ke(l,"modelValue");Ie(()=>r.value,m,{immediate:!0});function m(){var d;const s=o.camp.Duree;((d=r.value)==null?void 0:d.length)!=s&&(r.value=Array.from({length:s}).map(n=>0))}function a(){const s=r.value,d=s[0];for(let n=0;n<s.length;n++)s[n]=d}return(s,d)=>{const n=Je;return p(),w(Y,{subtitle:"Le prix est variable en fonction des jours de participation au camp."},{append:t(()=>[e(xt,{text:"Appliquer le prix du premier jour à tous."},{activator:t(({props:u})=>[e(O,ae(u,{icon:"mdi-arrow-expand",size:"x-small",disabled:!(r.value||[])[0],onClick:a}),null,16,["disabled"])]),_:1})]),default:t(()=>[e(J,null,{default:t(()=>[e(q,null,{default:t(()=>[(p(!0),Q(le,null,me(r.value,(u,i)=>(p(),w(f,{cols:"3"},{default:t(()=>[e(n,{label:`Jour ${i+1}`,"model-value":{Cent:u,Currency:o.camp.Prix.Currency},"onUpdate:modelValue":v=>r.value[i]=v.Cent,"readonly-currency":""},null,8,["label","model-value","onUpdate:modelValue"])]),_:2},1024))),256))]),_:1})]),_:1})]),_:1})}}}),Oa={key:0,class:"text-center"},Ba=Z({__name:"CampOptionsPrix",props:xe({camp:{}},{optionPrix:{required:!0},optionPrixModifiers:{},optionQf:{required:!0},optionQfModifiers:{}}),emits:["update:optionPrix","update:optionQf"],setup(l){const o=l,r=ke(l,"optionPrix"),m=ke(l,"optionQf"),a=N(()=>be.isQuotientFamilialActive(m.value)),s=it(el);return(d,n)=>{const u=We;return p(),w(Y,{title:"Options sur le prix",subtitle:"Permet de modifier le prix de base du séjour",width:"1000px"},{default:t(()=>[e(J,null,{default:t(()=>[e(q,null,{default:t(()=>[e(f,{"align-self":"center"},{default:t(()=>[e(ze,{"model-value":a.value,"onUpdate:modelValue":n[0]||(n[0]=i=>m.value[3]=i?100:0),"hide-details":"",label:"Prix au quotient familial"},null,8,["model-value"])]),_:1}),e(f,{"align-self":"center"},{default:t(()=>[e(u,{suffix:"%",min:0,max:100,disabled:!a.value,"hide-details":"","readonly-currency":"",label:"entre 1 et 359",modelValue:m.value[0],"onUpdate:modelValue":n[1]||(n[1]=i=>m.value[0]=i)},null,8,["disabled","modelValue"])]),_:1}),e(f,{"align-self":"center"},{default:t(()=>[e(u,{suffix:"%",min:0,max:100,disabled:!a.value,"hide-details":"","readonly-currency":"",label:"entre 360 et 564",modelValue:m.value[1],"onUpdate:modelValue":n[2]||(n[2]=i=>m.value[1]=i)},null,8,["disabled","modelValue"])]),_:1}),e(f,{"align-self":"center"},{default:t(()=>[e(u,{suffix:"%",min:0,max:100,disabled:!a.value,"hide-details":"","readonly-currency":"",label:"entre 565 et 714",modelValue:m.value[2],"onUpdate:modelValue":n[3]||(n[3]=i=>m.value[2]=i)},null,8,["disabled","modelValue"])]),_:1}),e(f,{"align-self":"center"},{default:t(()=>[e(u,{suffix:"%",min:0,max:100,disabled:!0,"hide-details":"","readonly-currency":"",label:"plus de 715",modelValue:m.value[3],"onUpdate:modelValue":n[4]||(n[4]=i=>m.value[3]=i)},null,8,["modelValue"])]),_:1})]),_:1}),e(re,{thickness:"1",class:"my-2"}),e(q,{class:"my-2"},{default:t(()=>[e(f,{"align-self":"center",cols:"4"},{default:t(()=>[e(Be,{variant:"outlined",density:"comfortable","hide-details":"",items:F(s),label:"Option sur le prix",modelValue:r.value.Active,"onUpdate:modelValue":n[5]||(n[5]=i=>r.value.Active=i)},null,8,["items","modelValue"])]),_:1}),e(f,{"align-self":"center"},{default:t(()=>[r.value.Active==F(De).NoOption?(p(),Q("div",Oa,n[8]||(n[8]=[E("i",null,"Aucune modification sur le prix de base.",-1)]))):r.value.Active==F(De).PrixStatut?(p(),w(Na,{key:1,camp:o.camp,modelValue:r.value.Statuts,"onUpdate:modelValue":n[6]||(n[6]=i=>r.value.Statuts=i)},null,8,["camp","modelValue"])):r.value.Active==F(De).PrixJour?(p(),w(ha,{key:2,camp:o.camp,modelValue:r.value.Jours,"onUpdate:modelValue":n[7]||(n[7]=i=>r.value.Jours=i)},null,8,["camp","modelValue"])):W("",!0)]),_:1})]),_:1})]),_:1})]),_:1})}}}),qa={key:0,class:"mx-1"},ja={key:1,class:"mx-1"},za={key:2,class:"mx-1"},Ha=Z({__name:"CampEdit",props:{camp:{}},emits:["save"],setup(l,{emit:o}){const r=l,m=o,a=D(Ve(r.camp)),s=N(()=>{var d,n;return new Date(a.value.DateDebut).getFullYear()>=2020&&a.value.Places>=1&&a.value.Nom!=""&&a.value.AgeMax>=a.value.AgeMin&&a.value.OptionQuotientFamilial.every(u=>0<=u&&u<=100)&&!(a.value.OptionPrix.Active==De.PrixStatut&&!((d=a.value.OptionPrix.Statuts)!=null&&d.length))&&!(a.value.OptionPrix.Active==De.PrixJour&&((n=a.value.OptionPrix.Jours)==null?void 0:n.length)!=a.value.Duree)});return(d,n)=>{const u=Pt,i=pl,v=We,y=Je;return p(),w(Y,{title:"Editer le séjour"},{default:t(()=>[e(J,null,{default:t(()=>[e(rl,null,{default:t(()=>[e(q,null,{default:t(()=>[e(f,null,{default:t(()=>[e(ce,{autofocus:"","hide-details":"",label:"Nom",density:"compact",variant:"outlined",modelValue:a.value.Nom,"onUpdate:modelValue":n[0]||(n[0]=c=>a.value.Nom=c)},null,8,["modelValue"])]),_:1}),e(f,null,{default:t(()=>[e(ce,{"hide-details":"",label:"Lieu",density:"compact",variant:"outlined",modelValue:a.value.Lieu,"onUpdate:modelValue":n[1]||(n[1]=c=>a.value.Lieu=c)},null,8,["modelValue"])]),_:1}),e(f,null,{default:t(()=>[e(ce,{"hide-details":"",label:"Numéro d'agrément",density:"compact",variant:"outlined",modelValue:a.value.Agrement,"onUpdate:modelValue":n[2]||(n[2]=c=>a.value.Agrement=c)},null,8,["modelValue"])]),_:1}),e(f,null,{default:t(()=>[e(u,{label:"Ouvert aux inscriptions",modelValue:a.value.Ouvert,"onUpdate:modelValue":n[3]||(n[3]=c=>a.value.Ouvert=c),"hide-details":""},null,8,["modelValue"])]),_:1})]),_:1}),e(q,null,{default:t(()=>[e(f,{"align-self":"center",cols:"2"},{default:t(()=>[e(i,{modelValue:a.value.DateDebut,"onUpdate:modelValue":n[4]||(n[4]=c=>a.value.DateDebut=c),label:"Date de début","hide-details":""},null,8,["modelValue"])]),_:1}),e(f,{"align-self":"center",cols:"2"},{default:t(()=>[e(v,{label:"Durée (en jours)",modelValue:a.value.Duree,"onUpdate:modelValue":n[5]||(n[5]=c=>a.value.Duree=c),"hide-details":""},null,8,["modelValue"])]),_:1}),e(f,{"align-self":"center",cols:"2"},{default:t(()=>[e(i,{"model-value":F(be).dateFin(a.value),label:"Date de fin",readonly:"","hide-details":""},null,8,["model-value"])]),_:1}),e(f,{"align-self":"center",cols:"3"},{default:t(()=>[e(y,{label:"Prix",modelValue:a.value.Prix,"onUpdate:modelValue":n[6]||(n[6]=c=>a.value.Prix=c),"hide-details":""},null,8,["modelValue"])]),_:1}),e(f,{"align-self":"center",cols:"3",class:"text-center"},{default:t(()=>[e(Pe,{"close-on-content-click":!1},{activator:t(({props:c})=>[e(ye,ae(c,{elevation:"1",label:""}),{default:t(()=>[!F(be).isQuotientFamilialActive(a.value.OptionQuotientFamilial)&&a.value.OptionPrix.Active==F(De).NoOption?(p(),Q("div",qa," Aucune option ")):W("",!0),F(be).isQuotientFamilialActive(a.value.OptionQuotientFamilial)?(p(),Q("div",ja," Quotient familial ")):W("",!0),a.value.OptionPrix.Active!=F(De).NoOption?(p(),Q("div",za,T(F(el)[a.value.OptionPrix.Active]),1)):W("",!0)]),_:2},1040)]),default:t(()=>[e(Ba,{camp:a.value,"option-prix":a.value.OptionPrix,"onUpdate:optionPrix":n[7]||(n[7]=c=>a.value.OptionPrix=c),"option-qf":a.value.OptionQuotientFamilial,"onUpdate:optionQf":n[8]||(n[8]=c=>a.value.OptionQuotientFamilial=c)},null,8,["camp","option-prix","option-qf"])]),_:1})]),_:1})]),_:1}),e(q,null,{default:t(()=>[e(f,{"align-self":"center",cols:"2"},{default:t(()=>[e(v,{modelValue:a.value.Places,"onUpdate:modelValue":n[9]||(n[9]=c=>a.value.Places=c),label:"Nombre de places"},null,8,["modelValue"])]),_:1}),e(f,{"align-self":"center",cols:"2"},{default:t(()=>[e(v,{modelValue:a.value.AgeMin,"onUpdate:modelValue":n[10]||(n[10]=c=>a.value.AgeMin=c),label:"Âge minimum"},null,8,["modelValue"])]),_:1}),e(f,{"align-self":"center",cols:"2"},{default:t(()=>[e(v,{modelValue:a.value.AgeMax,"onUpdate:modelValue":n[11]||(n[11]=c=>a.value.AgeMax=c),label:"Âge maximum"},null,8,["modelValue"])]),_:1}),e(f,{cols:"6"},{default:t(()=>[e(u,{modelValue:a.value.NeedEquilibreGF,"onUpdate:modelValue":n[12]||(n[12]=c=>a.value.NeedEquilibreGF=c),label:"Equilibre G/F demandé",density:"compact","persistent-hint":"",hint:"Place un inscrit en liste d'attente en cas de déséquilibre Garçons/Filles"},null,8,["modelValue"])]),_:1})]),_:1}),e(q,null,{default:t(()=>[e(f,null,{default:t(()=>[e(ot,{variant:"outlined",density:"compact",label:"Description",hint:"Ce texte est affiché sur le formulaire d'inscription.","persistent-hint":"",rows:"3",modelValue:a.value.Description,"onUpdate:modelValue":n[13]||(n[13]=c=>a.value.Description=c)},null,8,["modelValue"])]),_:1}),e(f,{cols:"2"}),e(f,{cols:"2"},{default:t(()=>[e(u,{label:"Navette",modelValue:a.value.Navette.Actif,"onUpdate:modelValue":n[14]||(n[14]=c=>a.value.Navette.Actif=c)},null,8,["modelValue"])]),_:1}),e(f,null,{default:t(()=>[e(ot,{variant:"outlined",density:"compact",label:"Navette",hint:"Ce texte est affiché sur l'espace personnel de suivi.","persistent-hint":"",rows:"3",disabled:!a.value.Navette.Actif,modelValue:a.value.Navette.Commentaire,"onUpdate:modelValue":n[15]||(n[15]=c=>a.value.Navette.Commentaire=c)},null,8,["disabled","modelValue"])]),_:1})]),_:1}),e(q,null,{default:t(()=>[e(f,null,{default:t(()=>[e(ce,{label:"Image",density:"compact",variant:"outlined",hint:"Lien vers une image affichée sur le formulaire d'inscription","persistent-hint":"",modelValue:a.value.ImageURL,"onUpdate:modelValue":n[16]||(n[16]=c=>a.value.ImageURL=c)},null,8,["modelValue"])]),_:1}),e(f,null,{default:t(()=>[e(ce,{label:"Mot de passe",density:"compact",variant:"outlined",hint:"Mot de passe d'accès à la page Directeur","persistent-hint":"",modelValue:a.value.Password,"onUpdate:modelValue":n[17]||(n[17]=c=>a.value.Password=c)},null,8,["modelValue"])]),_:1})]),_:1})]),_:1})]),_:1}),e(se,null,{default:t(()=>[e(ie),e(O,{disabled:!s.value,onClick:n[18]||(n[18]=c=>m("save",a.value))},{default:t(()=>n[19]||(n[19]=[_("Enregistrer")])),_:1,__:[19]},8,["disabled"])]),_:1})]),_:1})}}}),Ht=Z({__name:"TauxSelect",props:{modelValue:{required:!0},modelModifiers:{}},emits:["update:modelValue"],setup(l){Ee(s);const o=ke(l,"modelValue"),r=D(null),m=N(()=>{const i=Array.from(a.value.values()).map(v=>({title:v.Label,value:v.Id}));return i.sort((v,y)=>v.title.localeCompare(y.title)),i}),a=D(new Map);async function s(){const i=await k.CampsGetTaux();i!==void 0&&(a.value=Dl(i),o.value.Id>0&&(o.value=Ve(a.value.get(o.value.Id)),r.value=o.value.Id))}function d(){o.value.Id<=0?(r.value==null&&(r.value=1),o.value=Ve(a.value.get(r.value))):(r.value=null,o.value.Id=0,o.value.Label="")}function n(i){o.value=Ve(a.value.get(i))}const u=N(()=>{if(o.value.Id>0)return null;const i=o.value.Label;return Array.from(a.value.values()).map(y=>y.Label).includes(i)?"Ce label est déjà utilisé.":null});return(i,v)=>(p(),w(q,null,{default:t(()=>[e(f,{"align-self":"center"},{default:t(()=>[o.value.Id>0?(p(),w(Be,{key:0,variant:"outlined",density:"compact","hide-details":"",label:"Taux",items:m.value,modelValue:r.value,"onUpdate:modelValue":[v[0]||(v[0]=y=>r.value=y),n]},null,8,["items","modelValue"])):(p(),w(q,{key:1},{default:t(()=>[e(f,{cols:"12"},{default:t(()=>[e(ce,{variant:"outlined",density:"compact",label:"Label",modelValue:o.value.Label,"onUpdate:modelValue":v[1]||(v[1]=y=>o.value.Label=y),disabled:o.value.Id>0,"error-messages":u.value},null,8,["modelValue","disabled","error-messages"])]),_:1}),e(f,null,{default:t(()=>[e(ce,{label:`Valeur d'un ${F(Il)[F(Ml).FrancsSuisse]}`,density:"compact",variant:"outlined",type:"number",min:"0.001",suffix:"€",hint:"Valeur en € d'une unité de la monnaie.","persistent-hint":"","model-value":o.value.FrancsSuisse/1e3,"onUpdate:modelValue":v[2]||(v[2]=y=>o.value.FrancsSuisse=F(Sl)(Number(y)*1e3)),disabled:o.value.Id>0},null,8,["label","model-value","disabled"])]),_:1})]),_:1}))]),_:1}),e(f,{cols:"auto"},{default:t(()=>[e(re,{thickness:"2",vertical:"",class:"py-4"},{default:t(()=>v[3]||(v[3]=[_("ou")])),_:1,__:[3]})]),_:1}),e(f,{"align-self":"center",cols:"auto"},{default:t(()=>[e(O,{onClick:d},{prepend:t(()=>[e(_e,null,{default:t(()=>v[4]||(v[4]=[_("mdi-toggle-switch")])),_:1,__:[4]})]),default:t(()=>[_(" "+T(o.value.Id>0?"Créer un taux":"Utiliser un taux"),1)]),_:1})]),_:1})]),_:1}))}}),Qa=Z({__name:"CampStats",props:{stats:{}},setup(l){const o=l;function r(m,a){return`(${(a==0?0:100*m/a).toFixed(0)} %)`}return(m,a)=>(p(),w(Y,{title:"Statistiques"},{default:t(()=>[e(J,null,{default:t(()=>[e(q,null,{default:t(()=>[e(f,{cols:"5"},{default:t(()=>[_(" Demandes d'inscriptions : "+T(o.stats.Inscriptions),1)]),_:1}),e(f,{class:"text-right"},{default:t(()=>[_(" Dont Filles : "+T(o.stats.InscriptionsFilles)+" "+T(r(o.stats.InscriptionsFilles,o.stats.Inscriptions))+", Suisses : "+T(o.stats.InscriptionsSuisses)+" "+T(r(o.stats.InscriptionsSuisses,o.stats.Inscriptions)),1)]),_:1})]),_:1}),e(q,null,{default:t(()=>[e(f,{cols:"4"},{default:t(()=>[_(" Confirmées : "+T(o.stats.Valides)+" "+T(r(o.stats.Valides,o.stats.Inscriptions)),1)]),_:1}),e(f,{class:"text-right"},{default:t(()=>[_(" Dont Filles : "+T(o.stats.ValidesFilles)+" "+T(r(o.stats.ValidesFilles,o.stats.Valides))+" , Suisses : "+T(o.stats.ValidesSuisses)+" "+T(r(o.stats.ValidesSuisses,o.stats.Valides)),1)]),_:1})]),_:1}),e(q,null,{default:t(()=>[e(f,null,{default:t(()=>[_(" A statuer : "+T(o.stats.AStatuer)+" "+T(r(o.stats.AStatuer,o.stats.Inscriptions)),1)]),_:1}),e(f,{cols:"5",class:"text-center"},{default:t(()=>[_(" Demandes d'exception : "+T(o.stats.Exceptions)+" "+T(r(o.stats.Exceptions,o.stats.Inscriptions)),1)]),_:1}),e(f,{class:"text-right"},{default:t(()=>[_(" Refus : "+T(o.stats.Refus)+" "+T(r(o.stats.Refus,o.stats.Inscriptions)),1)]),_:1})]),_:1})]),_:1})]),_:1}))}}),Ya={key:0},Wa=Z({__name:"CampHeaderRow",props:{camp:{}},emits:["click","show-participants","edit-taux","delete","show-documents","send-sondage"],setup(l,{emit:o}){const r=l,m=o,a=N(()=>r.camp.Stats.Inscriptions-r.camp.Stats.Valides),s=D(!1),d=N(()=>{switch(new Date(r.camp.Camp.Camp.DateDebut).getUTCMonth()+1){case 7:case 8:return"rgb(45, 185, 187)";case 9:case 10:case 11:return"rgb(190, 150, 60)";case 12:case 1:case 2:case 3:return"rgb(240, 240, 240)";case 4:case 5:case 6:default:return"rgb(190, 228, 100)"}});return(n,u)=>(p(),Q(le,null,[e(te,{modelValue:s.value,"onUpdate:modelValue":u[1]||(u[1]=i=>s.value=i),"max-width":"600"},{default:t(()=>[e(Y,{title:"Confirmer la suppression"},{default:t(()=>[e(J,null,{default:t(()=>[u[9]||(u[9]=_(" Etes vous certain de supprimer le séjour ")),E("b",null,T(F(be).label(r.camp.Camp.Camp)),1),u[10]||(u[10]=_(" ? ")),u[11]||(u[11]=E("br",null,null,-1)),u[12]||(u[12]=E("br",null,null,-1)),u[13]||(u[13]=_(" Les éventuels ")),u[14]||(u[14]=E("i",null,"équipiers",-1)),u[15]||(u[15]=_(" déclarés sur ce séjour seront aussi supprimés. ")),u[16]||(u[16]=E("br",null,null,-1)),u[17]||(u[17]=E("br",null,null,-1)),u[18]||(u[18]=_(" Attention, cette opération est irréversible. "))]),_:1,__:[9,10,11,12,13,14,15,16,17,18]}),e(se,null,{default:t(()=>[e(ie),e(O,{color:"red",onClick:u[0]||(u[0]=i=>{s.value=!1,m("delete")})},{default:t(()=>u[19]||(u[19]=[_("Supprimer")])),_:1,__:[19]})]),_:1})]),_:1})]),_:1},8,["modelValue"]),e(Y,{color:d.value,"no-gutters":"",onClick:u[8]||(u[8]=i=>m("click")),class:"my-1"},{default:t(()=>[e(q,{style:Oe({"background-color":d.value}),class:"px-1","no-gutters":"",justify:"space-between"},{default:t(()=>[e(f,null,{default:t(()=>[e(K,{title:F(be).label(r.camp.Camp.Camp),subtitle:`ID : ${r.camp.Camp.Camp.Id}`},null,8,["title","subtitle"])]),_:1}),e(f,{"align-self":"center"},{default:t(()=>[_(T(F(be).formatPlage(n.camp.Camp.Camp)),1)]),_:1}),e(f,{cols:"2","align-self":"center"},{default:t(()=>[e(xt,{width:"600",location:"left","content-class":"pa-0"},{activator:t(({props:i})=>[e(tl,ae({class:"bg-white border-md border-primary"},i,{max:r.camp.Camp.Camp.Places,"model-value":r.camp.Stats.Valides,height:"36",rounded:"",color:"primary",onClick:u[2]||(u[2]=et(v=>m("show-participants"),["stop"]))}),{default:t(()=>[E("strong",null,[_(T(r.camp.Stats.Valides)+"/"+T(r.camp.Camp.Camp.Places)+" ",1),a.value>0?(p(),Q("span",Ya," (+ "+T(a.value)+")",1)):W("",!0)])]),_:2},1040,["max","model-value"])]),default:t(()=>[e(Qa,{stats:r.camp.Stats},null,8,["stats"])]),_:1})]),_:1}),e(f,{cols:"1"}),e(f,{cols:"auto","align-self":"center"},{default:t(()=>[e(Pe,null,{activator:t(({props:i})=>[e(O,ae(i,{size:"x-small",class:"mx-1",icon:"mdi-dots-vertical"}),null,16)]),default:t(()=>[e(we,{density:"compact"},{default:t(()=>[e(K,{"prepend-icon":"mdi-view-list",onClick:u[3]||(u[3]=i=>m("show-participants"))},{default:t(()=>u[20]||(u[20]=[_("Afficher les participants")])),_:1,__:[20]}),e(K,{"prepend-icon":"mdi-currency-eur",onClick:u[4]||(u[4]=i=>m("edit-taux"))},{default:t(()=>u[21]||(u[21]=[_("Taux de conversion")])),_:1,__:[21]}),e(re,{thickness:"1"}),e(K,{"prepend-icon":"mdi-mail",onClick:u[5]||(u[5]=i=>m("show-documents")),title:"Documents"}),e(re,{thickness:"1"}),e(K,{title:"Envoyer le sondage",subtitle:"de fin de séjour","prepend-icon":"mdi-comment-quote",onClick:u[6]||(u[6]=i=>m("send-sondage"))}),e(re,{thickness:"1"}),e(K,{"prepend-icon":"mdi-delete",disabled:r.camp.Stats.Inscriptions>0,onClick:u[7]||(u[7]=i=>s.value=!0)},{default:t(()=>u[22]||(u[22]=[_("Supprimer")])),_:1,__:[22]},8,["disabled"])]),_:1})]),_:1})]),_:1})]),_:1},8,["style"])]),_:1},8,["color"])],64))}}),Ja=Z({__name:"CampsSelector",props:xe({allCamps:{}},{modelValue:{required:!0},modelModifiers:{}}),emits:["update:modelValue"],setup(l,{emit:o}){const r=l,m=ke(l,"modelValue"),a=N(()=>r.allCamps.map(s=>({title:s.Label,value:s.Id})));return(s,d)=>(p(),w(ma,{multiple:"",chips:"","closable-chips":"",items:a.value,modelValue:m.value,"onUpdate:modelValue":d[0]||(d[0]=n=>m.value=n)},null,8,["items","modelValue"]))}}),Ga=Z({__name:"DocumentsCard",props:{camp:{}},setup(l){const o=l;Ee(m);const r=D(null);async function m(){const a=await k.CampsDocuments({idCamp:o.camp.Camp.Camp.Id});a!==void 0&&(r.value=a)}return(a,s)=>{const d=Pa;return r.value!=null?(p(),w(Y,{key:0,title:"Documents"},{default:t(()=>[e(J,null,{default:t(()=>[e(we,null,{default:t(()=>[e(Et,null,{default:t(()=>s[0]||(s[0]=[_("Préférences d'affichage")])),_:1,__:[0]}),e(K,null,{default:t(()=>[e(q,{class:"mb-2"},{default:t(()=>[e(f,null,{default:t(()=>[e(ye,{color:r.value.ToShow.LettreDirecteur?"green":"grey","append-icon":r.value.ToShow.LettreDirecteur?"mdi-check":""},{default:t(()=>s[1]||(s[1]=[_("Lettre du directeur")])),_:1,__:[1]},8,["color","append-icon"])]),_:1}),e(f,null,{default:t(()=>[e(ye,{color:r.value.ToShow.ListeVetements?"green":"grey","append-icon":r.value.ToShow.ListeVetements?"mdi-check":""},{default:t(()=>s[2]||(s[2]=[_(" Liste de vêtements")])),_:1,__:[2]},8,["color","append-icon"])]),_:1}),e(f,null,{default:t(()=>[e(ye,{color:r.value.ToShow.ListeParticipants?"green":"grey","append-icon":r.value.ToShow.ListeParticipants?"mdi-check":""},{default:t(()=>s[3]||(s[3]=[_("Liste des participants ")])),_:1,__:[3]},8,["color","append-icon"])]),_:1})]),_:1})]),_:1}),e(Et,null,{default:t(()=>s[4]||(s[4]=[_("Documents du séjour")])),_:1,__:[4]}),(p(!0),Q(le,null,me(r.value.Generated,n=>(p(),w(K,{title:n.NomClient},{append:t(()=>[e(d,{"file-key":n.Key,"is-generated-doc":!0},null,8,["file-key"])]),_:2},1032,["title"]))),256)),(p(!0),Q(le,null,me(r.value.ToRead,n=>(p(),w(K,{title:n.NomClient},{append:t(()=>[e(d,{"file-key":n.Key,"is-generated-doc":!1},null,8,["file-key"])]),_:2},1032,["title"]))),256)),(p(!0),Q(le,null,me(r.value.ToUploadModeles,n=>(p(),w(K,{title:n.NomClient,subtitle:"Document à remplir"},{append:t(()=>[e(d,{"file-key":n.Key,"is-generated-doc":!1},null,8,["file-key"])]),_:2},1032,["title"]))),256))]),_:1})]),_:1})]),_:1})):(p(),w(tt,{key:1,type:"card"}))}}}),bt=Z({__name:"RequestProgressCard",props:{title:{},current:{},total:{}},setup(l){const o=l;return(r,m)=>(p(),w(Y,{title:o.title},{default:t(()=>[e(J,null,{default:t(()=>[e(tl,{max:o.total,"model-value":o.current,color:"primary",height:"24"},{default:t(()=>[_(T(o.current)+" / "+T(o.total),1)]),_:1},8,["max","model-value"])]),_:1})]),_:1},8,["title"]))}});function Ka(){const l=D([]);Al(()=>l.value=[]);function o(r,m){l.value[m]=r}return{refs:l,updateRef:o}}const Xa=Ae({activeColor:String,start:{type:[Number,String],default:1},modelValue:{type:Number,default:l=>l.start},disabled:Boolean,length:{type:[Number,String],default:1,validator:l=>l%1===0},totalVisible:[Number,String],firstIcon:{type:he,default:"$first"},prevIcon:{type:he,default:"$prev"},nextIcon:{type:he,default:"$next"},lastIcon:{type:he,default:"$last"},ariaLabel:{type:String,default:"$vuetify.pagination.ariaLabel.root"},pageAriaLabel:{type:String,default:"$vuetify.pagination.ariaLabel.page"},currentPageAriaLabel:{type:String,default:"$vuetify.pagination.ariaLabel.currentPage"},firstAriaLabel:{type:String,default:"$vuetify.pagination.ariaLabel.first"},previousAriaLabel:{type:String,default:"$vuetify.pagination.ariaLabel.previous"},nextAriaLabel:{type:String,default:"$vuetify.pagination.ariaLabel.next"},lastAriaLabel:{type:String,default:"$vuetify.pagination.ariaLabel.last"},ellipsis:{type:String,default:"..."},showFirstLastPage:Boolean,...ql(),...Bl(),...Ol(),...hl(),...Nl(),...El(),...Tl({tag:"nav"}),...Ll(),...Rl({variant:"text"})},"VPagination"),Za=Ue()({name:"VPagination",props:Xa(),emits:{"update:modelValue":l=>!0,first:l=>!0,prev:l=>!0,next:l=>!0,last:l=>!0},setup(l,o){let{slots:r,emit:m}=o;const a=Le(l,"modelValue"),{t:s,n:d}=dt(),{isRtl:n}=Xt(),{themeClasses:u}=$l(l),{width:i}=Ul(),v=Xe(-1);It(void 0,{scoped:!0});const{resizeRef:y}=Fl(H=>{if(!H.length)return;const{target:S,contentRect:G}=H[0],L=S.querySelector(".v-pagination__list > *");if(!L)return;const A=G.width,z=L.offsetWidth+parseFloat(getComputedStyle(L).marginRight)*2;v.value=M(A,z)}),c=N(()=>parseInt(l.length,10)),V=N(()=>parseInt(l.start,10)),P=N(()=>l.totalVisible!=null?parseInt(l.totalVisible,10):v.value>=0?v.value:M(i.value,58));function M(H,S){const G=l.showFirstLastPage?5:3;return Math.max(0,Math.floor(Number(((H-S*G)/S).toFixed(2))))}const C=N(()=>{if(c.value<=0||isNaN(c.value)||c.value>Number.MAX_SAFE_INTEGER)return[];if(P.value<=0)return[];if(P.value===1)return[a.value];if(c.value<=P.value)return Re(c.value,V.value);const H=P.value%2===0,S=H?P.value/2:Math.floor(P.value/2),G=H?S:S+1,L=c.value-S;if(G-a.value>=0)return[...Re(Math.max(1,P.value-1),V.value),l.ellipsis,c.value];if(a.value-L>=(H?1:0)){const A=P.value-1,z=c.value-A+V.value;return[V.value,l.ellipsis,...Re(A,z)]}else{const A=Math.max(1,P.value-2),z=A===1?a.value:a.value-Math.ceil(A/2)+V.value;return[V.value,l.ellipsis,...Re(A,z),l.ellipsis,c.value]}});function b(H,S,G){H.preventDefault(),a.value=S,G&&m(G,S)}const{refs:$,updateRef:R}=Ka();It({VPaginationBtn:{color:$e(()=>l.color),border:$e(()=>l.border),density:$e(()=>l.density),size:$e(()=>l.size),variant:$e(()=>l.variant),rounded:$e(()=>l.rounded),elevation:$e(()=>l.elevation)}});const I=N(()=>C.value.map((H,S)=>{const G=L=>R(L,S);if(typeof H=="string")return{isActive:!1,key:`ellipsis-${S}`,page:H,props:{ref:G,ellipsis:!0,icon:!0,disabled:!0}};{const L=H===a.value;return{isActive:L,key:H,page:d(H),props:{ref:G,ellipsis:!1,icon:!0,disabled:!!l.disabled||Number(l.length)<2,color:L?l.activeColor:l.color,"aria-current":L,"aria-label":s(L?l.currentPageAriaLabel:l.pageAriaLabel,H),onClick:A=>b(A,H)}}}})),g=N(()=>{const H=!!l.disabled||a.value<=V.value,S=!!l.disabled||a.value>=V.value+c.value-1;return{first:l.showFirstLastPage?{icon:n.value?l.lastIcon:l.firstIcon,onClick:G=>b(G,V.value,"first"),disabled:H,"aria-label":s(l.firstAriaLabel),"aria-disabled":H}:void 0,prev:{icon:n.value?l.nextIcon:l.prevIcon,onClick:G=>b(G,a.value-1,"prev"),disabled:H,"aria-label":s(l.previousAriaLabel),"aria-disabled":H},next:{icon:n.value?l.prevIcon:l.nextIcon,onClick:G=>b(G,a.value+1,"next"),disabled:S,"aria-label":s(l.nextAriaLabel),"aria-disabled":S},last:l.showFirstLastPage?{icon:n.value?l.firstIcon:l.lastIcon,onClick:G=>b(G,V.value+c.value-1,"last"),disabled:S,"aria-label":s(l.lastAriaLabel),"aria-disabled":S}:void 0}});function de(){var S;const H=a.value-V.value;(S=$.value[H])==null||S.$el.focus()}function pe(H){H.key===Mt.left&&!l.disabled&&a.value>Number(l.start)?(a.value=a.value-1,yt(de)):H.key===Mt.right&&!l.disabled&&a.value<V.value+c.value-1&&(a.value=a.value+1,yt(de))}return Fe(()=>e(l.tag,{ref:y,class:fe(["v-pagination",u.value,l.class]),style:Oe(l.style),role:"navigation","aria-label":s(l.ariaLabel),onKeydown:pe,"data-test":"v-pagination-root"},{default:()=>[E("ul",{class:"v-pagination__list"},[l.showFirstLastPage&&E("li",{key:"first",class:"v-pagination__first","data-test":"v-pagination-first"},[r.first?r.first(g.value.first):e(O,ae({_as:"VPaginationBtn"},g.value.first),null)]),E("li",{key:"prev",class:"v-pagination__prev","data-test":"v-pagination-prev"},[r.prev?r.prev(g.value.prev):e(O,ae({_as:"VPaginationBtn"},g.value.prev),null)]),I.value.map((H,S)=>E("li",{key:H.key,class:fe(["v-pagination__item",{"v-pagination__item--is-active":H.isActive}]),"data-test":"v-pagination-item"},[r.item?r.item(H):e(O,ae({_as:"VPaginationBtn"},H.props),{default:()=>[H.page]})])),E("li",{key:"next",class:"v-pagination__next","data-test":"v-pagination-next"},[r.next?r.next(g.value.next):e(O,ae({_as:"VPaginationBtn"},g.value.next),null)]),l.showFirstLastPage&&E("li",{key:"last",class:"v-pagination__last","data-test":"v-pagination-last"},[r.last?r.last(g.value.last):e(O,ae({_as:"VPaginationBtn"},g.value.last),null)])])]})),{}}}),en={key:2},ft=16,tn=Z({__name:"CampsList",emits:["show-participants"],setup(l,{emit:o}){const r=o;Ee(i);const m=_t(new Map),a=D(!1),s=_t({pattern:"",openOnly:!1}),d=N(()=>{const h=ll(s.pattern),U=Array.from(m.values()).filter(ne=>be.match(ne.Camp.Camp,h)&&(!s.openOnly||Lt(ne.Camp)));return U.sort((ne,x)=>{const ee=new Date(x.Camp.Camp.DateDebut).valueOf(),X=new Date(ne.Camp.Camp.DateDebut).valueOf();return ee==X?ne.Camp.Camp.Id-x.Camp.Camp.Id:ee-X}),U}),n=N(()=>d.value.slice((c.value-1)*ft,c.value*ft));function u(){c.value>y.value&&(c.value=y.value)}async function i(){a.value=!0;const h=await k.CampsGet();a.value=!1,h!==void 0&&(m.clear(),h==null||h.forEach(U=>m.set(U.Camp.Camp.Id,U)))}async function v(){a.value=!0;const h=await k.CampsCreate();a.value=!1,h!==void 0&&(k.showMessage("Camp ajouté avec succès."),m.set(h.Camp.Camp.Id,h),V.value=h.Camp.Camp)}const y=N(()=>Math.max(Math.ceil(d.value.length/ft),1)),c=D(1),V=D(null);async function P(h){V.value=null,a.value=!0;const U=await k.CampsUpdate(h);a.value=!1,U!==void 0&&(k.showMessage("Séjour modifié avec succès."),m.get(U.Camp.Id).Camp=U,u())}const M=D(null);async function C(){const h=M.value;if(h==null)return;M.value=null,a.value=!0;const U=await k.CampsSetTaux({IdCamp:h.Camp.Camp.Id,Taux:h.Taux});a.value=!1,U!==void 0&&(k.showMessage("Taux modifié avec succès."),m.set(U.Camp.Camp.Id,U))}const b=D(!1),$=D(5),R=D({Id:1,Label:"",Euros:0,FrancsSuisse:0}),I=N(()=>R.value.Id>0||R.value.Label!=""),g=N(()=>new Set(Array.from(m.values()).filter(U=>Lt(U.Camp)).map(U=>U.Camp.Camp.IdTaux)).size<=1);async function de(){b.value=!1,a.value=!0;const h=await k.CampsCreateMany({Count:$.value,Taux:R.value});a.value=!1,h!==void 0&&(k.showMessage("Séjours créés avec succès."),h==null||h.forEach(U=>m.set(U.Camp.Camp.Id,U)))}async function pe(h){a.value=!0;const U=await k.CampsDelete({id:h.Camp.Camp.Id});a.value=!1,U!==void 0&&(k.showMessage("Séjour supprimé avec succès."),m.delete(h.Camp.Camp.Id),u())}const H=D(!1);function S(){G.value=Array.from(m.values()).filter(h=>!h.Camp.Camp.Ouvert).map(h=>h.Camp.Camp.Id),H.value=!0}const G=D([]);async function L(){H.value=!1,!(!G.value.length||await k.CampsOuvreInscriptions({Camps:G.value})===void 0)&&(k.showMessage("Séjours ouverts aux inscriptions avec succès."),i())}const A=D(null),z=D(null);async function oe(h){z.value={Current:0,Total:10};const U=await k.EventsSendSondages({idCamp:h});if(U===void 0){z.value=null;return}await gt(U,ne=>z.value=ne,ne=>k.onError("Envoi du sondage",ne)),z.value=null,k.showMessage("Sondage envoyé avec succès.")}return(h,U)=>{const ne=We;return p(),Q(le,null,[e(Y,{title:"Séjours",subtitle:m.size},{append:t(()=>[e(q,null,{default:t(()=>[e(f,{"align-self":"center",style:{width:"240px"}},{default:t(()=>[e(ce,{label:"Rechercher",variant:"filled",density:"comfortable","hide-details":"","prepend-inner-icon":"mdi-magnify",clearable:"",modelValue:s.pattern,"onUpdate:modelValue":[U[0]||(U[0]=x=>s.pattern=x),U[2]||(U[2]=x=>u())],"onClick:clear":U[1]||(U[1]=x=>{s.pattern="",u()})},null,8,["modelValue"])]),_:1}),e(re,{vertical:"",thickness:"1"}),e(f,{"align-self":"center",cols:"auto"},{default:t(()=>[e(Pe,null,{activator:t(({props:x})=>[e(O,ae(x,{color:"success",disabled:a.value}),{prepend:t(()=>[e(_e,null,{default:t(()=>U[16]||(U[16]=[_("mdi-plus")])),_:1,__:[16]})]),default:t(()=>[U[17]||(U[17]=_(" Créer un séjour "))]),_:2,__:[17]},1040,["disabled"])]),default:t(()=>[e(we,{density:"compact"},{default:t(()=>[e(K,{onClick:v,title:"Créer un séjour"}),e(K,{title:"Créer plusieurs séjours...",subtitle:"Permet de choisir les taux de conversion",onClick:U[3]||(U[3]=x=>b.value=!0)})]),_:1})]),_:1})]),_:1}),e(f,{"align-self":"center",cols:"auto"},{default:t(()=>[e(Pe,null,{activator:t(({props:x})=>[e(O,ae(x,{flat:"",icon:"mdi-dots-vertical",size:"small"}),null,16)]),default:t(()=>[e(we,{density:"compact"},{default:t(()=>[e(K,{title:"Masquer les camps fermés",subtitle:"N'afficher que les camps ouverts aux inscriptions",onClick:U[5]||(U[5]=x=>s.openOnly=!s.openOnly)},{prepend:t(()=>[e(ze,{class:"mr-2",modelValue:s.openOnly,"onUpdate:modelValue":U[4]||(U[4]=x=>s.openOnly=x),density:"compact","hide-details":""},null,8,["modelValue"])]),_:1}),e(re,{thickness:"1"}),e(K,{onClick:S,title:"Ouvrir les inscriptions","prepend-icon":"mdi-lock-open"})]),_:1})]),_:1})]),_:1})]),_:1})]),default:t(()=>[e(J,{class:"mt-4"},{default:t(()=>[g.value?W("",!0):(p(),w(jl,{key:0,type:"warning"},{default:t(()=>U[18]||(U[18]=[_(" Attention, les séjours ouverts aux inscriptions ont des taux de conversion incompatibles ! ")])),_:1,__:[18]})),a.value?(p(),w(tt,{key:1})):d.value.length==0?(p(),Q("i",en," Aucun camp ne correspond aux filtres actuels. ")):W("",!0),(p(!0),Q(le,null,me(n.value,(x,ee)=>(p(),w(Wa,{key:ee,camp:x,onClick:X=>V.value=x.Camp.Camp,onShowParticipants:X=>r("show-participants",x),onEditTaux:X=>M.value=x,onDelete:X=>pe(x),onShowDocuments:X=>A.value=x,onSendSondage:X=>oe(x.Camp.Camp.Id)},null,8,["camp","onClick","onShowParticipants","onEditTaux","onDelete","onShowDocuments","onSendSondage"]))),128)),e(Za,{length:y.value,modelValue:c.value,"onUpdate:modelValue":U[6]||(U[6]=x=>c.value=x)},null,8,["length","modelValue"])]),_:1})]),_:1},8,["subtitle"]),e(te,{"model-value":V.value!=null,"onUpdate:modelValue":U[7]||(U[7]=x=>V.value=null)},{default:t(()=>[V.value!=null?(p(),w(Ha,{key:0,camp:V.value,onSave:P},null,8,["camp"])):W("",!0)]),_:1},8,["model-value"]),e(te,{"model-value":M.value!=null,"onUpdate:modelValue":U[9]||(U[9]=x=>M.value=null),"max-width":"600"},{default:t(()=>[M.value!=null?(p(),w(Y,{key:0,title:"Modifier le taux",subtitle:"La modification n'est possible que si aucun participant n'est enregistré."},{default:t(()=>[e(J,null,{default:t(()=>[e(Ht,{modelValue:M.value.Taux,"onUpdate:modelValue":U[8]||(U[8]=x=>M.value.Taux=x)},null,8,["modelValue"])]),_:1}),e(se,null,{default:t(()=>[e(ie),e(O,{disabled:M.value.Stats.Inscriptions>0,onClick:C},{default:t(()=>U[19]||(U[19]=[_("Modifier")])),_:1,__:[19]},8,["disabled"])]),_:1})]),_:1})):W("",!0)]),_:1},8,["model-value"]),e(te,{modelValue:b.value,"onUpdate:modelValue":U[12]||(U[12]=x=>b.value=x),"max-width":"600"},{default:t(()=>[e(Y,{title:"Créer plusieurs séjours",subtitle:"Les séjours seront liés au même taux de conversion"},{default:t(()=>[e(J,null,{default:t(()=>[e(q,null,{default:t(()=>[e(f,null,{default:t(()=>[e(ne,{label:"Nombre de séjours",modelValue:$.value,"onUpdate:modelValue":U[10]||(U[10]=x=>$.value=x)},null,8,["modelValue"])]),_:1})]),_:1}),e(re,{thickness:"2",class:"my-2"}),e(Ht,{modelValue:R.value,"onUpdate:modelValue":U[11]||(U[11]=x=>R.value=x)},null,8,["modelValue"])]),_:1}),e(se,null,{default:t(()=>[e(ie),e(O,{color:"success",onClick:de,disabled:!I.value},{default:t(()=>U[20]||(U[20]=[_("Créer")])),_:1,__:[20]},8,["disabled"])]),_:1})]),_:1})]),_:1},8,["modelValue"]),e(te,{modelValue:H.value,"onUpdate:modelValue":U[14]||(U[14]=x=>H.value=x),"max-width":"600"},{default:t(()=>[e(Y,{title:"Ouvrir les inscriptions",subtitle:"Ouvre les inscriptions sur les séjours ci-dessous"},{default:t(()=>[e(J,null,{default:t(()=>[e(Ja,{"all-camps":Array.from(m.values()).map(x=>F(be).toItem(x.Camp)),modelValue:G.value,"onUpdate:modelValue":U[13]||(U[13]=x=>G.value=x)},null,8,["all-camps","modelValue"])]),_:1}),e(se,null,{default:t(()=>[e(ie),e(O,{onClick:L,disabled:!G.value.length},{default:t(()=>U[21]||(U[21]=[_("Ouvrir")])),_:1,__:[21]},8,["disabled"])]),_:1})]),_:1})]),_:1},8,["modelValue"]),e(te,{"model-value":A.value!=null,"onUpdate:modelValue":U[15]||(U[15]=x=>A.value=null),"max-width":"800px"},{default:t(()=>[A.value?(p(),w(Ga,{key:0,camp:A.value},null,8,["camp"])):W("",!0)]),_:1},8,["model-value"]),e(te,{"model-value":z.value!=null,"max-width":"400px",persistent:""},{default:t(()=>[z.value?(p(),w(bt,{key:0,title:"Envoi du sondage en cours",current:z.value.Current,total:z.value.Total},null,8,["current","total"])):W("",!0)]),_:1},8,["model-value"])],64)}}}),ln={key:1},an={key:0,class:"text-center font-italic"},nn=Z({__name:"CampParticipants",props:{id:{},idParticipant:{}},setup(l){const o=l;Ee(async()=>{a(),await n(),u()}),Ie(()=>o.id,n),Ie(()=>o.idParticipant,u);const r=D(!1),m=D([]);async function a(){const R=await k.GetCamps();R!==void 0&&(m.value=R||[])}const s=N(()=>{var I;const R=(((I=d.value)==null?void 0:I.Participants)||[]).map(g=>g);return R.sort(zl.cmp),R}),d=D(null);async function n(){r.value=!0;const R=await k.CampsLoad({idCamp:o.id});r.value=!1,R!==void 0&&(d.value=R)}function u(){var I;if(o.idParticipant===void 0)return;const R=(((I=d.value)==null?void 0:I.Participants)||[]).find(g=>g.Participant.Id==o.idParticipant);R&&(y.value=Ve(R))}const i=D(null);async function v(){if(i.value==null||d.value==null)return;const R=await k.ParticipantsCreate(i.value);i.value=null,R!==void 0&&(k.showMessage("Participant créé avec succès."),d.value.Participants=(d.value.Participants||[]).concat(R),y.value=Ve(R))}const y=D(null);async function c(R){if(y.value==null||d.value==null)return;const I=await k.ParticipantsUpdate(R);y.value=null,I!==void 0&&(k.showMessage("Participant modifié avec succès."),n())}const V=D(null);async function P(){if(V.value==null||d.value==null)return;const R=V.value.Participant.Id,I=await k.ParticipantsDelete({id:R});V.value=null,I!==void 0&&(k.showMessage("Participant supprimé avec succès."),d.value.Participants=(d.value.Participants||[]).filter(g=>g.Participant.Id!=R))}const M=D(null);async function C(){const R=M.value;R==null||d.value==null||(M.value=null,await k.ParticipantsMove(R)===void 0)||(k.showMessage("Participant déplacé avec succès.",void 0,{title:"Aller au nouveau séjour",action:()=>wt({IdCamp:R.Target,Id:R.Id})}),d.value.Participants=(d.value.Participants||[]).filter(g=>g.Participant.Id!=R.Id))}const b=D(null);async function $(){var de;if(b.value==null)return;const R=b.value.Participant.Id;b.value=null;const I=await k.ParticipantsSetPlaceLiberee({id:R});if(I===void 0||(k.showMessage("Notification de place libérée envoyée avec succès."),d.value==null))return;const g=(de=d.value.Participants)==null?void 0:de.find(pe=>pe.Participant.Id==R);g.Participant=I}return(R,I)=>{const g=ca,de=pa,pe=ct,H=nl,S=va,G=at;return d.value!=null?(p(),w(Y,{key:0,title:"Participants",subtitle:F(be).label(d.value.Camp.Camp)},{append:t(()=>[e(O,{color:"green",onClick:I[0]||(I[0]=L=>i.value={IdCamp:o.id,IdDossier:0,IdPersonne:0})},{prepend:t(()=>[e(_e,null,{default:t(()=>I[9]||(I[9]=[_("mdi-plus")])),_:1,__:[9]})]),default:t(()=>[I[10]||(I[10]=_(" Créer un participant"))]),_:1,__:[10]})]),default:t(()=>[e(J,{class:"mt-4"},{default:t(()=>[r.value?(p(),w(tt,{key:0,type:"table"})):(p(),Q("div",ln,[e(g),s.value.length?W("",!0):(p(),Q("div",an," Aucun participant n'est encore inscrit sur ce séjour. ")),(p(!0),Q(le,null,me(s.value,(L,A)=>(p(),w(de,{participant:L,index:A},{actions:t(()=>[e(we,{density:"comfortable"},{default:t(()=>[e(K,{title:"Modifier","prepend-icon":"mdi-pencil",onClick:z=>y.value=L},null,8,["onClick"]),e(re),e(K,{title:"Changer de camp...","prepend-icon":"mdi-file-move",onClick:z=>M.value={Id:L.Participant.Id,Target:0}},null,8,["onClick"]),e(K,{title:"Notifier d'une place disponible.",subtitle:"Envoi un email","prepend-icon":"mdi-email-alert",disabled:L.Participant.Statut==F(Ze).Inscrit||L.Participant.Statut==F(Ze).EnAttenteReponse,onClick:z=>b.value=L},null,8,["disabled","onClick"]),e(re),e(K,{title:"Aller à la personne",subtitle:`(ID : ${L.Personne.Id})`,onClick:z=>F(Ke)(L.Personne.Id)},null,8,["subtitle","onClick"]),e(K,{title:"Aller au dossier",subtitle:`(ID : ${L.Participant.IdDossier})`,onClick:z=>F(Vt)(L.Participant.IdDossier)},null,8,["subtitle","onClick"]),e(re),e(K,{title:"Supprimer","prepend-icon":"mdi-delete",onClick:z=>V.value=L},null,8,["onClick"])]),_:2},1024)]),_:2},1032,["participant","index"]))),256))]))]),_:1}),i.value!=null?(p(),w(te,{key:0,"model-value":i.value!=null,"onUpdate:modelValue":I[3]||(I[3]=L=>i.value=null),"max-width":"600px"},{default:t(()=>[e(Y,{title:"Créer un participant"},{default:t(()=>[e(J,null,{default:t(()=>[e(q,null,{default:t(()=>[e(f,{cols:"12"},{default:t(()=>[e(pe,{label:"Participant",modelValue:i.value.IdPersonne,"onUpdate:modelValue":I[1]||(I[1]=L=>i.value.IdPersonne=L),"initial-personne":"",api:{SelectPersonne:F(k).SelectPersonne.bind(F(k))}},null,8,["modelValue","api"])]),_:1}),e(f,{cols:"12"},{default:t(()=>[e(H,{modelValue:i.value.IdDossier,"onUpdate:modelValue":I[2]||(I[2]=L=>i.value.IdDossier=L)},null,8,["modelValue"])]),_:1})]),_:1})]),_:1}),e(se,null,{default:t(()=>[e(ie),e(O,{color:"green",onClick:v,disabled:!(i.value.IdDossier&&i.value.IdPersonne)},{default:t(()=>I[11]||(I[11]=[_("Créer")])),_:1,__:[11]},8,["disabled"])]),_:1})]),_:1})]),_:1},8,["model-value"])):W("",!0),y.value!=null?(p(),w(te,{key:1,"model-value":y.value!=null,"onUpdate:modelValue":I[4]||(I[4]=L=>y.value=null),"max-width":"800px"},{default:t(()=>[e(S,{participant:y.value.Participant,personne:y.value.Personne,api:{SelectPersonne:F(k).SelectPersonne.bind(F(k))},onSave:c},null,8,["participant","personne","api"])]),_:1},8,["model-value"])):W("",!0),V.value!=null?(p(),w(te,{key:2,"model-value":V.value!=null,"onUpdate:modelValue":I[5]||(I[5]=L=>V.value=null),"max-width":"600px"},{default:t(()=>[e(Y,{title:"Supprimer le participant"},{default:t(()=>[e(J,null,{default:t(()=>[I[12]||(I[12]=_(" Confirmez-vous la suppression du participant ")),E("b",null,T(F(Te).label(V.value.Personne)),1),I[13]||(I[13]=_(" ? ")),I[14]||(I[14]=E("br",null,null,-1)),I[15]||(I[15]=E("br",null,null,-1)),I[16]||(I[16]=_(" Attention, cette opération est irréversible. "))]),_:1,__:[12,13,14,15,16]}),e(se,null,{default:t(()=>[e(ie),e(O,{color:"red",onClick:P},{default:t(()=>I[17]||(I[17]=[_("Supprimer")])),_:1,__:[17]})]),_:1})]),_:1})]),_:1},8,["model-value"])):W("",!0),M.value!=null?(p(),w(te,{key:3,"model-value":M.value!=null,"onUpdate:modelValue":I[7]||(I[7]=L=>M.value=null),"max-width":"500px"},{default:t(()=>[e(Y,{title:"Déplacer le participant"},{default:t(()=>[e(J,null,{default:t(()=>[e(G,{label:"Nouveau séjour",camps:m.value,modelValue:M.value.Target,"onUpdate:modelValue":I[6]||(I[6]=L=>M.value.Target=L)},null,8,["camps","modelValue"])]),_:1}),e(se,null,{default:t(()=>[e(ie),e(O,{onClick:C,disabled:M.value.Target==o.id||!M.value.Target},{default:t(()=>I[18]||(I[18]=[_("Déplacer")])),_:1,__:[18]},8,["disabled"])]),_:1})]),_:1})]),_:1},8,["model-value"])):W("",!0),b.value!=null?(p(),w(te,{key:4,"model-value":b.value!=null,"onUpdate:modelValue":I[8]||(I[8]=L=>b.value=null),"max-width":"500px"},{default:t(()=>[e(Y,{title:"Notifier d'une place disponible"},{default:t(()=>[e(J,null,{default:t(()=>[_(" Confirmez-vous l'envoi d'une notification au responsable de "+T(F(Te).label(b.value.Personne))+" indiquant qu'une place est disponible ? ",1),I[19]||(I[19]=E("br",null,null,-1)),I[20]||(I[20]=E("br",null,null,-1)),_(" Le nouveau statut de "+T(b.value.Personne.Prenom)+" sera : ",1),E("i",null,T(F(Hl)[F(Ze).EnAttenteReponse]),1),I[21]||(I[21]=_(". "))]),_:1,__:[19,20,21]}),e(se,null,{default:t(()=>[e(ie),e(O,{onClick:$},{default:t(()=>I[22]||(I[22]=[_("Notifier")])),_:1,__:[22]})]),_:1})]),_:1})]),_:1},8,["model-value"])):W("",!0)]),_:1},8,["subtitle"])):(p(),w(tt,{key:1,type:"card"}))}}}),un=Z({__name:"camps",setup(l){const o=lt(),r=N(()=>au(o.currentRoute.value.query)),m=N(()=>r.value.idCamp);function a(d){const n=o.currentRoute.value;o.push({path:n.path,query:{idCamp:d.Camp.Camp.Id}})}function s(){const d=o.currentRoute.value;o.push({path:d.path,query:{}})}return(d,n)=>(p(),Q(le,null,[e(vt,{title:"Gestion des séjours"},{default:t(()=>[m.value!==null?(p(),w(O,{key:0,onClick:s},{prepend:t(()=>[e(_e,null,{default:t(()=>n[0]||(n[0]=[_("mdi-view-list")])),_:1,__:[0]})]),default:t(()=>[n[1]||(n[1]=_(" Retour à la liste"))]),_:1,__:[1]})):W("",!0)]),_:1}),m.value===void 0?(p(),w(tn,{key:0,onShowParticipants:a})):(p(),w(nn,{key:1,id:m.value,"id-participant":r.value.idParticipant},null,8,["id","id-participant"]))],64))}}),fl=Z({__name:"MergeCard",props:{from:{}},emits:["merge"],setup(l,{emit:o}){const r=l,m=o,a=D(0),s=D(!0);return(d,n)=>{const u=nl;return p(),w(Y,{title:"Fusionner le dossier vers",subtitle:"Les participants, paiements et messages seront copiés vers le dossier cible."},{default:t(()=>[e(J,null,{default:t(()=>[e(q,null,{default:t(()=>[e(f,{cols:"12"},{default:t(()=>[e(u,{modelValue:a.value,"onUpdate:modelValue":n[0]||(n[0]=i=>a.value=i)},null,8,["modelValue"])]),_:1}),e(f,{cols:"12"},{default:t(()=>[e(ze,{density:"compact",label:"Notifier par email",hint:"Le reponsable du dossier absorbé sera averti du changement d'espace personnel.","persistent-hint":"",modelValue:s.value,"onUpdate:modelValue":n[1]||(n[1]=i=>s.value=i)},null,8,["modelValue"])]),_:1})]),_:1})]),_:1}),e(se,null,{default:t(()=>[e(ie),e(O,{disabled:a.value==0||a.value==r.from,onClick:n[2]||(n[2]=i=>m("merge",{From:r.from,To:a.value,Notifie:s.value}))},{default:t(()=>n[3]||(n[3]=[_("Fusionner")])),_:1,__:[3]},8,["disabled"])]),_:1})]),_:1})}}}),sn={key:1,class:"text-center font-italic"},on={key:2},rn=Z({__name:"PannelInscriptions",emits:["goTo","empty"],setup(l,{emit:o}){const r=o,m=D(!1);Ee(async()=>{await s(),a.value.length||r("empty")});const a=D([]);async function s(){m.value=!0;const C=await k.InscriptionsGet();m.value=!1,C!==void 0&&(a.value=C||[])}const d=D(""),n=N(()=>{const C=ll(d.value);return a.value.filter(b=>{var $;return Te.match(b.Responsable,C)||(($=b.Participants)==null?void 0:$.some(R=>Te.match(R.Personne,C)||be.match(R.Camp,C)))})});async function u(C,b){const $=await k.InscriptionsIdentifiePersonne({IdDossier:C,Target:b});if($===void 0)return;k.showMessage("Profil identifié avec succès.");const R=a.value.findIndex(I=>I.Dossier.Id==C);a.value[R]=$}const i=D(null);async function v(C){const b=await k.InscriptionsHintValide({idDossier:C.Dossier.Id});b!==void 0&&(i.value={inscription:C,statuts:b||{}})}async function y(C,b){if(!i.value)return;const $=i.value.inscription.Dossier.Id;i.value=null,await k.InscriptionsValide({IdDossier:$,Statuts:C,SendMail:b})!==void 0&&(k.showMessage("Inscription validée avec succès.","",{title:"Aller au dossier",action:()=>r("goTo",$)}),a.value=a.value.filter(I=>I.Dossier.Id!=$))}async function c(C){await k.DossiersDelete({id:C.Dossier.Id})!==void 0&&(k.showMessage("Inscription supprimée avec succès."),a.value=a.value.filter($=>$.Dossier.Id!=C.Dossier.Id))}async function V(C,b){if(await k.ParticipantsDelete({id:b})===void 0)return;k.showMessage("Participant supprimé avec succès.");const R=a.value.find(I=>I.Dossier.Id==C);R.Participants=(R.Participants||[]).filter(I=>I.Participant.Id!=b)}const P=D(null);async function M(C){P.value=null,await k.DossiersMerge(C)!==void 0&&(k.showMessage("Inscriptions fusionnées avec succès."),s())}return(C,b)=>{const $=ya;return p(),w(Y,{title:"Inscriptions",subtitle:"En attente de validation",class:"ma-2"},{append:t(()=>[e(ce,{width:"300","append-inner-icon":"mdi-magnify",label:"Rechercher","hide-details":"",modelValue:d.value,"onUpdate:modelValue":b[0]||(b[0]=R=>d.value=R)},null,8,["modelValue"])]),default:t(()=>[e(J,null,{default:t(()=>[m.value?(p(),w(tt,{key:0})):a.value.length?(p(),Q("div",on,[(p(!0),Q(le,null,me(n.value,(R,I)=>(p(),w(fa,{class:"my-1",key:I,inscription:R,onIdentifie:g=>u(R.Dossier.Id,g),onValide:g=>v(R),onMerge:g=>P.value=R.Dossier.Id,onDelete:g=>c(R),onDeleteParticipant:g=>V(R.Dossier.Id,g),api:{SearchSimilaires:F(k).InscriptionsSearchSimilaires.bind(F(k)),SelectPersonne:F(k).SelectPersonne.bind(F(k))}},null,8,["inscription","onIdentifie","onValide","onMerge","onDelete","onDeleteParticipant","api"]))),128))])):(p(),Q("div",sn," Il n'y a aucune inscription à valider. "))]),_:1}),e(te,{"model-value":P.value!=null,"onUpdate:modelValue":b[1]||(b[1]=R=>P.value=null),"max-width":"600px"},{default:t(()=>[P.value!=null?(p(),w(fl,{key:0,from:P.value,onMerge:M},null,8,["from"])):W("",!0)]),_:1},8,["model-value"]),e(te,{"model-value":i.value!=null,"onUpdate:modelValue":b[2]||(b[2]=R=>i.value=null),"max-width":"800px"},{default:t(()=>[i.value?(p(),w($,{key:0,inscription:i.value.inscription,statuts:i.value.statuts,rights:{AgeInvalide:!0,CampComplet:!0},onValide:y},null,8,["inscription","statuts"])):W("",!0)]),_:1},8,["model-value"])]),_:1})}}}),dn={class:"text-grey"},mn={class:"text-grey"},cn={key:0},vn=Z({__name:"FactureCard",props:{dossier:{}},setup(l){const o=l,r=N(()=>(o.dossier.Participants||[]).filter(n=>n.Participant.Statut!=Ze.Inscrit).map(n=>Te.label(n.Personne))),m=N(()=>(o.dossier.Participants||[]).filter(n=>n.Participant.Statut==Ze.Inscrit).map(n=>({Label:Te.label(n.Personne),Camp:be.label(n.Camp),Prix:Ce.montant(n.Camp.Prix),Bilan:o.dossier.Bilan.Inscrits[n.Participant.Id]})));function a(n){return!!(n.Remises.ReducEnfants||n.Remises.ReducEquipiers||n.Remises.ReducSpeciale.Cent)}function s(n){const u=[];return n.ReducEnfants&&u.push(`Enfants : ${n.ReducEnfants}%`),n.ReducEquipiers&&u.push(`Enfants : ${n.ReducEquipiers}%`),n.ReducSpeciale.Cent&&u.push(`Remise : ${Ce.montant(n.ReducSpeciale)}`),u.join("  ;  ")}const d=N(()=>{const n=Object.values(o.dossier.Paiements||{});return n.sort((u,i)=>new Date(u.Time).valueOf()-new Date(i.Time).valueOf()),n});return(n,u)=>(p(),w(Y,{title:"Suivi financier",subtitle:r.value.length?`Les participants en liste d'attente (${r.value.join(", ")}) ne sont pas pris en compte.`:"","min-width":"900px"},{default:t(()=>[e(J,null,{default:t(()=>[e(q,null,{default:t(()=>[e(f,{cols:"3"},{default:t(()=>u[0]||(u[0]=[_("Participant")])),_:1,__:[0]}),e(f,{cols:"2",class:"text-center"},{default:t(()=>u[1]||(u[1]=[_("Prix du séjour")])),_:1,__:[1]}),e(f,{cols:"2",class:"text-center"},{default:t(()=>u[2]||(u[2]=[_("Prix avec option")])),_:1,__:[2]}),e(f,{cols:"3",class:"text-center"},{default:t(()=>u[3]||(u[3]=[_("Aides extérieures")])),_:1,__:[3]}),e(f,{cols:"2",class:"text-right"},{default:t(()=>u[4]||(u[4]=[_("Sous-total")])),_:1,__:[4]})]),_:1}),e(re,{thickness:"1",class:"my-2"}),(p(!0),Q(le,null,me(m.value,i=>(p(),Q(le,null,[e(q,null,{default:t(()=>[e(f,{"align-self":"center",cols:"3"},{default:t(()=>[_(T(i.Label)+" ",1),u[5]||(u[5]=E("br",null,null,-1)),E("span",dn,T(i.Camp),1)]),_:2,__:[5]},1024),e(f,{"align-self":"center",cols:"2",class:"text-center"},{default:t(()=>[_(T(i.Prix),1)]),_:2},1024),e(f,{"align-self":"center",cols:"2",class:"text-center"},{default:t(()=>[_(T(F(Ce).montant(i.Bilan.AvecOption))+" ",1),u[6]||(u[6]=E("br",null,null,-1)),E("span",mn,T(i.Bilan.AvecOptionDescription),1)]),_:2,__:[6]},1024),e(f,{"align-self":"center",cols:"3",class:"text-center"},{default:t(()=>{var v;return[(v=i.Bilan.Aides)!=null&&v.length?W("",!0):(p(),Q("span",cn,"-")),(p(!0),Q(le,null,me(i.Bilan.Aides,y=>(p(),w(ye,null,{default:t(()=>[_(T(y.Structure)+" : "+T(F(Ce).montant(y.Montant)),1)]),_:2},1024))),256))]}),_:2},1024),e(f,{"align-self":"center",cols:"2",class:"text-right"},{default:t(()=>[_(T(i.Bilan.AvecAides),1)]),_:2},1024)]),_:2},1024),a(i.Bilan)?(p(),w(q,{key:0,"no-gutters":""},{default:t(()=>[e(f,{cols:"10",class:"text-right"},{default:t(()=>[E("i",null,T(s(i.Bilan.Remises)),1)]),_:2},1024),e(f,{cols:"2",class:"text-right"},{default:t(()=>[_(T(i.Bilan.Net),1)]),_:2},1024)]),_:2},1024)):W("",!0)],64))),256)),e(re,{thickness:"1",class:"my-2"}),e(q,null,{default:t(()=>[e(f,{cols:"10",class:"text-right"},{default:t(()=>u[7]||(u[7]=[_("Total demandé")])),_:1,__:[7]}),e(f,{cols:"2",class:"text-right"},{default:t(()=>[_(T(o.dossier.Bilan.Demande),1)]),_:1})]),_:1}),e(re,{thickness:"1",class:"my-2"}),(p(!0),Q(le,null,me(d.value,i=>(p(),w(q,null,{default:t(()=>[e(f,null,{default:t(()=>[_(" Paiement de "+T(i.Payeur)+", le "+T(F(Ce).date(i.Time)),1)]),_:2},1024),e(f,{cols:"2",class:"text-right"},{default:t(()=>[_(T(i.IsRemboursement?"+":"-")+T(F(Ce).montant(i.Montant)),1)]),_:2},1024)]),_:2},1024))),256)),e(q,null,{default:t(()=>[e(f,{cols:"10",class:"text-right"},{default:t(()=>u[8]||(u[8]=[_("Solde")])),_:1,__:[8]}),e(f,{cols:"2",class:"text-right"},{default:t(()=>[E("b",null,T(o.dossier.Bilan.Restant),1)]),_:1})]),_:1})]),_:1})]),_:1},8,["subtitle"]))}});function qe(l){let o=arguments.length>1&&arguments[1]!==void 0?arguments[1]:2;return String(l).padStart(o,"0")}const pn=Ae({allowedValues:Function,ampm:Boolean,color:String,disabled:Boolean,displayedValue:null,double:Boolean,format:{type:Function,default:l=>l},max:{type:Number,required:!0},min:{type:Number,required:!0},scrollable:Boolean,readonly:Boolean,rotate:{type:Number,default:0},step:{type:Number,default:1},modelValue:{type:Number}},"VTimePickerClock"),Qt=Ue()({name:"VTimePickerClock",props:pn(),emits:{change:l=>!0,input:l=>!0},setup(l,o){let{emit:r}=o;const m=D(null),a=D(null),s=D(void 0),d=D(!1),n=D(null),u=D(null),{textColorClasses:i,textColorStyles:v}=Ql(()=>l.color),{backgroundColorClasses:y,backgroundColorStyles:c}=Wt(()=>l.color),V=N(()=>l.max-l.min+1),P=N(()=>l.double?V.value/2:V.value),M=N(()=>360/P.value),C=N(()=>M.value*Math.PI/180),b=N(()=>l.modelValue==null?l.min:l.modelValue),$=N(()=>.62),R=N(()=>{const x=[];for(let ee=l.min;ee<=l.max;ee=ee+l.step)x.push(ee);return x});Ie(()=>l.modelValue,x=>{s.value=x});function I(x){s.value!==x&&(s.value=x),r("input",x)}function g(x){return!l.allowedValues||l.allowedValues(x)}function de(x){if(!l.scrollable||l.disabled)return;x.preventDefault();const ee=Math.sign(-x.deltaY||1);let X=b.value;do X=X+ee,X=(X-l.min+V.value)%V.value+l.min;while(!g(X)&&X!==b.value);X!==l.displayedValue&&I(X)}function pe(x){return l.double&&x-l.min>=P.value}function H(x){return pe(x)?$.value:1}function S(x){const ee=l.rotate*Math.PI/180;return{x:Math.sin((x-l.min)*C.value+ee)*H(x),y:-Math.cos((x-l.min)*C.value+ee)*H(x)}}function G(x,ee){const X=(Math.round(x/M.value)+(ee?P.value:0))%V.value+l.min;return x<360-M.value/2?X:ee?l.max-P.value+1:l.min}function L(x){const{x:ee,y:X}=S(x);return{left:`${Math.round(50+ee*50)}%`,top:`${Math.round(50+X*50)}%`}}function A(x,ee){const X=ee.x-x.x,Me=ee.y-x.y;return Math.sqrt(X*X+Me*Me)}function z(x,ee){const X=2*Math.atan2(ee.y-x.y-A(x,ee),ee.x-x.x);return Math.abs(X*180/Math.PI)}function oe(x){n.value===null&&(n.value=x),u.value=x,I(x)}function h(x){var Dt,St;if(x.preventDefault(),!d.value&&x.type!=="click"||!m.value)return;const{width:ee,top:X,left:Me}=(Dt=m.value)==null?void 0:Dt.getBoundingClientRect(),{width:Ne}=((St=a.value)==null?void 0:St.getBoundingClientRect())??{width:0},{clientX:ge,clientY:He}="touches"in x?x.touches[0]:x,B={x:ee/2,y:-ee/2},j={x:ge-Me,y:X-He},ue=Math.round(z(B,j)-l.rotate+360)%360,ve=l.double&&A(B,j)<(Ne+Ne*$.value)/4,Se=Math.ceil(15/M.value);let Qe;for(let nt=0;nt<Se;nt++)if(Qe=G(ue+nt*M.value,ve),g(Qe)||(Qe=G(ue-nt*M.value,ve),g(Qe)))return oe(Qe)}function U(x){l.disabled||(x.preventDefault(),window.addEventListener("mousemove",h),window.addEventListener("touchmove",h),window.addEventListener("mouseup",ne),window.addEventListener("touchend",ne),n.value=null,u.value=null,d.value=!0,h(x))}function ne(x){x.stopPropagation(),window.removeEventListener("mousemove",h),window.removeEventListener("touchmove",h),window.removeEventListener("mouseup",ne),window.removeEventListener("touchend",ne),d.value=!1,u.value!==null&&g(u.value)&&r("change",u.value)}Fe(()=>E("div",{class:fe([{"v-time-picker-clock":!0,"v-time-picker-clock--indeterminate":l.modelValue==null,"v-time-picker-clock--readonly":l.readonly}]),onMousedown:U,onTouchstart:U,onWheel:de,ref:m},[E("div",{class:"v-time-picker-clock__inner",ref:a},[E("div",{class:fe([{"v-time-picker-clock__hand":!0,"v-time-picker-clock__hand--inner":pe(l.modelValue)},i.value]),style:Oe([{transform:`rotate(${l.rotate+M.value*(b.value-l.min)}deg) scaleY(${H(b.value)})`},v.value])},null),R.value.map(x=>{const ee=x===b.value;return E("div",{class:fe([{"v-time-picker-clock__item":!0,"v-time-picker-clock__item--active":ee,"v-time-picker-clock__item--disabled":l.disabled||!g(x)},ee&&y.value]),style:Oe([L(x),ee&&c.value])},[E("span",null,[l.format(x)])])})])]))}}),fn=Ae({ampm:Boolean,ampmInTitle:Boolean,ampmReadonly:Boolean,color:String,disabled:Boolean,hour:Number,minute:Number,second:Number,period:String,readonly:Boolean,useSeconds:Boolean,value:Number,viewMode:String},"VTimePickerControls"),Yt=Ue()({name:"VTimePickerControls",props:fn(),emits:{"update:period":l=>!0,"update:viewMode":l=>!0},setup(l,o){let{emit:r,slots:m}=o;const{t:a}=dt();return Fe(()=>{let s=l.hour;return l.ampm&&(s=s?(s-1)%12+1:12),E("div",{class:"v-time-picker-controls"},[E("div",{class:fe({"v-time-picker-controls__time":!0,"v-time-picker-controls__time--with-seconds":l.useSeconds})},[e(O,{active:l.viewMode==="hour",color:l.viewMode==="hour"?l.color:void 0,disabled:l.disabled,variant:"tonal",class:fe({"v-time-picker-controls__time__btn":!0,"v-time-picker-controls__time--with-ampm__btn":l.ampm,"v-time-picker-controls__time--with-seconds__btn":l.useSeconds}),text:l.hour==null?"--":qe(`${s}`),onClick:()=>r("update:viewMode","hour")},null),E("span",{class:fe(["v-time-picker-controls__time__separator",{"v-time-picker-controls--with-seconds__time__separator":l.useSeconds}])},[_(":")]),e(O,{active:l.viewMode==="minute",color:l.viewMode==="minute"?l.color:void 0,class:fe({"v-time-picker-controls__time__btn":!0,"v-time-picker-controls__time__btn__active":l.viewMode==="minute","v-time-picker-controls__time--with-ampm__btn":l.ampm,"v-time-picker-controls__time--with-seconds__btn":l.useSeconds}),disabled:l.disabled,variant:"tonal",text:l.minute==null?"--":qe(l.minute),onClick:()=>r("update:viewMode","minute")},null),l.useSeconds&&E("span",{class:fe(["v-time-picker-controls__time__separator",{"v-time-picker-controls--with-seconds__time__separator":l.useSeconds}]),key:"secondsDivider"},[_(":")]),l.useSeconds&&e(O,{key:"secondsVal",active:l.viewMode==="second",color:l.viewMode==="second"?l.color:void 0,variant:"tonal",onClick:()=>r("update:viewMode","second"),class:fe({"v-time-picker-controls__time__btn":!0,"v-time-picker-controls__time__btn__active":l.viewMode==="second","v-time-picker-controls__time--with-seconds__btn":l.useSeconds}),disabled:l.disabled,text:l.second==null?"--":qe(l.second)},null),l.ampm&&l.ampmInTitle&&E("div",{class:fe(["v-time-picker-controls__ampm",{"v-time-picker-controls__ampm--readonly":l.ampmReadonly}])},[e(O,{active:l.period==="am",color:l.period==="am"?l.color:void 0,class:fe({"v-time-picker-controls__ampm__am":!0,"v-time-picker-controls__ampm__btn":!0,"v-time-picker-controls__ampm__btn__active":l.period==="am"}),disabled:l.disabled,text:a("$vuetify.timePicker.am"),variant:l.disabled&&l.period==="am"?"elevated":"tonal",onClick:()=>l.period!=="am"?r("update:period","am"):null},null),e(O,{active:l.period==="pm",color:l.period==="pm"?l.color:void 0,class:fe({"v-time-picker-controls__ampm__pm":!0,"v-time-picker-controls__ampm__btn":!0,"v-time-picker-controls__ampm__btn__active":l.period==="pm"}),disabled:l.disabled,text:a("$vuetify.timePicker.pm"),variant:l.disabled&&l.period==="pm"?"elevated":"tonal",onClick:()=>l.period!=="pm"?r("update:period","pm"):null},null)])])])}),{}}}),yn=Re(24),yl=Re(12),_n=yl.map(l=>l+12);Re(60);const gn=Ae({allowedHours:[Function,Array],allowedMinutes:[Function,Array],allowedSeconds:[Function,Array],ampmInTitle:Boolean,disabled:Boolean,format:{type:String,default:"ampm"},max:String,min:String,viewMode:{type:String,default:"hour"},modelValue:null,readonly:Boolean,scrollable:Boolean,useSeconds:Boolean,...je(al({title:"$vuetify.timePicker.title"}),["landscape"])},"VTimePicker"),bn=Ue()({name:"VTimePicker",props:gn(),emits:{"update:hour":l=>!0,"update:minute":l=>!0,"update:period":l=>!0,"update:second":l=>!0,"update:modelValue":l=>!0,"update:viewMode":l=>!0},setup(l,o){let{emit:r,slots:m}=o;const{t:a}=dt(),s=D(null),d=D(null),n=D(null),u=D(null),i=D(null),v=D(null),y=D("am"),c=Le(l,"viewMode","hour"),V=D(null),P=D(null),M=N(()=>{let A;if(l.allowedHours instanceof Array?A=h=>l.allowedHours.includes(h):A=l.allowedHours,!l.min&&!l.max)return A;const z=l.min?Number(l.min.split(":")[0]):0,oe=l.max?Number(l.max.split(":")[0]):23;return h=>h>=Number(z)&&h<=Number(oe)&&(!A||A(h))}),C=N(()=>{let A;const z=!M.value||s.value===null||M.value(s.value);if(l.allowedMinutes instanceof Array?A=X=>l.allowedMinutes.includes(X):A=l.allowedMinutes,!l.min&&!l.max)return z?A:()=>!1;const[oe,h]=l.min?l.min.split(":").map(Number):[0,0],[U,ne]=l.max?l.max.split(":").map(Number):[23,59],x=oe*60+Number(h),ee=U*60+Number(ne);return X=>{const Me=60*s.value+X;return Me>=x&&Me<=ee&&z&&(!A||A(X))}}),b=N(()=>{let A;const oe=(!M.value||s.value===null||M.value(s.value))&&(!C.value||d.value===null||C.value(d.value));if(l.allowedSeconds instanceof Array?A=ge=>l.allowedSeconds.includes(ge):A=l.allowedSeconds,!l.min&&!l.max)return oe?A:()=>!1;const[h,U,ne]=l.min?l.min.split(":").map(Number):[0,0,0],[x,ee,X]=l.max?l.max.split(":").map(Number):[23,59,59],Me=h*3600+U*60+Number(ne||0),Ne=x*3600+ee*60+Number(X||0);return ge=>{const He=3600*s.value+60*d.value+ge;return He>=Me&&He<=Ne&&oe&&(!A||A(ge))}}),$=N(()=>l.format==="ampm");Ie(()=>l.modelValue,A=>pe(A)),Ee(()=>{pe(l.modelValue)});function R(){return s.value!=null&&d.value!=null&&(!l.useSeconds||n.value!=null)?`${qe(s.value)}:${qe(d.value)}`+(l.useSeconds?`:${qe(n.value)}`:""):null}function I(){const A=R();A!==null&&r("update:modelValue",A)}function g(A){return A?(A-1)%12+1:12}function de(A,z){return A%12+(z==="pm"?12:0)}function pe(A){if(A==null||A==="")s.value=null,d.value=null,n.value=null;else if(A instanceof Date)s.value=A.getHours(),d.value=A.getMinutes(),n.value=A.getSeconds();else{const[z,,oe,,h,U]=A.trim().toLowerCase().match(/^(\d+):(\d+)(:(\d+))?([ap]m)?$/)||new Array(6);s.value=U?de(parseInt(z,10),U):parseInt(z,10),d.value=parseInt(oe,10),n.value=parseInt(h||0,10)}y.value=s.value==null||s.value<12?"am":"pm"}function H(A,z){const oe=M.value;if(!oe)return z;const h=$.value?z<12?yl:_n:yn;return((h.find(ne=>oe((ne+z)%h.length+h[0]))||0)+z)%h.length+h[0]}function S(A){if(y.value=A,s.value!=null){const z=s.value+(y.value==="am"?-12:12);s.value=H("hour",z)}return r("update:period",A),I(),!0}function G(A){c.value==="hour"?s.value=$.value?de(A,y.value):A:c.value==="minute"?d.value=A:n.value=A}function L(A){switch(c.value||"hour"){case"hour":r("update:hour",A);break;case"minute":r("update:minute",A);break;case"second":r("update:second",A);break}const z=s.value!==null&&d.value!==null&&(l.useSeconds?n.value!==null:!0);c.value==="hour"?c.value="minute":l.useSeconds&&c.value==="minute"&&(c.value="second"),!(s.value===u.value&&d.value===i.value&&(!l.useSeconds||n.value===v.value)||R()===null)&&(u.value=s.value,i.value=d.value,l.useSeconds&&(v.value=n.value),z&&I())}Fe(()=>{const A=st.filterProps(l),z=Yt.filterProps(l),oe=Qt.filterProps(je(l,["format","modelValue","min","max"]));return e(st,ae(A,{color:void 0,class:["v-time-picker",l.class],style:l.style}),{title:()=>{var h;return((h=m.title)==null?void 0:h.call(m))??E("div",{class:"v-time-picker__title"},[a(l.title)])},header:()=>e(Yt,ae(z,{ampm:$.value||l.ampmInTitle,ampmReadonly:$.value&&!l.ampmInTitle,hour:s.value,minute:d.value,period:y.value,second:n.value,viewMode:c.value,"onUpdate:period":h=>S(h),"onUpdate:viewMode":h=>c.value=h,ref:V}),null),default:()=>e(Qt,ae(oe,{allowedValues:c.value==="hour"?M.value:c.value==="minute"?C.value:b.value,double:c.value==="hour"&&!$.value,format:c.value==="hour"?$.value?g:h=>h:h=>qe(h,2),max:c.value==="hour"?$.value&&y.value==="am"?11:23:59,min:c.value==="hour"&&$.value&&y.value==="pm"?12:0,size:20,step:c.value==="hour"?1:5,modelValue:c.value==="hour"?s.value:c.value==="minute"?d.value:n.value,onChange:L,onInput:G,ref:P}),null),actions:m.actions})})}}),Vn=Z({__name:"TimeField",props:xe({hideDetails:{type:Boolean},readonly:{type:Boolean}},{modelValue:{required:!0},modelModifiers:{}}),emits:["update:modelValue"],setup(l){const o=l,r=ke(l,"modelValue"),m=N(()=>new Date(r.value).toLocaleTimeString(void 0,{hour:"numeric",minute:"numeric"}));function a(n){const[u,i]=n.split(":"),v=new Date(r.value);v.setHours(Number(u),Number(i)),r.value=v.toISOString()}function s(n){const u=new Date(n),i=new Date(r.value);u.setHours(i.getHours(),i.getMinutes(),i.getSeconds()),r.value=u.toISOString()}const d=D(!1);return(n,u)=>{const i=pl;return p(),w(q,{"no-gutters":""},{default:t(()=>[e(f,null,{default:t(()=>[e(i,{class:"mr-2",label:"Date","model-value":F(Zt)(new Date(r.value)),"onUpdate:modelValue":s,"hide-details":o.hideDetails,readonly:o.readonly},null,8,["model-value","hide-details","readonly"])]),_:1}),e(f,{cols:"auto"},{default:t(()=>u[1]||(u[1]=[E("div",{class:"ma-2"},null,-1)])),_:1,__:[1]}),e(f,null,{default:t(()=>[e(Pe,{"close-on-content-click":!1,modelValue:d.value,"onUpdate:modelValue":u[0]||(u[0]=v=>d.value=v)},{activator:t(({props:v})=>[e(ce,ae({class:"center-text"},v,{variant:"outlined",density:"compact","hide-details":o.hideDetails,label:"Moment","model-value":m.value}),null,16,["hide-details","model-value"])]),default:t(()=>[e(F(bn),{"model-value":new Date(r.value),"onUpdate:modelValue":a,format:"24hr"},null,8,["model-value"])]),_:1},8,["modelValue"])]),_:1})]),_:1})}}}),kn=Ct(Vn,[["__scopeId","data-v-4a17089b"]]),Cn=Z({__name:"ModePaiementField",props:xe({hideDetails:{type:Boolean},readonly:{type:Boolean},rules:{}},{modelValue:{required:!0},modelModifiers:{}}),emits:["update:modelValue"],setup(l){const o=l,r=ke(l,"modelValue"),m=it(Yl);return(a,s)=>(p(),w(Be,{label:"Mode de paiement",variant:"outlined",density:"compact",items:F(m),readonly:o.readonly,"hide-details":o.hideDetails,modelValue:r.value,"onUpdate:modelValue":s[0]||(s[0]=d=>r.value=d),rules:o.rules},null,8,["items","readonly","hide-details","modelValue","rules"]))}}),xn=Z({__name:"PaiementEditCard",props:{paiement:{}},emits:["update","delete"],setup(l,{emit:o}){const r=l,m=o,a=D(Ve(r.paiement)),s=N(()=>!0),d=D(!1);return(n,u)=>{const i=Cn,v=Je,y=kn;return p(),w(Y,{title:"Modifier le paiement"},{default:t(()=>[e(te,{modelValue:d.value,"onUpdate:modelValue":u[1]||(u[1]=c=>d.value=c),"max-width":"400px"},{default:t(()=>[e(Y,{title:"Confirmation"},{default:t(()=>[e(J,null,{default:t(()=>u[11]||(u[11]=[_(" Confirmez-vous la suppression de ce paiement ? "),E("br",null,null,-1),E("br",null,null,-1),_(" Attention, cette opération est irréversible. ")])),_:1,__:[11]}),e(se,null,{default:t(()=>[e(ie),e(O,{color:"red",onClick:u[0]||(u[0]=c=>{d.value=!1,m("delete")})},{default:t(()=>u[12]||(u[12]=[_("Supprimer")])),_:1,__:[12]})]),_:1})]),_:1})]),_:1},8,["modelValue"]),e(J,null,{default:t(()=>[e(q,null,{default:t(()=>[e(f,null,{default:t(()=>[e(ce,{density:"compact",variant:"outlined","hide-details":"",label:"Payé par",modelValue:a.value.Payeur,"onUpdate:modelValue":u[2]||(u[2]=c=>a.value.Payeur=c)},null,8,["modelValue"])]),_:1}),e(f,null,{default:t(()=>[e(ce,{density:"compact",variant:"outlined","hide-details":"",label:"Description (optionelle)",modelValue:a.value.Label,"onUpdate:modelValue":u[3]||(u[3]=c=>a.value.Label=c)},null,8,["modelValue"])]),_:1})]),_:1}),e(q,null,{default:t(()=>[e(f,null,{default:t(()=>[e(i,{modelValue:a.value.Mode,"onUpdate:modelValue":u[4]||(u[4]=c=>a.value.Mode=c),"hide-details":""},null,8,["modelValue"])]),_:1}),e(f,null,{default:t(()=>[e(v,{label:"Montant",modelValue:a.value.Montant,"onUpdate:modelValue":u[5]||(u[5]=c=>a.value.Montant=c),"hide-details":""},null,8,["modelValue"])]),_:1})]),_:1}),e(q,null,{default:t(()=>[e(f,null,{default:t(()=>[e(ze,{"hide-details":"",density:"compact",label:"Remboursement ?",modelValue:a.value.IsRemboursement,"onUpdate:modelValue":u[6]||(u[6]=c=>a.value.IsRemboursement=c)},null,8,["modelValue"])]),_:1})]),_:1}),e(q,null,{default:t(()=>[e(f,null,{default:t(()=>[e(y,{modelValue:a.value.Time,"onUpdate:modelValue":u[7]||(u[7]=c=>a.value.Time=c),"hide-details":""},null,8,["modelValue"])]),_:1})]),_:1}),e(q,null,{default:t(()=>[e(f,null,{default:t(()=>[e(ce,{density:"compact",variant:"outlined",label:"Détails (optionnel)",modelValue:a.value.Details,"onUpdate:modelValue":u[8]||(u[8]=c=>a.value.Details=c)},null,8,["modelValue"])]),_:1})]),_:1})]),_:1}),e(se,null,{default:t(()=>[e(O,{color:"red",onClick:u[9]||(u[9]=c=>d.value=!0)},{default:t(()=>u[13]||(u[13]=[_("Supprimer le paiement")])),_:1,__:[13]}),e(ie),e(O,{onClick:u[10]||(u[10]=c=>m("update",a.value)),disabled:!s.value},{default:t(()=>u[14]||(u[14]=[_("Enregistrer")])),_:1,__:[14]},8,["disabled"])]),_:1})]),_:1})}}}),Pn=Z({__name:"DossierEditCard",props:{responsable:{},dossier:{}},emits:["save"],setup(l,{emit:o}){const r=l,m=o,a=D(Ve(r.dossier));return(s,d)=>{const n=ct,u=Sa,i=Pt;return p(),w(Y,null,{default:t(()=>[e(J,null,{default:t(()=>[e(q,null,{default:t(()=>[e(f,null,{default:t(()=>[e(n,{label:"Responsable","initial-personne":r.responsable,"model-value":a.value.IdResponsable,"onUpdate:modelValue":d[0]||(d[0]=v=>v?a.value.IdResponsable=v:void 0),api:{SelectPersonne:F(k).SelectPersonne.bind(F(k))}},null,8,["initial-personne","model-value","api"])]),_:1})]),_:1}),e(q,null,{default:t(()=>[e(f,null,{default:t(()=>[e(u,{label:"Adresses mail en copie",modelValue:a.value.CopiesMails,"onUpdate:modelValue":d[1]||(d[1]=v=>a.value.CopiesMails=v),rule:F(Wl).validMails()},null,8,["modelValue","rule"])]),_:1})]),_:1}),e(q,null,{default:t(()=>[e(f,null,{default:t(()=>[e(i,{"hide-details":"",modelValue:a.value.PartageAdressesOK,"onUpdate:modelValue":d[2]||(d[2]=v=>a.value.PartageAdressesOK=v),label:"Partage des coordonnées"},null,8,["modelValue"])]),_:1})]),_:1}),e(q,null,{default:t(()=>[e(f,null,{default:t(()=>[e(i,{"hide-details":"",modelValue:a.value.DemandeFondSoutien,"onUpdate:modelValue":d[3]||(d[3]=v=>a.value.DemandeFondSoutien=v),label:"Demande le fond de soutien"},null,8,["modelValue"])]),_:1})]),_:1})]),_:1}),e(se,null,{default:t(()=>[e(ie),e(O,{onClick:d[4]||(d[4]=v=>m("save",a.value))},{default:t(()=>d[5]||(d[5]=[_("Enregistrer")])),_:1,__:[5]})]),_:1})]),_:1})}}}),wn=Z({__name:"OptionJournee",props:xe({camp:{}},{modelValue:{required:!0},modelModifiers:{}}),emits:["update:modelValue"],setup(l){const o=l,r=ke(l,"modelValue"),m=N(()=>(o.camp.OptionPrix.Jours||[]).map((a,s)=>s));return(a,s)=>(p(),w(Y,null,{default:t(()=>[e(J,null,{default:t(()=>{var d;return[s[1]||(s[1]=E("div",{class:"text-grey mb-2"}," Le prix est variable en fonction des jours de participation au camp. ",-1)),e(Jl,{class:"overflow-x-auto",color:"secondary",multiple:"","model-value":(d=r.value)!=null&&d.length?r.value:m.value,"onUpdate:modelValue":s[0]||(s[0]=n=>r.value=n.length==m.value.length?[]:n)},{default:t(()=>[(p(!0),Q(le,null,me(o.camp.OptionPrix.Jours,(n,u)=>(p(),w(O,null,{default:t(()=>[_("J "+T(u+1),1)]),_:2},1024))),256))]),_:1},8,["model-value"])]}),_:1,__:[1]})]),_:1}))}}),Dn=Z({__name:"OptionStatut",props:xe({camp:{}},{modelValue:{required:!0},modelModifiers:{}}),emits:["update:modelValue"],setup(l){const o=l,r=ke(l,"modelValue"),m=N(()=>(o.camp.OptionPrix.Statuts||[]).map(s=>({value:s.Id,title:s.Label,subtitle:s.Description}))),a=N(()=>m.value.map(s=>s.value).includes(r.value));return(s,d)=>(p(),w(Y,null,{default:t(()=>[e(J,null,{default:t(()=>[d[1]||(d[1]=E("div",{class:"text-grey mb-4"},"Le prix dépend du statut du participant.",-1)),e(Be,{clearable:"",items:m.value,label:"Statut","model-value":a.value?r.value:null,"onUpdate:modelValue":d[0]||(d[0]=n=>r.value=n??0),variant:"outlined",density:"comfortable","hide-details":""},{item:t(({item:n,props:u})=>[e(K,ae(u,{title:n.title,subtitle:n.raw.subtitle}),null,16,["title","subtitle"])]),_:1},8,["items","model-value"])]),_:1,__:[1]})]),_:1}))}}),Sn={key:2},In=Z({__name:"ParticipantOptionPrix",props:{camp:{},optionAndQf:{}},emits:["update"],setup(l,{emit:o}){const r=l,m=o,a=D(Ve(r.optionAndQf));return Ie(()=>r.optionAndQf,()=>a.value=Ve(r.optionAndQf)),(s,d)=>{const n=We;return p(),w(Y,{title:"Prix variable",width:"800px"},{default:t(()=>[e(J,null,{default:t(()=>[e(q,{justify:"space-evenly"},{default:t(()=>[e(f,{"align-self":"center",cols:"3"},{default:t(()=>[e(n,{modelValue:a.value.quotientFamilial,"onUpdate:modelValue":d[0]||(d[0]=u=>a.value.quotientFamilial=u),label:"Quotient familial","hide-details":""},null,8,["modelValue"])]),_:1}),e(re,{thickness:"2",vertical:""}),e(f,{"align-self":"center",cols:"8"},{default:t(()=>[r.camp.OptionPrix.Active==F(De).PrixJour?(p(),w(wn,{key:0,camp:r.camp,modelValue:a.value.options.Jour,"onUpdate:modelValue":d[1]||(d[1]=u=>a.value.options.Jour=u)},null,8,["camp","modelValue"])):r.camp.OptionPrix.Active==F(De).PrixStatut?(p(),w(Dn,{key:1,camp:r.camp,modelValue:a.value.options.IdStatut,"onUpdate:modelValue":d[2]||(d[2]=u=>a.value.options.IdStatut=u)},null,8,["camp","modelValue"])):(p(),Q("div",Sn,"Le camp ne propose pas d'option sur le prix."))]),_:1})]),_:1})]),_:1}),e(se,null,{default:t(()=>[e(ie),e(O,{onClick:d[3]||(d[3]=u=>m("update",a.value))},{default:t(()=>d[4]||(d[4]=[_("Enregistrer")])),_:1,__:[4]})]),_:1})]),_:1})}}}),Mn={key:1,class:"mx-1"},An={key:2,class:"mx-1"},$n={key:3},Un={key:4,class:"mx-1"},Fn=Z({__name:"RemisesChip",props:{remises:{}},emits:["update"],setup(l,{emit:o}){const r=l,m=o,a=N(()=>s.value.ReducEnfants!=0||s.value.ReducEquipiers!=0||s.value.ReducSpeciale.Cent!=0),s=D(Ve(r.remises));Ie(()=>r.remises,()=>s.value=Ve(r.remises));const d=D(!1);return(n,u)=>{const i=We,v=Je;return p(),w(Pe,{"close-on-content-click":!1,location:"bottom",modelValue:d.value,"onUpdate:modelValue":u[4]||(u[4]=y=>d.value=y)},{activator:t(({props:y})=>[e(Y,ae(y,{elevation:"1",color:"grey-lighten-2"}),{default:t(()=>[e(J,{class:"py-1 px-1"},{default:t(()=>[a.value?W("",!0):(p(),Q(le,{key:0},[_(" Pas de remises ")],64)),s.value.ReducEnfants?(p(),Q("span",Mn," Enfants : "+T(s.value.ReducEnfants)+"% ",1)):W("",!0),s.value.ReducEquipiers?(p(),Q("span",An," Equipiers : "+T(s.value.ReducEquipiers)+"% ",1)):W("",!0),(s.value.ReducEnfants||s.value.ReducEquipiers)&&s.value.ReducSpeciale.Cent?(p(),Q("br",$n)):W("",!0),s.value.ReducSpeciale.Cent?(p(),Q("span",Un," Remise : "+T(F(Ce).montant(s.value.ReducSpeciale)),1)):W("",!0)]),_:1})]),_:2},1040)]),default:t(()=>[e(Y,{title:"Modifier les remises",width:"400px"},{default:t(()=>[e(J,null,{default:t(()=>[e(q,null,{default:t(()=>[e(f,null,{default:t(()=>[e(i,{modelValue:s.value.ReducEnfants,"onUpdate:modelValue":u[0]||(u[0]=y=>s.value.ReducEnfants=y),label:"Remise enfants","hide-details":"",suffix:"%"},null,8,["modelValue"])]),_:1}),e(f,null,{default:t(()=>[e(i,{modelValue:s.value.ReducEquipiers,"onUpdate:modelValue":u[1]||(u[1]=y=>s.value.ReducEquipiers=y),label:"Remise équipiers","hide-details":"",suffix:"%"},null,8,["modelValue"])]),_:1})]),_:1}),e(q,null,{default:t(()=>[e(f,null,{default:t(()=>[e(v,{class:"mt-2",modelValue:s.value.ReducSpeciale,"onUpdate:modelValue":u[2]||(u[2]=y=>s.value.ReducSpeciale=y),label:"Remise spéciale","hide-details":""},null,8,["modelValue"])]),_:1})]),_:1})]),_:1}),e(se,null,{default:t(()=>[e(ie),e(O,{onClick:u[3]||(u[3]=y=>{m("update",s.value),d.value=!1})},{default:t(()=>u[5]||(u[5]=[_("Enregistrer")])),_:1,__:[5]})]),_:1})]),_:1})]),_:1},8,["modelValue"])}}}),Rn=Ct(Fn,[["__scopeId","data-v-01096379"]]),Ln=Z({__name:"AideEditCard",props:{aide:{},file:{},structures:{},participant:{}},emits:["save","deleteFile","uploadFile","showStructureaides"],setup(l,{emit:o}){const r=l,m=o,a=D(Ve(r.aide)),s=N(()=>Object.values(r.structures).map(d=>({value:d.Id,title:d.Nom})));return(d,n)=>{const u=Pt,i=Je,v=We,y=Aa;return p(),w(Y,{title:"Modifier l'aide extérieure",subtitle:`pour ${F(Te).label(r.participant.Personne)} - ${F(be).label(r.participant.Camp)}`},{append:t(()=>[e(O,{onClick:n[0]||(n[0]=c=>m("showStructureaides"))},{default:t(()=>[e(_e,null,{default:t(()=>n[9]||(n[9]=[_("mdi-view-list")])),_:1,__:[9]}),n[10]||(n[10]=_(" Structures"))]),_:1,__:[10]})]),default:t(()=>[e(J,null,{default:t(()=>[e(q,null,{default:t(()=>[e(f,null,{default:t(()=>[e(Be,{variant:"outlined",density:"comfortable",label:"Structure",items:s.value,modelValue:a.value.IdStructureaide,"onUpdate:modelValue":n[1]||(n[1]=c=>a.value.IdStructureaide=c)},null,8,["items","modelValue"])]),_:1}),e(f,null,{default:t(()=>[e(u,{modelValue:a.value.Valide,"onUpdate:modelValue":n[2]||(n[2]=c=>a.value.Valide=c),label:"Aide validée","hide-details":""},null,8,["modelValue"])]),_:1})]),_:1}),e(q,null,{default:t(()=>[e(f,{"align-self":"center"},{default:t(()=>[e(i,{modelValue:a.value.Valeur,"onUpdate:modelValue":n[3]||(n[3]=c=>a.value.Valeur=c),label:"Montant","hide-details":""},null,8,["modelValue"])]),_:1}),e(f,{"align-self":"center",cols:"auto"},{default:t(()=>[e(u,{"hide-details":"",label:"Par jour",modelValue:a.value.ParJour,"onUpdate:modelValue":n[4]||(n[4]=c=>a.value.ParJour=c)},null,8,["modelValue"])]),_:1}),e(f,{"align-self":"center"},{default:t(()=>[e(v,{label:"Limite",suffix:"jours",modelValue:a.value.NbJoursMax,"onUpdate:modelValue":n[5]||(n[5]=c=>a.value.NbJoursMax=c),disabled:!a.value.ParJour,hint:"0 pour ne pas limiter",min:0,"persistent-hint":""},null,8,["modelValue","disabled"])]),_:1})]),_:1}),e(y,{class:"mt-4",files:r.file?[r.file]:[],title:"Document justificatif","max-docs":1,"in-upload":!1,onDelete:n[6]||(n[6]=c=>m("deleteFile")),onUpload:n[7]||(n[7]=c=>m("uploadFile",c))},null,8,["files"])]),_:1}),e(se,null,{default:t(()=>[e(ie),e(O,{onClick:n[8]||(n[8]=c=>m("save",a.value))},{default:t(()=>n[11]||(n[11]=[_("Enregistrer")])),_:1,__:[11]})]),_:1})]),_:1},8,["subtitle"])}}}),Tn=Z({__name:"StructuresPannel",props:{modelValue:{required:!0},modelModifiers:{}},emits:["update:modelValue"],setup(l){const o=ke(l,"modelValue"),r=N(()=>Object.values(o.value||{}).sort((u,i)=>u.Nom.localeCompare(i.Nom)));async function m(){const u=await k.StructureaideCreate();if(u===void 0)return;k.showMessage("Structure créée avec succès.");const i=o.value||{};i[u.Id]=u,o.value=i,a.value=u}const a=D(null);async function s(){const u=a.value;if(u==null||(a.value=null,await k.StructureaideUpdate(u)===void 0))return;k.showMessage("Structure modifiée avec succès.");const v=o.value||{};v[u.Id]=u,o.value=v}const d=D(null);async function n(){const u=d.value;if(u==null||(d.value=null,await k.StructureaideDelete({id:u.Id})===void 0))return;const v=o.value||{};delete v[u.Id],o.value=v,k.showMessage("Structure supprimée avec succès.")}return(u,i)=>(p(),w(Y,{title:"Structures d'aide",subtitle:"Organismes pouvant distribuer une aide extérieure"},{append:t(()=>[e(O,{onClick:m},{prepend:t(()=>[e(_e,{color:"green"},{default:t(()=>i[5]||(i[5]=[_("mdi-plus")])),_:1,__:[5]})]),default:t(()=>[i[6]||(i[6]=_(" Ajouter une structure "))]),_:1,__:[6]})]),default:t(()=>[e(J,{class:"overflow-y-auto"},{default:t(()=>[(p(!0),Q(le,null,me(r.value,v=>(p(),w(q,null,{default:t(()=>[e(f,{"align-self":"center"},{default:t(()=>[e(il,null,{default:t(()=>[_(T(v.Nom),1)]),_:2},1024),e(sl,null,{default:t(()=>[_(T(v.Immatriculation),1)]),_:2},1024)]),_:2},1024),e(f,{"align-self":"center",style:{"font-size":"smaller"}},{default:t(()=>[(p(!0),Q(le,null,me(v.Info.split(`
`),y=>(p(),Q("div",null,T(y),1))),256))]),_:2},1024),e(f,{"align-self":"center",cols:"auto"},{default:t(()=>[e(Pe,null,{activator:t(({props:y})=>[e(O,ae({icon:"mdi-dots-vertical"},{ref_for:!0},y,{size:"x-small"}),null,16)]),default:t(()=>[e(we,null,{default:t(()=>[e(K,{title:"Modifier","prepend-icon":"mdi-pencil",onClick:y=>a.value=F(Ve)(v)},null,8,["onClick"]),e(K,{title:"Supprimer","prepend-icon":"mdi-delete",onClick:y=>d.value=v},null,8,["onClick"])]),_:2},1024)]),_:2},1024)]),_:2},1024)]),_:2},1024))),256))]),_:1}),e(te,{"model-value":a.value!=null,"onUpdate:modelValue":i[3]||(i[3]=v=>a.value=null),"max-width":"600px"},{default:t(()=>[a.value!=null?(p(),w(Y,{key:0,title:"Modifier la structure"},{default:t(()=>[e(J,null,{default:t(()=>[e(q,null,{default:t(()=>[e(f,null,{default:t(()=>[e(ce,{variant:"outlined",density:"compact",label:"Nom",modelValue:a.value.Nom,"onUpdate:modelValue":i[0]||(i[0]=v=>a.value.Nom=v),"hide-details":""},null,8,["modelValue"])]),_:1}),e(f,null,{default:t(()=>[e(ce,{variant:"outlined",density:"compact",label:"Immatriculation",modelValue:a.value.Immatriculation,"onUpdate:modelValue":i[1]||(i[1]=v=>a.value.Immatriculation=v),"hide-details":""},null,8,["modelValue"])]),_:1})]),_:1}),e(q,null,{default:t(()=>[e(f,null,{default:t(()=>[e(ot,{variant:"outlined",density:"compact",label:"Informations",modelValue:a.value.Info,"onUpdate:modelValue":i[2]||(i[2]=v=>a.value.Info=v),"hide-details":""},null,8,["modelValue"])]),_:1})]),_:1})]),_:1}),e(se,null,{default:t(()=>[e(ie),e(O,{onClick:s},{default:t(()=>i[7]||(i[7]=[_("Enregistrer")])),_:1,__:[7]})]),_:1})]),_:1})):W("",!0)]),_:1},8,["model-value"]),e(te,{"model-value":d.value!=null,"onUpdate:modelValue":i[4]||(i[4]=v=>d.value=null),"max-width":"450px"},{default:t(()=>[d.value!=null?(p(),w(Y,{key:0,title:"Confirmation"},{default:t(()=>[e(J,null,{default:t(()=>[_(" Confirmez-vous la suppression de la structure "+T(d.value.Nom)+" ? ",1),i[8]||(i[8]=E("br",null,null,-1)),i[9]||(i[9]=E("br",null,null,-1)),i[10]||(i[10]=_(" Attention, cette opération est irréversible. "))]),_:1,__:[8,9,10]}),e(se,null,{default:t(()=>[e(ie),e(O,{color:"red",onClick:n},{default:t(()=>i[11]||(i[11]=[_("Supprimer")])),_:1,__:[11]})]),_:1})]),_:1})):W("",!0)]),_:1},8,["model-value"])]),_:1}))}}),En={key:0},Nn={key:1},hn=Z({__name:"DossierParticipantRow",props:xe({participant:{},aides:{},aidesFiles:{},hasManyParticipants:{type:Boolean}},{structures:{required:!0},structuresModifiers:{}}),emits:xe(["update","delete","createAide","updateAide","deleteAide","deleteFileAide","uploadFileAide","expand"],["update:structures"]),setup(l,{emit:o}){const r=l,m=ke(l,"structures"),a=o,s=N(()=>{const M=Object.values(r.aides||{});return M.sort((C,b)=>C.Id-b.Id),M}),d=N(()=>r.participant.Camp.OptionPrix.Active==De.NoOption&&!be.isQuotientFamilialActive(r.participant.Camp.OptionQuotientFamilial));function n(M){var C,b;switch(r.participant.Camp.OptionPrix.Active){case De.NoOption:return"Séjour sans option";case De.PrixJour:const $=((C=M.Jour)==null?void 0:C.length)||0;return $==0?"Présent tous les jours":`Présent ${$} jour${$>1?"s":""}`;case De.PrixStatut:const R=(b=r.participant.Camp.OptionPrix.Statuts)==null?void 0:b.find(I=>I.Id==M.IdStatut);return R?`Statut ${R.Label}`:"Pas d'option."}}const u=D(!1),i=D(!1),v=N(()=>Object.values(m.value).map(M=>({value:M.Id,title:M.Nom})).sort((M,C)=>M.title.localeCompare(C.title))),y=D(null),c=D(null),V=D(null),P=D(!1);return(M,C)=>(p(),w(q,null,{default:t(()=>[e(f,{"align-self":"center",cols:"3"},{default:t(()=>[e(il,null,{default:t(()=>[E("a",{href:"/camps",onClick:C[0]||(C[0]=et(b=>F(wt)(r.participant.Participant),["prevent"]))},T(F(Te).label(r.participant.Personne)),1)]),_:1}),e(sl,null,{default:t(()=>[_(T(F(be).label(r.participant.Camp)),1)]),_:1})]),_:1}),e(f,{"align-self":"center",cols:"2",class:"text-center"},{default:t(()=>[e(Pe,{disabled:d.value,"close-on-content-click":!1,modelValue:u.value,"onUpdate:modelValue":C[2]||(C[2]=b=>u.value=b)},{activator:t(({props:b})=>[e(Y,ae(b,{elevation:d.value?0:1,color:"grey-lighten-2"}),{default:t(()=>[e(J,{class:"py-1 px-1"},{default:t(()=>[d.value?(p(),Q("div",En,"Camp sans option")):(p(),Q("div",Nn,[_(T(r.participant.Participant.QuotientFamilial?`QF ${r.participant.Participant.QuotientFamilial}.`:"Pas de QF.")+" ",1),C[22]||(C[22]=E("br",null,null,-1)),_(" "+T(n(r.participant.Participant.OptionPrix)),1)]))]),_:1})]),_:2},1040,["elevation"])]),default:t(()=>[e(In,{camp:r.participant.Camp,"option-and-qf":{options:r.participant.Participant.OptionPrix,quotientFamilial:r.participant.Participant.QuotientFamilial},onUpdate:C[1]||(C[1]=b=>{r.participant.Participant.OptionPrix=b.options,r.participant.Participant.QuotientFamilial=b.quotientFamilial,u.value=!1,a("update",r.participant.Participant)})},null,8,["camp","option-and-qf"])]),_:1},8,["disabled","modelValue"])]),_:1}),e(f,{"align-self":"center",class:"text-center"},{default:t(()=>[s.value.length?W("",!0):(p(),w(ye,{key:0,label:""},{default:t(()=>C[23]||(C[23]=[_("Aucune aide")])),_:1,__:[23]})),(p(!0),Q(le,null,me(s.value,b=>(p(),w(ye,{class:"my-1","prepend-icon":"mdi-cash-plus",color:b.Valide?"green":"orange",onClick:$=>c.value=b},{close:t(()=>[e(_e,{icon:"mdi-close-circle",onClick:et($=>V.value=b,["stop"])},null,8,["onClick"])]),default:t(()=>[_(" "+T(m.value[b.IdStructureaide].Nom)+" : "+T(F(Ce).montant(b.Valeur)),1)]),_:2},1032,["color","onClick"]))),256))]),_:1}),e(f,{"align-self":"center",class:"text-center",cols:"3"},{default:t(()=>[e(Rn,{remises:r.participant.Participant.Remises,onUpdate:C[3]||(C[3]=b=>{r.participant.Participant.Remises=b,a("update",r.participant.Participant)})},null,8,["remises"])]),_:1}),e(f,{"align-self":"center",cols:"auto"},{default:t(()=>[e(Pe,{location:"left"},{activator:t(({props:b})=>[e(O,ae(b,{icon:"mdi-dots-vertical",size:"small"}),null,16)]),default:t(()=>[e(we,{density:"comfortable"},{default:t(()=>[e(K,{title:"Ajouter une aide","prepend-icon":"mdi-cash-plus",onClick:C[4]||(C[4]=b=>y.value={IdParticipant:r.participant.Participant.Id,IdStructure:0})}),e(re),r.hasManyParticipants?(p(),w(K,{key:0,"prepend-icon":"mdi-arrow-expand",title:"Étendre les options et remises",subtitle:"... au reste du dossier",onClick:C[5]||(C[5]=b=>a("expand"))})):W("",!0),e(re),e(K,{title:"Supprimer","prepend-icon":"mdi-delete",onClick:C[6]||(C[6]=b=>i.value=!0)})]),_:1})]),_:1})]),_:1}),e(te,{modelValue:i.value,"onUpdate:modelValue":C[8]||(C[8]=b=>i.value=b),"max-width":"600px"},{default:t(()=>[e(Y,{title:"Supprimer le participant"},{default:t(()=>[e(J,null,{default:t(()=>C[24]||(C[24]=[_(" Confirmez-vous la suppression de ce participant ? "),E("br",null,null,-1),_(" Attention, cette opération est irréversible. ")])),_:1,__:[24]}),e(se,null,{default:t(()=>[e(ie),e(O,{color:"red",onClick:C[7]||(C[7]=b=>{a("delete"),i.value=!1})},{default:t(()=>C[25]||(C[25]=[_("Supprimer")])),_:1,__:[25]})]),_:1})]),_:1})]),_:1},8,["modelValue"]),e(te,{modelValue:P.value,"onUpdate:modelValue":C[10]||(C[10]=b=>P.value=b),"max-width":"650px"},{default:t(()=>[e(Tn,{modelValue:m.value,"onUpdate:modelValue":C[9]||(C[9]=b=>m.value=b)},null,8,["modelValue"])]),_:1},8,["modelValue"]),y.value!=null?(p(),w(te,{key:0,"model-value":y.value!=null,"onUpdate:modelValue":C[14]||(C[14]=b=>y.value=null),width:"600px"},{default:t(()=>[e(Y,{title:"Ajouter une aide extérieure"},{append:t(()=>[e(O,{onClick:C[11]||(C[11]=b=>P.value=!0)},{default:t(()=>[e(_e,null,{default:t(()=>C[26]||(C[26]=[_("mdi-view-list")])),_:1,__:[26]}),C[27]||(C[27]=_(" Structures"))]),_:1,__:[27]})]),default:t(()=>[e(J,null,{default:t(()=>[e(Be,{variant:"outlined",density:"comfortable",label:"Structure",items:v.value,"model-value":y.value.IdStructure==0?null:y.value.IdStructure,"onUpdate:modelValue":C[12]||(C[12]=b=>y.value.IdStructure=b)},null,8,["items","model-value"])]),_:1}),e(se,null,{default:t(()=>[e(ie),e(O,{color:"green",onClick:C[13]||(C[13]=b=>{a("createAide",y.value),y.value=null}),disabled:y.value.IdStructure==0},{default:t(()=>C[28]||(C[28]=[_("Créer")])),_:1,__:[28]},8,["disabled"])]),_:1})]),_:1})]),_:1},8,["model-value"])):W("",!0),c.value!=null?(p(),w(te,{key:1,"model-value":c.value!=null,"onUpdate:modelValue":C[19]||(C[19]=b=>c.value=null),"max-width":"800px"},{default:t(()=>[e(Ln,{aide:c.value,file:M.aidesFiles[c.value.Id],structures:m.value,participant:r.participant,onShowStructureaides:C[15]||(C[15]=b=>P.value=!0),onSave:C[16]||(C[16]=b=>{a("updateAide",b),c.value=null}),onDeleteFile:C[17]||(C[17]=b=>a("deleteFileAide",c.value.Id)),onUploadFile:C[18]||(C[18]=b=>a("uploadFileAide",b,c.value.Id))},null,8,["aide","file","structures","participant"])]),_:1},8,["model-value"])):W("",!0),V.value!=null?(p(),w(te,{key:2,"model-value":V.value!=null,"onUpdate:modelValue":C[21]||(C[21]=b=>V.value=null),"max-width":"600px"},{default:t(()=>[e(Y,{title:"Supprimer l'aide"},{default:t(()=>[e(J,null,{default:t(()=>C[29]||(C[29]=[_(" Confirmez-vous la suppression de l'aide extérieure ? "),E("br",null,null,-1),_(" Attention, cette opération est irréversible. ")])),_:1,__:[29]}),e(se,null,{default:t(()=>[e(ie),e(O,{color:"red",onClick:C[20]||(C[20]=b=>{a("deleteAide",V.value.Id),V.value=null})},{default:t(()=>C[30]||(C[30]=[_("Supprimer")])),_:1,__:[30]})]),_:1})]),_:1})]),_:1},8,["model-value"])):W("",!0)]),_:1}))}}),On=Z({__name:"DossierEditor",props:{dossier:{},camps:{}},emits:["updateDossier","createParticipant","updateParticipant","deleteParticipant","expandParticipant","createAide","updateAide","deleteAide","deleteFileAide","uploadFileAide"],setup(l,{emit:o}){const r=l,m=o,a=D(null);Ee(n);const s=D(!0),d=D({});async function n(){const u=await k.StructureaidesGet();u!==void 0&&(s.value=!1,d.value=u||{})}return(u,i)=>(p(),w(Y,{title:"Modifier le dossier"},{append:t(()=>[e(O,{onClick:i[0]||(i[0]=v=>a.value={IdCamp:0,IdPersonne:0,IdDossier:r.dossier.Dossier.Dossier.Id})},{prepend:t(()=>[e(_e,{color:"green"},{default:t(()=>i[9]||(i[9]=[_("mdi-plus")])),_:1,__:[9]})]),default:t(()=>[i[10]||(i[10]=_(" Ajouter un participant"))]),_:1,__:[10]})]),default:t(()=>[e(J,null,{default:t(()=>[e(q,null,{default:t(()=>[e(f,{cols:"3"},{default:t(()=>[e(Pn,{responsable:r.dossier.Dossier.Responsable,dossier:r.dossier.Dossier.Dossier,onSave:i[1]||(i[1]=v=>m("updateDossier",v))},null,8,["responsable","dossier"])]),_:1}),e(re,{thickness:"4",vertical:""}),s.value?W("",!0):(p(),w(f,{key:0},{default:t(()=>[i[11]||(i[11]=E("div",{class:"my-1"},null,-1)),(p(!0),Q(le,null,me(r.dossier.Dossier.Participants,v=>{var y;return p(),w(hn,{participant:v,aides:(r.dossier.Dossier.Aides||{})[v.Participant.Id],"aides-files":r.dossier.Dossier.AidesFiles||{},"has-many-participants":(((y=r.dossier.Dossier.Participants)==null?void 0:y.length)||0)>1,structures:d.value,"onUpdate:structures":i[2]||(i[2]=c=>d.value=c),onCreateAide:i[3]||(i[3]=c=>m("createAide",c)),onDeleteAide:i[4]||(i[4]=c=>m("deleteAide",c)),onUpdateAide:i[5]||(i[5]=c=>m("updateAide",c)),onDeleteFileAide:i[6]||(i[6]=c=>m("deleteFileAide",c)),onUploadFileAide:i[7]||(i[7]=(c,V)=>m("uploadFileAide",c,V)),onUpdate:i[8]||(i[8]=c=>m("updateParticipant",c)),onDelete:c=>m("deleteParticipant",v.Participant.Id),onExpand:c=>m("expandParticipant",v.Participant)},null,8,["participant","aides","aides-files","has-many-participants","structures","onDelete","onExpand"])}),256))]),_:1,__:[11]}))]),_:1})]),_:1})]),_:1}))}}),Bn={class:"mr-1"},qn=["onClick"],jn={class:"overflow-y-auto",style:{"max-height":"65vh"}},zn=["href"],Hn=Z({__name:"DossierDetailsPannel",props:{dossier:{},camps:{}},emits:["updateDossier","deleteDossier","mergeDossier","createParticipant","updateParticipant","deleteParticipant","expandParticipant","createAide","updateAide","deleteAide","deleteFileAide","uploadFileAide","createPaiement","updatePaiement","deletePaiement","sendMessage","deleteMessage","sendFacture"],setup(l,{expose:o,emit:r}){const m=l,a=r;o({showEditPaiement:y,showEditDossier:u});const s=N(()=>Gl(m.dossier.Dossier,k.isFondSoutien?At.FondSoutien:At.Backoffice)),d=D(!1),n=D(!1);function u(){n.value=!0}const i=D(null),v=D(null);function y(I){v.value=I}const c="Repère",V=D(!1);async function P(){await pt(m.dossier.EspacepersoURL),k.showMessage("Lien vers l'espace personnel copié.")}async function M(){await pt(m.dossier.VirementCode),k.showMessage("Identifiant de virement copié.")}async function C(I){await pt(I),k.showMessage("IBAN copié.")}const b=D(!1),$=D(!1),R=D("");return(I,g)=>{const de=Da,pe=at,H=ct;return p(),w(Y,{title:`Dossier de ${m.dossier.Dossier.Responsable}`,class:"ml-2"},{subtitle:t(()=>[(p(!0),Q(le,null,me(m.dossier.Dossier.Participants,S=>(p(),Q("span",Bn,[E("a",{href:"/camps",onClick:et(G=>F(wt)(S.Participant),["prevent"])},T(F(Te).label(S.Personne)),9,qn)]))),256))]),append:t(()=>[e(O,{icon:"mdi-pencil",onClick:g[0]||(g[0]=S=>n.value=!0),class:"mx-1"}),e(Pe,null,{activator:t(({props:S})=>[e(O,ae(S,{icon:"mdi-dots-vertical",size:"small",class:"mx-1"}),null,16)]),default:t(()=>[e(we,{density:"compact"},{default:t(()=>[e(K,{"prepend-icon":"mdi-email",onClick:g[1]||(g[1]=S=>$.value=!0),title:"Envoyer un message",subtitle:"Notification par email"}),e(K,{"prepend-icon":"mdi-invoice-send",onClick:g[2]||(g[2]=S=>a("sendFacture")),title:"Envoyer une demande de règlement",subtitle:"Notification par email"}),e(re),e(K,{"prepend-icon":"mdi-cash-plus",onClick:g[3]||(g[3]=S=>a("createPaiement")),title:"Ajouter un paiement"}),e(re),e(K,{"prepend-icon":"mdi-link",onClick:g[4]||(g[4]=S=>V.value=!0),title:"Afficher les identifiants"}),e(re),e(K,{"prepend-icon":"mdi-file-move",onClick:g[5]||(g[5]=S=>b.value=!0),title:"Fusionner vers ..."}),e(re),e(K,{onClick:g[6]||(g[6]=S=>d.value=!0),title:"Supprimer"},{prepend:t(()=>[e(_e,{color:"red"},{default:t(()=>g[35]||(g[35]=[_("mdi-delete")])),_:1,__:[35]})]),_:1})]),_:1})]),_:1})]),default:t(()=>[e(J,null,{default:t(()=>[e(q,null,{default:t(()=>[e(f,{class:"ml-2 mb-1 text-center"},{default:t(()=>[e(Pe,null,{activator:t(({props:S})=>[e(ye,ae(S,{"prepend-icon":"mdi-currency-eur",color:F(Ce).colorStatutPaiement(m.dossier.Dossier.Bilan.Statut)}),{default:t(()=>[_(T(m.dossier.Dossier.Bilan.Recu)+" payé sur "+T(m.dossier.Dossier.Bilan.Demande),1)]),_:2},1040,["color"])]),default:t(()=>[e(vn,{dossier:m.dossier.Dossier},null,8,["dossier"])]),_:1})]),_:1})]),_:1}),E("div",jn,[e(wa,{side:"end",class:"mt-4",density:"compact"},{default:t(()=>[(p(!0),Q(le,null,me(s.value,(S,G)=>(p(),w(de,{event:S,key:G,onEditPaiement:g[7]||(g[7]=L=>v.value=L),onDeleteMessage:g[8]||(g[8]=L=>a("deleteMessage",L))},null,8,["event"]))),128))]),_:1})])]),_:1}),e(te,{modelValue:d.value,"onUpdate:modelValue":g[10]||(g[10]=S=>d.value=S),"max-width":"600px"},{default:t(()=>[e(Y,{title:"Supprimer le dossier"},{default:t(()=>[e(J,null,{default:t(()=>g[36]||(g[36]=[_(" Confirmez-vous la suppression du dossier et de ses participants ? "),E("br",null,null,-1),E("br",null,null,-1),_(" Attention, cette opération est irréversible. ")])),_:1,__:[36]}),e(se,null,{default:t(()=>[e(ie),e(O,{color:"red",onClick:g[9]||(g[9]=S=>{a("deleteDossier"),d.value=!1})},{default:t(()=>g[37]||(g[37]=[_("Supprimer")])),_:1,__:[37]})]),_:1})]),_:1})]),_:1},8,["modelValue"]),i.value!=null?(p(),w(te,{key:0,"model-value":i.value!=null,"onUpdate:modelValue":g[14]||(g[14]=S=>i.value=null),"max-width":"600px"},{default:t(()=>[e(Y,{title:"Ajouter un participant"},{default:t(()=>[e(J,null,{default:t(()=>[e(q,null,{default:t(()=>[e(f,{cols:"12"},{default:t(()=>[e(pe,{label:"Camp",camps:m.camps,modelValue:i.value.IdCamp,"onUpdate:modelValue":g[11]||(g[11]=S=>i.value.IdCamp=S)},null,8,["camps","modelValue"])]),_:1}),e(f,{cols:"12"},{default:t(()=>[e(H,{label:"Personne","initial-personne":"",modelValue:i.value.IdPersonne,"onUpdate:modelValue":g[12]||(g[12]=S=>i.value.IdPersonne=S),api:{SelectPersonne:F(k).SelectPersonne.bind(F(k))}},null,8,["modelValue","api"])]),_:1})]),_:1})]),_:1}),e(se,null,{default:t(()=>[e(ie),e(O,{color:"green",disabled:i.value.IdPersonne==0||i.value.IdCamp==0,onClick:g[13]||(g[13]=S=>{a("createParticipant",i.value),i.value=null})},{default:t(()=>g[38]||(g[38]=[_("Ajouter")])),_:1,__:[38]},8,["disabled"])]),_:1})]),_:1})]),_:1},8,["model-value"])):W("",!0),e(te,{modelValue:n.value,"onUpdate:modelValue":g[25]||(g[25]=S=>n.value=S)},{default:t(()=>[e(On,{dossier:m.dossier,camps:m.camps,onUpdateDossier:g[15]||(g[15]=S=>a("updateDossier",S)),onCreateParticipant:g[16]||(g[16]=S=>a("createParticipant",S)),onUpdateParticipant:g[17]||(g[17]=S=>a("updateParticipant",S)),onDeleteParticipant:g[18]||(g[18]=S=>a("deleteParticipant",S)),onExpandParticipant:g[19]||(g[19]=S=>a("expandParticipant",S)),onCreateAide:g[20]||(g[20]=S=>a("createAide",S)),onUpdateAide:g[21]||(g[21]=S=>a("updateAide",S)),onDeleteAide:g[22]||(g[22]=S=>a("deleteAide",S)),onDeleteFileAide:g[23]||(g[23]=S=>a("deleteFileAide",S)),onUploadFileAide:g[24]||(g[24]=(S,G)=>a("uploadFileAide",S,G))},null,8,["dossier","camps"])]),_:1},8,["modelValue"]),v.value!=null?(p(),w(te,{key:1,"model-value":v.value!=null,"onUpdate:modelValue":g[28]||(g[28]=S=>v.value=null),"max-width":"600px"},{default:t(()=>[e(xn,{paiement:v.value,onUpdate:g[26]||(g[26]=S=>{a("updatePaiement",S),v.value=null}),onDelete:g[27]||(g[27]=S=>{a("deletePaiement",v.value),v.value=null})},null,8,["paiement"])]),_:1},8,["model-value"])):W("",!0),e(te,{modelValue:V.value,"onUpdate:modelValue":g[29]||(g[29]=S=>V.value=S),"max-width":"800px"},{default:t(()=>[e(Y,{title:"Liens et identifiants"},{default:t(()=>[e(J,null,{default:t(()=>[e(q,null,{default:t(()=>[e(f,{cols:"3"},{default:t(()=>g[39]||(g[39]=[_("Espace personnel")])),_:1,__:[39]}),e(f,{class:"text-truncate"},{default:t(()=>[E("a",{href:m.dossier.EspacepersoURL,target:"_blank"},T(m.dossier.EspacepersoURL),9,zn)]),_:1}),e(f,{"align-self":"center",cols:"auto"},{default:t(()=>[e(O,{size:"small",icon:"mdi-content-copy",onClick:P})]),_:1})]),_:1}),(p(!0),Q(le,null,me(m.dossier.BankAccounts,S=>(p(),w(q,null,{default:t(()=>[e(f,{cols:"3"},{default:t(()=>[_("RIB ("+T(F(c))+")",1)]),_:1}),e(f,{cols:"3"},{default:t(()=>[_(T(S[0]),1)]),_:2},1024),e(f,null,{default:t(()=>[_(T(S[1]),1)]),_:2},1024),e(f,{"align-self":"center",cols:"auto"},{default:t(()=>[e(O,{size:"small",icon:"mdi-content-copy",onClick:()=>C(S[1])},null,8,["onClick"])]),_:2},1024)]),_:2},1024))),256)),e(q,null,{default:t(()=>[e(f,{cols:"3"},{default:t(()=>g[40]||(g[40]=[_("Identification de virement")])),_:1,__:[40]}),e(f,null,{default:t(()=>[_(T(m.dossier.VirementCode),1)]),_:1}),e(f,{"align-self":"center",cols:"auto"},{default:t(()=>[e(O,{size:"small",icon:"mdi-content-copy",onClick:M})]),_:1})]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"]),e(te,{modelValue:b.value,"onUpdate:modelValue":g[31]||(g[31]=S=>b.value=S),"max-width":"600px"},{default:t(()=>[e(fl,{from:m.dossier.Dossier.Dossier.Id,onMerge:g[30]||(g[30]=S=>{a("mergeDossier",S),b.value=!1})},null,8,["from"])]),_:1},8,["modelValue"]),e(te,{modelValue:$.value,"onUpdate:modelValue":g[34]||(g[34]=S=>$.value=S),"max-width":"600px"},{default:t(()=>[e(Y,{title:"Nouveau message",subtitle:"Envoie un message sur le fil de suivi et une notification par mail."},{default:t(()=>[e(J,null,{default:t(()=>[e(q,null,{default:t(()=>[e(f,null,{default:t(()=>[e(ot,{rows:"5",variant:"outlined",modelValue:R.value,"onUpdate:modelValue":g[32]||(g[32]=S=>R.value=S)},null,8,["modelValue"])]),_:1})]),_:1})]),_:1}),e(se,null,{default:t(()=>[e(ie),e(O,{disabled:!R.value.length,onClickOnce:g[33]||(g[33]=S=>{a("sendMessage",R.value),$.value=!1})},{default:t(()=>g[41]||(g[41]=[_("Envoyer")])),_:1,__:[41]},8,["disabled"])]),_:1})]),_:1})]),_:1},8,["modelValue"])]),_:1},8,["title"])}}}),Qn=Z({__name:"CreateDossierCard",emits:["create"],setup(l,{emit:o}){const r=o,m=D(0);return(a,s)=>{const d=ct;return p(),w(Y,{title:"Créer un dossier"},{default:t(()=>[e(J,null,{default:t(()=>[e(q,null,{default:t(()=>[e(f,null,{default:t(()=>[e(d,{label:"Responsable légal",modelValue:m.value,"onUpdate:modelValue":s[0]||(s[0]=n=>m.value=n),"initial-personne":"",api:{SelectPersonne:F(k).SelectPersonne.bind(F(k))}},null,8,["modelValue","api"])]),_:1})]),_:1})]),_:1}),e(se,null,{default:t(()=>[e(ie),e(O,{color:"green",disabled:m.value==0,onClick:s[1]||(s[1]=n=>r("create",m.value))},{default:t(()=>s[2]||(s[2]=[_("Créer")])),_:1,__:[2]},8,["disabled"])]),_:1})]),_:1})}}}),Yn=Z({__name:"DossierList",props:xe({camps:{},selected:{}},{query:{required:!0},queryModifiers:{}}),emits:xe(["click","update"],["update:query"]),setup(l,{expose:o,emit:r}){const m=l,a=r,s=ke(l,"query");o({searchDossiers:n}),Ie(()=>s.value,n,{immediate:!0});const d=D(null);async function n(){const u=await k.DossiersSearch(s.value);u!==void 0&&(d.value=u,a("update",u))}return(u,i)=>{const v=at,y=ul;return p(),Q("div",null,[e(q,null,{default:t(()=>[e(f,{"align-self":"center"},{default:t(()=>[e(y,{density:"compact",variant:"outlined","prepend-inner-icon":"mdi-magnify",label:"Rechercher un dossier","hide-details":"",clearable:"",modelValue:s.value.Pattern,"onUpdate:modelValue":[i[5]||(i[5]=c=>s.value.Pattern=c),n]},{"append-inner":t(()=>[s.value.IdCamp.Valid?(p(),w(ye,{key:0,class:"ml-1",size:"small","prepend-icon":"mdi-bed"},{default:t(()=>{var c;return[_(T((c=m.camps.find(V=>V.Id==s.value.IdCamp.Id))==null?void 0:c.Label),1)]}),_:1})):W("",!0),s.value.Attente!=F(ta).EmptyQA?(p(),w(ye,{key:1,class:"ml-1",size:"small","prepend-icon":"mdi-clock"},{default:t(()=>[_(T(F($t)[s.value.Attente]),1)]),_:1})):W("",!0),s.value.Reglement!=F(la).EmptyQR?(p(),w(ye,{key:2,class:"ml-1",size:"small","prepend-icon":"mdi-currency-eur"},{default:t(()=>[_(T(F(Ut)[s.value.Reglement]),1)]),_:1})):W("",!0),s.value.OnlyFondSoutien?(p(),w(ye,{key:3,class:"ml-1",size:"small"},{default:t(()=>i[6]||(i[6]=[_(" Fond de soutien ")])),_:1,__:[6]})):W("",!0)]),append:t(()=>[e(Pe,{location:"left top","close-on-content-click":!1},{activator:t(({props:c})=>[e(O,ae(c,{size:"small",variant:"flat",icon:""}),{default:t(()=>[e(_e,null,{default:t(()=>i[7]||(i[7]=[_("mdi-filter-cog")])),_:1,__:[7]}),e(xt,{activator:"parent",text:"Autres critères de recherche"})]),_:2},1040)]),default:t(()=>[e(Y,{"min-width":"400px",title:"Filtrer les dossiers"},{default:t(()=>[e(J,null,{default:t(()=>[e(q,null,{default:t(()=>[e(f,null,{default:t(()=>[e(v,{label:"Camp",camps:m.camps,"model-value":F(Zl)(F(ea)(s.value.IdCamp)),"onUpdate:modelValue":i[0]||(i[0]=c=>{s.value.IdCamp=F(Kl)(F(Xl)(c)),n()})},null,8,["camps","model-value"])]),_:1})]),_:1}),e(q,null,{default:t(()=>[e(f,null,{default:t(()=>[e(Be,{density:"compact",variant:"outlined",label:"Liste d'attente",modelValue:s.value.Attente,"onUpdate:modelValue":[i[1]||(i[1]=c=>s.value.Attente=c),n],items:F(it)(F($t)),"hide-details":""},null,8,["modelValue","items"])]),_:1})]),_:1}),e(q,null,{default:t(()=>[e(f,null,{default:t(()=>[e(Be,{density:"compact",variant:"outlined",label:"Réglement",modelValue:s.value.Reglement,"onUpdate:modelValue":[i[2]||(i[2]=c=>s.value.Reglement=c),n],items:F(it)(F(Ut)),"hide-details":""},null,8,["modelValue","items"])]),_:1})]),_:1}),e(q,null,{default:t(()=>[e(f,null,{default:t(()=>[e(Tt,{label:"Trier selon les nouveaux messages",hint:"Affiche les nouveaux messages en premier.","persistent-hint":"",density:"compact",color:"light-blue-darken-3",modelValue:s.value.SortByNewMessages,"onUpdate:modelValue":[i[3]||(i[3]=c=>s.value.SortByNewMessages=c),n]},null,8,["modelValue"])]),_:1})]),_:1}),e(q,null,{default:t(()=>[e(f,null,{default:t(()=>[e(Tt,{label:"Fond de soutien",hint:"N'affiche que les dossiers demandant le fond de soutien.","persistent-hint":"",density:"compact",color:"orange",modelValue:s.value.OnlyFondSoutien,"onUpdate:modelValue":[i[4]||(i[4]=c=>s.value.OnlyFondSoutien=c),n]},null,8,["modelValue"])]),_:1})]),_:1})]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"])]),_:1})]),_:1}),d.value!=null?(p(),w(we,{key:0,class:"mt-2",selected:m.selected?[m.selected]:void 0},{default:t(()=>{var c;return[(c=d.value.Dossiers)!=null&&c.length?W("",!0):(p(),w(K,{key:0,class:"text-center"},{default:t(()=>i[8]||(i[8]=[E("i",null,"Aucun dossier ne correspond à votre recherche.",-1)])),_:1,__:[8]})),(p(!0),Q(le,null,me(d.value.Dossiers,(V,P)=>(p(),w(K,{rounded:"",key:P,title:V.Responsable,subtitle:V.Participants,value:V.Id,onClick:M=>a("click",V),class:"my-1"},mt({_:2},[V.NewMessages?{name:"append",fn:t(()=>[e(ka,{color:"light-blue-darken-3",content:V.NewMessages},null,8,["content"])]),key:"0"}:void 0]),1032,["title","subtitle","value","onClick"]))),128))]}),_:1},8,["selected"])):W("",!0)])}}}),Wn=Z({__name:"SendDocumentsCampCard",props:{camps:{}},emits:["send"],setup(l,{emit:o}){const r=l,m=o,a=D(0),s=D(null);async function d(){const i=await k.EventsSendDocumentsCampPreview({idCamp:a.value});i!==void 0&&(s.value=i,n.value=(i.Dossiers||[]).filter(v=>!v.DocumentsSent).map(v=>v.Id))}const n=D([]),u=N(()=>{var i;return n.value.length==(((i=s.value)==null?void 0:i.Dossiers)||[]).length});return(i,v)=>{const y=at;return p(),w(Y,{title:"Envoyer les documents d'un séjour"},{default:t(()=>[e(J,null,{default:t(()=>[e(q,null,{default:t(()=>[e(f,{"align-self":"center",cols:"5"},{default:t(()=>[e(y,{camps:r.camps,label:"Séjour",modelValue:a.value,"onUpdate:modelValue":[v[0]||(v[0]=c=>a.value=c),d]},null,8,["camps","modelValue"])]),_:1}),e(f,{"align-self":"center"},{default:t(()=>{var c;return[s.value?(p(),w(Y,{key:0,subtitle:"Dossiers à contacter"},mt({default:t(()=>[e(J,null,{default:t(()=>[e(we,{selectable:"",selected:n.value,"onUpdate:selected":v[2]||(v[2]=V=>n.value=V),"select-strategy":"leaf"},{default:t(()=>[(p(!0),Q(le,null,me(s.value.Dossiers,V=>(p(),w(K,{title:V.Responsable,subtitle:V.Participants,value:V.Id,rounded:"",class:"my-1"},{append:t(({isSelected:P,select:M})=>[e(q,null,{default:t(()=>[e(f,null,{default:t(()=>[V.DocumentsSent?(p(),w(ye,{key:0,color:"green",class:"mr-2"},{default:t(()=>v[4]||(v[4]=[_("Envoyés")])),_:1,__:[4]})):W("",!0)]),_:2},1024),e(f,null,{default:t(()=>[e(ol,{density:"compact","hide-details":"","model-value":P,"onUpdate:modelValue":M},null,8,["model-value","onUpdate:modelValue"])]),_:2},1024)]),_:2},1024)]),_:2},1032,["title","subtitle","value"]))),256))]),_:1},8,["selected"])]),_:1})]),_:2},[(c=s.value.Dossiers)!=null&&c.length?{name:"append",fn:t(()=>[e(ze,{label:"Tout sélectionner",density:"compact","hide-details":"",indeterminate:!!n.value.length&&n.value.length!=(s.value.Dossiers||[]).length,"model-value":n.value.length==(s.value.Dossiers||[]).length,"onUpdate:modelValue":v[1]||(v[1]=V=>n.value=u.value?[]:(s.value.Dossiers||[]).map(P=>P.Id))},null,8,["indeterminate","model-value"])]),key:"0"}:void 0]),1024)):W("",!0)]}),_:1})]),_:1})]),_:1}),e(se,null,{default:t(()=>[e(ie),e(O,{disabled:!a.value||!n.value.length,onClick:v[3]||(v[3]=c=>m("send",a.value,n.value))},{append:t(()=>[e(_e,null,{default:t(()=>v[5]||(v[5]=[_("mdi-send")])),_:1,__:[5]})]),default:t(()=>[v[6]||(v[6]=_(" Envoyer "))]),_:1,__:[6]},8,["disabled"])]),_:1})]),_:1})}}}),Jn=Z({__name:"SendRelancePaiementCard",props:{camps:{}},emits:["send"],setup(l,{emit:o}){const r=l,m=o,a=D(0),s=D([]);async function d(){const i=await k.EventsSendRelancePaiementPreview({idCamp:a.value});i!==void 0&&(s.value=i||[],n.value=(i||[]).map(v=>v.Id))}const n=D([]),u=N(()=>n.value.length==s.value.length);return(i,v)=>{const y=at;return p(),w(Y,{title:"Envoyer une relance de paiement"},{default:t(()=>[e(J,null,{default:t(()=>[e(q,null,{default:t(()=>[e(f,{"align-self":"center",cols:"5"},{default:t(()=>[e(y,{camps:r.camps,label:"Séjour",modelValue:a.value,"onUpdate:modelValue":[v[0]||(v[0]=c=>a.value=c),d]},null,8,["camps","modelValue"])]),_:1}),e(f,{"align-self":"center"},{default:t(()=>[s.value?(p(),w(Y,{key:0,subtitle:"Dossiers à relancer"},mt({default:t(()=>[e(J,null,{default:t(()=>[e(we,{selectable:"",selected:n.value,"onUpdate:selected":v[2]||(v[2]=c=>n.value=c),"select-strategy":"leaf",density:"comfortable"},{default:t(()=>[(p(!0),Q(le,null,me(s.value,(c,V)=>(p(),w(K,{key:c.Id,title:c.Responsable,subtitle:F(aa)(c.LastEventFacture)?"":`Dernière demande : ${F(Ce).time(c.LastEventFacture)}`,value:c.Id,rounded:"",class:"my-1"},{append:t(({isSelected:P,select:M})=>[e(q,null,{default:t(()=>[e(f,{"align-self":"center"},{default:t(()=>[e(ye,{class:"mr-2",color:F(Ce).colorStatutPaiement(c.Bilan.Statut)},{default:t(()=>[_(T(c.Bilan.Recu)+" / "+T(c.Bilan.Demande),1)]),_:2},1032,["color"])]),_:2},1024),e(f,{"align-self":"center"},{default:t(()=>[e(ol,{density:"compact","hide-details":"","model-value":P,"onUpdate:modelValue":M},null,8,["model-value","onUpdate:modelValue"])]),_:2},1024)]),_:2},1024)]),_:2},1032,["title","subtitle","value"]))),128))]),_:1},8,["selected"])]),_:1})]),_:2},[s.value.length?{name:"append",fn:t(()=>[e(ze,{label:"Tout sélectionner",density:"compact","hide-details":"",indeterminate:!!n.value.length&&n.value.length!=s.value.length,"model-value":n.value.length==s.value.length,"onUpdate:modelValue":v[1]||(v[1]=c=>n.value=u.value?[]:s.value.map(V=>V.Id))},null,8,["indeterminate","model-value"])]),key:"0"}:void 0]),1024)):W("",!0)]),_:1})]),_:1})]),_:1}),e(se,null,{default:t(()=>[e(ie),e(O,{disabled:!a.value||!n.value.length,onClick:v[3]||(v[3]=c=>m("send",a.value,n.value))},{append:t(()=>[e(_e,null,{default:t(()=>v[4]||(v[4]=[_("mdi-send")])),_:1,__:[4]})]),default:t(()=>[v[5]||(v[5]=_(" Envoyer "))]),_:1,__:[5]},8,["disabled"])]),_:1})]),_:1})}}}),Gn={key:1,class:"text-center font-italic my-6"},Kn=Z({__name:"PannelDossiers",props:{initialDossier:{}},setup(l){const o=l;Ee(()=>{d(),o.initialDossier!==void 0&&v(o.initialDossier)}),Ie(()=>o.initialDossier,()=>{o.initialDossier!==void 0&&v(o.initialDossier)});const r=Ft("detailsPannel"),m=D(null),a=D(_a()),s=D([]);async function d(){const B=await k.GetCamps();B!==void 0&&(s.value=B||[])}function n(B){var j;m.value={length:((j=B.Dossiers)==null?void 0:j.length)||0,total:B.Total}}const u=Ft("dossierList");function i(){var B;(B=u.value)==null||B.searchDossiers()}async function v(B){await c(B),a.value=ga(B)}const y=D(null);async function c(B){const j=await k.DossiersLoad({id:B});j!==void 0&&(y.value=j)}async function V(B){c(B.Id),await k.EventsMarkMessagesSeen({idDossier:B.Id})!==void 0&&i()}async function P(){y.value!=null&&c(y.value.Dossier.Dossier.Id)}const M=D(!1);async function C(B){var ue;M.value=!1;const j=await k.DossiersCreate({idResponsable:B});j!==void 0&&(k.showMessage("Dossier créé avec succès."),await v(j.Id),(ue=r.value)==null||ue.showEditDossier())}async function b(B){const j=await k.DossiersUpdate(B);j!==void 0&&(k.showMessage("Dossier mis à jour avec succès."),y.value!=null&&(y.value.Dossier.Dossier=B,y.value.Dossier.Responsable=j.Responsable),i())}async function $(){if(y.value==null)return;const B=y.value.Dossier.Dossier.Id;await k.DossiersDelete({id:B})!==void 0&&(k.showMessage("Dossier supprimé avec succès."),y.value=null,i())}async function R(B){await k.DossiersMerge(B)!==void 0&&(k.showMessage("Dossier fusionné avec succès."),i(),c(B.To))}async function I(B){await k.ParticipantsCreate(B)!==void 0&&(k.showMessage("Participant ajouté avec succès."),P())}async function g(B){await k.ParticipantsUpdate(B)!==void 0&&(k.showMessage("Réglages du participant modifiés avec succès."),P())}async function de(B){await k.ParticipantsDelete({id:B})!==void 0&&(k.showMessage("Participant supprimé avec succès."),P())}async function pe(B){var ve;if(y.value==null)return;const j=((ve=y.value.Dossier.Participants)==null?void 0:ve.map(Se=>Se.Participant).filter(Se=>Se.Id!=B.Id))||[];!j.length||(j.forEach(Se=>{Se.Remises=B.Remises,Se.QuotientFamilial=B.QuotientFamilial,Se.IdCamp==B.IdCamp&&(Se.OptionPrix=B.OptionPrix)}),(await Promise.all(j.map(Se=>k.ParticipantsUpdate(Se)))).includes(void 0))||(k.showMessage("Réglages des participants modifiés avec succès."),P())}async function H(B){const j=await k.AidesCreate(B);if(j===void 0||(k.showMessage("Aide ajoutée avec succès."),y.value==null))return;const ue=y.value.Dossier.Aides||{},ve=ue[B.IdParticipant]||{};ve[j.Id]=j,ue[B.IdParticipant]=ve,y.value.Dossier.Aides=ue}async function S(B){await k.AidesUpdate(B)!==void 0&&(k.showMessage("Aide modifiée avec succès."),P())}async function G(B){await k.AidesJustificatifDelete({idAide:B})!==void 0&&(k.showMessage("Justificatif supprimé avec succès."),y.value!=null&&y.value.Dossier.AidesFiles&&delete y.value.Dossier.AidesFiles[B])}async function L(B,j){const ue=await k.AidesJustificatifUpload(B,{idAide:j});if(ue!==void 0&&(k.showMessage("Justificatif téléversé avec succès."),y.value!=null)){const ve=y.value.Dossier.AidesFiles||{};ve[j]=ue,y.value.Dossier.AidesFiles=ve}}async function A(B){await k.AidesDelete({id:B})!==void 0&&(k.showMessage("Aide supprimée avec succès."),P())}async function z(){var j;if(y.value==null)return;const B=await k.PaiementsCreate({idDossier:y.value.Dossier.Dossier.Id});B!==void 0&&(k.showMessage("Paiement créé avec succès."),P(),(j=r.value)==null||j.showEditPaiement(B))}async function oe(B){await k.PaiementsUpdate(B)!==void 0&&(k.showMessage("Paiement modifié avec succès."),P())}async function h(B){await k.PaiementsDelete({id:B.Id})!==void 0&&(k.showMessage("Paiement supprimé avec succès."),P())}async function U(B){y.value==null||await k.EventsSendMessage({IdDossier:y.value.Dossier.Dossier.Id,Contenu:B})===void 0||(k.showMessage("Message envoyé avec succès."),P())}async function ne(B){await k.EventsDelete({id:B.Id})!==void 0&&(k.showMessage("Message supprimé avec succès."),P())}async function x(){y.value==null||await k.EventsSendFacture({idDossier:y.value.Dossier.Dossier.Id})===void 0||(k.showMessage("Demande de règlement envoyé avec succès."),P())}const ee=D(!1),X=D(null);async function Me(B,j){X.value={Current:0,Total:j.length};const ue=await k.EventsSendDocumentsCamp({IdCamp:B,IdDossiers:j});if(ue===void 0){X.value=null;return}await gt(ue,ve=>X.value=ve,ve=>k.onError("Envoi des documents",ve)),X.value=null,P(),k.showMessage("Documents du séjour envoyés avec succès.")}const Ne=D(!1),ge=D(null);async function He(B,j){ge.value={Current:0,Total:j.length};const ue=await k.EventsSendRelancePaiement({IdDossiers:j});if(ue===void 0){ge.value=null;return}await gt(ue,ve=>ge.value=ve,ve=>k.onError("Envoi de la relance",ve)),ge.value=null,P(),k.showMessage("Toutes les relances ont été envoyées avec succès.")}return(B,j)=>(p(),w(q,{"no-gutters":"",class:"ma-2"},{default:t(()=>[e(f,{cols:"6"},{default:t(()=>[e(Y,{title:"Dossiers",subtitle:m.value==null?"-":`${m.value.length} affiché(s) / ${m.value.total}`},{append:t(()=>[e(O,{icon:"",size:"small",onClick:j[0]||(j[0]=ue=>M.value=!0)},{default:t(()=>[e(_e,{color:"green"},{default:t(()=>j[7]||(j[7]=[_("mdi-plus")])),_:1,__:[7]})]),_:1}),e(re,{thickness:"1",vertical:"",class:"mx-2"}),e(O,{size:"small"},{default:t(()=>[j[8]||(j[8]=_(" Actions ")),e(Pe,{activator:"parent"},{default:t(()=>[e(we,null,{default:t(()=>[e(K,{title:"Envoyer les documents",subtitle:"d'un séjour","prepend-icon":"mdi-mail",onClick:j[1]||(j[1]=ue=>ee.value=!0)}),e(re),e(K,{title:"Envoyer une relance de paiement","prepend-icon":"mdi-invoice-send",onClick:j[2]||(j[2]=ue=>Ne.value=!0)})]),_:1})]),_:1})]),_:1,__:[8]})]),default:t(()=>[e(J,null,{default:t(()=>{var ue;return[e(Yn,{camps:s.value,selected:(ue=y.value)==null?void 0:ue.Dossier.Dossier.Id,query:a.value,"onUpdate:query":j[3]||(j[3]=ve=>a.value=ve),onClick:V,onUpdate:n,ref_key:"dossierList",ref:u},null,8,["camps","selected","query"])]}),_:1})]),_:1},8,["subtitle"])]),_:1}),e(f,{cols:"6"},{default:t(()=>[y.value!=null?(p(),w(Hn,{key:0,dossier:y.value,camps:s.value,onUpdateDossier:b,onDeleteDossier:$,onMergeDossier:R,onCreateParticipant:I,onUpdateParticipant:g,onDeleteParticipant:de,onExpandParticipant:pe,onCreateAide:H,onDeleteAide:A,onUpdateAide:S,onDeleteFileAide:G,onUploadFileAide:L,onCreatePaiement:z,onUpdatePaiement:oe,onDeletePaiement:h,onSendMessage:U,onDeleteMessage:ne,onSendFacture:x,ref_key:"detailsPannel",ref:r},null,8,["dossier","camps"])):(p(),Q("div",Gn," Sélectionner un dossier... "))]),_:1}),e(te,{modelValue:M.value,"onUpdate:modelValue":j[4]||(j[4]=ue=>M.value=ue),"max-width":"400px"},{default:t(()=>[e(Qn,{onCreate:C})]),_:1},8,["modelValue"]),e(te,{modelValue:ee.value,"onUpdate:modelValue":j[5]||(j[5]=ue=>ee.value=ue),"max-width":"1000px"},{default:t(()=>[e(Wn,{camps:s.value,onSend:Me},null,8,["camps"])]),_:1},8,["modelValue"]),e(te,{modelValue:Ne.value,"onUpdate:modelValue":j[6]||(j[6]=ue=>Ne.value=ue),"max-width":"1000px"},{default:t(()=>[e(Jn,{camps:s.value,onSend:He},null,8,["camps"])]),_:1},8,["modelValue"]),e(te,{"model-value":X.value!=null,"max-width":"400px",persistent:""},{default:t(()=>[X.value?(p(),w(bt,{key:0,title:"Envoi des documents en cours",current:X.value.Current,total:X.value.Total},null,8,["current","total"])):W("",!0)]),_:1},8,["model-value"]),e(te,{"model-value":ge.value!=null,"max-width":"400px",persistent:""},{default:t(()=>[ge.value?(p(),w(bt,{key:0,title:"Envoi des relances en cours",current:ge.value.Current,total:ge.value.Total},null,8,["current","total"])):W("",!0)]),_:1},8,["model-value"])]),_:1}))}}),Xn=Z({__name:"inscriptions",setup(l){const o=lt(),r=N(()=>nu(o.currentRoute.value.query)),m=N(()=>r.value.tab||"insc"),a=N(()=>r.value.idDossier);function s(d){const n=o.currentRoute.value;o.push({path:n.path,query:{tab:d}})}return(d,n)=>(p(),Q(le,null,[e(vt,{title:"Suivi des inscriptions"},{default:t(()=>[e(xa,{"model-value":m.value,"onUpdate:modelValue":n[0]||(n[0]=u=>s(u))},{default:t(()=>[e(Nt,{value:"insc"},{default:t(()=>n[2]||(n[2]=[_("Nouvelles inscriptions")])),_:1,__:[2]}),e(Nt,{value:"doss"},{default:t(()=>n[3]||(n[3]=[_("Suivi des dossiers")])),_:1,__:[3]})]),_:1},8,["model-value"])]),_:1}),e(Ca,{"model-value":m.value},{default:t(()=>[e(ht,{value:"insc"},{default:t(()=>[e(rn,{onGoTo:F(Vt),onEmpty:n[1]||(n[1]=u=>F(Vt)())},null,8,["onGoTo"])]),_:1}),e(ht,{value:"doss"},{default:t(()=>[e(Kn,{"initial-dossier":a.value},null,8,["initial-dossier"])]),_:1})]),_:1},8,["model-value"])],64))}}),Zn=Z({__name:"PersonneEdit",props:{personne:{}},emits:["save"],setup(l,{emit:o}){const r=l,m=o,a=D(Ve(r.personne)),s=N(()=>!!(a.value.Nom&&a.value.Prenom));return(d,n)=>{const u=Ia,i=Ma;return p(),w(Y,{title:"Editer le profil"},{default:t(()=>[e(J,null,{default:t(()=>[e(rl,null,{default:t(()=>[e(q,null,{default:t(()=>[e(f,null,{default:t(()=>[e(ce,{autofocus:"","hide-details":"",label:"Nom",density:"compact",variant:"outlined",modelValue:a.value.Nom,"onUpdate:modelValue":n[0]||(n[0]=v=>a.value.Nom=v)},null,8,["modelValue"])]),_:1}),e(f,null,{default:t(()=>[e(ce,{"hide-details":"",label:"Prénom",density:"compact",variant:"outlined",modelValue:a.value.Prenom,"onUpdate:modelValue":n[1]||(n[1]=v=>a.value.Prenom=v)},null,8,["modelValue"])]),_:1}),e(f,null,{default:t(()=>[e(u,{modelValue:a.value.Sexe,"onUpdate:modelValue":n[2]||(n[2]=v=>a.value.Sexe=v)},null,8,["modelValue"])]),_:1}),e(f,null,{default:t(()=>[e(i,{modelValue:a.value.DateNaissance,"onUpdate:modelValue":n[3]||(n[3]=v=>a.value.DateNaissance=v)},null,8,["modelValue"])]),_:1})]),_:1})]),_:1})]),_:1}),e(se,null,{default:t(()=>[e(ie),e(O,{disabled:!s.value,onClick:n[4]||(n[4]=v=>m("save",a.value))},{default:t(()=>n[5]||(n[5]=[_("Enregistrer")])),_:1,__:[5]},8,["disabled"])]),_:1})]),_:1})}}}),eu=Z({__name:"annuaire",setup(l){const o=lt(),r=N(()=>uu(o.currentRoute.value.query)),m=N(()=>r.value.idPersonne);Ie(()=>m.value,()=>m.value!==void 0?v(m.value):null,{immediate:!0});const a=D([]),s=D("");async function d(){if(!s.value)return;const y=await k.PersonnesGet({search:s.value});y!==void 0&&(a.value=y||[])}async function n(){const y=await k.PersonnesCreate();y!==void 0&&(k.showMessage("Profil créé avec succès."),a.value.push(y),Ke(y.Id))}const u=D(null);async function i(y){u.value=null;const c=await k.PersonnesUpdate(y);if(c===void 0)return;k.showMessage("Profil modifié avec succès."),Ke();const V=a.value.findIndex(P=>P.Id==y.Id);a.value[V]=c}async function v(y){const c=await k.PersonnesLoad({id:y});c!==void 0&&(u.value=c)}return(y,c)=>{const V=ul;return p(),Q(le,null,[e(vt,{title:"Annuaire : personnes et organismes"},{default:t(()=>c[2]||(c[2]=[_(" TODO ")])),_:1,__:[2]}),e(Y,{class:"ma-2"},{append:t(()=>[e(O,{color:"green",onClick:n},{default:t(()=>c[3]||(c[3]=[_("Créer un nouveau profil")])),_:1,__:[3]})]),default:t(()=>[e(J,null,{default:t(()=>[e(q,null,{default:t(()=>[e(f,null,{default:t(()=>[e(V,{"prepend-inner-icon":"mdi-magnify",label:"Recherche",modelValue:s.value,"onUpdate:modelValue":[c[0]||(c[0]=P=>s.value=P),d]},null,8,["modelValue"]),e(we,null,{default:t(()=>[(p(!0),Q(le,null,me(a.value,P=>(p(),w(K,{title:P.Label,subtitle:F(Ce).dateNaissance(P.DateNaissance),"prepend-icon":F(Ce).sexeIcon(P.Sexe),onClick:M=>F(Ke)(P.Id)},mt({_:2},[P.IsTemp?{name:"append",fn:t(()=>[e(ye,{"prepend-icon":"mdi-alert",color:"warning"},{default:t(()=>c[4]||(c[4]=[_(" Ce profil est temporaire et devrait être identifié. ")])),_:1,__:[4]})]),key:"0"}:void 0]),1032,["title","subtitle","prepend-icon","onClick"]))),256))]),_:1})]),_:1}),e(f)]),_:1})]),_:1}),u.value!=null?(p(),w(te,{key:0,"model-value":u.value!=null,"onUpdate:modelValue":c[1]||(c[1]=P=>{u.value=null,F(Ke)(void 0)}),"max-width":"800px"},{default:t(()=>[e(Zn,{personne:u.value,onSave:i},null,8,["personne"])]),_:1},8,["model-value"])):W("",!0)]),_:1})],64)}}}),tu=[{path:"/",component:$a},{path:"/camps",component:un},{path:"/inscriptions",component:Xn},{path:"/annuaire",component:eu}],lu="/backoffice",Ge=ba({history:Va(lu),routes:tu});Ge.onError((l,o)=>{var r,m;(m=(r=l==null?void 0:l.message)==null?void 0:r.includes)!=null&&m.call(r,"Failed to fetch dynamically imported module")?localStorage.getItem("vuetify:dynamic-reload")?console.error("Dynamic import error, reloading page did not fix it",l):(console.log("Reloading page to fix dynamic import error"),localStorage.setItem("vuetify:dynamic-reload","true"),location.assign(o.fullPath)):console.error(l)});Ge.isReady().then(()=>{localStorage.removeItem("vuetify:dynamic-reload")});function rt(l){return l?Number(l):void 0}function au(l){const o=l;return{idCamp:rt(o.idCamp),idParticipant:rt(o.idParticipant)}}function wt(l){Ge.push({path:"/camps",query:{idCamp:l.IdCamp,idParticipant:l.Id}})}function nu(l){const o=l;return{tab:o.tab,idDossier:rt(o.idDossier)}}function Vt(l){Ge.push({path:"/inscriptions",query:{tab:"doss",idDossier:l}})}function uu(l){return{idPersonne:rt(l.idPersonne)}}function Ke(l){Ge.push({path:"/annuaire",query:{idPersonne:l}})}const iu=["innerHTML"],su=Z({__name:"App",setup(l){const o=_t({text:"",color:"secondary",action:void 0,timeout:4e3}),r=D(""),m=D("");return k.onError=(s,d)=>{r.value=s,m.value=d},k.showMessage=(s,d,n)=>{o.text=s,o.color=d||"success",o.action=n,o.timeout=1e4,o.timeout=4e3},lt().beforeEach(async(s,d)=>{if(!k.hasToken()&&s.path!=="/")return{path:"/"}}),(s,d)=>{const n=na("router-view");return p(),w(ia,null,{default:t(()=>[e(ua,null,{default:t(()=>[e(n),e(Rt,{style:{"z-index":"10000"},app:"","model-value":o.text!="","onUpdate:modelValue":d[1]||(d[1]=u=>o.text=""),timeout:o.timeout,color:o.color,location:"bottom left","close-on-content-click":""},{default:t(()=>[_(T(o.text)+" ",1),o.action?(p(),w(O,{key:0,onClick:d[0]||(d[0]=u=>o.action.action()),class:"ml-2"},{default:t(()=>[_(T(o.action.title),1)]),_:1})):W("",!0)]),_:1},8,["model-value","timeout","color"]),e(Rt,{app:"","model-value":r.value!="","onUpdate:modelValue":d[2]||(d[2]=u=>r.value=""),timeout:4e3,color:"red"},{default:t(()=>[E("b",null,T(r.value),1),E("div",{innerHTML:m.value},null,8,iu)]),_:1},8,["model-value"])]),_:1})]),_:1})}}}),_l=sa(su);_l.use(oa).use(Ge);_l.mount("#app");
