import{c8 as N,bR as xe,bT as $e,d as z,r as P,e as v,o as d,V as Ne,w as l,a as e,g as je,h as M,i as c,j as Ee,b as i,t as R,k as qe,l as S,c as D,F,_ as j,Y as L,a2 as ge,aw as Ve,m as x,a1 as I,s as q,O as ue,aL as He,aK as ze,f as H,Q as le,$ as X,bd as me,be as pe,A as oe,ac as ie,au as O,as as Ae,a6 as Be,U as de,aB as Oe,p as Je,q as Ke,S as Ge,ae as We,C as Xe,b4 as Ze,L as Qe,G as Ye,bp as el,u as ll,v as tl,aj as al,ak as nl,al as sl,ao as ol,ap as ul,I as he,W as il,X as rl,c4 as dl,aP as ml,bt as pl,aD as fl,n as cl,aT as vl,aU as Ue,aV as gl,aW as Vl,aX as bl}from"./VSnackbar-4WS0ckTD.js";import{_ as _l,a as yl,V as kl,b as hl}from"./EventSwitch.vue_vue_type_script_setup_true_lang-Ctu2lryD.js";import{p as Ul,_ as Sl,a as Pe,d as Re,b as De,c as Le,V as fe,g as Se}from"./VTabs-BL3VzwwU.js";import{b as w,c as A,k as ee,d as Q,e as te,f as be,l as Ce,V as W,h as E,g as ce,a as Me,i as K,m as Y,j as ve,n as we}from"./VTextarea-vvA5kftK.js";import{a as Cl,V as Fe}from"./FileCard.vue_vue_type_script_setup_true_lang-igzkYVuw.js";import{_ as Ie}from"./FilesDemande.vue_vue_type_script_setup_true_lang-BPqgrtDS.js";import"./VWindowItem-B61QShv2.js";import"./FilesRow.vue_vue_type_script_setup_true_lang-LKee0-LZ.js";const se={Complet:3,EnCours:2,NonCommence:1};se.Complet+"",se.EnCours+"",se.NonCommence+"";const G={AStatuer:0,Refuse:1,AttenteProfilInvalide:2,AttenteCampComplet:3,EnAttenteReponse:4,Inscrit:5},Ml={[G.AStatuer]:"A statuer",[G.Refuse]:"Refusé définitivement",[G.AttenteProfilInvalide]:"Profil limite",[G.AttenteCampComplet]:"Camp complet",[G.EnAttenteReponse]:"En attente de réponse",[G.Inscrit]:"Inscrit"},wl={Euros:0},J={NoFiche:0,Outdated:1,UpToDate:2};J.NoFiche+"",J.Outdated+"",J.UpToDate+"";class Al{constructor(o,a){this.baseURL=o,this.authToken=a}getHeaders(){return{Authorization:"Bearer "+this.authToken}}async Load(o){const a=this.baseURL+"/api/v1/espaceperso";this.startRequest();try{return(await N.get(a,{headers:this.getHeaders(),params:{token:o.token}})).data}catch(r){this.handleError(r)}}async SendMessage(o){const a=this.baseURL+"/api/v1/espaceperso/message";this.startRequest();try{return(await N.post(a,o,{headers:this.getHeaders()})).data}catch(r){this.handleError(r)}}async UpdateParticipants(o){const a=this.baseURL+"/api/v1/espaceperso/participants";this.startRequest();try{return await N.post(a,o,{headers:this.getHeaders()}),!0}catch(r){this.handleError(r)}}async CreateAide(o,a,r){const n=this.baseURL+"/api/v1/espaceperso/aide";this.startRequest();try{const f=new FormData;return f.append("document",o,o.name),f.append("aide",JSON.stringify(a)),await N.post(n,f,{headers:this.getHeaders(),params:{token:r.token}}),!0}catch(f){this.handleError(f)}}async GetStructureaides(){const o=this.baseURL+"/api/v1/espaceperso/structureaides";this.startRequest();try{return(await N.get(o,{headers:this.getHeaders()})).data}catch(a){this.handleError(a)}}async LoadJoomeo(o){const a=this.baseURL+"/api/v1/espaceperso/joomeo";this.startRequest();try{return(await N.get(a,{headers:this.getHeaders(),params:{token:o.token}})).data}catch(r){this.handleError(r)}}async LoadFichesanitaires(o){const a=this.baseURL+"/api/v1/espaceperso/fichesanitaires";this.startRequest();try{return(await N.get(a,{headers:this.getHeaders(),params:{token:o.token}})).data}catch(r){this.handleError(r)}}async UpdateFichesanitaire(o){const a=this.baseURL+"/api/v1/espaceperso/fichesanitaires";this.startRequest();try{return await N.post(a,o,{headers:this.getHeaders()}),!0}catch(r){this.handleError(r)}}async UploadVaccin(o,a){const r=this.baseURL+"/api/v1/espaceperso/fichesanitaires";this.startRequest();try{const n=new FormData;return n.append("file",o,o.name),(await N.put(r,n,{headers:this.getHeaders(),params:{token:a.token,idPersonne:String(a.idPersonne)}})).data}catch(n){this.handleError(n)}}async DeleteVaccin(o){const a=this.baseURL+"/api/v1/espaceperso/fichesanitaires";this.startRequest();try{return await N.delete(a,{headers:this.getHeaders(),params:{key:o.key}}),!0}catch(r){this.handleError(r)}}async TransfertFicheSanitaire(o){const a=this.baseURL+"/api/v1/espaceperso/fichesanitaires/transfert";this.startRequest();try{return await N.put(a,null,{headers:this.getHeaders(),params:{token:o.token,idPersonne:String(o.idPersonne)}}),!0}catch(r){this.handleError(r)}}async LoadSondages(o){const a=this.baseURL+"/api/v1/espaceperso/sondages";this.startRequest();try{return(await N.get(a,{headers:this.getHeaders(),params:{token:o.token}})).data}catch(r){this.handleError(r)}}async UpdateSondages(o){const a=this.baseURL+"/api/v1/espaceperso/sondages";this.startRequest();try{return await N.post(a,o,{headers:this.getHeaders()}),!0}catch(r){this.handleError(r)}}async LoadDocuments(o){const a=this.baseURL+"/api/v1/espaceperso/documents";this.startRequest();try{return(await N.get(a,{headers:this.getHeaders(),params:{token:o.token}})).data}catch(r){this.handleError(r)}}async UploadDocument(o,a){const r=this.baseURL+"/api/v1/espaceperso/documents";this.startRequest();try{const n=new FormData;return n.append("file",o,o.name),(await N.post(r,n,{headers:this.getHeaders(),params:{token:a.token,idDemande:String(a.idDemande),idPersonne:String(a.idPersonne)}})).data}catch(n){this.handleError(n)}}async DeleteDocument(o){const a=this.baseURL+"/api/v1/espaceperso/documents";this.startRequest();try{return await N.delete(a,{headers:this.getHeaders(),params:{key:o.key}}),!0}catch(r){this.handleError(r)}}}class Pl extends Al{constructor(o,a,r){super(r,""),this.onError=o,this.showMessage=a}handleError(o){const{kind:a,messageHtml:r}=$e(o);this.onError(a,r)}startRequest(){}}const C=new Pl((m,o)=>{},(m,o)=>{},xe()),Rl=z({__name:"NavBar",props:{title:{},hideMenu:{type:Boolean}},setup(m){const o=m,a="/static/repere/logo.png";return P(!1),(r,n)=>(d(),v(Ne,{rounded:"",elevation:"4",color:"secondary"},{append:l(()=>[qe(r.$slots,"default"),n[0]||(n[0]=S("div",{class:"mr-2"},null,-1))]),default:l(()=>[e(je,null,{default:l(()=>[e(M,null,{default:l(()=>[e(c,{"align-self":"center",cols:"auto"},{default:l(()=>[e(Ee,{width:"60",src:a})]),_:1}),e(c,{"align-self":"center"},{default:l(()=>[i(R(o.title),1)]),_:1})]),_:1})]),_:1})]),_:3}))}}),Dl=z({__name:"ParticipantsEditCard",props:{participants:{}},emits:["save"],setup(m,{emit:o}){const a=m,r=o,n=P(a.participants.map(f=>f.Participant));return(f,_)=>{const h=Ul;return d(),v(w,{title:"Modifier les options"},{default:l(()=>[e(A,null,{default:l(()=>[e(M,null,{default:l(()=>[(d(!0),D(F,null,j(a.participants,(k,b)=>(d(),v(c,{cols:"6"},{default:l(()=>[e(w,{title:L(Ve).label(k.Personne),subtitle:L(ge).label(k.Camp)},{default:l(()=>[e(A,null,{default:l(()=>[e(M,null,{default:l(()=>[e(c,null,{default:l(()=>[k.Camp.Navette.Actif?(d(),v(h,{key:0,modelValue:n.value[b].Navette,"onUpdate:modelValue":t=>n.value[b].Navette=t,hint:k.Camp.Navette.Commentaire},null,8,["modelValue","onUpdate:modelValue","hint"])):(d(),v(ee,{key:1},{default:l(()=>_[1]||(_[1]=[i("Ce séjour ne propose pas de navette.")])),_:1,__:[1]}))]),_:2},1024)]),_:2},1024),e(M,null,{default:l(()=>[e(c,null,{default:l(()=>[e(Q,{modelValue:n.value[b].Details,"onUpdate:modelValue":t=>n.value[b].Details=t,label:"Information libre",density:"compact",variant:"outlined","hide-details":""},null,8,["modelValue","onUpdate:modelValue"])]),_:2},1024)]),_:2},1024),e(M,null,{default:l(()=>[e(c,null,{default:l(()=>_[2]||(_[2]=[i(" TODO: option prix ")])),_:1,__:[2]})]),_:1})]),_:2},1024)]),_:2},1032,["title","subtitle"])]),_:2},1024))),256))]),_:1})]),_:1}),e(te,null,{default:l(()=>[e(be),e(x,{onClick:_[0]||(_[0]=k=>r("save",n.value)),color:"green"},{prepend:l(()=>[e(I,null,{default:l(()=>_[3]||(_[3]=[i("mdi-content-save-cog")])),_:1,__:[3]})]),default:l(()=>[_[4]||(_[4]=i(" Enregistrer"))]),_:1,__:[4]})]),_:1})]),_:1})}}}),Ll=z({__name:"AideCard",props:{dossier:{},structureaides:{}},emits:["save"],setup(m,{emit:o}){const a=m,r=o,n=P({Id:0,IdStructureaide:0,IdParticipant:(a.dossier.Participants||[])[0].Participant.Id,Valide:!1,Valeur:{Currency:wl.Euros,Cent:0},ParJour:!1,NbJoursMax:0}),f=P(null),_=q(()=>n.value?f.value!=null&&n.value.IdParticipant!=0&&n.value.IdStructureaide!=0&&n.value.Valeur.Cent!=0:!1),h=q(()=>(a.dossier.Participants||[]).map(b=>({title:Ve.label(b.Personne),subtitle:ge.label(b.Camp),value:b.Participant.Id}))),k=q(()=>Object.values(a.structureaides||{}).map(b=>({value:b.Id,title:b.Nom})));return(b,t)=>{const p=_l,s=Sl,V=Cl;return d(),v(w,{title:"Ajouter une aide extérieure"},{default:l(()=>[e(A,null,{default:l(()=>[e(M,null,{default:l(()=>[e(c,null,{default:l(()=>[e(Ce,{variant:"outlined",density:"comfortable",label:"Participant",modelValue:n.value.IdParticipant,"onUpdate:modelValue":t[0]||(t[0]=y=>n.value.IdParticipant=y),items:h.value},{item:l(({item:y,props:U})=>[e(W,ue(U,{title:y.raw.title,subtitle:y.raw.subtitle}),null,16,["title","subtitle"])]),_:1},8,["modelValue","items"])]),_:1}),e(c,null,{default:l(()=>[e(Ce,{variant:"outlined",density:"comfortable",label:"Structure","model-value":L(ze)(n.value.IdStructureaide),"onUpdate:modelValue":t[1]||(t[1]=y=>n.value.IdStructureaide=L(He)(y)),items:k.value,"no-data-text":"Aucune structure n'est disponible."},null,8,["model-value","items"])]),_:1})]),_:1}),e(M,null,{default:l(()=>[e(c,{"align-self":"center",cols:"5"},{default:l(()=>[e(p,{label:"Valeur",modelValue:n.value.Valeur,"onUpdate:modelValue":t[2]||(t[2]=y=>n.value.Valeur=y),"hide-details":""},null,8,["modelValue"])]),_:1}),e(c,{"align-self":"center"},{default:l(()=>[e(E,{modelValue:n.value.ParJour,"onUpdate:modelValue":t[3]||(t[3]=y=>n.value.ParJour=y),label:"Montant par jour","hide-details":""},null,8,["modelValue"])]),_:1}),e(c,{"align-self":"center"},{default:l(()=>[n.value.ParJour?(d(),v(s,{key:0,label:"Limite sur le nombre de jours",modelValue:n.value.NbJoursMax,"onUpdate:modelValue":t[4]||(t[4]=y=>n.value.NbJoursMax=y),min:0,hint:"0 pour ne pas limiter","persistent-hint":""},null,8,["modelValue"])):H("",!0)]),_:1})]),_:1}),e(M,null,{default:l(()=>[e(c,null,{default:l(()=>[e(V,{label:"Pièce justificative",onUpdate:t[5]||(t[5]=y=>f.value=y)})]),_:1})]),_:1})]),_:1}),e(te,null,{default:l(()=>[e(be),e(x,{color:"green",disabled:!_.value,onClick:t[6]||(t[6]=y=>r("save",n.value,f.value))},{default:l(()=>t[7]||(t[7]=[i(" Ajouter ")])),_:1,__:[7]},8,["disabled"])]),_:1})]),_:1})}}}),Fl=z({__name:"FinancesReglementCard",props:{token:{},dossier:{}},emits:["refresh"],setup(m,{emit:o}){return(a,r)=>(d(),v(w,{title:"Régler la pension",class:"mt-2"},{default:l(()=>[e(A,null,{default:l(()=>r[0]||(r[0]=[i(" TODO ")])),_:1,__:[0]})]),_:1}))}}),Il=z({__name:"FinancesCard",props:{token:{},dossier:{},isPaiementOpen:{type:Boolean}},emits:["refresh"],setup(m,{emit:o}){const a=m,r=o;le(b);const n=P(!1);async function f(p,s){n.value=!1,await C.CreateAide(s,p,{token:a.token})!==void 0&&(C.showMessage("Aide ajoutée avec succès (validation à venir). Merci !"),r("refresh"))}const _=q(()=>{const p=[];return Object.values(a.dossier.Aides||{}).forEach(s=>p.push(...Object.values(s||{}))),p}),h=q(()=>_.value.filter(p=>!p.Valide).length),k=P({});async function b(){const p=await C.GetStructureaides();p!==void 0&&(k.value=p||{})}const t=P(!1);return(p,s)=>(d(),v(w,{subtitle:"Réglement",class:"mt-2"},{append:l(()=>{var V;return[e(x,{size:"small",class:"mr-1",onClick:s[0]||(s[0]=y=>t.value=!0),disabled:!a.isPaiementOpen},{prepend:l(()=>[e(I,null,{default:l(()=>s[4]||(s[4]=[i("mdi-cash-plus")])),_:1,__:[4]})]),default:l(()=>[s[5]||(s[5]=i(" Régler "))]),_:1,__:[5]},8,["disabled"]),e(x,{size:"small",disabled:!((V=a.dossier.Participants)!=null&&V.length),onClick:s[1]||(s[1]=y=>n.value=!0)},{prepend:l(()=>[e(I,{color:"green"},{default:l(()=>s[6]||(s[6]=[i("mdi-plus")])),_:1,__:[6]})]),default:l(()=>[s[7]||(s[7]=i(" Ajouter une aide "))]),_:1,__:[7]},8,["disabled"])]}),default:l(()=>[e(A,null,{default:l(()=>[e(M,{class:"mt-2"},{default:l(()=>[e(c,null,{default:l(()=>s[8]||(s[8]=[i("Prix des séjours")])),_:1,__:[8]}),e(c,{cols:"4",class:"text-right"},{default:l(()=>[i(R(p.dossier.Bilan.Demande),1)]),_:1})]),_:1}),e(M,{class:"my-0"},{default:l(()=>[e(c,{cols:"auto"},{default:l(()=>[e(ce,null,{activator:l(({props:V})=>[e(I,me(pe(V)),{default:l(()=>s[9]||(s[9]=[i(" mdi-view-list ")])),_:2,__:[9]},1040)]),default:l(()=>[k.value?(d(),v(w,{key:0,title:"Aides extérieures"},{default:l(()=>[e(A,null,{default:l(()=>[(d(!0),D(F,null,j(_.value,V=>(d(),v(ee,{color:V.Valide?void 0:"orange",class:"mx-1"},{default:l(()=>[i(R(k.value[V.IdStructureaide].Nom)+" : "+R(L(X).montant(V.Valeur)),1)]),_:2},1032,["color"]))),256))]),_:1})]),_:1})):H("",!0)]),_:1})]),_:1}),e(c,null,{default:l(()=>[s[11]||(s[11]=i(" Dont aides extérieures ")),h.value?(d(),v(I,{key:0,color:"orange"},{default:l(()=>s[10]||(s[10]=[i("mdi-clock")])),_:1,__:[10]})):H("",!0)]),_:1,__:[11]}),e(c,{cols:"4",class:"text-right"},{default:l(()=>[i(R(p.dossier.Bilan.Aides),1)]),_:1})]),_:1}),e(Me,{thickness:"1"}),e(M,{class:"my-0"},{default:l(()=>[e(c,{cols:"auto"},{default:l(()=>[e(ce,null,{activator:l(({props:V})=>[e(I,me(pe(V)),{default:l(()=>s[12]||(s[12]=[i(" mdi-view-list ")])),_:2,__:[12]},1040)]),default:l(()=>[e(w,{title:"Paiements"},{default:l(()=>[e(A,null,{default:l(()=>[(d(!0),D(F,null,j(a.dossier.Paiements,V=>(d(),v(ee,{class:"mx-1"},{default:l(()=>[i(R(V.Payeur)+" : "+R(L(X).montant(V.Montant)),1)]),_:2},1024))),256))]),_:1})]),_:1})]),_:1})]),_:1}),e(c,null,{default:l(()=>s[13]||(s[13]=[i(" Paiements ")])),_:1,__:[13]}),e(c,{cols:"4",class:"text-right"},{default:l(()=>[i(R(p.dossier.Bilan.Recu),1)]),_:1})]),_:1}),e(Me,{thickness:"1"}),e(M,{class:"my-0"},{default:l(()=>[e(c,null,{default:l(()=>s[14]||(s[14]=[i("Montant restant à régler")])),_:1,__:[14]}),e(c,{cols:"4",class:"text-right"},{default:l(()=>[S("b",{class:oe(p.dossier.Bilan.Statut==L(se).Complet?"text-green":"text-orange")},R(p.dossier.Bilan.Restant),3)]),_:1})]),_:1})]),_:1}),e(K,{modelValue:n.value,"onUpdate:modelValue":s[2]||(s[2]=V=>n.value=V),"max-width":"800px"},{default:l(()=>[e(Ll,{dossier:a.dossier,structureaides:k.value,onSave:f},null,8,["dossier","structureaides"])]),_:1},8,["modelValue"]),e(K,{modelValue:t.value,"onUpdate:modelValue":s[3]||(s[3]=V=>t.value=V),"max-width":"800px"},{default:l(()=>[e(Fl,{token:a.token,dossier:a.dossier},null,8,["token","dossier"])]),_:1},8,["modelValue"])]),_:1}))}}),Tl={key:0},xl=z({__name:"JoomeoCard",props:{token:{}},setup(m){const o=m;le(r);const a=P(null);async function r(){const n=await C.LoadJoomeo({token:o.token});n!==void 0&&(a.value=n)}return(n,f)=>a.value==null?(d(),v(ie,{key:0,class:"mx-auto",width:"600px",type:"card"})):a.value.Loggin?(d(),v(w,{key:1,class:"mx-auto",title:"Identifiants et albums Joomeo",subtitle:"Retrouvez les photos prises dans nos séjours","min-width":"600px"},{default:l(()=>[e(A,null,{default:l(()=>[e(M,null,{default:l(()=>[e(c,null,{default:l(()=>[f[0]||(f[0]=i(" Identifiant : ")),S("b",null,R(a.value.Loggin),1)]),_:1,__:[0]}),e(c,null,{default:l(()=>[f[1]||(f[1]=i(" Mot de passe : ")),S("b",null,R(a.value.Password),1)]),_:1,__:[1]})]),_:1}),e(M,null,{default:l(()=>[e(c,null,{default:l(()=>{var _;return[(_=a.value.Albums)!=null&&_.length?H("",!0):(d(),D("i",Tl,"Aucun album n'est encore disponible.")),(d(!0),D(F,null,j(a.value.Albums,h=>(d(),v(ee,{class:"mx-1"},{default:l(()=>[i(R(h),1)]),_:2},1024))),256))]}),_:1})]),_:1})]),_:1}),e(te,null,{default:l(()=>[e(x,{block:"",color:"primary",variant:"outlined",href:a.value.SpaceURL,target:"_blank"},{default:l(()=>f[2]||(f[2]=[i(" Accéder à mon espace jooméo ")])),_:1,__:[2]},8,["href"])]),_:1})]),_:1})):(d(),v(O,{key:2,class:"mx-auto",type:"info"},{default:l(()=>f[3]||(f[3]=[i(" Il n'y a encore rien à voir... ")])),_:1,__:[3]}))}}),$l={class:"pa-2"},Nl=z({__name:"FichesanitaireForm",props:{fiche:{}},emits:["save","uploadVaccin","deleteVaccin","transfert"],setup(m,{emit:o}){const a=m,r=o,n=Ae(Be(a.fiche.Fichesanitaire)),f=P(a.fiche.RespoSecuriteSociale),_=q(()=>n.Allergies.Asthme||n.Allergies.Alimentaires||n.Allergies.Medicamenteuses||n.Allergies.Autres.length!=0),h=q(()=>a.fiche.Fichesanitaire.Mails||[]),k=q(()=>a.fiche.State==J.NoFiche?void 0:`Dernière modification : ${X.time(a.fiche.Fichesanitaire.LastModif)} / Propriétaire(s) :
         ${h.value.join(" ; ")}`);return(b,t)=>{const p=Ie;return d(),D("div",$l,[e(w,{title:a.fiche.Personne,subtitle:k.value},{default:l(()=>[e(A,null,{default:l(()=>{var s;return[a.fiche.IsLocked?(d(),v(O,{key:0},{default:l(()=>[i(" Votre adresse mail n'est pas reconnu dans notre système comme celle du responsable de cette fiche sanitaire. Elle est actuellement liée "+R(h.value.length>=2?"aux adresses":"à l'adresse")+" ",1),S("b",null,R(h.value.join(" ; ")),1),t[30]||(t[30]=i(". ")),t[31]||(t[31]=S("br",null,null,-1)),i(" Afin de protéger vos données, vous devez demander un transfert des droits de lecture et d'écriture. Un mail contenant un lien de transfert va être envoyé "+R(h.value.length>=2?"aux adresses":"à l'adresse")+" ",1),S("i",null,"("+R(h.value.join(" ; "))+")",1),t[32]||(t[32]=i(". ")),e(x,{variant:"outlined",onClick:t[0]||(t[0]=V=>r("transfert")),block:"",class:"mt-4"},{prepend:l(()=>[e(I,null,{default:l(()=>t[28]||(t[28]=[i("mdi-lock-open")])),_:1,__:[28]})]),default:l(()=>[t[29]||(t[29]=i(" Demander le transfert de la fiche sanitaire "))]),_:1,__:[29]})]),_:1,__:[30,31,32]})):a.fiche.State==L(J).UpToDate&&((s=a.fiche.VaccinsFiles)!=null&&s.length)?(d(),v(O,{key:1,type:"success"},{default:l(()=>t[33]||(t[33]=[i(" La fiche sanitaire est à jour. Merci ! ")])),_:1,__:[33]})):a.fiche.State==L(J).UpToDate?(d(),v(O,{key:2,type:"warning"},{default:l(()=>t[34]||(t[34]=[i(" La fiche sanitaire est à jour, mais vous n'avez déposé aucun vaccin. ")])),_:1,__:[34]})):a.fiche.State==L(J).Outdated?(d(),v(O,{key:3,type:"warning"},{default:l(()=>t[35]||(t[35]=[i(" Merci de bien vouloir vérifier que les données ci-dessous sont à jour et les valider. "),S("br",null,null,-1),i("Nous avons besoin de votre consentement, décrit dans l'encart "),S("b",null,"Validation",-1),i(" (en bas de page). ")])),_:1,__:[35]})):(d(),v(O,{key:4,type:"info"},{default:l(()=>t[36]||(t[36]=[i(" Merci de compléter la fiche sanitaire ci-dessous. ")])),_:1,__:[36]}))]}),_:1})]),_:1},8,["title","subtitle"]),a.fiche.IsLocked?H("",!0):(d(),D(F,{key:0},[e(w,{subtitle:"Vaccinations",class:"my-2"},{default:l(()=>[e(A,null,{default:l(()=>[t[37]||(t[37]=i(" Merci de joindre le scan des pages « vaccinations » du carnet de santé du participant. Seul le DTPolio est obligatoire pour être accueilli en séjour de vacances. ")),t[38]||(t[38]=S("br",null,null,-1)),t[39]||(t[39]=S("i",null," Si le participant n’a pas les vaccins obligatoires, joindre un certificat médical de contre-indication. ",-1)),e(p,{class:"mt-2",demande:a.fiche.VaccinsDemande,files:a.fiche.VaccinsFiles||[],"in-upload":!1,optionnelle:null,"show-upload-text":"",onUpload:t[1]||(t[1]=s=>r("uploadVaccin",s)),onDelete:t[2]||(t[2]=s=>r("deleteVaccin",s))},null,8,["demande","files"])]),_:1,__:[37,38,39]})]),_:1}),e(w,{subtitle:"Handicap",class:"my-2"},{default:l(()=>[e(A,null,{default:l(()=>[e(E,{modelValue:n.Handicap,"onUpdate:modelValue":t[3]||(t[3]=s=>n.Handicap=s),color:"primary",label:"Le participant est porteur de handicap. ","hide-details":""},null,8,["modelValue"]),e(de,null,{default:l(()=>[e(O,{modelValue:n.Handicap,"onUpdate:modelValue":t[4]||(t[4]=s=>n.Handicap=s),color:"blue-lighten-4"},{default:l(()=>t[40]||(t[40]=[i(" Merci de "),S("b",null,"contacter",-1),i(" au plus vite le directeur afin qu’un accueil individualisé puisse être mis en place. ")])),_:1,__:[40]},8,["modelValue"])]),_:1})]),_:1})]),_:1}),e(w,{subtitle:"Traitement",class:"my-2"},{default:l(()=>[e(A,null,{default:l(()=>[e(E,{modelValue:n.TraitementMedical,"onUpdate:modelValue":t[5]||(t[5]=s=>n.TraitementMedical=s),color:"primary",label:"Le participant suit un traitement médical pendant le séjour.","hide-details":""},null,8,["modelValue"]),e(de,null,{default:l(()=>[e(O,{modelValue:n.TraitementMedical,"onUpdate:modelValue":t[6]||(t[6]=s=>n.TraitementMedical=s),color:"blue-lighten-4"},{default:l(()=>t[41]||(t[41]=[i(" Merci de joindre une "),S("b",null,"ordonnance",-1),i(" récente et les "),S("b",null,"médicaments",-1),i(" correspondants (avec la notice). Aucun médicament ne pourra être pris sans ordonnance. ")])),_:1,__:[41]},8,["modelValue"])]),_:1})]),_:1})]),_:1}),e(w,{subtitle:"Maladies",class:"my-2"},{default:l(()=>[e(A,null,{default:l(()=>[t[42]||(t[42]=i(" Le participant a-t-il déjà eu les maladies suivantes ? ")),e(M,{class:"mt-2"},{default:l(()=>[e(c,{cols:"3",class:"py-0"},{default:l(()=>[e(E,{modelValue:n.Maladies.Rubeole,"onUpdate:modelValue":t[7]||(t[7]=s=>n.Maladies.Rubeole=s),color:"primary",label:"Rubéole","hide-details":""},null,8,["modelValue"])]),_:1}),e(c,{cols:"3",class:"py-0"},{default:l(()=>[e(E,{modelValue:n.Maladies.Varicelle,"onUpdate:modelValue":t[8]||(t[8]=s=>n.Maladies.Varicelle=s),color:"primary",label:"Varicelle","hide-details":""},null,8,["modelValue"])]),_:1}),e(c,{cols:"3",class:"py-0"},{default:l(()=>[e(E,{modelValue:n.Maladies.Angine,"onUpdate:modelValue":t[9]||(t[9]=s=>n.Maladies.Angine=s),color:"primary",label:"Angine","hide-details":""},null,8,["modelValue"])]),_:1}),e(c,{cols:"3",class:"py-0"},{default:l(()=>[e(E,{modelValue:n.Maladies.Oreillons,"onUpdate:modelValue":t[10]||(t[10]=s=>n.Maladies.Oreillons=s),color:"primary",label:"Oreillons","hide-details":""},null,8,["modelValue"])]),_:1}),e(c,{cols:"3",class:"py-0"},{default:l(()=>[e(E,{modelValue:n.Maladies.Scarlatine,"onUpdate:modelValue":t[11]||(t[11]=s=>n.Maladies.Scarlatine=s),color:"primary",label:"Scarlatine","hide-details":""},null,8,["modelValue"])]),_:1}),e(c,{cols:"3",class:"py-0"},{default:l(()=>[e(E,{modelValue:n.Maladies.Coqueluche,"onUpdate:modelValue":t[12]||(t[12]=s=>n.Maladies.Coqueluche=s),color:"primary",label:"Coqueluche","hide-details":""},null,8,["modelValue"])]),_:1}),e(c,{cols:"3",class:"py-0"},{default:l(()=>[e(E,{modelValue:n.Maladies.Otite,"onUpdate:modelValue":t[13]||(t[13]=s=>n.Maladies.Otite=s),color:"primary",label:"Otite","hide-details":""},null,8,["modelValue"])]),_:1}),e(c,{cols:"3",class:"py-0"},{default:l(()=>[e(E,{modelValue:n.Maladies.Rougeole,"onUpdate:modelValue":t[14]||(t[14]=s=>n.Maladies.Rougeole=s),color:"primary",label:"Rougeole","hide-details":""},null,8,["modelValue"])]),_:1}),e(c,{cols:"3",class:"py-0"},{default:l(()=>[e(E,{modelValue:n.Maladies.Rhumatisme,"onUpdate:modelValue":t[15]||(t[15]=s=>n.Maladies.Rhumatisme=s),color:"primary",label:"Rhumatisme articulaire aigü ","hide-details":""},null,8,["modelValue"])]),_:1})]),_:1})]),_:1,__:[42]})]),_:1}),e(w,{subtitle:"Allergies",class:"my-2"},{default:l(()=>[e(A,null,{default:l(()=>[t[43]||(t[43]=i(" Le participant a-t-il une des allergies suivantes ? ")),e(M,{class:"mt-2"},{default:l(()=>[e(c,{"align-self":"center",cols:"3",class:"py-0"},{default:l(()=>[e(E,{modelValue:n.Allergies.Asthme,"onUpdate:modelValue":t[16]||(t[16]=s=>n.Allergies.Asthme=s),color:"primary",label:"Asthme","hide-details":""},null,8,["modelValue"])]),_:1}),e(c,{"align-self":"center",cols:"3",class:"py-0"},{default:l(()=>[e(E,{modelValue:n.Allergies.Alimentaires,"onUpdate:modelValue":t[17]||(t[17]=s=>n.Allergies.Alimentaires=s),color:"primary",label:"Alimentaires","hide-details":""},null,8,["modelValue"])]),_:1}),e(c,{"align-self":"center",cols:"3",class:"py-0"},{default:l(()=>[e(E,{modelValue:n.Allergies.Medicamenteuses,"onUpdate:modelValue":t[18]||(t[18]=s=>n.Allergies.Medicamenteuses=s),color:"primary",label:"Médicamenteuses","hide-details":""},null,8,["modelValue"])]),_:1}),e(c,{"align-self":"center",cols:"3",class:"py-0"},{default:l(()=>[e(Q,{density:"compact",variant:"outlined","hide-details":"",label:"Autres allergies",modelValue:n.Allergies.Autres,"onUpdate:modelValue":t[19]||(t[19]=s=>n.Allergies.Autres=s)},null,8,["modelValue"])]),_:1})]),_:1}),e(de,null,{default:l(()=>[_.value?(d(),v(M,{key:0},{default:l(()=>[e(c,null,{default:l(()=>[e(Y,{variant:"outlined",label:"Conduite à tenir",modelValue:n.Allergies.ConduiteATenir,"onUpdate:modelValue":t[20]||(t[20]=s=>n.Allergies.ConduiteATenir=s),hint:"Préciser la cause de l’allergie et la conduite à tenir (si automédication le signaler). Si un PAI a été mis en place durant le temps scolaire, merci de nous le signaler.","persistent-hint":"",rules:[L(Oe).required("Merci de nous informer de la conduite à tenir en cas d'allergie.")]},null,8,["modelValue","rules"])]),_:1})]),_:1})):H("",!0)]),_:1})]),_:1,__:[43]})]),_:1}),e(w,{subtitle:"Divers",class:"my-2"},{default:l(()=>[e(A,null,{default:l(()=>[e(M,null,{default:l(()=>[e(c,null,{default:l(()=>[e(Y,{variant:"outlined",label:"Difficultés de santé",modelValue:n.DifficultesSante,"onUpdate:modelValue":t[21]||(t[21]=s=>n.DifficultesSante=s),hint:"Indiquer les difficultés de santé (maladie, accident, crises convulsives, hospitalisation, opération, rééducation) en précisant les dates et les précautions à prendre.","persistent-hint":""},null,8,["modelValue"])]),_:1}),e(c,null,{default:l(()=>[e(Y,{variant:"outlined",label:"Recommandations utiles",modelValue:n.Recommandations,"onUpdate:modelValue":t[22]||(t[22]=s=>n.Recommandations=s),hint:"Préciser si le participant porte des lunettes, des lentilles, des prothèses auditives, des prothèses dentaires...","persistent-hint":""},null,8,["modelValue"])]),_:1})]),_:1})]),_:1})]),_:1}),e(w,{subtitle:"Médecin traitant",class:"my-2"},{default:l(()=>[e(A,null,{default:l(()=>[e(M,null,{default:l(()=>[e(c,null,{default:l(()=>[e(Q,{variant:"outlined",density:"compact",label:"Nom",modelValue:n.Medecin.Nom,"onUpdate:modelValue":t[23]||(t[23]=s=>n.Medecin.Nom=s),"hide-details":""},null,8,["modelValue"])]),_:1}),e(c,null,{default:l(()=>[e(Q,{variant:"outlined",density:"compact",label:"Téléphone","model-value":L(X).tel(n.Medecin.Tel),"onUpdate:modelValue":t[24]||(t[24]=s=>n.Medecin.Tel=s),"hide-details":""},null,8,["model-value"])]),_:1})]),_:1})]),_:1})]),_:1}),e(w,{subtitle:"Responsable légal",class:"my-2"},{default:l(()=>[e(A,null,{default:l(()=>[e(M,null,{default:l(()=>[e(c,{"align-self":"center"},{default:l(()=>{var s;return[t[45]||(t[45]=i(" Téléphone : ")),(s=a.fiche.RespoTels)!=null&&s.length?H("",!0):(d(),v(ee,{key:0,label:""},{default:l(()=>t[44]||(t[44]=[i("Aucun numéro")])),_:1,__:[44]})),(d(!0),D(F,null,j(a.fiche.RespoTels,V=>(d(),v(ee,{label:"",class:"mx-1"},{default:l(()=>[i(R(L(X).tel(V)),1)]),_:2},1024))),256))]}),_:1,__:[45]}),e(c,{"align-self":"center"},{default:l(()=>[e(Q,{variant:"outlined",density:"compact",label:"Numéro de contact","model-value":L(X).tel(n.Tel),"onUpdate:modelValue":t[25]||(t[25]=s=>n.Tel=s),hint:"Numéro de téléphone supplémentaire (optionnel)","persistent-hint":""},null,8,["model-value"])]),_:1})]),_:1}),e(M,null,{default:l(()=>[e(c,null,{default:l(()=>[e(Q,{variant:"outlined",density:"compact",label:"Sécurité sociale",modelValue:f.value,"onUpdate:modelValue":t[26]||(t[26]=s=>f.value=s),"hide-details":""},null,8,["modelValue"])]),_:1})]),_:1})]),_:1})]),_:1}),e(w,{class:"mt-4",variant:"outlined",color:"success",title:"Validation"},{default:l(()=>[e(A,{class:"text-black"},{default:l(()=>t[46]||(t[46]=[i(" Le responsable légal déclare "),S("b",null,"exacts",-1),i(" les renseignements portés sur ce formulaire et autorise le responsable du séjour à prendre, le cas échéant, "),S("b",null,"toutes mesures",-1),i(" (traitement médical, hospitalisation, intervention chirurgicale) rendues nécessaires par l'état du participant. Il autorise également, si nécessaire, le directeur du séjour à faire sortir le participant de l’hôpital après une hospitalisation. ")])),_:1,__:[46]}),e(te,null,{default:l(()=>[e(x,{block:"",color:"success",onClick:t[27]||(t[27]=s=>r("save",n,f.value))},{prepend:l(()=>[e(I,null,{default:l(()=>t[47]||(t[47]=[i("mdi-content-save")])),_:1,__:[47]})]),default:l(()=>[i(" Enregistrer la fiche sanitaire de "+R(a.fiche.Personne),1)]),_:1})]),_:1})]),_:1})],64))])}}}),jl=z({__name:"FichessanitairesCard",props:{token:{}},emits:["close","updateNotifs"],setup(m,{emit:o}){const a=m,r=o;le(_);const n=P(0),f=P([]);async function _(){const p=await C.LoadFichesanitaires({token:a.token});p!==void 0&&(f.value=p.Fiches||[],f.value.length&&n.value==0&&(n.value=f.value[0].Fichesanitaire.IdPersonne),r("updateNotifs",p.ToFillCount))}async function h(p,s){await C.UpdateFichesanitaire({Token:a.token,Fichesanitaire:p,SecuriteSocialeResponsable:s})!==void 0&&(C.showMessage("La fiche sanitaire a bien été enregistrée. Merci !"),_())}async function k(p,s){const V=f.value[p];await C.UploadVaccin(s,{token:a.token,idPersonne:V.Fichesanitaire.IdPersonne})!==void 0&&(_(),C.showMessage("Le vaccin a bien été téléversé. Merci !"))}async function b(p,s){f.value[p],await C.DeleteVaccin({key:s.Key})!==void 0&&(_(),C.showMessage("Le vaccin a bien été supprimé."))}async function t(p){r("close"),await C.TransfertFicheSanitaire({token:a.token,idPersonne:p.IdPersonne})!==void 0&&C.showMessage("Mail de transfert envoyé avec succès.")}return(p,s)=>(d(),v(w,{title:"Fiches sanitaires et vaccins"},{append:l(()=>[e(De,{modelValue:n.value,"onUpdate:modelValue":s[0]||(s[0]=V=>n.value=V)},{default:l(()=>[(d(!0),D(F,null,j(f.value,V=>(d(),v(Le,{value:V.Fichesanitaire.IdPersonne},{default:l(()=>{var y;return[i(R(V.Personne)+" ",1),V.State==L(J).NoFiche||V.State==L(J).Outdated||!((y=V.VaccinsFiles)!=null&&y.length)?(d(),v(I,{key:0,class:"ml-2",color:"warning"},{default:l(()=>s[1]||(s[1]=[i(" mdi-alert ")])),_:1,__:[1]})):(d(),v(I,{key:1,class:"ml-2",color:"success"},{default:l(()=>s[2]||(s[2]=[i(" mdi-check ")])),_:1,__:[2]}))]}),_:2},1032,["value"]))),256))]),_:1},8,["modelValue"])]),default:l(()=>[e(A,null,{default:l(()=>[e(Pe,{"model-value":n.value},{default:l(()=>[(d(!0),D(F,null,j(f.value,(V,y)=>(d(),v(Re,{value:V.Fichesanitaire.IdPersonne},{default:l(()=>[e(Nl,{fiche:V,onSave:h,onUploadVaccin:U=>k(y,U),onDeleteVaccin:U=>b(y,U),onTransfert:U=>t(V.Fichesanitaire)},null,8,["fiche","onUploadVaccin","onDeleteVaccin","onTransfert"])]),_:2},1032,["value"]))),256))]),_:1},8,["model-value"])]),_:1})]),_:1}))}}),El=Ke({name:String,itemAriaLabel:{type:String,default:"$vuetify.rating.ariaLabel.item"},activeColor:String,color:String,clearable:Boolean,disabled:Boolean,emptyIcon:{type:he,default:"$ratingEmpty"},fullIcon:{type:he,default:"$ratingFull"},halfIncrements:Boolean,hover:Boolean,length:{type:[Number,String],default:5},readonly:Boolean,modelValue:{type:[Number,String],default:0},itemLabels:Array,itemLabelPosition:{type:String,default:"top",validator:m=>["top","bottom"].includes(m)},ripple:Boolean,...ul(),...ol(),...sl(),...nl(),...al()},"VRating"),ql=Je()({name:"VRating",props:El(),emits:{"update:modelValue":m=>!0},setup(m,o){let{slots:a}=o;const{t:r}=Ge(),{themeClasses:n}=We(m),f=Xe(m,"modelValue"),_=q(()=>Ze(parseFloat(f.value),0,Number(m.length))),h=q(()=>Qe(Number(m.length),1)),k=q(()=>h.value.flatMap(u=>m.halfIncrements?[u-.5,u]:[u])),b=Ye(-1),t=q(()=>k.value.map(u=>{const $=m.hover&&b.value>-1,g=_.value>=u,T=b.value>=u,Z=($?T:g)?m.fullIcon:m.emptyIcon,re=m.activeColor??m.color,ne=g||T?re:m.color;return{isFilled:g,isHovered:T,icon:Z,color:ne}})),p=q(()=>[0,...k.value].map(u=>{function $(){b.value=u}function g(){b.value=-1}function T(){m.disabled||m.readonly||(f.value=_.value===u&&m.clearable?0:u)}return{onMouseenter:m.hover?$:void 0,onMouseleave:m.hover?g:void 0,onClick:T}})),s=el(),V=q(()=>m.name??`v-rating-${s}`);function y(u){var ye,ke;let{value:$,index:g,showStar:T=!0}=u;const{onMouseenter:ae,onMouseleave:Z,onClick:re}=p.value[g+1],ne=`${V.value}-${String($).replace(".","-")}`,_e={color:(ye=t.value[g])==null?void 0:ye.color,density:m.density,disabled:m.disabled,icon:(ke=t.value[g])==null?void 0:ke.icon,ripple:m.ripple,size:m.size,variant:"plain"};return S(F,null,[S("label",{for:ne,class:oe({"v-rating__item--half":m.halfIncrements&&$%1>0,"v-rating__item--full":m.halfIncrements&&$%1===0}),onMouseenter:ae,onMouseleave:Z,onClick:re},[S("span",{class:"v-rating__hidden"},[r(m.itemAriaLabel,$,m.length)]),T?a.item?a.item({...t.value[g],props:_e,value:$,index:g,rating:_.value}):e(x,ue({"aria-label":r(m.itemAriaLabel,$,m.length)},_e),null):void 0]),S("input",{class:"v-rating__hidden",name:V.value,id:ne,type:"radio",value:$,checked:_.value===$,tabindex:-1,readonly:m.readonly,disabled:m.disabled},null)])}function U(u){return a["item-label"]?a["item-label"](u):u.label?S("span",null,[u.label]):S("span",null,[i(" ")])}return ll(()=>{var $;const u=!!(($=m.itemLabels)!=null&&$.length)||a["item-label"];return e(m.tag,{class:oe(["v-rating",{"v-rating--hover":m.hover,"v-rating--readonly":m.readonly},n.value,m.class]),style:tl(m.style)},{default:()=>[e(y,{value:0,index:-1,showStar:!1},null),h.value.map((g,T)=>{var ae,Z;return S("div",{class:"v-rating__wrapper"},[u&&m.itemLabelPosition==="top"?U({value:g,index:T,label:(ae=m.itemLabels)==null?void 0:ae[T]}):void 0,S("div",{class:"v-rating__item"},[m.halfIncrements?S(F,null,[e(y,{value:g-.5,index:T*2},null),e(y,{value:g,index:T*2+1},null)]):e(y,{value:g,index:T},null)]),u&&m.itemLabelPosition==="bottom"?U({value:g,index:T,label:(Z=m.itemLabels)==null?void 0:Z[T]}):void 0])})]})}),{}}}),B=z({__name:"RatingField",props:il({label:{}},{modelValue:{required:!0},modelModifiers:{}}),emits:["update:modelValue"],setup(m){const o=m,a=rl(m,"modelValue");return(r,n)=>(d(),v(M,{"no-gutters":""},{default:l(()=>[e(c,{cols:"12"},{default:l(()=>[i(R(o.label),1)]),_:1}),e(c,{cols:"12"},{default:l(()=>[e(ql,{hover:"",color:"primary",length:4,modelValue:a.value,"onUpdate:modelValue":n[0]||(n[0]=f=>a.value=f),size:"32"},null,8,["modelValue"])]),_:1})]),_:1}))}}),Hl={key:1},zl=z({__name:"SondagesCard",props:{token:{},initialCamp:{}},setup(m){const o=m;le(n);const a=P(0),r=P(null);async function n(){const h=await C.LoadSondages({token:o.token});if(h===void 0)return;r.value=h||[];const k=(h||[]).filter(f);(h||[]).map(b=>b.Sondage.IdCamp).includes(o.initialCamp)?a.value=o.initialCamp:k.length?a.value=k[0].Sondage.IdCamp:a.value==0&&(h!=null&&h.length)&&(a.value=h[0].Sondage.IdCamp)}function f(h){return dl(h.Sondage.Modified)}async function _(h){await C.UpdateSondages({Token:o.token,Id:h.Id,IdCamp:h.IdCamp,Reponse:h})!==void 0&&(n(),C.showMessage("Votre réponse a bien été enregistrée. Merci !"))}return(h,k)=>{var b;return r.value==null?(d(),v(ie,{key:0,type:"card"})):r.value!=null?(d(),v(w,{key:1,title:"Enquête de satisfaction",width:(b=r.value)!=null&&b.length?void 0:"600px",class:"mx-auto"},{default:l(()=>[e(A,null,{default:l(()=>[r.value.length?(d(),v(O,{key:0,color:"secondary",icon:"mdi-comment-quote"},{default:l(()=>k[1]||(k[1]=[i(" Afin d'améliorer nos prestations, nous avons à cœur de vous laisser la parole. Vos suggestions, remarques et ressentis nous aiderons à améliorer nos séjours. Merci d'avance de ce temps que vous réserverez pour répondre à cette courte enquête. ")])),_:1,__:[1]})):(d(),D("div",Hl," L'enquête n'est pas encore ouverte. Vous pouvez repasser à la fin du séjour. ")),r.value.length?(d(),v(De,{key:2,modelValue:a.value,"onUpdate:modelValue":k[0]||(k[0]=t=>a.value=t),grow:""},{default:l(()=>[(d(!0),D(F,null,j(r.value,t=>(d(),v(Le,{value:t.Sondage.IdCamp},{default:l(()=>[i(R(t.Camp)+" ",1),f(t)?(d(),v(fe,{key:0,inline:"",content:"Nouveau",color:"pink"})):H("",!0)]),_:2},1032,["value"]))),256))]),_:1},8,["modelValue"])):H("",!0),e(Pe,{"model-value":a.value,class:"mt-2"},{default:l(()=>[(d(!0),D(F,null,j(r.value,t=>(d(),v(Re,{value:t.Sondage.IdCamp},{default:l(()=>[e(w,{subtitle:"Vos impressions sur le séjour"},{default:l(()=>[e(A,null,{default:l(()=>[e(M,null,{default:l(()=>[e(c,null,{default:l(()=>[e(B,{label:"Informations avant le séjour",modelValue:t.Sondage.InfosAvantSejour,"onUpdate:modelValue":p=>t.Sondage.InfosAvantSejour=p},null,8,["modelValue","onUpdate:modelValue"])]),_:2},1024),e(c,null,{default:l(()=>[e(B,{label:"Informations pendant le séjour",modelValue:t.Sondage.InfosPendantSejour,"onUpdate:modelValue":p=>t.Sondage.InfosPendantSejour=p},null,8,["modelValue","onUpdate:modelValue"])]),_:2},1024),e(c,null,{default:l(()=>[e(B,{label:"L'hébergement",modelValue:t.Sondage.Hebergement,"onUpdate:modelValue":p=>t.Sondage.Hebergement=p},null,8,["modelValue","onUpdate:modelValue"])]),_:2},1024)]),_:2},1024),e(M,null,{default:l(()=>[e(c,null,{default:l(()=>[e(B,{label:"Les activités",modelValue:t.Sondage.Activites,"onUpdate:modelValue":p=>t.Sondage.Activites=p},null,8,["modelValue","onUpdate:modelValue"])]),_:2},1024),e(c,null,{default:l(()=>[e(B,{label:"Le thème",modelValue:t.Sondage.Theme,"onUpdate:modelValue":p=>t.Sondage.Theme=p},null,8,["modelValue","onUpdate:modelValue"])]),_:2},1024),e(c,null,{default:l(()=>[e(B,{label:"La nourriture",modelValue:t.Sondage.Nourriture,"onUpdate:modelValue":p=>t.Sondage.Nourriture=p},null,8,["modelValue","onUpdate:modelValue"])]),_:2},1024)]),_:2},1024),e(M,null,{default:l(()=>[e(c,null,{default:l(()=>[e(B,{label:"L'hygiène corporelle et vestimentaire",modelValue:t.Sondage.Hygiene,"onUpdate:modelValue":p=>t.Sondage.Hygiene=p},null,8,["modelValue","onUpdate:modelValue"])]),_:2},1024),e(c,null,{default:l(()=>[e(B,{label:"L'ambiance du groupe",modelValue:t.Sondage.Ambiance,"onUpdate:modelValue":p=>t.Sondage.Ambiance=p},null,8,["modelValue","onUpdate:modelValue"])]),_:2},1024),e(c,null,{default:l(()=>[e(B,{label:"Le ressenti global de votre enfant",modelValue:t.Sondage.Ressenti,"onUpdate:modelValue":p=>t.Sondage.Ressenti=p},null,8,["modelValue","onUpdate:modelValue"])]),_:2},1024)]),_:2},1024),e(M,null,{default:l(()=>[e(c,null,{default:l(()=>[e(Y,{rows:"3",label:"Message du participant",hint:"Si le participant souhaite donner son avis sur le séjour qu'il a vécu, la parole lui est donnée ci-dessus. Des regrets ? De bons souvenirs ? Des propositions d'amélioration ?","persistent-hint":"",modelValue:t.Sondage.MessageEnfant,"onUpdate:modelValue":p=>t.Sondage.MessageEnfant=p},null,8,["modelValue","onUpdate:modelValue"])]),_:2},1024),e(c,null,{default:l(()=>[e(Y,{rows:"3",label:"Message du responsable",hint:"En tant que responsable, vous avez une remarque, une suggestion, un ressenti à partager : avec plaisir ! N'hésitez pas à aborder tous les domaines : encadrement, activités, hébergement, repas, linge, etc. Nous prendrons soin de vous apporter une réponse en cas de besoin.","persistent-hint":"",modelValue:t.Sondage.MessageResponsable,"onUpdate:modelValue":p=>t.Sondage.MessageResponsable=p},null,8,["modelValue","onUpdate:modelValue"])]),_:2},1024)]),_:2},1024)]),_:2},1024),e(te,null,{default:l(()=>[e(x,{block:"",variant:"outlined",color:"success",onClick:p=>_(t.Sondage)},{prepend:l(()=>[e(I,null,{default:l(()=>k[2]||(k[2]=[i("mdi-content-save")])),_:1,__:[2]})]),default:l(()=>[i(" Enregistrer mon retour pour le séjour "+R(t.Camp),1)]),_:2},1032,["onClick"])]),_:2},1024)]),_:2},1024)]),_:2},1032,["value"]))),256))]),_:1},8,["model-value"])]),_:1})]),_:1},8,["width"])):H("",!0)}}}),Bl=z({__name:"DocumentsCard",props:{token:{}},emits:["updateNotifs"],setup(m,{emit:o}){const a=m,r=o;le(f);const n=P(null);async function f(){const k=await C.LoadDocuments({token:a.token});k!==void 0&&(n.value=k||[])}async function _(k,b,t){await C.UploadDocument(t,{token:a.token,idPersonne:k,idDemande:b})!==void 0&&(C.showMessage("Document téléversé avec succès. Merci !"),await f(),r("updateNotifs",n.value.ToFillCount))}async function h(k){await C.DeleteDocument({key:k.Key})!==void 0&&(C.showMessage("Document supprimé avec succès."),await f(),r("updateNotifs",n.value.ToFillCount))}return(k,b)=>{const t=yl,p=Ie;return d(),v(w,{title:"Documents des séjours",subtitle:"Vous retrouvez ici les documents des séjours auxquels vous participez, à lire ou remplir."},{append:l(()=>b[0]||(b[0]=[])),default:l(()=>[n.value!=null?(d(),v(A,{key:0},{default:l(()=>[e(ve,null,{default:l(()=>{var s,V;return[e(we,null,{default:l(()=>b[1]||(b[1]=[i("À lire")])),_:1,__:[1]}),(s=n.value.FilesToRead)!=null&&s.length?H("",!0):(d(),v(W,{key:0},{default:l(()=>b[2]||(b[2]=[S("i",null,"Aucun document à lire.",-1)])),_:1,__:[2]})),(d(!0),D(F,null,j(n.value.FilesToRead,y=>(d(),D(F,null,[(d(!0),D(F,null,j(y.Files,U=>(d(),v(W,{title:U.NomClient,subtitle:y.Camp},{append:l(()=>[e(t,{fileKey:U.Key,isGeneratedDoc:!1},null,8,["fileKey"])]),_:2},1032,["title","subtitle"]))),256)),(d(!0),D(F,null,j(y.Generated,U=>(d(),v(W,{title:U.NomClient,subtitle:y.Camp},{append:l(()=>[e(t,{fileKey:U.Key,isGeneratedDoc:!0},null,8,["fileKey"])]),_:2},1032,["title","subtitle"]))),256))],64))),256)),e(we,null,{default:l(()=>b[3]||(b[3]=[i("À fournir")])),_:1,__:[3]}),(V=n.value.FilesToUpload)!=null&&V.length?H("",!0):(d(),v(W,{key:1},{default:l(()=>b[4]||(b[4]=[S("i",null,"Aucun document à fournir.",-1)])),_:1,__:[4]})),(d(!0),D(F,null,j(n.value.FilesToUpload,y=>(d(),D(F,null,[(d(!0),D(F,null,j(y.Demandes,U=>(d(),v(p,{demande:U.Demande,files:U.Uploaded||[],inUpload:!1,title:`Document pour ${y.Personne}`,optionnelle:null,showUploadText:!0,onUpload:u=>_(y.IdPersonne,U.Demande.Id,u),onDelete:h},ml({_:2},[U.Demande.IdFile.Valid?{name:"prepend",fn:l(()=>[e(Fe,{"content-class":"pa-1"},{activator:l(({props:u})=>[e(x,ue({ref_for:!0},u,{href:L(pl)(U.DemandeFile.Key),class:"mr-2",size:"small"}),{prepend:l(()=>[e(I,null,{default:l(()=>b[5]||(b[5]=[i("mdi-download")])),_:1,__:[5]})]),default:l(()=>[b[6]||(b[6]=i(" Modèle"))]),_:2,__:[6]},1040,["href"])]),default:l(()=>[e(t,{"file-key":U.DemandeFile.Key,isGeneratedDoc:!1,large:!0},null,8,["file-key"])]),_:2},1024)]),key:"0"}:void 0]),1032,["demande","files","title","onUpload"]))),256))],64))),256))]}),_:1})]),_:1})):(d(),v(ie,{key:1}))]),_:1})}}}),Ol={class:"overflow-y-auto",style:{"max-height":"75vh"}},Jl=z({__name:"Main",setup(m){const o=P("");le(()=>{const U=new URLSearchParams(window.location.search);o.value=U.get("token")||"",r()});const a=P(null);async function r(){const U=await C.Load({token:o.value});U!==void 0&&(a.value=U)}const n=q(()=>a.value==null?[]:fl(a.value.Dossier,"espaceperso")),f=P(!1),_=P("");async function h(){if(!_.value.length||!a.value)return;f.value=!1;const U=await C.SendMessage({Token:o.value,Message:_.value});U!==void 0&&(C.showMessage("Message envoyé avec succès."),a.value.Dossier.Events=(a.value.Dossier.Events||[]).concat(U))}function k(U){return U.Participant.Statut==G.Inscrit?"bg-lime-lighten-2":U.Participant.Statut==G.AStatuer?"bg-grey-lighten-1":"bg-orange-lighten-3"}const b=P(!1);async function t(U){b.value=!1,await C.UpdateParticipants({Token:o.value,Participants:U})!==void 0&&C.showMessage("Modifications enregistrées avec succès. Merci !")}const p=P(null),s=P(!1),V=P(!1),y=P(!1);return(U,u)=>{const $=hl;return d(),D(F,null,[e(Rl,{title:"Bienvenue sur votre espace de suivi"},{default:l(()=>[e(x,{onClick:u[0]||(u[0]=g=>p.value=0)},{prepend:l(()=>[e(I,null,{default:l(()=>u[17]||(u[17]=[i("mdi-comment-quote")])),_:1,__:[17]})]),default:l(()=>[u[18]||(u[18]=i(" Avis "))]),_:1,__:[18]}),e(x,{onClick:u[1]||(u[1]=g=>s.value=!0)},{prepend:l(()=>[e(I,null,{default:l(()=>u[19]||(u[19]=[i("mdi-image-album")])),_:1,__:[19]})]),default:l(()=>[u[20]||(u[20]=i(" Album photos "))]),_:1,__:[20]}),e(ce,null,{activator:l(({props:g})=>[e(x,me(pe(g)),{prepend:l(()=>[e(I,null,{default:l(()=>u[21]||(u[21]=[i("mdi-download")])),_:1,__:[21]})]),default:l(()=>[u[22]||(u[22]=i(" Justificatifs "))]),_:2,__:[22]},1040)]),default:l(()=>[e(ve,null,{default:l(()=>[e(W,{title:"Attestation de présence",subtitle:"Télécharger au format .pdf","prepend-icon":"mdi-file-document-check",link:"",href:L(Se).DownloadAttestationPresence(o.value)},null,8,["href"]),e(W,{title:"Facture",subtitle:"Télécharger au format .pdf","prepend-icon":"mdi-invoice-list",href:L(Se).DownloadFacture(o.value)},null,8,["href"])]),_:1})]),_:1})]),_:1}),a.value==null?(d(),v(ie,{key:0,type:"card"})):(d(),v(cl,{key:1,class:"fill-height",fluid:""},{default:l(()=>[e(M,null,{default:l(()=>[e(c,{"align-self":"center",cols:"5"},{default:l(()=>[e(w,{subtitle:"Participants"},{append:l(()=>[e(x,{onClick:u[2]||(u[2]=g=>y.value=!0),size:"small",class:"mr-1"},{prepend:l(()=>[e(I,null,{default:l(()=>u[23]||(u[23]=[i("mdi-folder")])),_:1,__:[23]})]),default:l(()=>[e(fe,{color:a.value.DocumentsToFillCount?"pink":"transparent",content:a.value.DocumentsToFillCount||"",floating:""},{default:l(()=>u[24]||(u[24]=[i(" Documents ")])),_:1,__:[24]},8,["color","content"])]),_:1}),e(x,{onClick:u[3]||(u[3]=g=>V.value=!0),size:"small",class:"mr-1"},{prepend:l(()=>[e(I,null,{default:l(()=>u[25]||(u[25]=[i("mdi-pill")])),_:1,__:[25]})]),default:l(()=>[e(fe,{color:a.value.FichesanitaireToFillCount?"pink":"transparent",content:a.value.FichesanitaireToFillCount||"",floating:""},{default:l(()=>u[26]||(u[26]=[i(" Fiches sanitaires ")])),_:1,__:[26]},8,["color","content"])]),_:1})]),default:l(()=>[e(A,null,{default:l(()=>[e(ve,{class:"pa-0"},{default:l(()=>[(d(!0),D(F,null,j(a.value.Dossier.Participants,g=>(d(),v(W,{title:L(Ve).label(g.Personne),subtitle:L(ge).label(g.Camp),rounded:"",class:oe({"my-2":!0,[k(g)]:!0})},{append:l(()=>[e(Fe,{text:L(Ml)[g.Participant.Statut]},{activator:l(({props:T})=>[e(I,ue({ref_for:!0},T,{icon:L(X).statutParticipant(g.Participant.Statut).icon}),null,16,["icon"])]),_:2},1032,["text"])]),_:2},1032,["title","subtitle","class"]))),256))]),_:1})]),_:1})]),_:1}),e(Il,{token:o.value,dossier:a.value.Dossier,"is-paiement-open":a.value.IsPaiementOpen,onRefresh:r},null,8,["token","dossier","is-paiement-open"])]),_:1}),e(c,{"align-self":"center"},{default:l(()=>[e(w,{subtitle:"Suivi de votre inscription"},{append:l(()=>[e(x,{onClick:u[4]||(u[4]=g=>f.value=!0)},{prepend:l(()=>[e(I,null,{default:l(()=>u[27]||(u[27]=[i("mdi-email")])),_:1,__:[27]})]),default:l(()=>[u[28]||(u[28]=i(" Nous écrire"))]),_:1,__:[28]})]),default:l(()=>[e(A,null,{default:l(()=>[S("div",Ol,[e(kl,{side:"end",class:"mt-4",density:"compact"},{default:l(()=>[(d(!0),D(F,null,j(n.value,g=>(d(),v($,{event:g,onGoToSondage:u[5]||(u[5]=T=>p.value=T)},null,8,["event"]))),256))]),_:1})])]),_:1})]),_:1})]),_:1})]),_:1}),e(K,{modelValue:b.value,"onUpdate:modelValue":u[6]||(u[6]=g=>b.value=g)},{default:l(()=>[e(Dl,{participants:a.value.Dossier.Participants||[],onSave:t},null,8,["participants"])]),_:1},8,["modelValue"])]),_:1})),e(K,{modelValue:f.value,"onUpdate:modelValue":u[8]||(u[8]=g=>f.value=g),"max-width":"600px"},{default:l(()=>[e(w,{title:"Nouveau message"},{default:l(()=>[e(A,null,{default:l(()=>[e(Y,{autofocus:"",placeholder:"Rédigez votre message...",modelValue:_.value,"onUpdate:modelValue":u[7]||(u[7]=g=>_.value=g),rows:"10"},null,8,["modelValue"])]),_:1}),e(te,null,{default:l(()=>[e(be),e(x,{disabled:!_.value.length,onClick:h},{prepend:l(()=>[e(I,null,{default:l(()=>u[29]||(u[29]=[i("mdi-send")])),_:1,__:[29]})]),default:l(()=>[u[30]||(u[30]=i(" Envoyer"))]),_:1,__:[30]},8,["disabled"])]),_:1})]),_:1})]),_:1},8,["modelValue"]),e(K,{"model-value":p.value!=null,"onUpdate:modelValue":u[9]||(u[9]=g=>p.value=null)},{default:l(()=>[p.value!=null?(d(),v(zl,{key:0,token:o.value,"initial-camp":p.value},null,8,["token","initial-camp"])):H("",!0)]),_:1},8,["model-value"]),e(K,{modelValue:s.value,"onUpdate:modelValue":u[10]||(u[10]=g=>s.value=g)},{default:l(()=>[e(xl,{token:o.value},null,8,["token"])]),_:1},8,["modelValue"]),e(K,{modelValue:V.value,"onUpdate:modelValue":u[13]||(u[13]=g=>V.value=g)},{default:l(()=>[e(jl,{token:o.value,onClose:u[11]||(u[11]=g=>V.value=!1),onUpdateNotifs:u[12]||(u[12]=g=>a.value.FichesanitaireToFillCount=g)},null,8,["token"])]),_:1},8,["modelValue"]),e(K,{modelValue:y.value,"onUpdate:modelValue":u[16]||(u[16]=g=>y.value=g),"max-width":"800px"},{default:l(()=>[e(Bl,{token:o.value,onClose:u[14]||(u[14]=g=>y.value=!1),onUpdateNotifs:u[15]||(u[15]=g=>a.value.DocumentsToFillCount=g)},null,8,["token"])]),_:1},8,["modelValue"])],64)}}}),Kl=["innerHTML"],Gl=z({__name:"App",setup(m){const o=Ae({text:"",color:"secondary",action:void 0,timeout:4e3}),a=P(""),r=P("");return C.onError=(n,f)=>{a.value=n,r.value=f},C.showMessage=(n,f,_)=>{o.text=n,o.color=f||"success",o.action=_,o.timeout=1e4,o.timeout=4e3},(n,f)=>(d(),v(gl,null,{default:l(()=>[e(vl,null,{default:l(()=>[e(Jl),e(Ue,{style:{"z-index":"10000"},app:"","model-value":o.text!="","onUpdate:modelValue":f[1]||(f[1]=_=>o.text=""),timeout:o.timeout,color:o.color,location:"bottom left","close-on-content-click":""},{default:l(()=>[i(R(o.text)+" ",1),o.action?(d(),v(x,{key:0,onClick:f[0]||(f[0]=_=>o.action.action()),class:"ml-2"},{default:l(()=>[i(R(o.action.title),1)]),_:1})):H("",!0)]),_:1},8,["model-value","timeout","color"]),e(Ue,{app:"","model-value":a.value!="","onUpdate:modelValue":f[2]||(f[2]=_=>a.value=""),timeout:4e3,color:"red"},{default:l(()=>[S("b",null,R(a.value),1),S("div",{innerHTML:r.value},null,8,Kl)]),_:1},8,["model-value"])]),_:1})]),_:1}))}}),Te=Vl(Gl);Te.use(bl);Te.mount("#app");
