import{d as X,c as F,a as W,F as le,b as e,w as t,V as Vl,e as f,f as kl,g as h,h as g,i as _l,t as $,r as Cl,j as T,o as b,k as S,l as j,m as Y,n as Pl,p as et,q as L,s as se,u as xl,v as De,x as xe,y as D,z as Re,A as Ue,B as ze,C as Le,D as Ct,E as Ve,I as Ne,G as Gt,M as Kt,H as Xt,J as tt,K as wl,L as Qe,N as $e,O as ot,P as Xe,Q as Fe,R as Me,S as je,T as Dl,U as he,W as Zt,X as ue,Y as St,Z as Sl,_ as Il,$ as el,a0 as Al,a1 as U,a2 as tl,a3 as J,a4 as ce,a5 as ke,a6 as ve,a7 as _e,a8 as lt,a9 as ll,aa as Ae,ab as we,ac as Ml,ad as rt,ae as Oe,af as $l,ag as Ul,ah as Fl,ai as Rl,aj as dt,ak as at,al as Ll,am as It,an as hl,ao as El,ap as Tl,aq as At,ar as Ol,as as Nl,at as Bl,au as jl,av as ql,aw as Yl,ax as Hl,ay as zl,az as Ql,aA as Wl,aB as Mt,aC as $t,aD as bt,aE as al,aF as Jl,aG as Gl,aH as gt,aI as Kl,aJ as Xl,aK as Ee,aL as Zl,aM as Ze,aN as ea,aO as ta,aP as la,aQ as aa,aR as na,aS as ua,aT as Ut,aU as ia,aV as sa,aW as oa,aX as ra,aY as Ft,aZ as Rt,a_ as da,a$ as ma,b0 as pt,b1 as ca,b2 as Lt,b3 as va,b4 as pa,b5 as ht,b6 as fa,b7 as ya,b8 as ba}from"./VSnackbar-DS0GooKO.js";import{u as nt,c as ga,a as Va}from"./vue-router-B7K6D0YO.js";import{c as P,V as ka,a as mt,m as nl,b as Vt,_ as ut,d as _a,i as Et,e as Ca,f as ul,g as Pa,h as it,j as xa,k as wa,l as Da,n as il,o as Sa,p as Ia}from"./InscriptionRow.vue_vue_type_script_setup_true_lang-5kkHsLxN.js";import{V as z,a as re,b as pe,c as ie,d as qe,e as Se,f as Z,g as Pe,h as Ce,i as Te,j as ct,k as Tt,l as sl,m as ol,n as rl}from"./VTextarea-1-qLFUqr.js";import{_ as We,a as Aa,V as Ma,b as $a,c as Ua,d as Ot,e as Nt}from"./VTabs-BQkl3qRp.js";import{_ as Je,V as Fa,a as Ra}from"./EventSwitch.vue_vue_type_script_setup_true_lang-CU-fTBCw.js";import{_ as Pt}from"./_plugin-vue_export-helper-DlAUqK2U.js";import{V as He}from"./FileCard.vue_vue_type_script_setup_true_lang-BFJsLt2C.js";import{V as Bt,_ as La,a as ha,b as Ea}from"./SexeField.vue_vue_type_script_setup_true_lang-DrX8Zcvs.js";import{_ as Ta}from"./FilesRow.vue_vue_type_script_setup_true_lang-_FFTalGN.js";import{V as Oa}from"./VForm-Uvzd2hMv.js";import"./VSheet-BYq0ep0r.js";import"./VWindowItem-UTNo1qcg.js";const ft=X({__name:"NavBar",props:{title:{},hideMenu:{type:Boolean}},setup(l){const s="/static/repere/logo.png",o="v0.6.2",c=l,a=F(()=>P.isFondsSoutien);return(i,v)=>(b(),W(le,null,[e(ka,{app:"","model-value":!c.hideMenu,"expand-on-hover":"",permanent:"",rail:""},{append:t(()=>[e(z,{"prepend-icon":"mdi-account-circle-outline",title:a.value?"Fonds de soutien":"Administrateur"},null,8,["title"]),e(z,{"prepend-icon":"mdi-logout",link:"",to:{path:"/"},color:"primary"},{default:t(()=>[...v[3]||(v[3]=[f(" Se déconnecter ",-1)])]),_:1})]),default:t(()=>[e(z,{"prepend-icon":"mdi-menu",title:`Registro ${o}`},null,8,["title"]),e(re),e(z,{"prepend-icon":"mdi-bed",link:"",to:{path:"/camps"},color:"primary"},{default:t(()=>[...v[0]||(v[0]=[f(" Séjours ",-1)])]),_:1}),e(z,{"prepend-icon":"mdi-calendar-multiple-check",link:"",to:{path:"/inscriptions"},color:"primary"},{default:t(()=>[...v[1]||(v[1]=[f(" Inscriptions ",-1)])]),_:1}),e(re),e(z,{"prepend-icon":"mdi-account-multiple",link:"",to:{path:"/annuaire"},color:"primary"},{default:t(()=>[...v[2]||(v[2]=[f(" Annuaire ",-1)])]),_:1}),e(re)]),_:1},8,["model-value"]),e(Vl,{rounded:"",elevation:"4",color:"secondary"},{append:t(()=>[Cl(i.$slots,"default"),v[4]||(v[4]=T("div",{class:"mr-2"},null,-1))]),default:t(()=>[e(kl,null,{default:t(()=>[e(h,null,{default:t(()=>[e(g,{"align-self":"center",cols:"auto"},{default:t(()=>[e(_l,{width:"60",src:s})]),_:1}),e(g,{"align-self":"center"},{default:t(()=>[f($(c.title),1)]),_:1})]),_:1})]),_:1})]),_:3})],64))}}),Na=X({__name:"index",setup(l){const s=nt(),o=S(!1),c=S(""),a=S([]);async function i(){const v=await P.Loggin({password:c.value});v!==void 0&&(v.IsValid?(P.setToken(v.Token,v.IsFondSoutien),P.showMessage("Bienvenue !"),s.push({path:"/inscriptions"})):a.value=["Clé de connection incorrecte."])}return(v,n)=>(b(),W(le,null,[e(ft,{title:"Connection au backoffice","hide-menu":""}),e(xl,{class:"fill-height"},{default:t(()=>[e(j,{class:"mx-auto",width:"400px"},{default:t(()=>[e(Y,null,{default:t(()=>[e(pe,{label:"Clé de connection",modelValue:c.value,"onUpdate:modelValue":n[1]||(n[1]=d=>c.value=d),"error-messages":a.value,type:o.value?void 0:"password",name:"password",onKeydown:n[2]||(n[2]=Pl(et(()=>c.value.length==0?null:i(),["prevent"]),["enter"]))},{"append-inner":t(()=>[e(L,{class:"ml-2",size:"small",icon:o.value?"mdi-eye":"mdi-eye-off",flat:"",onClick:n[0]||(n[0]=d=>o.value=!o.value)},null,8,["icon"])]),_:1},8,["modelValue","error-messages","type"])]),_:1}),e(se,null,{default:t(()=>[e(ie),e(L,{disabled:!c.value.length,onClick:i},{default:t(()=>[...n[3]||(n[3]=[f("Se connecter",-1)])]),_:1},8,["disabled"])]),_:1})]),_:1})]),_:1})],64))}}),xt=X({__name:"BoolField",props:De({label:{},hideDetails:{type:Boolean},readonly:{type:Boolean},density:{},persistentHint:{type:Boolean},hint:{}},{modelValue:{type:Boolean,required:!0},modelModifiers:{}}),emits:["update:modelValue"],setup(l){const s=l,o=xe(l,"modelValue");return(c,a)=>(b(),D(qe,{label:s.label,"model-value":o.value,"onUpdate:modelValue":a[0]||(a[0]=i=>o.value=i||!1),"hide-details":s.hideDetails,readonly:s.readonly,density:s.density,"persistent-hint":s.persistentHint,hint:s.hint},null,8,["label","model-value","hide-details","readonly","density","persistent-hint","hint"]))}}),dl=Ue({active:{type:[String,Array],default:void 0},controlHeight:[Number,String],disabled:{type:[Boolean,String,Array],default:null},nextIcon:{type:Ne,default:"$next"},prevIcon:{type:Ne,default:"$prev"},modeIcon:{type:Ne,default:"$subgroup"},text:String,viewMode:{type:String,default:"month"}},"VDatePickerControls"),jt=Re()({name:"VDatePickerControls",props:dl(),emits:{"click:year":()=>!0,"click:month":()=>!0,"click:prev":()=>!0,"click:next":()=>!0,"click:text":()=>!0},setup(l,s){let{emit:o}=s;const{t:c}=ze(),a=F(()=>Array.isArray(l.disabled)?l.disabled.includes("text"):!!l.disabled),i=F(()=>Array.isArray(l.disabled)?l.disabled.includes("mode"):!!l.disabled),v=F(()=>Array.isArray(l.disabled)?l.disabled.includes("prev"):!!l.disabled),n=F(()=>Array.isArray(l.disabled)?l.disabled.includes("next"):!!l.disabled);function d(){o("click:prev")}function u(){o("click:next")}function r(){o("click:year")}function m(){o("click:month")}return Le(()=>T("div",{class:Ve(["v-date-picker-controls"]),style:{"--v-date-picker-controls-height":Ct(l.controlHeight)}},[e(L,{class:"v-date-picker-controls__month-btn","data-testid":"month-btn",disabled:a.value,text:l.text,variant:"text",rounded:!0,onClick:m},null),e(L,{class:"v-date-picker-controls__mode-btn","data-testid":"year-btn",disabled:i.value,density:"comfortable",icon:l.modeIcon,variant:"text","aria-label":c("$vuetify.datePicker.ariaLabel.selectYear"),onClick:r},null),e(ie,null,null),T("div",{class:"v-date-picker-controls__month"},[e(L,{"data-testid":"prev-month",disabled:v.value,density:"comfortable",icon:l.prevIcon,variant:"text","aria-label":c("$vuetify.datePicker.ariaLabel.previousMonth"),onClick:d},null),e(L,{"data-testid":"next-month",disabled:n.value,icon:l.nextIcon,density:"comfortable",variant:"text","aria-label":c("$vuetify.datePicker.ariaLabel.nextMonth"),onClick:u},null)])])),{}}}),Ba=Ue({appendIcon:Ne,color:String,header:String,transition:String,onClick:wl()},"VDatePickerHeader"),qt=Re()({name:"VDatePickerHeader",props:Ba(),emits:{click:()=>!0,"click:append":()=>!0},setup(l,s){let{emit:o,slots:c}=s;const{backgroundColorClasses:a,backgroundColorStyles:i}=Gt(()=>l.color);function v(){o("click")}function n(){o("click:append")}return Le(()=>{const d=!!(c.default||l.header),u=!!(c.append||l.appendIcon);return T("div",{class:Ve(["v-date-picker-header",{"v-date-picker-header--clickable":!!l.onClick},a.value]),style:tt(i.value),onClick:v},[c.prepend&&T("div",{key:"prepend",class:"v-date-picker-header__prepend"},[c.prepend()]),d&&e(Kt,{key:"content",name:l.transition},{default:()=>[T("div",{key:l.header,class:"v-date-picker-header__content"},[c.default?.()??l.header])]}),u&&T("div",{class:"v-date-picker-header__append"},[c.append?e(Xt,{key:"append-defaults",disabled:!l.appendIcon,defaults:{VBtn:{icon:l.appendIcon,variant:"text"}}},{default:()=>[c.append?.()]}):e(L,{key:"append-btn",icon:l.appendIcon,variant:"text",onClick:n},null)])])}),{}}}),ja=Ue({allowedDates:[Array,Function],disabled:{type:Boolean,default:null},displayValue:null,modelValue:Array,month:[Number,String],max:null,min:null,showAdjacentMonths:Boolean,year:[Number,String],weekdays:{type:Array,default:()=>[0,1,2,3,4,5,6]},weeksInMonth:{type:String,default:"dynamic"},firstDayOfWeek:{type:[Number,String],default:void 0},firstDayOfYear:{type:[Number,String],default:void 0},weekdayFormat:String},"calendar");function qa(l){const s=Qe(),o=$e(l,"modelValue",[],V=>ot(V).map(_=>s.date(_))),c=F(()=>l.displayValue?s.date(l.displayValue):o.value.length>0?s.date(o.value[0]):l.min?s.date(l.min):Array.isArray(l.allowedDates)?s.date(l.allowedDates[0]):s.date()),a=$e(l,"year",void 0,V=>{const _=V!=null?Number(V):s.getYear(c.value);return s.startOfYear(s.setYear(s.date(),_))},V=>s.getYear(V)),i=$e(l,"month",void 0,V=>{const _=V!=null?Number(V):s.getMonth(c.value),k=s.setYear(s.startOfMonth(s.date()),s.getYear(a.value));return s.setMonth(k,_)},V=>s.getMonth(V)),v=F(()=>{const V=s.toJsDate(s.startOfWeek(s.date(),l.firstDayOfWeek)).getDay();return s.getWeekdays(l.firstDayOfWeek,l.weekdayFormat).filter((_,k)=>l.weekdays.includes((k+V)%7))}),n=F(()=>{const V=s.getWeekArray(i.value,l.firstDayOfWeek),_=V.flat(),k=6*7;if(l.weeksInMonth==="static"&&_.length<k){const C=_[_.length-1];let A=[];for(let q=1;q<=k-_.length;q++)A.push(s.addDays(C,q)),q%7===0&&(V.push(A),A=[])}return V});function d(V,_){return V.filter(k=>l.weekdays.includes(s.toJsDate(k).getDay())).map((k,C)=>{const A=s.toISO(k),q=!s.isSameMonth(k,i.value),B=s.isSameDay(k,s.startOfMonth(i.value)),x=s.isSameDay(k,s.endOfMonth(i.value)),w=s.isSameDay(k,i.value),ee=l.weekdays.length;return{date:k,formatted:s.format(k,"keyboardDate"),isAdjacent:q,isDisabled:p(k),isEnd:x,isHidden:q&&!l.showAdjacentMonths,isSame:w,isSelected:o.value.some(ge=>s.isSameDay(k,ge)),isStart:B,isToday:s.isSameDay(k,_),isWeekEnd:C%ee===ee-1,isWeekStart:C%ee===0,isoDate:A,localized:s.format(k,"dayOfMonth"),month:s.getMonth(k),year:s.getYear(k)}})}const u=F(()=>{const V=s.startOfWeek(c.value,l.firstDayOfWeek),_=[];for(let C=0;C<=6;C++)_.push(s.addDays(V,C));const k=s.date();return d(_,k)}),r=F(()=>{const V=n.value.flat(),_=s.date();return d(V,_)}),m=F(()=>n.value.map(V=>V.length?s.getWeek(V[0],l.firstDayOfWeek,l.firstDayOfYear):null));function p(V){if(l.disabled)return!0;const _=s.date(V);return l.min&&s.isBefore(s.endOfDay(_),s.date(l.min))||l.max&&s.isAfter(_,s.date(l.max))?!0:Array.isArray(l.allowedDates)&&l.allowedDates.length>0?!l.allowedDates.some(k=>s.isSameDay(s.date(k),_)):typeof l.allowedDates=="function"?!l.allowedDates(_):!1}return{displayValue:c,daysInMonth:r,daysInWeek:u,genDays:d,model:o,weeksInMonth:n,weekdayLabels:v,weekNumbers:m}}const ml=Ue({color:String,hideWeekdays:Boolean,multiple:[Boolean,Number,String],showWeek:Boolean,transition:{type:String,default:"picker-transition"},reverseTransition:{type:String,default:"picker-reverse-transition"},...je(ja(),["displayValue"])},"VDatePickerMonth"),Yt=Re()({name:"VDatePickerMonth",props:ml(),emits:{"update:modelValue":l=>!0,"update:month":l=>!0,"update:year":l=>!0},setup(l,s){let{emit:o,slots:c}=s;const a=S(),{t:i}=ze(),{daysInMonth:v,model:n,weekNumbers:d,weekdayLabels:u}=qa(l),r=Qe(),m=Xe(),p=Xe(),V=Xe(!1),_=Fe(()=>V.value?l.reverseTransition:l.transition);l.multiple==="range"&&n.value.length>0&&(m.value=n.value[0],n.value.length>1&&(p.value=n.value[n.value.length-1]));const k=F(()=>{const x=["number","string"].includes(typeof l.multiple)?Number(l.multiple):1/0;return n.value.length>=x});Me(v,(x,w)=>{w&&(V.value=r.isBefore(x[0].date,w[0].date))});function C(x){const w=r.startOfDay(x);if(n.value.length===0?m.value=void 0:n.value.length===1&&(m.value=n.value[0],p.value=void 0),!m.value)m.value=w,n.value=[m.value];else if(p.value)m.value=x,p.value=void 0,n.value=[m.value];else{if(r.isSameDay(w,m.value)){m.value=void 0,n.value=[];return}else r.isBefore(w,m.value)?(p.value=r.endOfDay(m.value),m.value=w):p.value=r.endOfDay(w);n.value=Dl(r,m.value,p.value)}}function A(x){const w=r.format(x.date,"fullDateWithWeekday"),ee=x.isToday?"currentDate":"selectDate";return i(`$vuetify.datePicker.ariaLabel.${ee}`,w)}function q(x){const w=n.value.findIndex(ee=>r.isSameDay(ee,x));if(w===-1)n.value=[...n.value,x];else{const ee=[...n.value];ee.splice(w,1),n.value=ee}}function B(x){l.multiple==="range"?C(x):l.multiple?q(x):n.value=[x]}Le(()=>T("div",{class:"v-date-picker-month",style:{"--v-date-picker-days-in-week":l.weekdays.length}},[l.showWeek&&T("div",{key:"weeks",class:"v-date-picker-month__weeks"},[!l.hideWeekdays&&T("div",{key:"hide-week-days",class:"v-date-picker-month__day"},[f(" ")]),d.value.map(x=>T("div",{class:Ve(["v-date-picker-month__day","v-date-picker-month__day--adjacent"])},[x]))]),e(Kt,{name:_.value},{default:()=>[T("div",{ref:a,key:v.value[0].date?.toString(),class:"v-date-picker-month__days"},[!l.hideWeekdays&&u.value.map(x=>T("div",{class:Ve(["v-date-picker-month__day","v-date-picker-month__weekday"])},[x])),v.value.map((x,w)=>{const ee={props:{class:"v-date-picker-month__day-btn",color:x.isSelected||x.isToday?l.color:void 0,disabled:x.isDisabled,icon:!0,ripple:!1,text:x.localized,variant:x.isSelected?"flat":x.isToday?"outlined":"text","aria-label":A(x),"aria-current":x.isToday?"date":void 0,onClick:()=>B(x.date)},item:x,i:w};return k.value&&!x.isSelected&&(x.isDisabled=!0),T("div",{class:Ve(["v-date-picker-month__day",{"v-date-picker-month__day--adjacent":x.isAdjacent,"v-date-picker-month__day--hide-adjacent":x.isHidden,"v-date-picker-month__day--selected":x.isSelected,"v-date-picker-month__day--week-end":x.isWeekEnd,"v-date-picker-month__day--week-start":x.isWeekStart}]),"data-v-date":x.isDisabled?void 0:x.isoDate},[(l.showAdjacentMonths||!x.isAdjacent)&&(c.day?.(ee)??e(L,ee.props,null))])})])]})]))}}),cl=Ue({color:String,height:[String,Number],min:null,max:null,modelValue:Number,year:Number,allowedMonths:[Array,Function]},"VDatePickerMonths"),Ht=Re()({name:"VDatePickerMonths",props:cl(),emits:{"update:modelValue":l=>!0},setup(l,s){let{emit:o,slots:c}=s;const a=Qe(),i=$e(l,"modelValue"),v=F(()=>{let d=a.startOfYear(a.date());return l.year&&(d=a.setYear(d,l.year)),he(12).map(u=>{const r=a.format(d,"monthShort"),m=a.format(d,"month"),p=!!(!n(u)||l.min&&a.isAfter(a.startOfMonth(a.date(l.min)),d)||l.max&&a.isAfter(d,a.startOfMonth(a.date(l.max))));return d=a.getNextMonth(d),{isDisabled:p,text:r,label:m,value:u}})});Zt(()=>{i.value=i.value??a.getMonth(a.date())});function n(d){return Array.isArray(l.allowedMonths)&&l.allowedMonths.length?l.allowedMonths.includes(d):typeof l.allowedMonths=="function"?l.allowedMonths(d):!0}return Le(()=>T("div",{class:"v-date-picker-months",style:{height:Ct(l.height)}},[T("div",{class:"v-date-picker-months__content"},[v.value.map((d,u)=>{const r={active:i.value===u,ariaLabel:d.label,color:i.value===u?l.color:void 0,disabled:d.isDisabled,rounded:!0,text:d.text,variant:i.value===d.value?"flat":"text",onClick:()=>m(u)};function m(p){if(i.value===p){o("update:modelValue",i.value);return}i.value=p}return c.month?.({month:d,i:u,props:r})??e(L,ue({key:"month"},r),null)})])])),{}}}),vl=Ue({color:String,height:[String,Number],min:null,max:null,modelValue:Number,allowedYears:[Array,Function]},"VDatePickerYears"),zt=Re()({name:"VDatePickerYears",props:vl(),directives:{vIntersect:St},emits:{"update:modelValue":l=>!0},setup(l,s){let{emit:o,slots:c}=s;const a=Qe(),i=$e(l,"modelValue"),v=F(()=>{const r=a.getYear(a.date());let m=r-100,p=r+52;l.min&&(m=a.getYear(a.date(l.min))),l.max&&(p=a.getYear(a.date(l.max)));let V=a.startOfYear(a.date());return V=a.setYear(V,m),he(p-m+1,m).map(_=>{const k=a.format(V,"year");return V=a.setYear(V,a.getYear(V)+1),{text:k,value:_,isDisabled:!u(_)}})});Zt(()=>{i.value=i.value??a.getYear(a.date())});const n=Sl();function d(){n.el?.focus(),n.el?.scrollIntoView({block:"center"})}function u(r){return Array.isArray(l.allowedYears)&&l.allowedYears.length?l.allowedYears.includes(r):typeof l.allowedYears=="function"?l.allowedYears(r):!0}return Le(()=>Il(T("div",{class:"v-date-picker-years",style:{height:Ct(l.height)}},[T("div",{class:"v-date-picker-years__content"},[v.value.map((r,m)=>{const p={ref:i.value===r.value?n:void 0,active:i.value===r.value,color:i.value===r.value?l.color:void 0,rounded:!0,text:r.text,disabled:r.isDisabled,variant:i.value===r.value?"flat":"text",onClick:()=>{if(i.value===r.value){o("update:modelValue",i.value);return}i.value=r.value}};return c.year?.({year:r,i:m,props:p})??e(L,ue({key:"month"},p),null)})])]),[[St,{handler:d},null,{once:!0}]])),{}}}),Ya=Ue({header:{type:String,default:"$vuetify.datePicker.header"},headerColor:String,...dl(),...ml({weeksInMonth:"static"}),...je(cl(),["modelValue"]),...je(vl(),["modelValue"]),...nl({title:"$vuetify.datePicker.title"}),modelValue:null},"VDatePicker"),Ha=Re()({name:"VDatePicker",props:Ya(),emits:{"update:modelValue":l=>!0,"update:month":l=>!0,"update:year":l=>!0,"update:viewMode":l=>!0},setup(l,s){let{emit:o,slots:c}=s;const a=Qe(),{t:i}=ze(),{rtlClasses:v}=el(),n=$e(l,"modelValue",void 0,M=>ot(M).map(y=>a.date(y)),M=>l.multiple?M:M[0]),d=$e(l,"viewMode"),u=F(()=>{const M=a.date(l.min);return l.min&&a.isValid(M)?M:null}),r=F(()=>{const M=a.date(l.max);return l.max&&a.isValid(M)?M:null}),m=F(()=>{const M=a.date();let y=M;return n.value?.[0]?y=a.date(n.value[0]):u.value&&a.isBefore(M,u.value)?y=u.value:r.value&&a.isAfter(M,r.value)&&(y=r.value),y&&a.isValid(y)?y:M}),p=Fe(()=>l.headerColor??l.color),V=$e(l,"month"),_=F({get:()=>Number(V.value??a.getMonth(a.startOfMonth(m.value))),set:M=>V.value=M}),k=$e(l,"year"),C=F({get:()=>Number(k.value??a.getYear(a.startOfYear(a.setMonth(m.value,_.value)))),set:M=>k.value=M}),A=Xe(!1),q=F(()=>l.multiple&&n.value.length>1?i("$vuetify.datePicker.itemsSelected",n.value.length):n.value[0]&&a.isValid(n.value[0])?a.format(a.date(n.value[0]),"normalDateWithWeekday"):i(l.header)),B=F(()=>{let M=a.date();return M=a.setDate(M,1),M=a.setMonth(M,_.value),M=a.setYear(M,C.value),a.format(M,"monthAndYear")}),x=Fe(()=>`date-picker-header${A.value?"-reverse":""}-transition`),w=F(()=>{if(l.disabled)return!0;const M=[];if(d.value!=="month")M.push("prev","next");else{let y=a.date();if(y=a.startOfMonth(y),y=a.setMonth(y,_.value),y=a.setYear(y,C.value),u.value){const O=a.addDays(a.startOfMonth(y),-1);a.isAfter(u.value,O)&&M.push("prev")}if(r.value){const O=a.addDays(a.endOfMonth(y),1);a.isAfter(O,r.value)&&M.push("next")}}return M}),ee=F(()=>l.allowedYears||I),ge=F(()=>l.allowedMonths||te);function G(M,y){const O=l.allowedDates;if(typeof O!="function")return!0;const R=a.getDiff(y,M,"days");for(let ye=0;ye<R;ye++)if(O(a.addDays(M,ye)))return!0;return!1}function I(M){if(typeof l.allowedDates=="function"){const y=a.parseISO(`${M}-01-01`);return G(y,a.endOfYear(y))}if(Array.isArray(l.allowedDates)&&l.allowedDates.length){for(const y of l.allowedDates)if(a.getYear(a.date(y))===M)return!0;return!1}return!0}function te(M){if(typeof l.allowedDates=="function"){const y=String(M+1).padStart(2,"0"),O=a.parseISO(`${C.value}-${y}-01`);return G(O,a.endOfMonth(O))}if(Array.isArray(l.allowedDates)&&l.allowedDates.length){for(const y of l.allowedDates)if(a.getYear(a.date(y))===C.value&&a.getMonth(a.date(y))===M)return!0;return!1}return!0}function Q(){_.value<11?_.value++:(C.value++,_.value=0,be()),fe()}function N(){_.value>0?_.value--:(C.value--,_.value=11,be()),fe()}function K(){d.value="month"}function oe(){d.value=d.value==="months"?"month":"months"}function ae(){d.value=d.value==="year"?"month":"year"}function fe(){d.value==="months"&&oe()}function be(){d.value==="year"&&ae()}return Me(n,(M,y)=>{const O=ot(y),R=ot(M);if(!R.length)return;const ye=a.date(O[O.length-1]),ne=a.date(R[R.length-1]),Ie=a.getMonth(ne),E=a.getYear(ne);Ie!==_.value&&(_.value=Ie,fe()),E!==C.value&&(C.value=E,be()),A.value=a.isBefore(ye,ne)}),Le(()=>{const M=mt.filterProps(l),y=jt.filterProps(l),O=qt.filterProps(l),R=Yt.filterProps(l),ye=je(Ht.filterProps(l),["modelValue"]),ne=je(zt.filterProps(l),["modelValue"]),Ie={color:p.value,header:q.value,transition:x.value};return e(mt,ue(M,{color:p.value,class:["v-date-picker",`v-date-picker--${d.value}`,{"v-date-picker--show-week":l.showWeek},v.value,l.class],style:l.style}),{title:()=>c.title?.()??T("div",{class:"v-date-picker__title"},[i(l.title)]),header:()=>c.header?e(Xt,{defaults:{VDatePickerHeader:{...Ie}}},{default:()=>[c.header?.(Ie)]}):e(qt,ue({key:"header"},O,Ie,{onClick:d.value!=="month"?K:void 0}),{prepend:c.prepend,append:c.append}),default:()=>T(le,null,[e(jt,ue(y,{disabled:w.value,text:B.value,"onClick:next":Q,"onClick:prev":N,"onClick:month":oe,"onClick:year":ae}),null),e(Al,{hideOnLeave:!0},{default:()=>[d.value==="months"?e(Ht,ue({key:"date-picker-months"},ye,{modelValue:_.value,"onUpdate:modelValue":[E=>_.value=E,fe],min:u.value,max:r.value,year:C.value,allowedMonths:ge.value}),{month:c.month}):d.value==="year"?e(zt,ue({key:"date-picker-years"},ne,{modelValue:C.value,"onUpdate:modelValue":[E=>C.value=E,be],min:u.value,max:r.value,allowedYears:ee.value}),{year:c.year}):e(Yt,ue({key:"date-picker-month"},R,{modelValue:n.value,"onUpdate:modelValue":E=>n.value=E,month:_.value,"onUpdate:month":[E=>_.value=E,fe],year:C.value,"onUpdate:year":[E=>C.value=E,be],min:u.value,max:r.value}),{day:c.day})]})]),actions:c.actions})}),{}}}),za=X({__name:"DateField",props:De({label:{},hideDetails:{type:Boolean},readonly:{type:Boolean}},{modelValue:{required:!0},modelModifiers:{}}),emits:["update:modelValue"],setup(l){const s=l,o=xe(l,"modelValue"),c=Qe();function a(v){i.value=!1,o.value=tl(v)}const i=S(!1);return(v,n)=>s.readonly?(b(),D(pe,{key:0,class:"center-text",variant:"outlined",density:"compact","hide-details":s.hideDetails,label:s.label,"model-value":U(c).parseISO(o.value).toLocaleDateString(),readonly:""},null,8,["hide-details","label","model-value"])):(b(),D(Se,{key:1,"close-on-content-click":!1,modelValue:i.value,"onUpdate:modelValue":n[1]||(n[1]=d=>i.value=d)},{activator:t(({props:d})=>[e(pe,ue({class:"center-text"},d,{variant:"outlined",density:"compact","hide-details":s.hideDetails,label:s.label,"model-value":U(c).parseISO(o.value).toLocaleDateString()}),null,16,["hide-details","label","model-value"])]),default:t(()=>[e(Ha,{"model-value":U(c).parseISO(o.value),"onUpdate:modelValue":n[0]||(n[0]=d=>a(d))},null,8,["model-value"])]),_:1},8,["modelValue"]))}}),pl=Pt(za,[["__scopeId","data-v-1e184428"]]),Qa=X({__name:"OptionStatut",props:De({camp:{}},{modelValue:{required:!0},modelModifiers:{}}),emits:["update:modelValue"],setup(l){const s=l,o=xe(l,"modelValue");function c(){const v=o.value?.length?o.value.map(u=>u.Id):[0],d={Id:Math.max(...v)+1,Label:"",Description:"",Prix:s.camp.Prix.Cent};o.value=(o.value||[]).concat(d),a.value=d}const a=S(null);function i(v){o.value=(o.value||[]).filter(n=>n.Id!=v.Id)}return(v,n)=>{const d=Je;return b(),D(j,{subtitle:"Le prix dépend du statut du participant, à choisir parmi la liste ci-dessous."},{append:t(()=>[e(L,{icon:"",size:"x-small",onClick:c},{default:t(()=>[e(ve,{color:"green"},{default:t(()=>[...n[4]||(n[4]=[f("mdi-plus",-1)])]),_:1})]),_:1})]),default:t(()=>[a.value!=null?(b(),D(Z,{key:0,"model-value":a.value!=null,"onUpdate:modelValue":n[3]||(n[3]=u=>a.value=null),"max-width":"500px"},{default:t(()=>[e(j,{title:"Modifier le statut"},{default:t(()=>[e(Y,null,{default:t(()=>[e(h,null,{default:t(()=>[e(g,{cols:"12"},{default:t(()=>[e(pe,{autofocus:"",label:"Statut",modelValue:a.value.Label,"onUpdate:modelValue":n[0]||(n[0]=u=>a.value.Label=u),density:"compact",variant:"outlined","hide-details":""},null,8,["modelValue"])]),_:1}),e(g,{cols:"12"},{default:t(()=>[e(pe,{label:"Description",modelValue:a.value.Description,"onUpdate:modelValue":n[1]||(n[1]=u=>a.value.Description=u),density:"compact",variant:"outlined","hide-details":""},null,8,["modelValue"])]),_:1}),e(g,{cols:"12"},{default:t(()=>[e(d,{"model-value":{Cent:a.value.Prix,Currency:s.camp.Prix.Currency},"onUpdate:modelValue":n[2]||(n[2]=u=>a.value.Prix=u.Cent),label:"Prix","readonly-currency":""},null,8,["model-value"])]),_:1})]),_:1})]),_:1})]),_:1})]),_:1},8,["model-value"])):J("",!0),e(Y,{class:"py-0"},{default:t(()=>[e(Pe,null,{default:t(()=>[o.value?.length?J("",!0):(b(),D(z,{key:0},{default:t(()=>[...n[5]||(n[5]=[T("i",null,"Aucun statut n'est encore défini.",-1)])]),_:1})),(b(!0),W(le,null,ce(o.value,u=>(b(),D(z,{title:u.Label,subtitle:u.Description,onClick:r=>a.value=u},{append:t(()=>[e(h,null,{default:t(()=>[e(g,{"align-self":"center"},{default:t(()=>[e(Ce,null,{default:t(()=>[f($(U(ke).montant({Cent:u.Prix,Currency:l.camp.Prix.Currency})),1)]),_:2},1024)]),_:2},1024),e(g,{"align-self":"center",cols:"auto"},{default:t(()=>[e(L,{icon:"",size:"x-small",class:"my-1",onClick:et(r=>i(u),["stop"])},{default:t(()=>[e(ve,{color:"red"},{default:t(()=>[...n[6]||(n[6]=[f("mdi-delete",-1)])]),_:1})]),_:1},8,["onClick"])]),_:2},1024)]),_:2},1024)]),_:2},1032,["title","subtitle","onClick"]))),256))]),_:1})]),_:1})]),_:1})}}}),Wa=X({__name:"OptionJournee",props:De({camp:{}},{modelValue:{required:!0},modelModifiers:{}}),emits:["update:modelValue"],setup(l){const s=l,o=xe(l,"modelValue");Me(()=>o.value,c,{immediate:!0});function c(){const i=s.camp.Duree;o.value?.length!=i&&(o.value=Array.from({length:i}).map(v=>0))}function a(){const i=o.value,v=i[0];for(let n=0;n<i.length;n++)i[n]=v}return(i,v)=>{const n=Je;return b(),D(j,{subtitle:"Le prix est variable en fonction des jours de participation au camp."},{append:t(()=>[e(He,{text:"Appliquer le prix du premier jour à tous."},{activator:t(({props:d})=>[e(L,ue(d,{icon:"mdi-arrow-expand",size:"x-small",disabled:!(o.value||[])[0],onClick:a}),null,16,["disabled"])]),_:1})]),default:t(()=>[e(Y,null,{default:t(()=>[e(h,null,{default:t(()=>[(b(!0),W(le,null,ce(o.value,(d,u)=>(b(),D(g,{cols:"3"},{default:t(()=>[e(n,{label:`Jour ${u+1}`,"model-value":{Cent:d,Currency:s.camp.Prix.Currency},"onUpdate:modelValue":r=>o.value[u]=r.Cent,"readonly-currency":""},null,8,["label","model-value","onUpdate:modelValue"])]),_:2},1024))),256))]),_:1})]),_:1})]),_:1})}}}),Ja={key:0,class:"text-center"},Ga=X({__name:"CampOptionsPrix",props:De({camp:{}},{optionPrix:{required:!0},optionPrixModifiers:{},optionQf:{required:!0},optionQfModifiers:{}}),emits:["update:optionPrix","update:optionQf"],setup(l){const s=l,o=xe(l,"optionPrix"),c=xe(l,"optionQf"),a=F(()=>_e.isQuotientFamilialActive(c.value)),i=lt(ll);return(v,n)=>{const d=We;return b(),D(j,{title:"Options sur le prix",subtitle:"Permet de modifier le prix de base du séjour",width:"1000px"},{default:t(()=>[e(Y,null,{default:t(()=>[e(h,null,{default:t(()=>[e(g,{"align-self":"center"},{default:t(()=>[e(qe,{"model-value":a.value,"onUpdate:modelValue":n[0]||(n[0]=u=>c.value[3]=u?100:0),"hide-details":"",label:"Prix au quotient familial"},null,8,["model-value"])]),_:1}),e(g,{"align-self":"center"},{default:t(()=>[e(d,{suffix:"%",min:0,max:100,disabled:!a.value,"hide-details":"","readonly-currency":"",label:"entre 1 et 359",modelValue:c.value[0],"onUpdate:modelValue":n[1]||(n[1]=u=>c.value[0]=u)},null,8,["disabled","modelValue"])]),_:1}),e(g,{"align-self":"center"},{default:t(()=>[e(d,{suffix:"%",min:0,max:100,disabled:!a.value,"hide-details":"","readonly-currency":"",label:"entre 360 et 564",modelValue:c.value[1],"onUpdate:modelValue":n[2]||(n[2]=u=>c.value[1]=u)},null,8,["disabled","modelValue"])]),_:1}),e(g,{"align-self":"center"},{default:t(()=>[e(d,{suffix:"%",min:0,max:100,disabled:!a.value,"hide-details":"","readonly-currency":"",label:"entre 565 et 714",modelValue:c.value[2],"onUpdate:modelValue":n[3]||(n[3]=u=>c.value[2]=u)},null,8,["disabled","modelValue"])]),_:1}),e(g,{"align-self":"center"},{default:t(()=>[e(d,{suffix:"%",min:0,max:100,disabled:!0,"hide-details":"","readonly-currency":"",label:"plus de 715",modelValue:c.value[3],"onUpdate:modelValue":n[4]||(n[4]=u=>c.value[3]=u)},null,8,["modelValue"])]),_:1})]),_:1}),e(re,{thickness:"1",class:"my-2"}),e(h,{class:"my-2"},{default:t(()=>[e(g,{"align-self":"center",cols:"4"},{default:t(()=>[e(Te,{variant:"outlined",density:"comfortable","hide-details":"",items:U(i),label:"Option sur le prix",modelValue:o.value.Active,"onUpdate:modelValue":n[5]||(n[5]=u=>o.value.Active=u)},null,8,["items","modelValue"])]),_:1}),e(g,{"align-self":"center"},{default:t(()=>[o.value.Active==U(Ae).NoOption?(b(),W("div",Ja,[...n[8]||(n[8]=[T("i",null,"Aucune modification sur le prix de base.",-1)])])):o.value.Active==U(Ae).PrixStatut?(b(),D(Qa,{key:1,camp:s.camp,modelValue:o.value.Statuts,"onUpdate:modelValue":n[6]||(n[6]=u=>o.value.Statuts=u)},null,8,["camp","modelValue"])):o.value.Active==U(Ae).PrixJour?(b(),D(Wa,{key:2,camp:s.camp,modelValue:o.value.Jours,"onUpdate:modelValue":n[7]||(n[7]=u=>o.value.Jours=u)},null,8,["camp","modelValue"])):J("",!0)]),_:1})]),_:1})]),_:1})]),_:1})}}}),Ka=X({__name:"CampMetaEdit",props:De({metaEntriesHints:{}},{modelValue:{required:!0},modelModifiers:{}}),emits:["update:modelValue"],setup(l){const s=l,o=xe(l,"modelValue"),c=S(Object.entries(o.value||{}));function a(){const i=Object.fromEntries(c.value);o.value=i}return F(()=>{const i=c.value.map(n=>n[0]);return i.includes("")?!0:new Set(i).size!=c.value.length}),(i,v)=>(b(),D(j,{subtitle:"Métadonnées exposées sur l'API publique"},{append:t(()=>[e(L,{size:"small",class:"ml-2",onClick:v[0]||(v[0]=n=>{c.value.push(["",""]),a()})},{prepend:t(()=>[e(ve,{color:"green"},{default:t(()=>[...v[1]||(v[1]=[f("mdi-plus",-1)])]),_:1})]),default:t(()=>[v[2]||(v[2]=f(" Ajouter une valeur",-1))]),_:1})]),default:t(()=>[e(Y,{class:"pt-2"},{default:t(()=>[(b(!0),W(le,null,ce(c.value,(n,d)=>(b(),D(h,null,{default:t(()=>[e(g,{cols:"4"},{default:t(()=>[e(Bt,{variant:"outlined",density:"compact","hide-details":"",label:"Clé",modelValue:n[0],"onUpdate:modelValue":[u=>n[0]=u,a],autofocus:"",items:s.metaEntriesHints.keys},null,8,["modelValue","onUpdate:modelValue","items"])]),_:2},1024),e(g,null,{default:t(()=>[e(Bt,{variant:"outlined",density:"compact","hide-details":"",label:"Valeur",modelValue:n[1],"onUpdate:modelValue":[u=>n[1]=u,a],items:s.metaEntriesHints.values},null,8,["modelValue","onUpdate:modelValue","items"])]),_:2},1024),e(g,{cols:"auto"},{default:t(()=>[e(L,{icon:"",size:"small",flat:"",onClick:u=>{c.value.splice(d,1),a()}},{default:t(()=>[e(ve,{color:"red"},{default:t(()=>[...v[3]||(v[3]=[f("mdi-close",-1)])]),_:1})]),_:1},8,["onClick"])]),_:2},1024)]),_:2},1024))),256))]),_:1})]),_:1}))}}),Xa=X({__name:"CampEdit",props:{camp:{},preselectionUrl:{},metaEntriesHints:{}},emits:["save"],setup(l,{emit:s}){const o=l,c=s,a=S(we(o.camp)),i=F(()=>new Date(a.value.DateDebut).getFullYear()>=2020&&a.value.Places>=1&&a.value.Nom!=""&&a.value.AgeMax>=a.value.AgeMin&&a.value.OptionQuotientFamilial.every(u=>0<=u&&u<=100)&&!(a.value.OptionPrix.Active==Ae.PrixStatut&&!a.value.OptionPrix.Statuts?.length)&&!(a.value.OptionPrix.Active==Ae.PrixJour&&a.value.OptionPrix.Jours?.length!=a.value.Duree)),v=lt(Ml);function n(u){const r=_e.isQuotientFamilialActive(u.OptionQuotientFamilial),m=u.OptionPrix.Active!=Ae.NoOption;if(!r&&!m)return"Aucune";const p=[];return _e.isQuotientFamilialActive(u.OptionQuotientFamilial)&&p.push("Quotient familial"),u.OptionPrix.Active!=Ae.NoOption&&p.push(ll[u.OptionPrix.Active]),p.join(", ")}async function d(){await rt(o.preselectionUrl),P.showMessage("URL copiée dans le presse-papier.")}return(u,r)=>{const m=pl,p=We,V=Je,_=xt;return b(),D(j,{title:"Paramètres du séjour",subtitle:U(_e).label(o.camp)},{default:t(()=>[e(Y,null,{default:t(()=>[e(j,{class:"my-2",subtitle:"Général"},{default:t(()=>[e(Y,null,{default:t(()=>[e(h,null,{default:t(()=>[e(g,null,{default:t(()=>[e(pe,{autofocus:"","hide-details":"",label:"Nom",density:"compact",variant:"outlined",modelValue:a.value.Nom,"onUpdate:modelValue":r[0]||(r[0]=k=>a.value.Nom=k)},null,8,["modelValue"])]),_:1}),e(g,null,{default:t(()=>[e(pe,{"hide-details":"",label:"Lieu",density:"compact",variant:"outlined",modelValue:a.value.Lieu,"onUpdate:modelValue":r[1]||(r[1]=k=>a.value.Lieu=k)},null,8,["modelValue"])]),_:1}),e(g,null,{default:t(()=>[e(pe,{"hide-details":"",label:"Numéro d'agrément",density:"compact",variant:"outlined",modelValue:a.value.Agrement,"onUpdate:modelValue":r[2]||(r[2]=k=>a.value.Agrement=k)},null,8,["modelValue"])]),_:1})]),_:1}),e(h,null,{default:t(()=>[e(g,{"align-self":"center"},{default:t(()=>[e(m,{modelValue:a.value.DateDebut,"onUpdate:modelValue":r[3]||(r[3]=k=>a.value.DateDebut=k),label:"Date de début","hide-details":""},null,8,["modelValue"])]),_:1}),e(g,{"align-self":"center"},{default:t(()=>[e(p,{label:"Durée (en jours)",modelValue:a.value.Duree,"onUpdate:modelValue":r[4]||(r[4]=k=>a.value.Duree=k),"hide-details":""},null,8,["modelValue"])]),_:1}),e(g,{"align-self":"center"},{default:t(()=>[e(m,{"model-value":U(_e).dateFin(a.value),label:"Date de fin",readonly:"","hide-details":""},null,8,["model-value"])]),_:1})]),_:1})]),_:1})]),_:1}),e(j,{class:"my-2",subtitle:"Prix"},{default:t(()=>[e(Y,null,{default:t(()=>[e(h,null,{default:t(()=>[e(g,{"align-self":"center",cols:"6"},{default:t(()=>[e(V,{label:"Prix",modelValue:a.value.Prix,"onUpdate:modelValue":r[5]||(r[5]=k=>a.value.Prix=k),"hide-details":""},null,8,["modelValue"])]),_:1}),e(g,{"align-self":"center",cols:"6",class:"text-center"},{default:t(()=>[e(Se,{"close-on-content-click":!1},{activator:t(({props:k})=>[e(pe,ue(k,{readonly:"",label:"Option sur le prix",variant:"outlined",density:"compact","hide-details":"","model-value":n(a.value)}),null,16,["model-value"])]),default:t(()=>[e(Ga,{camp:a.value,"option-prix":a.value.OptionPrix,"onUpdate:optionPrix":r[6]||(r[6]=k=>a.value.OptionPrix=k),"option-qf":a.value.OptionQuotientFamilial,"onUpdate:optionQf":r[7]||(r[7]=k=>a.value.OptionQuotientFamilial=k)},null,8,["camp","option-prix","option-qf"])]),_:1})]),_:1})]),_:1})]),_:1})]),_:1}),e(j,{class:"my-2",subtitle:"Visibilité et inscriptions"},{default:t(()=>[e(Y,null,{default:t(()=>[e(h,null,{default:t(()=>[e(g,{"align-self":"center"},{default:t(()=>[e(Te,{label:"Ouverture aux inscriptions",variant:"outlined",density:"compact",items:U(v),"hide-details":"",modelValue:a.value.Statut,"onUpdate:modelValue":r[8]||(r[8]=k=>a.value.Statut=k)},null,8,["items","modelValue"])]),_:1}),e(g,{"align-self":"center"},{default:t(()=>[e(Vt,{label:"Camp sans inscription",modelValue:a.value.WithoutInscription,"onUpdate:modelValue":r[9]||(r[9]=k=>a.value.WithoutInscription=k),color:"primary",density:"compact","persistent-hint":"",hint:a.value.WithoutInscription?"Camp externe, uniquement visible sur l'API publique.":""},null,8,["modelValue","hint"])]),_:1})]),_:1})]),_:1})]),_:1}),e(j,{class:"my-2",subtitle:"Filtres sur les inscrits"},{default:t(()=>[e(Y,null,{default:t(()=>[e(h,null,{default:t(()=>[e(g,{"align-self":"center"},{default:t(()=>[e(p,{modelValue:a.value.Places,"onUpdate:modelValue":r[10]||(r[10]=k=>a.value.Places=k),label:"Nombre de places"},null,8,["modelValue"])]),_:1}),e(g,{"align-self":"center"},{default:t(()=>[e(p,{modelValue:a.value.AgeMin,"onUpdate:modelValue":r[11]||(r[11]=k=>a.value.AgeMin=k),label:"Âge minimum"},null,8,["modelValue"])]),_:1}),e(g,{"align-self":"center"},{default:t(()=>[e(p,{modelValue:a.value.AgeMax,"onUpdate:modelValue":r[12]||(r[12]=k=>a.value.AgeMax=k),label:"Âge maximum"},null,8,["modelValue"])]),_:1})]),_:1}),e(h,null,{default:t(()=>[e(g,null,{default:t(()=>[e(_,{modelValue:a.value.NeedEquilibreGF,"onUpdate:modelValue":r[13]||(r[13]=k=>a.value.NeedEquilibreGF=k),label:"Equilibre G/F demandé",density:"compact","persistent-hint":"",hint:"Place un inscrit en liste d'attente en cas de déséquilibre Garçons/Filles"},null,8,["modelValue"])]),_:1})]),_:1})]),_:1})]),_:1}),e(j,{class:"my-2",subtitle:"Formulaire d'inscription"},{default:t(()=>[e(Y,null,{default:t(()=>[e(h,null,{default:t(()=>[e(g,null,{default:t(()=>[e(pe,{label:"Image",density:"compact",variant:"outlined",hint:"URL d'une image affichée sur le formulaire d'inscription","persistent-hint":"",modelValue:a.value.ImageURL,"onUpdate:modelValue":r[14]||(r[14]=k=>a.value.ImageURL=k)},null,8,["modelValue"])]),_:1})]),_:1}),e(h,null,{default:t(()=>[e(g,null,{default:t(()=>[e(ct,{variant:"outlined",density:"compact",label:"Description",hint:"Ce texte est affiché sur le formulaire d'inscription.","persistent-hint":"",rows:"3",modelValue:a.value.Description,"onUpdate:modelValue":r[15]||(r[15]=k=>a.value.Description=k)},null,8,["modelValue"])]),_:1}),e(g,{cols:"2"},{default:t(()=>[e(_,{label:"Navette",modelValue:a.value.Navette.Actif,"onUpdate:modelValue":r[16]||(r[16]=k=>a.value.Navette.Actif=k)},null,8,["modelValue"])]),_:1}),e(g,null,{default:t(()=>[e(ct,{variant:"outlined",density:"compact",label:"Navette",hint:"Ce texte est affiché sur l'espace personnel de suivi.","persistent-hint":"",rows:"3",disabled:!a.value.Navette.Actif,modelValue:a.value.Navette.Commentaire,"onUpdate:modelValue":r[17]||(r[17]=k=>a.value.Navette.Commentaire=k)},null,8,["disabled","modelValue"])]),_:1})]),_:1}),e(h,null,{default:t(()=>[e(g,null,{default:t(()=>[e(pe,{density:"compact",variant:"outlined",label:"URL de préselection",hint:"Cette URL permet de sélectionner automatiquement le séjour sur le formulaire d'inscription.","persistent-hint":"",readonly:"","model-value":o.preselectionUrl},{append:t(()=>[e(L,{icon:"mdi-content-copy",size:"small",onClick:d})]),_:1},8,["model-value"])]),_:1})]),_:1})]),_:1})]),_:1}),e(j,{class:"my-2",subtitle:"Autre"},{default:t(()=>[e(Y,null,{default:t(()=>[e(h,null,{default:t(()=>[e(g,null,{default:t(()=>[e(pe,{label:"Mot de passe",density:"compact",variant:"outlined",hint:"Mot de passe d'accès à la page Directeur","persistent-hint":"",modelValue:a.value.Password,"onUpdate:modelValue":r[18]||(r[18]=k=>a.value.Password=k)},null,8,["modelValue"])]),_:1})]),_:1})]),_:1})]),_:1}),e(Ka,{"meta-entries-hints":l.metaEntriesHints,modelValue:a.value.Meta,"onUpdate:modelValue":r[19]||(r[19]=k=>a.value.Meta=k)},null,8,["meta-entries-hints","modelValue"])]),_:1}),e(se,null,{default:t(()=>[e(ie),e(L,{disabled:!i.value,onClick:r[20]||(r[20]=k=>c("save",a.value))},{default:t(()=>[...r[21]||(r[21]=[f("Enregistrer",-1)])]),_:1},8,["disabled"])]),_:1})]),_:1},8,["subtitle"])}}}),Qt=X({__name:"TauxSelect",props:{modelValue:{required:!0},modelModifiers:{}},emits:["update:modelValue"],setup(l){Oe(i);const s=xe(l,"modelValue"),o=S(null),c=F(()=>{const u=Array.from(a.value.values()).map(r=>({title:r.Label,value:r.Id}));return u.sort((r,m)=>r.title.localeCompare(m.title)),u}),a=S(new Map);async function i(){const u=await P.CampsGetTaux();u!==void 0&&(a.value=$l(u),s.value.Id>0&&(s.value=we(a.value.get(s.value.Id)),o.value=s.value.Id))}function v(){s.value.Id<=0?(o.value==null&&(o.value=1),s.value=we(a.value.get(o.value))):(o.value=null,s.value.Id=0,s.value.Label="")}function n(u){s.value=we(a.value.get(u))}const d=F(()=>{if(s.value.Id>0)return null;const u=s.value.Label;return Array.from(a.value.values()).map(m=>m.Label).includes(u)?"Ce label est déjà utilisé.":null});return(u,r)=>(b(),D(h,null,{default:t(()=>[e(g,{"align-self":"center"},{default:t(()=>[s.value.Id>0?(b(),D(Te,{key:0,variant:"outlined",density:"compact","hide-details":"",label:"Taux",items:c.value,modelValue:o.value,"onUpdate:modelValue":[r[0]||(r[0]=m=>o.value=m),n]},null,8,["items","modelValue"])):(b(),D(h,{key:1},{default:t(()=>[e(g,{cols:"12"},{default:t(()=>[e(pe,{variant:"outlined",density:"compact",label:"Label",modelValue:s.value.Label,"onUpdate:modelValue":r[1]||(r[1]=m=>s.value.Label=m),disabled:s.value.Id>0,"error-messages":d.value},null,8,["modelValue","disabled","error-messages"])]),_:1}),e(g,null,{default:t(()=>[e(pe,{label:`Valeur d'un ${U(Fl)[U(Rl).FrancsSuisse]}`,density:"compact",variant:"outlined",type:"number",min:"0.001",suffix:"€",hint:"Valeur en € d'une unité de la monnaie.","persistent-hint":"","model-value":s.value.FrancsSuisse/1e3,"onUpdate:modelValue":r[2]||(r[2]=m=>s.value.FrancsSuisse=U(Ul)(Number(m)*1e3)),disabled:s.value.Id>0},null,8,["label","model-value","disabled"])]),_:1})]),_:1}))]),_:1}),e(g,{cols:"auto"},{default:t(()=>[e(re,{thickness:"2",vertical:"",class:"py-4"},{default:t(()=>[...r[3]||(r[3]=[f("ou",-1)])]),_:1})]),_:1}),e(g,{"align-self":"center",cols:"auto"},{default:t(()=>[e(L,{onClick:v},{prepend:t(()=>[e(ve,null,{default:t(()=>[...r[4]||(r[4]=[f("mdi-toggle-switch",-1)])]),_:1})]),default:t(()=>[f(" "+$(s.value.Id>0?"Créer un taux":"Utiliser un taux"),1)]),_:1})]),_:1})]),_:1}))}}),Za=X({__name:"CampStats",props:{stats:{}},setup(l){const s=l;function o(c,a){return`(${ke.pourcent(c,a)} %)`}return(c,a)=>(b(),D(j,{title:"Statut des inscriptions"},{default:t(()=>[e(Y,null,{default:t(()=>[e(Pe,{density:"compact"},{default:t(()=>[e(z,{title:"Demandes d'inscriptions"},{append:t(()=>[f($(s.stats.Inscriptions),1)]),_:1}),e(z,{title:"Filles",subtitle:"Parmi toutes les demandes d'inscription"},{append:t(()=>[f($(s.stats.InscriptionsFilles)+" "+$(o(s.stats.InscriptionsFilles,s.stats.Inscriptions)),1)]),_:1}),e(z,{title:"Suisses",subtitle:"Parmi toutes les demandes d'inscription"},{append:t(()=>[f($(s.stats.InscriptionsSuisses)+" "+$(o(s.stats.InscriptionsSuisses,s.stats.Inscriptions)),1)]),_:1}),e(z,{title:"Inscriptions confirmées"},{append:t(()=>[f($(s.stats.Valides)+" "+$(o(s.stats.Valides,s.stats.Inscriptions)),1)]),_:1}),e(z,{title:"Filles",subtitle:"Parmi les inscriptions confirmées"},{append:t(()=>[f($(s.stats.ValidesFilles)+" "+$(o(s.stats.ValidesFilles,s.stats.Valides)),1)]),_:1}),e(z,{title:"Suisses",subtitle:"Parmi les inscriptions confirmées"},{append:t(()=>[f($(s.stats.ValidesSuisses)+" "+$(o(s.stats.ValidesSuisses,s.stats.Valides)),1)]),_:1}),e(z,{title:"A statuer"},{append:t(()=>[f($(s.stats.AStatuer)+" "+$(o(s.stats.AStatuer,s.stats.Inscriptions)),1)]),_:1}),e(z,{title:"Demandes d'exception"},{append:t(()=>[f($(s.stats.Exceptions)+" "+$(o(s.stats.Exceptions,s.stats.Inscriptions)),1)]),_:1}),e(z,{title:"Refus"},{append:t(()=>[f($(s.stats.Refus)+" "+$(o(s.stats.Refus,s.stats.Inscriptions)),1)]),_:1})]),_:1})]),_:1})]),_:1}))}}),en={key:0},tn=X({__name:"CampHeaderRow",props:{camp:{}},emits:["click","edit","edit-taux","delete","show-documents","send-sondage","add-directeur"],setup(l,{emit:s}){const o=l,c=s,a=F(()=>o.camp.Stats.Inscriptions-o.camp.Stats.Valides),i=S(!1),v=F(()=>{switch(new Date(o.camp.Camp.Camp.DateDebut).getUTCMonth()+1){case 7:case 8:return"rgb(45, 185, 187)";case 9:case 10:case 11:return"rgb(190, 150, 60)";case 12:case 1:case 2:case 3:return"rgb(240, 240, 240)";case 4:case 5:case 6:default:return"rgb(190, 228, 100)"}}),n=S(!1),d=S(0),u=F(()=>{const r=o.camp.ParticipantsFiles||[];if(r.length==0)return 0;let m=0;for(const p of r)p.InscritsCount!=0&&(m+=p.UploadedCount/p.InscritsCount);return Math.round(m/r.length*100)});return(r,m)=>{const p=ut;return b(),W(le,null,[e(j,{color:v.value,"no-gutters":"",onClick:m[6]||(m[6]=V=>c("click")),class:"my-1"},{default:t(()=>[e(h,{style:tt({"background-color":v.value}),class:"px-1","no-gutters":"",justify:"space-between"},{default:t(()=>[e(g,null,{default:t(()=>[e(z,{title:U(_e).label(o.camp.Camp.Camp),subtitle:`ID : ${o.camp.Camp.Camp.Id}`},null,8,["title","subtitle"])]),_:1}),e(g,{"align-self":"center"},{default:t(()=>[f($(U(_e).formatPlage(l.camp.Camp.Camp)),1)]),_:1}),e(g,{cols:"2","align-self":"center"},{default:t(()=>[e(He,{width:"450px",location:"left","content-class":"pa-0"},{activator:t(({props:V})=>[e(dt,ue({class:"bg-white border-md border-primary"},V,{max:o.camp.Camp.Camp.Places,"model-value":o.camp.Stats.Valides,height:"36",rounded:"",color:"primary"}),{default:t(()=>[T("strong",null,[f($(o.camp.Stats.Valides)+"/"+$(o.camp.Camp.Camp.Places)+" ",1),a.value>0?(b(),W("span",en," (+ "+$(a.value)+")",1)):J("",!0)]),e(ve,{class:"ml-2"},{default:t(()=>[...m[12]||(m[12]=[f("mdi-account-multiple",-1)])]),_:1})]),_:1},16,["max","model-value"])]),default:t(()=>[e(Za,{stats:o.camp.Stats},null,8,["stats"])]),_:1})]),_:1}),e(g,{cols:"1","align-self":"center",class:"px-2"},{default:t(()=>[e(He,{width:"600",location:"left","content-class":"pa-0"},{activator:t(({props:V})=>[e(dt,ue({class:"bg-white border-md border-primary"},V,{max:100,"model-value":u.value,height:"36",rounded:"",color:"primary"}),{default:t(()=>[T("strong",null,$(u.value)+" % ",1),e(ve,{class:"ml-2"},{default:t(()=>[...m[13]||(m[13]=[f("mdi-file-upload",-1)])]),_:1})]),_:1},16,["model-value"])]),default:t(()=>[e(j,{title:"Pièces justificatives"},{default:t(()=>[e(Y,null,{default:t(()=>[e(Pe,null,{default:t(()=>[(b(!0),W(le,null,ce(o.camp.ParticipantsFiles,V=>(b(),D(z,{title:V.Title},{append:t(()=>[f($(V.UploadedCount)+" / "+$(V.InscritsCount)+" ("+$(U(ke).pourcent(V.UploadedCount,V.InscritsCount))+" %) ",1)]),_:2},1032,["title"]))),256))]),_:1})]),_:1})]),_:1})]),_:1})]),_:1}),e(g,{cols:"1"}),e(g,{cols:"auto","align-self":"center"},{default:t(()=>[e(Se,null,{activator:t(({props:V})=>[e(L,ue(V,{size:"x-small",class:"mx-1",icon:"mdi-dots-vertical"}),null,16)]),default:t(()=>[e(Pe,{density:"compact"},{default:t(()=>[e(z,{"prepend-icon":"mdi-pencil",onClick:m[0]||(m[0]=V=>c("edit"))},{default:t(()=>[...m[14]||(m[14]=[f("Modifier les paramètres",-1)])]),_:1}),e(z,{"prepend-icon":"mdi-currency-eur",onClick:m[1]||(m[1]=V=>c("edit-taux"))},{default:t(()=>[...m[15]||(m[15]=[f("Taux de conversion",-1)])]),_:1}),e(re,{thickness:"1"}),e(z,{"prepend-icon":"mdi-mail",onClick:m[2]||(m[2]=V=>c("show-documents")),title:"Documents"}),e(re,{thickness:"1"}),e(z,{"prepend-icon":"mdi-plus",onClick:m[3]||(m[3]=V=>n.value=!0),title:"Ajouter un directeur...",disabled:o.camp.HasDirecteur},null,8,["disabled"]),e(re,{thickness:"1"}),e(z,{title:"Envoyer le sondage",subtitle:"de fin de séjour","prepend-icon":"mdi-comment-quote",onClick:m[4]||(m[4]=V=>c("send-sondage"))}),e(re,{thickness:"1"}),e(z,{"prepend-icon":"mdi-delete",disabled:o.camp.Stats.Inscriptions>0,onClick:m[5]||(m[5]=V=>i.value=!0)},{default:t(()=>[...m[16]||(m[16]=[f("Supprimer",-1)])]),_:1},8,["disabled"])]),_:1})]),_:1})]),_:1})]),_:1},8,["style"])]),_:1},8,["color"]),e(Z,{modelValue:i.value,"onUpdate:modelValue":m[8]||(m[8]=V=>i.value=V),"max-width":"600"},{default:t(()=>[e(j,{title:"Confirmer la suppression"},{default:t(()=>[e(Y,null,{default:t(()=>[m[17]||(m[17]=f(" Etes vous certain de supprimer le séjour ",-1)),T("b",null,$(U(_e).label(o.camp.Camp.Camp)),1),m[18]||(m[18]=f(" ? ",-1)),m[19]||(m[19]=T("br",null,null,-1)),m[20]||(m[20]=T("br",null,null,-1)),m[21]||(m[21]=f(" Les éventuels ",-1)),m[22]||(m[22]=T("i",null,"équipiers",-1)),m[23]||(m[23]=f(" déclarés sur ce séjour seront aussi supprimés. ",-1)),m[24]||(m[24]=T("br",null,null,-1)),m[25]||(m[25]=T("br",null,null,-1)),m[26]||(m[26]=f(" Attention, cette opération est irréversible. ",-1))]),_:1}),e(se,null,{default:t(()=>[e(ie),e(L,{color:"red",onClick:m[7]||(m[7]=V=>{i.value=!1,c("delete")})},{default:t(()=>[...m[27]||(m[27]=[f("Supprimer",-1)])]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"]),e(Z,{modelValue:n.value,"onUpdate:modelValue":m[11]||(m[11]=V=>n.value=V),"max-width":"400px"},{default:t(()=>[e(j,{title:"Ajouter un directeur"},{default:t(()=>[e(Y,null,{default:t(()=>[e(p,{"initial-personne":"",label:"Directeur",modelValue:d.value,"onUpdate:modelValue":m[9]||(m[9]=V=>d.value=V),api:U(P)},null,8,["modelValue","api"])]),_:1}),e(se,null,{default:t(()=>[e(ie),e(L,{disabled:!d.value,onClick:m[10]||(m[10]=V=>{n.value=!1,c("add-directeur",d.value)})},{default:t(()=>[...m[28]||(m[28]=[f("Ajouter",-1)])]),_:1},8,["disabled"])]),_:1})]),_:1})]),_:1},8,["modelValue"])],64)}}}),ln=X({__name:"CampsSelector",props:De({allCamps:{}},{modelValue:{required:!0},modelModifiers:{}}),emits:["update:modelValue"],setup(l,{emit:s}){const o=l,c=xe(l,"modelValue"),a=F(()=>o.allCamps.map(i=>({title:i.Label,value:i.Id})));return(i,v)=>(b(),D(_a,{multiple:"",chips:"","closable-chips":"",items:a.value,modelValue:c.value,"onUpdate:modelValue":v[0]||(v[0]=n=>c.value=n)},null,8,["items","modelValue"]))}}),an=X({__name:"DocumentsCard",props:{camp:{}},setup(l){const s=l;Oe(c);const o=S(null);async function c(){const a=await P.CampsDocuments({idCamp:s.camp.Camp.Camp.Id});a!==void 0&&(o.value=a)}return(a,i)=>{const v=Aa;return o.value!=null?(b(),D(j,{key:0,title:"Documents"},{default:t(()=>[e(Y,null,{default:t(()=>[e(Pe,null,{default:t(()=>[e(Tt,null,{default:t(()=>[...i[0]||(i[0]=[f("Préférences d'affichage",-1)])]),_:1}),e(z,null,{default:t(()=>[e(h,{class:"mb-2"},{default:t(()=>[e(g,null,{default:t(()=>[e(Ce,{color:o.value.ToShow.LettreDirecteur?"green":"grey","append-icon":o.value.ToShow.LettreDirecteur?"mdi-check":""},{default:t(()=>[...i[1]||(i[1]=[f("Lettre du directeur",-1)])]),_:1},8,["color","append-icon"])]),_:1}),e(g,null,{default:t(()=>[e(Ce,{color:o.value.ToShow.ListeVetements?"green":"grey","append-icon":o.value.ToShow.ListeVetements?"mdi-check":""},{default:t(()=>[...i[2]||(i[2]=[f(" Liste de vêtements",-1)])]),_:1},8,["color","append-icon"])]),_:1}),e(g,null,{default:t(()=>[e(Ce,{color:o.value.ToShow.ListeParticipants?"green":"grey","append-icon":o.value.ToShow.ListeParticipants?"mdi-check":""},{default:t(()=>[...i[3]||(i[3]=[f("Liste des participants ",-1)])]),_:1},8,["color","append-icon"])]),_:1})]),_:1})]),_:1}),e(Tt,null,{default:t(()=>[...i[4]||(i[4]=[f("Documents du séjour",-1)])]),_:1}),(b(!0),W(le,null,ce(o.value.Generated,n=>(b(),D(z,{title:n.NomClient},{append:t(()=>[e(v,{"file-key":n.Key,"is-generated-doc":!0},null,8,["file-key"])]),_:2},1032,["title"]))),256)),(b(!0),W(le,null,ce(o.value.ToRead,n=>(b(),D(z,{title:n.NomClient},{append:t(()=>[e(v,{"file-key":n.Key,"is-generated-doc":!1},null,8,["file-key"])]),_:2},1032,["title"]))),256)),(b(!0),W(le,null,ce(o.value.ToUploadModeles,n=>(b(),D(z,{title:n.NomClient,subtitle:"Document à remplir"},{append:t(()=>[e(v,{"file-key":n.Key,"is-generated-doc":!1},null,8,["file-key"])]),_:2},1032,["title"]))),256))]),_:1})]),_:1})]),_:1})):(b(),D(at,{key:1,type:"card"}))}}}),kt=X({__name:"RequestProgressCard",props:{title:{},current:{},total:{}},setup(l){const s=l;return(o,c)=>(b(),D(j,{title:s.title},{default:t(()=>[e(Y,null,{default:t(()=>[e(dt,{max:s.total,"model-value":s.current,color:"primary",height:"24"},{default:t(()=>[f($(s.current)+" / "+$(s.total),1)]),_:1},8,["max","model-value"])]),_:1})]),_:1},8,["title"]))}}),nn={key:0,class:"text-center my-4"},un=X({__name:"JoomeoPannel",emits:["save"],setup(l,{emit:s}){Oe(a);const o=S(null),c=S([]);async function a(){const p=await P.CampsLoadAlbums();p!==void 0&&(o.value=p||[],c.value=[])}function i(p){return o.value.find(V=>V.Camp.Id==p)}const v=S(!1),n=F(()=>v.value||!c.value.length||!o.value?!1:c.value.every(p=>i(p).Camp.JoomeoID==""));async function d(){v.value=!0;const p=await P.CampsCreateAlbums({IdCamps:c.value});v.value=!1,p!==void 0&&(It(p).forEach(([V,_])=>{i(V).Album=_}),P.showMessage("Albums Joomeo créés avec succès."))}const u=F(()=>v.value||!c.value.length||!o.value?!1:c.value.every(p=>i(p).Camp.JoomeoID!=""&&i(p).HasDirecteur));async function r(){v.value=!0;const p=await P.CampsAddDirecteursToAlbums({IdCamps:c.value,SendMail:!0});v.value=!1,p!==void 0&&(It(p).forEach(([V,_])=>{i(V).DirecteurPermission=_}),P.showMessage("Directeurs ajoutés avec succès."))}function m(p){return p.type==1&&p.albumAccessRules.allowDownload&&p.albumAccessRules.allowUpload&&p.accessRules.allowDeleteFile&&p.accessRules.allowEditFileCaption}return(p,V)=>(b(),D(j,{title:"Albums Joomeo",subtitle:"Seuls les camps en cours sont affichés."},{append:t(()=>[e(L,{disabled:!n.value,onClick:d},{prepend:t(()=>[e(ve,{color:"green"},{default:t(()=>[...V[1]||(V[1]=[f("mdi-plus",-1)])]),_:1})]),default:t(()=>[V[2]||(V[2]=f(" Créer les albums",-1))]),_:1},8,["disabled"]),e(L,{disabled:!u.value,onClick:r,class:"ml-2"},{prepend:t(()=>[e(ve,null,{default:t(()=>[...V[3]||(V[3]=[f("mdi-account-eye",-1)])]),_:1})]),default:t(()=>[V[4]||(V[4]=f(" Ajouter les directeurs",-1))]),_:1},8,["disabled"])]),default:t(()=>[v.value?(b(),D(dt,{key:0,indeterminate:""})):J("",!0),e(Y,null,{default:t(()=>[o.value==null?(b(),W("div",nn,[e(Ll,{indeterminate:""})])):(b(),D(Pe,{key:1,selected:c.value,"onUpdate:selected":V[0]||(V[0]=_=>c.value=_),"select-strategy":"leaf"},{default:t(()=>[(b(!0),W(le,null,ce(o.value,_=>(b(),D(z,{value:_.Camp.Id,title:U(_e).label(_.Camp),rounded:"",class:"my-1"},{append:t(()=>[e(h,null,{default:t(()=>[e(g,null,{default:t(()=>[e(Ce,{color:_.Album.Id?"primary":void 0},{default:t(()=>[_.Album.Id?(b(),D(He,{key:0,activator:"parent","content-class":"pa-0"},{default:t(()=>[e(j,{title:"Album Joomeo","min-width":"400px"},{default:t(()=>[e(Y,null,{default:t(()=>[e(h,null,{default:t(()=>[e(g,{cols:"auto"},{default:t(()=>[...V[5]||(V[5]=[f("Nom",-1)])]),_:1}),e(g,{class:"text-right"},{default:t(()=>[f($(_.Album.Label),1)]),_:2},1024)]),_:2},1024),e(h,null,{default:t(()=>[e(g,{cols:"auto"},{default:t(()=>[...V[6]||(V[6]=[f("ID",-1)])]),_:1}),e(g,{class:"text-right"},{default:t(()=>[f($(_.Album.Id),1)]),_:2},1024)]),_:2},1024),e(h,null,{default:t(()=>[e(g,{cols:"auto"},{default:t(()=>[...V[7]||(V[7]=[f("Date de création",-1)])]),_:1}),e(g,{class:"text-right"},{default:t(()=>[f($(new Date(_.Album.Date).toLocaleDateString("fr")),1)]),_:2},1024)]),_:2},1024),e(h,null,{default:t(()=>[e(g,{cols:"auto"},{default:t(()=>[...V[8]||(V[8]=[f("Nombre de photos",-1)])]),_:1}),e(g,{class:"text-right"},{default:t(()=>[f($(_.Album.FilesCount),1)]),_:2},1024)]),_:2},1024)]),_:2},1024)]),_:2},1024)]),_:2},1024)):J("",!0),f(" "+$(_.Album.Id==""?"Pas d'album":`Album créé le ${U(ke).date(_.Album.Date)}`),1)]),_:2},1032,["color"])]),_:2},1024),_.Album.Id?(b(),D(g,{key:0},{default:t(()=>[e(Ce,{color:_.HasDirecteur?_.DirecteurPermission.contactid!=""?"green":"orange":"red"},{default:t(()=>[_.DirecteurPermission.contactid?(b(),D(He,{key:0,activator:"parent","content-class":"pa-0"},{default:t(()=>[e(j,{title:"Accès à l'album",subtitle:"Le directeur a accès à l'album."},{default:t(()=>[e(Y,null,{default:t(()=>[e(h,null,{default:t(()=>[e(g,null,{default:t(()=>[...V[9]||(V[9]=[f("Email",-1)])]),_:1}),e(g,{class:"text-right"},{default:t(()=>[f($(_.DirecteurPermission.email),1)]),_:2},1024)]),_:2},1024),e(h,null,{default:t(()=>[e(g,null,{default:t(()=>[...V[10]||(V[10]=[f("Login",-1)])]),_:1}),e(g,{class:"text-right"},{default:t(()=>[f($(_.DirecteurPermission.login),1)]),_:2},1024)]),_:2},1024),e(h,null,{default:t(()=>[e(g,null,{default:t(()=>[...V[11]||(V[11]=[f("Mot de passe",-1)])]),_:1}),e(g,{class:"text-right"},{default:t(()=>[f($(_.DirecteurPermission.password),1)]),_:2},1024)]),_:2},1024),e(h,null,{default:t(()=>[e(g,null,{default:t(()=>[...V[12]||(V[12]=[f("Permissions (écriture)",-1)])]),_:1}),e(g,{class:"text-right"},{default:t(()=>[e(ve,{icon:m(_.DirecteurPermission)?"mdi-check":"mdi-warning",color:m(_.DirecteurPermission)?"green":"orange"},null,8,["icon","color"])]),_:2},1024)]),_:2},1024)]),_:2},1024)]),_:2},1024)]),_:2},1024)):J("",!0),f(" "+$(_.HasDirecteur?_.DirecteurPermission.contactid!=""?"Directeur ajouté":"Directeur à ajouter":"Aucun directeur"),1)]),_:2},1032,["color"])]),_:2},1024)):J("",!0)]),_:2},1024)]),_:2},1032,["value","title"]))),256))]),_:1},8,["selected"]))]),_:1}),e(se,null,{default:t(()=>[e(ie)]),_:1})]),_:1}))}});function sn(){const l=S([]);hl(()=>l.value=[]);function s(o,c){l.value[c]=o}return{refs:l,updateRef:s}}const on=Ue({activeColor:String,start:{type:[Number,String],default:1},modelValue:{type:Number,default:l=>l.start},disabled:Boolean,length:{type:[Number,String],default:1,validator:l=>l%1===0},totalVisible:[Number,String],firstIcon:{type:Ne,default:"$first"},prevIcon:{type:Ne,default:"$prev"},nextIcon:{type:Ne,default:"$next"},lastIcon:{type:Ne,default:"$last"},ariaLabel:{type:String,default:"$vuetify.pagination.ariaLabel.root"},pageAriaLabel:{type:String,default:"$vuetify.pagination.ariaLabel.page"},currentPageAriaLabel:{type:String,default:"$vuetify.pagination.ariaLabel.currentPage"},firstAriaLabel:{type:String,default:"$vuetify.pagination.ariaLabel.first"},previousAriaLabel:{type:String,default:"$vuetify.pagination.ariaLabel.previous"},nextAriaLabel:{type:String,default:"$vuetify.pagination.ariaLabel.next"},lastAriaLabel:{type:String,default:"$vuetify.pagination.ariaLabel.last"},ellipsis:{type:String,default:"..."},showFirstLastPage:Boolean,...Wl(),...Ql(),...zl(),...Hl(),...Yl(),...ql(),...jl({tag:"nav"}),...Bl(),...Nl({variant:"text"})},"VPagination"),rn=Re()({name:"VPagination",props:on(),emits:{"update:modelValue":l=>!0,first:l=>!0,prev:l=>!0,next:l=>!0,last:l=>!0},setup(l,s){let{slots:o,emit:c}=s;const a=$e(l,"modelValue"),{t:i,n:v}=ze(),{isRtl:n}=el(),{themeClasses:d}=El(l),{width:u}=Tl(),r=Xe(-1);At(void 0,{scoped:!0});const{resizeRef:m}=Ol(G=>{if(!G.length)return;const{target:I,contentRect:te}=G[0],Q=I.querySelector(".v-pagination__list > *");if(!Q)return;const N=te.width,K=Q.offsetWidth+parseFloat(getComputedStyle(Q).marginRight)*2;r.value=k(N,K)}),p=F(()=>parseInt(l.length,10)),V=F(()=>parseInt(l.start,10)),_=F(()=>l.totalVisible!=null?parseInt(l.totalVisible,10):r.value>=0?r.value:k(u.value,58));function k(G,I){const te=l.showFirstLastPage?5:3;return Math.max(0,Math.floor(Number(((G-I*te)/I).toFixed(2))))}const C=F(()=>{if(p.value<=0||isNaN(p.value)||p.value>Number.MAX_SAFE_INTEGER)return[];if(_.value<=0)return[];if(_.value===1)return[a.value];if(p.value<=_.value)return he(p.value,V.value);const G=_.value%2===0,I=G?_.value/2:Math.floor(_.value/2),te=G?I:I+1,Q=p.value-I;if(te-a.value>=0)return[...he(Math.max(1,_.value-1),V.value),l.ellipsis,p.value];if(a.value-Q>=(G?1:0)){const N=_.value-1,K=p.value-N+V.value;return[V.value,l.ellipsis,...he(N,K)]}else{const N=Math.max(1,_.value-2),K=N===1?a.value:a.value-Math.ceil(N/2)+V.value;return[V.value,l.ellipsis,...he(N,K),l.ellipsis,p.value]}});function A(G,I,te){G.preventDefault(),a.value=I,te&&c(te,I)}const{refs:q,updateRef:B}=sn();At({VPaginationBtn:{color:Fe(()=>l.color),border:Fe(()=>l.border),density:Fe(()=>l.density),size:Fe(()=>l.size),variant:Fe(()=>l.variant),rounded:Fe(()=>l.rounded),elevation:Fe(()=>l.elevation)}});const x=F(()=>C.value.map((G,I)=>{const te=Q=>B(Q,I);if(typeof G=="string")return{isActive:!1,key:`ellipsis-${I}`,page:G,props:{ref:te,ellipsis:!0,icon:!0,disabled:!0}};{const Q=G===a.value;return{isActive:Q,key:G,page:v(G),props:{ref:te,ellipsis:!1,icon:!0,disabled:!!l.disabled||Number(l.length)<2,color:Q?l.activeColor:l.color,"aria-current":Q,"aria-label":i(Q?l.currentPageAriaLabel:l.pageAriaLabel,G),onClick:N=>A(N,G)}}}})),w=F(()=>{const G=!!l.disabled||a.value<=V.value,I=!!l.disabled||a.value>=V.value+p.value-1;return{first:l.showFirstLastPage?{icon:n.value?l.lastIcon:l.firstIcon,onClick:te=>A(te,V.value,"first"),disabled:G,"aria-label":i(l.firstAriaLabel),"aria-disabled":G}:void 0,prev:{icon:n.value?l.nextIcon:l.prevIcon,onClick:te=>A(te,a.value-1,"prev"),disabled:G,"aria-label":i(l.previousAriaLabel),"aria-disabled":G},next:{icon:n.value?l.prevIcon:l.nextIcon,onClick:te=>A(te,a.value+1,"next"),disabled:I,"aria-label":i(l.nextAriaLabel),"aria-disabled":I},last:l.showFirstLastPage?{icon:n.value?l.firstIcon:l.lastIcon,onClick:te=>A(te,V.value+p.value-1,"last"),disabled:I,"aria-label":i(l.lastAriaLabel),"aria-disabled":I}:void 0}});function ee(){const G=a.value-V.value;q.value[G]?.$el.focus()}function ge(G){G.key===Mt.left&&!l.disabled&&a.value>Number(l.start)?(a.value=a.value-1,$t(ee)):G.key===Mt.right&&!l.disabled&&a.value<V.value+p.value-1&&(a.value=a.value+1,$t(ee))}return Le(()=>e(l.tag,{ref:m,class:Ve(["v-pagination",d.value,l.class]),style:tt(l.style),role:"navigation","aria-label":i(l.ariaLabel),onKeydown:ge,"data-test":"v-pagination-root"},{default:()=>[T("ul",{class:"v-pagination__list"},[l.showFirstLastPage&&T("li",{key:"first",class:"v-pagination__first","data-test":"v-pagination-first"},[o.first?o.first(w.value.first):e(L,ue({_as:"VPaginationBtn"},w.value.first),null)]),T("li",{key:"prev",class:"v-pagination__prev","data-test":"v-pagination-prev"},[o.prev?o.prev(w.value.prev):e(L,ue({_as:"VPaginationBtn"},w.value.prev),null)]),x.value.map((G,I)=>T("li",{key:G.key,class:Ve(["v-pagination__item",{"v-pagination__item--is-active":G.isActive}]),"data-test":"v-pagination-item"},[o.item?o.item(G):e(L,ue({_as:"VPaginationBtn"},G.props),{default:()=>[G.page]})])),T("li",{key:"next",class:"v-pagination__next","data-test":"v-pagination-next"},[o.next?o.next(w.value.next):e(L,ue({_as:"VPaginationBtn"},w.value.next),null)]),l.showFirstLastPage&&T("li",{key:"last",class:"v-pagination__last","data-test":"v-pagination-last"},[o.last?o.last(w.value.last):e(L,ue({_as:"VPaginationBtn"},w.value.last),null)])])]})),{}}}),dn={key:2},yt=16,mn=X({__name:"CampsList",emits:["show-participants"],setup(l,{emit:s}){const o=s;Oe(r);const c=bt(new Map),a=S(!1),i=bt({pattern:"",openOnly:!1}),v=F(()=>{const M=new Set,y=new Set;for(const O of c.values())for(const R of Object.entries(O.Camp.Camp.Meta||{}))M.add(R[0]),y.add(R[1]);return{keys:Array.from(M.keys()).sort(),values:Array.from(y.keys()).sort()}}),n=F(()=>{const M=al(i.pattern),y=Array.from(c.values()).filter(O=>_e.match(O.Camp.Camp,M)&&(!i.openOnly||Et(O.Camp)));return y.sort((O,R)=>{const ye=new Date(R.Camp.Camp.DateDebut).valueOf(),ne=new Date(O.Camp.Camp.DateDebut).valueOf();return ye==ne?O.Camp.Camp.Id-R.Camp.Camp.Id:ye-ne}),y}),d=F(()=>n.value.slice((V.value-1)*yt,V.value*yt));function u(){V.value>p.value&&(V.value=p.value)}async function r(){a.value=!0;const M=await P.CampsGet();a.value=!1,M!==void 0&&(c.clear(),M?.forEach(y=>c.set(y.Camp.Camp.Id,y)))}async function m(){a.value=!0;const M=await P.CampsCreate();a.value=!1,M!==void 0&&(P.showMessage("Camp ajouté avec succès."),c.set(M.Camp.Camp.Id,M),_.value=M)}const p=F(()=>Math.max(Math.ceil(n.value.length/yt),1)),V=S(1),_=S(null);async function k(M){_.value=null,a.value=!0;const y=await P.CampsUpdate(M);a.value=!1,y!==void 0&&(P.showMessage("Séjour modifié avec succès."),c.get(y.Camp.Id).Camp=y,u())}const C=S(null);async function A(){const M=C.value;if(M==null)return;C.value=null,a.value=!0;const y=await P.CampsSetTaux({IdCamp:M.Camp.Camp.Id,Taux:M.Taux});if(a.value=!1,y===void 0)return;P.showMessage("Taux modifié avec succès.");const O=c.get(M.Camp.Camp.Id);O.Camp.Camp.IdTaux=y.Id,O.Taux=y}const q=S(!1),B=S(5),x=S({Id:1,Label:"",Euros:0,FrancsSuisse:0}),w=F(()=>x.value.Id>0||x.value.Label!=""),ee=F(()=>new Set(Array.from(c.values()).filter(y=>Et(y.Camp)).map(y=>y.Camp.Camp.IdTaux)).size<=1);async function ge(){q.value=!1,a.value=!0;const M=await P.CampsCreateMany({Count:B.value,Taux:x.value});a.value=!1,M!==void 0&&(P.showMessage("Séjours créés avec succès."),M?.forEach(y=>c.set(y.Camp.Camp.Id,y)))}async function G(M){a.value=!0;const y=await P.CampsDelete({id:M.Camp.Camp.Id});a.value=!1,y!==void 0&&(P.showMessage("Séjour supprimé avec succès."),c.delete(M.Camp.Camp.Id),u())}const I=S(!1);function te(){Q.value=Array.from(c.values()).filter(M=>M.Camp.Camp.Statut!=Gl.Ouvert).map(M=>M.Camp.Camp.Id),I.value=!0}const Q=S([]);async function N(){I.value=!1,!(!Q.value.length||await P.CampsOuvreInscriptions({Camps:Q.value})===void 0)&&(P.showMessage("Séjours ouverts aux inscriptions avec succès."),r())}const K=S(null),oe=S(null);async function ae(M){oe.value={Current:0,Total:10};const y=await P.EventsSendSondages({idCamp:M});if(y===void 0){oe.value=null;return}await gt(y,O=>oe.value=O,O=>P.onError("Envoi du sondage",O)),oe.value=null,P.showMessage("Sondage envoyé avec succès.")}async function fe(M,y){await P.CampsCreateEquipier({IdPersonne:M,IdCamp:y,Roles:[Kl.Direction]})!==void 0&&(c.get(y).HasDirecteur=!0,P.showMessage("Directeur ajouté avec succès."))}const be=S(!1);return(M,y)=>{const O=We;return b(),W(le,null,[e(j,{title:"Séjours",subtitle:c.size},{append:t(()=>[e(h,null,{default:t(()=>[e(g,{"align-self":"center",style:{width:"240px"}},{default:t(()=>[e(pe,{label:"Rechercher",variant:"filled",density:"comfortable","hide-details":"","prepend-inner-icon":"mdi-magnify",clearable:"",modelValue:i.pattern,"onUpdate:modelValue":[y[0]||(y[0]=R=>i.pattern=R),y[2]||(y[2]=R=>u())],"onClick:clear":y[1]||(y[1]=R=>{i.pattern="",u()})},null,8,["modelValue"])]),_:1}),e(re,{vertical:"",thickness:"1"}),e(g,{"align-self":"center",cols:"auto"},{default:t(()=>[e(Se,null,{activator:t(({props:R})=>[e(L,ue(R,{color:"success",disabled:a.value}),{prepend:t(()=>[e(ve,null,{default:t(()=>[...y[18]||(y[18]=[f("mdi-plus",-1)])]),_:1})]),default:t(()=>[y[19]||(y[19]=f(" Créer un séjour ",-1))]),_:1},16,["disabled"])]),default:t(()=>[e(Pe,{density:"compact"},{default:t(()=>[e(z,{onClick:m,title:"Créer un séjour"}),e(z,{title:"Créer plusieurs séjours...",subtitle:"Permet de choisir les taux de conversion",onClick:y[3]||(y[3]=R=>q.value=!0)})]),_:1})]),_:1})]),_:1}),e(g,{"align-self":"center",cols:"auto"},{default:t(()=>[e(L,{flat:"",icon:"",size:"small"},{default:t(()=>[e(ve,{icon:"mdi-dots-vertical"}),e(Se,{activator:"parent"},{default:t(()=>[e(Pe,{density:"compact"},{default:t(()=>[e(z,{title:"Masquer les camps fermés",subtitle:"N'afficher que les camps ouverts aux inscriptions",onClick:y[5]||(y[5]=R=>i.openOnly=!i.openOnly)},{prepend:t(()=>[e(qe,{class:"mr-2",modelValue:i.openOnly,"onUpdate:modelValue":y[4]||(y[4]=R=>i.openOnly=R),density:"compact","hide-details":""},null,8,["modelValue"])]),_:1}),e(re,{thickness:"1"}),e(z,{onClick:y[6]||(y[6]=R=>be.value=!0),title:"Configurer les albums Joomeo...","prepend-icon":"mdi-image-album"}),e(re,{thickness:"1"}),e(z,{onClick:te,title:"Ouvrir les inscriptions...",subtitle:"sur plusieurs séjours","prepend-icon":"mdi-lock-open"})]),_:1})]),_:1})]),_:1})]),_:1})]),_:1})]),default:t(()=>[e(Y,{class:"mt-4"},{default:t(()=>[ee.value?J("",!0):(b(),D(Jl,{key:0,type:"warning"},{default:t(()=>[...y[20]||(y[20]=[f(" Attention, les séjours ouverts aux inscriptions ont des taux de conversion incompatibles ! ",-1)])]),_:1})),a.value?(b(),D(at,{key:1})):n.value.length==0?(b(),W("i",dn," Aucun camp ne correspond aux filtres actuels. ")):J("",!0),(b(!0),W(le,null,ce(d.value,(R,ye)=>(b(),D(tn,{key:ye,camp:R,onClick:ne=>o("show-participants",R),onEdit:ne=>_.value=R,onEditTaux:ne=>C.value=R,onDelete:ne=>G(R),onShowDocuments:ne=>K.value=R,onSendSondage:ne=>ae(R.Camp.Camp.Id),onAddDirecteur:ne=>fe(ne,R.Camp.Camp.Id)},null,8,["camp","onClick","onEdit","onEditTaux","onDelete","onShowDocuments","onSendSondage","onAddDirecteur"]))),128)),e(rn,{length:p.value,modelValue:V.value,"onUpdate:modelValue":y[7]||(y[7]=R=>V.value=R)},null,8,["length","modelValue"])]),_:1})]),_:1},8,["subtitle"]),e(Z,{"model-value":_.value!=null,"onUpdate:modelValue":y[8]||(y[8]=R=>_.value=null),"max-width":"800px"},{default:t(()=>[_.value!=null?(b(),D(Xa,{key:0,camp:_.value.Camp.Camp,"preselection-url":_.value.URLPreselection,"meta-entries-hints":v.value,onSave:k},null,8,["camp","preselection-url","meta-entries-hints"])):J("",!0)]),_:1},8,["model-value"]),e(Z,{"model-value":C.value!=null,"onUpdate:modelValue":y[10]||(y[10]=R=>C.value=null),"max-width":"600"},{default:t(()=>[C.value!=null?(b(),D(j,{key:0,title:"Modifier le taux",subtitle:"La modification n'est possible que si aucun participant n'est enregistré."},{default:t(()=>[e(Y,null,{default:t(()=>[e(Qt,{modelValue:C.value.Taux,"onUpdate:modelValue":y[9]||(y[9]=R=>C.value.Taux=R)},null,8,["modelValue"])]),_:1}),e(se,null,{default:t(()=>[e(ie),e(L,{disabled:C.value.Stats.Inscriptions>0,onClick:A},{default:t(()=>[...y[21]||(y[21]=[f("Modifier",-1)])]),_:1},8,["disabled"])]),_:1})]),_:1})):J("",!0)]),_:1},8,["model-value"]),e(Z,{modelValue:q.value,"onUpdate:modelValue":y[13]||(y[13]=R=>q.value=R),"max-width":"600"},{default:t(()=>[e(j,{title:"Créer plusieurs séjours",subtitle:"Les séjours seront liés au même taux de conversion"},{default:t(()=>[e(Y,null,{default:t(()=>[e(h,null,{default:t(()=>[e(g,null,{default:t(()=>[e(O,{label:"Nombre de séjours",modelValue:B.value,"onUpdate:modelValue":y[11]||(y[11]=R=>B.value=R)},null,8,["modelValue"])]),_:1})]),_:1}),e(re,{thickness:"2",class:"my-2"}),e(Qt,{modelValue:x.value,"onUpdate:modelValue":y[12]||(y[12]=R=>x.value=R)},null,8,["modelValue"])]),_:1}),e(se,null,{default:t(()=>[e(ie),e(L,{color:"success",onClick:ge,disabled:!w.value},{default:t(()=>[...y[22]||(y[22]=[f("Créer",-1)])]),_:1},8,["disabled"])]),_:1})]),_:1})]),_:1},8,["modelValue"]),e(Z,{modelValue:I.value,"onUpdate:modelValue":y[15]||(y[15]=R=>I.value=R),"max-width":"600"},{default:t(()=>[e(j,{title:"Ouvrir les inscriptions",subtitle:"Ouvre les inscriptions sur les séjours ci-dessous"},{default:t(()=>[e(Y,null,{default:t(()=>[e(ln,{"all-camps":Array.from(c.values()).map(R=>U(_e).toItem(R.Camp)),modelValue:Q.value,"onUpdate:modelValue":y[14]||(y[14]=R=>Q.value=R)},null,8,["all-camps","modelValue"])]),_:1}),e(se,null,{default:t(()=>[e(ie),e(L,{onClick:N,disabled:!Q.value.length},{default:t(()=>[...y[23]||(y[23]=[f("Ouvrir",-1)])]),_:1},8,["disabled"])]),_:1})]),_:1})]),_:1},8,["modelValue"]),e(Z,{"model-value":K.value!=null,"onUpdate:modelValue":y[16]||(y[16]=R=>K.value=null),"max-width":"800px"},{default:t(()=>[K.value?(b(),D(an,{key:0,camp:K.value},null,8,["camp"])):J("",!0)]),_:1},8,["model-value"]),e(Z,{"model-value":oe.value!=null,"max-width":"400px",persistent:""},{default:t(()=>[oe.value?(b(),D(kt,{key:0,title:"Envoi du sondage en cours",current:oe.value.Current,total:oe.value.Total},null,8,["current","total"])):J("",!0)]),_:1},8,["model-value"]),e(Z,{modelValue:be.value,"onUpdate:modelValue":y[17]||(y[17]=R=>be.value=R)},{default:t(()=>[e(un)]),_:1},8,["modelValue"])],64)}}}),cn={key:1},vn={key:0,class:"text-center font-italic"},pn=X({__name:"CampParticipants",props:{id:{},idParticipant:{}},setup(l){const s=l;Oe(async()=>{a(),await n(),d()}),Me(()=>s.id,n),Me(()=>s.idParticipant,d);const o=S(!1),c=S([]);async function a(){const B=await P.GetCamps();B!==void 0&&(c.value=B||[])}const i=F(()=>{const B=(v.value?.Participants||[]).map(x=>x);return B.sort(Xl.cmp),B}),v=S(null);async function n(){o.value=!0;const B=await P.CampsLoad({idCamp:s.id});o.value=!1,B!==void 0&&(v.value=B)}function d(){if(s.idParticipant===void 0)return;const B=(v.value?.Participants||[]).find(x=>x.Participant.Id==s.idParticipant);B&&(m.value=we(B))}const u=S(null);async function r(){if(u.value==null||v.value==null)return;const B=await P.ParticipantsCreate(u.value);u.value=null,B!==void 0&&(P.showMessage("Participant créé avec succès."),v.value.Participants=(v.value.Participants||[]).concat(B),m.value=we(B))}const m=S(null);async function p(B){if(m.value==null||v.value==null)return;const x=await P.ParticipantsUpdate(B);m.value=null,x!==void 0&&(P.showMessage("Participant modifié avec succès."),n())}const V=S(null);async function _(){if(V.value==null||v.value==null)return;const B=V.value.Participant.Id,x=await P.ParticipantsDelete({id:B});V.value=null,x!==void 0&&(P.showMessage("Participant supprimé avec succès."),v.value.Participants=(v.value.Participants||[]).filter(w=>w.Participant.Id!=B))}const k=S(null);async function C(){const B=k.value;B==null||v.value==null||(k.value=null,await P.ParticipantsMove(B)===void 0)||(P.showMessage("Participant déplacé avec succès.",void 0,{title:"Aller au nouveau séjour",action:()=>wt({IdCamp:B.Target,Id:B.Id})}),v.value.Participants=(v.value.Participants||[]).filter(w=>w.Participant.Id!=B.Id))}const A=S(null);async function q(){if(A.value==null)return;const B=A.value.Participant.Id;A.value=null;const x=await P.ParticipantsSetPlaceLiberee({id:B});if(x===void 0||(P.showMessage("Notification de place libérée envoyée avec succès."),v.value==null))return;const w=v.value.Participants?.find(ee=>ee.Participant.Id==B);w.Participant=x}return(B,x)=>{const w=Ca,ee=xa,ge=ut,G=ul,I=Pa,te=it;return v.value!=null?(b(),D(j,{key:0,title:"Participants",subtitle:U(_e).label(v.value.Camp.Camp)},{append:t(()=>[e(L,{color:"green",onClick:x[0]||(x[0]=Q=>u.value={IdCamp:s.id,IdDossier:0,IdPersonne:0})},{prepend:t(()=>[e(ve,null,{default:t(()=>[...x[9]||(x[9]=[f("mdi-plus",-1)])]),_:1})]),default:t(()=>[x[10]||(x[10]=f(" Ajouter un participant",-1))]),_:1})]),default:t(()=>[e(Y,{class:"mt-4"},{default:t(()=>[o.value?(b(),D(at,{key:0,type:"table"})):(b(),W("div",cn,[e(w),i.value.length?J("",!0):(b(),W("div",vn," Aucun participant n'est encore inscrit sur ce séjour. ")),(b(!0),W(le,null,ce(i.value,(Q,N)=>(b(),D(ee,{participant:Q,index:N},{actions:t(()=>[e(Pe,{density:"comfortable"},{default:t(()=>[e(z,{title:"Modifier","prepend-icon":"mdi-pencil",onClick:K=>m.value=Q},null,8,["onClick"]),e(re),e(z,{title:"Changer de camp...","prepend-icon":"mdi-file-move",onClick:K=>k.value={Id:Q.Participant.Id,Target:0}},null,8,["onClick"]),e(z,{title:"Notifier d'une place disponible.",subtitle:"Envoi un email","prepend-icon":"mdi-email-alert",disabled:Q.Participant.Statut==U(Ze).Inscrit||Q.Participant.Statut==U(Ze).EnAttenteReponse,onClick:K=>A.value=Q},null,8,["disabled","onClick"]),e(re),e(z,{title:"Aller à la personne",subtitle:`(ID : ${Q.Personne.Id})`,onClick:K=>U(Ke)(Q.Personne.Id)},null,8,["subtitle","onClick"]),e(z,{title:"Aller au dossier",subtitle:`(ID : ${Q.Participant.IdDossier})`,onClick:K=>U(_t)(Q.Participant.IdDossier)},null,8,["subtitle","onClick"]),e(re),e(z,{title:"Supprimer","prepend-icon":"mdi-delete",onClick:K=>V.value=Q},null,8,["onClick"])]),_:2},1024)]),_:2},1032,["participant","index"]))),256))]))]),_:1}),u.value!=null?(b(),D(Z,{key:0,"model-value":u.value!=null,"onUpdate:modelValue":x[3]||(x[3]=Q=>u.value=null),"max-width":"600px"},{default:t(()=>[e(j,{title:"Créer un participant"},{default:t(()=>[e(Y,null,{default:t(()=>[e(h,null,{default:t(()=>[e(g,{cols:"12"},{default:t(()=>[e(ge,{label:"Participant",modelValue:u.value.IdPersonne,"onUpdate:modelValue":x[1]||(x[1]=Q=>u.value.IdPersonne=Q),"initial-personne":"",api:{SelectPersonne:U(P).SelectPersonne.bind(U(P))}},null,8,["modelValue","api"])]),_:1}),e(g,{cols:"12"},{default:t(()=>[e(G,{modelValue:u.value.IdDossier,"onUpdate:modelValue":x[2]||(x[2]=Q=>u.value.IdDossier=Q)},null,8,["modelValue"])]),_:1})]),_:1})]),_:1}),e(se,null,{default:t(()=>[e(ie),e(L,{color:"green",onClick:r,disabled:!(u.value.IdDossier&&u.value.IdPersonne)},{default:t(()=>[...x[11]||(x[11]=[f("Créer",-1)])]),_:1},8,["disabled"])]),_:1})]),_:1})]),_:1},8,["model-value"])):J("",!0),m.value!=null?(b(),D(Z,{key:1,"model-value":m.value!=null,"onUpdate:modelValue":x[4]||(x[4]=Q=>m.value=null),"max-width":"800px"},{default:t(()=>[e(I,{participant:m.value.Participant,personne:m.value.Personne,api:{SelectPersonne:U(P).SelectPersonne.bind(U(P))},onSave:p},null,8,["participant","personne","api"])]),_:1},8,["model-value"])):J("",!0),V.value!=null?(b(),D(Z,{key:2,"model-value":V.value!=null,"onUpdate:modelValue":x[5]||(x[5]=Q=>V.value=null),"max-width":"600px"},{default:t(()=>[e(j,{title:"Supprimer le participant"},{default:t(()=>[e(Y,null,{default:t(()=>[x[12]||(x[12]=f(" Confirmez-vous la suppression du participant ",-1)),T("b",null,$(U(Ee).label(V.value.Personne)),1),x[13]||(x[13]=f(" ? ",-1)),x[14]||(x[14]=T("br",null,null,-1)),x[15]||(x[15]=T("br",null,null,-1)),x[16]||(x[16]=f(" Attention, cette opération est irréversible. ",-1))]),_:1}),e(se,null,{default:t(()=>[e(ie),e(L,{color:"red",onClick:_},{default:t(()=>[...x[17]||(x[17]=[f("Supprimer",-1)])]),_:1})]),_:1})]),_:1})]),_:1},8,["model-value"])):J("",!0),k.value!=null?(b(),D(Z,{key:3,"model-value":k.value!=null,"onUpdate:modelValue":x[7]||(x[7]=Q=>k.value=null),"max-width":"500px"},{default:t(()=>[e(j,{title:"Déplacer le participant"},{default:t(()=>[e(Y,null,{default:t(()=>[e(te,{label:"Nouveau séjour",camps:c.value,modelValue:k.value.Target,"onUpdate:modelValue":x[6]||(x[6]=Q=>k.value.Target=Q)},null,8,["camps","modelValue"])]),_:1}),e(se,null,{default:t(()=>[e(ie),e(L,{onClick:C,disabled:k.value.Target==s.id||!k.value.Target},{default:t(()=>[...x[18]||(x[18]=[f("Déplacer",-1)])]),_:1},8,["disabled"])]),_:1})]),_:1})]),_:1},8,["model-value"])):J("",!0),A.value!=null?(b(),D(Z,{key:4,"model-value":A.value!=null,"onUpdate:modelValue":x[8]||(x[8]=Q=>A.value=null),"max-width":"500px"},{default:t(()=>[e(j,{title:"Notifier d'une place disponible"},{default:t(()=>[e(Y,null,{default:t(()=>[f(" Confirmez-vous l'envoi d'une notification au responsable de "+$(U(Ee).label(A.value.Personne))+" indiquant qu'une place est disponible ? ",1),x[19]||(x[19]=T("br",null,null,-1)),x[20]||(x[20]=T("br",null,null,-1)),f(" Le nouveau statut de "+$(A.value.Personne.Prenom)+" sera : ",1),T("i",null,$(U(Zl)[U(Ze).EnAttenteReponse]),1),x[21]||(x[21]=f(". ",-1))]),_:1}),e(se,null,{default:t(()=>[e(ie),e(L,{onClick:q},{default:t(()=>[...x[22]||(x[22]=[f("Notifier",-1)])]),_:1})]),_:1})]),_:1})]),_:1},8,["model-value"])):J("",!0)]),_:1},8,["subtitle"])):(b(),D(at,{key:1,type:"card"}))}}}),fn=X({__name:"camps",setup(l){const s=nt(),o=F(()=>cu(s.currentRoute.value.query)),c=F(()=>o.value.idCamp);function a(v){const n=s.currentRoute.value;s.push({path:n.path,query:{idCamp:v.Camp.Camp.Id}})}function i(){const v=s.currentRoute.value;s.push({path:v.path,query:{}})}return(v,n)=>(b(),W(le,null,[e(ft,{title:"Gestion des séjours"},{default:t(()=>[c.value!==null?(b(),D(L,{key:0,onClick:i},{prepend:t(()=>[e(ve,null,{default:t(()=>[...n[0]||(n[0]=[f("mdi-view-list",-1)])]),_:1})]),default:t(()=>[n[1]||(n[1]=f(" Retour à la liste",-1))]),_:1})):J("",!0)]),_:1}),c.value===void 0?(b(),D(mn,{key:0,onShowParticipants:a})):(b(),D(pn,{key:1,id:c.value,"id-participant":o.value.idParticipant},null,8,["id","id-participant"]))],64))}}),fl=X({__name:"MergeCard",props:{from:{}},emits:["merge"],setup(l,{emit:s}){const o=l,c=s,a=S(0),i=S(!0);return(v,n)=>{const d=ul;return b(),D(j,{title:"Fusionner le dossier vers",subtitle:"Les participants, paiements et messages seront copiés vers le dossier cible."},{default:t(()=>[e(Y,null,{default:t(()=>[e(h,null,{default:t(()=>[e(g,{cols:"12"},{default:t(()=>[e(d,{modelValue:a.value,"onUpdate:modelValue":n[0]||(n[0]=u=>a.value=u)},null,8,["modelValue"])]),_:1}),e(g,{cols:"12"},{default:t(()=>[e(qe,{density:"compact",label:"Notifier par email",hint:"Le reponsable du dossier absorbé sera averti du changement d'espace personnel.","persistent-hint":"",modelValue:i.value,"onUpdate:modelValue":n[1]||(n[1]=u=>i.value=u)},null,8,["modelValue"])]),_:1})]),_:1})]),_:1}),e(se,null,{default:t(()=>[e(ie),e(L,{disabled:a.value==0||a.value==o.from,onClick:n[2]||(n[2]=u=>c("merge",{From:o.from,To:a.value,Notifie:i.value}))},{default:t(()=>[...n[3]||(n[3]=[f("Fusionner",-1)])]),_:1},8,["disabled"])]),_:1})]),_:1})}}}),yn={key:1,class:"text-center font-italic"},bn={key:2},gn=X({__name:"PannelInscriptions",emits:["goTo","empty"],setup(l,{emit:s}){const o=s,c=S(!1);Oe(async()=>{await i(),a.value.length||o("empty")});const a=S([]);async function i(){c.value=!0;const k=await P.InscriptionsGet();c.value=!1,k!==void 0&&(a.value=k||[])}const v=S(""),n=F(()=>{const k=al(v.value);return a.value.filter(C=>Ee.match(C.Responsable,k)||C.Participants?.some(A=>Ee.match(A.Personne,k)||_e.match(A.Camp,k)))});async function d(k,C){const A=await P.InscriptionsIdentifiePersonne({IdDossier:k,Target:C});if(A===void 0)return;P.showMessage("Profil identifié avec succès.");const q=a.value.findIndex(B=>B.Dossier.Id==k);a.value[q]=A}const u=S(null);async function r(k,C){if(!u.value)return;const A=u.value.inscription.Dossier.Id;u.value=null;const q=await P.InscriptionsValide({IdDossier:A,Statuts:k,SendMail:C});if(q!==void 0)if(q.Dossier.IsValidated)P.showMessage("Inscription validée avec succès.","",{title:"Aller au dossier",action:()=>o("goTo",A)}),a.value=a.value.filter(B=>B.Dossier.Id!=A);else{P.showMessage("Participant validé avec succès.");const B=a.value.findIndex(x=>x.Dossier.Id==A);a.value[B]=q}}async function m(k){await P.DossiersDelete({id:k.Dossier.Id})!==void 0&&(P.showMessage("Inscription supprimée avec succès."),a.value=a.value.filter(A=>A.Dossier.Id!=k.Dossier.Id))}async function p(k,C){if(await P.ParticipantsDelete({id:C})===void 0)return;P.showMessage("Participant supprimé avec succès.");const q=a.value.find(B=>B.Dossier.Id==k);q.Participants=(q.Participants||[]).filter(B=>B.Participant.Id!=C)}const V=S(null);async function _(k){V.value=null,await P.DossiersMerge(k)!==void 0&&(P.showMessage("Inscriptions fusionnées avec succès."),i())}return(k,C)=>{const A=Da;return b(),D(j,{title:"Inscriptions",subtitle:"En attente de validation",class:"ma-2"},{append:t(()=>[e(pe,{width:"300","append-inner-icon":"mdi-magnify",label:"Rechercher","hide-details":"",modelValue:v.value,"onUpdate:modelValue":C[0]||(C[0]=q=>v.value=q)},null,8,["modelValue"])]),default:t(()=>[e(Y,null,{default:t(()=>[c.value?(b(),D(at,{key:0})):a.value.length?(b(),W("div",bn,[(b(!0),W(le,null,ce(n.value,(q,B)=>(b(),D(wa,{class:"my-1",user:null,key:B,inscription:q,onIdentifie:x=>d(q.Dossier.Id,x),onValide:x=>u.value={inscription:q,participants:x===void 0?void 0:[x]},onMerge:x=>V.value=q.Dossier.Id,onDelete:x=>m(q),onDeleteParticipant:x=>p(q.Dossier.Id,x),api:{SearchSimilaires:U(P).InscriptionsSearchSimilaires.bind(U(P)),SelectPersonne:U(P).SelectPersonne.bind(U(P))}},null,8,["inscription","onIdentifie","onValide","onMerge","onDelete","onDeleteParticipant","api"]))),128))])):(b(),W("div",yn," Il n'y a aucune inscription à valider. "))]),_:1}),e(Z,{"model-value":V.value!=null,"onUpdate:modelValue":C[1]||(C[1]=q=>V.value=null),"max-width":"600px"},{default:t(()=>[V.value!=null?(b(),D(fl,{key:0,from:V.value,onMerge:_},null,8,["from"])):J("",!0)]),_:1},8,["model-value"]),e(Z,{"model-value":u.value!=null,"onUpdate:modelValue":C[2]||(C[2]=q=>u.value=null),"max-width":"800px"},{default:t(()=>[u.value?(b(),D(A,{key:0,inscription:u.value.inscription,"id-participants":u.value.participants,onValide:r},null,8,["inscription","id-participants"])):J("",!0)]),_:1},8,["model-value"])]),_:1})}}}),Vn={class:"text-grey"},kn={class:"text-grey"},_n={key:0},Cn=X({__name:"FactureCard",props:{dossier:{}},setup(l){const s=l,o=F(()=>(s.dossier.Participants||[]).filter(n=>n.Participant.Statut!=Ze.Inscrit).map(n=>Ee.label(n.Personne))),c=F(()=>(s.dossier.Participants||[]).filter(n=>n.Participant.Statut==Ze.Inscrit).map(n=>({Label:Ee.label(n.Personne),Camp:_e.label(n.Camp),Prix:ke.montant(n.Camp.Prix),Bilan:s.dossier.Bilan.Inscrits[n.Participant.Id]})));function a(n){return!!(n.Remises.ReducEnfants||n.Remises.ReducEquipiers||n.Remises.ReducSpeciale.Cent)}function i(n){const d=[];return n.ReducEnfants&&d.push(`Enfants : ${n.ReducEnfants}%`),n.ReducEquipiers&&d.push(`Enfants : ${n.ReducEquipiers}%`),n.ReducSpeciale.Cent&&d.push(`Remise : ${ke.montant(n.ReducSpeciale)}`),d.join("  ;  ")}const v=F(()=>{const n=Object.values(s.dossier.Paiements||{});return n.sort((d,u)=>new Date(d.Time).valueOf()-new Date(u.Time).valueOf()),n});return(n,d)=>(b(),D(j,{title:"Suivi financier",subtitle:o.value.length?`Les participants en liste d'attente (${o.value.join(", ")}) ne sont pas pris en compte.`:"","min-width":"900px"},{default:t(()=>[e(Y,null,{default:t(()=>[e(h,null,{default:t(()=>[e(g,{cols:"3"},{default:t(()=>[...d[0]||(d[0]=[f("Participant",-1)])]),_:1}),e(g,{cols:"2",class:"text-center"},{default:t(()=>[...d[1]||(d[1]=[f("Prix du séjour",-1)])]),_:1}),e(g,{cols:"2",class:"text-center"},{default:t(()=>[...d[2]||(d[2]=[f("Prix avec option",-1)])]),_:1}),e(g,{cols:"3",class:"text-center"},{default:t(()=>[...d[3]||(d[3]=[f("Aides extérieures",-1)])]),_:1}),e(g,{cols:"2",class:"text-right"},{default:t(()=>[...d[4]||(d[4]=[f("Sous-total",-1)])]),_:1})]),_:1}),e(re,{thickness:"1",class:"my-2"}),(b(!0),W(le,null,ce(c.value,u=>(b(),W(le,null,[e(h,null,{default:t(()=>[e(g,{"align-self":"center",cols:"3"},{default:t(()=>[f($(u.Label)+" ",1),d[5]||(d[5]=T("br",null,null,-1)),T("span",Vn,$(u.Camp),1)]),_:2},1024),e(g,{"align-self":"center",cols:"2",class:"text-center"},{default:t(()=>[f($(u.Prix),1)]),_:2},1024),e(g,{"align-self":"center",cols:"2",class:"text-center"},{default:t(()=>[f($(U(ke).montant(u.Bilan.AvecOption))+" ",1),d[6]||(d[6]=T("br",null,null,-1)),T("span",kn,$(u.Bilan.AvecOptionDescription),1)]),_:2},1024),e(g,{"align-self":"center",cols:"3",class:"text-center"},{default:t(()=>[u.Bilan.Aides?.length?J("",!0):(b(),W("span",_n,"-")),(b(!0),W(le,null,ce(u.Bilan.Aides,r=>(b(),D(Ce,null,{default:t(()=>[f($(r.Structure)+" : "+$(U(ke).montant(r.Montant)),1)]),_:2},1024))),256))]),_:2},1024),e(g,{"align-self":"center",cols:"2",class:"text-right"},{default:t(()=>[f($(u.Bilan.AvecAides),1)]),_:2},1024)]),_:2},1024),a(u.Bilan)?(b(),D(h,{key:0,"no-gutters":""},{default:t(()=>[e(g,{cols:"10",class:"text-right"},{default:t(()=>[T("i",null,$(i(u.Bilan.Remises)),1)]),_:2},1024),e(g,{cols:"2",class:"text-right"},{default:t(()=>[f($(u.Bilan.Net),1)]),_:2},1024)]),_:2},1024)):J("",!0)],64))),256)),e(re,{thickness:"1",class:"my-2"}),e(h,null,{default:t(()=>[e(g,{cols:"10",class:"text-right"},{default:t(()=>[...d[7]||(d[7]=[f("Total demandé",-1)])]),_:1}),e(g,{cols:"2",class:"text-right"},{default:t(()=>[f($(s.dossier.Bilan.Demande),1)]),_:1})]),_:1}),e(re,{thickness:"1",class:"my-2"}),(b(!0),W(le,null,ce(v.value,u=>(b(),D(h,null,{default:t(()=>[e(g,null,{default:t(()=>[f(" Paiement de "+$(u.Payeur)+", le "+$(U(ke).date(u.Time)),1)]),_:2},1024),e(g,{cols:"2",class:"text-right"},{default:t(()=>[f($(u.IsRemboursement?"+":"-")+$(U(ke).montant(u.Montant)),1)]),_:2},1024)]),_:2},1024))),256)),e(h,null,{default:t(()=>[e(g,{cols:"10",class:"text-right"},{default:t(()=>[...d[8]||(d[8]=[f("Solde",-1)])]),_:1}),e(g,{cols:"2",class:"text-right"},{default:t(()=>[T("b",null,$(s.dossier.Bilan.Restant),1)]),_:1})]),_:1})]),_:1})]),_:1},8,["subtitle"]))}});function Be(l){let s=arguments.length>1&&arguments[1]!==void 0?arguments[1]:2;return String(l).padStart(s,"0")}const Pn=Ue({allowedValues:Function,ampm:Boolean,color:String,disabled:Boolean,displayedValue:null,double:Boolean,format:{type:Function,default:l=>l},max:{type:Number,required:!0},min:{type:Number,required:!0},scrollable:Boolean,readonly:Boolean,rotate:{type:Number,default:0},step:{type:Number,default:1},modelValue:{type:Number}},"VTimePickerClock"),Wt=Re()({name:"VTimePickerClock",props:Pn(),emits:{change:l=>!0,input:l=>!0},setup(l,s){let{emit:o}=s;const c=S(null),a=S(null),i=S(void 0),v=S(!1),n=S(null),d=S(null),u=ea(y=>o("change",y),750),{textColorClasses:r,textColorStyles:m}=ta(()=>l.color),{backgroundColorClasses:p,backgroundColorStyles:V}=Gt(()=>l.color),_=F(()=>l.max-l.min+1),k=F(()=>l.double?_.value/2:_.value),C=F(()=>360/k.value),A=F(()=>C.value*Math.PI/180),q=F(()=>l.modelValue==null?l.min:l.modelValue),B=F(()=>.62),x=F(()=>{const y=[];for(let O=l.min;O<=l.max;O=O+l.step)y.push(O);return y});Me(()=>l.modelValue,y=>{i.value=y});function w(y){i.value!==y&&(i.value=y),o("input",y)}function ee(y){return!l.allowedValues||l.allowedValues(y)}function ge(y){if(!l.scrollable||l.disabled)return;y.preventDefault();const O=Math.sign(-y.deltaY||1);let R=q.value;do R=R+O,R=(R-l.min+_.value)%_.value+l.min;while(!ee(R)&&R!==q.value);R!==l.displayedValue&&w(R),u(R)}function G(y){return l.double&&y-l.min>=k.value}function I(y){return G(y)?B.value:1}function te(y){const O=l.rotate*Math.PI/180;return{x:Math.sin((y-l.min)*A.value+O)*I(y),y:-Math.cos((y-l.min)*A.value+O)*I(y)}}function Q(y,O){const R=(Math.round(y/C.value)+(O?k.value:0))%_.value+l.min;return y<360-C.value/2?R:O?l.max-k.value+1:l.min}function N(y){const{x:O,y:R}=te(y);return{left:`${Math.round(50+O*50)}%`,top:`${Math.round(50+R*50)}%`}}function K(y,O){const R=O.x-y.x,ye=O.y-y.y;return Math.sqrt(R*R+ye*ye)}function oe(y,O){const R=2*Math.atan2(O.y-y.y-K(y,O),O.x-y.x);return Math.abs(R*180/Math.PI)}function ae(y){n.value===null&&(n.value=y),d.value=y,w(y)}function fe(y){if(y.preventDefault(),!v.value&&y.type!=="click"||!c.value)return;const{width:O,top:R,left:ye}=c.value?.getBoundingClientRect(),{width:ne}=a.value?.getBoundingClientRect()??{width:0},{clientX:Ie,clientY:E}="touches"in y?y.touches[0]:y,H={x:O/2,y:-O/2},de={x:Ie-ye,y:R-E},me=Math.round(oe(H,de)-l.rotate+360)%360,Dt=l.double&&K(H,de)<(ne+ne*B.value)/4,gl=Math.ceil(15/C.value);let Ye;for(let st=0;st<gl;st++)if(Ye=Q(me+st*C.value,Dt),ee(Ye)||(Ye=Q(me-st*C.value,Dt),ee(Ye)))return ae(Ye)}function be(y){l.disabled||(y.preventDefault(),window.addEventListener("mousemove",fe),window.addEventListener("touchmove",fe),window.addEventListener("mouseup",M),window.addEventListener("touchend",M),n.value=null,d.value=null,v.value=!0,fe(y))}function M(y){y.stopPropagation(),window.removeEventListener("mousemove",fe),window.removeEventListener("touchmove",fe),window.removeEventListener("mouseup",M),window.removeEventListener("touchend",M),v.value=!1,d.value!==null&&ee(d.value)&&o("change",d.value)}Le(()=>T("div",{class:Ve([{"v-time-picker-clock":!0,"v-time-picker-clock--indeterminate":l.modelValue==null,"v-time-picker-clock--readonly":l.readonly}]),onMousedown:be,onTouchstart:be,onWheel:ge,ref:c},[T("div",{class:"v-time-picker-clock__inner",ref:a},[T("div",{class:Ve([{"v-time-picker-clock__hand":!0,"v-time-picker-clock__hand--inner":G(l.modelValue)},r.value]),style:tt([{transform:`rotate(${l.rotate+C.value*(q.value-l.min)}deg) scaleY(${I(q.value)})`},m.value])},null),x.value.map(y=>{const O=y===q.value;return T("div",{class:Ve([{"v-time-picker-clock__item":!0,"v-time-picker-clock__item--active":O,"v-time-picker-clock__item--disabled":l.disabled||!ee(y)},O&&p.value]),style:tt([N(y),O&&V.value])},[T("span",null,[l.format(y)])])})])]))}}),xn=Ue({ampm:Boolean,color:String,disabled:Boolean,hour:Number,minute:Number,second:Number,period:String,readonly:Boolean,useSeconds:Boolean,value:Number,viewMode:String},"VTimePickerControls"),Jt=Re()({name:"VTimePickerControls",props:xn(),emits:{"update:period":l=>!0,"update:viewMode":l=>!0},setup(l,s){let{emit:o,slots:c}=s;const{t:a}=ze();return Le(()=>{let i=l.hour;return l.ampm&&(i=i?(i-1)%12+1:12),T("div",{class:"v-time-picker-controls"},[T("div",{class:Ve({"v-time-picker-controls__time":!0,"v-time-picker-controls__time--with-seconds":l.useSeconds})},[e(L,{active:l.viewMode==="hour",color:l.viewMode==="hour"?l.color:void 0,disabled:l.disabled,variant:"tonal",class:Ve({"v-time-picker-controls__time__btn":!0,"v-time-picker-controls__time--with-ampm__btn":l.ampm,"v-time-picker-controls__time--with-seconds__btn":l.useSeconds}),text:l.hour==null?"--":Be(`${i}`),onClick:()=>o("update:viewMode","hour")},null),T("span",{class:Ve(["v-time-picker-controls__time__separator",{"v-time-picker-controls--with-seconds__time__separator":l.useSeconds}])},[f(":")]),e(L,{active:l.viewMode==="minute",color:l.viewMode==="minute"?l.color:void 0,class:Ve({"v-time-picker-controls__time__btn":!0,"v-time-picker-controls__time__btn__active":l.viewMode==="minute","v-time-picker-controls__time--with-ampm__btn":l.ampm,"v-time-picker-controls__time--with-seconds__btn":l.useSeconds}),disabled:l.disabled,variant:"tonal",text:l.minute==null?"--":Be(l.minute),onClick:()=>o("update:viewMode","minute")},null),l.useSeconds&&T("span",{class:Ve(["v-time-picker-controls__time__separator",{"v-time-picker-controls--with-seconds__time__separator":l.useSeconds}]),key:"secondsDivider"},[f(":")]),l.useSeconds&&e(L,{key:"secondsVal",active:l.viewMode==="second",color:l.viewMode==="second"?l.color:void 0,variant:"tonal",onClick:()=>o("update:viewMode","second"),class:Ve({"v-time-picker-controls__time__btn":!0,"v-time-picker-controls__time__btn__active":l.viewMode==="second","v-time-picker-controls__time--with-seconds__btn":l.useSeconds}),disabled:l.disabled,text:l.second==null?"--":Be(l.second)},null),l.ampm&&T("div",{class:"v-time-picker-controls__ampm"},[e(L,{active:l.period==="am",color:l.period==="am"?l.color:void 0,class:Ve({"v-time-picker-controls__ampm__am":!0,"v-time-picker-controls__ampm__btn":!0,"v-time-picker-controls__ampm__btn__active":l.period==="am"}),disabled:l.disabled,text:a("$vuetify.timePicker.am"),variant:l.disabled&&l.period==="am"?"elevated":"tonal",onClick:()=>l.period!=="am"?o("update:period","am"):null},null),e(L,{active:l.period==="pm",color:l.period==="pm"?l.color:void 0,class:Ve({"v-time-picker-controls__ampm__pm":!0,"v-time-picker-controls__ampm__btn":!0,"v-time-picker-controls__ampm__btn__active":l.period==="pm"}),disabled:l.disabled,text:a("$vuetify.timePicker.pm"),variant:l.disabled&&l.period==="pm"?"elevated":"tonal",onClick:()=>l.period!=="pm"?o("update:period","pm"):null},null)])])])}),{}}}),wn=he(24),yl=he(12),Dn=yl.map(l=>l+12);he(60);const Sn=Ue({allowedHours:[Function,Array],allowedMinutes:[Function,Array],allowedSeconds:[Function,Array],disabled:Boolean,format:{type:String,default:"ampm"},max:String,min:String,viewMode:{type:String,default:"hour"},period:{type:String,default:"am",validator:l=>["am","pm"].includes(l)},modelValue:null,readonly:Boolean,scrollable:Boolean,useSeconds:Boolean,...je(nl({title:"$vuetify.timePicker.title"}),["landscape"])},"VTimePicker"),In=Re()({name:"VTimePicker",props:Sn(),emits:{"update:hour":l=>!0,"update:minute":l=>!0,"update:period":l=>!0,"update:second":l=>!0,"update:modelValue":l=>!0,"update:viewMode":l=>!0},setup(l,s){let{emit:o,slots:c}=s;const{t:a}=ze(),i=S(null),v=S(null),n=S(null),d=S(null),u=S(null),r=S(null),m=$e(l,"period","am"),p=$e(l,"viewMode","hour"),V=S(null),_=S(null),k=F(()=>{let N;if(l.allowedHours instanceof Array?N=ae=>l.allowedHours.includes(ae):N=l.allowedHours,!l.min&&!l.max)return N;const K=l.min?Number(l.min.split(":")[0]):0,oe=l.max?Number(l.max.split(":")[0]):23;return ae=>ae>=Number(K)&&ae<=Number(oe)&&(!N||N(ae))}),C=F(()=>{let N;const K=!k.value||i.value===null||k.value(i.value);if(l.allowedMinutes instanceof Array?N=O=>l.allowedMinutes.includes(O):N=l.allowedMinutes,!l.min&&!l.max)return K?N:()=>!1;const[oe,ae]=l.min?l.min.split(":").map(Number):[0,0],[fe,be]=l.max?l.max.split(":").map(Number):[23,59],M=oe*60+Number(ae),y=fe*60+Number(be);return O=>{const R=60*i.value+O;return R>=M&&R<=y&&K&&(!N||N(O))}}),A=F(()=>{let N;const oe=(!k.value||i.value===null||k.value(i.value))&&(!C.value||v.value===null||C.value(v.value));if(l.allowedSeconds instanceof Array?N=ne=>l.allowedSeconds.includes(ne):N=l.allowedSeconds,!l.min&&!l.max)return oe?N:()=>!1;const[ae,fe,be]=l.min?l.min.split(":").map(Number):[0,0,0],[M,y,O]=l.max?l.max.split(":").map(Number):[23,59,59],R=ae*3600+fe*60+Number(be||0),ye=M*3600+y*60+Number(O||0);return ne=>{const Ie=3600*i.value+60*v.value+ne;return Ie>=R&&Ie<=ye&&oe&&(!N||N(ne))}}),q=F(()=>l.format==="ampm");Me(()=>l.period,N=>I(N)),Me(()=>l.modelValue,N=>ge(N)),Oe(()=>{ge(l.modelValue)});function B(){return i.value!=null&&v.value!=null&&(!l.useSeconds||n.value!=null)?`${Be(i.value)}:${Be(v.value)}`+(l.useSeconds?`:${Be(n.value)}`:""):null}function x(){const N=B();N!==null&&o("update:modelValue",N)}function w(N){return N?(N-1)%12+1:12}function ee(N,K){return N%12+(K==="pm"?12:0)}function ge(N){if(N==null||N==="")i.value=null,v.value=null,n.value=null;else if(N instanceof Date)i.value=N.getHours(),v.value=N.getMinutes(),n.value=N.getSeconds();else{const[K,,oe,,ae,fe]=N.trim().toLowerCase().match(/^(\d+):(\d+)(:(\d+))?([ap]m)?$/)||new Array(6);i.value=fe?ee(parseInt(K,10),fe):parseInt(K,10),v.value=parseInt(oe,10),n.value=parseInt(ae||0,10)}m.value=i.value==null||i.value<12?"am":"pm"}function G(N,K){const oe=k.value;if(!oe)return K;const ae=q.value?K<12?yl:Dn:wn;return((ae.find(be=>oe((be+K)%ae.length+ae[0]))||0)+K)%ae.length+ae[0]}function I(N){if(m.value=N,i.value!=null){const K=i.value+(m.value==="am"?-12:12);i.value=G("hour",K)}return o("update:period",N),x(),!0}function te(N){p.value==="hour"?i.value=q.value?ee(N,m.value):N:p.value==="minute"?v.value=N:n.value=N}function Q(N){switch(p.value||"hour"){case"hour":o("update:hour",N);break;case"minute":o("update:minute",N);break;case"second":o("update:second",N);break}const K=i.value!==null&&v.value!==null&&(l.useSeconds?n.value!==null:!0);p.value==="hour"?p.value="minute":l.useSeconds&&p.value==="minute"&&(p.value="second"),!(i.value===d.value&&v.value===u.value&&(!l.useSeconds||n.value===r.value)||B()===null)&&(d.value=i.value,u.value=v.value,l.useSeconds&&(r.value=n.value),K&&x())}Le(()=>{const N=mt.filterProps(l),K=Jt.filterProps(l),oe=Wt.filterProps(je(l,["format","modelValue","min","max"]));return e(mt,ue(N,{color:void 0,class:["v-time-picker",l.class],style:l.style}),{title:()=>c.title?.()??T("div",{class:"v-time-picker__title"},[a(l.title)]),header:()=>e(Jt,ue(K,{ampm:q.value,hour:i.value,minute:v.value,period:m.value,second:n.value,viewMode:p.value,"onUpdate:period":ae=>I(ae),"onUpdate:viewMode":ae=>p.value=ae,ref:V}),null),default:()=>e(Wt,ue(oe,{allowedValues:p.value==="hour"?k.value:p.value==="minute"?C.value:A.value,double:p.value==="hour"&&!q.value,format:p.value==="hour"?q.value?w:ae=>ae:ae=>Be(ae,2),max:p.value==="hour"?q.value&&m.value==="am"?11:23:59,min:p.value==="hour"&&q.value&&m.value==="pm"?12:0,size:20,step:p.value==="hour"?1:5,modelValue:p.value==="hour"?i.value:p.value==="minute"?v.value:n.value,onChange:Q,onInput:te,ref:_}),null),actions:c.actions})})}}),An=X({__name:"TimeField",props:De({hideDetails:{type:Boolean},readonly:{type:Boolean}},{modelValue:{required:!0},modelModifiers:{}}),emits:["update:modelValue"],setup(l){const s=l,o=xe(l,"modelValue"),c=F(()=>new Date(o.value).toLocaleTimeString(void 0,{hour:"numeric",minute:"numeric"}));function a(n){const[d,u]=n.split(":"),r=new Date(o.value);r.setHours(Number(d),Number(u)),o.value=r.toISOString()}function i(n){const d=new Date(n),u=new Date(o.value);d.setHours(u.getHours(),u.getMinutes(),u.getSeconds()),o.value=d.toISOString()}const v=S(!1);return(n,d)=>{const u=pl;return b(),D(h,{"no-gutters":""},{default:t(()=>[e(g,null,{default:t(()=>[e(u,{class:"mr-2",label:"Date","model-value":U(tl)(new Date(o.value)),"onUpdate:modelValue":i,"hide-details":s.hideDetails,readonly:s.readonly},null,8,["model-value","hide-details","readonly"])]),_:1}),e(g,{cols:"auto"},{default:t(()=>[...d[1]||(d[1]=[T("div",{class:"ma-2"},null,-1)])]),_:1}),e(g,null,{default:t(()=>[e(Se,{"close-on-content-click":!1,modelValue:v.value,"onUpdate:modelValue":d[0]||(d[0]=r=>v.value=r)},{activator:t(({props:r})=>[e(pe,ue({class:"center-text"},r,{variant:"outlined",density:"compact","hide-details":s.hideDetails,label:"Moment","model-value":c.value}),null,16,["hide-details","model-value"])]),default:t(()=>[e(In,{"model-value":new Date(o.value),"onUpdate:modelValue":a,format:"24hr"},null,8,["model-value"])]),_:1},8,["modelValue"])]),_:1})]),_:1})}}}),Mn=Pt(An,[["__scopeId","data-v-32955f86"]]),$n=X({__name:"ModePaiementField",props:De({hideDetails:{type:Boolean},readonly:{type:Boolean},rules:{}},{modelValue:{required:!0},modelModifiers:{}}),emits:["update:modelValue"],setup(l){const s=l,o=xe(l,"modelValue"),c=lt(la);return(a,i)=>(b(),D(Te,{label:"Mode de paiement",variant:"outlined",density:"compact",items:U(c),readonly:s.readonly,"hide-details":s.hideDetails,modelValue:o.value,"onUpdate:modelValue":i[0]||(i[0]=v=>o.value=v),rules:s.rules},null,8,["items","readonly","hide-details","modelValue","rules"]))}}),Un=X({__name:"PaiementEditCard",props:{paiement:{}},emits:["update","delete"],setup(l,{emit:s}){const o=l,c=s,a=S(we(o.paiement)),i=F(()=>!0),v=S(!1);return(n,d)=>{const u=$n,r=Je,m=Mn;return b(),D(j,{title:"Modifier le paiement"},{default:t(()=>[e(Z,{modelValue:v.value,"onUpdate:modelValue":d[1]||(d[1]=p=>v.value=p),"max-width":"400px"},{default:t(()=>[e(j,{title:"Confirmation"},{default:t(()=>[e(Y,null,{default:t(()=>[...d[11]||(d[11]=[f(" Confirmez-vous la suppression de ce paiement ? ",-1),T("br",null,null,-1),T("br",null,null,-1),f(" Attention, cette opération est irréversible. ",-1)])]),_:1}),e(se,null,{default:t(()=>[e(ie),e(L,{color:"red",onClick:d[0]||(d[0]=p=>{v.value=!1,c("delete")})},{default:t(()=>[...d[12]||(d[12]=[f("Supprimer",-1)])]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"]),e(Y,null,{default:t(()=>[e(h,null,{default:t(()=>[e(g,null,{default:t(()=>[e(pe,{density:"compact",variant:"outlined","hide-details":"",label:"Payé par",modelValue:a.value.Payeur,"onUpdate:modelValue":d[2]||(d[2]=p=>a.value.Payeur=p)},null,8,["modelValue"])]),_:1}),e(g,null,{default:t(()=>[e(pe,{density:"compact",variant:"outlined","hide-details":"",label:"Description (optionelle)",modelValue:a.value.Label,"onUpdate:modelValue":d[3]||(d[3]=p=>a.value.Label=p)},null,8,["modelValue"])]),_:1})]),_:1}),e(h,null,{default:t(()=>[e(g,null,{default:t(()=>[e(u,{modelValue:a.value.Mode,"onUpdate:modelValue":d[4]||(d[4]=p=>a.value.Mode=p),"hide-details":""},null,8,["modelValue"])]),_:1}),e(g,null,{default:t(()=>[e(r,{label:"Montant",modelValue:a.value.Montant,"onUpdate:modelValue":d[5]||(d[5]=p=>a.value.Montant=p),"hide-details":""},null,8,["modelValue"])]),_:1})]),_:1}),e(h,null,{default:t(()=>[e(g,null,{default:t(()=>[e(qe,{"hide-details":"",density:"compact",label:"Remboursement ?",modelValue:a.value.IsRemboursement,"onUpdate:modelValue":d[6]||(d[6]=p=>a.value.IsRemboursement=p)},null,8,["modelValue"])]),_:1})]),_:1}),e(h,null,{default:t(()=>[e(g,null,{default:t(()=>[e(m,{modelValue:a.value.Time,"onUpdate:modelValue":d[7]||(d[7]=p=>a.value.Time=p),"hide-details":""},null,8,["modelValue"])]),_:1})]),_:1}),e(h,null,{default:t(()=>[e(g,null,{default:t(()=>[e(pe,{density:"compact",variant:"outlined",label:"Détails (optionnel)",modelValue:a.value.Details,"onUpdate:modelValue":d[8]||(d[8]=p=>a.value.Details=p)},null,8,["modelValue"])]),_:1})]),_:1})]),_:1}),e(se,null,{default:t(()=>[e(L,{color:"red",onClick:d[9]||(d[9]=p=>v.value=!0)},{default:t(()=>[...d[13]||(d[13]=[f("Supprimer le paiement",-1)])]),_:1}),e(ie),e(L,{onClick:d[10]||(d[10]=p=>c("update",a.value)),disabled:!i.value},{default:t(()=>[...d[14]||(d[14]=[f("Enregistrer",-1)])]),_:1},8,["disabled"])]),_:1})]),_:1})}}}),Fn=X({__name:"DossierEditCard",props:{responsable:{},dossier:{}},emits:["save"],setup(l,{emit:s}){const o=l,c=s,a=S(we(o.dossier));return(i,v)=>{const n=ut,d=La,u=xt;return b(),D(j,null,{default:t(()=>[e(Y,null,{default:t(()=>[e(h,null,{default:t(()=>[e(g,null,{default:t(()=>[e(n,{label:"Responsable","initial-personne":o.responsable,"model-value":a.value.IdResponsable,"onUpdate:modelValue":v[0]||(v[0]=r=>r?a.value.IdResponsable=r:void 0),api:{SelectPersonne:U(P).SelectPersonne.bind(U(P))}},null,8,["initial-personne","model-value","api"])]),_:1})]),_:1}),e(h,null,{default:t(()=>[e(g,null,{default:t(()=>[e(d,{label:"Adresses mail en copie",modelValue:a.value.CopiesMails,"onUpdate:modelValue":v[1]||(v[1]=r=>a.value.CopiesMails=r),rule:U(aa).validMails()},null,8,["modelValue","rule"])]),_:1})]),_:1}),e(h,null,{default:t(()=>[e(g,null,{default:t(()=>[e(u,{"hide-details":"",modelValue:a.value.PartageAdressesOK,"onUpdate:modelValue":v[2]||(v[2]=r=>a.value.PartageAdressesOK=r),label:"Partage des coordonnées"},null,8,["modelValue"])]),_:1})]),_:1}),e(h,null,{default:t(()=>[e(g,null,{default:t(()=>[e(u,{"hide-details":"",modelValue:a.value.DemandeFondSoutien,"onUpdate:modelValue":v[3]||(v[3]=r=>a.value.DemandeFondSoutien=r),label:"Demande le fonds de soutien"},null,8,["modelValue"])]),_:1})]),_:1})]),_:1}),e(se,null,{default:t(()=>[e(ie),e(L,{onClick:v[4]||(v[4]=r=>c("save",a.value))},{default:t(()=>[...v[5]||(v[5]=[f("Enregistrer",-1)])]),_:1})]),_:1})]),_:1})}}}),Rn=X({__name:"OptionJournee",props:De({camp:{}},{modelValue:{required:!0},modelModifiers:{}}),emits:["update:modelValue"],setup(l){const s=l,o=xe(l,"modelValue"),c=F(()=>(s.camp.OptionPrix.Jours||[]).map((a,i)=>i));return(a,i)=>(b(),D(j,null,{default:t(()=>[e(Y,null,{default:t(()=>[i[1]||(i[1]=T("div",{class:"text-grey mb-2"}," Le prix est variable en fonction des jours de participation au camp. ",-1)),e(na,{class:"overflow-x-auto",color:"secondary",multiple:"","model-value":o.value?.length?o.value:c.value,"onUpdate:modelValue":i[0]||(i[0]=v=>o.value=v.length==c.value.length?[]:v)},{default:t(()=>[(b(!0),W(le,null,ce(s.camp.OptionPrix.Jours,(v,n)=>(b(),D(L,null,{default:t(()=>[f("J "+$(n+1),1)]),_:2},1024))),256))]),_:1},8,["model-value"])]),_:1})]),_:1}))}}),Ln=X({__name:"OptionStatut",props:De({camp:{}},{modelValue:{required:!0},modelModifiers:{}}),emits:["update:modelValue"],setup(l){const s=l,o=xe(l,"modelValue"),c=F(()=>(s.camp.OptionPrix.Statuts||[]).map(i=>({value:i.Id,title:i.Label,subtitle:i.Description}))),a=F(()=>c.value.map(i=>i.value).includes(o.value));return(i,v)=>(b(),D(j,null,{default:t(()=>[e(Y,null,{default:t(()=>[v[1]||(v[1]=T("div",{class:"text-grey mb-4"},"Le prix dépend du statut du participant.",-1)),e(Te,{clearable:"",items:c.value,label:"Statut","model-value":a.value?o.value:null,"onUpdate:modelValue":v[0]||(v[0]=n=>o.value=n??0),variant:"outlined",density:"comfortable","hide-details":""},{item:t(({item:n,props:d})=>[e(z,ue(d,{title:n.title,subtitle:n.raw.subtitle}),null,16,["title","subtitle"])]),_:1},8,["items","model-value"])]),_:1})]),_:1}))}}),hn={key:2},En=X({__name:"ParticipantOptionPrix",props:{camp:{},optionAndQf:{}},emits:["update"],setup(l,{emit:s}){const o=l,c=s,a=S(we(o.optionAndQf));return Me(()=>o.optionAndQf,()=>a.value=we(o.optionAndQf)),(i,v)=>{const n=We;return b(),D(j,{title:"Prix variable",width:"800px"},{default:t(()=>[e(Y,null,{default:t(()=>[e(h,{justify:"space-evenly"},{default:t(()=>[e(g,{"align-self":"center",cols:"3"},{default:t(()=>[e(n,{modelValue:a.value.quotientFamilial,"onUpdate:modelValue":v[0]||(v[0]=d=>a.value.quotientFamilial=d),label:"Quotient familial","hide-details":""},null,8,["modelValue"])]),_:1}),e(re,{thickness:"2",vertical:""}),e(g,{"align-self":"center",cols:"8"},{default:t(()=>[o.camp.OptionPrix.Active==U(Ae).PrixJour?(b(),D(Rn,{key:0,camp:o.camp,modelValue:a.value.options.Jour,"onUpdate:modelValue":v[1]||(v[1]=d=>a.value.options.Jour=d)},null,8,["camp","modelValue"])):o.camp.OptionPrix.Active==U(Ae).PrixStatut?(b(),D(Ln,{key:1,camp:o.camp,modelValue:a.value.options.IdStatut,"onUpdate:modelValue":v[2]||(v[2]=d=>a.value.options.IdStatut=d)},null,8,["camp","modelValue"])):(b(),W("div",hn,"Le camp ne propose pas d'option sur le prix."))]),_:1})]),_:1})]),_:1}),e(se,null,{default:t(()=>[e(ie),e(L,{onClick:v[3]||(v[3]=d=>c("update",a.value))},{default:t(()=>[...v[4]||(v[4]=[f("Enregistrer",-1)])]),_:1})]),_:1})]),_:1})}}}),Tn={key:1,class:"mx-1"},On={key:2,class:"mx-1"},Nn={key:3},Bn={key:4,class:"mx-1"},jn=X({__name:"RemisesChip",props:{remises:{}},emits:["update"],setup(l,{emit:s}){const o=l,c=s,a=F(()=>i.value.ReducEnfants!=0||i.value.ReducEquipiers!=0||i.value.ReducSpeciale.Cent!=0),i=S(we(o.remises));Me(()=>o.remises,()=>i.value=we(o.remises));const v=S(!1);return(n,d)=>{const u=We,r=Je;return b(),D(Se,{"close-on-content-click":!1,location:"bottom",modelValue:v.value,"onUpdate:modelValue":d[4]||(d[4]=m=>v.value=m)},{activator:t(({props:m})=>[e(j,ue(m,{elevation:"1",color:"grey-lighten-2"}),{default:t(()=>[e(Y,{class:"py-1 px-1"},{default:t(()=>[a.value?J("",!0):(b(),W(le,{key:0},[f(" Pas de remises ")],64)),i.value.ReducEnfants?(b(),W("span",Tn," Enfants : "+$(i.value.ReducEnfants)+"% ",1)):J("",!0),i.value.ReducEquipiers?(b(),W("span",On," Equipiers : "+$(i.value.ReducEquipiers)+"% ",1)):J("",!0),(i.value.ReducEnfants||i.value.ReducEquipiers)&&i.value.ReducSpeciale.Cent?(b(),W("br",Nn)):J("",!0),i.value.ReducSpeciale.Cent?(b(),W("span",Bn," Remise : "+$(U(ke).montant(i.value.ReducSpeciale)),1)):J("",!0)]),_:1})]),_:1},16)]),default:t(()=>[e(j,{title:"Modifier les remises",width:"400px"},{default:t(()=>[e(Y,null,{default:t(()=>[e(h,null,{default:t(()=>[e(g,null,{default:t(()=>[e(u,{modelValue:i.value.ReducEnfants,"onUpdate:modelValue":d[0]||(d[0]=m=>i.value.ReducEnfants=m),label:"Remise enfants","hide-details":"",suffix:"%"},null,8,["modelValue"])]),_:1}),e(g,null,{default:t(()=>[e(u,{modelValue:i.value.ReducEquipiers,"onUpdate:modelValue":d[1]||(d[1]=m=>i.value.ReducEquipiers=m),label:"Remise équipiers","hide-details":"",suffix:"%"},null,8,["modelValue"])]),_:1})]),_:1}),e(h,null,{default:t(()=>[e(g,null,{default:t(()=>[e(r,{class:"mt-2",modelValue:i.value.ReducSpeciale,"onUpdate:modelValue":d[2]||(d[2]=m=>i.value.ReducSpeciale=m),label:"Remise spéciale","hide-details":""},null,8,["modelValue"])]),_:1})]),_:1})]),_:1}),e(se,null,{default:t(()=>[e(ie),e(L,{onClick:d[3]||(d[3]=m=>{c("update",i.value),v.value=!1})},{default:t(()=>[...d[5]||(d[5]=[f("Enregistrer",-1)])]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"])}}}),qn=Pt(jn,[["__scopeId","data-v-01096379"]]),Yn=X({__name:"AideEditCard",props:{aide:{},file:{},structures:{},participant:{}},emits:["save","deleteFile","uploadFile","showStructureaides"],setup(l,{emit:s}){const o=l,c=s,a=S(we(o.aide)),i=F(()=>Object.values(o.structures).map(v=>({value:v.Id,title:v.Nom})));return(v,n)=>{const d=xt,u=Je,r=We,m=Ta;return b(),D(j,{title:"Modifier l'aide extérieure",subtitle:`pour ${U(Ee).label(o.participant.Personne)} - ${U(_e).label(o.participant.Camp)}`},{append:t(()=>[e(L,{onClick:n[0]||(n[0]=p=>c("showStructureaides"))},{default:t(()=>[e(ve,null,{default:t(()=>[...n[9]||(n[9]=[f("mdi-view-list",-1)])]),_:1}),n[10]||(n[10]=f(" Structures",-1))]),_:1})]),default:t(()=>[e(Y,null,{default:t(()=>[e(h,null,{default:t(()=>[e(g,null,{default:t(()=>[e(Te,{variant:"outlined",density:"comfortable",label:"Structure",items:i.value,modelValue:a.value.IdStructureaide,"onUpdate:modelValue":n[1]||(n[1]=p=>a.value.IdStructureaide=p)},null,8,["items","modelValue"])]),_:1}),e(g,null,{default:t(()=>[e(d,{modelValue:a.value.Valide,"onUpdate:modelValue":n[2]||(n[2]=p=>a.value.Valide=p),label:"Aide validée","hide-details":""},null,8,["modelValue"])]),_:1})]),_:1}),e(h,null,{default:t(()=>[e(g,{"align-self":"center"},{default:t(()=>[e(u,{modelValue:a.value.Valeur,"onUpdate:modelValue":n[3]||(n[3]=p=>a.value.Valeur=p),label:"Montant","hide-details":""},null,8,["modelValue"])]),_:1}),e(g,{"align-self":"center",cols:"auto"},{default:t(()=>[e(d,{"hide-details":"",label:"Par jour",modelValue:a.value.ParJour,"onUpdate:modelValue":n[4]||(n[4]=p=>a.value.ParJour=p)},null,8,["modelValue"])]),_:1}),e(g,{"align-self":"center"},{default:t(()=>[e(r,{label:"Limite",suffix:"jours",modelValue:a.value.NbJoursMax,"onUpdate:modelValue":n[5]||(n[5]=p=>a.value.NbJoursMax=p),disabled:!a.value.ParJour,hint:"0 pour ne pas limiter",min:0,"persistent-hint":""},null,8,["modelValue","disabled"])]),_:1})]),_:1}),e(m,{class:"mt-4",files:o.file?[o.file]:[],title:"Document justificatif","max-docs":1,"in-upload":!1,onDelete:n[6]||(n[6]=p=>c("deleteFile")),onUpload:n[7]||(n[7]=p=>c("uploadFile",p))},null,8,["files"])]),_:1}),e(se,null,{default:t(()=>[e(ie),e(L,{onClick:n[8]||(n[8]=p=>c("save",a.value))},{default:t(()=>[...n[11]||(n[11]=[f("Enregistrer",-1)])]),_:1})]),_:1})]),_:1},8,["subtitle"])}}}),Hn=X({__name:"StructuresPannel",props:{modelValue:{required:!0},modelModifiers:{}},emits:["update:modelValue"],setup(l){const s=xe(l,"modelValue"),o=F(()=>Object.values(s.value||{}).sort((d,u)=>d.Nom.localeCompare(u.Nom)));async function c(){const d=await P.StructureaideCreate();if(d===void 0)return;P.showMessage("Structure créée avec succès.");const u=s.value||{};u[d.Id]=d,s.value=u,a.value=d}const a=S(null);async function i(){const d=a.value;if(d==null||(a.value=null,await P.StructureaideUpdate(d)===void 0))return;P.showMessage("Structure modifiée avec succès.");const r=s.value||{};r[d.Id]=d,s.value=r}const v=S(null);async function n(){const d=v.value;if(d==null||(v.value=null,await P.StructureaideDelete({id:d.Id})===void 0))return;const r=s.value||{};delete r[d.Id],s.value=r,P.showMessage("Structure supprimée avec succès.")}return(d,u)=>(b(),D(j,{title:"Structures d'aide",subtitle:"Organismes pouvant distribuer une aide extérieure"},{append:t(()=>[e(L,{onClick:c},{prepend:t(()=>[e(ve,{color:"green"},{default:t(()=>[...u[5]||(u[5]=[f("mdi-plus",-1)])]),_:1})]),default:t(()=>[u[6]||(u[6]=f(" Ajouter une structure ",-1))]),_:1})]),default:t(()=>[e(Y,{class:"overflow-y-auto"},{default:t(()=>[(b(!0),W(le,null,ce(o.value,r=>(b(),D(h,null,{default:t(()=>[e(g,{"align-self":"center"},{default:t(()=>[e(sl,null,{default:t(()=>[f($(r.Nom),1)]),_:2},1024),e(ol,null,{default:t(()=>[f($(r.Immatriculation),1)]),_:2},1024)]),_:2},1024),e(g,{"align-self":"center",style:{"font-size":"smaller"}},{default:t(()=>[(b(!0),W(le,null,ce(r.Info.split(`
`),m=>(b(),W("div",null,$(m),1))),256))]),_:2},1024),e(g,{"align-self":"center",cols:"auto"},{default:t(()=>[e(Se,null,{activator:t(({props:m})=>[e(L,ue({icon:"mdi-dots-vertical"},{ref_for:!0},m,{size:"x-small"}),null,16)]),default:t(()=>[e(Pe,null,{default:t(()=>[e(z,{title:"Modifier","prepend-icon":"mdi-pencil",onClick:m=>a.value=U(we)(r)},null,8,["onClick"]),e(z,{title:"Supprimer","prepend-icon":"mdi-delete",onClick:m=>v.value=r},null,8,["onClick"])]),_:2},1024)]),_:2},1024)]),_:2},1024)]),_:2},1024))),256))]),_:1}),e(Z,{"model-value":a.value!=null,"onUpdate:modelValue":u[3]||(u[3]=r=>a.value=null),"max-width":"600px"},{default:t(()=>[a.value!=null?(b(),D(j,{key:0,title:"Modifier la structure"},{default:t(()=>[e(Y,null,{default:t(()=>[e(h,null,{default:t(()=>[e(g,null,{default:t(()=>[e(pe,{variant:"outlined",density:"compact",label:"Nom",modelValue:a.value.Nom,"onUpdate:modelValue":u[0]||(u[0]=r=>a.value.Nom=r),"hide-details":""},null,8,["modelValue"])]),_:1}),e(g,null,{default:t(()=>[e(pe,{variant:"outlined",density:"compact",label:"Immatriculation",modelValue:a.value.Immatriculation,"onUpdate:modelValue":u[1]||(u[1]=r=>a.value.Immatriculation=r),"hide-details":""},null,8,["modelValue"])]),_:1})]),_:1}),e(h,null,{default:t(()=>[e(g,null,{default:t(()=>[e(ct,{variant:"outlined",density:"compact",label:"Informations",modelValue:a.value.Info,"onUpdate:modelValue":u[2]||(u[2]=r=>a.value.Info=r),"hide-details":""},null,8,["modelValue"])]),_:1})]),_:1})]),_:1}),e(se,null,{default:t(()=>[e(ie),e(L,{onClick:i},{default:t(()=>[...u[7]||(u[7]=[f("Enregistrer",-1)])]),_:1})]),_:1})]),_:1})):J("",!0)]),_:1},8,["model-value"]),e(Z,{"model-value":v.value!=null,"onUpdate:modelValue":u[4]||(u[4]=r=>v.value=null),"max-width":"450px"},{default:t(()=>[v.value!=null?(b(),D(j,{key:0,title:"Confirmation"},{default:t(()=>[e(Y,null,{default:t(()=>[f(" Confirmez-vous la suppression de la structure "+$(v.value.Nom)+" ? ",1),u[8]||(u[8]=T("br",null,null,-1)),u[9]||(u[9]=T("br",null,null,-1)),u[10]||(u[10]=f(" Attention, cette opération est irréversible. ",-1))]),_:1}),e(se,null,{default:t(()=>[e(ie),e(L,{color:"red",onClick:n},{default:t(()=>[...u[11]||(u[11]=[f("Supprimer",-1)])]),_:1})]),_:1})]),_:1})):J("",!0)]),_:1},8,["model-value"])]),_:1}))}}),zn={key:0},Qn={key:1},Wn=X({__name:"DossierParticipantRow",props:De({participant:{},aides:{},aidesFiles:{},hasManyParticipants:{type:Boolean}},{structures:{required:!0},structuresModifiers:{}}),emits:De(["update","delete","createAide","updateAide","deleteAide","deleteFileAide","uploadFileAide","expand"],["update:structures"]),setup(l,{emit:s}){const o=l,c=xe(l,"structures"),a=s,i=F(()=>{const k=Object.values(o.aides||{});return k.sort((C,A)=>C.Id-A.Id),k}),v=F(()=>o.participant.Camp.OptionPrix.Active==Ae.NoOption&&!_e.isQuotientFamilialActive(o.participant.Camp.OptionQuotientFamilial));function n(k){switch(o.participant.Camp.OptionPrix.Active){case Ae.NoOption:return"Séjour sans option";case Ae.PrixJour:const C=k.Jour?.length||0;return C==0?"Présent tous les jours":`Présent ${C} jour${C>1?"s":""}`;case Ae.PrixStatut:const A=o.participant.Camp.OptionPrix.Statuts?.find(q=>q.Id==k.IdStatut);return A?`Statut ${A.Label}`:"Pas d'option."}}const d=S(!1),u=S(!1),r=F(()=>Object.values(c.value).map(k=>({value:k.Id,title:k.Nom})).sort((k,C)=>k.title.localeCompare(C.title))),m=S(null),p=S(null),V=S(null),_=S(!1);return(k,C)=>(b(),D(h,null,{default:t(()=>[e(g,{"align-self":"center",cols:"3"},{default:t(()=>[e(sl,null,{default:t(()=>[T("a",{href:"/camps",onClick:C[0]||(C[0]=et(A=>U(wt)(o.participant.Participant),["prevent"]))},$(U(Ee).label(o.participant.Personne)),1)]),_:1}),e(ol,null,{default:t(()=>[f($(U(_e).label(o.participant.Camp)),1)]),_:1})]),_:1}),e(g,{"align-self":"center",cols:"2",class:"text-center"},{default:t(()=>[e(Se,{disabled:v.value,"close-on-content-click":!1,modelValue:d.value,"onUpdate:modelValue":C[2]||(C[2]=A=>d.value=A)},{activator:t(({props:A})=>[e(j,ue(A,{elevation:v.value?0:1,color:"grey-lighten-2"}),{default:t(()=>[e(Y,{class:"py-1 px-1"},{default:t(()=>[v.value?(b(),W("div",zn,"Camp sans option")):(b(),W("div",Qn,[f($(o.participant.Participant.QuotientFamilial?`QF ${o.participant.Participant.QuotientFamilial}.`:"Pas de QF.")+" ",1),C[22]||(C[22]=T("br",null,null,-1)),f(" "+$(n(o.participant.Participant.OptionPrix)),1)]))]),_:1})]),_:1},16,["elevation"])]),default:t(()=>[e(En,{camp:o.participant.Camp,"option-and-qf":{options:o.participant.Participant.OptionPrix,quotientFamilial:o.participant.Participant.QuotientFamilial},onUpdate:C[1]||(C[1]=A=>{o.participant.Participant.OptionPrix=A.options,o.participant.Participant.QuotientFamilial=A.quotientFamilial,d.value=!1,a("update",o.participant.Participant)})},null,8,["camp","option-and-qf"])]),_:1},8,["disabled","modelValue"])]),_:1}),e(g,{"align-self":"center",class:"text-center"},{default:t(()=>[i.value.length?J("",!0):(b(),D(Ce,{key:0,label:""},{default:t(()=>[...C[23]||(C[23]=[f("Aucune aide",-1)])]),_:1})),(b(!0),W(le,null,ce(i.value,A=>(b(),D(Ce,{class:"my-1","prepend-icon":"mdi-cash-plus",color:A.Valide?"green":"orange",onClick:q=>p.value=A},{close:t(()=>[e(ve,{icon:"mdi-close-circle",onClick:et(q=>V.value=A,["stop"])},null,8,["onClick"])]),default:t(()=>[f(" "+$(c.value[A.IdStructureaide].Nom)+" : "+$(U(ke).montant(A.Valeur)),1)]),_:2},1032,["color","onClick"]))),256))]),_:1}),e(g,{"align-self":"center",class:"text-center",cols:"3"},{default:t(()=>[e(qn,{remises:o.participant.Participant.Remises,onUpdate:C[3]||(C[3]=A=>{o.participant.Participant.Remises=A,a("update",o.participant.Participant)})},null,8,["remises"])]),_:1}),e(g,{"align-self":"center",cols:"auto"},{default:t(()=>[e(Se,{location:"left"},{activator:t(({props:A})=>[e(L,ue(A,{icon:"mdi-dots-vertical",size:"small"}),null,16)]),default:t(()=>[e(Pe,{density:"comfortable"},{default:t(()=>[e(z,{title:"Ajouter une aide","prepend-icon":"mdi-cash-plus",onClick:C[4]||(C[4]=A=>m.value={IdParticipant:o.participant.Participant.Id,IdStructure:0})}),e(re),o.hasManyParticipants?(b(),D(z,{key:0,"prepend-icon":"mdi-arrow-expand",title:"Étendre les options et remises",subtitle:"... au reste du dossier",onClick:C[5]||(C[5]=A=>a("expand"))})):J("",!0),e(re),e(z,{title:"Supprimer","prepend-icon":"mdi-delete",onClick:C[6]||(C[6]=A=>u.value=!0)})]),_:1})]),_:1})]),_:1}),e(Z,{modelValue:u.value,"onUpdate:modelValue":C[8]||(C[8]=A=>u.value=A),"max-width":"600px"},{default:t(()=>[e(j,{title:"Supprimer le participant"},{default:t(()=>[e(Y,null,{default:t(()=>[...C[24]||(C[24]=[f(" Confirmez-vous la suppression de ce participant ? ",-1),T("br",null,null,-1),f(" Attention, cette opération est irréversible. ",-1)])]),_:1}),e(se,null,{default:t(()=>[e(ie),e(L,{color:"red",onClick:C[7]||(C[7]=A=>{a("delete"),u.value=!1})},{default:t(()=>[...C[25]||(C[25]=[f("Supprimer",-1)])]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"]),e(Z,{modelValue:_.value,"onUpdate:modelValue":C[10]||(C[10]=A=>_.value=A),"max-width":"650px"},{default:t(()=>[e(Hn,{modelValue:c.value,"onUpdate:modelValue":C[9]||(C[9]=A=>c.value=A)},null,8,["modelValue"])]),_:1},8,["modelValue"]),m.value!=null?(b(),D(Z,{key:0,"model-value":m.value!=null,"onUpdate:modelValue":C[14]||(C[14]=A=>m.value=null),width:"600px"},{default:t(()=>[e(j,{title:"Ajouter une aide extérieure"},{append:t(()=>[e(L,{onClick:C[11]||(C[11]=A=>_.value=!0)},{default:t(()=>[e(ve,null,{default:t(()=>[...C[26]||(C[26]=[f("mdi-view-list",-1)])]),_:1}),C[27]||(C[27]=f(" Structures",-1))]),_:1})]),default:t(()=>[e(Y,null,{default:t(()=>[e(Te,{variant:"outlined",density:"comfortable",label:"Structure",items:r.value,"model-value":m.value.IdStructure==0?null:m.value.IdStructure,"onUpdate:modelValue":C[12]||(C[12]=A=>m.value.IdStructure=A)},null,8,["items","model-value"])]),_:1}),e(se,null,{default:t(()=>[e(ie),e(L,{color:"green",onClick:C[13]||(C[13]=A=>{a("createAide",m.value),m.value=null}),disabled:m.value.IdStructure==0},{default:t(()=>[...C[28]||(C[28]=[f("Créer",-1)])]),_:1},8,["disabled"])]),_:1})]),_:1})]),_:1},8,["model-value"])):J("",!0),p.value!=null?(b(),D(Z,{key:1,"model-value":p.value!=null,"onUpdate:modelValue":C[19]||(C[19]=A=>p.value=null),"max-width":"800px"},{default:t(()=>[e(Yn,{aide:p.value,file:l.aidesFiles[p.value.Id],structures:c.value,participant:o.participant,onShowStructureaides:C[15]||(C[15]=A=>_.value=!0),onSave:C[16]||(C[16]=A=>{a("updateAide",A),p.value=null}),onDeleteFile:C[17]||(C[17]=A=>a("deleteFileAide",p.value.Id)),onUploadFile:C[18]||(C[18]=A=>a("uploadFileAide",A,p.value.Id))},null,8,["aide","file","structures","participant"])]),_:1},8,["model-value"])):J("",!0),V.value!=null?(b(),D(Z,{key:2,"model-value":V.value!=null,"onUpdate:modelValue":C[21]||(C[21]=A=>V.value=null),"max-width":"600px"},{default:t(()=>[e(j,{title:"Supprimer l'aide"},{default:t(()=>[e(Y,null,{default:t(()=>[...C[29]||(C[29]=[f(" Confirmez-vous la suppression de l'aide extérieure ? ",-1),T("br",null,null,-1),f(" Attention, cette opération est irréversible. ",-1)])]),_:1}),e(se,null,{default:t(()=>[e(ie),e(L,{color:"red",onClick:C[20]||(C[20]=A=>{a("deleteAide",V.value.Id),V.value=null})},{default:t(()=>[...C[30]||(C[30]=[f("Supprimer",-1)])]),_:1})]),_:1})]),_:1})]),_:1},8,["model-value"])):J("",!0)]),_:1}))}}),Jn=X({__name:"DossierEditor",props:{dossier:{},camps:{}},emits:["updateDossier","createParticipant","updateParticipant","deleteParticipant","expandParticipant","createAide","updateAide","deleteAide","deleteFileAide","uploadFileAide"],setup(l,{emit:s}){const o=l,c=s,a=S(null);Oe(n);const i=S(!0),v=S({});async function n(){const d=await P.StructureaidesGet();d!==void 0&&(i.value=!1,v.value=d||{})}return(d,u)=>(b(),D(j,{title:"Modifier le dossier"},{append:t(()=>[e(L,{onClick:u[0]||(u[0]=r=>a.value={IdCamp:0,IdPersonne:0,IdDossier:o.dossier.Dossier.Dossier.Id})},{prepend:t(()=>[e(ve,{color:"green"},{default:t(()=>[...u[9]||(u[9]=[f("mdi-plus",-1)])]),_:1})]),default:t(()=>[u[10]||(u[10]=f(" Ajouter un participant",-1))]),_:1})]),default:t(()=>[e(Y,null,{default:t(()=>[e(h,null,{default:t(()=>[e(g,{cols:"3"},{default:t(()=>[e(Fn,{responsable:o.dossier.Dossier.Responsable,dossier:o.dossier.Dossier.Dossier,onSave:u[1]||(u[1]=r=>c("updateDossier",r))},null,8,["responsable","dossier"])]),_:1}),e(re,{thickness:"4",vertical:""}),i.value?J("",!0):(b(),D(g,{key:0},{default:t(()=>[u[11]||(u[11]=T("div",{class:"my-1"},null,-1)),(b(!0),W(le,null,ce(o.dossier.Dossier.Participants,r=>(b(),D(Wn,{participant:r,aides:(o.dossier.Dossier.Aides||{})[r.Participant.Id],"aides-files":o.dossier.Dossier.AidesFiles||{},"has-many-participants":(o.dossier.Dossier.Participants?.length||0)>1,structures:v.value,"onUpdate:structures":u[2]||(u[2]=m=>v.value=m),onCreateAide:u[3]||(u[3]=m=>c("createAide",m)),onDeleteAide:u[4]||(u[4]=m=>c("deleteAide",m)),onUpdateAide:u[5]||(u[5]=m=>c("updateAide",m)),onDeleteFileAide:u[6]||(u[6]=m=>c("deleteFileAide",m)),onUploadFileAide:u[7]||(u[7]=(m,p)=>c("uploadFileAide",m,p)),onUpdate:u[8]||(u[8]=m=>c("updateParticipant",m)),onDelete:m=>c("deleteParticipant",r.Participant.Id),onExpand:m=>c("expandParticipant",r.Participant)},null,8,["participant","aides","aides-files","has-many-participants","structures","onDelete","onExpand"]))),256))]),_:1}))]),_:1})]),_:1})]),_:1}))}}),Gn={class:"mr-1"},Kn=["onClick"],Xn={class:"overflow-y-auto",style:{"max-height":"65vh"}},Zn=["href"],eu=X({__name:"DossierDetailsPannel",props:{dossier:{},camps:{}},emits:["updateDossier","deleteDossier","mergeDossier","createParticipant","updateParticipant","deleteParticipant","expandParticipant","createAide","updateAide","deleteAide","deleteFileAide","uploadFileAide","createPaiement","updatePaiement","deletePaiement","sendMessage","deleteMessage","sendFacture"],setup(l,{expose:s,emit:o}){const c=l,a=o;s({showEditPaiement:m,showEditDossier:d});const i=F(()=>ua(c.dossier.Dossier,P.isFondsSoutien?Ut.FondSoutien:Ut.Backoffice)),v=S(!1),n=S(!1);function d(){n.value=!0}const u=S(null),r=S(null);function m(x){r.value=x}const p="Repère",V=S(!1);async function _(){await rt(c.dossier.EspacepersoURL),P.showMessage("Lien vers l'espace personnel copié.")}async function k(){await rt(c.dossier.VirementCode),P.showMessage("Identifiant de virement copié.")}async function C(x){await rt(x),P.showMessage("IBAN copié.")}const A=S(!1),q=S(!1),B=S("");return(x,w)=>{const ee=Ra,ge=it,G=ut;return b(),D(j,{title:`Dossier de ${c.dossier.Dossier.Responsable}`,class:"ml-2"},{subtitle:t(()=>[(b(!0),W(le,null,ce(c.dossier.Dossier.Participants,I=>(b(),W("span",Gn,[T("a",{href:"/camps",onClick:et(te=>U(wt)(I.Participant),["prevent"])},$(U(Ee).label(I.Personne)),9,Kn)]))),256))]),append:t(()=>[e(L,{icon:"mdi-pencil",onClick:w[0]||(w[0]=I=>n.value=!0),class:"mx-1"}),e(Se,null,{activator:t(({props:I})=>[e(L,ue(I,{icon:"mdi-dots-vertical",size:"small",class:"mx-1"}),null,16)]),default:t(()=>[e(Pe,{density:"compact"},{default:t(()=>[e(z,{"prepend-icon":"mdi-email",onClick:w[1]||(w[1]=I=>q.value=!0),title:"Envoyer un message",subtitle:"Notification par email"}),e(z,{"prepend-icon":"mdi-invoice-send",onClick:w[2]||(w[2]=I=>a("sendFacture")),title:"Envoyer une demande de règlement",subtitle:"Notification par email"}),e(re),e(z,{"prepend-icon":"mdi-cash-plus",onClick:w[3]||(w[3]=I=>a("createPaiement")),title:"Ajouter un paiement"}),e(re),e(z,{"prepend-icon":"mdi-link",onClick:w[4]||(w[4]=I=>V.value=!0),title:"Afficher les identifiants"}),e(re),e(z,{"prepend-icon":"mdi-file-move",onClick:w[5]||(w[5]=I=>A.value=!0),title:"Fusionner vers ..."}),e(re),e(z,{onClick:w[6]||(w[6]=I=>v.value=!0),title:"Supprimer"},{prepend:t(()=>[e(ve,{color:"red"},{default:t(()=>[...w[35]||(w[35]=[f("mdi-delete",-1)])]),_:1})]),_:1})]),_:1})]),_:1})]),default:t(()=>[e(Y,null,{default:t(()=>[e(h,null,{default:t(()=>[e(g,{class:"ml-2 mb-1 text-center"},{default:t(()=>[e(Se,null,{activator:t(({props:I})=>[e(Ce,ue(I,{"prepend-icon":"mdi-currency-eur",color:U(ke).colorStatutPaiement(c.dossier.Dossier.Bilan.Statut)}),{default:t(()=>[f($(c.dossier.Dossier.Bilan.Recu)+" payé sur "+$(c.dossier.Dossier.Bilan.Demande),1)]),_:1},16,["color"])]),default:t(()=>[e(Cn,{dossier:c.dossier.Dossier},null,8,["dossier"])]),_:1})]),_:1})]),_:1}),T("div",Xn,[e(Fa,{side:"end",class:"mt-4",density:"compact"},{default:t(()=>[(b(!0),W(le,null,ce(i.value,(I,te)=>(b(),D(ee,{event:I,key:te,onEditPaiement:w[7]||(w[7]=Q=>r.value=Q),onDeleteMessage:w[8]||(w[8]=Q=>a("deleteMessage",Q))},null,8,["event"]))),128))]),_:1})])]),_:1}),e(Z,{modelValue:v.value,"onUpdate:modelValue":w[10]||(w[10]=I=>v.value=I),"max-width":"600px"},{default:t(()=>[e(j,{title:"Supprimer le dossier"},{default:t(()=>[e(Y,null,{default:t(()=>[...w[36]||(w[36]=[f(" Confirmez-vous la suppression du dossier et de ses participants ? ",-1),T("br",null,null,-1),T("br",null,null,-1),f(" Attention, cette opération est irréversible. ",-1)])]),_:1}),e(se,null,{default:t(()=>[e(ie),e(L,{color:"red",onClick:w[9]||(w[9]=I=>{a("deleteDossier"),v.value=!1})},{default:t(()=>[...w[37]||(w[37]=[f("Supprimer",-1)])]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"]),u.value!=null?(b(),D(Z,{key:0,"model-value":u.value!=null,"onUpdate:modelValue":w[14]||(w[14]=I=>u.value=null),"max-width":"600px"},{default:t(()=>[e(j,{title:"Ajouter un participant"},{default:t(()=>[e(Y,null,{default:t(()=>[e(h,null,{default:t(()=>[e(g,{cols:"12"},{default:t(()=>[e(ge,{label:"Camp",camps:c.camps,modelValue:u.value.IdCamp,"onUpdate:modelValue":w[11]||(w[11]=I=>u.value.IdCamp=I)},null,8,["camps","modelValue"])]),_:1}),e(g,{cols:"12"},{default:t(()=>[e(G,{label:"Personne","initial-personne":"",modelValue:u.value.IdPersonne,"onUpdate:modelValue":w[12]||(w[12]=I=>u.value.IdPersonne=I),api:{SelectPersonne:U(P).SelectPersonne.bind(U(P))}},null,8,["modelValue","api"])]),_:1})]),_:1})]),_:1}),e(se,null,{default:t(()=>[e(ie),e(L,{color:"green",disabled:u.value.IdPersonne==0||u.value.IdCamp==0,onClick:w[13]||(w[13]=I=>{a("createParticipant",u.value),u.value=null})},{default:t(()=>[...w[38]||(w[38]=[f("Ajouter",-1)])]),_:1},8,["disabled"])]),_:1})]),_:1})]),_:1},8,["model-value"])):J("",!0),e(Z,{modelValue:n.value,"onUpdate:modelValue":w[25]||(w[25]=I=>n.value=I)},{default:t(()=>[e(Jn,{dossier:c.dossier,camps:c.camps,onUpdateDossier:w[15]||(w[15]=I=>a("updateDossier",I)),onCreateParticipant:w[16]||(w[16]=I=>a("createParticipant",I)),onUpdateParticipant:w[17]||(w[17]=I=>a("updateParticipant",I)),onDeleteParticipant:w[18]||(w[18]=I=>a("deleteParticipant",I)),onExpandParticipant:w[19]||(w[19]=I=>a("expandParticipant",I)),onCreateAide:w[20]||(w[20]=I=>a("createAide",I)),onUpdateAide:w[21]||(w[21]=I=>a("updateAide",I)),onDeleteAide:w[22]||(w[22]=I=>a("deleteAide",I)),onDeleteFileAide:w[23]||(w[23]=I=>a("deleteFileAide",I)),onUploadFileAide:w[24]||(w[24]=(I,te)=>a("uploadFileAide",I,te))},null,8,["dossier","camps"])]),_:1},8,["modelValue"]),r.value!=null?(b(),D(Z,{key:1,"model-value":r.value!=null,"onUpdate:modelValue":w[28]||(w[28]=I=>r.value=null),"max-width":"600px"},{default:t(()=>[e(Un,{paiement:r.value,onUpdate:w[26]||(w[26]=I=>{a("updatePaiement",I),r.value=null}),onDelete:w[27]||(w[27]=I=>{a("deletePaiement",r.value),r.value=null})},null,8,["paiement"])]),_:1},8,["model-value"])):J("",!0),e(Z,{modelValue:V.value,"onUpdate:modelValue":w[29]||(w[29]=I=>V.value=I),"max-width":"800px"},{default:t(()=>[e(j,{title:"Liens et identifiants"},{default:t(()=>[e(Y,null,{default:t(()=>[e(h,null,{default:t(()=>[e(g,{cols:"3"},{default:t(()=>[...w[39]||(w[39]=[f("Espace personnel",-1)])]),_:1}),e(g,{class:"text-truncate"},{default:t(()=>[T("a",{href:c.dossier.EspacepersoURL,target:"_blank"},$(c.dossier.EspacepersoURL),9,Zn)]),_:1}),e(g,{"align-self":"center",cols:"auto"},{default:t(()=>[e(L,{size:"small",icon:"mdi-content-copy",onClick:_})]),_:1})]),_:1}),(b(!0),W(le,null,ce(c.dossier.BankAccounts,I=>(b(),D(h,null,{default:t(()=>[e(g,{cols:"3"},{default:t(()=>[f("RIB ("+$(U(p))+")",1)]),_:1}),e(g,{cols:"3"},{default:t(()=>[f($(I[0]),1)]),_:2},1024),e(g,null,{default:t(()=>[f($(I[1]),1)]),_:2},1024),e(g,{"align-self":"center",cols:"auto"},{default:t(()=>[e(L,{size:"small",icon:"mdi-content-copy",onClick:()=>C(I[1])},null,8,["onClick"])]),_:2},1024)]),_:2},1024))),256)),e(h,null,{default:t(()=>[e(g,{cols:"3"},{default:t(()=>[...w[40]||(w[40]=[f("Identification de virement",-1)])]),_:1}),e(g,null,{default:t(()=>[f($(c.dossier.VirementCode),1)]),_:1}),e(g,{"align-self":"center",cols:"auto"},{default:t(()=>[e(L,{size:"small",icon:"mdi-content-copy",onClick:k})]),_:1})]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"]),e(Z,{modelValue:A.value,"onUpdate:modelValue":w[31]||(w[31]=I=>A.value=I),"max-width":"600px"},{default:t(()=>[e(fl,{from:c.dossier.Dossier.Dossier.Id,onMerge:w[30]||(w[30]=I=>{a("mergeDossier",I),A.value=!1})},null,8,["from"])]),_:1},8,["modelValue"]),e(Z,{modelValue:q.value,"onUpdate:modelValue":w[34]||(w[34]=I=>q.value=I),"max-width":"600px"},{default:t(()=>[e(j,{title:"Nouveau message",subtitle:"Envoie un message sur le fil de suivi et une notification par mail."},{default:t(()=>[e(Y,null,{default:t(()=>[e(h,null,{default:t(()=>[e(g,null,{default:t(()=>[e(ct,{rows:"5",variant:"outlined",modelValue:B.value,"onUpdate:modelValue":w[32]||(w[32]=I=>B.value=I)},null,8,["modelValue"])]),_:1})]),_:1})]),_:1}),e(se,null,{default:t(()=>[e(ie),e(L,{disabled:!B.value.length,onClickOnce:w[33]||(w[33]=I=>{a("sendMessage",B.value),q.value=!1})},{default:t(()=>[...w[41]||(w[41]=[f("Envoyer",-1)])]),_:1},8,["disabled"])]),_:1})]),_:1})]),_:1},8,["modelValue"])]),_:1},8,["title"])}}}),tu=X({__name:"CreateDossierCard",emits:["create"],setup(l,{emit:s}){const o=s,c=S(0);return(a,i)=>{const v=ut;return b(),D(j,{title:"Créer un dossier"},{default:t(()=>[e(Y,null,{default:t(()=>[e(h,null,{default:t(()=>[e(g,null,{default:t(()=>[e(v,{label:"Responsable légal",modelValue:c.value,"onUpdate:modelValue":i[0]||(i[0]=n=>c.value=n),"initial-personne":"",api:{SelectPersonne:U(P).SelectPersonne.bind(U(P))}},null,8,["modelValue","api"])]),_:1})]),_:1})]),_:1}),e(se,null,{default:t(()=>[e(ie),e(L,{color:"green",disabled:c.value==0,onClick:i[1]||(i[1]=n=>o("create",c.value))},{default:t(()=>[...i[2]||(i[2]=[f("Créer",-1)])]),_:1},8,["disabled"])]),_:1})]),_:1})}}}),lu=X({__name:"DossierList",props:De({camps:{},allowFondsSoutien:{type:Boolean},selected:{}},{query:{required:!0},queryModifiers:{}}),emits:De(["click","update"],["update:query"]),setup(l,{expose:s,emit:o}){const c=l,a=o,i=xe(l,"query");s({searchDossiers:n}),Me(()=>i.value,n,{immediate:!0});const v=S(null);async function n(){const d=await P.DossiersSearch(i.value);d!==void 0&&(v.value=d,a("update",d))}return(d,u)=>{const r=it,m=il;return b(),W("div",null,[e(h,null,{default:t(()=>[e(g,{"align-self":"center"},{default:t(()=>[e(m,{density:"compact",variant:"outlined","prepend-inner-icon":"mdi-magnify",label:"Rechercher un dossier","hide-details":"",clearable:"",modelValue:i.value.Pattern,"onUpdate:modelValue":[u[5]||(u[5]=p=>i.value.Pattern=p),n]},{"append-inner":t(()=>[i.value.IdCamp.Valid?(b(),D(Ce,{key:0,class:"ml-1",size:"small","prepend-icon":"mdi-bed"},{default:t(()=>[f($(c.camps.find(p=>p.Id==i.value.IdCamp.Id)?.Label),1)]),_:1})):J("",!0),i.value.Attente!=U(da).EmptyQA?(b(),D(Ce,{key:1,class:"ml-1",size:"small","prepend-icon":"mdi-clock"},{default:t(()=>[f($(U(Ft)[i.value.Attente]),1)]),_:1})):J("",!0),i.value.Reglement!=U(ma).EmptyQR?(b(),D(Ce,{key:2,class:"ml-1",size:"small","prepend-icon":"mdi-currency-eur"},{default:t(()=>[f($(U(Rt)[i.value.Reglement]),1)]),_:1})):J("",!0),i.value.OnlyFondSoutien?(b(),D(Ce,{key:3,class:"ml-1",size:"small"},{default:t(()=>[...u[6]||(u[6]=[f(" Fonds de soutien ",-1)])]),_:1})):J("",!0)]),append:t(()=>[e(Se,{location:"left top","close-on-content-click":!1},{activator:t(({props:p})=>[e(L,ue(p,{size:"small",variant:"flat",icon:""}),{default:t(()=>[e(ve,null,{default:t(()=>[...u[7]||(u[7]=[f("mdi-filter-cog",-1)])]),_:1}),e(He,{activator:"parent",text:"Autres critères de recherche"})]),_:1},16)]),default:t(()=>[e(j,{"min-width":"400px",title:"Filtrer les dossiers"},{default:t(()=>[e(Y,null,{default:t(()=>[e(h,null,{default:t(()=>[e(g,null,{default:t(()=>[e(r,{label:"Camp",camps:c.camps,"model-value":U(oa)(U(ra)(i.value.IdCamp)),"onUpdate:modelValue":u[0]||(u[0]=p=>{i.value.IdCamp=U(ia)(U(sa)(p)),n()})},null,8,["camps","model-value"])]),_:1})]),_:1}),e(h,null,{default:t(()=>[e(g,null,{default:t(()=>[e(Te,{density:"compact",variant:"outlined",label:"Liste d'attente",modelValue:i.value.Attente,"onUpdate:modelValue":[u[1]||(u[1]=p=>i.value.Attente=p),n],items:U(lt)(U(Ft)),"hide-details":""},null,8,["modelValue","items"])]),_:1})]),_:1}),e(h,null,{default:t(()=>[e(g,null,{default:t(()=>[e(Te,{density:"compact",variant:"outlined",label:"Réglement",modelValue:i.value.Reglement,"onUpdate:modelValue":[u[2]||(u[2]=p=>i.value.Reglement=p),n],items:U(lt)(U(Rt)),"hide-details":""},null,8,["modelValue","items"])]),_:1})]),_:1}),e(h,null,{default:t(()=>[e(g,null,{default:t(()=>[e(Vt,{label:"Trier selon les nouveaux messages",hint:"Affiche les nouveaux messages en premier.","persistent-hint":"",density:"compact",color:"light-blue-darken-3",modelValue:i.value.SortByNewMessages,"onUpdate:modelValue":[u[3]||(u[3]=p=>i.value.SortByNewMessages=p),n]},null,8,["modelValue"])]),_:1})]),_:1}),c.allowFondsSoutien?(b(),D(h,{key:0},{default:t(()=>[e(g,null,{default:t(()=>[e(Vt,{label:"Fonds de soutien",hint:"N'affiche que les dossiers demandant le fonds de soutien.","persistent-hint":"",density:"compact",color:"orange",modelValue:i.value.OnlyFondSoutien,"onUpdate:modelValue":[u[4]||(u[4]=p=>i.value.OnlyFondSoutien=p),n]},null,8,["modelValue"])]),_:1})]),_:1})):J("",!0)]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"])]),_:1})]),_:1}),v.value!=null?(b(),D(Pe,{key:0,class:"mt-2",selected:c.selected?[c.selected]:void 0},{default:t(()=>[v.value.Dossiers?.length?J("",!0):(b(),D(z,{key:0,class:"text-center"},{default:t(()=>[...u[8]||(u[8]=[T("i",null,"Aucun dossier ne correspond à votre recherche.",-1)])]),_:1})),(b(!0),W(le,null,ce(v.value.Dossiers,(p,V)=>(b(),D(z,{rounded:"",key:V,title:p.Responsable,subtitle:p.Participants,value:p.Id,onClick:_=>a("click",p),class:"my-1"},pt({_:2},[p.NewMessages?{name:"append",fn:t(()=>[e(Ma,{color:"light-blue-darken-3",content:p.NewMessages},null,8,["content"])]),key:"0"}:void 0]),1032,["title","subtitle","value","onClick"]))),128))]),_:1},8,["selected"])):J("",!0)])}}}),au=X({__name:"SendDocumentsCampCard",props:{camps:{}},emits:["send"],setup(l,{emit:s}){const o=l,c=s,a=S(0),i=S(null);async function v(){const u=await P.EventsSendDocumentsCampPreview({idCamp:a.value});u!==void 0&&(i.value=u,n.value=(u.Dossiers||[]).filter(r=>!r.DocumentsSent).map(r=>r.Id))}const n=S([]),d=F(()=>n.value.length==(i.value?.Dossiers||[]).length);return(u,r)=>{const m=it;return b(),D(j,{title:"Envoyer les documents d'un séjour"},{default:t(()=>[e(Y,null,{default:t(()=>[e(h,null,{default:t(()=>[e(g,{"align-self":"center",cols:"5"},{default:t(()=>[e(m,{camps:o.camps,label:"Séjour",modelValue:a.value,"onUpdate:modelValue":[r[0]||(r[0]=p=>a.value=p),v]},null,8,["camps","modelValue"])]),_:1}),e(g,{"align-self":"center"},{default:t(()=>[i.value?(b(),D(j,{key:0,subtitle:"Dossiers à contacter"},pt({default:t(()=>[e(Y,null,{default:t(()=>[e(Pe,{selectable:"",selected:n.value,"onUpdate:selected":r[2]||(r[2]=p=>n.value=p),"select-strategy":"leaf"},{default:t(()=>[(b(!0),W(le,null,ce(i.value.Dossiers,p=>(b(),D(z,{title:p.Responsable,subtitle:p.Participants,value:p.Id,rounded:"",class:"my-1"},{append:t(({isSelected:V,select:_})=>[e(h,null,{default:t(()=>[e(g,null,{default:t(()=>[p.DocumentsSent?(b(),D(Ce,{key:0,color:"green",class:"mr-2"},{default:t(()=>[...r[4]||(r[4]=[f("Envoyés",-1)])]),_:1})):J("",!0)]),_:2},1024),e(g,null,{default:t(()=>[e(rl,{density:"compact","hide-details":"","model-value":V,"onUpdate:modelValue":_},null,8,["model-value","onUpdate:modelValue"])]),_:2},1024)]),_:2},1024)]),_:2},1032,["title","subtitle","value"]))),256))]),_:1},8,["selected"])]),_:1})]),_:2},[i.value.Dossiers?.length?{name:"append",fn:t(()=>[e(qe,{label:"Tout sélectionner",density:"compact","hide-details":"",indeterminate:!!n.value.length&&n.value.length!=(i.value.Dossiers||[]).length,"model-value":n.value.length==(i.value.Dossiers||[]).length,"onUpdate:modelValue":r[1]||(r[1]=p=>n.value=d.value?[]:(i.value.Dossiers||[]).map(V=>V.Id))},null,8,["indeterminate","model-value"])]),key:"0"}:void 0]),1024)):J("",!0)]),_:1})]),_:1})]),_:1}),e(se,null,{default:t(()=>[e(ie),e(L,{disabled:!a.value||!n.value.length,onClick:r[3]||(r[3]=p=>c("send",a.value,n.value))},{append:t(()=>[e(ve,null,{default:t(()=>[...r[5]||(r[5]=[f("mdi-send",-1)])]),_:1})]),default:t(()=>[r[6]||(r[6]=f(" Envoyer ",-1))]),_:1},8,["disabled"])]),_:1})]),_:1})}}}),nu=X({__name:"SendRelancePaiementCard",props:{camps:{}},emits:["send"],setup(l,{emit:s}){const o=l,c=s,a=S(0),i=S([]);async function v(){const u=await P.EventsSendRelancePaiementPreview({idCamp:a.value});u!==void 0&&(i.value=u||[],n.value=(u||[]).map(r=>r.Id))}const n=S([]),d=F(()=>n.value.length==i.value.length);return(u,r)=>{const m=it;return b(),D(j,{title:"Envoyer une relance de paiement"},{default:t(()=>[e(Y,null,{default:t(()=>[e(h,null,{default:t(()=>[e(g,{"align-self":"center",cols:"5"},{default:t(()=>[e(m,{camps:o.camps,label:"Séjour",modelValue:a.value,"onUpdate:modelValue":[r[0]||(r[0]=p=>a.value=p),v]},null,8,["camps","modelValue"])]),_:1}),e(g,{"align-self":"center"},{default:t(()=>[i.value?(b(),D(j,{key:0,subtitle:"Dossiers à relancer"},pt({default:t(()=>[e(Y,null,{default:t(()=>[e(Pe,{selectable:"",selected:n.value,"onUpdate:selected":r[2]||(r[2]=p=>n.value=p),"select-strategy":"leaf",density:"comfortable"},{default:t(()=>[(b(!0),W(le,null,ce(i.value,(p,V)=>(b(),D(z,{key:p.Id,title:p.Responsable,subtitle:U(ca)(p.LastEventFacture)?"":`Dernière demande : ${U(ke).time(p.LastEventFacture)}`,value:p.Id,rounded:"",class:"my-1"},{append:t(({isSelected:_,select:k})=>[e(h,null,{default:t(()=>[e(g,{"align-self":"center"},{default:t(()=>[e(Ce,{class:"mr-2",color:U(ke).colorStatutPaiement(p.Bilan.Statut)},{default:t(()=>[f($(p.Bilan.Recu)+" / "+$(p.Bilan.Demande),1)]),_:2},1032,["color"])]),_:2},1024),e(g,{"align-self":"center"},{default:t(()=>[e(rl,{density:"compact","hide-details":"","model-value":_,"onUpdate:modelValue":k},null,8,["model-value","onUpdate:modelValue"])]),_:2},1024)]),_:2},1024)]),_:2},1032,["title","subtitle","value"]))),128))]),_:1},8,["selected"])]),_:1})]),_:2},[i.value.length?{name:"append",fn:t(()=>[e(qe,{label:"Tout sélectionner",density:"compact","hide-details":"",indeterminate:!!n.value.length&&n.value.length!=i.value.length,"model-value":n.value.length==i.value.length,"onUpdate:modelValue":r[1]||(r[1]=p=>n.value=d.value?[]:i.value.map(V=>V.Id))},null,8,["indeterminate","model-value"])]),key:"0"}:void 0]),1024)):J("",!0)]),_:1})]),_:1})]),_:1}),e(se,null,{default:t(()=>[e(ie),e(L,{disabled:!a.value||!n.value.length,onClick:r[3]||(r[3]=p=>c("send",a.value,n.value))},{append:t(()=>[e(ve,null,{default:t(()=>[...r[4]||(r[4]=[f("mdi-send",-1)])]),_:1})]),default:t(()=>[r[5]||(r[5]=f(" Envoyer ",-1))]),_:1},8,["disabled"])]),_:1})]),_:1})}}}),uu={key:1,class:"text-center font-italic my-6"},iu=X({__name:"PannelDossiers",props:{initialDossier:{}},setup(l){const s=l;Oe(()=>{v(),s.initialDossier!==void 0&&r(s.initialDossier)}),Me(()=>s.initialDossier,()=>{s.initialDossier!==void 0&&r(s.initialDossier)});const o=Lt("detailsPannel"),c=S(null),a=S(Sa()),i=S([]);async function v(){const E=await P.GetCamps();E!==void 0&&(i.value=E||[])}function n(E){c.value={length:E.Dossiers?.length||0,total:E.Total}}const d=Lt("dossierList");function u(){d.value?.searchDossiers()}async function r(E){await p(E),a.value=Ia(E)}const m=S(null);async function p(E){const H=await P.DossiersLoad({id:E});H!==void 0&&(m.value=H)}async function V(E){p(E.Id),await P.EventsMarkMessagesSeen({idDossier:E.Id})!==void 0&&u()}async function _(){m.value!=null&&p(m.value.Dossier.Dossier.Id)}const k=S(!1);async function C(E){k.value=!1;const H=await P.DossiersCreate({idResponsable:E});H!==void 0&&(P.showMessage("Dossier créé avec succès."),await r(H.Id),o.value?.showEditDossier())}async function A(E){const H=await P.DossiersUpdate(E);H!==void 0&&(P.showMessage("Dossier mis à jour avec succès."),m.value!=null&&(m.value.Dossier.Dossier=E,m.value.Dossier.Responsable=H.Responsable),u())}async function q(){if(m.value==null)return;const E=m.value.Dossier.Dossier.Id;await P.DossiersDelete({id:E})!==void 0&&(P.showMessage("Dossier supprimé avec succès."),m.value=null,u())}async function B(E){await P.DossiersMerge(E)!==void 0&&(P.showMessage("Dossier fusionné avec succès."),u(),p(E.To))}async function x(E){await P.ParticipantsCreate(E)!==void 0&&(P.showMessage("Participant ajouté avec succès."),_())}async function w(E){await P.ParticipantsUpdate(E)!==void 0&&(P.showMessage("Réglages du participant modifiés avec succès."),_())}async function ee(E){await P.ParticipantsDelete({id:E})!==void 0&&(P.showMessage("Participant supprimé avec succès."),_())}async function ge(E){if(m.value==null)return;const H=m.value.Dossier.Participants?.map(me=>me.Participant).filter(me=>me.Id!=E.Id)||[];!H.length||(H.forEach(me=>{me.Remises=E.Remises,me.QuotientFamilial=E.QuotientFamilial,me.IdCamp==E.IdCamp&&(me.OptionPrix=E.OptionPrix)}),(await Promise.all(H.map(me=>P.ParticipantsUpdate(me)))).includes(void 0))||(P.showMessage("Réglages des participants modifiés avec succès."),_())}async function G(E){const H=await P.AidesCreate(E);if(H===void 0||(P.showMessage("Aide ajoutée avec succès."),m.value==null))return;const de=m.value.Dossier.Aides||{},me=de[E.IdParticipant]||{};me[H.Id]=H,de[E.IdParticipant]=me,m.value.Dossier.Aides=de}async function I(E){await P.AidesUpdate(E)!==void 0&&(P.showMessage("Aide modifiée avec succès."),_())}async function te(E){await P.AidesJustificatifDelete({idAide:E})!==void 0&&(P.showMessage("Justificatif supprimé avec succès."),m.value!=null&&m.value.Dossier.AidesFiles&&delete m.value.Dossier.AidesFiles[E])}async function Q(E,H){const de=await P.AidesJustificatifUpload(E,{idAide:H});if(de!==void 0&&(P.showMessage("Justificatif téléversé avec succès."),m.value!=null)){const me=m.value.Dossier.AidesFiles||{};me[H]=de,m.value.Dossier.AidesFiles=me}}async function N(E){await P.AidesDelete({id:E})!==void 0&&(P.showMessage("Aide supprimée avec succès."),_())}async function K(){if(m.value==null)return;const E=await P.PaiementsCreate({idDossier:m.value.Dossier.Dossier.Id});E!==void 0&&(P.showMessage("Paiement créé avec succès."),_(),o.value?.showEditPaiement(E))}async function oe(E){await P.PaiementsUpdate(E)!==void 0&&(P.showMessage("Paiement modifié avec succès."),_())}async function ae(E){await P.PaiementsDelete({id:E.Id})!==void 0&&(P.showMessage("Paiement supprimé avec succès."),_())}async function fe(E){m.value==null||await P.EventsSendMessage({IdDossier:m.value.Dossier.Dossier.Id,Contenu:E})===void 0||(P.showMessage("Message envoyé avec succès."),_())}async function be(E){await P.EventsDelete({id:E.Id})!==void 0&&(P.showMessage("Message supprimé avec succès."),_())}async function M(){m.value==null||await P.EventsSendFacture({idDossier:m.value.Dossier.Dossier.Id})===void 0||(P.showMessage("Demande de règlement envoyé avec succès."),_())}const y=S(!1),O=S(null);async function R(E,H){O.value={Current:0,Total:H.length};const de=await P.EventsSendDocumentsCamp({IdCamp:E,IdDossiers:H});if(de===void 0){O.value=null;return}await gt(de,me=>O.value=me,me=>P.onError("Envoi des documents",me)),O.value=null,_(),P.showMessage("Documents du séjour envoyés avec succès.")}const ye=S(!1),ne=S(null);async function Ie(E,H){ne.value={Current:0,Total:H.length};const de=await P.EventsSendRelancePaiement({IdDossiers:H});if(de===void 0){ne.value=null;return}await gt(de,me=>ne.value=me,me=>P.onError("Envoi de la relance",me)),ne.value=null,_(),P.showMessage("Toutes les relances ont été envoyées avec succès.")}return(E,H)=>(b(),D(h,{"no-gutters":"",class:"ma-2"},{default:t(()=>[e(g,{cols:"6"},{default:t(()=>[e(j,{title:"Dossiers",subtitle:c.value==null?"-":`${c.value.length} affiché(s) / ${c.value.total}`},{append:t(()=>[e(L,{icon:"",size:"small",onClick:H[0]||(H[0]=de=>k.value=!0)},{default:t(()=>[e(ve,{color:"green"},{default:t(()=>[...H[7]||(H[7]=[f("mdi-plus",-1)])]),_:1})]),_:1}),e(re,{thickness:"1",vertical:"",class:"mx-2"}),e(L,{size:"small"},{prepend:t(()=>[e(ve,null,{default:t(()=>[...H[8]||(H[8]=[f("mdi-send-circle-outline",-1)])]),_:1})]),default:t(()=>[H[9]||(H[9]=f(" Actions ",-1)),e(Se,{activator:"parent"},{default:t(()=>[e(Pe,null,{default:t(()=>[e(z,{title:"Documents...",subtitle:"Paramétrer et envoyer les documents d'un séjour","prepend-icon":"mdi-mail",onClick:H[1]||(H[1]=de=>y.value=!0)}),e(re),e(z,{title:"Relance de paiement...",subtitle:"Paramétrer et envoyer une relance, pour un séjour","prepend-icon":"mdi-invoice-send",onClick:H[2]||(H[2]=de=>ye.value=!0)})]),_:1})]),_:1})]),_:1})]),default:t(()=>[e(Y,null,{default:t(()=>[e(lu,{camps:i.value,"allow-fonds-soutien":U(P).isFondsSoutien,selected:m.value?.Dossier.Dossier.Id,query:a.value,"onUpdate:query":H[3]||(H[3]=de=>a.value=de),onClick:V,onUpdate:n,ref_key:"dossierList",ref:d},null,8,["camps","allow-fonds-soutien","selected","query"])]),_:1})]),_:1},8,["subtitle"])]),_:1}),e(g,{cols:"6"},{default:t(()=>[m.value!=null?(b(),D(eu,{key:0,dossier:m.value,camps:i.value,onUpdateDossier:A,onDeleteDossier:q,onMergeDossier:B,onCreateParticipant:x,onUpdateParticipant:w,onDeleteParticipant:ee,onExpandParticipant:ge,onCreateAide:G,onDeleteAide:N,onUpdateAide:I,onDeleteFileAide:te,onUploadFileAide:Q,onCreatePaiement:K,onUpdatePaiement:oe,onDeletePaiement:ae,onSendMessage:fe,onDeleteMessage:be,onSendFacture:M,ref_key:"detailsPannel",ref:o},null,8,["dossier","camps"])):(b(),W("div",uu," Sélectionner un dossier... "))]),_:1}),e(Z,{modelValue:k.value,"onUpdate:modelValue":H[4]||(H[4]=de=>k.value=de),"max-width":"400px"},{default:t(()=>[e(tu,{onCreate:C})]),_:1},8,["modelValue"]),e(Z,{modelValue:y.value,"onUpdate:modelValue":H[5]||(H[5]=de=>y.value=de),"max-width":"1000px"},{default:t(()=>[e(au,{camps:i.value,onSend:R},null,8,["camps"])]),_:1},8,["modelValue"]),e(Z,{modelValue:ye.value,"onUpdate:modelValue":H[6]||(H[6]=de=>ye.value=de),"max-width":"1000px"},{default:t(()=>[e(nu,{camps:i.value,onSend:Ie},null,8,["camps"])]),_:1},8,["modelValue"]),e(Z,{"model-value":O.value!=null,"max-width":"400px",persistent:""},{default:t(()=>[O.value?(b(),D(kt,{key:0,title:"Envoi des documents en cours",current:O.value.Current,total:O.value.Total},null,8,["current","total"])):J("",!0)]),_:1},8,["model-value"]),e(Z,{"model-value":ne.value!=null,"max-width":"400px",persistent:""},{default:t(()=>[ne.value?(b(),D(kt,{key:0,title:"Envoi des relances en cours",current:ne.value.Current,total:ne.value.Total},null,8,["current","total"])):J("",!0)]),_:1},8,["model-value"])]),_:1}))}}),su=X({__name:"inscriptions",setup(l){const s=nt(),o=F(()=>vu(s.currentRoute.value.query)),c=F(()=>o.value.tab||"insc"),a=F(()=>o.value.idDossier);function i(v){const n=s.currentRoute.value;s.push({path:n.path,query:{tab:v}})}return(v,n)=>(b(),W(le,null,[e(ft,{title:"Suivi des inscriptions"},{default:t(()=>[e(Ua,{"model-value":c.value,"onUpdate:modelValue":n[0]||(n[0]=d=>i(d))},{default:t(()=>[e(Ot,{value:"insc"},{default:t(()=>[...n[2]||(n[2]=[f("Inscriptions en attente",-1)])]),_:1}),e(Ot,{value:"doss"},{default:t(()=>[...n[3]||(n[3]=[f("Suivi des dossiers",-1)])]),_:1})]),_:1},8,["model-value"])]),_:1}),e($a,{"model-value":c.value},{default:t(()=>[e(Nt,{value:"insc"},{default:t(()=>[e(gn,{onGoTo:U(_t),onEmpty:n[1]||(n[1]=d=>U(_t)())},null,8,["onGoTo"])]),_:1}),e(Nt,{value:"doss"},{default:t(()=>[e(iu,{"initial-dossier":a.value},null,8,["initial-dossier"])]),_:1})]),_:1},8,["model-value"])],64))}}),ou=X({__name:"PersonneEdit",props:{personne:{}},emits:["save"],setup(l,{emit:s}){const o=l,c=s,a=S(we(o.personne)),i=F(()=>!!(a.value.Nom&&a.value.Prenom));return(v,n)=>{const d=ha,u=Ea;return b(),D(j,{title:"Editer le profil"},{default:t(()=>[e(Y,null,{default:t(()=>[e(Oa,null,{default:t(()=>[e(h,null,{default:t(()=>[e(g,null,{default:t(()=>[e(pe,{autofocus:"","hide-details":"",label:"Nom",density:"compact",variant:"outlined",modelValue:a.value.Nom,"onUpdate:modelValue":n[0]||(n[0]=r=>a.value.Nom=r)},null,8,["modelValue"])]),_:1}),e(g,null,{default:t(()=>[e(pe,{"hide-details":"",label:"Prénom",density:"compact",variant:"outlined",modelValue:a.value.Prenom,"onUpdate:modelValue":n[1]||(n[1]=r=>a.value.Prenom=r)},null,8,["modelValue"])]),_:1}),e(g,null,{default:t(()=>[e(d,{modelValue:a.value.Sexe,"onUpdate:modelValue":n[2]||(n[2]=r=>a.value.Sexe=r)},null,8,["modelValue"])]),_:1}),e(g,null,{default:t(()=>[e(u,{modelValue:a.value.DateNaissance,"onUpdate:modelValue":n[3]||(n[3]=r=>a.value.DateNaissance=r)},null,8,["modelValue"])]),_:1})]),_:1})]),_:1})]),_:1}),e(se,null,{default:t(()=>[e(ie),e(L,{disabled:!i.value,onClick:n[4]||(n[4]=r=>c("save",a.value))},{default:t(()=>[...n[5]||(n[5]=[f("Enregistrer",-1)])]),_:1},8,["disabled"])]),_:1})]),_:1})}}}),ru=X({__name:"annuaire",setup(l){const s=nt(),o=F(()=>pu(s.currentRoute.value.query)),c=F(()=>o.value.idPersonne);Me(()=>c.value,()=>c.value!==void 0?r(c.value):null,{immediate:!0});const a=S([]),i=S("");async function v(){if(!i.value)return;const m=await P.PersonnesGet({search:i.value});m!==void 0&&(a.value=m||[])}async function n(){const m=await P.PersonnesCreate();m!==void 0&&(P.showMessage("Profil créé avec succès."),a.value.push(m),Ke(m.Id))}const d=S(null);async function u(m){d.value=null;const p=await P.PersonnesUpdate(m);if(p===void 0)return;P.showMessage("Profil modifié avec succès."),Ke();const V=a.value.findIndex(_=>_.Id==m.Id);a.value[V]=p}async function r(m){const p=await P.PersonnesLoad({id:m});p!==void 0&&(d.value=p)}return(m,p)=>{const V=il;return b(),W(le,null,[e(ft,{title:"Annuaire : personnes et organismes"},{default:t(()=>[...p[2]||(p[2]=[f(" TODO ",-1)])]),_:1}),e(j,{class:"ma-2"},{append:t(()=>[e(L,{color:"green",onClick:n},{default:t(()=>[...p[3]||(p[3]=[f("Créer un nouveau profil",-1)])]),_:1})]),default:t(()=>[e(Y,null,{default:t(()=>[e(h,null,{default:t(()=>[e(g,null,{default:t(()=>[e(V,{"prepend-inner-icon":"mdi-magnify",label:"Recherche",modelValue:i.value,"onUpdate:modelValue":[p[0]||(p[0]=_=>i.value=_),v]},null,8,["modelValue"]),e(Pe,null,{default:t(()=>[(b(!0),W(le,null,ce(a.value,_=>(b(),D(z,{title:_.Label,subtitle:U(ke).dateNaissance(_.DateNaissance),"prepend-icon":U(ke).sexeIcon(_.Sexe),onClick:k=>U(Ke)(_.Id)},pt({_:2},[_.IsTemp?{name:"append",fn:t(()=>[e(Ce,{"prepend-icon":"mdi-alert",color:"warning"},{default:t(()=>[...p[4]||(p[4]=[f(" Ce profil est temporaire et devrait être identifié. ",-1)])]),_:1})]),key:"0"}:void 0]),1032,["title","subtitle","prepend-icon","onClick"]))),256))]),_:1})]),_:1}),e(g)]),_:1})]),_:1}),d.value!=null?(b(),D(Z,{key:0,"model-value":d.value!=null,"onUpdate:modelValue":p[1]||(p[1]=_=>{d.value=null,U(Ke)(void 0)}),"max-width":"800px"},{default:t(()=>[e(ou,{personne:d.value,onSave:u},null,8,["personne"])]),_:1},8,["model-value"])):J("",!0)]),_:1})],64)}}}),du=[{path:"/",component:Na},{path:"/camps",component:fn},{path:"/inscriptions",component:su},{path:"/annuaire",component:ru}],mu="/backoffice",Ge=ga({history:Va(mu),routes:du});Ge.onError((l,s)=>{l?.message?.includes?.("Failed to fetch dynamically imported module")?localStorage.getItem("vuetify:dynamic-reload")?console.error("Dynamic import error, reloading page did not fix it",l):(console.log("Reloading page to fix dynamic import error"),localStorage.setItem("vuetify:dynamic-reload","true"),location.assign(s.fullPath)):console.error(l)});Ge.isReady().then(()=>{localStorage.removeItem("vuetify:dynamic-reload")});function vt(l){return l?Number(l):void 0}function cu(l){const s=l;return{idCamp:vt(s.idCamp),idParticipant:vt(s.idParticipant)}}function wt(l){Ge.push({path:"/camps",query:{idCamp:l.IdCamp,idParticipant:l.Id}})}function vu(l){const s=l;return{tab:s.tab,idDossier:vt(s.idDossier)}}function _t(l){Ge.push({path:"/inscriptions",query:{tab:"doss",idDossier:l}})}function pu(l){return{idPersonne:vt(l.idPersonne)}}function Ke(l){Ge.push({path:"/annuaire",query:{idPersonne:l}})}const fu=["innerHTML"],yu=X({__name:"App",setup(l){const s=bt({text:"",color:"secondary",action:void 0,timeout:4e3}),o=S(""),c=S("");return P.onError=(i,v)=>{o.value=i,c.value=v},P.showMessage=(i,v,n)=>{s.text=i,s.color=v||"success",s.action=n,s.timeout=1e4,s.timeout=4e3},nt().beforeEach(async(i,v)=>{if(!P.hasToken()&&i.path!=="/")return{path:"/"}}),(i,v)=>{const n=va("router-view");return b(),D(fa,null,{default:t(()=>[e(pa,null,{default:t(()=>[e(n),e(ht,{style:{"z-index":"10000"},app:"","model-value":s.text!="","onUpdate:modelValue":v[1]||(v[1]=d=>s.text=""),timeout:s.timeout,color:s.color,location:"bottom left","close-on-content-click":""},{default:t(()=>[f($(s.text)+" ",1),s.action?(b(),D(L,{key:0,onClick:v[0]||(v[0]=d=>s.action.action()),class:"ml-2"},{default:t(()=>[f($(s.action.title),1)]),_:1})):J("",!0)]),_:1},8,["model-value","timeout","color"]),e(ht,{app:"","model-value":o.value!="","onUpdate:modelValue":v[2]||(v[2]=d=>o.value=""),timeout:4e3,color:"red"},{default:t(()=>[T("b",null,$(o.value),1),T("div",{innerHTML:c.value},null,8,fu)]),_:1},8,["model-value"])]),_:1})]),_:1})}}}),bl=ya(yu);bl.use(ba).use(Ge);bl.mount("#app");
