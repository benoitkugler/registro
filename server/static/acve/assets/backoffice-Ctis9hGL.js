import{$ as e,$t as t,Ai as n,An as r,B as i,Bi as a,Bn as o,Bt as s,Ca as c,Ea as l,Ei as u,Er as d,Fi as f,Gi as p,Gn as m,Gt as h,H as g,Hn as _,Ht as v,Ii as y,Jt as b,Kn as ee,Kr as x,Li as S,M as C,Mi as w,Mn as T,Ni as E,O as D,Ot as te,Pi as O,Qi as k,Qn as ne,Qt as re,Ri as A,Rn as j,Sa as M,Sr as ie,St as ae,Ta as oe,U as N,Un as se,Ut as P,V as ce,Vn as le,Wi as F,Wn as ue,Wr as de,Wt as fe,Xn as pe,Yn as me,Yt as he,Zt as ge,_a as _e,an as ve,ca as I,dr as ye,ea as L,en as be,f as xe,fa as Se,gr as Ce,gt as we,ha as R,ht as Te,i as Ee,ia as De,in as Oe,ji as z,jn as ke,k as B,ki as Ae,kt as je,ln as Me,mn as Ne,mt as Pe,n as Fe,na as V,nt as Ie,oa as Le,ot as Re,pa as ze,pi as Be,pn as Ve,pr as He,qr as Ue,qt as We,r as Ge,ra as Ke,rn as qe,rt as H,sa as Je,sn as Ye,t as Xe,tn as Ze,u as U,ua as W,ya as Qe,z as G,zi as K,zn as $e}from"./VSnackbar-DKsX373a.js";import{S as q,_ as et,b as tt,d as nt,m as J,o as rt,s as Y,t as it,u as at,v as X,x as Z,y as ot}from"./VSelect-DKlba4X0.js";import{n as st,r as ct,t as lt}from"./vue-router-DdoCR-R7.js";import{_ as Q,a as ut,b as dt,c as ft,d as pt,f as mt,g as ht,h as gt,i as _t,l as vt,m as yt,n as bt,o as xt,p as St,r as Ct,s as wt,t as Tt,u as Et,v as Dt,y as Ot}from"./InscriptionRow-DKGA_Hiq.js";import{i as kt,n as At,o as jt,r as Mt,s as Nt,t as Pt}from"./VTabs-ZvJZT4IU.js";import{t as Ft}from"./MontantField-DerzTMqX.js";import{n as It,r as Lt,t as Rt}from"./ModePaiementField-B7FaPc2b.js";import{t as zt}from"./VBadge-BaNiUdH_.js";import{n as Bt,t as Vt}from"./VPicker-Bbu7JWFU.js";import"./VSheet-CF2FMydG.js";import{t as Ht}from"./_plugin-vue_export-helper-U-kLyCs_.js";import{t as $}from"./VDialog-491dXdoo.js";import{t as Ut}from"./VTooltip-05sJRP7O.js";import{t as Wt}from"./VCombobox-BiNZw4JF.js";import{t as Gt}from"./VTextarea-Csu_MYTK.js";import{t as Kt}from"./VAlert-Doq-6NOj.js";import{t as qt}from"./VForm-dB1KwUiU.js";import{n as Jt,t as Yt}from"./EventSwitch-Ctxp6Bi5.js";import{n as Xt,o as Zt,r as Qt,t as $t}from"./SexeField-CmnWQtBw.js";import"./FileCard-B5JGRUtq.js";import{t as en}from"./FilesRow-B-ero5WG.js";import"./VWindowItem-eWU8sHUC.js";import{t as tn}from"./NationaliteField-CZJcYI_H.js";import{t as nn}from"./DepartementField-p1iX0g1V.js";var rn=a({__name:`NavBar`,props:{title:{},hideMenu:{type:Boolean}},setup(e){let t=e,n=w(()=>Q.isFondsSoutien);return(e,r)=>(L(),y(z,null,[K(gt,{app:``,"model-value":!t.hideMenu,"expand-on-hover":``,permanent:``,rail:``},{append:W(()=>[K(X,{"prepend-icon":`mdi-account-circle-outline`,title:n.value?`Fonds de soutien`:`Administrateur`},null,8,[`title`]),K(X,{"prepend-icon":`mdi-logout`,link:``,to:{path:`/`},color:`primary`,onClick:r[0]||=e=>M(ht).clear()},{default:W(()=>[...r[4]||=[A(` Se déconnecter `,-1)]]),_:1})]),default:W(()=>[K(X,{"prepend-icon":`mdi-menu`,title:`Registro - Backoffice`,subtitle:`v0.9.0`}),K(q),K(X,{"prepend-icon":`mdi-bed`,link:``,to:{path:`/camps`},color:`primary`},{default:W(()=>[...r[1]||=[A(` Séjours `,-1)]]),_:1}),K(X,{"prepend-icon":`mdi-calendar-multiple-check`,link:``,to:{path:`/inscriptions`},color:`primary`},{default:W(()=>[...r[2]||=[A(` Inscriptions `,-1)]]),_:1}),K(q),K(X,{"prepend-icon":`mdi-account-multiple`,link:``,to:{path:`/annuaire`},color:`primary`},{default:W(()=>[...r[3]||=[A(` Annuaire `,-1)]]),_:1}),K(q)]),_:1},8,[`model-value`]),K(we,{rounded:``,elevation:`4`,color:`primary`},{append:W(()=>[Ke(e.$slots,`default`),r[5]||=E(`div`,{class:`mr-2`},null,-1)]),default:W(()=>[K(g,null,{default:W(()=>[K(G,null,{default:W(()=>[K(i,{"align-self":`center`,cols:`auto`},{default:W(()=>[K(ae,{width:`150`,src:`/static/acve/logo.png`})]),_:1}),K(i,{"align-self":`center`},{default:W(()=>[A(l(t.title),1)]),_:1})]),_:1})]),_:1})]),_:3})],64))}}),an=a({__name:`index`,setup(e){let t=ct(),r=R(!1),i=R(``),a=R([]);async function o(){let e=await Q.Loggin({password:i.value});e!==void 0&&(e.IsValid?(Q.setToken(e.Token,e.IsFondSoutien),ht.set(e.Token),Q.showMessage(`Bienvenue !`),t.push({path:`/inscriptions`})):a.value=[`Clé de connection incorrecte.`])}return(e,t)=>(L(),y(z,null,[K(rn,{title:`Connection au backoffice`,"hide-menu":``}),K(ce,{class:`fill-height`},{default:W(()=>[K(D,{class:`mx-auto`,width:`400px`},{default:W(()=>[K(B,null,{default:W(()=>[E(`form`,null,[K(U,{label:`Clé de connection`,modelValue:i.value,"onUpdate:modelValue":t[1]||=e=>i.value=e,"error-messages":a.value,type:r.value?void 0:`password`,name:`password`,onKeydown:t[2]||=Ae(n(()=>i.value.length==0?null:o(),[`prevent`]),[`enter`]),autocomplete:`current-password`},{"append-inner":W(()=>[K(N,{class:`ml-2`,size:`small`,icon:r.value?`mdi-eye`:`mdi-eye-off`,flat:``,onClick:t[0]||=e=>r.value=!r.value},null,8,[`icon`])]),_:1},8,[`modelValue`,`error-messages`,`type`])])]),_:1}),K(C,null,{default:W(()=>[K(Z),K(N,{disabled:!i.value.length,onClick:o},{default:W(()=>[...t[3]||=[A(`Se connecter`,-1)]]),_:1},8,[`disabled`])]),_:1})]),_:1})]),_:1})],64))}}),on=a({__name:`BoolField`,props:F({label:{},hideDetails:{type:Boolean},readonly:{type:Boolean},density:{},persistentHint:{type:Boolean},hint:{}},{modelValue:{type:Boolean,required:!0},modelModifiers:{}}),emits:[`update:modelValue`],setup(e){let t=e,n=Le(e,`modelValue`);return(e,r)=>(L(),O(at,{label:t.label,"model-value":n.value,"onUpdate:modelValue":r[0]||=e=>n.value=e||!1,"hide-details":t.hideDetails,readonly:t.readonly,density:t.density,"persistent-hint":t.persistentHint,hint:t.hint},null,8,[`label`,`model-value`,`hide-details`,`readonly`,`density`,`persistent-hint`,`hint`]))}}),sn=a({__name:`OptionStatut`,props:F({camp:{}},{modelValue:{required:!0},modelModifiers:{}}),emits:[`update:modelValue`],setup(e){let t=e,r=Le(e,`modelValue`);function a(){let e=r.value?.length?r.value.map(e=>e.Id):[0],n={Id:Math.max(...e)+1,Label:``,Description:``,Prix:t.camp.Prix.Cent};r.value=(r.value||[]).concat(n),o.value=n}let o=R(null);function s(e){r.value=(r.value||[]).filter(t=>t.Id!=e.Id)}return(c,u)=>{let d=Ft;return L(),O(D,{subtitle:`Le prix dépend du statut du participant, à choisir parmi la liste ci-dessous.`},{append:W(()=>[K(N,{icon:``,size:`x-small`,onClick:a},{default:W(()=>[K(H,{color:`green`},{default:W(()=>[...u[4]||=[A(`mdi-plus`,-1)]]),_:1})]),_:1})]),default:W(()=>[o.value==null?f(``,!0):(L(),O($,{key:0,"model-value":o.value!=null,"onUpdate:modelValue":u[3]||=e=>o.value=null,"max-width":`500px`},{default:W(()=>[K(D,{title:`Modifier le statut`},{default:W(()=>[K(B,null,{default:W(()=>[K(G,null,{default:W(()=>[K(i,{cols:`12`},{default:W(()=>[K(U,{autofocus:``,label:`Statut`,modelValue:o.value.Label,"onUpdate:modelValue":u[0]||=e=>o.value.Label=e,density:`compact`,variant:`outlined`,"hide-details":``},null,8,[`modelValue`])]),_:1}),K(i,{cols:`12`},{default:W(()=>[K(U,{label:`Description`,modelValue:o.value.Description,"onUpdate:modelValue":u[1]||=e=>o.value.Description=e,density:`compact`,variant:`outlined`,"hide-details":``},null,8,[`modelValue`])]),_:1}),K(i,{cols:`12`},{default:W(()=>[K(d,{"model-value":{Cent:o.value.Prix,Currency:t.camp.Prix.Currency},"onUpdate:modelValue":u[2]||=e=>o.value.Prix=e.Cent,label:`Prix`,"readonly-currency":``},null,8,[`model-value`])]),_:1})]),_:1})]),_:1})]),_:1})]),_:1},8,[`model-value`])),K(B,{class:`py-0`},{default:W(()=>[K(J,null,{default:W(()=>[r.value?.length?f(``,!0):(L(),O(X,{key:0},{default:W(()=>[...u[5]||=[E(`i`,null,`Aucun statut n'est encore défini.`,-1)]]),_:1})),(L(!0),y(z,null,V(r.value,t=>(L(),O(X,{title:t.Label,subtitle:t.Description,onClick:e=>o.value=t},{append:W(()=>[K(G,null,{default:W(()=>[K(i,{"align-self":`center`},{default:W(()=>[K(Y,null,{default:W(()=>[A(l(M(P).montant({Cent:t.Prix,Currency:e.camp.Prix.Currency})),1)]),_:2},1024)]),_:2},1024),K(i,{"align-self":`center`,cols:`auto`},{default:W(()=>[K(N,{icon:``,size:`x-small`,class:`my-1`,onClick:n(e=>s(t),[`stop`])},{default:W(()=>[K(H,{color:`red`},{default:W(()=>[...u[6]||=[A(`mdi-delete`,-1)]]),_:1})]),_:1},8,[`onClick`])]),_:2},1024)]),_:2},1024)]),_:2},1032,[`title`,`subtitle`,`onClick`]))),256))]),_:1})]),_:1})]),_:1})}}}),cn=a({__name:`OptionJournee`,props:F({camp:{}},{modelValue:{required:!0},modelModifiers:{}}),emits:[`update:modelValue`],setup(e){let t=e,n=Le(e,`modelValue`);I(()=>n.value,r,{immediate:!0});function r(){let e=t.camp.Duree;n.value?.length!=e&&(n.value=Array.from({length:e}).map(e=>0))}function a(){let e=n.value,t=e[0];for(let n=0;n<e.length;n++)e[n]=t}return(e,r)=>{let o=Ft;return L(),O(D,{subtitle:`Le prix est variable en fonction des jours de participation au camp.`},{append:W(()=>[K(Ut,{text:`Appliquer le prix du premier jour à tous.`},{activator:W(({props:e})=>[K(N,p(e,{icon:`mdi-arrow-expand`,size:`x-small`,disabled:!(n.value||[])[0],onClick:a}),null,16,[`disabled`])]),_:1})]),default:W(()=>[K(B,null,{default:W(()=>[K(G,null,{default:W(()=>[(L(!0),y(z,null,V(n.value,(e,r)=>(L(),O(i,{cols:`3`},{default:W(()=>[K(o,{label:`Jour ${r+1}`,"model-value":{Cent:e,Currency:t.camp.Prix.Currency},"onUpdate:modelValue":e=>n.value[r]=e.Cent,"readonly-currency":``},null,8,[`label`,`model-value`,`onUpdate:modelValue`])]),_:2},1024))),256))]),_:1})]),_:1})]),_:1})}}}),ln={key:0,class:`text-center`},un=a({__name:`CampOptionsPrix`,props:F({camp:{}},{optionPrix:{required:!0},optionPrixModifiers:{},optionQf:{required:!0},optionQfModifiers:{}}),emits:[`update:optionPrix`,`update:optionQf`],setup(e){let t=e,n=Le(e,`optionPrix`),r=Le(e,`optionQf`),a=w(()=>s.isQuotientFamilialActive(r.value)),o=Ye($e);return(e,s)=>{let c=Nt;return L(),O(D,{title:`Options sur le prix`,subtitle:`Permet de modifier le prix de base du séjour`,width:`1000px`},{default:W(()=>[K(B,null,{default:W(()=>[K(G,null,{default:W(()=>[K(i,{"align-self":`center`},{default:W(()=>[K(at,{"model-value":a.value,"onUpdate:modelValue":s[0]||=e=>r.value[3]=e?100:0,"hide-details":``,label:`Prix au quotient familial`},null,8,[`model-value`])]),_:1}),K(i,{"align-self":`center`},{default:W(()=>[K(c,{suffix:`%`,min:0,max:100,disabled:!a.value,"hide-details":``,"readonly-currency":``,label:`entre 1 et 359`,modelValue:r.value[0],"onUpdate:modelValue":s[1]||=e=>r.value[0]=e},null,8,[`disabled`,`modelValue`])]),_:1}),K(i,{"align-self":`center`},{default:W(()=>[K(c,{suffix:`%`,min:0,max:100,disabled:!a.value,"hide-details":``,"readonly-currency":``,label:`entre 360 et 564`,modelValue:r.value[1],"onUpdate:modelValue":s[2]||=e=>r.value[1]=e},null,8,[`disabled`,`modelValue`])]),_:1}),K(i,{"align-self":`center`},{default:W(()=>[K(c,{suffix:`%`,min:0,max:100,disabled:!a.value,"hide-details":``,"readonly-currency":``,label:`entre 565 et 714`,modelValue:r.value[2],"onUpdate:modelValue":s[3]||=e=>r.value[2]=e},null,8,[`disabled`,`modelValue`])]),_:1}),K(i,{"align-self":`center`},{default:W(()=>[K(c,{suffix:`%`,min:0,max:100,disabled:!0,"hide-details":``,"readonly-currency":``,label:`plus de 715`,modelValue:r.value[3],"onUpdate:modelValue":s[4]||=e=>r.value[3]=e},null,8,[`modelValue`])]),_:1})]),_:1}),K(q,{thickness:`1`,class:`my-2`}),K(G,{class:`my-2`},{default:W(()=>[K(i,{"align-self":`center`,cols:`4`},{default:W(()=>[K(it,{variant:`outlined`,density:`comfortable`,"hide-details":``,items:M(o),label:`Option sur le prix`,modelValue:n.value.Active,"onUpdate:modelValue":s[5]||=e=>n.value.Active=e},null,8,[`items`,`modelValue`])]),_:1}),K(i,{"align-self":`center`},{default:W(()=>[n.value.Active==M(j).NoOption?(L(),y(`div`,ln,[...s[8]||=[E(`i`,null,`Aucune modification sur le prix de base.`,-1)]])):n.value.Active==M(j).PrixStatut?(L(),O(sn,{key:1,camp:t.camp,modelValue:n.value.Statuts,"onUpdate:modelValue":s[6]||=e=>n.value.Statuts=e},null,8,[`camp`,`modelValue`])):n.value.Active==M(j).PrixJour?(L(),O(cn,{key:2,camp:t.camp,modelValue:n.value.Jours,"onUpdate:modelValue":s[7]||=e=>n.value.Jours=e},null,8,[`camp`,`modelValue`])):f(``,!0)]),_:1})]),_:1})]),_:1})]),_:1})}}}),dn=a({__name:`CampMetaEdit`,props:F({metaEntriesHints:{}},{modelValue:{required:!0},modelModifiers:{}}),emits:[`update:modelValue`],setup(e){let t=e,n=Le(e,`modelValue`),r=R(Object.entries(n.value||{}));function a(){n.value=Object.fromEntries(r.value)}return w(()=>{let e=r.value.map(e=>e[0]);return e.includes(``)?!0:new Set(e).size!=r.value.length}),(e,n)=>(L(),O(D,{subtitle:`Métadonnées exposées sur l'API publique`},{append:W(()=>[K(N,{size:`small`,class:`ml-2`,onClick:n[0]||=e=>{r.value.push([``,``]),a()}},{prepend:W(()=>[K(H,{color:`green`},{default:W(()=>[...n[1]||=[A(`mdi-plus`,-1)]]),_:1})]),default:W(()=>[n[2]||=A(` Ajouter une valeur`,-1)]),_:1})]),default:W(()=>[K(B,{class:`pt-2`},{default:W(()=>[(L(!0),y(z,null,V(r.value,(e,o)=>(L(),O(G,null,{default:W(()=>[K(i,{cols:`4`},{default:W(()=>[K(Wt,{variant:`outlined`,density:`compact`,"hide-details":``,label:`Clé`,modelValue:e[0],"onUpdate:modelValue":[t=>e[0]=t,a],autofocus:``,items:t.metaEntriesHints.keys},null,8,[`modelValue`,`onUpdate:modelValue`,`items`])]),_:2},1024),K(i,null,{default:W(()=>[K(Wt,{variant:`outlined`,density:`compact`,"hide-details":``,label:`Valeur`,modelValue:e[1],"onUpdate:modelValue":[t=>e[1]=t,a],items:t.metaEntriesHints.values},null,8,[`modelValue`,`onUpdate:modelValue`,`items`])]),_:2},1024),K(i,{cols:`auto`},{default:W(()=>[K(N,{icon:``,size:`small`,flat:``,onClick:e=>{r.value.splice(o,1),a()}},{default:W(()=>[K(H,{color:`red`},{default:W(()=>[...n[3]||=[A(`mdi-close`,-1)]]),_:1})]),_:1},8,[`onClick`])]),_:2},1024)]),_:2},1024))),256))]),_:1})]),_:1}))}}),fn=a({__name:`CampEdit`,props:{camp:{},preselectionUrl:{},metaEntriesHints:{}},emits:[`save`],setup(e,{emit:t}){let n=e,r=t,a=R(b(n.camp)),o=w(()=>new Date(a.value.DateDebut).getFullYear()>=2020&&a.value.Places>=1&&a.value.Nom!=``&&a.value.AgeMax>=a.value.AgeMin&&a.value.OptionQuotientFamilial.every(e=>0<=e&&e<=100)&&!(a.value.OptionPrix.Active==j.PrixStatut&&!a.value.OptionPrix.Statuts?.length)&&!(a.value.OptionPrix.Active==j.PrixJour&&a.value.OptionPrix.Jours?.length!=a.value.Duree)),c=Ye(ee);function l(e){let t=s.isQuotientFamilialActive(e.OptionQuotientFamilial),n=e.OptionPrix.Active!=j.NoOption;if(!t&&!n)return`Aucune`;let r=[];return s.isQuotientFamilialActive(e.OptionQuotientFamilial)&&r.push(`Quotient familial`),e.OptionPrix.Active!=j.NoOption&&r.push($e[e.OptionPrix.Active]),r.join(`, `)}async function u(){await he(n.preselectionUrl),Q.showMessage(`URL copiée dans le presse-papier.`)}return(t,d)=>{let f=Lt,m=Nt,h=Ft,g=on;return L(),O(D,{title:`Paramètres du séjour`,subtitle:M(s).label(n.camp)},{default:W(()=>[K(B,null,{default:W(()=>[K(D,{class:`my-2`,subtitle:`Général`},{default:W(()=>[K(B,null,{default:W(()=>[K(G,null,{default:W(()=>[K(i,null,{default:W(()=>[K(U,{autofocus:``,"hide-details":``,label:`Nom`,density:`compact`,variant:`outlined`,modelValue:a.value.Nom,"onUpdate:modelValue":d[0]||=e=>a.value.Nom=e},null,8,[`modelValue`])]),_:1}),K(i,null,{default:W(()=>[K(U,{"hide-details":``,label:`Lieu`,density:`compact`,variant:`outlined`,modelValue:a.value.Lieu,"onUpdate:modelValue":d[1]||=e=>a.value.Lieu=e},null,8,[`modelValue`])]),_:1}),K(i,null,{default:W(()=>[K(U,{"hide-details":``,label:`Numéro d'agrément`,density:`compact`,variant:`outlined`,modelValue:a.value.Agrement,"onUpdate:modelValue":d[2]||=e=>a.value.Agrement=e},null,8,[`modelValue`])]),_:1})]),_:1}),K(G,null,{default:W(()=>[K(i,{"align-self":`center`},{default:W(()=>[K(f,{modelValue:a.value.DateDebut,"onUpdate:modelValue":d[3]||=e=>a.value.DateDebut=e,label:`Date de début`,"hide-details":``},null,8,[`modelValue`])]),_:1}),K(i,{"align-self":`center`},{default:W(()=>[K(m,{label:`Durée (en jours)`,modelValue:a.value.Duree,"onUpdate:modelValue":d[4]||=e=>a.value.Duree=e,"hide-details":``},null,8,[`modelValue`])]),_:1}),K(i,{"align-self":`center`},{default:W(()=>[K(f,{"model-value":M(s).dateFin(a.value),label:`Date de fin`,readonly:``,"hide-details":``},null,8,[`model-value`])]),_:1})]),_:1})]),_:1})]),_:1}),K(D,{class:`my-2`,subtitle:`Prix`},{default:W(()=>[K(B,null,{default:W(()=>[K(G,null,{default:W(()=>[K(i,{"align-self":`center`,cols:`6`},{default:W(()=>[K(h,{label:`Prix`,modelValue:a.value.Prix,"onUpdate:modelValue":d[5]||=e=>a.value.Prix=e,"hide-details":``},null,8,[`modelValue`])]),_:1}),K(i,{"align-self":`center`,cols:`6`,class:`text-center`},{default:W(()=>[K(rt,{"close-on-content-click":!1},{activator:W(({props:e})=>[K(U,p(e,{readonly:``,label:`Option sur le prix`,variant:`outlined`,density:`compact`,"hide-details":``,"model-value":l(a.value)}),null,16,[`model-value`])]),default:W(()=>[K(un,{camp:a.value,"option-prix":a.value.OptionPrix,"onUpdate:optionPrix":d[6]||=e=>a.value.OptionPrix=e,"option-qf":a.value.OptionQuotientFamilial,"onUpdate:optionQf":d[7]||=e=>a.value.OptionQuotientFamilial=e},null,8,[`camp`,`option-prix`,`option-qf`])]),_:1})]),_:1})]),_:1})]),_:1})]),_:1}),K(D,{class:`my-2`,subtitle:`Visibilité et inscriptions`},{default:W(()=>[K(B,null,{default:W(()=>[K(G,null,{default:W(()=>[K(i,{"align-self":`center`},{default:W(()=>[K(it,{label:`Ouverture aux inscriptions`,variant:`outlined`,density:`compact`,items:M(c),"hide-details":``,modelValue:a.value.Statut,"onUpdate:modelValue":d[8]||=e=>a.value.Statut=e},null,8,[`items`,`modelValue`])]),_:1}),K(i,{"align-self":`center`},{default:W(()=>[K(yt,{label:`Inscription externe`,modelValue:a.value.InscriptionExterne,"onUpdate:modelValue":d[9]||=e=>a.value.InscriptionExterne=e,color:`primary`,density:`compact`,"persistent-hint":``,hint:a.value.InscriptionExterne?`Camp externe, uniquement visible sur l'API publique.`:``},null,8,[`modelValue`,`hint`])]),_:1})]),_:1})]),_:1})]),_:1}),K(D,{class:`my-2`,subtitle:`Filtres sur les inscrits`},{default:W(()=>[K(B,null,{default:W(()=>[K(G,null,{default:W(()=>[K(i,{"align-self":`center`},{default:W(()=>[K(m,{modelValue:a.value.Places,"onUpdate:modelValue":d[10]||=e=>a.value.Places=e,label:`Nombre de places`},null,8,[`modelValue`])]),_:1}),K(i,{"align-self":`center`},{default:W(()=>[K(m,{modelValue:a.value.AgeMin,"onUpdate:modelValue":d[11]||=e=>a.value.AgeMin=e,label:`Âge minimum`},null,8,[`modelValue`])]),_:1}),K(i,{"align-self":`center`},{default:W(()=>[K(m,{modelValue:a.value.AgeMax,"onUpdate:modelValue":d[12]||=e=>a.value.AgeMax=e,label:`Âge maximum`},null,8,[`modelValue`])]),_:1})]),_:1}),K(G,null,{default:W(()=>[K(i,null,{default:W(()=>[K(g,{modelValue:a.value.NeedEquilibreGF,"onUpdate:modelValue":d[13]||=e=>a.value.NeedEquilibreGF=e,label:`Equilibre G/F demandé`,density:`compact`,"persistent-hint":``,hint:`Place un inscrit en liste d'attente en cas de déséquilibre Garçons/Filles`},null,8,[`modelValue`])]),_:1})]),_:1})]),_:1})]),_:1}),K(D,{class:`my-2`,subtitle:`Formulaire d'inscription`},{default:W(()=>[K(B,null,{default:W(()=>[K(G,null,{default:W(()=>[K(i,null,{default:W(()=>[K(U,{label:`Image`,density:`compact`,variant:`outlined`,hint:`URL d'une image affichée sur le formulaire d'inscription`,"persistent-hint":``,modelValue:a.value.ImageURL,"onUpdate:modelValue":d[14]||=e=>a.value.ImageURL=e},null,8,[`modelValue`])]),_:1})]),_:1}),K(G,null,{default:W(()=>[K(i,null,{default:W(()=>[K(Gt,{variant:`outlined`,density:`compact`,label:`Description`,hint:`Ce texte est affiché sur le formulaire d'inscription.`,"persistent-hint":``,rows:`3`,modelValue:a.value.Description,"onUpdate:modelValue":d[15]||=e=>a.value.Description=e},null,8,[`modelValue`])]),_:1}),K(i,{cols:`2`},{default:W(()=>[K(g,{label:`Navette`,modelValue:a.value.Navette.Actif,"onUpdate:modelValue":d[16]||=e=>a.value.Navette.Actif=e},null,8,[`modelValue`])]),_:1}),K(i,null,{default:W(()=>[K(Gt,{variant:`outlined`,density:`compact`,label:`Navette`,hint:`Ce texte est affiché sur l'espace personnel de suivi.`,"persistent-hint":``,rows:`3`,disabled:!a.value.Navette.Actif,modelValue:a.value.Navette.Commentaire,"onUpdate:modelValue":d[17]||=e=>a.value.Navette.Commentaire=e},null,8,[`disabled`,`modelValue`])]),_:1})]),_:1}),K(G,null,{default:W(()=>[K(i,null,{default:W(()=>[K(U,{density:`compact`,variant:`outlined`,label:`URL de préselection`,hint:`Cette URL permet de sélectionner automatiquement le séjour sur le formulaire d'inscription.`,"persistent-hint":``,readonly:``,"model-value":n.preselectionUrl},{append:W(()=>[K(N,{icon:`mdi-content-copy`,size:`small`,onClick:u})]),_:1},8,[`model-value`])]),_:1})]),_:1})]),_:1})]),_:1}),K(D,{class:`my-2`,subtitle:`Autre`},{default:W(()=>[K(B,null,{default:W(()=>[K(G,null,{default:W(()=>[K(i,null,{default:W(()=>[K(U,{label:`Mot de passe`,density:`compact`,variant:`outlined`,hint:`Mot de passe d'accès à la page Directeur`,"persistent-hint":``,modelValue:a.value.Password,"onUpdate:modelValue":d[18]||=e=>a.value.Password=e},null,8,[`modelValue`])]),_:1})]),_:1})]),_:1})]),_:1}),K(dn,{"meta-entries-hints":e.metaEntriesHints,modelValue:a.value.Meta,"onUpdate:modelValue":d[19]||=e=>a.value.Meta=e},null,8,[`meta-entries-hints`,`modelValue`])]),_:1}),K(C,null,{default:W(()=>[K(Z),K(N,{disabled:!o.value,onClick:d[20]||=e=>r(`save`,a.value)},{default:W(()=>[...d[21]||=[A(`Enregistrer`,-1)]]),_:1},8,[`disabled`])]),_:1})]),_:1},8,[`subtitle`])}}}),pn=a({__name:`TauxSelect`,props:{modelValue:{required:!0},modelModifiers:{}},emits:[`update:modelValue`],setup(e){k(o);let t=Le(e,`modelValue`),n=R(null),r=w(()=>{let e=Array.from(a.value.values()).map(e=>({title:e.Label,subtitle:e.Description,value:e.Id}));return e.sort((e,t)=>e.title.localeCompare(t.title)),e}),a=R(new Map);async function o(){let e=await Q.CampsGetTaux();e!==void 0&&(a.value=ge(e),t.value.Id>0&&(t.value=b(a.value.get(t.value.Id)),n.value=t.value.Id))}function s(){t.value.Id<=0?(n.value??=1,t.value=b(a.value.get(n.value))):(n.value=null,t.value.Id=0,t.value.Label=``)}function c(e){t.value=b(a.value.get(e))}let u=w(()=>{if(t.value.Id>0)return null;let e=t.value.Label;return Array.from(a.value.values()).map(e=>e.Label).includes(e)?`Ce label est déjà utilisé.`:null});return(e,a)=>(L(),O(G,null,{default:W(()=>[K(i,{"align-self":`center`},{default:W(()=>[t.value.Id>0?(L(),O(it,{key:0,variant:`outlined`,density:`compact`,"hide-details":``,label:`Taux`,items:r.value,modelValue:n.value,"onUpdate:modelValue":[a[0]||=e=>n.value=e,c]},{item:W(({item:e,props:t})=>[K(X,p(t,{title:e.title,subtitle:e.raw.subtitle}),null,16,[`title`,`subtitle`])]),selection:W(({item:e})=>[K(X,{density:`compact`,title:e.title,subtitle:e.raw.subtitle},null,8,[`title`,`subtitle`])]),_:1},8,[`items`,`modelValue`])):(L(),O(G,{key:1},{default:W(()=>[K(i,{cols:`12`},{default:W(()=>[K(U,{variant:`outlined`,density:`compact`,label:`Label`,modelValue:t.value.Label,"onUpdate:modelValue":a[1]||=e=>t.value.Label=e,disabled:t.value.Id>0,"error-messages":u.value},null,8,[`modelValue`,`disabled`,`error-messages`])]),_:1}),K(i,null,{default:W(()=>[K(U,{label:`Valeur d'un ${M(T)[M(ke).FrancsSuisse]}`,density:`compact`,variant:`outlined`,type:`number`,min:`0.001`,suffix:`€`,hint:`Valeur en € d'une unité de la monnaie.`,"persistent-hint":``,"model-value":t.value.FrancsSuisse/1e3,"onUpdate:modelValue":a[2]||=e=>t.value.FrancsSuisse=M(ve)(Number(e)*1e3),disabled:t.value.Id>0},null,8,[`label`,`model-value`,`disabled`])]),_:1})]),_:1}))]),_:1}),K(i,{cols:`auto`},{default:W(()=>[K(q,{thickness:`2`,vertical:``,class:`py-4`},{default:W(()=>[...a[3]||=[A(`ou`,-1)]]),_:1})]),_:1}),K(i,{"align-self":`center`,cols:`auto`},{default:W(()=>[K(N,{onClick:s,"prepend-icon":`mdi-toggle-switch`},{default:W(()=>[A(l(t.value.Id>0?`Créer un taux`:`Utiliser un taux`),1)]),_:1})]),_:1})]),_:1}))}}),mn=a({__name:`CampStats`,props:{stats:{}},setup(e){let t=e;function n(e,t){return`(${P.pourcent(e,t)} %)`}return(e,r)=>(L(),O(D,{title:`Statut des inscriptions`},{default:W(()=>[K(B,null,{default:W(()=>[K(J,{density:`compact`},{default:W(()=>[K(X,{title:`Demandes d'inscriptions`},{append:W(()=>[A(l(t.stats.Inscriptions),1)]),_:1}),K(X,{title:`Filles`,subtitle:`Parmi toutes les demandes d'inscription`},{append:W(()=>[A(l(t.stats.InscriptionsFilles)+` `+l(n(t.stats.InscriptionsFilles,t.stats.Inscriptions)),1)]),_:1}),K(X,{title:`Suisses`,subtitle:`Parmi toutes les demandes d'inscription`},{append:W(()=>[A(l(t.stats.InscriptionsSuisses)+` `+l(n(t.stats.InscriptionsSuisses,t.stats.Inscriptions)),1)]),_:1}),K(X,{title:`Inscriptions confirmées`},{append:W(()=>[A(l(t.stats.Valides)+` `+l(n(t.stats.Valides,t.stats.Inscriptions)),1)]),_:1}),K(X,{title:`Filles`,subtitle:`Parmi les inscriptions confirmées`},{append:W(()=>[A(l(t.stats.ValidesFilles)+` `+l(n(t.stats.ValidesFilles,t.stats.Valides)),1)]),_:1}),K(X,{title:`Suisses`,subtitle:`Parmi les inscriptions confirmées`},{append:W(()=>[A(l(t.stats.ValidesSuisses)+` `+l(n(t.stats.ValidesSuisses,t.stats.Valides)),1)]),_:1}),K(X,{title:`A statuer`},{append:W(()=>[A(l(t.stats.AStatuer)+` `+l(n(t.stats.AStatuer,t.stats.Inscriptions)),1)]),_:1}),K(X,{title:`Demandes d'exception`},{append:W(()=>[A(l(t.stats.Exceptions)+` `+l(n(t.stats.Exceptions,t.stats.Inscriptions)),1)]),_:1}),K(X,{title:`Refus`},{append:W(()=>[A(l(t.stats.Refus)+` `+l(n(t.stats.Refus,t.stats.Inscriptions)),1)]),_:1})]),_:1})]),_:1})]),_:1}))}}),hn={key:0},gn=a({__name:`CampHeaderRow`,props:{camp:{}},emits:[`click`,`edit`,`edit-taux`,`delete`,`show-documents`,`send-sondage`,`add-directeur`],setup(t,{emit:n}){let r=t,a=n,o=w(()=>r.camp.Stats.Inscriptions-r.camp.Stats.Valides),c=R(!1),u=w(()=>{switch(new Date(r.camp.Camp.Camp.DateDebut).getUTCMonth()+1){case 7:case 8:return`rgb(45, 185, 187)`;case 9:case 10:case 11:return`rgb(190, 150, 60)`;case 12:case 1:case 2:case 3:return`rgb(240, 240, 240)`;default:return`rgb(190, 228, 100)`}}),d=R(!1),m=R(0),h=w(()=>{let e=r.camp.ParticipantsFiles||[];if(e.length==0)return 0;let t=0;for(let n of e)n.InscritsCount!=0&&(t+=n.UploadedCount/n.InscritsCount);return Math.round(t/e.length*100)});return(n,g)=>{let _=mt;return L(),y(z,null,[K(D,{color:u.value,"no-gutters":``,onClick:g[6]||=e=>a(`click`),class:`my-1`},{default:W(()=>[K(G,{style:oe({"background-color":u.value}),class:`px-1`,"no-gutters":``,justify:`space-between`},{default:W(()=>[K(i,null,{default:W(()=>[K(X,{title:M(s).label(r.camp.Camp.Camp),subtitle:`ID : ${r.camp.Camp.Camp.Id}`},null,8,[`title`,`subtitle`])]),_:1}),K(i,{"align-self":`center`},{default:W(()=>[A(l(M(s).formatPlage(t.camp.Camp.Camp)),1)]),_:1}),K(i,{cols:`2`,"align-self":`center`},{default:W(()=>[K(Ut,{width:`450px`,location:`left`,"content-class":`pa-0`},{activator:W(({props:t})=>[K(e,p({class:`bg-white border-md border-primary`},t,{max:r.camp.Camp.Camp.Places,"model-value":r.camp.Stats.Valides,height:`36`,rounded:``,color:`primary`}),{default:W(()=>[E(`strong`,null,[A(l(r.camp.Stats.Valides)+`/`+l(r.camp.Camp.Camp.Places)+` `,1),o.value>0?(L(),y(`span`,hn,` (+ `+l(o.value)+`)`,1)):f(``,!0)]),K(H,{class:`ml-2`},{default:W(()=>[...g[12]||=[A(`mdi-account-multiple`,-1)]]),_:1})]),_:1},16,[`max`,`model-value`])]),default:W(()=>[K(mn,{stats:r.camp.Stats},null,8,[`stats`])]),_:1})]),_:1}),K(i,{cols:`1`,"align-self":`center`,class:`px-2`},{default:W(()=>[K(Ut,{width:`600`,location:`left`,"content-class":`pa-0`},{activator:W(({props:t})=>[K(e,p({class:`bg-white border-md border-primary`},t,{max:100,"model-value":h.value,height:`36`,rounded:``,color:`primary`}),{default:W(()=>[E(`strong`,null,l(h.value)+` % `,1),K(H,{class:`ml-2`},{default:W(()=>[...g[13]||=[A(`mdi-file-upload`,-1)]]),_:1})]),_:1},16,[`model-value`])]),default:W(()=>[K(D,{title:`Pièces justificatives`},{default:W(()=>[K(B,null,{default:W(()=>[K(J,null,{default:W(()=>[(L(!0),y(z,null,V(r.camp.ParticipantsFiles,e=>(L(),O(X,{title:e.Title},{append:W(()=>[A(l(e.UploadedCount)+` / `+l(e.InscritsCount)+` (`+l(M(P).pourcent(e.UploadedCount,e.InscritsCount))+` %) `,1)]),_:2},1032,[`title`]))),256))]),_:1})]),_:1})]),_:1})]),_:1})]),_:1}),K(i,{cols:`1`}),K(i,{cols:`auto`,"align-self":`center`},{default:W(()=>[K(rt,null,{activator:W(({props:e})=>[K(N,p(e,{size:`x-small`,class:`mx-1`,icon:`mdi-dots-vertical`}),null,16)]),default:W(()=>[K(J,{density:`compact`},{default:W(()=>[K(X,{"prepend-icon":`mdi-pencil`,onClick:g[0]||=e=>a(`edit`)},{default:W(()=>[...g[14]||=[A(`Modifier les paramètres`,-1)]]),_:1}),K(X,{"prepend-icon":`mdi-currency-eur`,onClick:g[1]||=e=>a(`edit-taux`)},{default:W(()=>[...g[15]||=[A(`Taux de conversion`,-1)]]),_:1}),K(q,{thickness:`1`}),K(X,{"prepend-icon":`mdi-mail`,onClick:g[2]||=e=>a(`show-documents`),title:`Documents`}),K(q,{thickness:`1`}),K(X,{"prepend-icon":`mdi-plus`,onClick:g[3]||=e=>d.value=!0,title:`Ajouter un directeur...`,disabled:r.camp.HasDirecteur},null,8,[`disabled`]),K(q,{thickness:`1`}),K(X,{title:`Se connecter à l'espace directeur`,"prepend-icon":`mdi-open-in-new`,href:r.camp.URLDirecteur,target:`_blank`},null,8,[`href`]),K(q,{thickness:`1`}),K(X,{title:`Envoyer le sondage`,subtitle:`de fin de séjour`,"prepend-icon":`mdi-comment-quote`,onClick:g[4]||=e=>a(`send-sondage`)}),K(q,{thickness:`1`}),K(X,{"prepend-icon":`mdi-delete`,disabled:r.camp.Stats.Inscriptions>0,onClick:g[5]||=e=>c.value=!0},{default:W(()=>[...g[16]||=[A(`Supprimer`,-1)]]),_:1},8,[`disabled`])]),_:1})]),_:1})]),_:1})]),_:1},8,[`style`])]),_:1},8,[`color`]),K($,{modelValue:c.value,"onUpdate:modelValue":g[8]||=e=>c.value=e,"max-width":`600`},{default:W(()=>[K(D,{title:`Confirmer la suppression`},{default:W(()=>[K(B,null,{default:W(()=>[g[17]||=A(` Etes vous certain de supprimer le séjour `,-1),E(`b`,null,l(M(s).label(r.camp.Camp.Camp)),1),g[18]||=A(` ? `,-1),g[19]||=E(`br`,null,null,-1),g[20]||=E(`br`,null,null,-1),g[21]||=A(` Les éventuels `,-1),g[22]||=E(`i`,null,`équipiers`,-1),g[23]||=A(` déclarés sur ce séjour seront aussi supprimés. `,-1),g[24]||=E(`br`,null,null,-1),g[25]||=E(`br`,null,null,-1),g[26]||=A(` Attention, cette opération est irréversible. `,-1)]),_:1}),K(C,null,{default:W(()=>[K(Z),K(N,{color:`red`,onClick:g[7]||=e=>{c.value=!1,a(`delete`)}},{default:W(()=>[...g[27]||=[A(`Supprimer`,-1)]]),_:1})]),_:1})]),_:1})]),_:1},8,[`modelValue`]),K($,{modelValue:d.value,"onUpdate:modelValue":g[11]||=e=>d.value=e,"max-width":`400px`},{default:W(()=>[K(D,{title:`Ajouter un directeur`},{default:W(()=>[K(B,null,{default:W(()=>[K(_,{"initial-personne":``,label:`Directeur`,modelValue:m.value,"onUpdate:modelValue":g[9]||=e=>m.value=e,api:M(Q)},null,8,[`modelValue`,`api`])]),_:1}),K(C,null,{default:W(()=>[K(Z),K(N,{disabled:!m.value,onClick:g[10]||=e=>{d.value=!1,a(`add-directeur`,m.value)}},{default:W(()=>[...g[28]||=[A(`Ajouter`,-1)]]),_:1},8,[`disabled`])]),_:1})]),_:1})]),_:1},8,[`modelValue`])],64)}}}),_n=a({__name:`CampsSelector`,props:F({allCamps:{}},{modelValue:{required:!0},modelModifiers:{}}),emits:[`update:modelValue`],setup(e){let t=e,n=Le(e,`modelValue`),r=w(()=>t.allCamps.map(e=>({title:e.Label,value:e.Id})));return(e,t)=>(L(),O(St,{multiple:``,chips:``,"closable-chips":``,items:r.value,modelValue:n.value,"onUpdate:modelValue":t[0]||=e=>n.value=e},null,8,[`items`,`modelValue`]))}}),vn=a({__name:`DocumentsCard`,props:{camp:{}},setup(e){let t=e;k(r);let n=R(null);async function r(){let e=await Q.CampsDocuments({idCamp:t.camp.Camp.Camp.Id});e!==void 0&&(n.value=e)}return(e,t)=>{let r=jt;return n.value==null?(L(),O(Ee,{key:1,type:`card`})):(L(),O(D,{key:0,title:`Documents`},{default:W(()=>[K(B,null,{default:W(()=>[K(J,null,{default:W(()=>[K(et,null,{default:W(()=>[...t[0]||=[A(`Préférences d'affichage`,-1)]]),_:1}),K(X,null,{default:W(()=>[K(G,{class:`mb-2`},{default:W(()=>[K(i,null,{default:W(()=>[K(Y,{color:n.value.ToShow.LettreDirecteur?`green`:`grey`,"append-icon":n.value.ToShow.LettreDirecteur?`mdi-check`:``},{default:W(()=>[...t[1]||=[A(`Lettre du directeur`,-1)]]),_:1},8,[`color`,`append-icon`])]),_:1}),K(i,null,{default:W(()=>[K(Y,{color:n.value.ToShow.ListeVetements?`green`:`grey`,"append-icon":n.value.ToShow.ListeVetements?`mdi-check`:``},{default:W(()=>[...t[2]||=[A(` Liste de vêtements`,-1)]]),_:1},8,[`color`,`append-icon`])]),_:1}),K(i,null,{default:W(()=>[K(Y,{color:n.value.ToShow.ListeParticipants?`green`:`grey`,"append-icon":n.value.ToShow.ListeParticipants?`mdi-check`:``},{default:W(()=>[...t[3]||=[A(`Liste des participants `,-1)]]),_:1},8,[`color`,`append-icon`])]),_:1})]),_:1})]),_:1}),K(et,null,{default:W(()=>[...t[4]||=[A(`Documents du séjour`,-1)]]),_:1}),(L(!0),y(z,null,V(n.value.Generated,e=>(L(),O(X,{title:e.NomClient},{append:W(()=>[K(r,{"file-key":e.Key,"is-generated-doc":!0},null,8,[`file-key`])]),_:2},1032,[`title`]))),256)),(L(!0),y(z,null,V(n.value.ToRead,e=>(L(),O(X,{title:e.NomClient},{append:W(()=>[K(r,{"file-key":e.Key,"is-generated-doc":!1},null,8,[`file-key`])]),_:2},1032,[`title`]))),256)),(L(!0),y(z,null,V(n.value.ToUploadModeles,e=>(L(),O(X,{title:e.NomClient,subtitle:`Document à remplir`},{append:W(()=>[K(r,{"file-key":e.Key,"is-generated-doc":!1},null,8,[`file-key`])]),_:2},1032,[`title`]))),256))]),_:1})]),_:1})]),_:1}))}}}),yn={key:0,class:`text-center my-4`},bn={key:1},xn=[`href`],Sn=a({__name:`AlbumsPhotosPannel`,setup(t,{emit:n}){k(o);let r=R(null),a=R([]);async function o(){let e=await Q.CampsLoadAlbums();e!==void 0&&(r.value=e,a.value=[])}function c(e){return(r.value?.Camps||[]).find(t=>t.Camp.Id==e)}let u=R(!1),d=w(()=>u.value||!a.value.length||!r.value?!1:a.value.every(e=>c(e).Album.Id==``));async function p(){u.value=!0;let e=await Q.CampsCreateAlbums({IdCamps:a.value});u.value=!1,e!==void 0&&(Oe(e).forEach(([e,t])=>{c(e).Album=t}),Q.showMessage(`Albums photos créés avec succès.`))}let m=w(()=>u.value||!a.value.length||!r.value?!1:a.value.every(e=>c(e).Album.Id!=``)),h=R(!1);async function g(){h.value=!1,u.value=!0;for(let e of a.value)if(await Q.CampsDeleteAlbum({idCamp:e})===void 0)break;u.value=!1,Q.showMessage(`Albums photos supprimés avec succès.`),o()}return(t,n)=>(L(),O(D,{title:`Albums photos`,subtitle:`Seuls les camps en cours sont affichés.`},{append:W(()=>[K(N,{disabled:!d.value,onClick:p,class:`mx-2`},{prepend:W(()=>[K(H,{color:`green`},{default:W(()=>[...n[3]||=[A(`mdi-plus`,-1)]]),_:1})]),default:W(()=>[n[4]||=A(` Créer`,-1)]),_:1},8,[`disabled`]),K(N,{disabled:!m.value,onClick:n[0]||=e=>h.value=!0},{prepend:W(()=>[K(H,{color:`red`},{default:W(()=>[...n[5]||=[A(`mdi-delete`,-1)]]),_:1})]),default:W(()=>[n[6]||=A(` Supprimer`,-1)]),_:1},8,[`disabled`])]),default:W(()=>[u.value?(L(),O(e,{key:0,indeterminate:``})):f(``,!0),K(B,null,{default:W(()=>[r.value==null?(L(),y(`div`,yn,[K(Ie,{indeterminate:``})])):(L(),y(`div`,bn,[K(D,{variant:`outlined`},{default:W(()=>[K(B,null,{default:W(()=>[K(G,null,{default:W(()=>[K(i,null,{default:W(()=>[...n[7]||=[A(`Hébergement des photos`,-1)]]),_:1}),K(i,{class:`text-right`},{default:W(()=>[E(`a`,{href:r.value.HostURL},l(r.value.HostURL),9,xn)]),_:1})]),_:1})]),_:1})]),_:1}),K(J,{selected:a.value,"onUpdate:selected":n[1]||=e=>a.value=e,"select-strategy":`leaf`},{default:W(()=>[(L(!0),y(z,null,V(r.value.Camps,e=>(L(),O(X,{value:e.Camp.Id,title:M(s).label(e.Camp),rounded:``,class:`my-1`},{append:W(()=>[K(Y,{color:e.Album.Id?`success`:void 0},{default:W(()=>[e.Album.Id?(L(),O(Ut,{key:0,activator:`parent`,"content-class":`pa-0`},{default:W(()=>[K(D,{title:`Album photo`,"min-width":`400px`},{default:W(()=>[K(B,null,{default:W(()=>[K(G,null,{default:W(()=>[K(i,{cols:`auto`},{default:W(()=>[...n[8]||=[A(`Nom`,-1)]]),_:1}),K(i,{class:`text-right`},{default:W(()=>[A(l(e.Album.albumName),1)]),_:2},1024)]),_:2},1024),K(G,null,{default:W(()=>[K(i,{cols:`auto`},{default:W(()=>[...n[9]||=[A(`ID`,-1)]]),_:1}),K(i,{class:`text-right`},{default:W(()=>[A(l(e.Album.Id),1)]),_:2},1024)]),_:2},1024),K(G,null,{default:W(()=>[K(i,{cols:`auto`},{default:W(()=>[...n[10]||=[A(`Date de création`,-1)]]),_:1}),K(i,{class:`text-right`},{default:W(()=>[A(l(new Date(e.Album.createdAt).toLocaleDateString(`fr`)),1)]),_:2},1024)]),_:2},1024),K(G,null,{default:W(()=>[K(i,{cols:`auto`},{default:W(()=>[...n[11]||=[A(`Nombre de photos`,-1)]]),_:1}),K(i,{class:`text-right`},{default:W(()=>[A(l(e.Album.assetCount),1)]),_:2},1024)]),_:2},1024)]),_:2},1024)]),_:2},1024)]),_:2},1024)):f(``,!0),A(` `+l(e.Album.Id==``?`Pas d'album`:`Album créé le ${M(P).date(e.Album.createdAt)}`),1)]),_:2},1032,[`color`])]),_:2},1032,[`value`,`title`]))),256))]),_:1},8,[`selected`])]))]),_:1}),K($,{modelValue:h.value,"onUpdate:modelValue":n[2]||=e=>h.value=e,"max-width":`600px`},{default:W(()=>[K(D,{title:`Confirmer la suppression`},{default:W(()=>[K(B,null,{default:W(()=>[...n[12]||=[A(` Confirmez-vous la suppression des albums sélectionnés ? `,-1),E(`br`,null,null,-1),E(`br`,null,null,-1),A(` Les liens de partage ne seront plus valides. `,-1),E(`br`,null,null,-1),A(` Les photos ou vidéos elles-mêmes ne seront pas supprimées. `,-1)]]),_:1}),K(C,null,{default:W(()=>[K(Z),K(N,{color:`red`,onClick:g},{default:W(()=>[...n[13]||=[A(`Supprimer`,-1)]]),_:1})]),_:1})]),_:1})]),_:1},8,[`modelValue`])]),_:1}))}}),Cn=a({__name:`CampsSondagesPannel`,props:{allCamps:{}},emits:[`close`],setup(e,{emit:t}){let n=e,r=t;k(l);let a=R(new Date(Date.now()).getFullYear()),o=w(()=>Array.from(new Set(n.allCamps.map(e=>s.year(e.Camp.Camp))).keys()).sort()),c=R(null);async function l(){let e=await Q.CampsLoadSondages({year:a.value});e!==void 0&&(c.value=e)}let u=R(null),d=w(()=>u.value==null?null:(c.value?.Sondages||{})[u.value]);return(e,t)=>(L(),O(D,{title:`Avis sur les séjours`},{append:W(()=>[K(N,{icon:`mdi-close`,onClick:t[0]||=e=>r(`close`),flat:``})]),default:W(()=>[K(B,null,{default:W(()=>[K(G,null,{default:W(()=>[K(i,{cols:`3`},{default:W(()=>[K(G,null,{default:W(()=>[K(i,{cols:`12`},{default:W(()=>[K(it,{label:`Année`,variant:`outlined`,density:`comfortable`,"hide-details":``,items:o.value,modelValue:a.value,"onUpdate:modelValue":[t[1]||=e=>a.value=e,l]},null,8,[`items`,`modelValue`])]),_:1}),c.value?(L(),O(i,{key:0,cols:`12`},{default:W(()=>[K(J,{selected:u.value,"onUpdate:selected":t[2]||=e=>u.value=e,"select-strategy":`single-leaf`},{default:W(()=>[(L(!0),y(z,null,V(c.value.Camps,e=>(L(),O(X,{rounded:``,title:M(s).label(e),value:e.Id,key:e.Id},{append:W(()=>[K(zt,{inline:``,content:((c.value.Sondages||{})[e.Id].Sondages||[]).length},null,8,[`content`])]),_:2},1032,[`title`,`value`]))),128))]),_:1},8,[`selected`])]),_:1})):f(``,!0)]),_:1})]),_:1}),K(i,{cols:`9`},{default:W(()=>[d.value?(L(),O(Et,{key:0,sondages:d.value},null,8,[`sondages`])):f(``,!0)]),_:1})]),_:1})]),_:1})]),_:1}))}}),wn={key:2},Tn=16,En=a({__name:`CampsList`,emits:[`show-participants`],setup(e,{emit:t}){let n=t;k(h);let r=ze(new Map),a=R(!1),o=ze({pattern:``,openOnly:!1}),c=w(()=>{let e=new Set,t=new Set;for(let n of r.values())for(let r of Object.entries(n.Camp.Camp.Meta||{}))e.add(r[0]),t.add(r[1]);return{keys:Array.from(e.keys()).sort(),values:Array.from(t.keys()).sort()}}),l=w(()=>{let e=re(o.pattern),t=Array.from(r.values()).filter(t=>s.match(t.Camp.Camp,e)&&(!o.openOnly||dt(t.Camp)));return t.sort((e,t)=>{let n=new Date(t.Camp.Camp.DateDebut).valueOf(),r=new Date(e.Camp.Camp.DateDebut).valueOf();return n==r?e.Camp.Camp.Id-t.Camp.Camp.Id:n-r}),t}),u=w(()=>l.value.slice((v.value-1)*Tn,v.value*Tn));function d(){v.value>_.value&&(v.value=_.value)}async function h(){a.value=!0;let e=await Q.CampsGet();a.value=!1,e!==void 0&&(r.clear(),e?.forEach(e=>r.set(e.Camp.Camp.Id,e)))}async function g(){a.value=!0;let e=await Q.CampsCreate();a.value=!1,e!==void 0&&(Q.showMessage(`Camp ajouté avec succès.`),r.set(e.Camp.Camp.Id,e),b.value=e)}let _=w(()=>Math.max(Math.ceil(l.value.length/Tn),1)),v=R(1),b=R(null);async function ee(e){b.value=null,a.value=!0;let t=await Q.CampsUpdate(e);a.value=!1,t!==void 0&&(Q.showMessage(`Séjour modifié avec succès.`),r.get(t.Camp.Id).Camp=t,d())}let x=R(null);async function S(){let e=x.value;if(e==null)return;x.value=null,a.value=!0;let t=await Q.CampsSetTaux({IdCamp:e.Camp.Camp.Id,Taux:e.Taux});if(a.value=!1,t===void 0)return;Q.showMessage(`Taux modifié avec succès.`);let n=r.get(e.Camp.Camp.Id);n.Camp.Camp.IdTaux=t.Id,n.Taux=t}let T=R(!1),E=R(5),te=R({Id:1,Label:``,Euros:0,FrancsSuisse:0}),ne=w(()=>te.value.Id>0||te.value.Label!=``),j=w(()=>new Set(Array.from(r.values()).filter(e=>dt(e.Camp)).map(e=>e.Camp.Camp.IdTaux)).size<=1);async function ie(){T.value=!1,a.value=!0;let e=await Q.CampsCreateMany({Count:E.value,Taux:te.value});a.value=!1,e!==void 0&&(Q.showMessage(`Séjours créés avec succès.`),e?.forEach(e=>r.set(e.Camp.Camp.Id,e)))}async function ae(e){a.value=!0;let t=await Q.CampsDelete({id:e.Camp.Camp.Id});a.value=!1,t!==void 0&&(Q.showMessage(`Séjour supprimé avec succès.`),r.delete(e.Camp.Camp.Id),d())}let oe=R(!1);function se(){P.value=Array.from(r.values()).filter(e=>e.Camp.Camp.Statut!=m.Ouvert).map(e=>e.Camp.Camp.Id),oe.value=!0}let P=R([]);async function ce(){oe.value=!1,P.value.length&&await Q.CampsOuvreInscriptions({Camps:P.value})!==void 0&&(Q.showMessage(`Séjours ouverts aux inscriptions avec succès.`),h())}let le=R(null),F=R(null);async function de(e){F.value={Current:0,Total:10};let t=await Q.EventsSendSondages({idCamp:e});if(t===void 0){F.value=null;return}await qe(t,e=>F.value=e,e=>Q.onError(`Envoi du sondage`,e)),F.value=null,Q.showMessage(`Sondage envoyé avec succès.`)}async function fe(e,t){await Q.CampsCreateEquipier({IdPersonne:e,IdCamp:t,Roles:[ue.Direction]})!==void 0&&(r.get(t).HasDirecteur=!0,Q.showMessage(`Directeur ajouté avec succès.`))}let pe=R(!1),me=R(!1);return(e,t)=>{let m=Nt;return L(),y(z,null,[K(D,{title:`Séjours`,subtitle:r.size,class:`ma-2`},{append:W(()=>[K(G,null,{default:W(()=>[K(i,{"align-self":`center`,style:{width:`240px`}},{default:W(()=>[K(U,{label:`Rechercher`,variant:`outlined`,density:`comfortable`,"hide-details":``,"prepend-inner-icon":`mdi-magnify`,clearable:``,modelValue:o.pattern,"onUpdate:modelValue":[t[0]||=e=>o.pattern=e,t[2]||=e=>d()],"onClick:clear":t[1]||=e=>{o.pattern=``,d()}},null,8,[`modelValue`])]),_:1}),K(q,{vertical:``,thickness:`1`}),K(i,{"align-self":`center`,cols:`auto`},{default:W(()=>[K(rt,null,{activator:W(({props:e})=>[K(N,p(e,{color:`success`,disabled:a.value,"prepend-icon":`mdi-plus`}),{default:W(()=>[...t[21]||=[A(` Créer un séjour `,-1)]]),_:1},16,[`disabled`])]),default:W(()=>[K(J,{density:`compact`},{default:W(()=>[K(X,{onClick:g,title:`Créer un séjour`}),K(X,{title:`Créer plusieurs séjours...`,subtitle:`Permet de choisir les taux de conversion`,onClick:t[3]||=e=>T.value=!0})]),_:1})]),_:1})]),_:1}),K(i,{"align-self":`center`,cols:`auto`},{default:W(()=>[K(N,{flat:``,icon:``,size:`small`},{default:W(()=>[K(H,{icon:`mdi-dots-vertical`}),K(rt,{activator:`parent`},{default:W(()=>[K(J,{density:`compact`},{default:W(()=>[K(X,{title:`Masquer les camps fermés`,subtitle:`N'afficher que les camps ouverts aux inscriptions`,onClick:t[5]||=e=>o.openOnly=!o.openOnly},{prepend:W(()=>[K(at,{class:`mr-2`,modelValue:o.openOnly,"onUpdate:modelValue":t[4]||=e=>o.openOnly=e,density:`compact`,"hide-details":``},null,8,[`modelValue`])]),_:1}),K(q,{thickness:`1`}),K(X,{onClick:t[6]||=e=>pe.value=!0,title:`Configurer les albums photos...`,"prepend-icon":`mdi-image-album`}),K(q,{thickness:`1`}),K(X,{onClick:se,title:`Ouvrir les inscriptions...`,subtitle:`sur plusieurs séjours`,"prepend-icon":`mdi-lock-open`}),K(q,{thickness:`1`}),K(X,{onClick:t[7]||=e=>me.value=!0,title:`Avis sur les séjours...`,"prepend-icon":`mdi-comment-quote`}),K(q,{thickness:`1`}),K(X,{"prepend-icon":`mdi-file-excel`,title:`Exporter`,subtitle:`Participants de l'année courante (format Excel)`,link:``,href:M(Q).CampsDownloadParticipants(new Date().getFullYear(),M(Q).authToken)},null,8,[`href`])]),_:1})]),_:1})]),_:1})]),_:1})]),_:1})]),default:W(()=>[K(B,{class:`mt-4`},{default:W(()=>[j.value?f(``,!0):(L(),O(Kt,{key:0,type:`warning`},{default:W(()=>[...t[22]||=[A(` Attention, les séjours ouverts aux inscriptions ont des taux de conversion incompatibles ! `,-1)]]),_:1})),a.value?(L(),O(Ee,{key:1})):l.value.length==0?(L(),y(`i`,wn,` Aucun camp ne correspond aux filtres actuels. `)):f(``,!0),(L(!0),y(z,null,V(u.value,(e,t)=>(L(),O(gn,{key:t,camp:e,onClick:t=>n(`show-participants`,e),onEdit:t=>b.value=e,onEditTaux:t=>x.value=e,onDelete:t=>ae(e),onShowDocuments:t=>le.value=e,onSendSondage:t=>de(e.Camp.Camp.Id),onAddDirecteur:t=>fe(t,e.Camp.Camp.Id)},null,8,[`camp`,`onClick`,`onEdit`,`onEditTaux`,`onDelete`,`onShowDocuments`,`onSendSondage`,`onAddDirecteur`]))),128)),K(It,{length:_.value,modelValue:v.value,"onUpdate:modelValue":t[8]||=e=>v.value=e},null,8,[`length`,`modelValue`])]),_:1})]),_:1},8,[`subtitle`]),K($,{"model-value":b.value!=null,"onUpdate:modelValue":t[9]||=e=>b.value=null,"max-width":`800px`},{default:W(()=>[b.value==null?f(``,!0):(L(),O(fn,{key:0,camp:b.value.Camp.Camp,"preselection-url":b.value.URLPreselection,"meta-entries-hints":c.value,onSave:ee},null,8,[`camp`,`preselection-url`,`meta-entries-hints`]))]),_:1},8,[`model-value`]),K($,{"model-value":x.value!=null,"onUpdate:modelValue":t[11]||=e=>x.value=null,"max-width":`600`},{default:W(()=>[x.value==null?f(``,!0):(L(),O(D,{key:0,title:`Modifier le taux`,subtitle:`La modification n'est possible que si aucun participant n'est enregistré.`},{default:W(()=>[K(B,null,{default:W(()=>[K(pn,{modelValue:x.value.Taux,"onUpdate:modelValue":t[10]||=e=>x.value.Taux=e},null,8,[`modelValue`])]),_:1}),K(C,null,{default:W(()=>[K(Z),K(N,{disabled:x.value.Stats.Inscriptions>0,onClick:S},{default:W(()=>[...t[23]||=[A(`Modifier`,-1)]]),_:1},8,[`disabled`])]),_:1})]),_:1}))]),_:1},8,[`model-value`]),K($,{modelValue:T.value,"onUpdate:modelValue":t[14]||=e=>T.value=e,"max-width":`600`},{default:W(()=>[K(D,{title:`Créer plusieurs séjours`,subtitle:`Les séjours seront liés au même taux de conversion`},{default:W(()=>[K(B,null,{default:W(()=>[K(G,null,{default:W(()=>[K(i,null,{default:W(()=>[K(m,{label:`Nombre de séjours`,modelValue:E.value,"onUpdate:modelValue":t[12]||=e=>E.value=e},null,8,[`modelValue`])]),_:1})]),_:1}),K(q,{thickness:`2`,class:`my-2`}),K(pn,{modelValue:te.value,"onUpdate:modelValue":t[13]||=e=>te.value=e},null,8,[`modelValue`])]),_:1}),K(C,null,{default:W(()=>[K(Z),K(N,{color:`success`,onClick:ie,disabled:!ne.value},{default:W(()=>[...t[24]||=[A(`Créer`,-1)]]),_:1},8,[`disabled`])]),_:1})]),_:1})]),_:1},8,[`modelValue`]),K($,{modelValue:oe.value,"onUpdate:modelValue":t[16]||=e=>oe.value=e,"max-width":`600`},{default:W(()=>[K(D,{title:`Ouvrir les inscriptions`,subtitle:`Ouvre les inscriptions sur les séjours ci-dessous`},{default:W(()=>[K(B,null,{default:W(()=>[K(_n,{"all-camps":Array.from(r.values()).map(e=>M(s).toItem(e.Camp)),modelValue:P.value,"onUpdate:modelValue":t[15]||=e=>P.value=e},null,8,[`all-camps`,`modelValue`])]),_:1}),K(C,null,{default:W(()=>[K(Z),K(N,{onClick:ce,disabled:!P.value.length},{default:W(()=>[...t[25]||=[A(`Ouvrir`,-1)]]),_:1},8,[`disabled`])]),_:1})]),_:1})]),_:1},8,[`modelValue`]),K($,{"model-value":le.value!=null,"onUpdate:modelValue":t[17]||=e=>le.value=null,"max-width":`800px`},{default:W(()=>[le.value?(L(),O(vn,{key:0,camp:le.value},null,8,[`camp`])):f(``,!0)]),_:1},8,[`model-value`]),K($,{"model-value":F.value!=null,"max-width":`400px`,persistent:``},{default:W(()=>[F.value?(L(),O(pt,{key:0,title:`Envoi du sondage en cours`,current:F.value.Current,total:F.value.Total},null,8,[`current`,`total`])):f(``,!0)]),_:1},8,[`model-value`]),K($,{modelValue:pe.value,"onUpdate:modelValue":t[18]||=e=>pe.value=e,"max-width":`800px`},{default:W(()=>[K(Sn)]),_:1},8,[`modelValue`]),K($,{modelValue:me.value,"onUpdate:modelValue":t[20]||=e=>me.value=e,fullscreen:``},{default:W(()=>[K(Cn,{"all-camps":Array.from(r.values()),onClose:t[19]||=e=>me.value=!1},null,8,[`all-camps`])]),_:1},8,[`modelValue`])],64)}}}),Dn={key:1},On={key:0,class:`text-center font-italic`},kn=a({__name:`CampParticipants`,props:{id:{},idParticipant:{}},setup(e){let t=e;k(async()=>{a(),await u(),d()}),I(()=>t.id,u),I(()=>t.idParticipant,d);let n=R(!1),r=R([]);async function a(){let e=await Q.GetCamps();e!==void 0&&(r.value=e||[])}let o=w(()=>{let e=(c.value?.Participants||[]).map(e=>e);return e.sort(fe.cmp),e}),c=R(null);async function u(){n.value=!0;let e=await Q.CampsLoad({idCamp:t.id});n.value=!1,e!==void 0&&(c.value=e)}function d(){if(t.idParticipant===void 0)return;let e=(c.value?.Participants||[]).find(e=>e.Participant.Id==t.idParticipant);e&&(g.value=b(e))}let p=R(null);async function m(){if(p.value==null||c.value==null)return;let e=await Q.ParticipantsCreate(p.value);p.value=null,e!==void 0&&(Q.showMessage(`Participant créé avec succès.`),c.value.Participants=(c.value.Participants||[]).concat(e),g.value=b(e))}let g=R(null);async function _(e){if(g.value==null||c.value==null)return;let t=await Q.ParticipantsUpdate(e);g.value=null,t!==void 0&&(Q.showMessage(`Participant modifié avec succès.`),u())}let v=R(null);async function ee(){if(v.value==null||c.value==null)return;let e=v.value.Participant.Id,t=await Q.ParticipantsDelete({id:e});v.value=null,t!==void 0&&(Q.showMessage(`Participant supprimé avec succès.`),c.value.Participants=(c.value.Participants||[]).filter(t=>t.Participant.Id!=e))}let x=R(null);async function S(){let e=x.value;e==null||c.value==null||(x.value=null,await Q.ParticipantsMove(e)!==void 0&&(Q.showMessage(`Participant déplacé avec succès.`,void 0,{title:`Aller au nouveau séjour`,action:()=>zr({IdCamp:e.Target,Id:e.Id})}),c.value.Participants=(c.value.Participants||[]).filter(t=>t.Participant.Id!=e.Id)))}let T=R(null);async function te(){if(T.value==null)return;let e=T.value.Participant.Id;T.value=null;let t=await Q.ParticipantsSetPlaceLiberee({id:e});if(t===void 0||(Q.showMessage(`Notification de place libérée envoyée avec succès.`),c.value==null))return;let n=c.value.Participants?.find(t=>t.Participant.Id==e);n.Participant=t}let ne=R(!1);return(e,a)=>{let u=_t,d=ut,b=mt,w=wt,k=xt,re=ft,j=vt;return c.value==null?(L(),O(Ee,{key:1,type:`card`})):(L(),O(D,{key:0,title:`Participants`,subtitle:M(s).label(c.value.Camp.Camp)},{append:W(()=>[K(N,{color:`green`,onClick:a[0]||=e=>p.value={IdCamp:t.id,IdDossier:0,IdPersonne:0},"prepend-icon":`mdi-plus`},{default:W(()=>[...a[11]||=[A(` Ajouter un participant`,-1)]]),_:1}),K(q,{thickness:`1`,class:`mx-1`}),K(N,{icon:``,size:`small`,flat:``},{default:W(()=>[K(H,null,{default:W(()=>[...a[12]||=[A(`mdi-dots-vertical`,-1)]]),_:1}),K(rt,{activator:`parent`},{default:W(()=>[K(J,null,{default:W(()=>[K(X,{"prepend-icon":`mdi-currency-eur`,title:`Suivi du règlement`,onClick:a[1]||=e=>ne.value=!0})]),_:1})]),_:1})]),_:1})]),default:W(()=>[K(B,{class:`mt-4`},{default:W(()=>[n.value?(L(),O(Ee,{key:0,type:`table`})):(L(),y(`div`,Dn,[K(u),o.value.length?f(``,!0):(L(),y(`div`,On,` Aucun participant n'est encore inscrit sur ce séjour. `)),(L(!0),y(z,null,V(o.value,(e,t)=>(L(),O(d,{participant:e,index:t},{actions:W(()=>[K(J,{density:`comfortable`},{default:W(()=>[K(X,{title:`Modifier`,"prepend-icon":`mdi-pencil`,onClick:t=>g.value=e},null,8,[`onClick`]),K(q),K(X,{title:`Changer de camp...`,"prepend-icon":`mdi-file-move`,onClick:t=>x.value={Id:e.Participant.Id,Target:0}},null,8,[`onClick`]),K(X,{title:`Notifier d'une place disponible.`,subtitle:`Envoi un email`,"prepend-icon":`mdi-email-alert`,disabled:e.Participant.Statut==M(me).Inscrit||e.Participant.Statut==M(me).EnAttenteReponse,onClick:t=>T.value=e},null,8,[`disabled`,`onClick`]),K(q),K(X,{title:`Aller à la personne`,subtitle:`(ID : ${e.Personne.Id})`,onClick:t=>M(Ur)(e.Personne.Id)},null,8,[`subtitle`,`onClick`]),K(X,{title:`Aller au dossier`,subtitle:`(ID : ${e.Participant.IdDossier})`,onClick:t=>M(Vr)(e.Participant.IdDossier)},null,8,[`subtitle`,`onClick`]),K(q),K(X,{title:`Supprimer`,"prepend-icon":`mdi-delete`,onClick:t=>v.value=e},null,8,[`onClick`])]),_:2},1024)]),_:2},1032,[`participant`,`index`]))),256))]))]),_:1}),p.value==null?f(``,!0):(L(),O($,{key:0,"model-value":p.value!=null,"onUpdate:modelValue":a[4]||=e=>p.value=null,"max-width":`600px`},{default:W(()=>[K(D,{title:`Créer un participant`},{default:W(()=>[K(B,null,{default:W(()=>[K(G,null,{default:W(()=>[K(i,{cols:`12`},{default:W(()=>[K(b,{label:`Participant`,modelValue:p.value.IdPersonne,"onUpdate:modelValue":a[2]||=e=>p.value.IdPersonne=e,"initial-personne":``,api:{SelectPersonne:M(Q).SelectPersonne.bind(M(Q))}},null,8,[`modelValue`,`api`])]),_:1}),K(i,{cols:`12`},{default:W(()=>[K(w,{modelValue:p.value.IdDossier,"onUpdate:modelValue":a[3]||=e=>p.value.IdDossier=e},null,8,[`modelValue`])]),_:1})]),_:1})]),_:1}),K(C,null,{default:W(()=>[K(Z),K(N,{color:`green`,onClick:m,disabled:!(p.value.IdDossier&&p.value.IdPersonne)},{default:W(()=>[...a[13]||=[A(`Créer`,-1)]]),_:1},8,[`disabled`])]),_:1})]),_:1})]),_:1},8,[`model-value`])),g.value==null?f(``,!0):(L(),O($,{key:1,"model-value":g.value!=null,"onUpdate:modelValue":a[5]||=e=>g.value=null,"max-width":`800px`},{default:W(()=>[K(k,{participant:g.value.Participant,personne:g.value.Personne,api:{SelectPersonne:M(Q).SelectPersonne.bind(M(Q))},onSave:_},null,8,[`participant`,`personne`,`api`])]),_:1},8,[`model-value`])),v.value==null?f(``,!0):(L(),O($,{key:2,"model-value":v.value!=null,"onUpdate:modelValue":a[6]||=e=>v.value=null,"max-width":`600px`},{default:W(()=>[K(D,{title:`Supprimer le participant`},{default:W(()=>[K(B,null,{default:W(()=>[a[14]||=A(` Confirmez-vous la suppression du participant `,-1),E(`b`,null,l(M(h).label(v.value.Personne)),1),a[15]||=A(` ? `,-1),a[16]||=E(`br`,null,null,-1),a[17]||=E(`br`,null,null,-1),a[18]||=A(` Attention, cette opération est irréversible. `,-1)]),_:1}),K(C,null,{default:W(()=>[K(Z),K(N,{color:`red`,onClick:ee},{default:W(()=>[...a[19]||=[A(`Supprimer`,-1)]]),_:1})]),_:1})]),_:1})]),_:1},8,[`model-value`])),x.value==null?f(``,!0):(L(),O($,{key:3,"model-value":x.value!=null,"onUpdate:modelValue":a[8]||=e=>x.value=null,"max-width":`500px`},{default:W(()=>[K(D,{title:`Déplacer le participant`},{default:W(()=>[K(B,null,{default:W(()=>[K(re,{label:`Nouveau séjour`,camps:r.value,modelValue:x.value.Target,"onUpdate:modelValue":a[7]||=e=>x.value.Target=e},null,8,[`camps`,`modelValue`])]),_:1}),K(C,null,{default:W(()=>[K(Z),K(N,{onClick:S,disabled:x.value.Target==t.id||!x.value.Target},{default:W(()=>[...a[20]||=[A(`Déplacer`,-1)]]),_:1},8,[`disabled`])]),_:1})]),_:1})]),_:1},8,[`model-value`])),T.value==null?f(``,!0):(L(),O($,{key:4,"model-value":T.value!=null,"onUpdate:modelValue":a[9]||=e=>T.value=null,"max-width":`500px`},{default:W(()=>[K(D,{title:`Notifier d'une place disponible`},{default:W(()=>[K(B,null,{default:W(()=>[A(` Confirmez-vous l'envoi d'une notification au responsable de `+l(M(h).label(T.value.Personne))+` indiquant qu'une place est disponible ? `,1),a[21]||=E(`br`,null,null,-1),a[22]||=E(`br`,null,null,-1),A(` Le nouveau statut de `+l(T.value.Personne.Prenom)+` sera : `,1),E(`i`,null,l(M(pe)[M(me).EnAttenteReponse]),1),a[23]||=A(`. `,-1)]),_:1}),K(C,null,{default:W(()=>[K(Z),K(N,{onClick:te},{default:W(()=>[...a[24]||=[A(`Notifier`,-1)]]),_:1})]),_:1})]),_:1})]),_:1},8,[`model-value`])),K($,{modelValue:ne.value,"onUpdate:modelValue":a[10]||=e=>ne.value=e,"max-width":`700px`},{default:W(()=>[K(j,{data:c.value},null,8,[`data`])]),_:1},8,[`modelValue`])]),_:1},8,[`subtitle`]))}}}),An=a({__name:`camps`,setup(e){let t=ct(),n=w(()=>Rr(t.currentRoute.value.query)),r=w(()=>n.value.idCamp);function i(e){let n=t.currentRoute.value;t.push({path:n.path,query:{idCamp:e.Camp.Camp.Id}})}function a(){let e=t.currentRoute.value;t.push({path:e.path,query:{}})}return(e,t)=>(L(),y(z,null,[K(rn,{title:`Gestion des séjours`},{default:W(()=>[r.value===null?f(``,!0):(L(),O(N,{key:0,onClick:a,"prepend-icon":`mdi-view-list`},{default:W(()=>[...t[0]||=[A(` Retour à la liste`,-1)]]),_:1}))]),_:1}),r.value===void 0?(L(),O(En,{key:0,onShowParticipants:i})):(L(),O(kn,{key:1,id:r.value,"id-participant":n.value.idParticipant},null,8,[`id`,`id-participant`]))],64))}}),jn=a({__name:`MergeCard`,props:{from:{}},emits:[`merge`],setup(e,{emit:t}){let n=e,r=t,a=R(0),o=R(!0);return(e,t)=>{let s=wt;return L(),O(D,{title:`Fusionner le dossier vers`,subtitle:`Les participants, paiements et messages seront copiés vers le dossier cible.`},{default:W(()=>[K(B,null,{default:W(()=>[K(G,null,{default:W(()=>[K(i,{cols:`12`},{default:W(()=>[K(s,{modelValue:a.value,"onUpdate:modelValue":t[0]||=e=>a.value=e},null,8,[`modelValue`])]),_:1}),K(i,{cols:`12`},{default:W(()=>[K(at,{density:`compact`,label:`Notifier par email`,hint:`Le reponsable du dossier absorbé sera averti du changement d'espace personnel.`,"persistent-hint":``,modelValue:o.value,"onUpdate:modelValue":t[1]||=e=>o.value=e},null,8,[`modelValue`])]),_:1})]),_:1})]),_:1}),K(C,null,{default:W(()=>[K(Z),K(N,{disabled:a.value==0||a.value==n.from,onClick:t[2]||=e=>r(`merge`,{From:n.from,To:a.value,Notifie:o.value})},{default:W(()=>[...t[3]||=[A(`Fusionner`,-1)]]),_:1},8,[`disabled`])]),_:1})]),_:1})}}}),Mn={key:1,class:`text-center font-italic`},Nn={key:2},Pn=a({__name:`PannelInscriptions`,emits:[`goTo`,`empty`],setup(e,{emit:t}){let n=t,r=R(!1);k(async()=>{await a(),i.value.length||n(`empty`)});let i=R([]);async function a(){r.value=!0;let e=await Q.InscriptionsGet();r.value=!1,e!==void 0&&(i.value=e||[])}let o=R(``),c=w(()=>{let e=re(o.value);return i.value.filter(t=>h.match(t.Responsable,e)||t.Participants?.some(t=>h.match(t.Personne,e)||s.match(t.Camp,e)))});async function l(e,t){let n=await Q.InscriptionsIdentifiePersonne({IdDossier:e,Target:t});if(n===void 0)return;Q.showMessage(`Profil identifié avec succès.`);let r=i.value.findIndex(t=>t.Dossier.Id==e);i.value[r]=n}let u=R(null);async function d(e,t){if(!u.value)return;let r=u.value.inscription.Dossier.Id;u.value=null;let a=await Q.InscriptionsValide({IdDossier:r,Statuts:e,SendMail:t});if(a!==void 0)if(a.Dossier.IsValidated)Q.showMessage(`Inscription validée avec succès.`,``,{title:`Aller au dossier`,action:()=>n(`goTo`,r)}),i.value=i.value.filter(e=>e.Dossier.Id!=r);else{Q.showMessage(`Participant validé avec succès.`);let e=i.value.findIndex(e=>e.Dossier.Id==r);i.value[e]=a}}async function p(e){await Q.DossiersDelete({id:e.Dossier.Id})!==void 0&&(Q.showMessage(`Inscription supprimée avec succès.`),i.value=i.value.filter(t=>t.Dossier.Id!=e.Dossier.Id))}async function m(e,t){if(await Q.ParticipantsDelete({id:t})===void 0)return;Q.showMessage(`Participant supprimé avec succès.`);let n=i.value.find(t=>t.Dossier.Id==e);n.Participants=(n.Participants||[]).filter(e=>e.Participant.Id!=t)}let g=R(null);async function _(e){g.value=null,await Q.DossiersMerge(e)!==void 0&&(Q.showMessage(`Inscriptions fusionnées avec succès.`),a())}return(e,t)=>{let n=Ct;return L(),O(D,{title:`Inscriptions`,subtitle:`En attente de validation`,class:`ma-2`},{append:W(()=>[K(U,{width:`300`,"append-inner-icon":`mdi-magnify`,label:`Rechercher`,"hide-details":``,modelValue:o.value,"onUpdate:modelValue":t[0]||=e=>o.value=e},null,8,[`modelValue`])]),default:W(()=>[K(B,null,{default:W(()=>[r.value?(L(),O(Ee,{key:0})):i.value.length?(L(),y(`div`,Nn,[(L(!0),y(z,null,V(c.value,(e,t)=>(L(),O(Tt,{class:`my-1`,user:null,key:t,inscription:e,onIdentifie:t=>l(e.Dossier.Id,t),onValide:t=>u.value={inscription:e,participants:t===void 0?void 0:[t]},onMerge:t=>g.value=e.Dossier.Id,onDelete:t=>p(e),onDeleteParticipant:t=>m(e.Dossier.Id,t),api:{SearchSimilaires:M(Q).InscriptionsSearchSimilaires.bind(M(Q)),SelectPersonne:M(Q).SelectPersonne.bind(M(Q))}},null,8,[`inscription`,`onIdentifie`,`onValide`,`onMerge`,`onDelete`,`onDeleteParticipant`,`api`]))),128))])):(L(),y(`div`,Mn,` Il n'y a aucune inscription à valider. `))]),_:1}),K($,{"model-value":g.value!=null,"onUpdate:modelValue":t[1]||=e=>g.value=null,"max-width":`600px`},{default:W(()=>[g.value==null?f(``,!0):(L(),O(jn,{key:0,from:g.value,onMerge:_},null,8,[`from`]))]),_:1},8,[`model-value`]),K($,{"model-value":u.value!=null,"onUpdate:modelValue":t[2]||=e=>u.value=null,"max-width":`800px`},{default:W(()=>[u.value?(L(),O(n,{key:0,inscription:u.value.inscription,"id-participants":u.value.participants,onValide:d},null,8,[`inscription`,`id-participants`])):f(``,!0)]),_:1},8,[`model-value`])]),_:1})}}}),Fn={class:`text-grey`},In={class:`text-grey`},Ln={key:0},Rn=a({__name:`FactureCard`,props:{dossier:{}},setup(e){let t=e,n=w(()=>(t.dossier.Participants||[]).filter(e=>e.Participant.Statut!=me.Inscrit).map(e=>h.label(e.Personne))),r=w(()=>(t.dossier.Participants||[]).filter(e=>e.Participant.Statut==me.Inscrit).map(e=>({Label:h.label(e.Personne),Camp:s.label(e.Camp),Prix:P.montant(e.Camp.Prix),Bilan:t.dossier.Bilan.Inscrits[e.Participant.Id]})));function a(e){return!!(e.Remises.Famille||e.Remises.Equipiers||e.Remises.Speciale.Cent)}function o(e){let t=[];return e.Famille&&t.push(`Enfants : ${e.Famille}%`),e.Equipiers&&t.push(`Enfants : ${e.Equipiers}%`),e.Speciale.Cent&&t.push(`Remise : ${P.montant(e.Speciale)}`),t.join(`  ;  `)}let c=w(()=>{let e=Object.values(t.dossier.Paiements||{});return e.sort((e,t)=>new Date(e.Time).valueOf()-new Date(t.Time).valueOf()),e});return(e,s)=>(L(),O(D,{title:`Suivi financier`,subtitle:n.value.length?`Les participants en liste d'attente (${n.value.join(`, `)}) ne sont pas pris en compte.`:``,"min-width":`900px`},{default:W(()=>[K(B,null,{default:W(()=>[K(G,null,{default:W(()=>[K(i,{cols:`3`},{default:W(()=>[...s[0]||=[A(`Participant`,-1)]]),_:1}),K(i,{cols:`2`,class:`text-center`},{default:W(()=>[...s[1]||=[A(`Prix du séjour`,-1)]]),_:1}),K(i,{cols:`2`,class:`text-center`},{default:W(()=>[...s[2]||=[A(`Prix avec option`,-1)]]),_:1}),K(i,{cols:`3`,class:`text-center`},{default:W(()=>[...s[3]||=[A(`Aides extérieures`,-1)]]),_:1}),K(i,{cols:`2`,class:`text-right`},{default:W(()=>[...s[4]||=[A(`Sous-total`,-1)]]),_:1})]),_:1}),K(q,{thickness:`1`,class:`my-2`}),(L(!0),y(z,null,V(r.value,e=>(L(),y(z,null,[K(G,null,{default:W(()=>[K(i,{"align-self":`center`,cols:`3`},{default:W(()=>[A(l(e.Label)+` `,1),s[5]||=E(`br`,null,null,-1),E(`span`,Fn,l(e.Camp),1)]),_:2},1024),K(i,{"align-self":`center`,cols:`2`,class:`text-center`},{default:W(()=>[A(l(e.Prix),1)]),_:2},1024),K(i,{"align-self":`center`,cols:`2`,class:`text-center`},{default:W(()=>[A(l(M(P).montant(e.Bilan.AvecOption))+` `,1),s[6]||=E(`br`,null,null,-1),E(`span`,In,l(e.Bilan.AvecOptionDescription),1)]),_:2},1024),K(i,{"align-self":`center`,cols:`3`,class:`text-center`},{default:W(()=>[e.Bilan.Aides?.length?f(``,!0):(L(),y(`span`,Ln,`-`)),(L(!0),y(z,null,V(e.Bilan.Aides,e=>(L(),O(Y,null,{default:W(()=>[A(l(e.Structure)+` : `+l(M(P).montant(e.Montant)),1)]),_:2},1024))),256))]),_:2},1024),K(i,{"align-self":`center`,cols:`2`,class:`text-right`},{default:W(()=>[A(l(e.Bilan.AvecAides),1)]),_:2},1024)]),_:2},1024),a(e.Bilan)?(L(),O(G,{key:0,"no-gutters":``},{default:W(()=>[K(i,{cols:`10`,class:`text-right`},{default:W(()=>[E(`i`,null,l(o(e.Bilan.Remises)),1)]),_:2},1024),K(i,{cols:`2`,class:`text-right`},{default:W(()=>[A(l(e.Bilan.Net),1)]),_:2},1024)]),_:2},1024)):f(``,!0)],64))),256)),K(q,{thickness:`1`,class:`my-2`}),K(G,null,{default:W(()=>[K(i,{cols:`10`,class:`text-right`},{default:W(()=>[...s[7]||=[A(`Total demandé`,-1)]]),_:1}),K(i,{cols:`2`,class:`text-right`},{default:W(()=>[A(l(t.dossier.Bilan.Demande),1)]),_:1})]),_:1}),K(q,{thickness:`1`,class:`my-2`}),(L(!0),y(z,null,V(c.value,e=>(L(),O(G,null,{default:W(()=>[K(i,null,{default:W(()=>[A(` Paiement de `+l(e.Payeur)+`, le `+l(M(P).date(e.Time)),1)]),_:2},1024),K(i,{cols:`2`,class:`text-right`},{default:W(()=>[A(l(e.IsRemboursement?`+`:`-`)+l(M(P).montant(e.Montant)),1)]),_:2},1024)]),_:2},1024))),256)),K(G,null,{default:W(()=>[K(i,{cols:`10`,class:`text-right`},{default:W(()=>[...s[8]||=[A(`Solde`,-1)]]),_:1}),K(i,{cols:`2`,class:`text-right`},{default:W(()=>[E(`b`,null,l(t.dossier.Bilan.Restant),1)]),_:1})]),_:1})]),_:1})]),_:1},8,[`subtitle`]))}});const zn=d({allowedValues:Function,ampm:Boolean,color:String,disabled:Boolean,displayedValue:null,double:Boolean,format:{type:Function,default:e=>e},max:{type:Number,required:!0},min:{type:Number,required:!0},scrollable:Boolean,readonly:Boolean,rotate:{type:Number,default:0},step:{type:Number,default:1},modelValue:{type:Number}},`VTimePickerClock`),Bn=ie()({name:`VTimePickerClock`,props:zn(),emits:{change:e=>!0,input:e=>!0},setup(e,t){let{emit:n}=t,r=R(null),i=R(null),a=R(void 0),o=R(!1),s=R(null),l=R(null),u=Ue(e=>n(`change`,e),750),{textColorClasses:d,textColorStyles:f}=je(()=>e.color),{backgroundColorClasses:p,backgroundColorStyles:m}=te(()=>e.color),h=w(()=>e.max-e.min+1),g=w(()=>e.double?h.value/2:h.value),_=w(()=>360/g.value),v=w(()=>_.value*Math.PI/180),y=w(()=>e.modelValue==null?e.min:e.modelValue),b=w(()=>.62),ee=w(()=>{let t=[];for(let n=e.min;n<=e.max;n+=e.step)t.push(n);return t});I(()=>e.modelValue,e=>{a.value=e});function x(e){a.value!==e&&(a.value=e),n(`input`,e)}function S(t){return!e.allowedValues||e.allowedValues(t)}function C(t){if(!e.scrollable||e.disabled)return;t.preventDefault();let n=Math.sign(-t.deltaY||1),r=y.value;do r+=n,r=(r-e.min+h.value)%h.value+e.min;while(!S(r)&&r!==y.value);r!==e.displayedValue&&x(r),u(r)}function T(t){return e.double&&t-e.min>=g.value}function D(e){return T(e)?b.value:1}function O(t){let n=e.rotate*Math.PI/180;return{x:Math.sin((t-e.min)*v.value+n)*D(t),y:-Math.cos((t-e.min)*v.value+n)*D(t)}}function k(t,n){let r=(Math.round(t/_.value)+(n?g.value:0))%h.value+e.min;return t<360-_.value/2?r:n?e.max-g.value+1:e.min}function ne(e){let{x:t,y:n}=O(e);return{left:`${Math.round(50+t*50)}%`,top:`${Math.round(50+n*50)}%`}}function re(e,t){let n=t.x-e.x,r=t.y-e.y;return Math.sqrt(n*n+r*r)}function A(e,t){let n=2*Math.atan2(t.y-e.y-re(e,t),t.x-e.x);return Math.abs(n*180/Math.PI)}function j(e){s.value===null&&(s.value=e),l.value=e,x(e)}function M(t){if(t.preventDefault(),!o.value&&t.type!==`click`||!r.value)return;let{width:n,top:a,left:s}=r.value?.getBoundingClientRect(),{width:c}=i.value?.getBoundingClientRect()??{width:0},{clientX:l,clientY:u}=`touches`in t?t.touches[0]:t,d={x:n/2,y:-n/2},f={x:l-s,y:a-u},p=Math.round(A(d,f)-e.rotate+360)%360,m=e.double&&re(d,f)<(c+c*b.value)/4,h=Math.ceil(15/_.value),g;for(let e=0;e<h;e++)if(g=k(p+e*_.value,m),S(g)||(g=k(p-e*_.value,m),S(g)))return j(g)}function ie(t){e.disabled||(t.preventDefault(),window.addEventListener(`mousemove`,M),window.addEventListener(`touchmove`,M),window.addEventListener(`mouseup`,ae),window.addEventListener(`touchend`,ae),s.value=null,l.value=null,o.value=!0,M(t))}function ae(e){e.stopPropagation(),N(),o.value=!1,l.value!==null&&S(l.value)&&n(`change`,l.value)}function N(){window.removeEventListener(`mousemove`,M),window.removeEventListener(`touchmove`,M),window.removeEventListener(`mouseup`,ae),window.removeEventListener(`touchend`,ae)}Se(N),Ce(()=>E(`div`,{class:c([{"v-time-picker-clock":!0,"v-time-picker-clock--indeterminate":e.modelValue==null,"v-time-picker-clock--readonly":e.readonly}]),onMousedown:ie,onTouchstart:ie,onWheel:C,ref:r},[E(`div`,{class:`v-time-picker-clock__inner`,ref:i},[E(`div`,{class:c([{"v-time-picker-clock__hand":!0,"v-time-picker-clock__hand--inner":T(e.modelValue)},d.value]),style:oe([{transform:`rotate(${e.rotate+_.value*(y.value-e.min)}deg) scaleY(${D(y.value)})`},f.value])},null),ee.value.map(t=>{let n=t===y.value;return E(`div`,{class:c([{"v-time-picker-clock__item":!0,"v-time-picker-clock__item--active":n,"v-time-picker-clock__item--disabled":e.disabled||!S(t)},n&&p.value]),style:oe([ne(t),n&&m.value])},[E(`span`,null,[e.format(t)])])})])]))}}),Vn=d({active:Boolean,color:String,disabled:Boolean,label:String,modelValue:String,readonly:Boolean},`VTimePickerField`),Hn=ie()({name:`VTimePickerField`,inheritAttrs:!1,props:Vn(),emits:{"update:modelValue":e=>!0},setup(e,t){let{emit:n,attrs:r}=t,{textColorClasses:i,textColorStyles:a}=je(()=>e.color),o=R(),s=_e(!1);function c(e){if([`Backspace`,`Delete`].includes(e.key)){e.preventDefault();let t=e.target;t.value=``,n(`update:modelValue`,null)}}return Ce(()=>E(`div`,null,[K(U,p({ref:o,_as:`VTimePickerField`,autocomplete:`off`,class:[`v-time-picker-controls__time__field`,{"v-time-picker-controls__time__field--active":e.active},e.active?i.value:[]],style:e.active?a.value:[],disabled:e.disabled,variant:`solo-filled`,inputmode:`numeric`,hideDetails:!0,flat:!0,modelValue:e.modelValue??(s.value?``:`--`),"onUpdate:modelValue":e=>n(`update:modelValue`,e),onKeydown:c,onFocus:()=>s.value=!0,onBlur:()=>s.value=!1},r),null),E(`div`,{class:`v-time-picker-controls__field-label`},[e.label])])),xe({},o)}});function Un(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:2;return String(e).padStart(t,`0`)}function Wn(e){return e?(e-1)%12+1:12}function Gn(e,t){return e%12+(t===`pm`?12:0)}function Kn(e){let t=e.replaceAll(/\D/g,``);return t.length>0?Number(t):null}function qn(e,t,n){if(n){if(e===12&&t)return{value:1};if(e===11&&t)return{value:12,togglePeriod:!0};if(e===12&&!t)return{value:11,togglePeriod:!0};if(e===1&&!t)return{value:12}}else{if(e===23&&t)return{value:0};if(e===0&&!t)return{value:23}}return{value:e+(t?1:-1)}}function Jn(e,t){return e===59&&t?0:e===0&&!t?59:e+(t?1:-1)}const Yn=d({ampm:Boolean,color:String,disabled:Boolean,hour:[Number,String],minute:[Number,String],second:[Number,String],period:String,readonly:Boolean,useSeconds:Boolean,value:Number,viewMode:String},`VTimePickerControls`),Xn=ie()({name:`VTimePickerControls`,props:Yn(),emits:{"update:period":e=>!0,"update:viewMode":e=>!0,"update:hour":e=>!0,"update:minute":e=>!0,"update:second":e=>!0},setup(e,t){let{emit:n,slots:r}=t,{t:i}=ye(),a={in:t=>{if(t==null||isNaN(Number(t)))return null;let n=Number(t);return e.ampm?Un(Wn(n)):Un(n)},out:t=>{if(isNaN(Number(t))||t==null||t===``)return null;let n=typeof t==`string`?Kn(t):Number(t);return n===null?null:e.ampm?Gn(n,e.period??`am`):de(n,0,23)}},o=He(e,`hour`,void 0,a.in,a.out),s={in:e=>e!=null&&!isNaN(Number(e))?Un(`${e}`):null,out:e=>{if(isNaN(Number(e))||e==null||e===``)return null;let t=typeof e==`string`?Kn(e):Number(e);return t===null?null:de(t,0,59)}},l=He(e,`minute`,void 0,s.in,s.out),u=He(e,`second`,void 0,s.in,s.out);function d(t){if(![`ArrowUp`,`ArrowDown`].includes(t.key))return;t.preventDefault(),t.stopPropagation();let r=Number(o.value??0),i=e.ampm?e.period??`am`:null,{value:a,togglePeriod:s}=qn(r,t.key===`ArrowUp`,i);o.value=Un(a),s&&n(`update:period`,e.period===`am`?`pm`:`am`)}function f(e){[`ArrowUp`,`ArrowDown`].includes(e.key)&&(e.preventDefault(),e.stopPropagation(),l.value=Jn(Number(l.value),e.key===`ArrowUp`))}function p(e){[`ArrowUp`,`ArrowDown`].includes(e.key)&&(e.preventDefault(),e.stopPropagation(),u.value=Jn(Number(u.value),e.key===`ArrowUp`))}function m(t,n,r){return i=>{if(!i.data)return;let a=i.target,{value:o,selectionStart:s,selectionEnd:c}=a??{};if(Kn(i.data)===null){i.preventDefault();return}let l=o?o.slice(0,s)+i.data+o.slice(c):i.data;if(l.length>2){if(s===c&&c===0&&i.data.trim().startsWith(`0`)){i.preventDefault(),a.value=l.trim().substring(0,2),r(a.value),i.data.trim().length===1&&a.setSelectionRange(1,1);return}if(s===c&&c===1&&o.startsWith(`0`)){i.preventDefault(),a.value=l.trim().substring(0,2),r(a.value);return}let t=e.viewMode===`hour`?e.ampm?12:23:59;if(Kn(l)>t){i.preventDefault(),a.value=Un(String(Kn(i.data)).substring(0,2)),r(a.value);return}}n(t(l))&&i.preventDefault()}}let h=R(),g=R(),_=R();I(()=>e.viewMode,(e,t)=>{switch(t){case`hour`:h.value.blur();break;case`minute`:g.value.blur();break;case`second`:_.value.blur();break}});let v=m(a.out,e=>a.in(e)===o.value,e=>o.value=e),y=m(s.out,e=>s.in(e)===l.value,e=>l.value=e),b=m(s.out,e=>s.in(e)===u.value,e=>u.value=e);return Ce(()=>E(`div`,{class:`v-time-picker-controls`},[E(`div`,{class:c({"v-time-picker-controls__time":!0,"v-time-picker-controls__time--with-ampm":e.ampm,"v-time-picker-controls__time--with-seconds":e.useSeconds})},[K(Hn,{ref:h,active:e.viewMode===`hour`,color:e.color,disabled:e.disabled,label:i(`$vuetify.timePicker.hour`),modelValue:o.value,"onUpdate:modelValue":e=>o.value=e,onKeydown:d,onBeforeinput:v,onFocus:()=>n(`update:viewMode`,`hour`)},null),E(`span`,{class:`v-time-picker-controls__time__separator`},[A(`:`)]),K(Hn,{ref:g,active:e.viewMode===`minute`,color:e.color,disabled:e.disabled,label:i(`$vuetify.timePicker.minute`),modelValue:l.value,"onUpdate:modelValue":e=>l.value=e,onKeydown:f,onBeforeinput:y,onFocus:()=>n(`update:viewMode`,`minute`)},null),e.useSeconds&&E(`span`,{key:`secondsDivider`,class:`v-time-picker-controls__time__separator`},[A(`:`)]),e.useSeconds&&K(Hn,{key:`secondsVal`,ref:_,active:e.viewMode===`second`,color:e.color,disabled:e.disabled,label:i(`$vuetify.timePicker.second`),modelValue:u.value,"onUpdate:modelValue":e=>u.value=e,onKeydown:p,onBeforeinput:b,onFocus:()=>n(`update:viewMode`,`second`)},null),e.ampm&&E(`div`,{class:`v-time-picker-controls__ampm`},[K(N,{active:e.period===`am`,color:e.period===`am`?e.color:void 0,class:c({"v-time-picker-controls__ampm__am":!0,"v-time-picker-controls__ampm__btn":!0,"v-time-picker-controls__ampm__btn__active":e.period===`am`}),disabled:e.disabled,text:i(`$vuetify.timePicker.am`),variant:e.disabled&&e.period===`am`?`elevated`:`tonal`,onClick:()=>e.period===`am`?null:n(`update:period`,`am`)},null),K(N,{active:e.period===`pm`,color:e.period===`pm`?e.color:void 0,class:c({"v-time-picker-controls__ampm__pm":!0,"v-time-picker-controls__ampm__btn":!0,"v-time-picker-controls__ampm__btn__active":e.period===`pm`}),disabled:e.disabled,text:i(`$vuetify.timePicker.pm`),variant:e.disabled&&e.period===`pm`?`elevated`:`tonal`,onClick:()=>e.period===`pm`?null:n(`update:period`,`pm`)},null)])])])),{}}});var Zn=x(24),Qn=x(12),$n=Qn.map(e=>e+12),er=x(60);const tr=d({allowedHours:[Function,Array],allowedMinutes:[Function,Array],allowedSeconds:[Function,Array],disabled:Boolean,format:{type:String,default:`ampm`},max:String,min:String,viewMode:{type:String,default:`hour`},period:{type:String,default:`am`,validator:e=>[`am`,`pm`].includes(e)},modelValue:null,readonly:Boolean,scrollable:Boolean,useSeconds:Boolean,variant:{type:String,default:`dial`},...Be(Bt({title:`$vuetify.timePicker.title`}),[`landscape`]),...Pe()},`VTimePicker`),nr=ie()({name:`VTimePicker`,props:tr(),emits:{"update:hour":e=>!0,"update:minute":e=>!0,"update:period":e=>!0,"update:second":e=>!0,"update:modelValue":e=>!0,"update:viewMode":e=>!0},setup(e,t){let{emit:n,slots:r}=t,{t:i}=ye(),{densityClasses:a}=Te(e),o=R(null),s=R(null),c=R(null),l=R(null),u=R(null),d=R(null),f=He(e,`period`,`am`),m=He(e,`viewMode`,`hour`),h=R(null),g=R(null),_=w(()=>{let t;if(t=e.allowedHours instanceof Array?t=>e.allowedHours.includes(t):e.allowedHours,!e.min&&!e.max)return t;let n=e.min?Number(e.min.split(`:`)[0]):0,r=e.max?Number(e.max.split(`:`)[0]):23;return e=>e>=Number(n)&&e<=Number(r)&&(!t||t(e))}),v=w(()=>{let t,n=!_.value||o.value===null||_.value(o.value);if(t=e.allowedMinutes instanceof Array?t=>e.allowedMinutes.includes(t):e.allowedMinutes,!e.min&&!e.max)return n?t:()=>!1;let[r,i]=e.min?e.min.split(`:`).map(Number):[0,0],[a,s]=e.max?e.max.split(`:`).map(Number):[23,59],c=r*60+Number(i),l=a*60+Number(s);return e=>{let r=60*o.value+e;return r>=c&&r<=l&&n&&(!t||t(e))}}),y=w(()=>{let t,n=(!_.value||o.value===null||_.value(o.value))&&(!v.value||s.value===null||v.value(s.value));if(t=e.allowedSeconds instanceof Array?t=>e.allowedSeconds.includes(t):e.allowedSeconds,!e.min&&!e.max)return n?t:()=>!1;let[r,i,a]=e.min?e.min.split(`:`).map(Number):[0,0,0],[c,l,u]=e.max?e.max.split(`:`).map(Number):[23,59,59],d=r*3600+i*60+Number(a||0),f=c*3600+l*60+Number(u||0);return e=>{let r=3600*o.value+60*s.value+e;return r>=d&&r<=f&&n&&(!t||t(e))}}),b=w(()=>e.format===`ampm`),ee=Qe(()=>e.modelValue!==null&&o.value===null&&s.value===null&&(!e.useSeconds||c.value===null));function x(){let t=S();t!==null&&t!==e.modelValue&&n(`update:modelValue`,t),ee.value&&n(`update:modelValue`,null)}I(o,x),I(s,x),I(c,x),I(()=>e.period,e=>D(e)),I(()=>e.modelValue,e=>C(e)),I(()=>e.useSeconds,(e,t)=>{t&&!e&&m.value===`second`&&(m.value=`minute`),!e&&c.value!==null&&(c.value=null)}),k(()=>{C(e.modelValue)});function S(){return o.value!=null&&s.value!=null&&(!e.useSeconds||c.value!=null)?`${Un(o.value)}:${Un(s.value)}`+(e.useSeconds?`:${Un(c.value)}`:``):null}function C(e){if(e==null||e===``)o.value=null,s.value=null,c.value=null;else if(e instanceof Date)o.value=e.getHours(),s.value=e.getMinutes(),c.value=e.getSeconds();else{let[t,,n,,r,i]=e.trim().toLowerCase().match(/^(\d+):(\d+)(:(\d+))?([ap]m)?$/)||[,,,,,,];o.value=i?Gn(parseInt(t,10),i):parseInt(t,10),s.value=parseInt(n,10),c.value=parseInt(r||0,10)}f.value=o.value==null||o.value<12?`am`:`pm`}function T(e,t){let n=e===`hour`?_.value:e===`minute`?v.value:y.value;if(!n)return t;let r=e===`minute`||e===`second`?er:b.value?t<12?Qn:$n:Zn;return((r.find(e=>n((e+t)%r.length+r[0]))||0)+t)%r.length+r[0]}function D(e){return f.value=e,o.value!=null&&(o.value=T(`hour`,o.value+(f.value===`am`?-12:12))),n(`update:period`,e),x(),!0}function te(e){m.value===`hour`?o.value=b.value?Gn(e,f.value):e:m.value===`minute`?s.value=e:c.value=e}function O(t){switch(m.value||`hour`){case`hour`:n(`update:hour`,t);break;case`minute`:n(`update:minute`,t);break;case`second`:n(`update:second`,t);break;default:break}let r=o.value!==null&&s.value!==null&&(e.useSeconds?c.value!==null:!0);m.value===`hour`?m.value=`minute`:e.useSeconds&&m.value===`minute`&&(m.value=`second`),!(o.value===l.value&&s.value===u.value&&(!e.useSeconds||c.value===d.value))&&S()!==null&&(l.value=o.value,u.value=s.value,e.useSeconds&&(d.value=c.value),r&&x())}Ce(()=>{let t=Be(Vt.filterProps(e),[`hideHeader`]),n=Xn.filterProps(e),l=Bn.filterProps(Be(e,[`format`,`modelValue`,`min`,`max`]));return K(Vt,p(t,{color:void 0,class:[`v-time-picker`,`v-time-picker--variant-${e.variant}`,e.class,a.value],hideHeader:e.hideHeader&&e.variant!==`input`,style:e.style}),{title:()=>r.title?.()??E(`div`,{class:`v-time-picker__title`},[i(e.title)]),header:()=>K(Xn,p(n,{ampm:b.value,hour:o.value,minute:s.value,period:f.value,second:c.value,viewMode:m.value,"onUpdate:hour":e=>o.value=e,"onUpdate:minute":e=>s.value=e,"onUpdate:period":e=>D(e),"onUpdate:second":e=>c.value=e,"onUpdate:viewMode":e=>m.value=e,ref:h}),null),default:()=>K(Bn,p(l,{allowedValues:m.value===`hour`?_.value:m.value===`minute`?v.value:y.value,double:m.value===`hour`&&!b.value,format:m.value===`hour`?b.value?Wn:e=>e:e=>Un(e,2),max:m.value===`hour`?b.value&&f.value===`am`?11:23:59,min:m.value===`hour`&&b.value&&f.value===`pm`?12:0,size:20,step:m.value===`hour`?1:5,modelValue:m.value===`hour`?o.value:m.value===`minute`?s.value:c.value,onChange:O,onInput:te,ref:g}),null),actions:r.actions})})}});var rr=Ht(a({__name:`TimeField`,props:F({hideDetails:{type:Boolean},readonly:{type:Boolean}},{modelValue:{required:!0},modelModifiers:{}}),emits:[`update:modelValue`],setup(e){let t=e,n=Le(e,`modelValue`),r=w(()=>new Date(n.value).toLocaleTimeString(void 0,{hour:`numeric`,minute:`numeric`}));function a(e){let[t,r]=e.split(`:`),i=new Date(n.value);i.setHours(Number(t),Number(r)),n.value=i.toISOString()}function o(e){let t=new Date(e),r=new Date(n.value);t.setHours(r.getHours(),r.getMinutes(),r.getSeconds()),n.value=t.toISOString()}let s=R(!1);return(e,c)=>{let l=Lt;return L(),O(G,{"no-gutters":``},{default:W(()=>[K(i,null,{default:W(()=>[K(l,{class:`mr-2`,label:`Date`,"model-value":M(Ne)(new Date(n.value)),"onUpdate:modelValue":o,"hide-details":t.hideDetails,readonly:t.readonly},null,8,[`model-value`,`hide-details`,`readonly`])]),_:1}),K(i,{cols:`auto`},{default:W(()=>[...c[1]||=[E(`div`,{class:`ma-2`},null,-1)]]),_:1}),K(i,null,{default:W(()=>[K(rt,{"close-on-content-click":!1,modelValue:s.value,"onUpdate:modelValue":c[0]||=e=>s.value=e},{activator:W(({props:e})=>[K(U,p({class:`center-text`},e,{variant:`outlined`,density:`compact`,"hide-details":t.hideDetails,label:`Moment`,"model-value":r.value}),null,16,[`hide-details`,`model-value`])]),default:W(()=>[K(nr,{"model-value":new Date(n.value),"onUpdate:modelValue":a,format:`24hr`},null,8,[`model-value`])]),_:1},8,[`modelValue`])]),_:1})]),_:1})}}}),[[`__scopeId`,`data-v-32955f86`]]),ir=a({__name:`PaiementEditCard`,props:{paiement:{}},emits:[`update`,`delete`],setup(e,{emit:t}){let n=e,r=t,a=R(b(n.paiement)),o=w(()=>!0),s=R(!1);return(e,t)=>{let n=Rt,c=Ft,l=rr;return L(),O(D,{title:`Modifier le paiement`},{default:W(()=>[K($,{modelValue:s.value,"onUpdate:modelValue":t[1]||=e=>s.value=e,"max-width":`400px`},{default:W(()=>[K(D,{title:`Confirmation`},{default:W(()=>[K(B,null,{default:W(()=>[...t[11]||=[A(` Confirmez-vous la suppression de ce paiement ? `,-1),E(`br`,null,null,-1),E(`br`,null,null,-1),A(` Attention, cette opération est irréversible. `,-1)]]),_:1}),K(C,null,{default:W(()=>[K(Z),K(N,{color:`red`,onClick:t[0]||=e=>{s.value=!1,r(`delete`)}},{default:W(()=>[...t[12]||=[A(`Supprimer`,-1)]]),_:1})]),_:1})]),_:1})]),_:1},8,[`modelValue`]),K(B,null,{default:W(()=>[K(G,null,{default:W(()=>[K(i,null,{default:W(()=>[K(U,{density:`compact`,variant:`outlined`,"hide-details":``,label:`Payé par`,modelValue:a.value.Payeur,"onUpdate:modelValue":t[2]||=e=>a.value.Payeur=e},null,8,[`modelValue`])]),_:1}),K(i,null,{default:W(()=>[K(U,{density:`compact`,variant:`outlined`,"hide-details":``,label:`Description (optionelle)`,modelValue:a.value.Label,"onUpdate:modelValue":t[3]||=e=>a.value.Label=e},null,8,[`modelValue`])]),_:1})]),_:1}),K(G,null,{default:W(()=>[K(i,null,{default:W(()=>[K(n,{modelValue:a.value.Mode,"onUpdate:modelValue":t[4]||=e=>a.value.Mode=e,"hide-details":``},null,8,[`modelValue`])]),_:1}),K(i,null,{default:W(()=>[K(c,{label:`Montant`,modelValue:a.value.Montant,"onUpdate:modelValue":t[5]||=e=>a.value.Montant=e,"hide-details":``},null,8,[`modelValue`])]),_:1})]),_:1}),K(G,null,{default:W(()=>[K(i,null,{default:W(()=>[K(at,{"hide-details":``,density:`compact`,label:`Remboursement ?`,modelValue:a.value.IsRemboursement,"onUpdate:modelValue":t[6]||=e=>a.value.IsRemboursement=e},null,8,[`modelValue`])]),_:1})]),_:1}),K(G,null,{default:W(()=>[K(i,null,{default:W(()=>[K(l,{modelValue:a.value.Time,"onUpdate:modelValue":t[7]||=e=>a.value.Time=e,"hide-details":``},null,8,[`modelValue`])]),_:1})]),_:1}),K(G,null,{default:W(()=>[K(i,null,{default:W(()=>[K(U,{density:`compact`,variant:`outlined`,label:`Détails (optionnel)`,modelValue:a.value.Details,"onUpdate:modelValue":t[8]||=e=>a.value.Details=e},null,8,[`modelValue`])]),_:1})]),_:1})]),_:1}),K(C,null,{default:W(()=>[K(N,{color:`red`,onClick:t[9]||=e=>s.value=!0},{default:W(()=>[...t[13]||=[A(`Supprimer le paiement`,-1)]]),_:1}),K(Z),K(N,{onClick:t[10]||=e=>r(`update`,a.value),disabled:!o.value},{default:W(()=>[...t[14]||=[A(`Enregistrer`,-1)]]),_:1},8,[`disabled`])]),_:1})]),_:1})}}}),ar=a({__name:`DossierEditCard`,props:{responsable:{},dossier:{}},emits:[`save`],setup(e,{emit:t}){let n=e,r=t,a=R(b(n.dossier));return(e,t)=>{let o=mt,s=Zt,c=on;return L(),O(D,null,{default:W(()=>[K(B,null,{default:W(()=>[K(G,null,{default:W(()=>[K(i,null,{default:W(()=>[K(o,{label:`Responsable`,"initial-personne":n.responsable,"model-value":a.value.IdResponsable,"onUpdate:modelValue":t[0]||=e=>e?a.value.IdResponsable=e:void 0,api:{SelectPersonne:M(Q).SelectPersonne.bind(M(Q))}},null,8,[`initial-personne`,`model-value`,`api`])]),_:1})]),_:1}),K(G,null,{default:W(()=>[K(i,null,{default:W(()=>[K(s,{label:`Adresses mail en copie`,modelValue:a.value.CopiesMails,"onUpdate:modelValue":t[1]||=e=>a.value.CopiesMails=e,rule:M(v).validMails()},null,8,[`modelValue`,`rule`])]),_:1})]),_:1}),K(G,null,{default:W(()=>[K(i,null,{default:W(()=>[K(c,{"hide-details":``,modelValue:a.value.PartageAdressesOK,"onUpdate:modelValue":t[2]||=e=>a.value.PartageAdressesOK=e,label:`Partage des coordonnées`},null,8,[`modelValue`])]),_:1})]),_:1}),K(G,null,{default:W(()=>[K(i,null,{default:W(()=>[K(c,{"hide-details":``,modelValue:a.value.DemandeFondSoutien,"onUpdate:modelValue":t[3]||=e=>a.value.DemandeFondSoutien=e,label:`Demande le fonds de soutien`},null,8,[`modelValue`])]),_:1})]),_:1})]),_:1}),K(C,null,{default:W(()=>[K(Z),K(N,{onClick:t[4]||=e=>r(`save`,a.value)},{default:W(()=>[...t[5]||=[A(`Enregistrer`,-1)]]),_:1})]),_:1})]),_:1})}}}),or=a({__name:`OptionJournee`,props:F({camp:{}},{modelValue:{required:!0},modelModifiers:{}}),emits:[`update:modelValue`],setup(e){let t=e,n=Le(e,`modelValue`),r=w(()=>(t.camp.OptionPrix.Jours||[]).map((e,t)=>t));return(e,i)=>(L(),O(D,null,{default:W(()=>[K(B,null,{default:W(()=>[i[1]||=E(`div`,{class:`text-grey mb-2`},` Le prix est variable en fonction des jours de participation au camp. `,-1),K(Re,{class:`overflow-x-auto`,color:`primary`,multiple:``,"model-value":n.value?.length?n.value:r.value,"onUpdate:modelValue":i[0]||=e=>n.value=e.length==r.value.length?[]:e},{default:W(()=>[(L(!0),y(z,null,V(t.camp.OptionPrix.Jours,(e,t)=>(L(),O(N,null,{default:W(()=>[A(`J `+l(t+1),1)]),_:2},1024))),256))]),_:1},8,[`model-value`])]),_:1})]),_:1}))}}),sr=a({__name:`OptionStatut`,props:F({camp:{}},{modelValue:{required:!0},modelModifiers:{}}),emits:[`update:modelValue`],setup(e){let t=e,n=Le(e,`modelValue`),r=w(()=>(t.camp.OptionPrix.Statuts||[]).map(e=>({value:e.Id,title:e.Label,subtitle:e.Description}))),i=w(()=>r.value.map(e=>e.value).includes(n.value));return(e,t)=>(L(),O(D,null,{default:W(()=>[K(B,null,{default:W(()=>[t[1]||=E(`div`,{class:`text-grey mb-4`},`Le prix dépend du statut du participant.`,-1),K(it,{clearable:``,items:r.value,label:`Statut`,"model-value":i.value?n.value:null,"onUpdate:modelValue":t[0]||=e=>n.value=e??0,variant:`outlined`,density:`comfortable`,"hide-details":``},{item:W(({item:e,props:t})=>[K(X,p(t,{title:e.title,subtitle:e.raw.subtitle}),null,16,[`title`,`subtitle`])]),_:1},8,[`items`,`model-value`])]),_:1})]),_:1}))}}),cr={key:2},lr=a({__name:`ParticipantOptionPrix`,props:{camp:{},optionAndQf:{}},emits:[`update`],setup(e,{emit:t}){let n=e,r=t,a=R(b(n.optionAndQf));return I(()=>n.optionAndQf,()=>a.value=b(n.optionAndQf)),(e,t)=>{let o=Nt;return L(),O(D,{title:`Prix variable`,width:`800px`},{default:W(()=>[K(B,null,{default:W(()=>[K(G,{justify:`space-evenly`},{default:W(()=>[K(i,{"align-self":`center`,cols:`3`},{default:W(()=>[K(o,{modelValue:a.value.quotientFamilial,"onUpdate:modelValue":t[0]||=e=>a.value.quotientFamilial=e,label:`Quotient familial`,"hide-details":``},null,8,[`modelValue`])]),_:1}),K(q,{thickness:`2`,vertical:``}),K(i,{"align-self":`center`,cols:`8`},{default:W(()=>[n.camp.OptionPrix.Active==M(j).PrixJour?(L(),O(or,{key:0,camp:n.camp,modelValue:a.value.options.Jour,"onUpdate:modelValue":t[1]||=e=>a.value.options.Jour=e},null,8,[`camp`,`modelValue`])):n.camp.OptionPrix.Active==M(j).PrixStatut?(L(),O(sr,{key:1,camp:n.camp,modelValue:a.value.options.IdStatut,"onUpdate:modelValue":t[2]||=e=>a.value.options.IdStatut=e},null,8,[`camp`,`modelValue`])):(L(),y(`div`,cr,`Le camp ne propose pas d'option sur le prix.`))]),_:1})]),_:1})]),_:1}),K(C,null,{default:W(()=>[K(Z),K(N,{onClick:t[3]||=e=>r(`update`,a.value)},{default:W(()=>[...t[4]||=[A(`Enregistrer`,-1)]]),_:1})]),_:1})]),_:1})}}}),ur={key:1,class:`mx-1`},dr={key:2,class:`mx-1`},fr={key:3},pr={key:4,class:`mx-1`},mr=Ht(a({__name:`RemisesChip`,props:{remises:{}},emits:[`update`],setup(e,{emit:t}){let n=e,r=t,a=w(()=>o.value.Famille!=0||o.value.Equipiers!=0||o.value.Speciale.Cent!=0),o=R(b(n.remises));I(()=>n.remises,()=>o.value=b(n.remises));let s=R(!1);return(e,t)=>{let n=Nt,c=Ft;return L(),O(rt,{"close-on-content-click":!1,location:`bottom`,modelValue:s.value,"onUpdate:modelValue":t[4]||=e=>s.value=e},{activator:W(({props:e})=>[K(D,p(e,{elevation:`1`,color:`grey-lighten-2`}),{default:W(()=>[K(B,{class:`py-1 px-1`},{default:W(()=>[a.value?f(``,!0):(L(),y(z,{key:0},[A(` Pas de remises `)],64)),o.value.Famille?(L(),y(`span`,ur,` Inscrits : `+l(o.value.Famille)+`% `,1)):f(``,!0),o.value.Equipiers?(L(),y(`span`,dr,` Equipiers : `+l(o.value.Equipiers)+`% `,1)):f(``,!0),(o.value.Famille||o.value.Equipiers)&&o.value.Speciale.Cent?(L(),y(`br`,fr)):f(``,!0),o.value.Speciale.Cent?(L(),y(`span`,pr,` Remise : `+l(M(P).montant(o.value.Speciale)),1)):f(``,!0)]),_:1})]),_:1},16)]),default:W(()=>[K(D,{title:`Modifier les remises`,width:`400px`},{default:W(()=>[K(B,null,{default:W(()=>[K(G,null,{default:W(()=>[K(i,null,{default:W(()=>[K(n,{modelValue:o.value.Famille,"onUpdate:modelValue":t[0]||=e=>o.value.Famille=e,label:`Remise inscrits`,"hide-details":``,suffix:`%`},null,8,[`modelValue`])]),_:1}),K(i,null,{default:W(()=>[K(n,{modelValue:o.value.Equipiers,"onUpdate:modelValue":t[1]||=e=>o.value.Equipiers=e,label:`Remise équipiers`,"hide-details":``,suffix:`%`},null,8,[`modelValue`])]),_:1})]),_:1}),K(G,null,{default:W(()=>[K(i,null,{default:W(()=>[K(c,{class:`mt-2`,modelValue:o.value.Speciale,"onUpdate:modelValue":t[2]||=e=>o.value.Speciale=e,label:`Remise spéciale`,"hide-details":``},null,8,[`modelValue`])]),_:1})]),_:1})]),_:1}),K(C,null,{default:W(()=>[K(Z),K(N,{onClick:t[3]||=e=>{r(`update`,o.value),s.value=!1}},{default:W(()=>[...t[5]||=[A(`Enregistrer`,-1)]]),_:1})]),_:1})]),_:1})]),_:1},8,[`modelValue`])}}}),[[`__scopeId`,`data-v-06eacfe8`]]),hr=a({__name:`AideEditCard`,props:{aide:{},file:{},structures:{},participant:{}},emits:[`save`,`deleteFile`,`uploadFile`,`showStructureaides`],setup(e,{emit:t}){let n=e,r=t,a=R(b(n.aide)),o=w(()=>Object.values(n.structures).map(e=>({value:e.Id,title:e.Nom})));return(e,t)=>{let c=on,l=Ft,u=Nt,d=en;return L(),O(D,{title:`Modifier l'aide extérieure`,subtitle:`pour ${M(h).label(n.participant.Personne)} - ${M(s).label(n.participant.Camp)}`},{append:W(()=>[K(N,{onClick:t[0]||=e=>r(`showStructureaides`)},{default:W(()=>[K(H,null,{default:W(()=>[...t[9]||=[A(`mdi-view-list`,-1)]]),_:1}),t[10]||=A(` Structures`,-1)]),_:1})]),default:W(()=>[K(B,null,{default:W(()=>[K(G,null,{default:W(()=>[K(i,null,{default:W(()=>[K(it,{variant:`outlined`,density:`comfortable`,label:`Structure`,items:o.value,modelValue:a.value.IdStructureaide,"onUpdate:modelValue":t[1]||=e=>a.value.IdStructureaide=e},null,8,[`items`,`modelValue`])]),_:1}),K(i,null,{default:W(()=>[K(c,{modelValue:a.value.Valide,"onUpdate:modelValue":t[2]||=e=>a.value.Valide=e,label:`Aide validée`,"hide-details":``},null,8,[`modelValue`])]),_:1})]),_:1}),K(G,null,{default:W(()=>[K(i,{"align-self":`center`},{default:W(()=>[K(l,{modelValue:a.value.Valeur,"onUpdate:modelValue":t[3]||=e=>a.value.Valeur=e,label:`Montant`,"hide-details":``},null,8,[`modelValue`])]),_:1}),K(i,{"align-self":`center`,cols:`auto`},{default:W(()=>[K(c,{"hide-details":``,label:`Par jour`,modelValue:a.value.ParJour,"onUpdate:modelValue":t[4]||=e=>a.value.ParJour=e},null,8,[`modelValue`])]),_:1}),K(i,{"align-self":`center`},{default:W(()=>[K(u,{label:`Limite`,suffix:`jours`,modelValue:a.value.NbJoursMax,"onUpdate:modelValue":t[5]||=e=>a.value.NbJoursMax=e,disabled:!a.value.ParJour,hint:`0 pour ne pas limiter`,min:0,"persistent-hint":``},null,8,[`modelValue`,`disabled`])]),_:1})]),_:1}),K(d,{class:`mt-4`,files:n.file?[n.file]:[],title:`Document justificatif`,"max-docs":1,"in-upload":!1,onDelete:t[6]||=e=>r(`deleteFile`),onUpload:t[7]||=e=>r(`uploadFile`,e)},null,8,[`files`])]),_:1}),K(C,null,{default:W(()=>[K(Z),K(N,{onClick:t[8]||=e=>r(`save`,a.value)},{default:W(()=>[...t[11]||=[A(`Enregistrer`,-1)]]),_:1})]),_:1})]),_:1},8,[`subtitle`])}}}),gr=a({__name:`StructuresPannel`,props:{modelValue:{required:!0},modelModifiers:{}},emits:[`update:modelValue`],setup(e){let t=Le(e,`modelValue`),n=w(()=>Object.values(t.value||{}).sort((e,t)=>e.Nom.localeCompare(t.Nom)));async function r(){let e=await Q.StructureaideCreate();if(e===void 0)return;Q.showMessage(`Structure créée avec succès.`);let n=t.value||{};n[e.Id]=e,t.value=n,a.value=e}let a=R(null);async function o(){let e=a.value;if(e==null||(a.value=null,await Q.StructureaideUpdate(e)===void 0))return;Q.showMessage(`Structure modifiée avec succès.`);let n=t.value||{};n[e.Id]=e,t.value=n}let s=R(null);async function c(){let e=s.value;if(e==null||(s.value=null,await Q.StructureaideDelete({id:e.Id})===void 0))return;let n=t.value||{};delete n[e.Id],t.value=n,Q.showMessage(`Structure supprimée avec succès.`)}return(e,t)=>(L(),O(D,{title:`Structures d'aide`,subtitle:`Organismes pouvant distribuer une aide extérieure`},{append:W(()=>[K(N,{onClick:r},{prepend:W(()=>[K(H,{color:`green`},{default:W(()=>[...t[5]||=[A(`mdi-plus`,-1)]]),_:1})]),default:W(()=>[t[6]||=A(` Ajouter une structure `,-1)]),_:1})]),default:W(()=>[K(B,{class:`overflow-y-auto`},{default:W(()=>[(L(!0),y(z,null,V(n.value,e=>(L(),O(G,null,{default:W(()=>[K(i,{"align-self":`center`},{default:W(()=>[K(ot,null,{default:W(()=>[A(l(e.Nom),1)]),_:2},1024),K(tt,null,{default:W(()=>[A(l(e.Immatriculation),1)]),_:2},1024)]),_:2},1024),K(i,{"align-self":`center`,style:{"font-size":`smaller`}},{default:W(()=>[(L(!0),y(z,null,V(e.Info.split(`
`),e=>(L(),y(`div`,null,l(e),1))),256))]),_:2},1024),K(i,{"align-self":`center`,cols:`auto`},{default:W(()=>[K(rt,null,{activator:W(({props:e})=>[K(N,p({icon:`mdi-dots-vertical`},{ref_for:!0},e,{size:`x-small`}),null,16)]),default:W(()=>[K(J,null,{default:W(()=>[K(X,{title:`Modifier`,"prepend-icon":`mdi-pencil`,onClick:t=>a.value=M(b)(e)},null,8,[`onClick`]),K(X,{title:`Supprimer`,"prepend-icon":`mdi-delete`,onClick:t=>s.value=e},null,8,[`onClick`])]),_:2},1024)]),_:2},1024)]),_:2},1024)]),_:2},1024))),256))]),_:1}),K($,{"model-value":a.value!=null,"onUpdate:modelValue":t[3]||=e=>a.value=null,"max-width":`600px`},{default:W(()=>[a.value==null?f(``,!0):(L(),O(D,{key:0,title:`Modifier la structure`},{default:W(()=>[K(B,null,{default:W(()=>[K(G,null,{default:W(()=>[K(i,null,{default:W(()=>[K(U,{variant:`outlined`,density:`compact`,label:`Nom`,modelValue:a.value.Nom,"onUpdate:modelValue":t[0]||=e=>a.value.Nom=e,"hide-details":``},null,8,[`modelValue`])]),_:1}),K(i,null,{default:W(()=>[K(U,{variant:`outlined`,density:`compact`,label:`Immatriculation`,modelValue:a.value.Immatriculation,"onUpdate:modelValue":t[1]||=e=>a.value.Immatriculation=e,"hide-details":``},null,8,[`modelValue`])]),_:1})]),_:1}),K(G,null,{default:W(()=>[K(i,null,{default:W(()=>[K(Gt,{variant:`outlined`,density:`compact`,label:`Informations`,modelValue:a.value.Info,"onUpdate:modelValue":t[2]||=e=>a.value.Info=e,"hide-details":``},null,8,[`modelValue`])]),_:1})]),_:1})]),_:1}),K(C,null,{default:W(()=>[K(Z),K(N,{onClick:o},{default:W(()=>[...t[7]||=[A(`Enregistrer`,-1)]]),_:1})]),_:1})]),_:1}))]),_:1},8,[`model-value`]),K($,{"model-value":s.value!=null,"onUpdate:modelValue":t[4]||=e=>s.value=null,"max-width":`450px`},{default:W(()=>[s.value==null?f(``,!0):(L(),O(D,{key:0,title:`Confirmation`},{default:W(()=>[K(B,null,{default:W(()=>[A(` Confirmez-vous la suppression de la structure `+l(s.value.Nom)+` ? `,1),t[8]||=E(`br`,null,null,-1),t[9]||=E(`br`,null,null,-1),t[10]||=A(` Attention, cette opération est irréversible. `,-1)]),_:1}),K(C,null,{default:W(()=>[K(Z),K(N,{color:`red`,onClick:c},{default:W(()=>[...t[11]||=[A(`Supprimer`,-1)]]),_:1})]),_:1})]),_:1}))]),_:1},8,[`model-value`])]),_:1}))}}),_r={key:0},vr={key:1},yr=a({__name:`DossierParticipantRow`,props:F({participant:{},aides:{},aidesFiles:{},hasManyParticipants:{type:Boolean}},{structures:{required:!0},structuresModifiers:{}}),emits:F([`update`,`delete`,`createAide`,`updateAide`,`deleteAide`,`deleteFileAide`,`uploadFileAide`,`expand`],[`update:structures`]),setup(e,{emit:t}){let r=e,a=Le(e,`structures`),o=t,c=w(()=>{let e=Object.values(r.aides||{});return e.sort((e,t)=>e.Id-t.Id),e}),u=w(()=>r.participant.Camp.OptionPrix.Active==j.NoOption&&!s.isQuotientFamilialActive(r.participant.Camp.OptionQuotientFamilial));function d(e){switch(r.participant.Camp.OptionPrix.Active){case j.NoOption:return`Séjour sans option`;case j.PrixJour:let t=e.Jour?.length||0;return t==0?`Présent tous les jours`:`Présent ${t} jour${t>1?`s`:``}`;case j.PrixStatut:let n=r.participant.Camp.OptionPrix.Statuts?.find(t=>t.Id==e.IdStatut);return n?`Statut ${n.Label}`:`Pas d'option.`}}let m=R(!1),g=R(!1),_=w(()=>Object.values(a.value).map(e=>({value:e.Id,title:e.Nom})).sort((e,t)=>e.title.localeCompare(t.title))),v=R(null),b=R(null),ee=R(null),x=R(!1);return(t,S)=>(L(),O(G,null,{default:W(()=>[K(i,{"align-self":`center`,cols:`3`},{default:W(()=>[K(ot,null,{default:W(()=>[E(`a`,{href:`/camps`,onClick:S[0]||=n(e=>M(zr)(r.participant.Participant),[`prevent`])},l(M(h).label(r.participant.Personne)),1)]),_:1}),K(tt,null,{default:W(()=>[A(l(M(s).label(r.participant.Camp)),1)]),_:1})]),_:1}),K(i,{"align-self":`center`,cols:`2`,class:`text-center`},{default:W(()=>[K(rt,{disabled:u.value,"close-on-content-click":!1,modelValue:m.value,"onUpdate:modelValue":S[2]||=e=>m.value=e},{activator:W(({props:e})=>[K(D,p(e,{elevation:u.value?0:1,color:`grey-lighten-2`}),{default:W(()=>[K(B,{class:`py-1 px-1`},{default:W(()=>[u.value?(L(),y(`div`,_r,`Camp sans option`)):(L(),y(`div`,vr,[A(l(r.participant.Participant.QuotientFamilial?`QF ${r.participant.Participant.QuotientFamilial}.`:`Pas de QF.`)+` `,1),S[22]||=E(`br`,null,null,-1),A(` `+l(d(r.participant.Participant.OptionPrix)),1)]))]),_:1})]),_:1},16,[`elevation`])]),default:W(()=>[K(lr,{camp:r.participant.Camp,"option-and-qf":{options:r.participant.Participant.OptionPrix,quotientFamilial:r.participant.Participant.QuotientFamilial},onUpdate:S[1]||=e=>{r.participant.Participant.OptionPrix=e.options,r.participant.Participant.QuotientFamilial=e.quotientFamilial,m.value=!1,o(`update`,r.participant.Participant)}},null,8,[`camp`,`option-and-qf`])]),_:1},8,[`disabled`,`modelValue`])]),_:1}),K(i,{"align-self":`center`,class:`text-center`},{default:W(()=>[c.value.length?f(``,!0):(L(),O(Y,{key:0,label:``},{default:W(()=>[...S[23]||=[A(`Aucune aide`,-1)]]),_:1})),(L(!0),y(z,null,V(c.value,e=>(L(),O(Y,{class:`my-1`,"prepend-icon":`mdi-cash-plus`,color:e.Valide?`green`:`orange`,onClick:t=>b.value=e},{close:W(()=>[K(H,{icon:`mdi-close-circle`,onClick:n(t=>ee.value=e,[`stop`])},null,8,[`onClick`])]),default:W(()=>[A(` `+l(a.value[e.IdStructureaide].Nom)+` : `+l(M(P).montant(e.Valeur)),1)]),_:2},1032,[`color`,`onClick`]))),256))]),_:1}),K(i,{"align-self":`center`,class:`text-center`,cols:`3`},{default:W(()=>[K(mr,{remises:r.participant.Participant.Remises,onUpdate:S[3]||=e=>{r.participant.Participant.Remises=e,o(`update`,r.participant.Participant)}},null,8,[`remises`])]),_:1}),K(i,{"align-self":`center`,cols:`auto`},{default:W(()=>[K(rt,{location:`left`},{activator:W(({props:e})=>[K(N,p(e,{icon:`mdi-dots-vertical`,size:`small`}),null,16)]),default:W(()=>[K(J,{density:`comfortable`},{default:W(()=>[K(X,{title:`Ajouter une aide`,"prepend-icon":`mdi-cash-plus`,onClick:S[4]||=e=>v.value={IdParticipant:r.participant.Participant.Id,IdStructure:0}}),K(q),r.hasManyParticipants?(L(),O(X,{key:0,"prepend-icon":`mdi-arrow-expand`,title:`Étendre les options et remises`,subtitle:`... au reste du dossier`,onClick:S[5]||=e=>o(`expand`)})):f(``,!0),K(q),K(X,{title:`Supprimer`,"prepend-icon":`mdi-delete`,onClick:S[6]||=e=>g.value=!0})]),_:1})]),_:1})]),_:1}),K($,{modelValue:g.value,"onUpdate:modelValue":S[8]||=e=>g.value=e,"max-width":`600px`},{default:W(()=>[K(D,{title:`Supprimer le participant`},{default:W(()=>[K(B,null,{default:W(()=>[...S[24]||=[A(` Confirmez-vous la suppression de ce participant ? `,-1),E(`br`,null,null,-1),A(` Attention, cette opération est irréversible. `,-1)]]),_:1}),K(C,null,{default:W(()=>[K(Z),K(N,{color:`red`,onClick:S[7]||=e=>{o(`delete`),g.value=!1}},{default:W(()=>[...S[25]||=[A(`Supprimer`,-1)]]),_:1})]),_:1})]),_:1})]),_:1},8,[`modelValue`]),K($,{modelValue:x.value,"onUpdate:modelValue":S[10]||=e=>x.value=e,"max-width":`650px`},{default:W(()=>[K(gr,{modelValue:a.value,"onUpdate:modelValue":S[9]||=e=>a.value=e},null,8,[`modelValue`])]),_:1},8,[`modelValue`]),v.value==null?f(``,!0):(L(),O($,{key:0,"model-value":v.value!=null,"onUpdate:modelValue":S[14]||=e=>v.value=null,width:`600px`},{default:W(()=>[K(D,{title:`Ajouter une aide extérieure`},{append:W(()=>[K(N,{onClick:S[11]||=e=>x.value=!0,"prepend-icon":`mdi-view-list`},{default:W(()=>[...S[26]||=[A(` Structures`,-1)]]),_:1})]),default:W(()=>[K(B,null,{default:W(()=>[K(it,{variant:`outlined`,density:`comfortable`,label:`Structure`,items:_.value,"model-value":v.value.IdStructure==0?null:v.value.IdStructure,"onUpdate:modelValue":S[12]||=e=>v.value.IdStructure=e},null,8,[`items`,`model-value`])]),_:1}),K(C,null,{default:W(()=>[K(Z),K(N,{color:`green`,onClick:S[13]||=e=>{o(`createAide`,v.value),v.value=null},disabled:v.value.IdStructure==0},{default:W(()=>[...S[27]||=[A(`Créer`,-1)]]),_:1},8,[`disabled`])]),_:1})]),_:1})]),_:1},8,[`model-value`])),b.value==null?f(``,!0):(L(),O($,{key:1,"model-value":b.value!=null,"onUpdate:modelValue":S[19]||=e=>b.value=null,"max-width":`800px`},{default:W(()=>[K(hr,{aide:b.value,file:e.aidesFiles[b.value.Id],structures:a.value,participant:r.participant,onShowStructureaides:S[15]||=e=>x.value=!0,onSave:S[16]||=e=>{o(`updateAide`,e),b.value=null},onDeleteFile:S[17]||=e=>o(`deleteFileAide`,b.value.Id),onUploadFile:S[18]||=e=>o(`uploadFileAide`,e,b.value.Id)},null,8,[`aide`,`file`,`structures`,`participant`])]),_:1},8,[`model-value`])),ee.value==null?f(``,!0):(L(),O($,{key:2,"model-value":ee.value!=null,"onUpdate:modelValue":S[21]||=e=>ee.value=null,"max-width":`600px`},{default:W(()=>[K(D,{title:`Supprimer l'aide`},{default:W(()=>[K(B,null,{default:W(()=>[...S[28]||=[A(` Confirmez-vous la suppression de l'aide extérieure ? `,-1),E(`br`,null,null,-1),A(` Attention, cette opération est irréversible. `,-1)]]),_:1}),K(C,null,{default:W(()=>[K(Z),K(N,{color:`red`,onClick:S[20]||=e=>{o(`deleteAide`,ee.value.Id),ee.value=null}},{default:W(()=>[...S[29]||=[A(`Supprimer`,-1)]]),_:1})]),_:1})]),_:1})]),_:1},8,[`model-value`]))]),_:1}))}}),br=a({__name:`DossierEditor`,props:{dossier:{},camps:{}},emits:[`updateDossier`,`createParticipant`,`updateParticipant`,`deleteParticipant`,`expandParticipant`,`createAide`,`updateAide`,`deleteAide`,`deleteFileAide`,`uploadFileAide`],setup(e,{emit:t}){let n=e,r=t,a=R(null);k(c);let o=R(!0),s=R({});async function c(){let e=await Q.StructureaidesGet();e!==void 0&&(o.value=!1,s.value=e||{})}return(e,t)=>(L(),O(D,{title:`Modifier le dossier`},{append:W(()=>[K(N,{onClick:t[0]||=e=>a.value={IdCamp:0,IdPersonne:0,IdDossier:n.dossier.Dossier.Dossier.Id}},{prepend:W(()=>[K(H,{color:`green`},{default:W(()=>[...t[9]||=[A(`mdi-plus`,-1)]]),_:1})]),default:W(()=>[t[10]||=A(` Ajouter un participant`,-1)]),_:1})]),default:W(()=>[K(B,null,{default:W(()=>[K(G,null,{default:W(()=>[K(i,{cols:`3`},{default:W(()=>[K(ar,{responsable:n.dossier.Dossier.Responsable,dossier:n.dossier.Dossier.Dossier,onSave:t[1]||=e=>r(`updateDossier`,e)},null,8,[`responsable`,`dossier`])]),_:1}),K(q,{thickness:`2`,vertical:``}),o.value?f(``,!0):(L(),O(i,{key:0},{default:W(()=>[t[11]||=E(`div`,{class:`my-1`},null,-1),(L(!0),y(z,null,V(n.dossier.Dossier.Participants,e=>(L(),O(yr,{participant:e,aides:(n.dossier.Dossier.Aides||{})[e.Participant.Id],"aides-files":n.dossier.Dossier.AidesFiles||{},"has-many-participants":(n.dossier.Dossier.Participants?.length||0)>1,structures:s.value,"onUpdate:structures":t[2]||=e=>s.value=e,onCreateAide:t[3]||=e=>r(`createAide`,e),onDeleteAide:t[4]||=e=>r(`deleteAide`,e),onUpdateAide:t[5]||=e=>r(`updateAide`,e),onDeleteFileAide:t[6]||=e=>r(`deleteFileAide`,e),onUploadFileAide:t[7]||=(e,t)=>r(`uploadFileAide`,e,t),onUpdate:t[8]||=e=>r(`updateParticipant`,e),onDelete:t=>r(`deleteParticipant`,e.Participant.Id),onExpand:t=>r(`expandParticipant`,e.Participant)},null,8,[`participant`,`aides`,`aides-files`,`has-many-participants`,`structures`,`onDelete`,`onExpand`]))),256))]),_:1}))]),_:1})]),_:1})]),_:1}))}}),xr={class:`mr-1`},Sr=[`onClick`],Cr={class:`overflow-y-auto`,style:{"max-height":`65vh`}},wr=[`href`],Tr=a({__name:`DossierDetailsPannel`,props:{dossier:{},camps:{}},emits:[`updateDossier`,`deleteDossier`,`mergeDossier`,`createParticipant`,`updateParticipant`,`deleteParticipant`,`expandParticipant`,`createAide`,`updateAide`,`deleteAide`,`deleteFileAide`,`uploadFileAide`,`createPaiement`,`updatePaiement`,`deletePaiement`,`sendMessage`,`deleteMessage`,`sendFacture`],setup(e,{expose:t,emit:a}){let o=e,s=a;t({showEditPaiement:v,showEditDossier:m});let c=w(()=>We(o.dossier.Dossier,Q.isFondsSoutien?r.FondSoutien:r.Backoffice)),u=R(!1),d=R(!1);function m(){d.value=!0}let g=R(null),_=R(null);function v(e){_.value=e}let b=R(!1);async function ee(){await he(o.dossier.EspacepersoURL),Q.showMessage(`Lien vers l'espace personnel copié.`)}async function x(){await he(o.dossier.VirementCode),Q.showMessage(`Identifiant de virement copié.`)}async function S(e){await he(e),Q.showMessage(`IBAN copié.`)}let T=R(!1),te=R(!1),k=R(``);return(e,t)=>{let r=Yt,a=ft,m=mt;return L(),O(D,{class:`ml-2`},{title:W(()=>[t[36]||=A(` Responsable `,-1),E(`a`,{href:`/annuaire`,onClick:t[0]||=n(e=>M(Ur)(o.dossier.Dossier.IdResponsable),[`prevent`])},l(o.dossier.Dossier.Responsable),1)]),subtitle:W(()=>[t[37]||=A(` Participants `,-1),(L(!0),y(z,null,V(o.dossier.Dossier.Participants,e=>(L(),y(`span`,xr,[E(`a`,{href:`/camps`,onClick:n(t=>M(zr)(e.Participant),[`prevent`])},l(M(h).prenomN(e.Personne)),9,Sr)]))),256))]),append:W(()=>[K(N,{icon:`mdi-pencil`,onClick:t[1]||=e=>d.value=!0,class:`mx-1`}),K(rt,null,{activator:W(({props:e})=>[K(N,p(e,{icon:`mdi-dots-vertical`,size:`small`,class:`mx-1`}),null,16)]),default:W(()=>[K(J,{density:`compact`},{default:W(()=>[K(X,{"prepend-icon":`mdi-email`,onClick:t[2]||=e=>te.value=!0,title:`Envoyer un message`,subtitle:`Notification par email`}),K(X,{"prepend-icon":`mdi-invoice-send`,onClick:t[3]||=e=>s(`sendFacture`),title:`Envoyer une demande de règlement`,subtitle:`Notification par email`}),K(q),K(X,{"prepend-icon":`mdi-cash-plus`,onClick:t[4]||=e=>s(`createPaiement`),title:`Ajouter un paiement`}),K(q),K(X,{"prepend-icon":`mdi-link`,onClick:t[5]||=e=>b.value=!0,title:`Afficher les identifiants`}),K(q),K(X,{"prepend-icon":`mdi-file-move`,onClick:t[6]||=e=>T.value=!0,title:`Fusionner vers ...`}),K(q),K(X,{onClick:t[7]||=e=>u.value=!0,title:`Supprimer`},{prepend:W(()=>[K(H,{color:`red`},{default:W(()=>[...t[38]||=[A(`mdi-delete`,-1)]]),_:1})]),_:1})]),_:1})]),_:1})]),default:W(()=>[K(B,null,{default:W(()=>[K(G,null,{default:W(()=>[K(i,{class:`ml-2 mb-1 text-center`},{default:W(()=>[K(rt,null,{activator:W(({props:e})=>[K(Y,p(e,{"prepend-icon":`mdi-currency-eur`,color:M(P).colorStatutPaiement(o.dossier.Dossier.Bilan.Statut)}),{default:W(()=>[A(l(o.dossier.Dossier.Bilan.Recu)+` payé sur `+l(o.dossier.Dossier.Bilan.Demande),1)]),_:1},16,[`color`])]),default:W(()=>[K(Rn,{dossier:o.dossier.Dossier},null,8,[`dossier`])]),_:1})]),_:1})]),_:1}),E(`div`,Cr,[K(Jt,{side:`end`,class:`mt-4`,density:`compact`},{default:W(()=>[(L(!0),y(z,null,V(c.value,(e,n)=>(L(),O(r,{event:e,key:n,onEditPaiement:t[8]||=e=>_.value=e,onDeleteMessage:t[9]||=e=>s(`deleteMessage`,e)},null,8,[`event`]))),128))]),_:1})])]),_:1}),K($,{modelValue:u.value,"onUpdate:modelValue":t[11]||=e=>u.value=e,"max-width":`600px`},{default:W(()=>[K(D,{title:`Supprimer le dossier`},{default:W(()=>[K(B,null,{default:W(()=>[...t[39]||=[A(` Confirmez-vous la suppression du dossier et de ses participants ? `,-1),E(`br`,null,null,-1),E(`br`,null,null,-1),A(` Attention, cette opération est irréversible. `,-1)]]),_:1}),K(C,null,{default:W(()=>[K(Z),K(N,{color:`red`,onClick:t[10]||=e=>{s(`deleteDossier`),u.value=!1}},{default:W(()=>[...t[40]||=[A(`Supprimer`,-1)]]),_:1})]),_:1})]),_:1})]),_:1},8,[`modelValue`]),g.value==null?f(``,!0):(L(),O($,{key:0,"model-value":g.value!=null,"onUpdate:modelValue":t[15]||=e=>g.value=null,"max-width":`600px`},{default:W(()=>[K(D,{title:`Ajouter un participant`},{default:W(()=>[K(B,null,{default:W(()=>[K(G,null,{default:W(()=>[K(i,{cols:`12`},{default:W(()=>[K(a,{label:`Camp`,camps:o.camps,modelValue:g.value.IdCamp,"onUpdate:modelValue":t[12]||=e=>g.value.IdCamp=e},null,8,[`camps`,`modelValue`])]),_:1}),K(i,{cols:`12`},{default:W(()=>[K(m,{label:`Personne`,"initial-personne":``,modelValue:g.value.IdPersonne,"onUpdate:modelValue":t[13]||=e=>g.value.IdPersonne=e,api:{SelectPersonne:M(Q).SelectPersonne.bind(M(Q))}},null,8,[`modelValue`,`api`])]),_:1})]),_:1})]),_:1}),K(C,null,{default:W(()=>[K(Z),K(N,{color:`green`,disabled:g.value.IdPersonne==0||g.value.IdCamp==0,onClick:t[14]||=e=>{s(`createParticipant`,g.value),g.value=null}},{default:W(()=>[...t[41]||=[A(`Ajouter`,-1)]]),_:1},8,[`disabled`])]),_:1})]),_:1})]),_:1},8,[`model-value`])),K($,{modelValue:d.value,"onUpdate:modelValue":t[26]||=e=>d.value=e},{default:W(()=>[K(br,{dossier:o.dossier,camps:o.camps,onUpdateDossier:t[16]||=e=>s(`updateDossier`,e),onCreateParticipant:t[17]||=e=>s(`createParticipant`,e),onUpdateParticipant:t[18]||=e=>s(`updateParticipant`,e),onDeleteParticipant:t[19]||=e=>s(`deleteParticipant`,e),onExpandParticipant:t[20]||=e=>s(`expandParticipant`,e),onCreateAide:t[21]||=e=>s(`createAide`,e),onUpdateAide:t[22]||=e=>s(`updateAide`,e),onDeleteAide:t[23]||=e=>s(`deleteAide`,e),onDeleteFileAide:t[24]||=e=>s(`deleteFileAide`,e),onUploadFileAide:t[25]||=(e,t)=>s(`uploadFileAide`,e,t)},null,8,[`dossier`,`camps`])]),_:1},8,[`modelValue`]),_.value==null?f(``,!0):(L(),O($,{key:1,"model-value":_.value!=null,"onUpdate:modelValue":t[29]||=e=>_.value=null,"max-width":`600px`},{default:W(()=>[K(ir,{paiement:_.value,onUpdate:t[27]||=e=>{s(`updatePaiement`,e),_.value=null},onDelete:t[28]||=e=>{s(`deletePaiement`,_.value),_.value=null}},null,8,[`paiement`])]),_:1},8,[`model-value`])),K($,{modelValue:b.value,"onUpdate:modelValue":t[30]||=e=>b.value=e,"max-width":`800px`},{default:W(()=>[K(D,{title:`Liens et identifiants`},{default:W(()=>[K(B,null,{default:W(()=>[K(G,null,{default:W(()=>[K(i,{cols:`3`},{default:W(()=>[...t[42]||=[A(`Espace personnel`,-1)]]),_:1}),K(i,{class:`text-truncate`},{default:W(()=>[E(`a`,{href:o.dossier.EspacepersoURL,target:`_blank`},l(o.dossier.EspacepersoURL),9,wr)]),_:1}),K(i,{"align-self":`center`,cols:`auto`},{default:W(()=>[K(N,{size:`small`,icon:`mdi-content-copy`,onClick:ee})]),_:1})]),_:1}),(L(!0),y(z,null,V(o.dossier.BankAccounts,e=>(L(),O(G,null,{default:W(()=>[K(i,{cols:`3`},{default:W(()=>[A(`RIB (`+l(M(`ACVE`))+`)`,1)]),_:1}),K(i,{cols:`3`},{default:W(()=>[A(l(e[0]),1)]),_:2},1024),K(i,null,{default:W(()=>[A(l(e[1]),1)]),_:2},1024),K(i,{"align-self":`center`,cols:`auto`},{default:W(()=>[K(N,{size:`small`,icon:`mdi-content-copy`,onClick:()=>S(e[1])},null,8,[`onClick`])]),_:2},1024)]),_:2},1024))),256)),K(G,null,{default:W(()=>[K(i,{cols:`3`},{default:W(()=>[...t[43]||=[A(`Identification de virement`,-1)]]),_:1}),K(i,null,{default:W(()=>[A(l(o.dossier.VirementCode),1)]),_:1}),K(i,{"align-self":`center`,cols:`auto`},{default:W(()=>[K(N,{size:`small`,icon:`mdi-content-copy`,onClick:x})]),_:1})]),_:1})]),_:1})]),_:1})]),_:1},8,[`modelValue`]),K($,{modelValue:T.value,"onUpdate:modelValue":t[32]||=e=>T.value=e,"max-width":`600px`},{default:W(()=>[K(jn,{from:o.dossier.Dossier.Dossier.Id,onMerge:t[31]||=e=>{s(`mergeDossier`,e),T.value=!1}},null,8,[`from`])]),_:1},8,[`modelValue`]),K($,{modelValue:te.value,"onUpdate:modelValue":t[35]||=e=>te.value=e,"max-width":`600px`},{default:W(()=>[K(D,{title:`Nouveau message`,subtitle:`Envoie un message sur le fil de suivi et une notification par mail.`},{default:W(()=>[K(B,null,{default:W(()=>[K(G,null,{default:W(()=>[K(i,null,{default:W(()=>[K(Gt,{rows:`5`,variant:`outlined`,modelValue:k.value,"onUpdate:modelValue":t[33]||=e=>k.value=e},null,8,[`modelValue`])]),_:1})]),_:1})]),_:1}),K(C,null,{default:W(()=>[K(Z),K(N,{disabled:!k.value.length,onClickOnce:t[34]||=e=>{s(`sendMessage`,k.value),te.value=!1}},{default:W(()=>[...t[44]||=[A(`Envoyer`,-1)]]),_:1},8,[`disabled`])]),_:1})]),_:1})]),_:1},8,[`modelValue`])]),_:1})}}}),Er=a({__name:`CreateDossierCard`,emits:[`create`],setup(e,{emit:t}){let n=t,r=R(0);return(e,t)=>{let a=mt;return L(),O(D,{title:`Créer un dossier`},{default:W(()=>[K(B,null,{default:W(()=>[K(G,null,{default:W(()=>[K(i,null,{default:W(()=>[K(a,{label:`Responsable légal`,modelValue:r.value,"onUpdate:modelValue":t[0]||=e=>r.value=e,"initial-personne":``,api:{SelectPersonne:M(Q).SelectPersonne.bind(M(Q))}},null,8,[`modelValue`,`api`])]),_:1})]),_:1})]),_:1}),K(C,null,{default:W(()=>[K(Z),K(N,{color:`green`,disabled:r.value==0,onClick:t[1]||=e=>n(`create`,r.value)},{default:W(()=>[...t[2]||=[A(`Créer`,-1)]]),_:1},8,[`disabled`])]),_:1})]),_:1})}}}),Dr=a({__name:`DossierList`,props:F({camps:{},allowFondsSoutien:{type:Boolean},selected:{}},{query:{required:!0},queryModifiers:{}}),emits:F([`click`,`update`],[`update:query`]),setup(e,{expose:n,emit:r}){let a=e,s=r,c=Le(e,`query`);n({searchDossiers:d}),I(()=>c.value,d,{immediate:!0});let u=R(null);async function d(){let e=await Q.DossiersSearch(c.value);e!==void 0&&(u.value=e,s(`update`,e))}return(e,n)=>{let r=ft,m=bt;return L(),y(`div`,null,[K(G,null,{default:W(()=>[K(i,{"align-self":`center`},{default:W(()=>[K(m,{density:`compact`,variant:`outlined`,"prepend-inner-icon":`mdi-magnify`,label:`Rechercher un dossier`,"hide-details":``,clearable:``,modelValue:c.value.Pattern,"onUpdate:modelValue":[n[5]||=e=>c.value.Pattern=e,d]},{"append-inner":W(()=>[c.value.IdCamp.Valid?(L(),O(Y,{key:0,class:`ml-1`,size:`small`,"prepend-icon":`mdi-bed`},{default:W(()=>[A(l(a.camps.find(e=>e.Id==c.value.IdCamp.Id)?.Label),1)]),_:1})):f(``,!0),c.value.Attente==M(o).EmptyQA?f(``,!0):(L(),O(Y,{key:1,class:`ml-1`,size:`small`,"prepend-icon":`mdi-clock`},{default:W(()=>[A(l(M(le)[c.value.Attente]),1)]),_:1})),c.value.Reglement==M(_).EmptyQR?f(``,!0):(L(),O(Y,{key:2,class:`ml-1`,size:`small`,"prepend-icon":`mdi-currency-eur`},{default:W(()=>[A(l(M(se)[c.value.Reglement]),1)]),_:1})),c.value.OnlyFondSoutien?(L(),O(Y,{key:3,class:`ml-1`,size:`small`},{default:W(()=>[...n[6]||=[A(` Fonds de soutien `,-1)]]),_:1})):f(``,!0)]),append:W(()=>[K(rt,{location:`left top`,"close-on-content-click":!1},{activator:W(({props:e})=>[K(N,p(e,{size:`small`,variant:`flat`,icon:``}),{default:W(()=>[K(H,null,{default:W(()=>[...n[7]||=[A(`mdi-filter-cog`,-1)]]),_:1}),K(Ut,{activator:`parent`,text:`Autres critères de recherche`})]),_:1},16)]),default:W(()=>[K(D,{"min-width":`400px`,title:`Filtrer les dossiers`},{default:W(()=>[K(B,null,{default:W(()=>[K(G,null,{default:W(()=>[K(i,null,{default:W(()=>[K(r,{label:`Camp`,camps:a.camps,"model-value":M(be)(M(Ze)(c.value.IdCamp)),"onUpdate:modelValue":n[0]||=e=>{c.value.IdCamp=M(t)(M(Me)(e)),d()}},null,8,[`camps`,`model-value`])]),_:1})]),_:1}),K(G,null,{default:W(()=>[K(i,null,{default:W(()=>[K(it,{density:`compact`,variant:`outlined`,label:`Liste d'attente`,modelValue:c.value.Attente,"onUpdate:modelValue":[n[1]||=e=>c.value.Attente=e,d],items:M(Ye)(M(le)),"hide-details":``},null,8,[`modelValue`,`items`])]),_:1})]),_:1}),K(G,null,{default:W(()=>[K(i,null,{default:W(()=>[K(it,{density:`compact`,variant:`outlined`,label:`Réglement`,modelValue:c.value.Reglement,"onUpdate:modelValue":[n[2]||=e=>c.value.Reglement=e,d],items:M(Ye)(M(se)),"hide-details":``},null,8,[`modelValue`,`items`])]),_:1})]),_:1}),K(G,null,{default:W(()=>[K(i,null,{default:W(()=>[K(yt,{label:`Trier selon les nouveaux messages`,hint:`Affiche les nouveaux messages en premier.`,"persistent-hint":``,density:`compact`,color:`light-blue-darken-3`,modelValue:c.value.SortByNewMessages,"onUpdate:modelValue":[n[3]||=e=>c.value.SortByNewMessages=e,d]},null,8,[`modelValue`])]),_:1})]),_:1}),a.allowFondsSoutien?(L(),O(G,{key:0},{default:W(()=>[K(i,null,{default:W(()=>[K(yt,{label:`Fonds de soutien`,hint:`N'affiche que les dossiers demandant le fonds de soutien.`,"persistent-hint":``,density:`compact`,color:`orange`,modelValue:c.value.OnlyFondSoutien,"onUpdate:modelValue":[n[4]||=e=>c.value.OnlyFondSoutien=e,d]},null,8,[`modelValue`])]),_:1})]),_:1})):f(``,!0)]),_:1})]),_:1})]),_:1})]),_:1},8,[`modelValue`])]),_:1})]),_:1}),u.value==null?f(``,!0):(L(),O(J,{key:0,class:`mt-2`,selected:a.selected?[a.selected]:void 0},{default:W(()=>[u.value.Dossiers?.length?f(``,!0):(L(),O(X,{key:0,class:`text-center`},{default:W(()=>[...n[8]||=[E(`i`,null,`Aucun dossier ne correspond à votre recherche.`,-1)]]),_:1})),(L(!0),y(z,null,V(u.value.Dossiers,(e,t)=>(L(),O(X,{rounded:``,key:t,title:e.Responsable,subtitle:e.Participants,value:e.Id,onClick:t=>s(`click`,e),class:`my-1`},S({_:2},[e.NewMessages?{name:`append`,fn:W(()=>[K(zt,{color:`light-blue-darken-3`,content:e.NewMessages},null,8,[`content`])]),key:`0`}:void 0]),1032,[`title`,`subtitle`,`value`,`onClick`]))),128))]),_:1},8,[`selected`]))])}}}),Or=a({__name:`SendDocumentsCampCard`,props:{camps:{}},emits:[`send`],setup(e,{emit:t}){let n=e,r=t,a=R(0),o=R(null);async function s(){let e=await Q.EventsSendDocumentsCampPreview({idCamp:a.value});e!==void 0&&(o.value=e,c.value=(e.Dossiers||[]).filter(e=>!e.DocumentsSent).map(e=>e.Id))}let c=R([]),l=w(()=>c.value.length==(o.value?.Dossiers||[]).length);return(e,t)=>{let u=ft;return L(),O(D,{title:`Envoyer les documents d'un séjour`},{default:W(()=>[K(B,null,{default:W(()=>[K(G,null,{default:W(()=>[K(i,{"align-self":`center`,cols:`5`},{default:W(()=>[K(u,{camps:n.camps,label:`Séjour`,modelValue:a.value,"onUpdate:modelValue":[t[0]||=e=>a.value=e,s]},null,8,[`camps`,`modelValue`])]),_:1}),K(i,{"align-self":`center`},{default:W(()=>[o.value?(L(),O(D,{key:0,subtitle:`Dossiers à contacter`},S({default:W(()=>[K(B,null,{default:W(()=>[K(J,{selectable:``,selected:c.value,"onUpdate:selected":t[2]||=e=>c.value=e,"select-strategy":`leaf`},{default:W(()=>[(L(!0),y(z,null,V(o.value.Dossiers,e=>(L(),O(X,{title:e.Responsable,subtitle:e.Participants,value:e.Id,rounded:``,class:`my-1`},{append:W(({isSelected:n,select:r})=>[K(G,null,{default:W(()=>[K(i,null,{default:W(()=>[e.DocumentsSent?(L(),O(Y,{key:0,color:`green`,class:`mr-2`},{default:W(()=>[...t[4]||=[A(`Envoyés`,-1)]]),_:1})):f(``,!0)]),_:2},1024),K(i,null,{default:W(()=>[K(nt,{density:`compact`,"hide-details":``,"model-value":n,"onUpdate:modelValue":r},null,8,[`model-value`,`onUpdate:modelValue`])]),_:2},1024)]),_:2},1024)]),_:2},1032,[`title`,`subtitle`,`value`]))),256))]),_:1},8,[`selected`])]),_:1})]),_:2},[o.value.Dossiers?.length?{name:`append`,fn:W(()=>[K(at,{label:`Tout sélectionner`,density:`compact`,"hide-details":``,indeterminate:!!c.value.length&&c.value.length!=(o.value.Dossiers||[]).length,"model-value":c.value.length==(o.value.Dossiers||[]).length,"onUpdate:modelValue":t[1]||=e=>c.value=l.value?[]:(o.value.Dossiers||[]).map(e=>e.Id)},null,8,[`indeterminate`,`model-value`])]),key:`0`}:void 0]),1024)):f(``,!0)]),_:1})]),_:1})]),_:1}),K(C,null,{default:W(()=>[K(Z),K(N,{disabled:!a.value||!c.value.length,onClick:t[3]||=e=>r(`send`,a.value,c.value),"prepend-icon":`mdi-send`},{default:W(()=>[...t[5]||=[A(` Envoyer `,-1)]]),_:1},8,[`disabled`])]),_:1})]),_:1})}}}),kr=a({__name:`SendRelancePaiementCard`,props:{camps:{}},emits:[`send`],setup(e,{emit:t}){let n=e,r=t,a=R(0),o=R([]);async function s(){let e=await Q.EventsSendRelancePaiementPreview({idCamp:a.value});e!==void 0&&(o.value=e||[],c.value=(e||[]).map(e=>e.Id))}let c=R([]),u=w(()=>c.value.length==o.value.length);return(e,t)=>{let d=ft;return L(),O(D,{title:`Envoyer une relance de paiement`},{default:W(()=>[K(B,null,{default:W(()=>[K(G,null,{default:W(()=>[K(i,{"align-self":`center`,cols:`5`},{default:W(()=>[K(d,{camps:n.camps,label:`Séjour`,modelValue:a.value,"onUpdate:modelValue":[t[0]||=e=>a.value=e,s]},null,8,[`camps`,`modelValue`])]),_:1}),K(i,{"align-self":`center`},{default:W(()=>[o.value?(L(),O(D,{key:0,subtitle:`Dossiers à relancer`},S({default:W(()=>[K(B,null,{default:W(()=>[K(J,{selectable:``,selected:c.value,"onUpdate:selected":t[2]||=e=>c.value=e,"select-strategy":`leaf`,density:`comfortable`},{default:W(()=>[(L(!0),y(z,null,V(o.value,(e,t)=>(L(),O(X,{key:e.Id,title:e.Responsable,subtitle:M(Ve)(e.LastEventFacture)?``:`Dernière demande : ${M(P).time(e.LastEventFacture)}`,value:e.Id,rounded:``,class:`my-1`},{append:W(({isSelected:t,select:n})=>[K(G,null,{default:W(()=>[K(i,{"align-self":`center`},{default:W(()=>[K(Y,{class:`mr-2`,color:M(P).colorStatutPaiement(e.Bilan.Statut)},{default:W(()=>[A(l(e.Bilan.Recu)+` / `+l(e.Bilan.Demande),1)]),_:2},1032,[`color`])]),_:2},1024),K(i,{"align-self":`center`},{default:W(()=>[K(nt,{density:`compact`,"hide-details":``,"model-value":t,"onUpdate:modelValue":n},null,8,[`model-value`,`onUpdate:modelValue`])]),_:2},1024)]),_:2},1024)]),_:2},1032,[`title`,`subtitle`,`value`]))),128))]),_:1},8,[`selected`])]),_:1})]),_:2},[o.value.length?{name:`append`,fn:W(()=>[K(at,{label:`Tout sélectionner`,density:`compact`,"hide-details":``,indeterminate:!!c.value.length&&c.value.length!=o.value.length,"model-value":c.value.length==o.value.length,"onUpdate:modelValue":t[1]||=e=>c.value=u.value?[]:o.value.map(e=>e.Id)},null,8,[`indeterminate`,`model-value`])]),key:`0`}:void 0]),1024)):f(``,!0)]),_:1})]),_:1})]),_:1}),K(C,null,{default:W(()=>[K(Z),K(N,{disabled:!a.value||!c.value.length,onClick:t[3]||=e=>r(`send`,a.value,c.value),"prepend-icon":`mdi-send`},{default:W(()=>[...t[4]||=[A(` Envoyer `,-1)]]),_:1},8,[`disabled`])]),_:1})]),_:1})}}}),Ar=a({__name:`RemisesHintsCard`,props:{allCamps:{}},setup(e){let t=e;k(()=>{a.value=t.allCamps.filter(e=>!e.IsOld).map(e=>e.Id),s()});let n=R([]),r=R(!1),a=R([]),o=R(null);async function s(){let e=await Q.DossiersRemisesHint({IdCamps:a.value});e!==void 0&&(o.value=e||[])}let c=R([]);async function u(){let e=o.value;if(!c.value.length||!e)return;let t=c.value.map(t=>e[t]),n=await Q.DossiersApplyRemisesHints(t);c.value=[],n!==void 0&&(Q.showMessage(`Remises appliquées avec succès.`),s())}return(e,d)=>(L(),O(D,{title:`Estimer les remises`,subtitle:`Seules les nouvelles remises sont affichées.`},{append:W(()=>[K(N,{onClick:d[0]||=e=>{n.value=a.value,r.value=!0},"prepend-icon":`mdi-cog`},{default:W(()=>[...d[5]||=[A(` Séjours `,-1)]]),_:1}),K(q,{vertical:``,thickness:`1`,class:`mx-2`}),K(N,{disabled:!c.value.length,onClick:u},{default:W(()=>[...d[6]||=[A(`Appliquer les remises`,-1)]]),_:1},8,[`disabled`])]),default:W(()=>[K(B,null,{default:W(()=>[o.value==null?(L(),O(Ee,{key:0})):(L(),O(J,{key:1,"select-strategy":`leaf`,selected:c.value,"onUpdate:selected":d[1]||=e=>c.value=e,color:`primary`},{default:W(()=>[o.value.length?f(``,!0):(L(),O(X,{key:0,class:`font-italic`},{default:W(()=>[...d[7]||=[A(` Aucune nouvelle remise à appliquer. `,-1)]]),_:1})),(L(!0),y(z,null,V(o.value,(e,t)=>(L(),O(X,{title:e.Personne,subtitle:e.Camp,value:t,rounded:``,class:`my-1`},{append:W(()=>[K(G,{style:{width:`200px`}},{default:W(()=>[K(i,{cols:`6`},{default:W(()=>[e.Hint.Famille?(L(),O(Y,{key:0,"prepend-icon":`mdi-account-multiple`,class:`mx-1`,elevation:`1`},{default:W(()=>[A(l(e.Hint.Famille)+` % `,1),K(Ut,{activator:`parent`,"content-class":`ma-0 pa-0`},{default:W(()=>[K(D,{subtitle:`Autres inscrits de la même famille`},{default:W(()=>[K(B,null,{default:W(()=>[(L(!0),y(z,null,V(e.AutresInscrits,e=>(L(),O(Y,{class:`mx-1`},{default:W(()=>[A(l(e.Personne)+` (`+l(e.Camp)+`)`,1)]),_:2},1024))),256))]),_:2},1024)]),_:2},1024)]),_:2},1024)]),_:2},1024)):f(``,!0)]),_:2},1024),K(i,{cols:`6`},{default:W(()=>[e.Hint.Equipiers?(L(),O(Y,{key:0,"prepend-icon":`mdi-account-hard-hat`,class:`mx-1`,elevation:`1`},{default:W(()=>[A(l(e.Hint.Equipiers)+` % `,1),K(Ut,{activator:`parent`,"content-class":`ma-0 pa-0`},{default:W(()=>[K(D,{subtitle:`Equipiers de la même famille`},{default:W(()=>[K(B,null,{default:W(()=>[(L(!0),y(z,null,V(e.Equipiers,e=>(L(),O(Y,{class:`mx-1`},{default:W(()=>[A(l(e.Personne)+` (`+l(e.Camp)+`)`,1)]),_:2},1024))),256))]),_:2},1024)]),_:2},1024)]),_:2},1024)]),_:2},1024)):f(``,!0)]),_:2},1024)]),_:2},1024)]),_:2},1032,[`title`,`subtitle`,`value`]))),256))]),_:1},8,[`selected`]))]),_:1}),K($,{modelValue:r.value,"onUpdate:modelValue":d[4]||=e=>r.value=e,"max-width":`600px`},{default:W(()=>[K(D,{title:`Choix des séjours`},{default:W(()=>[K(B,null,{default:W(()=>[K(_n,{"all-camps":t.allCamps,modelValue:n.value,"onUpdate:modelValue":d[2]||=e=>n.value=e},null,8,[`all-camps`,`modelValue`])]),_:1}),K(C,null,{default:W(()=>[K(Z),K(N,{onClick:d[3]||=e=>{a.value=n.value,r.value=!1,s()}},{default:W(()=>[...d[8]||=[A(`Appliquer`,-1)]]),_:1})]),_:1})]),_:1})]),_:1},8,[`modelValue`])]),_:1}))}}),jr={key:1,class:`text-center font-italic my-6`},Mr=a({__name:`PannelDossiers`,props:{initialDossier:{}},setup(e){let t=e;k(()=>{s(),t.initialDossier!==void 0&&d(t.initialDossier)}),I(()=>t.initialDossier,()=>{t.initialDossier!==void 0&&d(t.initialDossier)});let n=Je(`detailsPannel`),r=R(null),a=R(Dt()),o=R([]);async function s(){let e=await Q.GetCamps();e!==void 0&&(o.value=e||[])}function c(e){r.value={length:e.Dossiers?.length||0,total:e.Total}}let l=Je(`dossierList`);function u(){l.value?.searchDossiers()}async function d(e){await m(e),a.value=Ot(e)}let p=R(null);async function m(e){let t=await Q.DossiersLoad({id:e});t!==void 0&&(p.value=t)}async function h(e){m(e.Id),await Q.EventsMarkMessagesSeen({idDossier:e.Id})!==void 0&&u()}async function g(){p.value!=null&&m(p.value.Dossier.Dossier.Id)}let _=R(!1);async function v(e){_.value=!1;let t=await Q.DossiersCreate({idResponsable:e});t!==void 0&&(Q.showMessage(`Dossier créé avec succès.`),await d(t.Id),n.value?.showEditDossier())}async function b(e){let t=await Q.DossiersUpdate(e);t!==void 0&&(Q.showMessage(`Dossier mis à jour avec succès.`),p.value!=null&&(p.value.Dossier.Dossier=e,p.value.Dossier.Responsable=t.Responsable),u())}async function ee(){if(p.value==null)return;let e=p.value.Dossier.Dossier.Id;await Q.DossiersDelete({id:e})!==void 0&&(Q.showMessage(`Dossier supprimé avec succès.`),p.value=null,u())}async function x(e){await Q.DossiersMerge(e)!==void 0&&(Q.showMessage(`Dossier fusionné avec succès.`),u(),m(e.To))}async function S(e){await Q.ParticipantsCreate(e)!==void 0&&(Q.showMessage(`Participant ajouté avec succès.`),g())}async function C(e){await Q.ParticipantsUpdate(e)!==void 0&&(Q.showMessage(`Réglages du participant modifiés avec succès.`),g())}async function w(e){await Q.ParticipantsDelete({id:e})!==void 0&&(Q.showMessage(`Participant supprimé avec succès.`),g())}async function T(e){if(p.value==null)return;let t=p.value.Dossier.Participants?.map(e=>e.Participant).filter(t=>t.Id!=e.Id)||[];t.length&&(t.forEach(t=>{t.Remises=e.Remises,t.QuotientFamilial=e.QuotientFamilial,t.IdCamp==e.IdCamp&&(t.OptionPrix=e.OptionPrix)}),!(await Promise.all(t.map(e=>Q.ParticipantsUpdate(e)))).includes(void 0)&&(Q.showMessage(`Réglages des participants modifiés avec succès.`),g()))}async function E(e){let t=await Q.AidesCreate(e);if(t===void 0||(Q.showMessage(`Aide ajoutée avec succès.`),p.value==null))return;let n=p.value.Dossier.Aides||{},r=n[e.IdParticipant]||{};r[t.Id]=t,n[e.IdParticipant]=r,p.value.Dossier.Aides=n}async function te(e){await Q.AidesUpdate(e)!==void 0&&(Q.showMessage(`Aide modifiée avec succès.`),g())}async function ne(e){await Q.AidesJustificatifDelete({idAide:e})!==void 0&&(Q.showMessage(`Justificatif supprimé avec succès.`),p.value!=null&&p.value.Dossier.AidesFiles&&delete p.value.Dossier.AidesFiles[e])}async function re(e,t){let n=await Q.AidesJustificatifUpload(e,{idAide:t});if(n!==void 0&&(Q.showMessage(`Justificatif téléversé avec succès.`),p.value!=null)){let e=p.value.Dossier.AidesFiles||{};e[t]=n,p.value.Dossier.AidesFiles=e}}async function j(e){await Q.AidesDelete({id:e})!==void 0&&(Q.showMessage(`Aide supprimée avec succès.`),g())}async function ie(){if(p.value==null)return;let e=await Q.PaiementsCreate({idDossier:p.value.Dossier.Dossier.Id});e!==void 0&&(Q.showMessage(`Paiement créé avec succès.`),g(),n.value?.showEditPaiement(e))}async function ae(e){await Q.PaiementsUpdate(e)!==void 0&&(Q.showMessage(`Paiement modifié avec succès.`),g())}async function oe(e){await Q.PaiementsDelete({id:e.Id})!==void 0&&(Q.showMessage(`Paiement supprimé avec succès.`),g())}async function se(e){p.value!=null&&await Q.EventsSendMessage({IdDossier:p.value.Dossier.Dossier.Id,Contenu:e})!==void 0&&(Q.showMessage(`Message envoyé avec succès.`),g())}async function P(e){await Q.EventsDelete({id:e.Id})!==void 0&&(Q.showMessage(`Message supprimé avec succès.`),g())}async function ce(){p.value!=null&&await Q.EventsSendFacture({idDossier:p.value.Dossier.Dossier.Id})!==void 0&&(Q.showMessage(`Demande de règlement envoyé avec succès.`),g())}let le=R(!1),F=R(null);async function ue(e,t){F.value={Current:0,Total:t.length};let n=await Q.EventsSendDocumentsCamp({IdCamp:e,IdDossiers:t});if(n===void 0){F.value=null;return}await qe(n,e=>F.value=e,e=>Q.onError(`Envoi des documents`,e)),F.value=null,g(),Q.showMessage(`Documents du séjour envoyés avec succès.`)}let de=R(!1),fe=R(null);async function pe(e,t){fe.value={Current:0,Total:t.length};let n=await Q.EventsSendRelancePaiement({IdDossiers:t});if(n===void 0){fe.value=null;return}await qe(n,e=>fe.value=e,e=>Q.onError(`Envoi de la relance`,e)),fe.value=null,g(),Q.showMessage(`Toutes les relances ont été envoyées avec succès.`)}let me=R(!1);return(e,t)=>(L(),O(G,{"no-gutters":``,class:`ma-2`},{default:W(()=>[K(i,{cols:`6`},{default:W(()=>[K(D,{title:`Dossiers`,subtitle:r.value==null?`-`:`${r.value.length} affiché(s) / ${r.value.total}`},{append:W(()=>[K(N,{icon:``,size:`small`,onClick:t[0]||=e=>_.value=!0},{default:W(()=>[K(H,{color:`green`},{default:W(()=>[...t[9]||=[A(`mdi-plus`,-1)]]),_:1})]),_:1}),K(q,{thickness:`1`,vertical:``,class:`mx-2`}),K(N,{size:`small`,"prepend-icon":`mdi-send-circle-outline`},{default:W(()=>[t[10]||=A(` Actions `,-1),K(rt,{activator:`parent`},{default:W(()=>[K(J,{density:`compact`},{default:W(()=>[K(X,{title:`Estimation des remises`,"prepend-icon":`mdi-finance`,onClick:t[1]||=e=>me.value=!0}),K(q),K(X,{title:`Documents...`,subtitle:`Paramétrer et envoyer les documents d'un séjour`,"prepend-icon":`mdi-mail`,onClick:t[2]||=e=>le.value=!0}),K(q),K(X,{title:`Relance de paiement...`,subtitle:`Paramétrer et envoyer une relance, pour un séjour`,"prepend-icon":`mdi-invoice-send`,onClick:t[3]||=e=>de.value=!0})]),_:1})]),_:1})]),_:1})]),default:W(()=>[K(B,null,{default:W(()=>[K(Dr,{camps:o.value,"allow-fonds-soutien":M(Q).isFondsSoutien,selected:p.value?.Dossier.Dossier.Id,query:a.value,"onUpdate:query":t[4]||=e=>a.value=e,onClick:h,onUpdate:c,ref_key:`dossierList`,ref:l},null,8,[`camps`,`allow-fonds-soutien`,`selected`,`query`])]),_:1})]),_:1},8,[`subtitle`])]),_:1}),K(i,{cols:`6`},{default:W(()=>[p.value==null?(L(),y(`div`,jr,` Sélectionner un dossier... `)):(L(),O(Tr,{key:0,dossier:p.value,camps:o.value,onUpdateDossier:b,onDeleteDossier:ee,onMergeDossier:x,onCreateParticipant:S,onUpdateParticipant:C,onDeleteParticipant:w,onExpandParticipant:T,onCreateAide:E,onDeleteAide:j,onUpdateAide:te,onDeleteFileAide:ne,onUploadFileAide:re,onCreatePaiement:ie,onUpdatePaiement:ae,onDeletePaiement:oe,onSendMessage:se,onDeleteMessage:P,onSendFacture:ce,ref_key:`detailsPannel`,ref:n},null,8,[`dossier`,`camps`]))]),_:1}),K($,{modelValue:_.value,"onUpdate:modelValue":t[5]||=e=>_.value=e,"max-width":`400px`},{default:W(()=>[K(Er,{onCreate:v})]),_:1},8,[`modelValue`]),K($,{modelValue:le.value,"onUpdate:modelValue":t[6]||=e=>le.value=e,"max-width":`1000px`},{default:W(()=>[K(Or,{camps:o.value,onSend:ue},null,8,[`camps`])]),_:1},8,[`modelValue`]),K($,{modelValue:de.value,"onUpdate:modelValue":t[7]||=e=>de.value=e,"max-width":`1000px`},{default:W(()=>[K(kr,{camps:o.value,onSend:pe},null,8,[`camps`])]),_:1},8,[`modelValue`]),K($,{"model-value":F.value!=null,"max-width":`400px`,persistent:``},{default:W(()=>[F.value?(L(),O(pt,{key:0,title:`Envoi des documents en cours`,current:F.value.Current,total:F.value.Total},null,8,[`current`,`total`])):f(``,!0)]),_:1},8,[`model-value`]),K($,{"model-value":fe.value!=null,"max-width":`400px`,persistent:``},{default:W(()=>[fe.value?(L(),O(pt,{key:0,title:`Envoi des relances en cours`,current:fe.value.Current,total:fe.value.Total},null,8,[`current`,`total`])):f(``,!0)]),_:1},8,[`model-value`]),K($,{modelValue:me.value,"onUpdate:modelValue":t[8]||=e=>me.value=e,"max-width":`800px`},{default:W(()=>[K(Ar,{"all-camps":o.value},null,8,[`all-camps`])]),_:1},8,[`modelValue`])]),_:1}))}}),Nr=a({__name:`inscriptions`,setup(e){let t=ct(),n=w(()=>Br(t.currentRoute.value.query)),r=w(()=>n.value.tab||`insc`),i=w(()=>n.value.idDossier);function a(e){let n=t.currentRoute.value;t.push({path:n.path,query:{tab:e}})}return(e,t)=>(L(),y(z,null,[K(rn,{title:`Suivi des inscriptions`},{default:W(()=>[K(Pt,{"model-value":r.value,"onUpdate:modelValue":t[0]||=e=>a(e)},{default:W(()=>[K(kt,{value:`insc`},{default:W(()=>[...t[2]||=[A(`Inscriptions en attente`,-1)]]),_:1}),K(kt,{value:`doss`},{default:W(()=>[...t[3]||=[A(`Suivi des dossiers`,-1)]]),_:1})]),_:1},8,[`model-value`])]),_:1}),K(Mt,{"model-value":r.value},{default:W(()=>[K(At,{value:`insc`},{default:W(()=>[K(Pn,{onGoTo:M(Vr),onEmpty:t[1]||=e=>M(Vr)()},null,8,[`onGoTo`])]),_:1}),K(At,{value:`doss`},{default:W(()=>[K(Mr,{"initial-dossier":i.value},null,8,[`initial-dossier`])]),_:1})]),_:1},8,[`model-value`])],64))}}),Pr=a({__name:`PersonneEdit`,props:{personne:{}},emits:[`save`],setup(e,{emit:t}){let n=e,r=t,a=R(b(n.personne)),o=w(()=>!!(a.value.Nom&&a.value.Prenom));return(e,t)=>{let n=$t,s=Xt,c=nn,l=tn,u=Qt;return L(),O(D,{title:`Editer le profil`},{default:W(()=>[K(B,null,{default:W(()=>[K(qt,null,{default:W(()=>[K(G,null,{default:W(()=>[K(i,null,{default:W(()=>[K(U,{autofocus:``,"hide-details":``,label:`Nom`,density:`compact`,variant:`outlined`,modelValue:a.value.Nom,"onUpdate:modelValue":t[0]||=e=>a.value.Nom=e},null,8,[`modelValue`])]),_:1}),K(i,null,{default:W(()=>[K(U,{"hide-details":``,label:`Prénom`,density:`compact`,variant:`outlined`,modelValue:a.value.Prenom,"onUpdate:modelValue":t[1]||=e=>a.value.Prenom=e},null,8,[`modelValue`])]),_:1}),K(i,{cols:`3`},{default:W(()=>[K(n,{modelValue:a.value.Sexe,"onUpdate:modelValue":t[2]||=e=>a.value.Sexe=e},null,8,[`modelValue`])]),_:1})]),_:1}),K(G,null,{default:W(()=>[K(i,null,{default:W(()=>[K(s,{modelValue:a.value.DateNaissance,"onUpdate:modelValue":t[3]||=e=>a.value.DateNaissance=e},null,8,[`modelValue`])]),_:1}),K(i,null,{default:W(()=>[K(U,{"hide-details":``,label:`Ville de naissance`,density:`compact`,variant:`outlined`,modelValue:a.value.VilleNaissance,"onUpdate:modelValue":t[4]||=e=>a.value.VilleNaissance=e},null,8,[`modelValue`])]),_:1}),K(i,null,{default:W(()=>[K(c,{label:`Département de naissance`,modelValue:a.value.DepartementNaissance,"onUpdate:modelValue":t[5]||=e=>a.value.DepartementNaissance=e},null,8,[`modelValue`])]),_:1}),K(i,null,{default:W(()=>[K(l,{modelValue:a.value.Nationnalite,"onUpdate:modelValue":t[6]||=e=>a.value.Nationnalite=e},null,8,[`modelValue`])]),_:1})]),_:1}),K(G,null,{default:W(()=>[K(i,null,{default:W(()=>[K(U,{"hide-details":``,label:`Adresse`,density:`compact`,variant:`outlined`,modelValue:a.value.Adresse,"onUpdate:modelValue":t[7]||=e=>a.value.Adresse=e},null,8,[`modelValue`])]),_:1}),K(i,null,{default:W(()=>[K(U,{"hide-details":``,label:`Code postal`,density:`compact`,variant:`outlined`,modelValue:a.value.CodePostal,"onUpdate:modelValue":t[8]||=e=>a.value.CodePostal=e},null,8,[`modelValue`])]),_:1}),K(i,null,{default:W(()=>[K(U,{"hide-details":``,label:`Ville`,density:`compact`,variant:`outlined`,modelValue:a.value.Ville,"onUpdate:modelValue":t[9]||=e=>a.value.Ville=e},null,8,[`modelValue`])]),_:1}),K(i,null,{default:W(()=>[K(u,{modelValue:a.value.Pays,"onUpdate:modelValue":t[10]||=e=>a.value.Pays=e},null,8,[`modelValue`])]),_:1})]),_:1}),K(G,null,{default:W(()=>[K(i,null,{default:W(()=>[K(U,{"hide-details":``,label:`Mail`,density:`compact`,variant:`outlined`,modelValue:a.value.Mail,"onUpdate:modelValue":t[11]||=e=>a.value.Mail=e},null,8,[`modelValue`])]),_:1}),K(i,null,{default:W(()=>[K(Zt,{label:`Téléphone`,modelValue:a.value.Tels,"onUpdate:modelValue":t[12]||=e=>a.value.Tels=e,formatter:a.value.Pays==`CH`?M(P).telCh:M(P).telFr},null,8,[`modelValue`,`formatter`])]),_:1})]),_:1})]),_:1})]),_:1}),K(C,null,{default:W(()=>[K(Z),K(N,{disabled:!o.value,onClick:t[13]||=e=>r(`save`,a.value)},{default:W(()=>[...t[14]||=[A(`Enregistrer`,-1)]]),_:1},8,[`disabled`])]),_:1})]),_:1})}}}),Fr=[{path:`/`,component:an},{path:`/camps`,component:An},{path:`/inscriptions`,component:Nr},{path:`/annuaire`,component:a({__name:`annuaire`,setup(e){let t=ct(),n=w(()=>Hr(t.currentRoute.value.query)),r=w(()=>n.value.idPersonne);I(()=>r.value,()=>r.value===void 0?null:d(r.value),{immediate:!0});let a=R([]),o=R(``);async function s(){if(!o.value)return;let e=await Q.PersonnesGet({search:o.value});e!==void 0&&(a.value=e||[])}async function c(){let e=await Q.PersonnesCreate();e!==void 0&&(Q.showMessage(`Profil créé avec succès.`),a.value.push(e),Ur(e.Id))}let l=R(null);async function u(e){l.value=null;let t=await Q.PersonnesUpdate(e);if(t===void 0)return;Q.showMessage(`Profil modifié avec succès.`),Ur();let n=a.value.findIndex(t=>t.Id==e.Id);a.value[n]=t}async function d(e){let t=await Q.PersonnesLoad({id:e});t!==void 0&&(l.value=t)}return(e,t)=>{let n=bt;return L(),y(z,null,[K(rn,{title:`Annuaire : personnes et organismes`}),K(D,{class:`my-2 mx-auto`,"max-width":`600px`},{append:W(()=>[K(N,{color:`green`,onClick:c},{default:W(()=>[...t[2]||=[A(`Créer un nouveau profil`,-1)]]),_:1})]),default:W(()=>[K(B,null,{default:W(()=>[K(G,null,{default:W(()=>[K(i,null,{default:W(()=>[K(n,{"prepend-inner-icon":`mdi-magnify`,label:`Recherche`,modelValue:o.value,"onUpdate:modelValue":[t[0]||=e=>o.value=e,s]},null,8,[`modelValue`]),K(J,null,{default:W(()=>[(L(!0),y(z,null,V(a.value,e=>(L(),O(X,{title:e.Label,subtitle:M(P).dateNaissance(e.DateNaissance),"prepend-icon":M(P).sexeIcon(e.Sexe),onClick:t=>M(Ur)(e.Id)},S({_:2},[e.IsTemp?{name:`append`,fn:W(()=>[K(Y,{"prepend-icon":`mdi-alert`,color:`warning`},{default:W(()=>[...t[3]||=[A(` Ce profil est temporaire et devrait être identifié. `,-1)]]),_:1})]),key:`0`}:void 0]),1032,[`title`,`subtitle`,`prepend-icon`,`onClick`]))),256))]),_:1})]),_:1}),K(i)]),_:1})]),_:1}),l.value==null?f(``,!0):(L(),O($,{key:0,"model-value":l.value!=null,"onUpdate:modelValue":t[1]||=e=>{l.value=null,M(Ur)(void 0)},"max-width":`1000px`},{default:W(()=>[K(Pr,{personne:l.value,onSave:u},null,8,[`personne`])]),_:1},8,[`model-value`]))]),_:1})],64)}}})}],Ir=lt({history:st(`/backoffice`),routes:Fr});Ir.onError((e,t)=>{e?.message?.includes?.(`Failed to fetch dynamically imported module`)?localStorage.getItem(`vuetify:dynamic-reload`)?console.error(`Dynamic import error, reloading page did not fix it`,e):(console.log(`Reloading page to fix dynamic import error`),localStorage.setItem(`vuetify:dynamic-reload`,`true`),location.assign(t.fullPath)):console.error(e)}),Ir.isReady().then(()=>{localStorage.removeItem(`vuetify:dynamic-reload`)});function Lr(e){return e?Number(e):void 0}function Rr(e){let t=e;return{idCamp:Lr(t.idCamp),idParticipant:Lr(t.idParticipant)}}function zr(e){Ir.push({path:`/camps`,query:{idCamp:e.IdCamp,idParticipant:e.Id}})}function Br(e){let t=e;return{tab:t.tab,idDossier:Lr(t.idDossier)}}function Vr(e){Ir.push({path:`/inscriptions`,query:{tab:`doss`,idDossier:e}})}function Hr(e){return{idPersonne:Lr(e.idPersonne)}}function Ur(e){Ir.push({path:`/annuaire`,query:{idPersonne:e}})}var Wr=[`innerHTML`],Gr=u(a({__name:`App`,setup(e){let t=ze({text:``,color:`accent`,action:void 0,timeout:4e3}),n=R(``),r=R(``);return Q.onError=(e,t)=>{n.value=e,r.value=t},Q.showMessage=(e,n,r)=>{t.text=e,t.color=n||`success`,t.action=r,t.timeout=1e4,t.timeout=4e3},ct().beforeEach(async(e,t)=>{if(Q.hasToken())return;let n=ht.get();if(n){let t=await Q.Loggin({password:n});if(t&&t.IsValid)return Q.setToken(t.Token,t.IsFondSoutien),Q.showMessage(`Bienvenue !`),e.path==`/`?{path:`/inscriptions`}:void 0}if(e.path!==`/`)return{path:`/`}}),(e,i)=>{let a=De(`router-view`);return L(),O(Ge,null,{default:W(()=>[K(Fe,null,{default:W(()=>[K(a),K(Xe,{style:{"z-index":`10000`},app:``,"model-value":t.text!=``,"onUpdate:modelValue":i[1]||=e=>t.text=``,timeout:t.timeout,color:t.color,location:`bottom left`,"close-on-content-click":``},{default:W(()=>[A(l(t.text)+` `,1),t.action?(L(),O(N,{key:0,onClick:i[0]||=e=>t.action.action(),class:`ml-2`},{default:W(()=>[A(l(t.action.title),1)]),_:1})):f(``,!0)]),_:1},8,[`model-value`,`timeout`,`color`]),K(Xe,{app:``,"model-value":n.value!=``,"onUpdate:modelValue":i[2]||=e=>n.value=``,timeout:4e3,color:`red`},{default:W(()=>[E(`b`,null,l(n.value),1),E(`div`,{innerHTML:r.value},null,8,Wr)]),_:1},8,[`model-value`])]),_:1})]),_:1})}}}));Gr.use(ne).use(Ir),Gr.mount(`#app`);