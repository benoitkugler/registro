import{d as G,c as F,a as z,F as le,b as e,w as l,V as _t,e as f,f as xt,g as T,h as V,i as Pt,t as M,r as wt,j as N,o as b,k as D,l as O,m as B,n as Dt,p as tl,q as L,s as oe,u as St,v as De,x as Pe,y as w,z as Le,A as Re,B as Je,C as Te,D as xl,E as Ce,I as Be,G as Gl,M as Kl,H as Xl,J as al,K as It,L as Ye,N as Ue,O as rl,P as el,Q as Fe,R as Ae,S as He,T as At,U as Ne,W as Zl,X as se,Y as Sl,Z as Mt,_ as $t,$ as et,a0 as Ut,a1 as Rt,a2 as U,a3 as lt,a4 as Q,a5 as ce,a6 as _e,a7 as pe,a8 as xe,a9 as nl,aa as tt,ab as Ie,ac as we,ad as Ft,ae as dl,af as Ee,ag as Lt,ah as Tt,ai as Et,aj as Nt,ak as ml,al as We,am as ht,an as Il,ao as Ot,ap as Bt,aq as jt,ar as Al,as as qt,at as Ht,au as Yt,av as zt,aw as Qt,ax as Wt,ay as Jt,az as Gt,aA as Kt,aB as Xt,aC as Ml,aD as $l,aE as gl,aF as at,aG as Zt,aH as ea,aI as Vl,aJ as la,aK as ta,aL as he,aM as aa,aN as ll,aO as na,aP as ua,aQ as ia,aR as sa,aS as oa,aT as ra,aU as Ul,aV as da,aW as ma,aX as ca,aY as va,aZ as Rl,a_ as Fl,a$ as pa,b0 as fa,b1 as fl,b2 as ya,b3 as Ll,b4 as ba,b5 as ga,b6 as Tl,b7 as Va,b8 as ka,b9 as Ca}from"./VSnackbar-Bb6JWY-C.js";import{u as ul,c as _a,a as xa}from"./vue-router-DWawli3E.js";import{c as x,V as Pa,a as cl,m as nt,b as kl,_ as il,d as wa,i as El,e as Da,f as ut,g as Sa,h as sl,j as Ia,k as Aa,l as Ma,n as $a,o as it,p as Ua,q as Ra}from"./InscriptionRow.vue_vue_type_script_setup_true_lang-CrlTSJx5.js";import{V as Y,a as ue,b as me,c as ie,d as ze,e as Se,f as Z,g as ke,h as ye,i as Oe,j as vl,k as Nl,l as st,m as ot,n as rt}from"./VTextarea-Ex3xMDut.js";import{_ as Ge,a as Fa,V as La,b as Ta,c as Ea,d as hl,e as Ol}from"./VTabs-rFUSGZN3.js";import{_ as Ke,V as Na,a as ha}from"./EventSwitch.vue_vue_type_script_setup_true_lang-CCCo8kGn.js";import{_ as Pl}from"./_plugin-vue_export-helper-DlAUqK2U.js";import{V as je}from"./FileCard.vue_vue_type_script_setup_true_lang-DgknR3t3.js";import{V as Bl,_ as dt,a as Oa,b as Ba,c as ja}from"./SexeField.vue_vue_type_script_setup_true_lang-BlAbdthw.js";import{_ as qa}from"./FilesRow.vue_vue_type_script_setup_true_lang-5Fb-_74J.js";import{_ as Ha}from"./NationaliteField.vue_vue_type_script_setup_true_lang-CSpgB62G.js";import{_ as Ya}from"./DepartementField.vue_vue_type_script_setup_true_lang-DLSprXJb.js";import{V as za}from"./VForm-Be8d6fCl.js";import"./VSheet-DfvWq044.js";import"./VWindowItem-B_jIllBw.js";const yl=G({__name:"NavBar",props:{title:{},hideMenu:{type:Boolean}},setup(t){const o="/static/acve/logo.png",s="v0.6.5",v=t,a=F(()=>x.isFondsSoutien);return(i,m)=>(b(),z(le,null,[e(Pa,{app:"","model-value":!v.hideMenu,"expand-on-hover":"",permanent:"",rail:""},{append:l(()=>[e(Y,{"prepend-icon":"mdi-account-circle-outline",title:a.value?"Fonds de soutien":"Administrateur"},null,8,["title"]),e(Y,{"prepend-icon":"mdi-logout",link:"",to:{path:"/"},color:"primary"},{default:l(()=>[...m[3]||(m[3]=[f(" Se déconnecter ",-1)])]),_:1})]),default:l(()=>[e(Y,{"prepend-icon":"mdi-menu",title:`Registro ${s}`},null,8,["title"]),e(ue),e(Y,{"prepend-icon":"mdi-bed",link:"",to:{path:"/camps"},color:"primary"},{default:l(()=>[...m[0]||(m[0]=[f(" Séjours ",-1)])]),_:1}),e(Y,{"prepend-icon":"mdi-calendar-multiple-check",link:"",to:{path:"/inscriptions"},color:"primary"},{default:l(()=>[...m[1]||(m[1]=[f(" Inscriptions ",-1)])]),_:1}),e(ue),e(Y,{"prepend-icon":"mdi-account-multiple",link:"",to:{path:"/annuaire"},color:"primary"},{default:l(()=>[...m[2]||(m[2]=[f(" Annuaire ",-1)])]),_:1}),e(ue)]),_:1},8,["model-value"]),e(_t,{rounded:"",elevation:"4",color:"secondary"},{append:l(()=>[wt(i.$slots,"default"),m[4]||(m[4]=N("div",{class:"mr-2"},null,-1))]),default:l(()=>[e(xt,null,{default:l(()=>[e(T,null,{default:l(()=>[e(V,{"align-self":"center",cols:"auto"},{default:l(()=>[e(Pt,{width:"60",src:o})]),_:1}),e(V,{"align-self":"center"},{default:l(()=>[f(M(v.title),1)]),_:1})]),_:1})]),_:1})]),_:3})],64))}}),Qa=G({__name:"index",setup(t){const o=ul(),s=D(!1),v=D(""),a=D([]);async function i(){const m=await x.Loggin({password:v.value});m!==void 0&&(m.IsValid?(x.setToken(m.Token,m.IsFondSoutien),x.showMessage("Bienvenue !"),o.push({path:"/inscriptions"})):a.value=["Clé de connection incorrecte."])}return(m,n)=>(b(),z(le,null,[e(yl,{title:"Connection au backoffice","hide-menu":""}),e(St,{class:"fill-height"},{default:l(()=>[e(O,{class:"mx-auto",width:"400px"},{default:l(()=>[e(B,null,{default:l(()=>[e(me,{label:"Clé de connection",modelValue:v.value,"onUpdate:modelValue":n[1]||(n[1]=c=>v.value=c),"error-messages":a.value,type:s.value?void 0:"password",name:"password",onKeydown:n[2]||(n[2]=Dt(tl(()=>v.value.length==0?null:i(),["prevent"]),["enter"]))},{"append-inner":l(()=>[e(L,{class:"ml-2",size:"small",icon:s.value?"mdi-eye":"mdi-eye-off",flat:"",onClick:n[0]||(n[0]=c=>s.value=!s.value)},null,8,["icon"])]),_:1},8,["modelValue","error-messages","type"])]),_:1}),e(oe,null,{default:l(()=>[e(ie),e(L,{disabled:!v.value.length,onClick:i},{default:l(()=>[...n[3]||(n[3]=[f("Se connecter",-1)])]),_:1},8,["disabled"])]),_:1})]),_:1})]),_:1})],64))}}),wl=G({__name:"BoolField",props:De({label:{},hideDetails:{type:Boolean},readonly:{type:Boolean},density:{},persistentHint:{type:Boolean},hint:{}},{modelValue:{type:Boolean,required:!0},modelModifiers:{}}),emits:["update:modelValue"],setup(t){const o=t,s=Pe(t,"modelValue");return(v,a)=>(b(),w(ze,{label:o.label,"model-value":s.value,"onUpdate:modelValue":a[0]||(a[0]=i=>s.value=i||!1),"hide-details":o.hideDetails,readonly:o.readonly,density:o.density,"persistent-hint":o.persistentHint,hint:o.hint},null,8,["label","model-value","hide-details","readonly","density","persistent-hint","hint"]))}}),mt=Re({active:{type:[String,Array],default:void 0},controlHeight:[Number,String],disabled:{type:[Boolean,String,Array],default:null},nextIcon:{type:Be,default:"$next"},prevIcon:{type:Be,default:"$prev"},modeIcon:{type:Be,default:"$subgroup"},text:String,viewMode:{type:String,default:"month"}},"VDatePickerControls"),jl=Le()({name:"VDatePickerControls",props:mt(),emits:{"click:year":()=>!0,"click:month":()=>!0,"click:prev":()=>!0,"click:next":()=>!0,"click:text":()=>!0},setup(t,o){let{emit:s}=o;const{t:v}=Je(),a=F(()=>Array.isArray(t.disabled)?t.disabled.includes("text"):!!t.disabled),i=F(()=>Array.isArray(t.disabled)?t.disabled.includes("mode"):!!t.disabled),m=F(()=>Array.isArray(t.disabled)?t.disabled.includes("prev"):!!t.disabled),n=F(()=>Array.isArray(t.disabled)?t.disabled.includes("next"):!!t.disabled);function c(){s("click:prev")}function u(){s("click:next")}function r(){s("click:year")}function d(){s("click:month")}return Te(()=>N("div",{class:Ce(["v-date-picker-controls"]),style:{"--v-date-picker-controls-height":xl(t.controlHeight)}},[e(L,{class:"v-date-picker-controls__month-btn","data-testid":"month-btn",disabled:a.value,text:t.text,variant:"text",rounded:!0,onClick:d},null),e(L,{class:"v-date-picker-controls__mode-btn","data-testid":"year-btn",disabled:i.value,density:"comfortable",icon:t.modeIcon,variant:"text","aria-label":v("$vuetify.datePicker.ariaLabel.selectYear"),onClick:r},null),e(ie,null,null),N("div",{class:"v-date-picker-controls__month"},[e(L,{"data-testid":"prev-month",disabled:m.value,density:"comfortable",icon:t.prevIcon,variant:"text","aria-label":v("$vuetify.datePicker.ariaLabel.previousMonth"),onClick:c},null),e(L,{"data-testid":"next-month",disabled:n.value,icon:t.nextIcon,density:"comfortable",variant:"text","aria-label":v("$vuetify.datePicker.ariaLabel.nextMonth"),onClick:u},null)])])),{}}}),Wa=Re({appendIcon:Be,color:String,header:String,transition:String,onClick:It()},"VDatePickerHeader"),ql=Le()({name:"VDatePickerHeader",props:Wa(),emits:{click:()=>!0,"click:append":()=>!0},setup(t,o){let{emit:s,slots:v}=o;const{backgroundColorClasses:a,backgroundColorStyles:i}=Gl(()=>t.color);function m(){s("click")}function n(){s("click:append")}return Te(()=>{const c=!!(v.default||t.header),u=!!(v.append||t.appendIcon);return N("div",{class:Ce(["v-date-picker-header",{"v-date-picker-header--clickable":!!t.onClick},a.value]),style:al(i.value),onClick:m},[v.prepend&&N("div",{key:"prepend",class:"v-date-picker-header__prepend"},[v.prepend()]),c&&e(Kl,{key:"content",name:t.transition},{default:()=>[N("div",{key:t.header,class:"v-date-picker-header__content"},[v.default?.()??t.header])]}),u&&N("div",{class:"v-date-picker-header__append"},[v.append?e(Xl,{key:"append-defaults",disabled:!t.appendIcon,defaults:{VBtn:{icon:t.appendIcon,variant:"text"}}},{default:()=>[v.append?.()]}):e(L,{key:"append-btn",icon:t.appendIcon,variant:"text",onClick:n},null)])])}),{}}}),Ja=Re({allowedDates:[Array,Function],disabled:{type:Boolean,default:null},displayValue:null,modelValue:Array,month:[Number,String],max:null,min:null,showAdjacentMonths:Boolean,year:[Number,String],weekdays:{type:Array,default:()=>[0,1,2,3,4,5,6]},weeksInMonth:{type:String,default:"dynamic"},firstDayOfWeek:{type:[Number,String],default:void 0},firstDayOfYear:{type:[Number,String],default:void 0},weekdayFormat:String},"calendar");function Ga(t){const o=Ye(),s=Ue(t,"modelValue",[],C=>rl(C).map(_=>o.date(_))),v=F(()=>t.displayValue?o.date(t.displayValue):s.value.length>0?o.date(s.value[0]):t.min?o.date(t.min):Array.isArray(t.allowedDates)?o.date(t.allowedDates[0]):o.date()),a=Ue(t,"year",void 0,C=>{const _=C!=null?Number(C):o.getYear(v.value);return o.startOfYear(o.setYear(o.date(),_))},C=>o.getYear(C)),i=Ue(t,"month",void 0,C=>{const _=C!=null?Number(C):o.getMonth(v.value),P=o.setYear(o.startOfMonth(o.date()),o.getYear(a.value));return o.setMonth(P,_)},C=>o.getMonth(C)),m=F(()=>{const C=o.toJsDate(o.startOfWeek(o.date(),t.firstDayOfWeek)).getDay();return o.getWeekdays(t.firstDayOfWeek,t.weekdayFormat).filter((_,P)=>t.weekdays.includes((P+C)%7))}),n=F(()=>{const C=o.getWeekArray(i.value,t.firstDayOfWeek),_=C.flat(),P=6*7;if(t.weeksInMonth==="static"&&_.length<P){const j=_[_.length-1];let K=[];for(let S=1;S<=P-_.length;S++)K.push(o.addDays(j,S)),S%7===0&&(C.push(K),K=[])}return C});function c(C,_){return C.filter(P=>t.weekdays.includes(o.toJsDate(P).getDay())).map((P,j)=>{const K=o.toISO(P),S=!o.isSameMonth(P,i.value),y=o.isSameDay(P,o.startOfMonth(i.value)),ee=o.isSameDay(P,o.endOfMonth(i.value)),be=o.isSameDay(P,i.value),W=t.weekdays.length;return{date:P,formatted:o.format(P,"keyboardDate"),isAdjacent:S,isDisabled:I(P),isEnd:ee,isHidden:S&&!t.showAdjacentMonths,isSame:be,isSelected:s.value.some(A=>o.isSameDay(P,A)),isStart:y,isToday:o.isSameDay(P,_),isWeekEnd:j%W===W-1,isWeekStart:j%W===0,isoDate:K,localized:o.format(P,"dayOfMonth"),month:o.getMonth(P),year:o.getYear(P)}})}const u=F(()=>{const C=o.startOfWeek(v.value,t.firstDayOfWeek),_=[];for(let j=0;j<=6;j++)_.push(o.addDays(C,j));const P=o.date();return c(_,P)}),r=F(()=>{const C=n.value.flat(),_=o.date();return c(C,_)}),d=F(()=>n.value.map(C=>C.length?o.getWeek(C[0],t.firstDayOfWeek,t.firstDayOfYear):null)),{minDate:p,maxDate:k}=ct(t);function I(C){if(t.disabled)return!0;const _=o.date(C);return p.value&&o.isBefore(o.endOfDay(_),p.value)||k.value&&o.isAfter(_,k.value)?!0:Array.isArray(t.allowedDates)&&t.allowedDates.length>0?!t.allowedDates.some(P=>o.isSameDay(o.date(P),_)):typeof t.allowedDates=="function"?!t.allowedDates(_):!1}return{displayValue:v,daysInMonth:r,daysInWeek:u,genDays:c,model:s,weeksInMonth:n,weekdayLabels:m,weekNumbers:d}}function ct(t){const o=Ye(),s=F(()=>{if(!t.min)return null;const m=o.date(t.min);return o.isValid(m)?m:null}),v=F(()=>{if(!t.max)return null;const m=o.date(t.max);return o.isValid(m)?m:null});function a(m){return s.value&&o.isBefore(m,s.value)?s.value:v.value&&o.isAfter(m,v.value)?v.value:m}function i(m){return(!s.value||o.isAfter(m,s.value))&&(!v.value||o.isBefore(m,v.value))}return{minDate:s,maxDate:v,clampDate:a,isInAllowedRange:i}}const vt=Re({color:String,hideWeekdays:Boolean,multiple:[Boolean,Number,String],showWeek:Boolean,transition:{type:String,default:"picker-transition"},reverseTransition:{type:String,default:"picker-reverse-transition"},...He(Ja(),["displayValue"])},"VDatePickerMonth"),Hl=Le()({name:"VDatePickerMonth",props:vt(),emits:{"update:modelValue":t=>!0,"update:month":t=>!0,"update:year":t=>!0},setup(t,o){let{emit:s,slots:v}=o;const a=D(),{t:i}=Je(),{daysInMonth:m,model:n,weekNumbers:c,weekdayLabels:u}=Ga(t),r=Ye(),d=el(),p=el(),k=el(!1),I=Fe(()=>k.value?t.reverseTransition:t.transition);t.multiple==="range"&&n.value.length>0&&(d.value=n.value[0],n.value.length>1&&(p.value=n.value[n.value.length-1]));const C=F(()=>{const S=["number","string"].includes(typeof t.multiple)?Number(t.multiple):1/0;return n.value.length>=S});Ae(m,(S,y)=>{y&&(k.value=r.isBefore(S[0].date,y[0].date))});function _(S){const y=r.startOfDay(S);if(n.value.length===0?d.value=void 0:n.value.length===1&&(d.value=n.value[0],p.value=void 0),!d.value)d.value=y,n.value=[d.value];else if(p.value)d.value=S,p.value=void 0,n.value=[d.value];else{if(r.isSameDay(y,d.value)){d.value=void 0,n.value=[];return}else r.isBefore(y,d.value)?(p.value=r.endOfDay(d.value),d.value=y):p.value=r.endOfDay(y);n.value=At(r,d.value,p.value)}}function P(S){const y=r.format(S.date,"fullDateWithWeekday"),ee=S.isToday?"currentDate":"selectDate";return i(`$vuetify.datePicker.ariaLabel.${ee}`,y)}function j(S){const y=n.value.findIndex(ee=>r.isSameDay(ee,S));if(y===-1)n.value=[...n.value,S];else{const ee=[...n.value];ee.splice(y,1),n.value=ee}}function K(S){t.multiple==="range"?_(S):t.multiple?j(S):n.value=[S]}Te(()=>N("div",{class:"v-date-picker-month",style:{"--v-date-picker-days-in-week":t.weekdays.length}},[t.showWeek&&N("div",{key:"weeks",class:"v-date-picker-month__weeks"},[!t.hideWeekdays&&N("div",{key:"hide-week-days",class:"v-date-picker-month__day"},[f(" ")]),c.value.map(S=>N("div",{class:Ce(["v-date-picker-month__day","v-date-picker-month__day--adjacent"])},[S]))]),e(Kl,{name:I.value},{default:()=>[N("div",{ref:a,key:m.value[0].date?.toString(),class:"v-date-picker-month__days"},[!t.hideWeekdays&&u.value.map(S=>N("div",{class:Ce(["v-date-picker-month__day","v-date-picker-month__weekday"])},[S])),m.value.map((S,y)=>{const ee={props:{class:"v-date-picker-month__day-btn",color:S.isSelected||S.isToday?t.color:void 0,disabled:S.isDisabled,icon:!0,ripple:!1,text:S.localized,variant:S.isSelected?"flat":S.isToday?"outlined":"text","aria-label":P(S),"aria-current":S.isToday?"date":void 0,onClick:()=>K(S.date)},item:S,i:y};return C.value&&!S.isSelected&&(S.isDisabled=!0),N("div",{class:Ce(["v-date-picker-month__day",{"v-date-picker-month__day--adjacent":S.isAdjacent,"v-date-picker-month__day--hide-adjacent":S.isHidden,"v-date-picker-month__day--selected":S.isSelected,"v-date-picker-month__day--week-end":S.isWeekEnd,"v-date-picker-month__day--week-start":S.isWeekStart}]),"data-v-date":S.isDisabled?void 0:S.isoDate},[(t.showAdjacentMonths||!S.isAdjacent)&&(v.day?.(ee)??e(L,ee.props,null))])})])]})]))}}),pt=Re({color:String,height:[String,Number],min:null,max:null,modelValue:Number,year:Number,allowedMonths:[Array,Function]},"VDatePickerMonths"),Yl=Le()({name:"VDatePickerMonths",props:pt(),emits:{"update:modelValue":t=>!0},setup(t,o){let{emit:s,slots:v}=o;const a=Ye(),i=Ue(t,"modelValue"),m=F(()=>{let c=a.startOfYear(a.date());return t.year&&(c=a.setYear(c,t.year)),Ne(12).map(u=>{const r=a.format(c,"monthShort"),d=a.format(c,"month"),p=!!(!n(u)||t.min&&a.isAfter(a.startOfMonth(a.date(t.min)),c)||t.max&&a.isAfter(c,a.startOfMonth(a.date(t.max))));return c=a.getNextMonth(c),{isDisabled:p,text:r,label:d,value:u}})});Zl(()=>{i.value=i.value??a.getMonth(a.date())});function n(c){return Array.isArray(t.allowedMonths)&&t.allowedMonths.length?t.allowedMonths.includes(c):typeof t.allowedMonths=="function"?t.allowedMonths(c):!0}return Te(()=>N("div",{class:"v-date-picker-months",style:{height:xl(t.height)}},[N("div",{class:"v-date-picker-months__content"},[m.value.map((c,u)=>{const r={active:i.value===u,ariaLabel:c.label,color:i.value===u?t.color:void 0,disabled:c.isDisabled,rounded:!0,text:c.text,variant:i.value===c.value?"flat":"text",onClick:()=>d(u)};function d(p){if(i.value===p){s("update:modelValue",i.value);return}i.value=p}return v.month?.({month:c,i:u,props:r})??e(L,se({key:"month"},r),null)})])])),{}}}),ft=Re({color:String,height:[String,Number],min:null,max:null,modelValue:Number,allowedYears:[Array,Function]},"VDatePickerYears"),zl=Le()({name:"VDatePickerYears",props:ft(),directives:{vIntersect:Sl},emits:{"update:modelValue":t=>!0},setup(t,o){let{emit:s,slots:v}=o;const a=Ye(),i=Ue(t,"modelValue"),m=F(()=>{const r=a.getYear(a.date());let d=r-100,p=r+52;t.min&&(d=a.getYear(a.date(t.min))),t.max&&(p=a.getYear(a.date(t.max)));let k=a.startOfYear(a.date());return k=a.setYear(k,d),Ne(p-d+1,d).map(I=>{const C=a.format(k,"year");return k=a.setYear(k,a.getYear(k)+1),{text:C,value:I,isDisabled:!u(I)}})});Zl(()=>{i.value=i.value??a.getYear(a.date())});const n=Mt();function c(){n.el?.focus(),n.el?.scrollIntoView({block:"center"})}function u(r){return Array.isArray(t.allowedYears)&&t.allowedYears.length?t.allowedYears.includes(r):typeof t.allowedYears=="function"?t.allowedYears(r):!0}return Te(()=>$t(N("div",{class:"v-date-picker-years",style:{height:xl(t.height)}},[N("div",{class:"v-date-picker-years__content"},[m.value.map((r,d)=>{const p={ref:i.value===r.value?n:void 0,active:i.value===r.value,color:i.value===r.value?t.color:void 0,rounded:!0,text:r.text,disabled:r.isDisabled,variant:i.value===r.value?"flat":"text",onClick:()=>{if(i.value===r.value){s("update:modelValue",i.value);return}i.value=r.value}};return v.year?.({year:r,i:d,props:p})??e(L,se({key:"month"},p),null)})])]),[[Sl,{handler:c},null,{once:!0}]])),{}}}),Ka=Re({header:{type:String,default:"$vuetify.datePicker.header"},headerColor:String,...mt(),...vt({weeksInMonth:"static"}),...He(pt(),["modelValue"]),...He(ft(),["modelValue"]),...nt({title:"$vuetify.datePicker.title"}),modelValue:null},"VDatePicker"),Xa=Le()({name:"VDatePicker",props:Ka(),emits:{"update:modelValue":t=>!0,"update:month":t=>!0,"update:year":t=>!0,"update:viewMode":t=>!0},setup(t,o){let{emit:s,slots:v}=o;const a=Ye(),{t:i}=Je(),{rtlClasses:m}=et(),n=Ue(t,"modelValue",void 0,g=>rl(g).map($=>a.date($)),g=>t.multiple?g:g[0]),c=Ue(t,"viewMode"),{minDate:u,maxDate:r,clampDate:d}=ct(t),p=F(()=>{const g=a.date(),$=n.value?.[0]?a.date(n.value[0]):d(g);return $&&a.isValid($)?$:g}),k=Fe(()=>t.headerColor??t.color),I=Ue(t,"month"),C=F({get:()=>Number(I.value??a.getMonth(a.startOfMonth(p.value))),set:g=>I.value=g}),_=Ue(t,"year"),P=F({get:()=>Number(_.value??a.getYear(a.startOfYear(a.setMonth(p.value,C.value)))),set:g=>_.value=g}),j=el(!1),K=F(()=>t.multiple&&n.value.length>1?i("$vuetify.datePicker.itemsSelected",n.value.length):n.value[0]&&a.isValid(n.value[0])?a.format(a.date(n.value[0]),"normalDateWithWeekday"):i(t.header)),S=F(()=>{let g=a.date();return g=a.setDate(g,1),g=a.setMonth(g,C.value),g=a.setYear(g,P.value),a.format(g,"monthAndYear")}),y=Fe(()=>`date-picker-header${j.value?"-reverse":""}-transition`),ee=F(()=>{if(t.disabled)return!0;const g=[];if(c.value!=="month")g.push("prev","next");else{let $=a.date();if($=a.startOfMonth($),$=a.setMonth($,C.value),$=a.setYear($,P.value),u.value){const R=a.addDays(a.startOfMonth($),-1);a.isAfter(u.value,R)&&g.push("prev")}if(r.value){const R=a.addDays(a.endOfMonth($),1);a.isAfter(R,r.value)&&g.push("next")}}return g}),be=F(()=>t.allowedYears||te),W=F(()=>t.allowedMonths||ne);function A(g,$){const R=t.allowedDates;if(typeof R!="function")return!0;const fe=1+Rt(a,g,$);for(let ae=0;ae<fe;ae++)if(R(a.addDays(g,ae)))return!0;return!1}function te(g){if(typeof t.allowedDates=="function"){const $=a.parseISO(`${g}-01-01`);return A($,a.endOfYear($))}if(Array.isArray(t.allowedDates)&&t.allowedDates.length){for(const $ of t.allowedDates)if(a.getYear(a.date($))===g)return!0;return!1}return!0}function ne(g){if(typeof t.allowedDates=="function"){const $=String(g+1).padStart(2,"0"),R=a.parseISO(`${P.value}-${$}-01`);return A(R,a.endOfMonth(R))}if(Array.isArray(t.allowedDates)&&t.allowedDates.length){for(const $ of t.allowedDates)if(a.getYear(a.date($))===P.value&&a.getMonth(a.date($))===g)return!0;return!1}return!0}function h(){C.value<11?C.value++:(P.value++,C.value=0,J()),Ve()}function q(){C.value>0?C.value--:(P.value--,C.value=11,J()),Ve()}function re(){c.value="month"}function X(){c.value=c.value==="months"?"month":"months"}function ge(){c.value=c.value==="year"?"month":"year"}function Ve(){c.value==="months"&&X()}function J(){c.value==="year"&&ge()}return Ae(n,(g,$)=>{const R=rl($),fe=rl(g);if(!fe.length)return;const ae=a.date(R[R.length-1]),Me=a.date(fe[fe.length-1]),$e=a.getMonth(Me),E=a.getYear(Me);$e!==C.value&&(C.value=$e,Ve()),E!==P.value&&(P.value=E,J()),j.value=a.isBefore(ae,Me)}),Te(()=>{const g=cl.filterProps(t),$=jl.filterProps(t),R=ql.filterProps(t),fe=Hl.filterProps(t),ae=He(Yl.filterProps(t),["modelValue"]),Me=He(zl.filterProps(t),["modelValue"]),$e={color:k.value,header:K.value,transition:y.value};return e(cl,se(g,{color:k.value,class:["v-date-picker",`v-date-picker--${c.value}`,{"v-date-picker--show-week":t.showWeek},m.value,t.class],style:t.style}),{title:()=>v.title?.()??N("div",{class:"v-date-picker__title"},[i(t.title)]),header:()=>v.header?e(Xl,{defaults:{VDatePickerHeader:{...$e}}},{default:()=>[v.header?.($e)]}):e(ql,se({key:"header"},R,$e,{onClick:c.value!=="month"?re:void 0}),{prepend:v.prepend,append:v.append}),default:()=>N(le,null,[e(jl,se($,{disabled:ee.value,text:S.value,"onClick:next":h,"onClick:prev":q,"onClick:month":X,"onClick:year":ge}),null),e(Ut,{hideOnLeave:!0},{default:()=>[c.value==="months"?e(Yl,se({key:"date-picker-months"},ae,{modelValue:C.value,"onUpdate:modelValue":[E=>C.value=E,Ve],min:u.value,max:r.value,year:P.value,allowedMonths:W.value}),{month:v.month}):c.value==="year"?e(zl,se({key:"date-picker-years"},Me,{modelValue:P.value,"onUpdate:modelValue":[E=>P.value=E,J],min:u.value,max:r.value,allowedYears:be.value}),{year:v.year}):e(Hl,se({key:"date-picker-month"},fe,{modelValue:n.value,"onUpdate:modelValue":E=>n.value=E,month:C.value,"onUpdate:month":[E=>C.value=E,Ve],year:P.value,"onUpdate:year":[E=>P.value=E,J],min:u.value,max:r.value}),{day:v.day})]})]),actions:v.actions})}),{}}}),Za=G({__name:"DateField",props:De({label:{},hideDetails:{type:Boolean},readonly:{type:Boolean}},{modelValue:{required:!0},modelModifiers:{}}),emits:["update:modelValue"],setup(t){const o=t,s=Pe(t,"modelValue"),v=Ye();function a(m){i.value=!1,s.value=lt(m)}const i=D(!1);return(m,n)=>o.readonly?(b(),w(me,{key:0,class:"center-text",variant:"outlined",density:"compact","hide-details":o.hideDetails,label:o.label,"model-value":U(v).parseISO(s.value).toLocaleDateString(),readonly:""},null,8,["hide-details","label","model-value"])):(b(),w(Se,{key:1,"close-on-content-click":!1,modelValue:i.value,"onUpdate:modelValue":n[1]||(n[1]=c=>i.value=c)},{activator:l(({props:c})=>[e(me,se({class:"center-text"},c,{variant:"outlined",density:"compact","hide-details":o.hideDetails,label:o.label,"model-value":U(v).parseISO(s.value).toLocaleDateString()}),null,16,["hide-details","label","model-value"])]),default:l(()=>[e(Xa,{"model-value":U(v).parseISO(s.value),"onUpdate:modelValue":n[0]||(n[0]=c=>a(c))},null,8,["model-value"])]),_:1},8,["modelValue"]))}}),yt=Pl(Za,[["__scopeId","data-v-1e184428"]]),en=G({__name:"OptionStatut",props:De({camp:{}},{modelValue:{required:!0},modelModifiers:{}}),emits:["update:modelValue"],setup(t){const o=t,s=Pe(t,"modelValue");function v(){const m=s.value?.length?s.value.map(u=>u.Id):[0],c={Id:Math.max(...m)+1,Label:"",Description:"",Prix:o.camp.Prix.Cent};s.value=(s.value||[]).concat(c),a.value=c}const a=D(null);function i(m){s.value=(s.value||[]).filter(n=>n.Id!=m.Id)}return(m,n)=>{const c=Ke;return b(),w(O,{subtitle:"Le prix dépend du statut du participant, à choisir parmi la liste ci-dessous."},{append:l(()=>[e(L,{icon:"",size:"x-small",onClick:v},{default:l(()=>[e(pe,{color:"green"},{default:l(()=>[...n[4]||(n[4]=[f("mdi-plus",-1)])]),_:1})]),_:1})]),default:l(()=>[a.value!=null?(b(),w(Z,{key:0,"model-value":a.value!=null,"onUpdate:modelValue":n[3]||(n[3]=u=>a.value=null),"max-width":"500px"},{default:l(()=>[e(O,{title:"Modifier le statut"},{default:l(()=>[e(B,null,{default:l(()=>[e(T,null,{default:l(()=>[e(V,{cols:"12"},{default:l(()=>[e(me,{autofocus:"",label:"Statut",modelValue:a.value.Label,"onUpdate:modelValue":n[0]||(n[0]=u=>a.value.Label=u),density:"compact",variant:"outlined","hide-details":""},null,8,["modelValue"])]),_:1}),e(V,{cols:"12"},{default:l(()=>[e(me,{label:"Description",modelValue:a.value.Description,"onUpdate:modelValue":n[1]||(n[1]=u=>a.value.Description=u),density:"compact",variant:"outlined","hide-details":""},null,8,["modelValue"])]),_:1}),e(V,{cols:"12"},{default:l(()=>[e(c,{"model-value":{Cent:a.value.Prix,Currency:o.camp.Prix.Currency},"onUpdate:modelValue":n[2]||(n[2]=u=>a.value.Prix=u.Cent),label:"Prix","readonly-currency":""},null,8,["model-value"])]),_:1})]),_:1})]),_:1})]),_:1})]),_:1},8,["model-value"])):Q("",!0),e(B,{class:"py-0"},{default:l(()=>[e(ke,null,{default:l(()=>[s.value?.length?Q("",!0):(b(),w(Y,{key:0},{default:l(()=>[...n[5]||(n[5]=[N("i",null,"Aucun statut n'est encore défini.",-1)])]),_:1})),(b(!0),z(le,null,ce(s.value,u=>(b(),w(Y,{title:u.Label,subtitle:u.Description,onClick:r=>a.value=u},{append:l(()=>[e(T,null,{default:l(()=>[e(V,{"align-self":"center"},{default:l(()=>[e(ye,null,{default:l(()=>[f(M(U(_e).montant({Cent:u.Prix,Currency:t.camp.Prix.Currency})),1)]),_:2},1024)]),_:2},1024),e(V,{"align-self":"center",cols:"auto"},{default:l(()=>[e(L,{icon:"",size:"x-small",class:"my-1",onClick:tl(r=>i(u),["stop"])},{default:l(()=>[e(pe,{color:"red"},{default:l(()=>[...n[6]||(n[6]=[f("mdi-delete",-1)])]),_:1})]),_:1},8,["onClick"])]),_:2},1024)]),_:2},1024)]),_:2},1032,["title","subtitle","onClick"]))),256))]),_:1})]),_:1})]),_:1})}}}),ln=G({__name:"OptionJournee",props:De({camp:{}},{modelValue:{required:!0},modelModifiers:{}}),emits:["update:modelValue"],setup(t){const o=t,s=Pe(t,"modelValue");Ae(()=>s.value,v,{immediate:!0});function v(){const i=o.camp.Duree;s.value?.length!=i&&(s.value=Array.from({length:i}).map(m=>0))}function a(){const i=s.value,m=i[0];for(let n=0;n<i.length;n++)i[n]=m}return(i,m)=>{const n=Ke;return b(),w(O,{subtitle:"Le prix est variable en fonction des jours de participation au camp."},{append:l(()=>[e(je,{text:"Appliquer le prix du premier jour à tous."},{activator:l(({props:c})=>[e(L,se(c,{icon:"mdi-arrow-expand",size:"x-small",disabled:!(s.value||[])[0],onClick:a}),null,16,["disabled"])]),_:1})]),default:l(()=>[e(B,null,{default:l(()=>[e(T,null,{default:l(()=>[(b(!0),z(le,null,ce(s.value,(c,u)=>(b(),w(V,{cols:"3"},{default:l(()=>[e(n,{label:`Jour ${u+1}`,"model-value":{Cent:c,Currency:o.camp.Prix.Currency},"onUpdate:modelValue":r=>s.value[u]=r.Cent,"readonly-currency":""},null,8,["label","model-value","onUpdate:modelValue"])]),_:2},1024))),256))]),_:1})]),_:1})]),_:1})}}}),tn={key:0,class:"text-center"},an=G({__name:"CampOptionsPrix",props:De({camp:{}},{optionPrix:{required:!0},optionPrixModifiers:{},optionQf:{required:!0},optionQfModifiers:{}}),emits:["update:optionPrix","update:optionQf"],setup(t){const o=t,s=Pe(t,"optionPrix"),v=Pe(t,"optionQf"),a=F(()=>xe.isQuotientFamilialActive(v.value)),i=nl(tt);return(m,n)=>{const c=Ge;return b(),w(O,{title:"Options sur le prix",subtitle:"Permet de modifier le prix de base du séjour",width:"1000px"},{default:l(()=>[e(B,null,{default:l(()=>[e(T,null,{default:l(()=>[e(V,{"align-self":"center"},{default:l(()=>[e(ze,{"model-value":a.value,"onUpdate:modelValue":n[0]||(n[0]=u=>v.value[3]=u?100:0),"hide-details":"",label:"Prix au quotient familial"},null,8,["model-value"])]),_:1}),e(V,{"align-self":"center"},{default:l(()=>[e(c,{suffix:"%",min:0,max:100,disabled:!a.value,"hide-details":"","readonly-currency":"",label:"entre 1 et 359",modelValue:v.value[0],"onUpdate:modelValue":n[1]||(n[1]=u=>v.value[0]=u)},null,8,["disabled","modelValue"])]),_:1}),e(V,{"align-self":"center"},{default:l(()=>[e(c,{suffix:"%",min:0,max:100,disabled:!a.value,"hide-details":"","readonly-currency":"",label:"entre 360 et 564",modelValue:v.value[1],"onUpdate:modelValue":n[2]||(n[2]=u=>v.value[1]=u)},null,8,["disabled","modelValue"])]),_:1}),e(V,{"align-self":"center"},{default:l(()=>[e(c,{suffix:"%",min:0,max:100,disabled:!a.value,"hide-details":"","readonly-currency":"",label:"entre 565 et 714",modelValue:v.value[2],"onUpdate:modelValue":n[3]||(n[3]=u=>v.value[2]=u)},null,8,["disabled","modelValue"])]),_:1}),e(V,{"align-self":"center"},{default:l(()=>[e(c,{suffix:"%",min:0,max:100,disabled:!0,"hide-details":"","readonly-currency":"",label:"plus de 715",modelValue:v.value[3],"onUpdate:modelValue":n[4]||(n[4]=u=>v.value[3]=u)},null,8,["modelValue"])]),_:1})]),_:1}),e(ue,{thickness:"1",class:"my-2"}),e(T,{class:"my-2"},{default:l(()=>[e(V,{"align-self":"center",cols:"4"},{default:l(()=>[e(Oe,{variant:"outlined",density:"comfortable","hide-details":"",items:U(i),label:"Option sur le prix",modelValue:s.value.Active,"onUpdate:modelValue":n[5]||(n[5]=u=>s.value.Active=u)},null,8,["items","modelValue"])]),_:1}),e(V,{"align-self":"center"},{default:l(()=>[s.value.Active==U(Ie).NoOption?(b(),z("div",tn,[...n[8]||(n[8]=[N("i",null,"Aucune modification sur le prix de base.",-1)])])):s.value.Active==U(Ie).PrixStatut?(b(),w(en,{key:1,camp:o.camp,modelValue:s.value.Statuts,"onUpdate:modelValue":n[6]||(n[6]=u=>s.value.Statuts=u)},null,8,["camp","modelValue"])):s.value.Active==U(Ie).PrixJour?(b(),w(ln,{key:2,camp:o.camp,modelValue:s.value.Jours,"onUpdate:modelValue":n[7]||(n[7]=u=>s.value.Jours=u)},null,8,["camp","modelValue"])):Q("",!0)]),_:1})]),_:1})]),_:1})]),_:1})}}}),nn=G({__name:"CampMetaEdit",props:De({metaEntriesHints:{}},{modelValue:{required:!0},modelModifiers:{}}),emits:["update:modelValue"],setup(t){const o=t,s=Pe(t,"modelValue"),v=D(Object.entries(s.value||{}));function a(){const i=Object.fromEntries(v.value);s.value=i}return F(()=>{const i=v.value.map(n=>n[0]);return i.includes("")?!0:new Set(i).size!=v.value.length}),(i,m)=>(b(),w(O,{subtitle:"Métadonnées exposées sur l'API publique"},{append:l(()=>[e(L,{size:"small",class:"ml-2",onClick:m[0]||(m[0]=n=>{v.value.push(["",""]),a()})},{prepend:l(()=>[e(pe,{color:"green"},{default:l(()=>[...m[1]||(m[1]=[f("mdi-plus",-1)])]),_:1})]),default:l(()=>[m[2]||(m[2]=f(" Ajouter une valeur",-1))]),_:1})]),default:l(()=>[e(B,{class:"pt-2"},{default:l(()=>[(b(!0),z(le,null,ce(v.value,(n,c)=>(b(),w(T,null,{default:l(()=>[e(V,{cols:"4"},{default:l(()=>[e(Bl,{variant:"outlined",density:"compact","hide-details":"",label:"Clé",modelValue:n[0],"onUpdate:modelValue":[u=>n[0]=u,a],autofocus:"",items:o.metaEntriesHints.keys},null,8,["modelValue","onUpdate:modelValue","items"])]),_:2},1024),e(V,null,{default:l(()=>[e(Bl,{variant:"outlined",density:"compact","hide-details":"",label:"Valeur",modelValue:n[1],"onUpdate:modelValue":[u=>n[1]=u,a],items:o.metaEntriesHints.values},null,8,["modelValue","onUpdate:modelValue","items"])]),_:2},1024),e(V,{cols:"auto"},{default:l(()=>[e(L,{icon:"",size:"small",flat:"",onClick:u=>{v.value.splice(c,1),a()}},{default:l(()=>[e(pe,{color:"red"},{default:l(()=>[...m[3]||(m[3]=[f("mdi-close",-1)])]),_:1})]),_:1},8,["onClick"])]),_:2},1024)]),_:2},1024))),256))]),_:1})]),_:1}))}}),un=G({__name:"CampEdit",props:{camp:{},preselectionUrl:{},metaEntriesHints:{}},emits:["save"],setup(t,{emit:o}){const s=t,v=o,a=D(we(s.camp)),i=F(()=>new Date(a.value.DateDebut).getFullYear()>=2020&&a.value.Places>=1&&a.value.Nom!=""&&a.value.AgeMax>=a.value.AgeMin&&a.value.OptionQuotientFamilial.every(u=>0<=u&&u<=100)&&!(a.value.OptionPrix.Active==Ie.PrixStatut&&!a.value.OptionPrix.Statuts?.length)&&!(a.value.OptionPrix.Active==Ie.PrixJour&&a.value.OptionPrix.Jours?.length!=a.value.Duree)),m=nl(Ft);function n(u){const r=xe.isQuotientFamilialActive(u.OptionQuotientFamilial),d=u.OptionPrix.Active!=Ie.NoOption;if(!r&&!d)return"Aucune";const p=[];return xe.isQuotientFamilialActive(u.OptionQuotientFamilial)&&p.push("Quotient familial"),u.OptionPrix.Active!=Ie.NoOption&&p.push(tt[u.OptionPrix.Active]),p.join(", ")}async function c(){await dl(s.preselectionUrl),x.showMessage("URL copiée dans le presse-papier.")}return(u,r)=>{const d=yt,p=Ge,k=Ke,I=wl;return b(),w(O,{title:"Paramètres du séjour",subtitle:U(xe).label(s.camp)},{default:l(()=>[e(B,null,{default:l(()=>[e(O,{class:"my-2",subtitle:"Général"},{default:l(()=>[e(B,null,{default:l(()=>[e(T,null,{default:l(()=>[e(V,null,{default:l(()=>[e(me,{autofocus:"","hide-details":"",label:"Nom",density:"compact",variant:"outlined",modelValue:a.value.Nom,"onUpdate:modelValue":r[0]||(r[0]=C=>a.value.Nom=C)},null,8,["modelValue"])]),_:1}),e(V,null,{default:l(()=>[e(me,{"hide-details":"",label:"Lieu",density:"compact",variant:"outlined",modelValue:a.value.Lieu,"onUpdate:modelValue":r[1]||(r[1]=C=>a.value.Lieu=C)},null,8,["modelValue"])]),_:1}),e(V,null,{default:l(()=>[e(me,{"hide-details":"",label:"Numéro d'agrément",density:"compact",variant:"outlined",modelValue:a.value.Agrement,"onUpdate:modelValue":r[2]||(r[2]=C=>a.value.Agrement=C)},null,8,["modelValue"])]),_:1})]),_:1}),e(T,null,{default:l(()=>[e(V,{"align-self":"center"},{default:l(()=>[e(d,{modelValue:a.value.DateDebut,"onUpdate:modelValue":r[3]||(r[3]=C=>a.value.DateDebut=C),label:"Date de début","hide-details":""},null,8,["modelValue"])]),_:1}),e(V,{"align-self":"center"},{default:l(()=>[e(p,{label:"Durée (en jours)",modelValue:a.value.Duree,"onUpdate:modelValue":r[4]||(r[4]=C=>a.value.Duree=C),"hide-details":""},null,8,["modelValue"])]),_:1}),e(V,{"align-self":"center"},{default:l(()=>[e(d,{"model-value":U(xe).dateFin(a.value),label:"Date de fin",readonly:"","hide-details":""},null,8,["model-value"])]),_:1})]),_:1})]),_:1})]),_:1}),e(O,{class:"my-2",subtitle:"Prix"},{default:l(()=>[e(B,null,{default:l(()=>[e(T,null,{default:l(()=>[e(V,{"align-self":"center",cols:"6"},{default:l(()=>[e(k,{label:"Prix",modelValue:a.value.Prix,"onUpdate:modelValue":r[5]||(r[5]=C=>a.value.Prix=C),"hide-details":""},null,8,["modelValue"])]),_:1}),e(V,{"align-self":"center",cols:"6",class:"text-center"},{default:l(()=>[e(Se,{"close-on-content-click":!1},{activator:l(({props:C})=>[e(me,se(C,{readonly:"",label:"Option sur le prix",variant:"outlined",density:"compact","hide-details":"","model-value":n(a.value)}),null,16,["model-value"])]),default:l(()=>[e(an,{camp:a.value,"option-prix":a.value.OptionPrix,"onUpdate:optionPrix":r[6]||(r[6]=C=>a.value.OptionPrix=C),"option-qf":a.value.OptionQuotientFamilial,"onUpdate:optionQf":r[7]||(r[7]=C=>a.value.OptionQuotientFamilial=C)},null,8,["camp","option-prix","option-qf"])]),_:1})]),_:1})]),_:1})]),_:1})]),_:1}),e(O,{class:"my-2",subtitle:"Visibilité et inscriptions"},{default:l(()=>[e(B,null,{default:l(()=>[e(T,null,{default:l(()=>[e(V,{"align-self":"center"},{default:l(()=>[e(Oe,{label:"Ouverture aux inscriptions",variant:"outlined",density:"compact",items:U(m),"hide-details":"",modelValue:a.value.Statut,"onUpdate:modelValue":r[8]||(r[8]=C=>a.value.Statut=C)},null,8,["items","modelValue"])]),_:1}),e(V,{"align-self":"center"},{default:l(()=>[e(kl,{label:"Camp sans inscription",modelValue:a.value.WithoutInscription,"onUpdate:modelValue":r[9]||(r[9]=C=>a.value.WithoutInscription=C),color:"primary",density:"compact","persistent-hint":"",hint:a.value.WithoutInscription?"Camp externe, uniquement visible sur l'API publique.":""},null,8,["modelValue","hint"])]),_:1})]),_:1})]),_:1})]),_:1}),e(O,{class:"my-2",subtitle:"Filtres sur les inscrits"},{default:l(()=>[e(B,null,{default:l(()=>[e(T,null,{default:l(()=>[e(V,{"align-self":"center"},{default:l(()=>[e(p,{modelValue:a.value.Places,"onUpdate:modelValue":r[10]||(r[10]=C=>a.value.Places=C),label:"Nombre de places"},null,8,["modelValue"])]),_:1}),e(V,{"align-self":"center"},{default:l(()=>[e(p,{modelValue:a.value.AgeMin,"onUpdate:modelValue":r[11]||(r[11]=C=>a.value.AgeMin=C),label:"Âge minimum"},null,8,["modelValue"])]),_:1}),e(V,{"align-self":"center"},{default:l(()=>[e(p,{modelValue:a.value.AgeMax,"onUpdate:modelValue":r[12]||(r[12]=C=>a.value.AgeMax=C),label:"Âge maximum"},null,8,["modelValue"])]),_:1})]),_:1}),e(T,null,{default:l(()=>[e(V,null,{default:l(()=>[e(I,{modelValue:a.value.NeedEquilibreGF,"onUpdate:modelValue":r[13]||(r[13]=C=>a.value.NeedEquilibreGF=C),label:"Equilibre G/F demandé",density:"compact","persistent-hint":"",hint:"Place un inscrit en liste d'attente en cas de déséquilibre Garçons/Filles"},null,8,["modelValue"])]),_:1})]),_:1})]),_:1})]),_:1}),e(O,{class:"my-2",subtitle:"Formulaire d'inscription"},{default:l(()=>[e(B,null,{default:l(()=>[e(T,null,{default:l(()=>[e(V,null,{default:l(()=>[e(me,{label:"Image",density:"compact",variant:"outlined",hint:"URL d'une image affichée sur le formulaire d'inscription","persistent-hint":"",modelValue:a.value.ImageURL,"onUpdate:modelValue":r[14]||(r[14]=C=>a.value.ImageURL=C)},null,8,["modelValue"])]),_:1})]),_:1}),e(T,null,{default:l(()=>[e(V,null,{default:l(()=>[e(vl,{variant:"outlined",density:"compact",label:"Description",hint:"Ce texte est affiché sur le formulaire d'inscription.","persistent-hint":"",rows:"3",modelValue:a.value.Description,"onUpdate:modelValue":r[15]||(r[15]=C=>a.value.Description=C)},null,8,["modelValue"])]),_:1}),e(V,{cols:"2"},{default:l(()=>[e(I,{label:"Navette",modelValue:a.value.Navette.Actif,"onUpdate:modelValue":r[16]||(r[16]=C=>a.value.Navette.Actif=C)},null,8,["modelValue"])]),_:1}),e(V,null,{default:l(()=>[e(vl,{variant:"outlined",density:"compact",label:"Navette",hint:"Ce texte est affiché sur l'espace personnel de suivi.","persistent-hint":"",rows:"3",disabled:!a.value.Navette.Actif,modelValue:a.value.Navette.Commentaire,"onUpdate:modelValue":r[17]||(r[17]=C=>a.value.Navette.Commentaire=C)},null,8,["disabled","modelValue"])]),_:1})]),_:1}),e(T,null,{default:l(()=>[e(V,null,{default:l(()=>[e(me,{density:"compact",variant:"outlined",label:"URL de préselection",hint:"Cette URL permet de sélectionner automatiquement le séjour sur le formulaire d'inscription.","persistent-hint":"",readonly:"","model-value":s.preselectionUrl},{append:l(()=>[e(L,{icon:"mdi-content-copy",size:"small",onClick:c})]),_:1},8,["model-value"])]),_:1})]),_:1})]),_:1})]),_:1}),e(O,{class:"my-2",subtitle:"Autre"},{default:l(()=>[e(B,null,{default:l(()=>[e(T,null,{default:l(()=>[e(V,null,{default:l(()=>[e(me,{label:"Mot de passe",density:"compact",variant:"outlined",hint:"Mot de passe d'accès à la page Directeur","persistent-hint":"",modelValue:a.value.Password,"onUpdate:modelValue":r[18]||(r[18]=C=>a.value.Password=C)},null,8,["modelValue"])]),_:1})]),_:1})]),_:1})]),_:1}),e(nn,{"meta-entries-hints":t.metaEntriesHints,modelValue:a.value.Meta,"onUpdate:modelValue":r[19]||(r[19]=C=>a.value.Meta=C)},null,8,["meta-entries-hints","modelValue"])]),_:1}),e(oe,null,{default:l(()=>[e(ie),e(L,{disabled:!i.value,onClick:r[20]||(r[20]=C=>v("save",a.value))},{default:l(()=>[...r[21]||(r[21]=[f("Enregistrer",-1)])]),_:1},8,["disabled"])]),_:1})]),_:1},8,["subtitle"])}}}),Ql=G({__name:"TauxSelect",props:{modelValue:{required:!0},modelModifiers:{}},emits:["update:modelValue"],setup(t){Ee(i);const o=Pe(t,"modelValue"),s=D(null),v=F(()=>{const u=Array.from(a.value.values()).map(r=>({title:r.Label,value:r.Id}));return u.sort((r,d)=>r.title.localeCompare(d.title)),u}),a=D(new Map);async function i(){const u=await x.CampsGetTaux();u!==void 0&&(a.value=Lt(u),o.value.Id>0&&(o.value=we(a.value.get(o.value.Id)),s.value=o.value.Id))}function m(){o.value.Id<=0?(s.value==null&&(s.value=1),o.value=we(a.value.get(s.value))):(s.value=null,o.value.Id=0,o.value.Label="")}function n(u){o.value=we(a.value.get(u))}const c=F(()=>{if(o.value.Id>0)return null;const u=o.value.Label;return Array.from(a.value.values()).map(d=>d.Label).includes(u)?"Ce label est déjà utilisé.":null});return(u,r)=>(b(),w(T,null,{default:l(()=>[e(V,{"align-self":"center"},{default:l(()=>[o.value.Id>0?(b(),w(Oe,{key:0,variant:"outlined",density:"compact","hide-details":"",label:"Taux",items:v.value,modelValue:s.value,"onUpdate:modelValue":[r[0]||(r[0]=d=>s.value=d),n]},null,8,["items","modelValue"])):(b(),w(T,{key:1},{default:l(()=>[e(V,{cols:"12"},{default:l(()=>[e(me,{variant:"outlined",density:"compact",label:"Label",modelValue:o.value.Label,"onUpdate:modelValue":r[1]||(r[1]=d=>o.value.Label=d),disabled:o.value.Id>0,"error-messages":c.value},null,8,["modelValue","disabled","error-messages"])]),_:1}),e(V,null,{default:l(()=>[e(me,{label:`Valeur d'un ${U(Et)[U(Nt).FrancsSuisse]}`,density:"compact",variant:"outlined",type:"number",min:"0.001",suffix:"€",hint:"Valeur en € d'une unité de la monnaie.","persistent-hint":"","model-value":o.value.FrancsSuisse/1e3,"onUpdate:modelValue":r[2]||(r[2]=d=>o.value.FrancsSuisse=U(Tt)(Number(d)*1e3)),disabled:o.value.Id>0},null,8,["label","model-value","disabled"])]),_:1})]),_:1}))]),_:1}),e(V,{cols:"auto"},{default:l(()=>[e(ue,{thickness:"2",vertical:"",class:"py-4"},{default:l(()=>[...r[3]||(r[3]=[f("ou",-1)])]),_:1})]),_:1}),e(V,{"align-self":"center",cols:"auto"},{default:l(()=>[e(L,{onClick:m},{prepend:l(()=>[e(pe,null,{default:l(()=>[...r[4]||(r[4]=[f("mdi-toggle-switch",-1)])]),_:1})]),default:l(()=>[f(" "+M(o.value.Id>0?"Créer un taux":"Utiliser un taux"),1)]),_:1})]),_:1})]),_:1}))}}),sn=G({__name:"CampStats",props:{stats:{}},setup(t){const o=t;function s(v,a){return`(${_e.pourcent(v,a)} %)`}return(v,a)=>(b(),w(O,{title:"Statut des inscriptions"},{default:l(()=>[e(B,null,{default:l(()=>[e(ke,{density:"compact"},{default:l(()=>[e(Y,{title:"Demandes d'inscriptions"},{append:l(()=>[f(M(o.stats.Inscriptions),1)]),_:1}),e(Y,{title:"Filles",subtitle:"Parmi toutes les demandes d'inscription"},{append:l(()=>[f(M(o.stats.InscriptionsFilles)+" "+M(s(o.stats.InscriptionsFilles,o.stats.Inscriptions)),1)]),_:1}),e(Y,{title:"Suisses",subtitle:"Parmi toutes les demandes d'inscription"},{append:l(()=>[f(M(o.stats.InscriptionsSuisses)+" "+M(s(o.stats.InscriptionsSuisses,o.stats.Inscriptions)),1)]),_:1}),e(Y,{title:"Inscriptions confirmées"},{append:l(()=>[f(M(o.stats.Valides)+" "+M(s(o.stats.Valides,o.stats.Inscriptions)),1)]),_:1}),e(Y,{title:"Filles",subtitle:"Parmi les inscriptions confirmées"},{append:l(()=>[f(M(o.stats.ValidesFilles)+" "+M(s(o.stats.ValidesFilles,o.stats.Valides)),1)]),_:1}),e(Y,{title:"Suisses",subtitle:"Parmi les inscriptions confirmées"},{append:l(()=>[f(M(o.stats.ValidesSuisses)+" "+M(s(o.stats.ValidesSuisses,o.stats.Valides)),1)]),_:1}),e(Y,{title:"A statuer"},{append:l(()=>[f(M(o.stats.AStatuer)+" "+M(s(o.stats.AStatuer,o.stats.Inscriptions)),1)]),_:1}),e(Y,{title:"Demandes d'exception"},{append:l(()=>[f(M(o.stats.Exceptions)+" "+M(s(o.stats.Exceptions,o.stats.Inscriptions)),1)]),_:1}),e(Y,{title:"Refus"},{append:l(()=>[f(M(o.stats.Refus)+" "+M(s(o.stats.Refus,o.stats.Inscriptions)),1)]),_:1})]),_:1})]),_:1})]),_:1}))}}),on={key:0},rn=G({__name:"CampHeaderRow",props:{camp:{}},emits:["click","edit","edit-taux","delete","show-documents","send-sondage","add-directeur"],setup(t,{emit:o}){const s=t,v=o,a=F(()=>s.camp.Stats.Inscriptions-s.camp.Stats.Valides),i=D(!1),m=F(()=>{switch(new Date(s.camp.Camp.Camp.DateDebut).getUTCMonth()+1){case 7:case 8:return"rgb(45, 185, 187)";case 9:case 10:case 11:return"rgb(190, 150, 60)";case 12:case 1:case 2:case 3:return"rgb(240, 240, 240)";case 4:case 5:case 6:default:return"rgb(190, 228, 100)"}}),n=D(!1),c=D(0),u=F(()=>{const r=s.camp.ParticipantsFiles||[];if(r.length==0)return 0;let d=0;for(const p of r)p.InscritsCount!=0&&(d+=p.UploadedCount/p.InscritsCount);return Math.round(d/r.length*100)});return(r,d)=>{const p=il;return b(),z(le,null,[e(O,{color:m.value,"no-gutters":"",onClick:d[6]||(d[6]=k=>v("click")),class:"my-1"},{default:l(()=>[e(T,{style:al({"background-color":m.value}),class:"px-1","no-gutters":"",justify:"space-between"},{default:l(()=>[e(V,null,{default:l(()=>[e(Y,{title:U(xe).label(s.camp.Camp.Camp),subtitle:`ID : ${s.camp.Camp.Camp.Id}`},null,8,["title","subtitle"])]),_:1}),e(V,{"align-self":"center"},{default:l(()=>[f(M(U(xe).formatPlage(t.camp.Camp.Camp)),1)]),_:1}),e(V,{cols:"2","align-self":"center"},{default:l(()=>[e(je,{width:"450px",location:"left","content-class":"pa-0"},{activator:l(({props:k})=>[e(ml,se({class:"bg-white border-md border-primary"},k,{max:s.camp.Camp.Camp.Places,"model-value":s.camp.Stats.Valides,height:"36",rounded:"",color:"primary"}),{default:l(()=>[N("strong",null,[f(M(s.camp.Stats.Valides)+"/"+M(s.camp.Camp.Camp.Places)+" ",1),a.value>0?(b(),z("span",on," (+ "+M(a.value)+")",1)):Q("",!0)]),e(pe,{class:"ml-2"},{default:l(()=>[...d[12]||(d[12]=[f("mdi-account-multiple",-1)])]),_:1})]),_:1},16,["max","model-value"])]),default:l(()=>[e(sn,{stats:s.camp.Stats},null,8,["stats"])]),_:1})]),_:1}),e(V,{cols:"1","align-self":"center",class:"px-2"},{default:l(()=>[e(je,{width:"600",location:"left","content-class":"pa-0"},{activator:l(({props:k})=>[e(ml,se({class:"bg-white border-md border-primary"},k,{max:100,"model-value":u.value,height:"36",rounded:"",color:"primary"}),{default:l(()=>[N("strong",null,M(u.value)+" % ",1),e(pe,{class:"ml-2"},{default:l(()=>[...d[13]||(d[13]=[f("mdi-file-upload",-1)])]),_:1})]),_:1},16,["model-value"])]),default:l(()=>[e(O,{title:"Pièces justificatives"},{default:l(()=>[e(B,null,{default:l(()=>[e(ke,null,{default:l(()=>[(b(!0),z(le,null,ce(s.camp.ParticipantsFiles,k=>(b(),w(Y,{title:k.Title},{append:l(()=>[f(M(k.UploadedCount)+" / "+M(k.InscritsCount)+" ("+M(U(_e).pourcent(k.UploadedCount,k.InscritsCount))+" %) ",1)]),_:2},1032,["title"]))),256))]),_:1})]),_:1})]),_:1})]),_:1})]),_:1}),e(V,{cols:"1"}),e(V,{cols:"auto","align-self":"center"},{default:l(()=>[e(Se,null,{activator:l(({props:k})=>[e(L,se(k,{size:"x-small",class:"mx-1",icon:"mdi-dots-vertical"}),null,16)]),default:l(()=>[e(ke,{density:"compact"},{default:l(()=>[e(Y,{"prepend-icon":"mdi-pencil",onClick:d[0]||(d[0]=k=>v("edit"))},{default:l(()=>[...d[14]||(d[14]=[f("Modifier les paramètres",-1)])]),_:1}),e(Y,{"prepend-icon":"mdi-currency-eur",onClick:d[1]||(d[1]=k=>v("edit-taux"))},{default:l(()=>[...d[15]||(d[15]=[f("Taux de conversion",-1)])]),_:1}),e(ue,{thickness:"1"}),e(Y,{"prepend-icon":"mdi-mail",onClick:d[2]||(d[2]=k=>v("show-documents")),title:"Documents"}),e(ue,{thickness:"1"}),e(Y,{"prepend-icon":"mdi-plus",onClick:d[3]||(d[3]=k=>n.value=!0),title:"Ajouter un directeur...",disabled:s.camp.HasDirecteur},null,8,["disabled"]),e(ue,{thickness:"1"}),e(Y,{title:"Se connecter à l'espace directeur","prepend-icon":"mdi-open-in-new",href:s.camp.URLDirecteur,target:"_blank"},null,8,["href"]),e(ue,{thickness:"1"}),e(Y,{title:"Envoyer le sondage",subtitle:"de fin de séjour","prepend-icon":"mdi-comment-quote",onClick:d[4]||(d[4]=k=>v("send-sondage"))}),e(ue,{thickness:"1"}),e(Y,{"prepend-icon":"mdi-delete",disabled:s.camp.Stats.Inscriptions>0,onClick:d[5]||(d[5]=k=>i.value=!0)},{default:l(()=>[...d[16]||(d[16]=[f("Supprimer",-1)])]),_:1},8,["disabled"])]),_:1})]),_:1})]),_:1})]),_:1},8,["style"])]),_:1},8,["color"]),e(Z,{modelValue:i.value,"onUpdate:modelValue":d[8]||(d[8]=k=>i.value=k),"max-width":"600"},{default:l(()=>[e(O,{title:"Confirmer la suppression"},{default:l(()=>[e(B,null,{default:l(()=>[d[17]||(d[17]=f(" Etes vous certain de supprimer le séjour ",-1)),N("b",null,M(U(xe).label(s.camp.Camp.Camp)),1),d[18]||(d[18]=f(" ? ",-1)),d[19]||(d[19]=N("br",null,null,-1)),d[20]||(d[20]=N("br",null,null,-1)),d[21]||(d[21]=f(" Les éventuels ",-1)),d[22]||(d[22]=N("i",null,"équipiers",-1)),d[23]||(d[23]=f(" déclarés sur ce séjour seront aussi supprimés. ",-1)),d[24]||(d[24]=N("br",null,null,-1)),d[25]||(d[25]=N("br",null,null,-1)),d[26]||(d[26]=f(" Attention, cette opération est irréversible. ",-1))]),_:1}),e(oe,null,{default:l(()=>[e(ie),e(L,{color:"red",onClick:d[7]||(d[7]=k=>{i.value=!1,v("delete")})},{default:l(()=>[...d[27]||(d[27]=[f("Supprimer",-1)])]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"]),e(Z,{modelValue:n.value,"onUpdate:modelValue":d[11]||(d[11]=k=>n.value=k),"max-width":"400px"},{default:l(()=>[e(O,{title:"Ajouter un directeur"},{default:l(()=>[e(B,null,{default:l(()=>[e(p,{"initial-personne":"",label:"Directeur",modelValue:c.value,"onUpdate:modelValue":d[9]||(d[9]=k=>c.value=k),api:U(x)},null,8,["modelValue","api"])]),_:1}),e(oe,null,{default:l(()=>[e(ie),e(L,{disabled:!c.value,onClick:d[10]||(d[10]=k=>{n.value=!1,v("add-directeur",c.value)})},{default:l(()=>[...d[28]||(d[28]=[f("Ajouter",-1)])]),_:1},8,["disabled"])]),_:1})]),_:1})]),_:1},8,["modelValue"])],64)}}}),bt=G({__name:"CampsSelector",props:De({allCamps:{}},{modelValue:{required:!0},modelModifiers:{}}),emits:["update:modelValue"],setup(t){const o=t,s=Pe(t,"modelValue"),v=F(()=>o.allCamps.map(a=>({title:a.Label,value:a.Id})));return(a,i)=>(b(),w(wa,{multiple:"",chips:"","closable-chips":"",items:v.value,modelValue:s.value,"onUpdate:modelValue":i[0]||(i[0]=m=>s.value=m)},null,8,["items","modelValue"]))}}),dn=G({__name:"DocumentsCard",props:{camp:{}},setup(t){const o=t;Ee(v);const s=D(null);async function v(){const a=await x.CampsDocuments({idCamp:o.camp.Camp.Camp.Id});a!==void 0&&(s.value=a)}return(a,i)=>{const m=Fa;return s.value!=null?(b(),w(O,{key:0,title:"Documents"},{default:l(()=>[e(B,null,{default:l(()=>[e(ke,null,{default:l(()=>[e(Nl,null,{default:l(()=>[...i[0]||(i[0]=[f("Préférences d'affichage",-1)])]),_:1}),e(Y,null,{default:l(()=>[e(T,{class:"mb-2"},{default:l(()=>[e(V,null,{default:l(()=>[e(ye,{color:s.value.ToShow.LettreDirecteur?"green":"grey","append-icon":s.value.ToShow.LettreDirecteur?"mdi-check":""},{default:l(()=>[...i[1]||(i[1]=[f("Lettre du directeur",-1)])]),_:1},8,["color","append-icon"])]),_:1}),e(V,null,{default:l(()=>[e(ye,{color:s.value.ToShow.ListeVetements?"green":"grey","append-icon":s.value.ToShow.ListeVetements?"mdi-check":""},{default:l(()=>[...i[2]||(i[2]=[f(" Liste de vêtements",-1)])]),_:1},8,["color","append-icon"])]),_:1}),e(V,null,{default:l(()=>[e(ye,{color:s.value.ToShow.ListeParticipants?"green":"grey","append-icon":s.value.ToShow.ListeParticipants?"mdi-check":""},{default:l(()=>[...i[3]||(i[3]=[f("Liste des participants ",-1)])]),_:1},8,["color","append-icon"])]),_:1})]),_:1})]),_:1}),e(Nl,null,{default:l(()=>[...i[4]||(i[4]=[f("Documents du séjour",-1)])]),_:1}),(b(!0),z(le,null,ce(s.value.Generated,n=>(b(),w(Y,{title:n.NomClient},{append:l(()=>[e(m,{"file-key":n.Key,"is-generated-doc":!0},null,8,["file-key"])]),_:2},1032,["title"]))),256)),(b(!0),z(le,null,ce(s.value.ToRead,n=>(b(),w(Y,{title:n.NomClient},{append:l(()=>[e(m,{"file-key":n.Key,"is-generated-doc":!1},null,8,["file-key"])]),_:2},1032,["title"]))),256)),(b(!0),z(le,null,ce(s.value.ToUploadModeles,n=>(b(),w(Y,{title:n.NomClient,subtitle:"Document à remplir"},{append:l(()=>[e(m,{"file-key":n.Key,"is-generated-doc":!1},null,8,["file-key"])]),_:2},1032,["title"]))),256))]),_:1})]),_:1})]),_:1})):(b(),w(We,{key:1,type:"card"}))}}}),Cl=G({__name:"RequestProgressCard",props:{title:{},current:{},total:{}},setup(t){const o=t;return(s,v)=>(b(),w(O,{title:o.title},{default:l(()=>[e(B,null,{default:l(()=>[e(ml,{max:o.total,"model-value":o.current,color:"primary",height:"24"},{default:l(()=>[f(M(o.current)+" / "+M(o.total),1)]),_:1},8,["max","model-value"])]),_:1})]),_:1},8,["title"]))}}),mn={key:0,class:"text-center my-4"},cn=G({__name:"JoomeoPannel",emits:["save"],setup(t,{emit:o}){Ee(a);const s=D(null),v=D([]);async function a(){const p=await x.CampsLoadAlbums();p!==void 0&&(s.value=p||[],v.value=[])}function i(p){return s.value.find(k=>k.Camp.Id==p)}const m=D(!1),n=F(()=>m.value||!v.value.length||!s.value?!1:v.value.every(p=>i(p).Camp.JoomeoID==""));async function c(){m.value=!0;const p=await x.CampsCreateAlbums({IdCamps:v.value});m.value=!1,p!==void 0&&(Il(p).forEach(([k,I])=>{i(k).Album=I}),x.showMessage("Albums Joomeo créés avec succès."))}const u=F(()=>m.value||!v.value.length||!s.value?!1:v.value.every(p=>i(p).Camp.JoomeoID!=""&&i(p).HasDirecteur));async function r(){m.value=!0;const p=await x.CampsAddDirecteursToAlbums({IdCamps:v.value,SendMail:!0});m.value=!1,p!==void 0&&(Il(p).forEach(([k,I])=>{i(k).DirecteurPermission=I}),x.showMessage("Directeurs ajoutés avec succès."))}function d(p){return p.type==1&&p.albumAccessRules.allowDownload&&p.albumAccessRules.allowUpload&&p.accessRules.allowDeleteFile&&p.accessRules.allowEditFileCaption}return(p,k)=>(b(),w(O,{title:"Albums Joomeo",subtitle:"Seuls les camps en cours sont affichés."},{append:l(()=>[e(L,{disabled:!n.value,onClick:c},{prepend:l(()=>[e(pe,{color:"green"},{default:l(()=>[...k[1]||(k[1]=[f("mdi-plus",-1)])]),_:1})]),default:l(()=>[k[2]||(k[2]=f(" Créer les albums",-1))]),_:1},8,["disabled"]),e(L,{disabled:!u.value,onClick:r,class:"ml-2"},{prepend:l(()=>[e(pe,null,{default:l(()=>[...k[3]||(k[3]=[f("mdi-account-eye",-1)])]),_:1})]),default:l(()=>[k[4]||(k[4]=f(" Ajouter les directeurs",-1))]),_:1},8,["disabled"])]),default:l(()=>[m.value?(b(),w(ml,{key:0,indeterminate:""})):Q("",!0),e(B,null,{default:l(()=>[s.value==null?(b(),z("div",mn,[e(ht,{indeterminate:""})])):(b(),w(ke,{key:1,selected:v.value,"onUpdate:selected":k[0]||(k[0]=I=>v.value=I),"select-strategy":"leaf"},{default:l(()=>[(b(!0),z(le,null,ce(s.value,I=>(b(),w(Y,{value:I.Camp.Id,title:U(xe).label(I.Camp),rounded:"",class:"my-1"},{append:l(()=>[e(T,null,{default:l(()=>[e(V,null,{default:l(()=>[e(ye,{color:I.Album.Id?"primary":void 0},{default:l(()=>[I.Album.Id?(b(),w(je,{key:0,activator:"parent","content-class":"pa-0"},{default:l(()=>[e(O,{title:"Album Joomeo","min-width":"400px"},{default:l(()=>[e(B,null,{default:l(()=>[e(T,null,{default:l(()=>[e(V,{cols:"auto"},{default:l(()=>[...k[5]||(k[5]=[f("Nom",-1)])]),_:1}),e(V,{class:"text-right"},{default:l(()=>[f(M(I.Album.Label),1)]),_:2},1024)]),_:2},1024),e(T,null,{default:l(()=>[e(V,{cols:"auto"},{default:l(()=>[...k[6]||(k[6]=[f("ID",-1)])]),_:1}),e(V,{class:"text-right"},{default:l(()=>[f(M(I.Album.Id),1)]),_:2},1024)]),_:2},1024),e(T,null,{default:l(()=>[e(V,{cols:"auto"},{default:l(()=>[...k[7]||(k[7]=[f("Date de création",-1)])]),_:1}),e(V,{class:"text-right"},{default:l(()=>[f(M(new Date(I.Album.Date).toLocaleDateString("fr")),1)]),_:2},1024)]),_:2},1024),e(T,null,{default:l(()=>[e(V,{cols:"auto"},{default:l(()=>[...k[8]||(k[8]=[f("Nombre de photos",-1)])]),_:1}),e(V,{class:"text-right"},{default:l(()=>[f(M(I.Album.FilesCount),1)]),_:2},1024)]),_:2},1024)]),_:2},1024)]),_:2},1024)]),_:2},1024)):Q("",!0),f(" "+M(I.Album.Id==""?"Pas d'album":`Album créé le ${U(_e).date(I.Album.Date)}`),1)]),_:2},1032,["color"])]),_:2},1024),I.Album.Id?(b(),w(V,{key:0},{default:l(()=>[e(ye,{color:I.HasDirecteur?I.DirecteurPermission.contactid!=""?"green":"orange":"red"},{default:l(()=>[I.DirecteurPermission.contactid?(b(),w(je,{key:0,activator:"parent","content-class":"pa-0"},{default:l(()=>[e(O,{title:"Accès à l'album",subtitle:"Le directeur a accès à l'album."},{default:l(()=>[e(B,null,{default:l(()=>[e(T,null,{default:l(()=>[e(V,null,{default:l(()=>[...k[9]||(k[9]=[f("Email",-1)])]),_:1}),e(V,{class:"text-right"},{default:l(()=>[f(M(I.DirecteurPermission.email),1)]),_:2},1024)]),_:2},1024),e(T,null,{default:l(()=>[e(V,null,{default:l(()=>[...k[10]||(k[10]=[f("Login",-1)])]),_:1}),e(V,{class:"text-right"},{default:l(()=>[f(M(I.DirecteurPermission.login),1)]),_:2},1024)]),_:2},1024),e(T,null,{default:l(()=>[e(V,null,{default:l(()=>[...k[11]||(k[11]=[f("Mot de passe",-1)])]),_:1}),e(V,{class:"text-right"},{default:l(()=>[f(M(I.DirecteurPermission.password),1)]),_:2},1024)]),_:2},1024),e(T,null,{default:l(()=>[e(V,null,{default:l(()=>[...k[12]||(k[12]=[f("Permissions (écriture)",-1)])]),_:1}),e(V,{class:"text-right"},{default:l(()=>[e(pe,{icon:d(I.DirecteurPermission)?"mdi-check":"mdi-warning",color:d(I.DirecteurPermission)?"green":"orange"},null,8,["icon","color"])]),_:2},1024)]),_:2},1024)]),_:2},1024)]),_:2},1024)]),_:2},1024)):Q("",!0),f(" "+M(I.HasDirecteur?I.DirecteurPermission.contactid!=""?"Directeur ajouté":"Directeur à ajouter":"Aucun directeur"),1)]),_:2},1032,["color"])]),_:2},1024)):Q("",!0)]),_:2},1024)]),_:2},1032,["value","title"]))),256))]),_:1},8,["selected"]))]),_:1}),e(oe,null,{default:l(()=>[e(ie)]),_:1})]),_:1}))}});function vn(){const t=D([]);Ot(()=>t.value=[]);function o(s,v){t.value[v]=s}return{refs:t,updateRef:o}}const pn=Re({activeColor:String,start:{type:[Number,String],default:1},modelValue:{type:Number,default:t=>t.start},disabled:Boolean,length:{type:[Number,String],default:1,validator:t=>t%1===0},totalVisible:[Number,String],firstIcon:{type:Be,default:"$first"},prevIcon:{type:Be,default:"$prev"},nextIcon:{type:Be,default:"$next"},lastIcon:{type:Be,default:"$last"},ariaLabel:{type:String,default:"$vuetify.pagination.ariaLabel.root"},pageAriaLabel:{type:String,default:"$vuetify.pagination.ariaLabel.page"},currentPageAriaLabel:{type:String,default:"$vuetify.pagination.ariaLabel.currentPage"},firstAriaLabel:{type:String,default:"$vuetify.pagination.ariaLabel.first"},previousAriaLabel:{type:String,default:"$vuetify.pagination.ariaLabel.previous"},nextAriaLabel:{type:String,default:"$vuetify.pagination.ariaLabel.next"},lastAriaLabel:{type:String,default:"$vuetify.pagination.ariaLabel.last"},ellipsis:{type:String,default:"..."},showFirstLastPage:Boolean,...Xt(),...Kt(),...Gt(),...Jt(),...Wt(),...Qt(),...zt({tag:"nav"}),...Yt(),...Ht({variant:"text"})},"VPagination"),fn=Le()({name:"VPagination",props:pn(),emits:{"update:modelValue":t=>!0,first:t=>!0,prev:t=>!0,next:t=>!0,last:t=>!0},setup(t,o){let{slots:s,emit:v}=o;const a=Ue(t,"modelValue"),{t:i,n:m}=Je(),{isRtl:n}=et(),{themeClasses:c}=Bt(t),{width:u}=jt(),r=el(-1);Al(void 0,{scoped:!0});const{resizeRef:d}=qt(W=>{if(!W.length)return;const{target:A,contentRect:te}=W[0],ne=A.querySelector(".v-pagination__list > *");if(!ne)return;const h=te.width,q=ne.offsetWidth+parseFloat(getComputedStyle(ne).marginRight)*2;r.value=C(h,q)}),p=F(()=>parseInt(t.length,10)),k=F(()=>parseInt(t.start,10)),I=F(()=>t.totalVisible!=null?parseInt(t.totalVisible,10):r.value>=0?r.value:C(u.value,58));function C(W,A){const te=t.showFirstLastPage?5:3;return Math.max(0,Math.floor(Number(((W-A*te)/A).toFixed(2))))}const _=F(()=>{if(p.value<=0||isNaN(p.value)||p.value>Number.MAX_SAFE_INTEGER)return[];if(I.value<=0)return[];if(I.value===1)return[a.value];if(p.value<=I.value)return Ne(p.value,k.value);const W=I.value%2===0,A=W?I.value/2:Math.floor(I.value/2),te=W?A:A+1,ne=p.value-A;if(te-a.value>=0)return[...Ne(Math.max(1,I.value-1),k.value),t.ellipsis,p.value];if(a.value-ne>=(W?1:0)){const h=I.value-1,q=p.value-h+k.value;return[k.value,t.ellipsis,...Ne(h,q)]}else{const h=Math.max(1,I.value-2),q=h===1?a.value:a.value-Math.ceil(h/2)+k.value;return[k.value,t.ellipsis,...Ne(h,q),t.ellipsis,p.value]}});function P(W,A,te){W.preventDefault(),a.value=A,te&&v(te,A)}const{refs:j,updateRef:K}=vn();Al({VPaginationBtn:{color:Fe(()=>t.color),border:Fe(()=>t.border),density:Fe(()=>t.density),size:Fe(()=>t.size),variant:Fe(()=>t.variant),rounded:Fe(()=>t.rounded),elevation:Fe(()=>t.elevation)}});const S=F(()=>_.value.map((W,A)=>{const te=ne=>K(ne,A);if(typeof W=="string")return{isActive:!1,key:`ellipsis-${A}`,page:W,props:{ref:te,ellipsis:!0,icon:!0,disabled:!0}};{const ne=W===a.value;return{isActive:ne,key:W,page:m(W),props:{ref:te,ellipsis:!1,icon:!0,disabled:!!t.disabled||Number(t.length)<2,color:ne?t.activeColor:t.color,"aria-current":ne,"aria-label":i(ne?t.currentPageAriaLabel:t.pageAriaLabel,W),onClick:h=>P(h,W)}}}})),y=F(()=>{const W=!!t.disabled||a.value<=k.value,A=!!t.disabled||a.value>=k.value+p.value-1;return{first:t.showFirstLastPage?{icon:n.value?t.lastIcon:t.firstIcon,onClick:te=>P(te,k.value,"first"),disabled:W,"aria-label":i(t.firstAriaLabel),"aria-disabled":W}:void 0,prev:{icon:n.value?t.nextIcon:t.prevIcon,onClick:te=>P(te,a.value-1,"prev"),disabled:W,"aria-label":i(t.previousAriaLabel),"aria-disabled":W},next:{icon:n.value?t.prevIcon:t.nextIcon,onClick:te=>P(te,a.value+1,"next"),disabled:A,"aria-label":i(t.nextAriaLabel),"aria-disabled":A},last:t.showFirstLastPage?{icon:n.value?t.firstIcon:t.lastIcon,onClick:te=>P(te,k.value+p.value-1,"last"),disabled:A,"aria-label":i(t.lastAriaLabel),"aria-disabled":A}:void 0}});function ee(){const W=a.value-k.value;j.value[W]?.$el.focus()}function be(W){W.key===Ml.left&&!t.disabled&&a.value>Number(t.start)?(a.value=a.value-1,$l(ee)):W.key===Ml.right&&!t.disabled&&a.value<k.value+p.value-1&&(a.value=a.value+1,$l(ee))}return Te(()=>e(t.tag,{ref:d,class:Ce(["v-pagination",c.value,t.class]),style:al(t.style),role:"navigation","aria-label":i(t.ariaLabel),onKeydown:be,"data-test":"v-pagination-root"},{default:()=>[N("ul",{class:"v-pagination__list"},[t.showFirstLastPage&&N("li",{key:"first",class:"v-pagination__first","data-test":"v-pagination-first"},[s.first?s.first(y.value.first):e(L,se({_as:"VPaginationBtn"},y.value.first),null)]),N("li",{key:"prev",class:"v-pagination__prev","data-test":"v-pagination-prev"},[s.prev?s.prev(y.value.prev):e(L,se({_as:"VPaginationBtn"},y.value.prev),null)]),S.value.map((W,A)=>N("li",{key:W.key,class:Ce(["v-pagination__item",{"v-pagination__item--is-active":W.isActive}]),"data-test":"v-pagination-item"},[s.item?s.item(W):e(L,se({_as:"VPaginationBtn"},W.props),{default:()=>[W.page]})])),N("li",{key:"next",class:"v-pagination__next","data-test":"v-pagination-next"},[s.next?s.next(y.value.next):e(L,se({_as:"VPaginationBtn"},y.value.next),null)]),t.showFirstLastPage&&N("li",{key:"last",class:"v-pagination__last","data-test":"v-pagination-last"},[s.last?s.last(y.value.last):e(L,se({_as:"VPaginationBtn"},y.value.last),null)])])]})),{}}}),yn={key:2},bl=16,bn=G({__name:"CampsList",emits:["show-participants"],setup(t,{emit:o}){const s=o;Ee(r);const v=gl(new Map),a=D(!1),i=gl({pattern:"",openOnly:!1}),m=F(()=>{const J=new Set,g=new Set;for(const $ of v.values())for(const R of Object.entries($.Camp.Camp.Meta||{}))J.add(R[0]),g.add(R[1]);return{keys:Array.from(J.keys()).sort(),values:Array.from(g.keys()).sort()}}),n=F(()=>{const J=at(i.pattern),g=Array.from(v.values()).filter($=>xe.match($.Camp.Camp,J)&&(!i.openOnly||El($.Camp)));return g.sort(($,R)=>{const fe=new Date(R.Camp.Camp.DateDebut).valueOf(),ae=new Date($.Camp.Camp.DateDebut).valueOf();return fe==ae?$.Camp.Camp.Id-R.Camp.Camp.Id:fe-ae}),g}),c=F(()=>n.value.slice((k.value-1)*bl,k.value*bl));function u(){k.value>p.value&&(k.value=p.value)}async function r(){a.value=!0;const J=await x.CampsGet();a.value=!1,J!==void 0&&(v.clear(),J?.forEach(g=>v.set(g.Camp.Camp.Id,g)))}async function d(){a.value=!0;const J=await x.CampsCreate();a.value=!1,J!==void 0&&(x.showMessage("Camp ajouté avec succès."),v.set(J.Camp.Camp.Id,J),I.value=J)}const p=F(()=>Math.max(Math.ceil(n.value.length/bl),1)),k=D(1),I=D(null);async function C(J){I.value=null,a.value=!0;const g=await x.CampsUpdate(J);a.value=!1,g!==void 0&&(x.showMessage("Séjour modifié avec succès."),v.get(g.Camp.Id).Camp=g,u())}const _=D(null);async function P(){const J=_.value;if(J==null)return;_.value=null,a.value=!0;const g=await x.CampsSetTaux({IdCamp:J.Camp.Camp.Id,Taux:J.Taux});if(a.value=!1,g===void 0)return;x.showMessage("Taux modifié avec succès.");const $=v.get(J.Camp.Camp.Id);$.Camp.Camp.IdTaux=g.Id,$.Taux=g}const j=D(!1),K=D(5),S=D({Id:1,Label:"",Euros:0,FrancsSuisse:0}),y=F(()=>S.value.Id>0||S.value.Label!=""),ee=F(()=>new Set(Array.from(v.values()).filter(g=>El(g.Camp)).map(g=>g.Camp.Camp.IdTaux)).size<=1);async function be(){j.value=!1,a.value=!0;const J=await x.CampsCreateMany({Count:K.value,Taux:S.value});a.value=!1,J!==void 0&&(x.showMessage("Séjours créés avec succès."),J?.forEach(g=>v.set(g.Camp.Camp.Id,g)))}async function W(J){a.value=!0;const g=await x.CampsDelete({id:J.Camp.Camp.Id});a.value=!1,g!==void 0&&(x.showMessage("Séjour supprimé avec succès."),v.delete(J.Camp.Camp.Id),u())}const A=D(!1);function te(){ne.value=Array.from(v.values()).filter(J=>J.Camp.Camp.Statut!=ea.Ouvert).map(J=>J.Camp.Camp.Id),A.value=!0}const ne=D([]);async function h(){A.value=!1,!(!ne.value.length||await x.CampsOuvreInscriptions({Camps:ne.value})===void 0)&&(x.showMessage("Séjours ouverts aux inscriptions avec succès."),r())}const q=D(null),re=D(null);async function X(J){re.value={Current:0,Total:10};const g=await x.EventsSendSondages({idCamp:J});if(g===void 0){re.value=null;return}await Vl(g,$=>re.value=$,$=>x.onError("Envoi du sondage",$)),re.value=null,x.showMessage("Sondage envoyé avec succès.")}async function ge(J,g){await x.CampsCreateEquipier({IdPersonne:J,IdCamp:g,Roles:[la.Direction]})!==void 0&&(v.get(g).HasDirecteur=!0,x.showMessage("Directeur ajouté avec succès."))}const Ve=D(!1);return(J,g)=>{const $=Ge;return b(),z(le,null,[e(O,{title:"Séjours",subtitle:v.size},{append:l(()=>[e(T,null,{default:l(()=>[e(V,{"align-self":"center",style:{width:"240px"}},{default:l(()=>[e(me,{label:"Rechercher",variant:"filled",density:"comfortable","hide-details":"","prepend-inner-icon":"mdi-magnify",clearable:"",modelValue:i.pattern,"onUpdate:modelValue":[g[0]||(g[0]=R=>i.pattern=R),g[2]||(g[2]=R=>u())],"onClick:clear":g[1]||(g[1]=R=>{i.pattern="",u()})},null,8,["modelValue"])]),_:1}),e(ue,{vertical:"",thickness:"1"}),e(V,{"align-self":"center",cols:"auto"},{default:l(()=>[e(Se,null,{activator:l(({props:R})=>[e(L,se(R,{color:"success",disabled:a.value}),{prepend:l(()=>[e(pe,null,{default:l(()=>[...g[18]||(g[18]=[f("mdi-plus",-1)])]),_:1})]),default:l(()=>[g[19]||(g[19]=f(" Créer un séjour ",-1))]),_:1},16,["disabled"])]),default:l(()=>[e(ke,{density:"compact"},{default:l(()=>[e(Y,{onClick:d,title:"Créer un séjour"}),e(Y,{title:"Créer plusieurs séjours...",subtitle:"Permet de choisir les taux de conversion",onClick:g[3]||(g[3]=R=>j.value=!0)})]),_:1})]),_:1})]),_:1}),e(V,{"align-self":"center",cols:"auto"},{default:l(()=>[e(L,{flat:"",icon:"",size:"small"},{default:l(()=>[e(pe,{icon:"mdi-dots-vertical"}),e(Se,{activator:"parent"},{default:l(()=>[e(ke,{density:"compact"},{default:l(()=>[e(Y,{title:"Masquer les camps fermés",subtitle:"N'afficher que les camps ouverts aux inscriptions",onClick:g[5]||(g[5]=R=>i.openOnly=!i.openOnly)},{prepend:l(()=>[e(ze,{class:"mr-2",modelValue:i.openOnly,"onUpdate:modelValue":g[4]||(g[4]=R=>i.openOnly=R),density:"compact","hide-details":""},null,8,["modelValue"])]),_:1}),e(ue,{thickness:"1"}),e(Y,{onClick:g[6]||(g[6]=R=>Ve.value=!0),title:"Configurer les albums Joomeo...","prepend-icon":"mdi-image-album"}),e(ue,{thickness:"1"}),e(Y,{onClick:te,title:"Ouvrir les inscriptions...",subtitle:"sur plusieurs séjours","prepend-icon":"mdi-lock-open"}),e(ue,{thickness:"1"}),e(Y,{"prepend-icon":"mdi-file-excel",title:"Exporter",subtitle:"Participants de l'année courante (format Excel)",link:"",href:U(x).CampsDownloadParticipants(new Date().getFullYear(),U(x).authToken)},null,8,["href"])]),_:1})]),_:1})]),_:1})]),_:1})]),_:1})]),default:l(()=>[e(B,{class:"mt-4"},{default:l(()=>[ee.value?Q("",!0):(b(),w(Zt,{key:0,type:"warning"},{default:l(()=>[...g[20]||(g[20]=[f(" Attention, les séjours ouverts aux inscriptions ont des taux de conversion incompatibles ! ",-1)])]),_:1})),a.value?(b(),w(We,{key:1})):n.value.length==0?(b(),z("i",yn," Aucun camp ne correspond aux filtres actuels. ")):Q("",!0),(b(!0),z(le,null,ce(c.value,(R,fe)=>(b(),w(rn,{key:fe,camp:R,onClick:ae=>s("show-participants",R),onEdit:ae=>I.value=R,onEditTaux:ae=>_.value=R,onDelete:ae=>W(R),onShowDocuments:ae=>q.value=R,onSendSondage:ae=>X(R.Camp.Camp.Id),onAddDirecteur:ae=>ge(ae,R.Camp.Camp.Id)},null,8,["camp","onClick","onEdit","onEditTaux","onDelete","onShowDocuments","onSendSondage","onAddDirecteur"]))),128)),e(fn,{length:p.value,modelValue:k.value,"onUpdate:modelValue":g[7]||(g[7]=R=>k.value=R)},null,8,["length","modelValue"])]),_:1})]),_:1},8,["subtitle"]),e(Z,{"model-value":I.value!=null,"onUpdate:modelValue":g[8]||(g[8]=R=>I.value=null),"max-width":"800px"},{default:l(()=>[I.value!=null?(b(),w(un,{key:0,camp:I.value.Camp.Camp,"preselection-url":I.value.URLPreselection,"meta-entries-hints":m.value,onSave:C},null,8,["camp","preselection-url","meta-entries-hints"])):Q("",!0)]),_:1},8,["model-value"]),e(Z,{"model-value":_.value!=null,"onUpdate:modelValue":g[10]||(g[10]=R=>_.value=null),"max-width":"600"},{default:l(()=>[_.value!=null?(b(),w(O,{key:0,title:"Modifier le taux",subtitle:"La modification n'est possible que si aucun participant n'est enregistré."},{default:l(()=>[e(B,null,{default:l(()=>[e(Ql,{modelValue:_.value.Taux,"onUpdate:modelValue":g[9]||(g[9]=R=>_.value.Taux=R)},null,8,["modelValue"])]),_:1}),e(oe,null,{default:l(()=>[e(ie),e(L,{disabled:_.value.Stats.Inscriptions>0,onClick:P},{default:l(()=>[...g[21]||(g[21]=[f("Modifier",-1)])]),_:1},8,["disabled"])]),_:1})]),_:1})):Q("",!0)]),_:1},8,["model-value"]),e(Z,{modelValue:j.value,"onUpdate:modelValue":g[13]||(g[13]=R=>j.value=R),"max-width":"600"},{default:l(()=>[e(O,{title:"Créer plusieurs séjours",subtitle:"Les séjours seront liés au même taux de conversion"},{default:l(()=>[e(B,null,{default:l(()=>[e(T,null,{default:l(()=>[e(V,null,{default:l(()=>[e($,{label:"Nombre de séjours",modelValue:K.value,"onUpdate:modelValue":g[11]||(g[11]=R=>K.value=R)},null,8,["modelValue"])]),_:1})]),_:1}),e(ue,{thickness:"2",class:"my-2"}),e(Ql,{modelValue:S.value,"onUpdate:modelValue":g[12]||(g[12]=R=>S.value=R)},null,8,["modelValue"])]),_:1}),e(oe,null,{default:l(()=>[e(ie),e(L,{color:"success",onClick:be,disabled:!y.value},{default:l(()=>[...g[22]||(g[22]=[f("Créer",-1)])]),_:1},8,["disabled"])]),_:1})]),_:1})]),_:1},8,["modelValue"]),e(Z,{modelValue:A.value,"onUpdate:modelValue":g[15]||(g[15]=R=>A.value=R),"max-width":"600"},{default:l(()=>[e(O,{title:"Ouvrir les inscriptions",subtitle:"Ouvre les inscriptions sur les séjours ci-dessous"},{default:l(()=>[e(B,null,{default:l(()=>[e(bt,{"all-camps":Array.from(v.values()).map(R=>U(xe).toItem(R.Camp)),modelValue:ne.value,"onUpdate:modelValue":g[14]||(g[14]=R=>ne.value=R)},null,8,["all-camps","modelValue"])]),_:1}),e(oe,null,{default:l(()=>[e(ie),e(L,{onClick:h,disabled:!ne.value.length},{default:l(()=>[...g[23]||(g[23]=[f("Ouvrir",-1)])]),_:1},8,["disabled"])]),_:1})]),_:1})]),_:1},8,["modelValue"]),e(Z,{"model-value":q.value!=null,"onUpdate:modelValue":g[16]||(g[16]=R=>q.value=null),"max-width":"800px"},{default:l(()=>[q.value?(b(),w(dn,{key:0,camp:q.value},null,8,["camp"])):Q("",!0)]),_:1},8,["model-value"]),e(Z,{"model-value":re.value!=null,"max-width":"400px",persistent:""},{default:l(()=>[re.value?(b(),w(Cl,{key:0,title:"Envoi du sondage en cours",current:re.value.Current,total:re.value.Total},null,8,["current","total"])):Q("",!0)]),_:1},8,["model-value"]),e(Z,{modelValue:Ve.value,"onUpdate:modelValue":g[17]||(g[17]=R=>Ve.value=R)},{default:l(()=>[e(cn)]),_:1},8,["modelValue"])],64)}}}),gn={key:1},Vn={key:0,class:"text-center font-italic"},kn=G({__name:"CampParticipants",props:{id:{},idParticipant:{}},setup(t){const o=t;Ee(async()=>{a(),await n(),c()}),Ae(()=>o.id,n),Ae(()=>o.idParticipant,c);const s=D(!1),v=D([]);async function a(){const S=await x.GetCamps();S!==void 0&&(v.value=S||[])}const i=F(()=>{const S=(m.value?.Participants||[]).map(y=>y);return S.sort(ta.cmp),S}),m=D(null);async function n(){s.value=!0;const S=await x.CampsLoad({idCamp:o.id});s.value=!1,S!==void 0&&(m.value=S)}function c(){if(o.idParticipant===void 0)return;const S=(m.value?.Participants||[]).find(y=>y.Participant.Id==o.idParticipant);S&&(d.value=we(S))}const u=D(null);async function r(){if(u.value==null||m.value==null)return;const S=await x.ParticipantsCreate(u.value);u.value=null,S!==void 0&&(x.showMessage("Participant créé avec succès."),m.value.Participants=(m.value.Participants||[]).concat(S),d.value=we(S))}const d=D(null);async function p(S){if(d.value==null||m.value==null)return;const y=await x.ParticipantsUpdate(S);d.value=null,y!==void 0&&(x.showMessage("Participant modifié avec succès."),n())}const k=D(null);async function I(){if(k.value==null||m.value==null)return;const S=k.value.Participant.Id,y=await x.ParticipantsDelete({id:S});k.value=null,y!==void 0&&(x.showMessage("Participant supprimé avec succès."),m.value.Participants=(m.value.Participants||[]).filter(ee=>ee.Participant.Id!=S))}const C=D(null);async function _(){const S=C.value;S==null||m.value==null||(C.value=null,await x.ParticipantsMove(S)===void 0)||(x.showMessage("Participant déplacé avec succès.",void 0,{title:"Aller au nouveau séjour",action:()=>Dl({IdCamp:S.Target,Id:S.Id})}),m.value.Participants=(m.value.Participants||[]).filter(ee=>ee.Participant.Id!=S.Id))}const P=D(null);async function j(){if(P.value==null)return;const S=P.value.Participant.Id;P.value=null;const y=await x.ParticipantsSetPlaceLiberee({id:S});if(y===void 0||(x.showMessage("Notification de place libérée envoyée avec succès."),m.value==null))return;const ee=m.value.Participants?.find(be=>be.Participant.Id==S);ee.Participant=y}const K=D(!1);return(S,y)=>{const ee=Da,be=Aa,W=il,A=ut,te=Sa,ne=sl,h=Ia;return m.value!=null?(b(),w(O,{key:0,title:"Participants",subtitle:U(xe).label(m.value.Camp.Camp)},{append:l(()=>[e(L,{color:"green",onClick:y[0]||(y[0]=q=>u.value={IdCamp:o.id,IdDossier:0,IdPersonne:0})},{prepend:l(()=>[e(pe,null,{default:l(()=>[...y[11]||(y[11]=[f("mdi-plus",-1)])]),_:1})]),default:l(()=>[y[12]||(y[12]=f(" Ajouter un participant",-1))]),_:1}),e(ue,{thickness:"1",class:"mx-1"}),e(L,{icon:"",size:"small",flat:""},{default:l(()=>[e(pe,null,{default:l(()=>[...y[13]||(y[13]=[f("mdi-dots-vertical",-1)])]),_:1}),e(Se,{activator:"parent"},{default:l(()=>[e(ke,null,{default:l(()=>[e(Y,{"prepend-icon":"mdi-currency-eur",title:"Suivi du règlement",onClick:y[1]||(y[1]=q=>K.value=!0)})]),_:1})]),_:1})]),_:1})]),default:l(()=>[e(B,{class:"mt-4"},{default:l(()=>[s.value?(b(),w(We,{key:0,type:"table"})):(b(),z("div",gn,[e(ee),i.value.length?Q("",!0):(b(),z("div",Vn," Aucun participant n'est encore inscrit sur ce séjour. ")),(b(!0),z(le,null,ce(i.value,(q,re)=>(b(),w(be,{participant:q,index:re},{actions:l(()=>[e(ke,{density:"comfortable"},{default:l(()=>[e(Y,{title:"Modifier","prepend-icon":"mdi-pencil",onClick:X=>d.value=q},null,8,["onClick"]),e(ue),e(Y,{title:"Changer de camp...","prepend-icon":"mdi-file-move",onClick:X=>C.value={Id:q.Participant.Id,Target:0}},null,8,["onClick"]),e(Y,{title:"Notifier d'une place disponible.",subtitle:"Envoi un email","prepend-icon":"mdi-email-alert",disabled:q.Participant.Statut==U(ll).Inscrit||q.Participant.Statut==U(ll).EnAttenteReponse,onClick:X=>P.value=q},null,8,["disabled","onClick"]),e(ue),e(Y,{title:"Aller à la personne",subtitle:`(ID : ${q.Personne.Id})`,onClick:X=>U(Ze)(q.Personne.Id)},null,8,["subtitle","onClick"]),e(Y,{title:"Aller au dossier",subtitle:`(ID : ${q.Participant.IdDossier})`,onClick:X=>U(_l)(q.Participant.IdDossier)},null,8,["subtitle","onClick"]),e(ue),e(Y,{title:"Supprimer","prepend-icon":"mdi-delete",onClick:X=>k.value=q},null,8,["onClick"])]),_:2},1024)]),_:2},1032,["participant","index"]))),256))]))]),_:1}),u.value!=null?(b(),w(Z,{key:0,"model-value":u.value!=null,"onUpdate:modelValue":y[4]||(y[4]=q=>u.value=null),"max-width":"600px"},{default:l(()=>[e(O,{title:"Créer un participant"},{default:l(()=>[e(B,null,{default:l(()=>[e(T,null,{default:l(()=>[e(V,{cols:"12"},{default:l(()=>[e(W,{label:"Participant",modelValue:u.value.IdPersonne,"onUpdate:modelValue":y[2]||(y[2]=q=>u.value.IdPersonne=q),"initial-personne":"",api:{SelectPersonne:U(x).SelectPersonne.bind(U(x))}},null,8,["modelValue","api"])]),_:1}),e(V,{cols:"12"},{default:l(()=>[e(A,{modelValue:u.value.IdDossier,"onUpdate:modelValue":y[3]||(y[3]=q=>u.value.IdDossier=q)},null,8,["modelValue"])]),_:1})]),_:1})]),_:1}),e(oe,null,{default:l(()=>[e(ie),e(L,{color:"green",onClick:r,disabled:!(u.value.IdDossier&&u.value.IdPersonne)},{default:l(()=>[...y[14]||(y[14]=[f("Créer",-1)])]),_:1},8,["disabled"])]),_:1})]),_:1})]),_:1},8,["model-value"])):Q("",!0),d.value!=null?(b(),w(Z,{key:1,"model-value":d.value!=null,"onUpdate:modelValue":y[5]||(y[5]=q=>d.value=null),"max-width":"800px"},{default:l(()=>[e(te,{participant:d.value.Participant,personne:d.value.Personne,api:{SelectPersonne:U(x).SelectPersonne.bind(U(x))},onSave:p},null,8,["participant","personne","api"])]),_:1},8,["model-value"])):Q("",!0),k.value!=null?(b(),w(Z,{key:2,"model-value":k.value!=null,"onUpdate:modelValue":y[6]||(y[6]=q=>k.value=null),"max-width":"600px"},{default:l(()=>[e(O,{title:"Supprimer le participant"},{default:l(()=>[e(B,null,{default:l(()=>[y[15]||(y[15]=f(" Confirmez-vous la suppression du participant ",-1)),N("b",null,M(U(he).label(k.value.Personne)),1),y[16]||(y[16]=f(" ? ",-1)),y[17]||(y[17]=N("br",null,null,-1)),y[18]||(y[18]=N("br",null,null,-1)),y[19]||(y[19]=f(" Attention, cette opération est irréversible. ",-1))]),_:1}),e(oe,null,{default:l(()=>[e(ie),e(L,{color:"red",onClick:I},{default:l(()=>[...y[20]||(y[20]=[f("Supprimer",-1)])]),_:1})]),_:1})]),_:1})]),_:1},8,["model-value"])):Q("",!0),C.value!=null?(b(),w(Z,{key:3,"model-value":C.value!=null,"onUpdate:modelValue":y[8]||(y[8]=q=>C.value=null),"max-width":"500px"},{default:l(()=>[e(O,{title:"Déplacer le participant"},{default:l(()=>[e(B,null,{default:l(()=>[e(ne,{label:"Nouveau séjour",camps:v.value,modelValue:C.value.Target,"onUpdate:modelValue":y[7]||(y[7]=q=>C.value.Target=q)},null,8,["camps","modelValue"])]),_:1}),e(oe,null,{default:l(()=>[e(ie),e(L,{onClick:_,disabled:C.value.Target==o.id||!C.value.Target},{default:l(()=>[...y[21]||(y[21]=[f("Déplacer",-1)])]),_:1},8,["disabled"])]),_:1})]),_:1})]),_:1},8,["model-value"])):Q("",!0),P.value!=null?(b(),w(Z,{key:4,"model-value":P.value!=null,"onUpdate:modelValue":y[9]||(y[9]=q=>P.value=null),"max-width":"500px"},{default:l(()=>[e(O,{title:"Notifier d'une place disponible"},{default:l(()=>[e(B,null,{default:l(()=>[f(" Confirmez-vous l'envoi d'une notification au responsable de "+M(U(he).label(P.value.Personne))+" indiquant qu'une place est disponible ? ",1),y[22]||(y[22]=N("br",null,null,-1)),y[23]||(y[23]=N("br",null,null,-1)),f(" Le nouveau statut de "+M(P.value.Personne.Prenom)+" sera : ",1),N("i",null,M(U(aa)[U(ll).EnAttenteReponse]),1),y[24]||(y[24]=f(". ",-1))]),_:1}),e(oe,null,{default:l(()=>[e(ie),e(L,{onClick:j},{default:l(()=>[...y[25]||(y[25]=[f("Notifier",-1)])]),_:1})]),_:1})]),_:1})]),_:1},8,["model-value"])):Q("",!0),e(Z,{modelValue:K.value,"onUpdate:modelValue":y[10]||(y[10]=q=>K.value=q),"max-width":"700px"},{default:l(()=>[e(h,{data:m.value},null,8,["data"])]),_:1},8,["modelValue"])]),_:1},8,["subtitle"])):(b(),w(We,{key:1,type:"card"}))}}}),Cn=G({__name:"camps",setup(t){const o=ul(),s=F(()=>Vu(o.currentRoute.value.query)),v=F(()=>s.value.idCamp);function a(m){const n=o.currentRoute.value;o.push({path:n.path,query:{idCamp:m.Camp.Camp.Id}})}function i(){const m=o.currentRoute.value;o.push({path:m.path,query:{}})}return(m,n)=>(b(),z(le,null,[e(yl,{title:"Gestion des séjours"},{default:l(()=>[v.value!==null?(b(),w(L,{key:0,onClick:i},{prepend:l(()=>[e(pe,null,{default:l(()=>[...n[0]||(n[0]=[f("mdi-view-list",-1)])]),_:1})]),default:l(()=>[n[1]||(n[1]=f(" Retour à la liste",-1))]),_:1})):Q("",!0)]),_:1}),v.value===void 0?(b(),w(bn,{key:0,onShowParticipants:a})):(b(),w(kn,{key:1,id:v.value,"id-participant":s.value.idParticipant},null,8,["id","id-participant"]))],64))}}),gt=G({__name:"MergeCard",props:{from:{}},emits:["merge"],setup(t,{emit:o}){const s=t,v=o,a=D(0),i=D(!0);return(m,n)=>{const c=ut;return b(),w(O,{title:"Fusionner le dossier vers",subtitle:"Les participants, paiements et messages seront copiés vers le dossier cible."},{default:l(()=>[e(B,null,{default:l(()=>[e(T,null,{default:l(()=>[e(V,{cols:"12"},{default:l(()=>[e(c,{modelValue:a.value,"onUpdate:modelValue":n[0]||(n[0]=u=>a.value=u)},null,8,["modelValue"])]),_:1}),e(V,{cols:"12"},{default:l(()=>[e(ze,{density:"compact",label:"Notifier par email",hint:"Le reponsable du dossier absorbé sera averti du changement d'espace personnel.","persistent-hint":"",modelValue:i.value,"onUpdate:modelValue":n[1]||(n[1]=u=>i.value=u)},null,8,["modelValue"])]),_:1})]),_:1})]),_:1}),e(oe,null,{default:l(()=>[e(ie),e(L,{disabled:a.value==0||a.value==s.from,onClick:n[2]||(n[2]=u=>v("merge",{From:s.from,To:a.value,Notifie:i.value}))},{default:l(()=>[...n[3]||(n[3]=[f("Fusionner",-1)])]),_:1},8,["disabled"])]),_:1})]),_:1})}}}),_n={key:1,class:"text-center font-italic"},xn={key:2},Pn=G({__name:"PannelInscriptions",emits:["goTo","empty"],setup(t,{emit:o}){const s=o,v=D(!1);Ee(async()=>{await i(),a.value.length||s("empty")});const a=D([]);async function i(){v.value=!0;const C=await x.InscriptionsGet();v.value=!1,C!==void 0&&(a.value=C||[])}const m=D(""),n=F(()=>{const C=at(m.value);return a.value.filter(_=>he.match(_.Responsable,C)||_.Participants?.some(P=>he.match(P.Personne,C)||xe.match(P.Camp,C)))});async function c(C,_){const P=await x.InscriptionsIdentifiePersonne({IdDossier:C,Target:_});if(P===void 0)return;x.showMessage("Profil identifié avec succès.");const j=a.value.findIndex(K=>K.Dossier.Id==C);a.value[j]=P}const u=D(null);async function r(C,_){if(!u.value)return;const P=u.value.inscription.Dossier.Id;u.value=null;const j=await x.InscriptionsValide({IdDossier:P,Statuts:C,SendMail:_});if(j!==void 0)if(j.Dossier.IsValidated)x.showMessage("Inscription validée avec succès.","",{title:"Aller au dossier",action:()=>s("goTo",P)}),a.value=a.value.filter(K=>K.Dossier.Id!=P);else{x.showMessage("Participant validé avec succès.");const K=a.value.findIndex(S=>S.Dossier.Id==P);a.value[K]=j}}async function d(C){await x.DossiersDelete({id:C.Dossier.Id})!==void 0&&(x.showMessage("Inscription supprimée avec succès."),a.value=a.value.filter(P=>P.Dossier.Id!=C.Dossier.Id))}async function p(C,_){if(await x.ParticipantsDelete({id:_})===void 0)return;x.showMessage("Participant supprimé avec succès.");const j=a.value.find(K=>K.Dossier.Id==C);j.Participants=(j.Participants||[]).filter(K=>K.Participant.Id!=_)}const k=D(null);async function I(C){k.value=null,await x.DossiersMerge(C)!==void 0&&(x.showMessage("Inscriptions fusionnées avec succès."),i())}return(C,_)=>{const P=$a;return b(),w(O,{title:"Inscriptions",subtitle:"En attente de validation",class:"ma-2"},{append:l(()=>[e(me,{width:"300","append-inner-icon":"mdi-magnify",label:"Rechercher","hide-details":"",modelValue:m.value,"onUpdate:modelValue":_[0]||(_[0]=j=>m.value=j)},null,8,["modelValue"])]),default:l(()=>[e(B,null,{default:l(()=>[v.value?(b(),w(We,{key:0})):a.value.length?(b(),z("div",xn,[(b(!0),z(le,null,ce(n.value,(j,K)=>(b(),w(Ma,{class:"my-1",user:null,key:K,inscription:j,onIdentifie:S=>c(j.Dossier.Id,S),onValide:S=>u.value={inscription:j,participants:S===void 0?void 0:[S]},onMerge:S=>k.value=j.Dossier.Id,onDelete:S=>d(j),onDeleteParticipant:S=>p(j.Dossier.Id,S),api:{SearchSimilaires:U(x).InscriptionsSearchSimilaires.bind(U(x)),SelectPersonne:U(x).SelectPersonne.bind(U(x))}},null,8,["inscription","onIdentifie","onValide","onMerge","onDelete","onDeleteParticipant","api"]))),128))])):(b(),z("div",_n," Il n'y a aucune inscription à valider. "))]),_:1}),e(Z,{"model-value":k.value!=null,"onUpdate:modelValue":_[1]||(_[1]=j=>k.value=null),"max-width":"600px"},{default:l(()=>[k.value!=null?(b(),w(gt,{key:0,from:k.value,onMerge:I},null,8,["from"])):Q("",!0)]),_:1},8,["model-value"]),e(Z,{"model-value":u.value!=null,"onUpdate:modelValue":_[2]||(_[2]=j=>u.value=null),"max-width":"800px"},{default:l(()=>[u.value?(b(),w(P,{key:0,inscription:u.value.inscription,"id-participants":u.value.participants,onValide:r},null,8,["inscription","id-participants"])):Q("",!0)]),_:1},8,["model-value"])]),_:1})}}}),wn={class:"text-grey"},Dn={class:"text-grey"},Sn={key:0},In=G({__name:"FactureCard",props:{dossier:{}},setup(t){const o=t,s=F(()=>(o.dossier.Participants||[]).filter(n=>n.Participant.Statut!=ll.Inscrit).map(n=>he.label(n.Personne))),v=F(()=>(o.dossier.Participants||[]).filter(n=>n.Participant.Statut==ll.Inscrit).map(n=>({Label:he.label(n.Personne),Camp:xe.label(n.Camp),Prix:_e.montant(n.Camp.Prix),Bilan:o.dossier.Bilan.Inscrits[n.Participant.Id]})));function a(n){return!!(n.Remises.ReducInscrits||n.Remises.ReducEquipiers||n.Remises.ReducSpeciale.Cent)}function i(n){const c=[];return n.ReducInscrits&&c.push(`Enfants : ${n.ReducInscrits}%`),n.ReducEquipiers&&c.push(`Enfants : ${n.ReducEquipiers}%`),n.ReducSpeciale.Cent&&c.push(`Remise : ${_e.montant(n.ReducSpeciale)}`),c.join("  ;  ")}const m=F(()=>{const n=Object.values(o.dossier.Paiements||{});return n.sort((c,u)=>new Date(c.Time).valueOf()-new Date(u.Time).valueOf()),n});return(n,c)=>(b(),w(O,{title:"Suivi financier",subtitle:s.value.length?`Les participants en liste d'attente (${s.value.join(", ")}) ne sont pas pris en compte.`:"","min-width":"900px"},{default:l(()=>[e(B,null,{default:l(()=>[e(T,null,{default:l(()=>[e(V,{cols:"3"},{default:l(()=>[...c[0]||(c[0]=[f("Participant",-1)])]),_:1}),e(V,{cols:"2",class:"text-center"},{default:l(()=>[...c[1]||(c[1]=[f("Prix du séjour",-1)])]),_:1}),e(V,{cols:"2",class:"text-center"},{default:l(()=>[...c[2]||(c[2]=[f("Prix avec option",-1)])]),_:1}),e(V,{cols:"3",class:"text-center"},{default:l(()=>[...c[3]||(c[3]=[f("Aides extérieures",-1)])]),_:1}),e(V,{cols:"2",class:"text-right"},{default:l(()=>[...c[4]||(c[4]=[f("Sous-total",-1)])]),_:1})]),_:1}),e(ue,{thickness:"1",class:"my-2"}),(b(!0),z(le,null,ce(v.value,u=>(b(),z(le,null,[e(T,null,{default:l(()=>[e(V,{"align-self":"center",cols:"3"},{default:l(()=>[f(M(u.Label)+" ",1),c[5]||(c[5]=N("br",null,null,-1)),N("span",wn,M(u.Camp),1)]),_:2},1024),e(V,{"align-self":"center",cols:"2",class:"text-center"},{default:l(()=>[f(M(u.Prix),1)]),_:2},1024),e(V,{"align-self":"center",cols:"2",class:"text-center"},{default:l(()=>[f(M(U(_e).montant(u.Bilan.AvecOption))+" ",1),c[6]||(c[6]=N("br",null,null,-1)),N("span",Dn,M(u.Bilan.AvecOptionDescription),1)]),_:2},1024),e(V,{"align-self":"center",cols:"3",class:"text-center"},{default:l(()=>[u.Bilan.Aides?.length?Q("",!0):(b(),z("span",Sn,"-")),(b(!0),z(le,null,ce(u.Bilan.Aides,r=>(b(),w(ye,null,{default:l(()=>[f(M(r.Structure)+" : "+M(U(_e).montant(r.Montant)),1)]),_:2},1024))),256))]),_:2},1024),e(V,{"align-self":"center",cols:"2",class:"text-right"},{default:l(()=>[f(M(u.Bilan.AvecAides),1)]),_:2},1024)]),_:2},1024),a(u.Bilan)?(b(),w(T,{key:0,"no-gutters":""},{default:l(()=>[e(V,{cols:"10",class:"text-right"},{default:l(()=>[N("i",null,M(i(u.Bilan.Remises)),1)]),_:2},1024),e(V,{cols:"2",class:"text-right"},{default:l(()=>[f(M(u.Bilan.Net),1)]),_:2},1024)]),_:2},1024)):Q("",!0)],64))),256)),e(ue,{thickness:"1",class:"my-2"}),e(T,null,{default:l(()=>[e(V,{cols:"10",class:"text-right"},{default:l(()=>[...c[7]||(c[7]=[f("Total demandé",-1)])]),_:1}),e(V,{cols:"2",class:"text-right"},{default:l(()=>[f(M(o.dossier.Bilan.Demande),1)]),_:1})]),_:1}),e(ue,{thickness:"1",class:"my-2"}),(b(!0),z(le,null,ce(m.value,u=>(b(),w(T,null,{default:l(()=>[e(V,null,{default:l(()=>[f(" Paiement de "+M(u.Payeur)+", le "+M(U(_e).date(u.Time)),1)]),_:2},1024),e(V,{cols:"2",class:"text-right"},{default:l(()=>[f(M(u.IsRemboursement?"+":"-")+M(U(_e).montant(u.Montant)),1)]),_:2},1024)]),_:2},1024))),256)),e(T,null,{default:l(()=>[e(V,{cols:"10",class:"text-right"},{default:l(()=>[...c[8]||(c[8]=[f("Solde",-1)])]),_:1}),e(V,{cols:"2",class:"text-right"},{default:l(()=>[N("b",null,M(o.dossier.Bilan.Restant),1)]),_:1})]),_:1})]),_:1})]),_:1},8,["subtitle"]))}});function qe(t){let o=arguments.length>1&&arguments[1]!==void 0?arguments[1]:2;return String(t).padStart(o,"0")}const An=Re({allowedValues:Function,ampm:Boolean,color:String,disabled:Boolean,displayedValue:null,double:Boolean,format:{type:Function,default:t=>t},max:{type:Number,required:!0},min:{type:Number,required:!0},scrollable:Boolean,readonly:Boolean,rotate:{type:Number,default:0},step:{type:Number,default:1},modelValue:{type:Number}},"VTimePickerClock"),Wl=Le()({name:"VTimePickerClock",props:An(),emits:{change:t=>!0,input:t=>!0},setup(t,o){let{emit:s}=o;const v=D(null),a=D(null),i=D(void 0),m=D(!1),n=D(null),c=D(null),u=na(g=>s("change",g),750),{textColorClasses:r,textColorStyles:d}=ua(()=>t.color),{backgroundColorClasses:p,backgroundColorStyles:k}=Gl(()=>t.color),I=F(()=>t.max-t.min+1),C=F(()=>t.double?I.value/2:I.value),_=F(()=>360/C.value),P=F(()=>_.value*Math.PI/180),j=F(()=>t.modelValue==null?t.min:t.modelValue),K=F(()=>.62),S=F(()=>{const g=[];for(let $=t.min;$<=t.max;$=$+t.step)g.push($);return g});Ae(()=>t.modelValue,g=>{i.value=g});function y(g){i.value!==g&&(i.value=g),s("input",g)}function ee(g){return!t.allowedValues||t.allowedValues(g)}function be(g){if(!t.scrollable||t.disabled)return;g.preventDefault();const $=Math.sign(-g.deltaY||1);let R=j.value;do R=R+$,R=(R-t.min+I.value)%I.value+t.min;while(!ee(R)&&R!==j.value);R!==t.displayedValue&&y(R),u(R)}function W(g){return t.double&&g-t.min>=C.value}function A(g){return W(g)?K.value:1}function te(g){const $=t.rotate*Math.PI/180;return{x:Math.sin((g-t.min)*P.value+$)*A(g),y:-Math.cos((g-t.min)*P.value+$)*A(g)}}function ne(g,$){const R=(Math.round(g/_.value)+($?C.value:0))%I.value+t.min;return g<360-_.value/2?R:$?t.max-C.value+1:t.min}function h(g){const{x:$,y:R}=te(g);return{left:`${Math.round(50+$*50)}%`,top:`${Math.round(50+R*50)}%`}}function q(g,$){const R=$.x-g.x,fe=$.y-g.y;return Math.sqrt(R*R+fe*fe)}function re(g,$){const R=2*Math.atan2($.y-g.y-q(g,$),$.x-g.x);return Math.abs(R*180/Math.PI)}function X(g){n.value===null&&(n.value=g),c.value=g,y(g)}function ge(g){if(g.preventDefault(),!m.value&&g.type!=="click"||!v.value)return;const{width:$,top:R,left:fe}=v.value?.getBoundingClientRect(),{width:ae}=a.value?.getBoundingClientRect()??{width:0},{clientX:Me,clientY:$e}="touches"in g?g.touches[0]:g,E={x:$/2,y:-$/2},H={x:Me-fe,y:R-$e},de=Math.round(re(E,H)-t.rotate+360)%360,ve=t.double&&q(E,H)<(ae+ae*K.value)/4,Ct=Math.ceil(15/_.value);let Qe;for(let ol=0;ol<Ct;ol++)if(Qe=ne(de+ol*_.value,ve),ee(Qe)||(Qe=ne(de-ol*_.value,ve),ee(Qe)))return X(Qe)}function Ve(g){t.disabled||(g.preventDefault(),window.addEventListener("mousemove",ge),window.addEventListener("touchmove",ge),window.addEventListener("mouseup",J),window.addEventListener("touchend",J),n.value=null,c.value=null,m.value=!0,ge(g))}function J(g){g.stopPropagation(),window.removeEventListener("mousemove",ge),window.removeEventListener("touchmove",ge),window.removeEventListener("mouseup",J),window.removeEventListener("touchend",J),m.value=!1,c.value!==null&&ee(c.value)&&s("change",c.value)}Te(()=>N("div",{class:Ce([{"v-time-picker-clock":!0,"v-time-picker-clock--indeterminate":t.modelValue==null,"v-time-picker-clock--readonly":t.readonly}]),onMousedown:Ve,onTouchstart:Ve,onWheel:be,ref:v},[N("div",{class:"v-time-picker-clock__inner",ref:a},[N("div",{class:Ce([{"v-time-picker-clock__hand":!0,"v-time-picker-clock__hand--inner":W(t.modelValue)},r.value]),style:al([{transform:`rotate(${t.rotate+_.value*(j.value-t.min)}deg) scaleY(${A(j.value)})`},d.value])},null),S.value.map(g=>{const $=g===j.value;return N("div",{class:Ce([{"v-time-picker-clock__item":!0,"v-time-picker-clock__item--active":$,"v-time-picker-clock__item--disabled":t.disabled||!ee(g)},$&&p.value]),style:al([h(g),$&&k.value])},[N("span",null,[t.format(g)])])})])]))}}),Mn=Re({ampm:Boolean,color:String,disabled:Boolean,hour:Number,minute:Number,second:Number,period:String,readonly:Boolean,useSeconds:Boolean,value:Number,viewMode:String},"VTimePickerControls"),Jl=Le()({name:"VTimePickerControls",props:Mn(),emits:{"update:period":t=>!0,"update:viewMode":t=>!0},setup(t,o){let{emit:s,slots:v}=o;const{t:a}=Je();return Te(()=>{let i=t.hour;return t.ampm&&(i=i?(i-1)%12+1:12),N("div",{class:"v-time-picker-controls"},[N("div",{class:Ce({"v-time-picker-controls__time":!0,"v-time-picker-controls__time--with-seconds":t.useSeconds})},[e(L,{active:t.viewMode==="hour",color:t.viewMode==="hour"?t.color:void 0,disabled:t.disabled,variant:"tonal",class:Ce({"v-time-picker-controls__time__btn":!0,"v-time-picker-controls__time--with-ampm__btn":t.ampm,"v-time-picker-controls__time--with-seconds__btn":t.useSeconds}),text:t.hour==null?"--":qe(`${i}`),onClick:()=>s("update:viewMode","hour")},null),N("span",{class:Ce(["v-time-picker-controls__time__separator",{"v-time-picker-controls--with-seconds__time__separator":t.useSeconds}])},[f(":")]),e(L,{active:t.viewMode==="minute",color:t.viewMode==="minute"?t.color:void 0,class:Ce({"v-time-picker-controls__time__btn":!0,"v-time-picker-controls__time__btn__active":t.viewMode==="minute","v-time-picker-controls__time--with-ampm__btn":t.ampm,"v-time-picker-controls__time--with-seconds__btn":t.useSeconds}),disabled:t.disabled,variant:"tonal",text:t.minute==null?"--":qe(t.minute),onClick:()=>s("update:viewMode","minute")},null),t.useSeconds&&N("span",{class:Ce(["v-time-picker-controls__time__separator",{"v-time-picker-controls--with-seconds__time__separator":t.useSeconds}]),key:"secondsDivider"},[f(":")]),t.useSeconds&&e(L,{key:"secondsVal",active:t.viewMode==="second",color:t.viewMode==="second"?t.color:void 0,variant:"tonal",onClick:()=>s("update:viewMode","second"),class:Ce({"v-time-picker-controls__time__btn":!0,"v-time-picker-controls__time__btn__active":t.viewMode==="second","v-time-picker-controls__time--with-seconds__btn":t.useSeconds}),disabled:t.disabled,text:t.second==null?"--":qe(t.second)},null),t.ampm&&N("div",{class:"v-time-picker-controls__ampm"},[e(L,{active:t.period==="am",color:t.period==="am"?t.color:void 0,class:Ce({"v-time-picker-controls__ampm__am":!0,"v-time-picker-controls__ampm__btn":!0,"v-time-picker-controls__ampm__btn__active":t.period==="am"}),disabled:t.disabled,text:a("$vuetify.timePicker.am"),variant:t.disabled&&t.period==="am"?"elevated":"tonal",onClick:()=>t.period!=="am"?s("update:period","am"):null},null),e(L,{active:t.period==="pm",color:t.period==="pm"?t.color:void 0,class:Ce({"v-time-picker-controls__ampm__pm":!0,"v-time-picker-controls__ampm__btn":!0,"v-time-picker-controls__ampm__btn__active":t.period==="pm"}),disabled:t.disabled,text:a("$vuetify.timePicker.pm"),variant:t.disabled&&t.period==="pm"?"elevated":"tonal",onClick:()=>t.period!=="pm"?s("update:period","pm"):null},null)])])])}),{}}}),$n=Ne(24),Vt=Ne(12),Un=Vt.map(t=>t+12);Ne(60);const Rn=Re({allowedHours:[Function,Array],allowedMinutes:[Function,Array],allowedSeconds:[Function,Array],disabled:Boolean,format:{type:String,default:"ampm"},max:String,min:String,viewMode:{type:String,default:"hour"},period:{type:String,default:"am",validator:t=>["am","pm"].includes(t)},modelValue:null,readonly:Boolean,scrollable:Boolean,useSeconds:Boolean,...He(nt({title:"$vuetify.timePicker.title"}),["landscape"])},"VTimePicker"),Fn=Le()({name:"VTimePicker",props:Rn(),emits:{"update:hour":t=>!0,"update:minute":t=>!0,"update:period":t=>!0,"update:second":t=>!0,"update:modelValue":t=>!0,"update:viewMode":t=>!0},setup(t,o){let{emit:s,slots:v}=o;const{t:a}=Je(),i=D(null),m=D(null),n=D(null),c=D(null),u=D(null),r=D(null),d=Ue(t,"period","am"),p=Ue(t,"viewMode","hour"),k=D(null),I=D(null),C=F(()=>{let h;if(t.allowedHours instanceof Array?h=X=>t.allowedHours.includes(X):h=t.allowedHours,!t.min&&!t.max)return h;const q=t.min?Number(t.min.split(":")[0]):0,re=t.max?Number(t.max.split(":")[0]):23;return X=>X>=Number(q)&&X<=Number(re)&&(!h||h(X))}),_=F(()=>{let h;const q=!C.value||i.value===null||C.value(i.value);if(t.allowedMinutes instanceof Array?h=$=>t.allowedMinutes.includes($):h=t.allowedMinutes,!t.min&&!t.max)return q?h:()=>!1;const[re,X]=t.min?t.min.split(":").map(Number):[0,0],[ge,Ve]=t.max?t.max.split(":").map(Number):[23,59],J=re*60+Number(X),g=ge*60+Number(Ve);return $=>{const R=60*i.value+$;return R>=J&&R<=g&&q&&(!h||h($))}}),P=F(()=>{let h;const re=(!C.value||i.value===null||C.value(i.value))&&(!_.value||m.value===null||_.value(m.value));if(t.allowedSeconds instanceof Array?h=ae=>t.allowedSeconds.includes(ae):h=t.allowedSeconds,!t.min&&!t.max)return re?h:()=>!1;const[X,ge,Ve]=t.min?t.min.split(":").map(Number):[0,0,0],[J,g,$]=t.max?t.max.split(":").map(Number):[23,59,59],R=X*3600+ge*60+Number(Ve||0),fe=J*3600+g*60+Number($||0);return ae=>{const Me=3600*i.value+60*m.value+ae;return Me>=R&&Me<=fe&&re&&(!h||h(ae))}}),j=F(()=>t.format==="ampm");Ae(()=>t.period,h=>A(h)),Ae(()=>t.modelValue,h=>be(h)),Ee(()=>{be(t.modelValue)});function K(){return i.value!=null&&m.value!=null&&(!t.useSeconds||n.value!=null)?`${qe(i.value)}:${qe(m.value)}`+(t.useSeconds?`:${qe(n.value)}`:""):null}function S(){const h=K();h!==null&&s("update:modelValue",h)}function y(h){return h?(h-1)%12+1:12}function ee(h,q){return h%12+(q==="pm"?12:0)}function be(h){if(h==null||h==="")i.value=null,m.value=null,n.value=null;else if(h instanceof Date)i.value=h.getHours(),m.value=h.getMinutes(),n.value=h.getSeconds();else{const[q,,re,,X,ge]=h.trim().toLowerCase().match(/^(\d+):(\d+)(:(\d+))?([ap]m)?$/)||new Array(6);i.value=ge?ee(parseInt(q,10),ge):parseInt(q,10),m.value=parseInt(re,10),n.value=parseInt(X||0,10)}d.value=i.value==null||i.value<12?"am":"pm"}function W(h,q){const re=C.value;if(!re)return q;const X=j.value?q<12?Vt:Un:$n;return((X.find(Ve=>re((Ve+q)%X.length+X[0]))||0)+q)%X.length+X[0]}function A(h){if(d.value=h,i.value!=null){const q=i.value+(d.value==="am"?-12:12);i.value=W("hour",q)}return s("update:period",h),S(),!0}function te(h){p.value==="hour"?i.value=j.value?ee(h,d.value):h:p.value==="minute"?m.value=h:n.value=h}function ne(h){switch(p.value||"hour"){case"hour":s("update:hour",h);break;case"minute":s("update:minute",h);break;case"second":s("update:second",h);break}const q=i.value!==null&&m.value!==null&&(t.useSeconds?n.value!==null:!0);p.value==="hour"?p.value="minute":t.useSeconds&&p.value==="minute"&&(p.value="second"),!(i.value===c.value&&m.value===u.value&&(!t.useSeconds||n.value===r.value)||K()===null)&&(c.value=i.value,u.value=m.value,t.useSeconds&&(r.value=n.value),q&&S())}Te(()=>{const h=cl.filterProps(t),q=Jl.filterProps(t),re=Wl.filterProps(He(t,["format","modelValue","min","max"]));return e(cl,se(h,{color:void 0,class:["v-time-picker",t.class],style:t.style}),{title:()=>v.title?.()??N("div",{class:"v-time-picker__title"},[a(t.title)]),header:()=>e(Jl,se(q,{ampm:j.value,hour:i.value,minute:m.value,period:d.value,second:n.value,viewMode:p.value,"onUpdate:period":X=>A(X),"onUpdate:viewMode":X=>p.value=X,ref:k}),null),default:()=>e(Wl,se(re,{allowedValues:p.value==="hour"?C.value:p.value==="minute"?_.value:P.value,double:p.value==="hour"&&!j.value,format:p.value==="hour"?j.value?y:X=>X:X=>qe(X,2),max:p.value==="hour"?j.value&&d.value==="am"?11:23:59,min:p.value==="hour"&&j.value&&d.value==="pm"?12:0,size:20,step:p.value==="hour"?1:5,modelValue:p.value==="hour"?i.value:p.value==="minute"?m.value:n.value,onChange:ne,onInput:te,ref:I}),null),actions:v.actions})})}}),Ln=G({__name:"TimeField",props:De({hideDetails:{type:Boolean},readonly:{type:Boolean}},{modelValue:{required:!0},modelModifiers:{}}),emits:["update:modelValue"],setup(t){const o=t,s=Pe(t,"modelValue"),v=F(()=>new Date(s.value).toLocaleTimeString(void 0,{hour:"numeric",minute:"numeric"}));function a(n){const[c,u]=n.split(":"),r=new Date(s.value);r.setHours(Number(c),Number(u)),s.value=r.toISOString()}function i(n){const c=new Date(n),u=new Date(s.value);c.setHours(u.getHours(),u.getMinutes(),u.getSeconds()),s.value=c.toISOString()}const m=D(!1);return(n,c)=>{const u=yt;return b(),w(T,{"no-gutters":""},{default:l(()=>[e(V,null,{default:l(()=>[e(u,{class:"mr-2",label:"Date","model-value":U(lt)(new Date(s.value)),"onUpdate:modelValue":i,"hide-details":o.hideDetails,readonly:o.readonly},null,8,["model-value","hide-details","readonly"])]),_:1}),e(V,{cols:"auto"},{default:l(()=>[...c[1]||(c[1]=[N("div",{class:"ma-2"},null,-1)])]),_:1}),e(V,null,{default:l(()=>[e(Se,{"close-on-content-click":!1,modelValue:m.value,"onUpdate:modelValue":c[0]||(c[0]=r=>m.value=r)},{activator:l(({props:r})=>[e(me,se({class:"center-text"},r,{variant:"outlined",density:"compact","hide-details":o.hideDetails,label:"Moment","model-value":v.value}),null,16,["hide-details","model-value"])]),default:l(()=>[e(Fn,{"model-value":new Date(s.value),"onUpdate:modelValue":a,format:"24hr"},null,8,["model-value"])]),_:1},8,["modelValue"])]),_:1})]),_:1})}}}),Tn=Pl(Ln,[["__scopeId","data-v-32955f86"]]),En=G({__name:"ModePaiementField",props:De({hideDetails:{type:Boolean},readonly:{type:Boolean},rules:{}},{modelValue:{required:!0},modelModifiers:{}}),emits:["update:modelValue"],setup(t){const o=t,s=Pe(t,"modelValue"),v=nl(ia);return(a,i)=>(b(),w(Oe,{label:"Mode de paiement",variant:"outlined",density:"compact",items:U(v),readonly:o.readonly,"hide-details":o.hideDetails,modelValue:s.value,"onUpdate:modelValue":i[0]||(i[0]=m=>s.value=m),rules:o.rules},null,8,["items","readonly","hide-details","modelValue","rules"]))}}),Nn=G({__name:"PaiementEditCard",props:{paiement:{}},emits:["update","delete"],setup(t,{emit:o}){const s=t,v=o,a=D(we(s.paiement)),i=F(()=>!0),m=D(!1);return(n,c)=>{const u=En,r=Ke,d=Tn;return b(),w(O,{title:"Modifier le paiement"},{default:l(()=>[e(Z,{modelValue:m.value,"onUpdate:modelValue":c[1]||(c[1]=p=>m.value=p),"max-width":"400px"},{default:l(()=>[e(O,{title:"Confirmation"},{default:l(()=>[e(B,null,{default:l(()=>[...c[11]||(c[11]=[f(" Confirmez-vous la suppression de ce paiement ? ",-1),N("br",null,null,-1),N("br",null,null,-1),f(" Attention, cette opération est irréversible. ",-1)])]),_:1}),e(oe,null,{default:l(()=>[e(ie),e(L,{color:"red",onClick:c[0]||(c[0]=p=>{m.value=!1,v("delete")})},{default:l(()=>[...c[12]||(c[12]=[f("Supprimer",-1)])]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"]),e(B,null,{default:l(()=>[e(T,null,{default:l(()=>[e(V,null,{default:l(()=>[e(me,{density:"compact",variant:"outlined","hide-details":"",label:"Payé par",modelValue:a.value.Payeur,"onUpdate:modelValue":c[2]||(c[2]=p=>a.value.Payeur=p)},null,8,["modelValue"])]),_:1}),e(V,null,{default:l(()=>[e(me,{density:"compact",variant:"outlined","hide-details":"",label:"Description (optionelle)",modelValue:a.value.Label,"onUpdate:modelValue":c[3]||(c[3]=p=>a.value.Label=p)},null,8,["modelValue"])]),_:1})]),_:1}),e(T,null,{default:l(()=>[e(V,null,{default:l(()=>[e(u,{modelValue:a.value.Mode,"onUpdate:modelValue":c[4]||(c[4]=p=>a.value.Mode=p),"hide-details":""},null,8,["modelValue"])]),_:1}),e(V,null,{default:l(()=>[e(r,{label:"Montant",modelValue:a.value.Montant,"onUpdate:modelValue":c[5]||(c[5]=p=>a.value.Montant=p),"hide-details":""},null,8,["modelValue"])]),_:1})]),_:1}),e(T,null,{default:l(()=>[e(V,null,{default:l(()=>[e(ze,{"hide-details":"",density:"compact",label:"Remboursement ?",modelValue:a.value.IsRemboursement,"onUpdate:modelValue":c[6]||(c[6]=p=>a.value.IsRemboursement=p)},null,8,["modelValue"])]),_:1})]),_:1}),e(T,null,{default:l(()=>[e(V,null,{default:l(()=>[e(d,{modelValue:a.value.Time,"onUpdate:modelValue":c[7]||(c[7]=p=>a.value.Time=p),"hide-details":""},null,8,["modelValue"])]),_:1})]),_:1}),e(T,null,{default:l(()=>[e(V,null,{default:l(()=>[e(me,{density:"compact",variant:"outlined",label:"Détails (optionnel)",modelValue:a.value.Details,"onUpdate:modelValue":c[8]||(c[8]=p=>a.value.Details=p)},null,8,["modelValue"])]),_:1})]),_:1})]),_:1}),e(oe,null,{default:l(()=>[e(L,{color:"red",onClick:c[9]||(c[9]=p=>m.value=!0)},{default:l(()=>[...c[13]||(c[13]=[f("Supprimer le paiement",-1)])]),_:1}),e(ie),e(L,{onClick:c[10]||(c[10]=p=>v("update",a.value)),disabled:!i.value},{default:l(()=>[...c[14]||(c[14]=[f("Enregistrer",-1)])]),_:1},8,["disabled"])]),_:1})]),_:1})}}}),hn=G({__name:"DossierEditCard",props:{responsable:{},dossier:{}},emits:["save"],setup(t,{emit:o}){const s=t,v=o,a=D(we(s.dossier));return(i,m)=>{const n=il,c=dt,u=wl;return b(),w(O,null,{default:l(()=>[e(B,null,{default:l(()=>[e(T,null,{default:l(()=>[e(V,null,{default:l(()=>[e(n,{label:"Responsable","initial-personne":s.responsable,"model-value":a.value.IdResponsable,"onUpdate:modelValue":m[0]||(m[0]=r=>r?a.value.IdResponsable=r:void 0),api:{SelectPersonne:U(x).SelectPersonne.bind(U(x))}},null,8,["initial-personne","model-value","api"])]),_:1})]),_:1}),e(T,null,{default:l(()=>[e(V,null,{default:l(()=>[e(c,{label:"Adresses mail en copie",modelValue:a.value.CopiesMails,"onUpdate:modelValue":m[1]||(m[1]=r=>a.value.CopiesMails=r),rule:U(sa).validMails()},null,8,["modelValue","rule"])]),_:1})]),_:1}),e(T,null,{default:l(()=>[e(V,null,{default:l(()=>[e(u,{"hide-details":"",modelValue:a.value.PartageAdressesOK,"onUpdate:modelValue":m[2]||(m[2]=r=>a.value.PartageAdressesOK=r),label:"Partage des coordonnées"},null,8,["modelValue"])]),_:1})]),_:1}),e(T,null,{default:l(()=>[e(V,null,{default:l(()=>[e(u,{"hide-details":"",modelValue:a.value.DemandeFondSoutien,"onUpdate:modelValue":m[3]||(m[3]=r=>a.value.DemandeFondSoutien=r),label:"Demande le fonds de soutien"},null,8,["modelValue"])]),_:1})]),_:1})]),_:1}),e(oe,null,{default:l(()=>[e(ie),e(L,{onClick:m[4]||(m[4]=r=>v("save",a.value))},{default:l(()=>[...m[5]||(m[5]=[f("Enregistrer",-1)])]),_:1})]),_:1})]),_:1})}}}),On=G({__name:"OptionJournee",props:De({camp:{}},{modelValue:{required:!0},modelModifiers:{}}),emits:["update:modelValue"],setup(t){const o=t,s=Pe(t,"modelValue"),v=F(()=>(o.camp.OptionPrix.Jours||[]).map((a,i)=>i));return(a,i)=>(b(),w(O,null,{default:l(()=>[e(B,null,{default:l(()=>[i[1]||(i[1]=N("div",{class:"text-grey mb-2"}," Le prix est variable en fonction des jours de participation au camp. ",-1)),e(oa,{class:"overflow-x-auto",color:"secondary",multiple:"","model-value":s.value?.length?s.value:v.value,"onUpdate:modelValue":i[0]||(i[0]=m=>s.value=m.length==v.value.length?[]:m)},{default:l(()=>[(b(!0),z(le,null,ce(o.camp.OptionPrix.Jours,(m,n)=>(b(),w(L,null,{default:l(()=>[f("J "+M(n+1),1)]),_:2},1024))),256))]),_:1},8,["model-value"])]),_:1})]),_:1}))}}),Bn=G({__name:"OptionStatut",props:De({camp:{}},{modelValue:{required:!0},modelModifiers:{}}),emits:["update:modelValue"],setup(t){const o=t,s=Pe(t,"modelValue"),v=F(()=>(o.camp.OptionPrix.Statuts||[]).map(i=>({value:i.Id,title:i.Label,subtitle:i.Description}))),a=F(()=>v.value.map(i=>i.value).includes(s.value));return(i,m)=>(b(),w(O,null,{default:l(()=>[e(B,null,{default:l(()=>[m[1]||(m[1]=N("div",{class:"text-grey mb-4"},"Le prix dépend du statut du participant.",-1)),e(Oe,{clearable:"",items:v.value,label:"Statut","model-value":a.value?s.value:null,"onUpdate:modelValue":m[0]||(m[0]=n=>s.value=n??0),variant:"outlined",density:"comfortable","hide-details":""},{item:l(({item:n,props:c})=>[e(Y,se(c,{title:n.title,subtitle:n.raw.subtitle}),null,16,["title","subtitle"])]),_:1},8,["items","model-value"])]),_:1})]),_:1}))}}),jn={key:2},qn=G({__name:"ParticipantOptionPrix",props:{camp:{},optionAndQf:{}},emits:["update"],setup(t,{emit:o}){const s=t,v=o,a=D(we(s.optionAndQf));return Ae(()=>s.optionAndQf,()=>a.value=we(s.optionAndQf)),(i,m)=>{const n=Ge;return b(),w(O,{title:"Prix variable",width:"800px"},{default:l(()=>[e(B,null,{default:l(()=>[e(T,{justify:"space-evenly"},{default:l(()=>[e(V,{"align-self":"center",cols:"3"},{default:l(()=>[e(n,{modelValue:a.value.quotientFamilial,"onUpdate:modelValue":m[0]||(m[0]=c=>a.value.quotientFamilial=c),label:"Quotient familial","hide-details":""},null,8,["modelValue"])]),_:1}),e(ue,{thickness:"2",vertical:""}),e(V,{"align-self":"center",cols:"8"},{default:l(()=>[s.camp.OptionPrix.Active==U(Ie).PrixJour?(b(),w(On,{key:0,camp:s.camp,modelValue:a.value.options.Jour,"onUpdate:modelValue":m[1]||(m[1]=c=>a.value.options.Jour=c)},null,8,["camp","modelValue"])):s.camp.OptionPrix.Active==U(Ie).PrixStatut?(b(),w(Bn,{key:1,camp:s.camp,modelValue:a.value.options.IdStatut,"onUpdate:modelValue":m[2]||(m[2]=c=>a.value.options.IdStatut=c)},null,8,["camp","modelValue"])):(b(),z("div",jn,"Le camp ne propose pas d'option sur le prix."))]),_:1})]),_:1})]),_:1}),e(oe,null,{default:l(()=>[e(ie),e(L,{onClick:m[3]||(m[3]=c=>v("update",a.value))},{default:l(()=>[...m[4]||(m[4]=[f("Enregistrer",-1)])]),_:1})]),_:1})]),_:1})}}}),Hn={key:1,class:"mx-1"},Yn={key:2,class:"mx-1"},zn={key:3},Qn={key:4,class:"mx-1"},Wn=G({__name:"RemisesChip",props:{remises:{}},emits:["update"],setup(t,{emit:o}){const s=t,v=o,a=F(()=>i.value.ReducInscrits!=0||i.value.ReducEquipiers!=0||i.value.ReducSpeciale.Cent!=0),i=D(we(s.remises));Ae(()=>s.remises,()=>i.value=we(s.remises));const m=D(!1);return(n,c)=>{const u=Ge,r=Ke;return b(),w(Se,{"close-on-content-click":!1,location:"bottom",modelValue:m.value,"onUpdate:modelValue":c[4]||(c[4]=d=>m.value=d)},{activator:l(({props:d})=>[e(O,se(d,{elevation:"1",color:"grey-lighten-2"}),{default:l(()=>[e(B,{class:"py-1 px-1"},{default:l(()=>[a.value?Q("",!0):(b(),z(le,{key:0},[f(" Pas de remises ")],64)),i.value.ReducInscrits?(b(),z("span",Hn," Inscrits : "+M(i.value.ReducInscrits)+"% ",1)):Q("",!0),i.value.ReducEquipiers?(b(),z("span",Yn," Equipiers : "+M(i.value.ReducEquipiers)+"% ",1)):Q("",!0),(i.value.ReducInscrits||i.value.ReducEquipiers)&&i.value.ReducSpeciale.Cent?(b(),z("br",zn)):Q("",!0),i.value.ReducSpeciale.Cent?(b(),z("span",Qn," Remise : "+M(U(_e).montant(i.value.ReducSpeciale)),1)):Q("",!0)]),_:1})]),_:1},16)]),default:l(()=>[e(O,{title:"Modifier les remises",width:"400px"},{default:l(()=>[e(B,null,{default:l(()=>[e(T,null,{default:l(()=>[e(V,null,{default:l(()=>[e(u,{modelValue:i.value.ReducInscrits,"onUpdate:modelValue":c[0]||(c[0]=d=>i.value.ReducInscrits=d),label:"Remise inscrits","hide-details":"",suffix:"%"},null,8,["modelValue"])]),_:1}),e(V,null,{default:l(()=>[e(u,{modelValue:i.value.ReducEquipiers,"onUpdate:modelValue":c[1]||(c[1]=d=>i.value.ReducEquipiers=d),label:"Remise équipiers","hide-details":"",suffix:"%"},null,8,["modelValue"])]),_:1})]),_:1}),e(T,null,{default:l(()=>[e(V,null,{default:l(()=>[e(r,{class:"mt-2",modelValue:i.value.ReducSpeciale,"onUpdate:modelValue":c[2]||(c[2]=d=>i.value.ReducSpeciale=d),label:"Remise spéciale","hide-details":""},null,8,["modelValue"])]),_:1})]),_:1})]),_:1}),e(oe,null,{default:l(()=>[e(ie),e(L,{onClick:c[3]||(c[3]=d=>{v("update",i.value),m.value=!1})},{default:l(()=>[...c[5]||(c[5]=[f("Enregistrer",-1)])]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"])}}}),Jn=Pl(Wn,[["__scopeId","data-v-cc911118"]]),Gn=G({__name:"AideEditCard",props:{aide:{},file:{},structures:{},participant:{}},emits:["save","deleteFile","uploadFile","showStructureaides"],setup(t,{emit:o}){const s=t,v=o,a=D(we(s.aide)),i=F(()=>Object.values(s.structures).map(m=>({value:m.Id,title:m.Nom})));return(m,n)=>{const c=wl,u=Ke,r=Ge,d=qa;return b(),w(O,{title:"Modifier l'aide extérieure",subtitle:`pour ${U(he).label(s.participant.Personne)} - ${U(xe).label(s.participant.Camp)}`},{append:l(()=>[e(L,{onClick:n[0]||(n[0]=p=>v("showStructureaides"))},{default:l(()=>[e(pe,null,{default:l(()=>[...n[9]||(n[9]=[f("mdi-view-list",-1)])]),_:1}),n[10]||(n[10]=f(" Structures",-1))]),_:1})]),default:l(()=>[e(B,null,{default:l(()=>[e(T,null,{default:l(()=>[e(V,null,{default:l(()=>[e(Oe,{variant:"outlined",density:"comfortable",label:"Structure",items:i.value,modelValue:a.value.IdStructureaide,"onUpdate:modelValue":n[1]||(n[1]=p=>a.value.IdStructureaide=p)},null,8,["items","modelValue"])]),_:1}),e(V,null,{default:l(()=>[e(c,{modelValue:a.value.Valide,"onUpdate:modelValue":n[2]||(n[2]=p=>a.value.Valide=p),label:"Aide validée","hide-details":""},null,8,["modelValue"])]),_:1})]),_:1}),e(T,null,{default:l(()=>[e(V,{"align-self":"center"},{default:l(()=>[e(u,{modelValue:a.value.Valeur,"onUpdate:modelValue":n[3]||(n[3]=p=>a.value.Valeur=p),label:"Montant","hide-details":""},null,8,["modelValue"])]),_:1}),e(V,{"align-self":"center",cols:"auto"},{default:l(()=>[e(c,{"hide-details":"",label:"Par jour",modelValue:a.value.ParJour,"onUpdate:modelValue":n[4]||(n[4]=p=>a.value.ParJour=p)},null,8,["modelValue"])]),_:1}),e(V,{"align-self":"center"},{default:l(()=>[e(r,{label:"Limite",suffix:"jours",modelValue:a.value.NbJoursMax,"onUpdate:modelValue":n[5]||(n[5]=p=>a.value.NbJoursMax=p),disabled:!a.value.ParJour,hint:"0 pour ne pas limiter",min:0,"persistent-hint":""},null,8,["modelValue","disabled"])]),_:1})]),_:1}),e(d,{class:"mt-4",files:s.file?[s.file]:[],title:"Document justificatif","max-docs":1,"in-upload":!1,onDelete:n[6]||(n[6]=p=>v("deleteFile")),onUpload:n[7]||(n[7]=p=>v("uploadFile",p))},null,8,["files"])]),_:1}),e(oe,null,{default:l(()=>[e(ie),e(L,{onClick:n[8]||(n[8]=p=>v("save",a.value))},{default:l(()=>[...n[11]||(n[11]=[f("Enregistrer",-1)])]),_:1})]),_:1})]),_:1},8,["subtitle"])}}}),Kn=G({__name:"StructuresPannel",props:{modelValue:{required:!0},modelModifiers:{}},emits:["update:modelValue"],setup(t){const o=Pe(t,"modelValue"),s=F(()=>Object.values(o.value||{}).sort((c,u)=>c.Nom.localeCompare(u.Nom)));async function v(){const c=await x.StructureaideCreate();if(c===void 0)return;x.showMessage("Structure créée avec succès.");const u=o.value||{};u[c.Id]=c,o.value=u,a.value=c}const a=D(null);async function i(){const c=a.value;if(c==null||(a.value=null,await x.StructureaideUpdate(c)===void 0))return;x.showMessage("Structure modifiée avec succès.");const r=o.value||{};r[c.Id]=c,o.value=r}const m=D(null);async function n(){const c=m.value;if(c==null||(m.value=null,await x.StructureaideDelete({id:c.Id})===void 0))return;const r=o.value||{};delete r[c.Id],o.value=r,x.showMessage("Structure supprimée avec succès.")}return(c,u)=>(b(),w(O,{title:"Structures d'aide",subtitle:"Organismes pouvant distribuer une aide extérieure"},{append:l(()=>[e(L,{onClick:v},{prepend:l(()=>[e(pe,{color:"green"},{default:l(()=>[...u[5]||(u[5]=[f("mdi-plus",-1)])]),_:1})]),default:l(()=>[u[6]||(u[6]=f(" Ajouter une structure ",-1))]),_:1})]),default:l(()=>[e(B,{class:"overflow-y-auto"},{default:l(()=>[(b(!0),z(le,null,ce(s.value,r=>(b(),w(T,null,{default:l(()=>[e(V,{"align-self":"center"},{default:l(()=>[e(st,null,{default:l(()=>[f(M(r.Nom),1)]),_:2},1024),e(ot,null,{default:l(()=>[f(M(r.Immatriculation),1)]),_:2},1024)]),_:2},1024),e(V,{"align-self":"center",style:{"font-size":"smaller"}},{default:l(()=>[(b(!0),z(le,null,ce(r.Info.split(`
`),d=>(b(),z("div",null,M(d),1))),256))]),_:2},1024),e(V,{"align-self":"center",cols:"auto"},{default:l(()=>[e(Se,null,{activator:l(({props:d})=>[e(L,se({icon:"mdi-dots-vertical"},{ref_for:!0},d,{size:"x-small"}),null,16)]),default:l(()=>[e(ke,null,{default:l(()=>[e(Y,{title:"Modifier","prepend-icon":"mdi-pencil",onClick:d=>a.value=U(we)(r)},null,8,["onClick"]),e(Y,{title:"Supprimer","prepend-icon":"mdi-delete",onClick:d=>m.value=r},null,8,["onClick"])]),_:2},1024)]),_:2},1024)]),_:2},1024)]),_:2},1024))),256))]),_:1}),e(Z,{"model-value":a.value!=null,"onUpdate:modelValue":u[3]||(u[3]=r=>a.value=null),"max-width":"600px"},{default:l(()=>[a.value!=null?(b(),w(O,{key:0,title:"Modifier la structure"},{default:l(()=>[e(B,null,{default:l(()=>[e(T,null,{default:l(()=>[e(V,null,{default:l(()=>[e(me,{variant:"outlined",density:"compact",label:"Nom",modelValue:a.value.Nom,"onUpdate:modelValue":u[0]||(u[0]=r=>a.value.Nom=r),"hide-details":""},null,8,["modelValue"])]),_:1}),e(V,null,{default:l(()=>[e(me,{variant:"outlined",density:"compact",label:"Immatriculation",modelValue:a.value.Immatriculation,"onUpdate:modelValue":u[1]||(u[1]=r=>a.value.Immatriculation=r),"hide-details":""},null,8,["modelValue"])]),_:1})]),_:1}),e(T,null,{default:l(()=>[e(V,null,{default:l(()=>[e(vl,{variant:"outlined",density:"compact",label:"Informations",modelValue:a.value.Info,"onUpdate:modelValue":u[2]||(u[2]=r=>a.value.Info=r),"hide-details":""},null,8,["modelValue"])]),_:1})]),_:1})]),_:1}),e(oe,null,{default:l(()=>[e(ie),e(L,{onClick:i},{default:l(()=>[...u[7]||(u[7]=[f("Enregistrer",-1)])]),_:1})]),_:1})]),_:1})):Q("",!0)]),_:1},8,["model-value"]),e(Z,{"model-value":m.value!=null,"onUpdate:modelValue":u[4]||(u[4]=r=>m.value=null),"max-width":"450px"},{default:l(()=>[m.value!=null?(b(),w(O,{key:0,title:"Confirmation"},{default:l(()=>[e(B,null,{default:l(()=>[f(" Confirmez-vous la suppression de la structure "+M(m.value.Nom)+" ? ",1),u[8]||(u[8]=N("br",null,null,-1)),u[9]||(u[9]=N("br",null,null,-1)),u[10]||(u[10]=f(" Attention, cette opération est irréversible. ",-1))]),_:1}),e(oe,null,{default:l(()=>[e(ie),e(L,{color:"red",onClick:n},{default:l(()=>[...u[11]||(u[11]=[f("Supprimer",-1)])]),_:1})]),_:1})]),_:1})):Q("",!0)]),_:1},8,["model-value"])]),_:1}))}}),Xn={key:0},Zn={key:1},eu=G({__name:"DossierParticipantRow",props:De({participant:{},aides:{},aidesFiles:{},hasManyParticipants:{type:Boolean}},{structures:{required:!0},structuresModifiers:{}}),emits:De(["update","delete","createAide","updateAide","deleteAide","deleteFileAide","uploadFileAide","expand"],["update:structures"]),setup(t,{emit:o}){const s=t,v=Pe(t,"structures"),a=o,i=F(()=>{const C=Object.values(s.aides||{});return C.sort((_,P)=>_.Id-P.Id),C}),m=F(()=>s.participant.Camp.OptionPrix.Active==Ie.NoOption&&!xe.isQuotientFamilialActive(s.participant.Camp.OptionQuotientFamilial));function n(C){switch(s.participant.Camp.OptionPrix.Active){case Ie.NoOption:return"Séjour sans option";case Ie.PrixJour:const _=C.Jour?.length||0;return _==0?"Présent tous les jours":`Présent ${_} jour${_>1?"s":""}`;case Ie.PrixStatut:const P=s.participant.Camp.OptionPrix.Statuts?.find(j=>j.Id==C.IdStatut);return P?`Statut ${P.Label}`:"Pas d'option."}}const c=D(!1),u=D(!1),r=F(()=>Object.values(v.value).map(C=>({value:C.Id,title:C.Nom})).sort((C,_)=>C.title.localeCompare(_.title))),d=D(null),p=D(null),k=D(null),I=D(!1);return(C,_)=>(b(),w(T,null,{default:l(()=>[e(V,{"align-self":"center",cols:"3"},{default:l(()=>[e(st,null,{default:l(()=>[N("a",{href:"/camps",onClick:_[0]||(_[0]=tl(P=>U(Dl)(s.participant.Participant),["prevent"]))},M(U(he).label(s.participant.Personne)),1)]),_:1}),e(ot,null,{default:l(()=>[f(M(U(xe).label(s.participant.Camp)),1)]),_:1})]),_:1}),e(V,{"align-self":"center",cols:"2",class:"text-center"},{default:l(()=>[e(Se,{disabled:m.value,"close-on-content-click":!1,modelValue:c.value,"onUpdate:modelValue":_[2]||(_[2]=P=>c.value=P)},{activator:l(({props:P})=>[e(O,se(P,{elevation:m.value?0:1,color:"grey-lighten-2"}),{default:l(()=>[e(B,{class:"py-1 px-1"},{default:l(()=>[m.value?(b(),z("div",Xn,"Camp sans option")):(b(),z("div",Zn,[f(M(s.participant.Participant.QuotientFamilial?`QF ${s.participant.Participant.QuotientFamilial}.`:"Pas de QF.")+" ",1),_[22]||(_[22]=N("br",null,null,-1)),f(" "+M(n(s.participant.Participant.OptionPrix)),1)]))]),_:1})]),_:1},16,["elevation"])]),default:l(()=>[e(qn,{camp:s.participant.Camp,"option-and-qf":{options:s.participant.Participant.OptionPrix,quotientFamilial:s.participant.Participant.QuotientFamilial},onUpdate:_[1]||(_[1]=P=>{s.participant.Participant.OptionPrix=P.options,s.participant.Participant.QuotientFamilial=P.quotientFamilial,c.value=!1,a("update",s.participant.Participant)})},null,8,["camp","option-and-qf"])]),_:1},8,["disabled","modelValue"])]),_:1}),e(V,{"align-self":"center",class:"text-center"},{default:l(()=>[i.value.length?Q("",!0):(b(),w(ye,{key:0,label:""},{default:l(()=>[..._[23]||(_[23]=[f("Aucune aide",-1)])]),_:1})),(b(!0),z(le,null,ce(i.value,P=>(b(),w(ye,{class:"my-1","prepend-icon":"mdi-cash-plus",color:P.Valide?"green":"orange",onClick:j=>p.value=P},{close:l(()=>[e(pe,{icon:"mdi-close-circle",onClick:tl(j=>k.value=P,["stop"])},null,8,["onClick"])]),default:l(()=>[f(" "+M(v.value[P.IdStructureaide].Nom)+" : "+M(U(_e).montant(P.Valeur)),1)]),_:2},1032,["color","onClick"]))),256))]),_:1}),e(V,{"align-self":"center",class:"text-center",cols:"3"},{default:l(()=>[e(Jn,{remises:s.participant.Participant.Remises,onUpdate:_[3]||(_[3]=P=>{s.participant.Participant.Remises=P,a("update",s.participant.Participant)})},null,8,["remises"])]),_:1}),e(V,{"align-self":"center",cols:"auto"},{default:l(()=>[e(Se,{location:"left"},{activator:l(({props:P})=>[e(L,se(P,{icon:"mdi-dots-vertical",size:"small"}),null,16)]),default:l(()=>[e(ke,{density:"comfortable"},{default:l(()=>[e(Y,{title:"Ajouter une aide","prepend-icon":"mdi-cash-plus",onClick:_[4]||(_[4]=P=>d.value={IdParticipant:s.participant.Participant.Id,IdStructure:0})}),e(ue),s.hasManyParticipants?(b(),w(Y,{key:0,"prepend-icon":"mdi-arrow-expand",title:"Étendre les options et remises",subtitle:"... au reste du dossier",onClick:_[5]||(_[5]=P=>a("expand"))})):Q("",!0),e(ue),e(Y,{title:"Supprimer","prepend-icon":"mdi-delete",onClick:_[6]||(_[6]=P=>u.value=!0)})]),_:1})]),_:1})]),_:1}),e(Z,{modelValue:u.value,"onUpdate:modelValue":_[8]||(_[8]=P=>u.value=P),"max-width":"600px"},{default:l(()=>[e(O,{title:"Supprimer le participant"},{default:l(()=>[e(B,null,{default:l(()=>[..._[24]||(_[24]=[f(" Confirmez-vous la suppression de ce participant ? ",-1),N("br",null,null,-1),f(" Attention, cette opération est irréversible. ",-1)])]),_:1}),e(oe,null,{default:l(()=>[e(ie),e(L,{color:"red",onClick:_[7]||(_[7]=P=>{a("delete"),u.value=!1})},{default:l(()=>[..._[25]||(_[25]=[f("Supprimer",-1)])]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"]),e(Z,{modelValue:I.value,"onUpdate:modelValue":_[10]||(_[10]=P=>I.value=P),"max-width":"650px"},{default:l(()=>[e(Kn,{modelValue:v.value,"onUpdate:modelValue":_[9]||(_[9]=P=>v.value=P)},null,8,["modelValue"])]),_:1},8,["modelValue"]),d.value!=null?(b(),w(Z,{key:0,"model-value":d.value!=null,"onUpdate:modelValue":_[14]||(_[14]=P=>d.value=null),width:"600px"},{default:l(()=>[e(O,{title:"Ajouter une aide extérieure"},{append:l(()=>[e(L,{onClick:_[11]||(_[11]=P=>I.value=!0)},{default:l(()=>[e(pe,null,{default:l(()=>[..._[26]||(_[26]=[f("mdi-view-list",-1)])]),_:1}),_[27]||(_[27]=f(" Structures",-1))]),_:1})]),default:l(()=>[e(B,null,{default:l(()=>[e(Oe,{variant:"outlined",density:"comfortable",label:"Structure",items:r.value,"model-value":d.value.IdStructure==0?null:d.value.IdStructure,"onUpdate:modelValue":_[12]||(_[12]=P=>d.value.IdStructure=P)},null,8,["items","model-value"])]),_:1}),e(oe,null,{default:l(()=>[e(ie),e(L,{color:"green",onClick:_[13]||(_[13]=P=>{a("createAide",d.value),d.value=null}),disabled:d.value.IdStructure==0},{default:l(()=>[..._[28]||(_[28]=[f("Créer",-1)])]),_:1},8,["disabled"])]),_:1})]),_:1})]),_:1},8,["model-value"])):Q("",!0),p.value!=null?(b(),w(Z,{key:1,"model-value":p.value!=null,"onUpdate:modelValue":_[19]||(_[19]=P=>p.value=null),"max-width":"800px"},{default:l(()=>[e(Gn,{aide:p.value,file:t.aidesFiles[p.value.Id],structures:v.value,participant:s.participant,onShowStructureaides:_[15]||(_[15]=P=>I.value=!0),onSave:_[16]||(_[16]=P=>{a("updateAide",P),p.value=null}),onDeleteFile:_[17]||(_[17]=P=>a("deleteFileAide",p.value.Id)),onUploadFile:_[18]||(_[18]=P=>a("uploadFileAide",P,p.value.Id))},null,8,["aide","file","structures","participant"])]),_:1},8,["model-value"])):Q("",!0),k.value!=null?(b(),w(Z,{key:2,"model-value":k.value!=null,"onUpdate:modelValue":_[21]||(_[21]=P=>k.value=null),"max-width":"600px"},{default:l(()=>[e(O,{title:"Supprimer l'aide"},{default:l(()=>[e(B,null,{default:l(()=>[..._[29]||(_[29]=[f(" Confirmez-vous la suppression de l'aide extérieure ? ",-1),N("br",null,null,-1),f(" Attention, cette opération est irréversible. ",-1)])]),_:1}),e(oe,null,{default:l(()=>[e(ie),e(L,{color:"red",onClick:_[20]||(_[20]=P=>{a("deleteAide",k.value.Id),k.value=null})},{default:l(()=>[..._[30]||(_[30]=[f("Supprimer",-1)])]),_:1})]),_:1})]),_:1})]),_:1},8,["model-value"])):Q("",!0)]),_:1}))}}),lu=G({__name:"DossierEditor",props:{dossier:{},camps:{}},emits:["updateDossier","createParticipant","updateParticipant","deleteParticipant","expandParticipant","createAide","updateAide","deleteAide","deleteFileAide","uploadFileAide"],setup(t,{emit:o}){const s=t,v=o,a=D(null);Ee(n);const i=D(!0),m=D({});async function n(){const c=await x.StructureaidesGet();c!==void 0&&(i.value=!1,m.value=c||{})}return(c,u)=>(b(),w(O,{title:"Modifier le dossier"},{append:l(()=>[e(L,{onClick:u[0]||(u[0]=r=>a.value={IdCamp:0,IdPersonne:0,IdDossier:s.dossier.Dossier.Dossier.Id})},{prepend:l(()=>[e(pe,{color:"green"},{default:l(()=>[...u[9]||(u[9]=[f("mdi-plus",-1)])]),_:1})]),default:l(()=>[u[10]||(u[10]=f(" Ajouter un participant",-1))]),_:1})]),default:l(()=>[e(B,null,{default:l(()=>[e(T,null,{default:l(()=>[e(V,{cols:"3"},{default:l(()=>[e(hn,{responsable:s.dossier.Dossier.Responsable,dossier:s.dossier.Dossier.Dossier,onSave:u[1]||(u[1]=r=>v("updateDossier",r))},null,8,["responsable","dossier"])]),_:1}),e(ue,{thickness:"2",vertical:""}),i.value?Q("",!0):(b(),w(V,{key:0},{default:l(()=>[u[11]||(u[11]=N("div",{class:"my-1"},null,-1)),(b(!0),z(le,null,ce(s.dossier.Dossier.Participants,r=>(b(),w(eu,{participant:r,aides:(s.dossier.Dossier.Aides||{})[r.Participant.Id],"aides-files":s.dossier.Dossier.AidesFiles||{},"has-many-participants":(s.dossier.Dossier.Participants?.length||0)>1,structures:m.value,"onUpdate:structures":u[2]||(u[2]=d=>m.value=d),onCreateAide:u[3]||(u[3]=d=>v("createAide",d)),onDeleteAide:u[4]||(u[4]=d=>v("deleteAide",d)),onUpdateAide:u[5]||(u[5]=d=>v("updateAide",d)),onDeleteFileAide:u[6]||(u[6]=d=>v("deleteFileAide",d)),onUploadFileAide:u[7]||(u[7]=(d,p)=>v("uploadFileAide",d,p)),onUpdate:u[8]||(u[8]=d=>v("updateParticipant",d)),onDelete:d=>v("deleteParticipant",r.Participant.Id),onExpand:d=>v("expandParticipant",r.Participant)},null,8,["participant","aides","aides-files","has-many-participants","structures","onDelete","onExpand"]))),256))]),_:1}))]),_:1})]),_:1})]),_:1}))}}),tu={class:"mr-1"},au=["onClick"],nu={class:"overflow-y-auto",style:{"max-height":"65vh"}},uu=["href"],iu=G({__name:"DossierDetailsPannel",props:{dossier:{},camps:{}},emits:["updateDossier","deleteDossier","mergeDossier","createParticipant","updateParticipant","deleteParticipant","expandParticipant","createAide","updateAide","deleteAide","deleteFileAide","uploadFileAide","createPaiement","updatePaiement","deletePaiement","sendMessage","deleteMessage","sendFacture"],setup(t,{expose:o,emit:s}){const v=t,a=s;o({showEditPaiement:d,showEditDossier:c});const i=F(()=>ra(v.dossier.Dossier,x.isFondsSoutien?Ul.FondSoutien:Ul.Backoffice)),m=D(!1),n=D(!1);function c(){n.value=!0}const u=D(null),r=D(null);function d(S){r.value=S}const p="ACVE",k=D(!1);async function I(){await dl(v.dossier.EspacepersoURL),x.showMessage("Lien vers l'espace personnel copié.")}async function C(){await dl(v.dossier.VirementCode),x.showMessage("Identifiant de virement copié.")}async function _(S){await dl(S),x.showMessage("IBAN copié.")}const P=D(!1),j=D(!1),K=D("");return(S,y)=>{const ee=ha,be=sl,W=il;return b(),w(O,{title:`Dossier de ${v.dossier.Dossier.Responsable}`,class:"ml-2"},{subtitle:l(()=>[(b(!0),z(le,null,ce(v.dossier.Dossier.Participants,A=>(b(),z("span",tu,[N("a",{href:"/camps",onClick:tl(te=>U(Dl)(A.Participant),["prevent"])},M(U(he).label(A.Personne)),9,au)]))),256))]),append:l(()=>[e(L,{icon:"mdi-pencil",onClick:y[0]||(y[0]=A=>n.value=!0),class:"mx-1"}),e(Se,null,{activator:l(({props:A})=>[e(L,se(A,{icon:"mdi-dots-vertical",size:"small",class:"mx-1"}),null,16)]),default:l(()=>[e(ke,{density:"compact"},{default:l(()=>[e(Y,{"prepend-icon":"mdi-email",onClick:y[1]||(y[1]=A=>j.value=!0),title:"Envoyer un message",subtitle:"Notification par email"}),e(Y,{"prepend-icon":"mdi-invoice-send",onClick:y[2]||(y[2]=A=>a("sendFacture")),title:"Envoyer une demande de règlement",subtitle:"Notification par email"}),e(ue),e(Y,{"prepend-icon":"mdi-cash-plus",onClick:y[3]||(y[3]=A=>a("createPaiement")),title:"Ajouter un paiement"}),e(ue),e(Y,{"prepend-icon":"mdi-link",onClick:y[4]||(y[4]=A=>k.value=!0),title:"Afficher les identifiants"}),e(ue),e(Y,{"prepend-icon":"mdi-file-move",onClick:y[5]||(y[5]=A=>P.value=!0),title:"Fusionner vers ..."}),e(ue),e(Y,{onClick:y[6]||(y[6]=A=>m.value=!0),title:"Supprimer"},{prepend:l(()=>[e(pe,{color:"red"},{default:l(()=>[...y[35]||(y[35]=[f("mdi-delete",-1)])]),_:1})]),_:1})]),_:1})]),_:1})]),default:l(()=>[e(B,null,{default:l(()=>[e(T,null,{default:l(()=>[e(V,{class:"ml-2 mb-1 text-center"},{default:l(()=>[e(Se,null,{activator:l(({props:A})=>[e(ye,se(A,{"prepend-icon":"mdi-currency-eur",color:U(_e).colorStatutPaiement(v.dossier.Dossier.Bilan.Statut)}),{default:l(()=>[f(M(v.dossier.Dossier.Bilan.Recu)+" payé sur "+M(v.dossier.Dossier.Bilan.Demande),1)]),_:1},16,["color"])]),default:l(()=>[e(In,{dossier:v.dossier.Dossier},null,8,["dossier"])]),_:1})]),_:1})]),_:1}),N("div",nu,[e(Na,{side:"end",class:"mt-4",density:"compact"},{default:l(()=>[(b(!0),z(le,null,ce(i.value,(A,te)=>(b(),w(ee,{event:A,key:te,onEditPaiement:y[7]||(y[7]=ne=>r.value=ne),onDeleteMessage:y[8]||(y[8]=ne=>a("deleteMessage",ne))},null,8,["event"]))),128))]),_:1})])]),_:1}),e(Z,{modelValue:m.value,"onUpdate:modelValue":y[10]||(y[10]=A=>m.value=A),"max-width":"600px"},{default:l(()=>[e(O,{title:"Supprimer le dossier"},{default:l(()=>[e(B,null,{default:l(()=>[...y[36]||(y[36]=[f(" Confirmez-vous la suppression du dossier et de ses participants ? ",-1),N("br",null,null,-1),N("br",null,null,-1),f(" Attention, cette opération est irréversible. ",-1)])]),_:1}),e(oe,null,{default:l(()=>[e(ie),e(L,{color:"red",onClick:y[9]||(y[9]=A=>{a("deleteDossier"),m.value=!1})},{default:l(()=>[...y[37]||(y[37]=[f("Supprimer",-1)])]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"]),u.value!=null?(b(),w(Z,{key:0,"model-value":u.value!=null,"onUpdate:modelValue":y[14]||(y[14]=A=>u.value=null),"max-width":"600px"},{default:l(()=>[e(O,{title:"Ajouter un participant"},{default:l(()=>[e(B,null,{default:l(()=>[e(T,null,{default:l(()=>[e(V,{cols:"12"},{default:l(()=>[e(be,{label:"Camp",camps:v.camps,modelValue:u.value.IdCamp,"onUpdate:modelValue":y[11]||(y[11]=A=>u.value.IdCamp=A)},null,8,["camps","modelValue"])]),_:1}),e(V,{cols:"12"},{default:l(()=>[e(W,{label:"Personne","initial-personne":"",modelValue:u.value.IdPersonne,"onUpdate:modelValue":y[12]||(y[12]=A=>u.value.IdPersonne=A),api:{SelectPersonne:U(x).SelectPersonne.bind(U(x))}},null,8,["modelValue","api"])]),_:1})]),_:1})]),_:1}),e(oe,null,{default:l(()=>[e(ie),e(L,{color:"green",disabled:u.value.IdPersonne==0||u.value.IdCamp==0,onClick:y[13]||(y[13]=A=>{a("createParticipant",u.value),u.value=null})},{default:l(()=>[...y[38]||(y[38]=[f("Ajouter",-1)])]),_:1},8,["disabled"])]),_:1})]),_:1})]),_:1},8,["model-value"])):Q("",!0),e(Z,{modelValue:n.value,"onUpdate:modelValue":y[25]||(y[25]=A=>n.value=A)},{default:l(()=>[e(lu,{dossier:v.dossier,camps:v.camps,onUpdateDossier:y[15]||(y[15]=A=>a("updateDossier",A)),onCreateParticipant:y[16]||(y[16]=A=>a("createParticipant",A)),onUpdateParticipant:y[17]||(y[17]=A=>a("updateParticipant",A)),onDeleteParticipant:y[18]||(y[18]=A=>a("deleteParticipant",A)),onExpandParticipant:y[19]||(y[19]=A=>a("expandParticipant",A)),onCreateAide:y[20]||(y[20]=A=>a("createAide",A)),onUpdateAide:y[21]||(y[21]=A=>a("updateAide",A)),onDeleteAide:y[22]||(y[22]=A=>a("deleteAide",A)),onDeleteFileAide:y[23]||(y[23]=A=>a("deleteFileAide",A)),onUploadFileAide:y[24]||(y[24]=(A,te)=>a("uploadFileAide",A,te))},null,8,["dossier","camps"])]),_:1},8,["modelValue"]),r.value!=null?(b(),w(Z,{key:1,"model-value":r.value!=null,"onUpdate:modelValue":y[28]||(y[28]=A=>r.value=null),"max-width":"600px"},{default:l(()=>[e(Nn,{paiement:r.value,onUpdate:y[26]||(y[26]=A=>{a("updatePaiement",A),r.value=null}),onDelete:y[27]||(y[27]=A=>{a("deletePaiement",r.value),r.value=null})},null,8,["paiement"])]),_:1},8,["model-value"])):Q("",!0),e(Z,{modelValue:k.value,"onUpdate:modelValue":y[29]||(y[29]=A=>k.value=A),"max-width":"800px"},{default:l(()=>[e(O,{title:"Liens et identifiants"},{default:l(()=>[e(B,null,{default:l(()=>[e(T,null,{default:l(()=>[e(V,{cols:"3"},{default:l(()=>[...y[39]||(y[39]=[f("Espace personnel",-1)])]),_:1}),e(V,{class:"text-truncate"},{default:l(()=>[N("a",{href:v.dossier.EspacepersoURL,target:"_blank"},M(v.dossier.EspacepersoURL),9,uu)]),_:1}),e(V,{"align-self":"center",cols:"auto"},{default:l(()=>[e(L,{size:"small",icon:"mdi-content-copy",onClick:I})]),_:1})]),_:1}),(b(!0),z(le,null,ce(v.dossier.BankAccounts,A=>(b(),w(T,null,{default:l(()=>[e(V,{cols:"3"},{default:l(()=>[f("RIB ("+M(U(p))+")",1)]),_:1}),e(V,{cols:"3"},{default:l(()=>[f(M(A[0]),1)]),_:2},1024),e(V,null,{default:l(()=>[f(M(A[1]),1)]),_:2},1024),e(V,{"align-self":"center",cols:"auto"},{default:l(()=>[e(L,{size:"small",icon:"mdi-content-copy",onClick:()=>_(A[1])},null,8,["onClick"])]),_:2},1024)]),_:2},1024))),256)),e(T,null,{default:l(()=>[e(V,{cols:"3"},{default:l(()=>[...y[40]||(y[40]=[f("Identification de virement",-1)])]),_:1}),e(V,null,{default:l(()=>[f(M(v.dossier.VirementCode),1)]),_:1}),e(V,{"align-self":"center",cols:"auto"},{default:l(()=>[e(L,{size:"small",icon:"mdi-content-copy",onClick:C})]),_:1})]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"]),e(Z,{modelValue:P.value,"onUpdate:modelValue":y[31]||(y[31]=A=>P.value=A),"max-width":"600px"},{default:l(()=>[e(gt,{from:v.dossier.Dossier.Dossier.Id,onMerge:y[30]||(y[30]=A=>{a("mergeDossier",A),P.value=!1})},null,8,["from"])]),_:1},8,["modelValue"]),e(Z,{modelValue:j.value,"onUpdate:modelValue":y[34]||(y[34]=A=>j.value=A),"max-width":"600px"},{default:l(()=>[e(O,{title:"Nouveau message",subtitle:"Envoie un message sur le fil de suivi et une notification par mail."},{default:l(()=>[e(B,null,{default:l(()=>[e(T,null,{default:l(()=>[e(V,null,{default:l(()=>[e(vl,{rows:"5",variant:"outlined",modelValue:K.value,"onUpdate:modelValue":y[32]||(y[32]=A=>K.value=A)},null,8,["modelValue"])]),_:1})]),_:1})]),_:1}),e(oe,null,{default:l(()=>[e(ie),e(L,{disabled:!K.value.length,onClickOnce:y[33]||(y[33]=A=>{a("sendMessage",K.value),j.value=!1})},{default:l(()=>[...y[41]||(y[41]=[f("Envoyer",-1)])]),_:1},8,["disabled"])]),_:1})]),_:1})]),_:1},8,["modelValue"])]),_:1},8,["title"])}}}),su=G({__name:"CreateDossierCard",emits:["create"],setup(t,{emit:o}){const s=o,v=D(0);return(a,i)=>{const m=il;return b(),w(O,{title:"Créer un dossier"},{default:l(()=>[e(B,null,{default:l(()=>[e(T,null,{default:l(()=>[e(V,null,{default:l(()=>[e(m,{label:"Responsable légal",modelValue:v.value,"onUpdate:modelValue":i[0]||(i[0]=n=>v.value=n),"initial-personne":"",api:{SelectPersonne:U(x).SelectPersonne.bind(U(x))}},null,8,["modelValue","api"])]),_:1})]),_:1})]),_:1}),e(oe,null,{default:l(()=>[e(ie),e(L,{color:"green",disabled:v.value==0,onClick:i[1]||(i[1]=n=>s("create",v.value))},{default:l(()=>[...i[2]||(i[2]=[f("Créer",-1)])]),_:1},8,["disabled"])]),_:1})]),_:1})}}}),ou=G({__name:"DossierList",props:De({camps:{},allowFondsSoutien:{type:Boolean},selected:{}},{query:{required:!0},queryModifiers:{}}),emits:De(["click","update"],["update:query"]),setup(t,{expose:o,emit:s}){const v=t,a=s,i=Pe(t,"query");o({searchDossiers:n}),Ae(()=>i.value,n,{immediate:!0});const m=D(null);async function n(){const c=await x.DossiersSearch(i.value);c!==void 0&&(m.value=c,a("update",c))}return(c,u)=>{const r=sl,d=it;return b(),z("div",null,[e(T,null,{default:l(()=>[e(V,{"align-self":"center"},{default:l(()=>[e(d,{density:"compact",variant:"outlined","prepend-inner-icon":"mdi-magnify",label:"Rechercher un dossier","hide-details":"",clearable:"",modelValue:i.value.Pattern,"onUpdate:modelValue":[u[5]||(u[5]=p=>i.value.Pattern=p),n]},{"append-inner":l(()=>[i.value.IdCamp.Valid?(b(),w(ye,{key:0,class:"ml-1",size:"small","prepend-icon":"mdi-bed"},{default:l(()=>[f(M(v.camps.find(p=>p.Id==i.value.IdCamp.Id)?.Label),1)]),_:1})):Q("",!0),i.value.Attente!=U(pa).EmptyQA?(b(),w(ye,{key:1,class:"ml-1",size:"small","prepend-icon":"mdi-clock"},{default:l(()=>[f(M(U(Rl)[i.value.Attente]),1)]),_:1})):Q("",!0),i.value.Reglement!=U(fa).EmptyQR?(b(),w(ye,{key:2,class:"ml-1",size:"small","prepend-icon":"mdi-currency-eur"},{default:l(()=>[f(M(U(Fl)[i.value.Reglement]),1)]),_:1})):Q("",!0),i.value.OnlyFondSoutien?(b(),w(ye,{key:3,class:"ml-1",size:"small"},{default:l(()=>[...u[6]||(u[6]=[f(" Fonds de soutien ",-1)])]),_:1})):Q("",!0)]),append:l(()=>[e(Se,{location:"left top","close-on-content-click":!1},{activator:l(({props:p})=>[e(L,se(p,{size:"small",variant:"flat",icon:""}),{default:l(()=>[e(pe,null,{default:l(()=>[...u[7]||(u[7]=[f("mdi-filter-cog",-1)])]),_:1}),e(je,{activator:"parent",text:"Autres critères de recherche"})]),_:1},16)]),default:l(()=>[e(O,{"min-width":"400px",title:"Filtrer les dossiers"},{default:l(()=>[e(B,null,{default:l(()=>[e(T,null,{default:l(()=>[e(V,null,{default:l(()=>[e(r,{label:"Camp",camps:v.camps,"model-value":U(ca)(U(va)(i.value.IdCamp)),"onUpdate:modelValue":u[0]||(u[0]=p=>{i.value.IdCamp=U(da)(U(ma)(p)),n()})},null,8,["camps","model-value"])]),_:1})]),_:1}),e(T,null,{default:l(()=>[e(V,null,{default:l(()=>[e(Oe,{density:"compact",variant:"outlined",label:"Liste d'attente",modelValue:i.value.Attente,"onUpdate:modelValue":[u[1]||(u[1]=p=>i.value.Attente=p),n],items:U(nl)(U(Rl)),"hide-details":""},null,8,["modelValue","items"])]),_:1})]),_:1}),e(T,null,{default:l(()=>[e(V,null,{default:l(()=>[e(Oe,{density:"compact",variant:"outlined",label:"Réglement",modelValue:i.value.Reglement,"onUpdate:modelValue":[u[2]||(u[2]=p=>i.value.Reglement=p),n],items:U(nl)(U(Fl)),"hide-details":""},null,8,["modelValue","items"])]),_:1})]),_:1}),e(T,null,{default:l(()=>[e(V,null,{default:l(()=>[e(kl,{label:"Trier selon les nouveaux messages",hint:"Affiche les nouveaux messages en premier.","persistent-hint":"",density:"compact",color:"light-blue-darken-3",modelValue:i.value.SortByNewMessages,"onUpdate:modelValue":[u[3]||(u[3]=p=>i.value.SortByNewMessages=p),n]},null,8,["modelValue"])]),_:1})]),_:1}),v.allowFondsSoutien?(b(),w(T,{key:0},{default:l(()=>[e(V,null,{default:l(()=>[e(kl,{label:"Fonds de soutien",hint:"N'affiche que les dossiers demandant le fonds de soutien.","persistent-hint":"",density:"compact",color:"orange",modelValue:i.value.OnlyFondSoutien,"onUpdate:modelValue":[u[4]||(u[4]=p=>i.value.OnlyFondSoutien=p),n]},null,8,["modelValue"])]),_:1})]),_:1})):Q("",!0)]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"])]),_:1})]),_:1}),m.value!=null?(b(),w(ke,{key:0,class:"mt-2",selected:v.selected?[v.selected]:void 0},{default:l(()=>[m.value.Dossiers?.length?Q("",!0):(b(),w(Y,{key:0,class:"text-center"},{default:l(()=>[...u[8]||(u[8]=[N("i",null,"Aucun dossier ne correspond à votre recherche.",-1)])]),_:1})),(b(!0),z(le,null,ce(m.value.Dossiers,(p,k)=>(b(),w(Y,{rounded:"",key:k,title:p.Responsable,subtitle:p.Participants,value:p.Id,onClick:I=>a("click",p),class:"my-1"},fl({_:2},[p.NewMessages?{name:"append",fn:l(()=>[e(La,{color:"light-blue-darken-3",content:p.NewMessages},null,8,["content"])]),key:"0"}:void 0]),1032,["title","subtitle","value","onClick"]))),128))]),_:1},8,["selected"])):Q("",!0)])}}}),ru=G({__name:"SendDocumentsCampCard",props:{camps:{}},emits:["send"],setup(t,{emit:o}){const s=t,v=o,a=D(0),i=D(null);async function m(){const u=await x.EventsSendDocumentsCampPreview({idCamp:a.value});u!==void 0&&(i.value=u,n.value=(u.Dossiers||[]).filter(r=>!r.DocumentsSent).map(r=>r.Id))}const n=D([]),c=F(()=>n.value.length==(i.value?.Dossiers||[]).length);return(u,r)=>{const d=sl;return b(),w(O,{title:"Envoyer les documents d'un séjour"},{default:l(()=>[e(B,null,{default:l(()=>[e(T,null,{default:l(()=>[e(V,{"align-self":"center",cols:"5"},{default:l(()=>[e(d,{camps:s.camps,label:"Séjour",modelValue:a.value,"onUpdate:modelValue":[r[0]||(r[0]=p=>a.value=p),m]},null,8,["camps","modelValue"])]),_:1}),e(V,{"align-self":"center"},{default:l(()=>[i.value?(b(),w(O,{key:0,subtitle:"Dossiers à contacter"},fl({default:l(()=>[e(B,null,{default:l(()=>[e(ke,{selectable:"",selected:n.value,"onUpdate:selected":r[2]||(r[2]=p=>n.value=p),"select-strategy":"leaf"},{default:l(()=>[(b(!0),z(le,null,ce(i.value.Dossiers,p=>(b(),w(Y,{title:p.Responsable,subtitle:p.Participants,value:p.Id,rounded:"",class:"my-1"},{append:l(({isSelected:k,select:I})=>[e(T,null,{default:l(()=>[e(V,null,{default:l(()=>[p.DocumentsSent?(b(),w(ye,{key:0,color:"green",class:"mr-2"},{default:l(()=>[...r[4]||(r[4]=[f("Envoyés",-1)])]),_:1})):Q("",!0)]),_:2},1024),e(V,null,{default:l(()=>[e(rt,{density:"compact","hide-details":"","model-value":k,"onUpdate:modelValue":I},null,8,["model-value","onUpdate:modelValue"])]),_:2},1024)]),_:2},1024)]),_:2},1032,["title","subtitle","value"]))),256))]),_:1},8,["selected"])]),_:1})]),_:2},[i.value.Dossiers?.length?{name:"append",fn:l(()=>[e(ze,{label:"Tout sélectionner",density:"compact","hide-details":"",indeterminate:!!n.value.length&&n.value.length!=(i.value.Dossiers||[]).length,"model-value":n.value.length==(i.value.Dossiers||[]).length,"onUpdate:modelValue":r[1]||(r[1]=p=>n.value=c.value?[]:(i.value.Dossiers||[]).map(k=>k.Id))},null,8,["indeterminate","model-value"])]),key:"0"}:void 0]),1024)):Q("",!0)]),_:1})]),_:1})]),_:1}),e(oe,null,{default:l(()=>[e(ie),e(L,{disabled:!a.value||!n.value.length,onClick:r[3]||(r[3]=p=>v("send",a.value,n.value))},{append:l(()=>[e(pe,null,{default:l(()=>[...r[5]||(r[5]=[f("mdi-send",-1)])]),_:1})]),default:l(()=>[r[6]||(r[6]=f(" Envoyer ",-1))]),_:1},8,["disabled"])]),_:1})]),_:1})}}}),du=G({__name:"SendRelancePaiementCard",props:{camps:{}},emits:["send"],setup(t,{emit:o}){const s=t,v=o,a=D(0),i=D([]);async function m(){const u=await x.EventsSendRelancePaiementPreview({idCamp:a.value});u!==void 0&&(i.value=u||[],n.value=(u||[]).map(r=>r.Id))}const n=D([]),c=F(()=>n.value.length==i.value.length);return(u,r)=>{const d=sl;return b(),w(O,{title:"Envoyer une relance de paiement"},{default:l(()=>[e(B,null,{default:l(()=>[e(T,null,{default:l(()=>[e(V,{"align-self":"center",cols:"5"},{default:l(()=>[e(d,{camps:s.camps,label:"Séjour",modelValue:a.value,"onUpdate:modelValue":[r[0]||(r[0]=p=>a.value=p),m]},null,8,["camps","modelValue"])]),_:1}),e(V,{"align-self":"center"},{default:l(()=>[i.value?(b(),w(O,{key:0,subtitle:"Dossiers à relancer"},fl({default:l(()=>[e(B,null,{default:l(()=>[e(ke,{selectable:"",selected:n.value,"onUpdate:selected":r[2]||(r[2]=p=>n.value=p),"select-strategy":"leaf",density:"comfortable"},{default:l(()=>[(b(!0),z(le,null,ce(i.value,(p,k)=>(b(),w(Y,{key:p.Id,title:p.Responsable,subtitle:U(ya)(p.LastEventFacture)?"":`Dernière demande : ${U(_e).time(p.LastEventFacture)}`,value:p.Id,rounded:"",class:"my-1"},{append:l(({isSelected:I,select:C})=>[e(T,null,{default:l(()=>[e(V,{"align-self":"center"},{default:l(()=>[e(ye,{class:"mr-2",color:U(_e).colorStatutPaiement(p.Bilan.Statut)},{default:l(()=>[f(M(p.Bilan.Recu)+" / "+M(p.Bilan.Demande),1)]),_:2},1032,["color"])]),_:2},1024),e(V,{"align-self":"center"},{default:l(()=>[e(rt,{density:"compact","hide-details":"","model-value":I,"onUpdate:modelValue":C},null,8,["model-value","onUpdate:modelValue"])]),_:2},1024)]),_:2},1024)]),_:2},1032,["title","subtitle","value"]))),128))]),_:1},8,["selected"])]),_:1})]),_:2},[i.value.length?{name:"append",fn:l(()=>[e(ze,{label:"Tout sélectionner",density:"compact","hide-details":"",indeterminate:!!n.value.length&&n.value.length!=i.value.length,"model-value":n.value.length==i.value.length,"onUpdate:modelValue":r[1]||(r[1]=p=>n.value=c.value?[]:i.value.map(k=>k.Id))},null,8,["indeterminate","model-value"])]),key:"0"}:void 0]),1024)):Q("",!0)]),_:1})]),_:1})]),_:1}),e(oe,null,{default:l(()=>[e(ie),e(L,{disabled:!a.value||!n.value.length,onClick:r[3]||(r[3]=p=>v("send",a.value,n.value))},{append:l(()=>[e(pe,null,{default:l(()=>[...r[4]||(r[4]=[f("mdi-send",-1)])]),_:1})]),default:l(()=>[r[5]||(r[5]=f(" Envoyer ",-1))]),_:1},8,["disabled"])]),_:1})]),_:1})}}}),mu=G({__name:"RemisesHintsCard",props:{allCamps:{}},setup(t){const o=t;Ee(()=>{a.value=o.allCamps.filter(u=>!u.IsOld).map(u=>u.Id),m()});const s=D([]),v=D(!1),a=D([]),i=D(null);async function m(){const u=await x.DossiersRemisesHint({IdCamps:a.value});u!==void 0&&(i.value=u||[])}const n=D([]);async function c(){const u=i.value;if(!n.value.length||!u)return;const r=n.value.map(p=>u[p]),d=await x.DossiersApplyRemisesHints(r);n.value=[],d!==void 0&&(x.showMessage("Remises appliquées avec succès."),m())}return(u,r)=>(b(),w(O,{title:"Estimer les remises",subtitle:"Seules les nouvelles remises sont affichées."},{append:l(()=>[e(L,{onClick:r[0]||(r[0]=d=>{s.value=a.value,v.value=!0})},{prepend:l(()=>[e(pe,null,{default:l(()=>[...r[5]||(r[5]=[f("mdi-cog",-1)])]),_:1})]),default:l(()=>[r[6]||(r[6]=f(" Séjours ",-1))]),_:1}),e(ue,{vertical:"",thickness:"1",class:"mx-2"}),e(L,{disabled:!n.value.length,onClick:c},{default:l(()=>[...r[7]||(r[7]=[f("Appliquer les remises",-1)])]),_:1},8,["disabled"])]),default:l(()=>[e(B,null,{default:l(()=>[i.value==null?(b(),w(We,{key:0})):(b(),w(ke,{key:1,"select-strategy":"leaf",selected:n.value,"onUpdate:selected":r[1]||(r[1]=d=>n.value=d),color:"primary"},{default:l(()=>[i.value.length?Q("",!0):(b(),w(Y,{key:0,class:"font-italic"},{default:l(()=>[...r[8]||(r[8]=[f(" Aucune nouvelle remise à appliquer. ",-1)])]),_:1})),(b(!0),z(le,null,ce(i.value,(d,p)=>(b(),w(Y,{title:d.Personne,subtitle:d.Camp,value:p,rounded:"",class:"my-1"},{append:l(()=>[e(T,{style:{width:"200px"}},{default:l(()=>[e(V,{cols:"6"},{default:l(()=>[d.Hint.ReducInscrits?(b(),w(ye,{key:0,"prepend-icon":"mdi-account-multiple",class:"mx-1",elevation:"1"},{default:l(()=>[f(M(d.Hint.ReducInscrits)+" % ",1),e(je,{activator:"parent","content-class":"ma-0 pa-0"},{default:l(()=>[e(O,{subtitle:"Autres inscrits de la même famille"},{default:l(()=>[e(B,null,{default:l(()=>[(b(!0),z(le,null,ce(d.AutresInscrits,k=>(b(),w(ye,{class:"mx-1"},{default:l(()=>[f(M(k.Personne)+" ("+M(k.Camp)+")",1)]),_:2},1024))),256))]),_:2},1024)]),_:2},1024)]),_:2},1024)]),_:2},1024)):Q("",!0)]),_:2},1024),e(V,{cols:"6"},{default:l(()=>[d.Hint.ReducEquipiers?(b(),w(ye,{key:0,"prepend-icon":"mdi-account-hard-hat",class:"mx-1",elevation:"1"},{default:l(()=>[f(M(d.Hint.ReducEquipiers)+" % ",1),e(je,{activator:"parent","content-class":"ma-0 pa-0"},{default:l(()=>[e(O,{subtitle:"Equipiers de la même famille"},{default:l(()=>[e(B,null,{default:l(()=>[(b(!0),z(le,null,ce(d.Equipiers,k=>(b(),w(ye,{class:"mx-1"},{default:l(()=>[f(M(k.Personne)+" ("+M(k.Camp)+")",1)]),_:2},1024))),256))]),_:2},1024)]),_:2},1024)]),_:2},1024)]),_:2},1024)):Q("",!0)]),_:2},1024)]),_:2},1024)]),_:2},1032,["title","subtitle","value"]))),256))]),_:1},8,["selected"]))]),_:1}),e(Z,{modelValue:v.value,"onUpdate:modelValue":r[4]||(r[4]=d=>v.value=d),"max-width":"600px"},{default:l(()=>[e(O,{title:"Choix des séjours"},{default:l(()=>[e(B,null,{default:l(()=>[e(bt,{"all-camps":o.allCamps,modelValue:s.value,"onUpdate:modelValue":r[2]||(r[2]=d=>s.value=d)},null,8,["all-camps","modelValue"])]),_:1}),e(oe,null,{default:l(()=>[e(ie),e(L,{onClick:r[3]||(r[3]=d=>{a.value=s.value,v.value=!1,m()})},{default:l(()=>[...r[9]||(r[9]=[f("Appliquer",-1)])]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"])]),_:1}))}}),cu={key:1,class:"text-center font-italic my-6"},vu=G({__name:"PannelDossiers",props:{initialDossier:{}},setup(t){const o=t;Ee(()=>{m(),o.initialDossier!==void 0&&r(o.initialDossier)}),Ae(()=>o.initialDossier,()=>{o.initialDossier!==void 0&&r(o.initialDossier)});const s=Ll("detailsPannel"),v=D(null),a=D(Ua()),i=D([]);async function m(){const E=await x.GetCamps();E!==void 0&&(i.value=E||[])}function n(E){v.value={length:E.Dossiers?.length||0,total:E.Total}}const c=Ll("dossierList");function u(){c.value?.searchDossiers()}async function r(E){await p(E),a.value=Ra(E)}const d=D(null);async function p(E){const H=await x.DossiersLoad({id:E});H!==void 0&&(d.value=H)}async function k(E){p(E.Id),await x.EventsMarkMessagesSeen({idDossier:E.Id})!==void 0&&u()}async function I(){d.value!=null&&p(d.value.Dossier.Dossier.Id)}const C=D(!1);async function _(E){C.value=!1;const H=await x.DossiersCreate({idResponsable:E});H!==void 0&&(x.showMessage("Dossier créé avec succès."),await r(H.Id),s.value?.showEditDossier())}async function P(E){const H=await x.DossiersUpdate(E);H!==void 0&&(x.showMessage("Dossier mis à jour avec succès."),d.value!=null&&(d.value.Dossier.Dossier=E,d.value.Dossier.Responsable=H.Responsable),u())}async function j(){if(d.value==null)return;const E=d.value.Dossier.Dossier.Id;await x.DossiersDelete({id:E})!==void 0&&(x.showMessage("Dossier supprimé avec succès."),d.value=null,u())}async function K(E){await x.DossiersMerge(E)!==void 0&&(x.showMessage("Dossier fusionné avec succès."),u(),p(E.To))}async function S(E){await x.ParticipantsCreate(E)!==void 0&&(x.showMessage("Participant ajouté avec succès."),I())}async function y(E){await x.ParticipantsUpdate(E)!==void 0&&(x.showMessage("Réglages du participant modifiés avec succès."),I())}async function ee(E){await x.ParticipantsDelete({id:E})!==void 0&&(x.showMessage("Participant supprimé avec succès."),I())}async function be(E){if(d.value==null)return;const H=d.value.Dossier.Participants?.map(ve=>ve.Participant).filter(ve=>ve.Id!=E.Id)||[];!H.length||(H.forEach(ve=>{ve.Remises=E.Remises,ve.QuotientFamilial=E.QuotientFamilial,ve.IdCamp==E.IdCamp&&(ve.OptionPrix=E.OptionPrix)}),(await Promise.all(H.map(ve=>x.ParticipantsUpdate(ve)))).includes(void 0))||(x.showMessage("Réglages des participants modifiés avec succès."),I())}async function W(E){const H=await x.AidesCreate(E);if(H===void 0||(x.showMessage("Aide ajoutée avec succès."),d.value==null))return;const de=d.value.Dossier.Aides||{},ve=de[E.IdParticipant]||{};ve[H.Id]=H,de[E.IdParticipant]=ve,d.value.Dossier.Aides=de}async function A(E){await x.AidesUpdate(E)!==void 0&&(x.showMessage("Aide modifiée avec succès."),I())}async function te(E){await x.AidesJustificatifDelete({idAide:E})!==void 0&&(x.showMessage("Justificatif supprimé avec succès."),d.value!=null&&d.value.Dossier.AidesFiles&&delete d.value.Dossier.AidesFiles[E])}async function ne(E,H){const de=await x.AidesJustificatifUpload(E,{idAide:H});if(de!==void 0&&(x.showMessage("Justificatif téléversé avec succès."),d.value!=null)){const ve=d.value.Dossier.AidesFiles||{};ve[H]=de,d.value.Dossier.AidesFiles=ve}}async function h(E){await x.AidesDelete({id:E})!==void 0&&(x.showMessage("Aide supprimée avec succès."),I())}async function q(){if(d.value==null)return;const E=await x.PaiementsCreate({idDossier:d.value.Dossier.Dossier.Id});E!==void 0&&(x.showMessage("Paiement créé avec succès."),I(),s.value?.showEditPaiement(E))}async function re(E){await x.PaiementsUpdate(E)!==void 0&&(x.showMessage("Paiement modifié avec succès."),I())}async function X(E){await x.PaiementsDelete({id:E.Id})!==void 0&&(x.showMessage("Paiement supprimé avec succès."),I())}async function ge(E){d.value==null||await x.EventsSendMessage({IdDossier:d.value.Dossier.Dossier.Id,Contenu:E})===void 0||(x.showMessage("Message envoyé avec succès."),I())}async function Ve(E){await x.EventsDelete({id:E.Id})!==void 0&&(x.showMessage("Message supprimé avec succès."),I())}async function J(){d.value==null||await x.EventsSendFacture({idDossier:d.value.Dossier.Dossier.Id})===void 0||(x.showMessage("Demande de règlement envoyé avec succès."),I())}const g=D(!1),$=D(null);async function R(E,H){$.value={Current:0,Total:H.length};const de=await x.EventsSendDocumentsCamp({IdCamp:E,IdDossiers:H});if(de===void 0){$.value=null;return}await Vl(de,ve=>$.value=ve,ve=>x.onError("Envoi des documents",ve)),$.value=null,I(),x.showMessage("Documents du séjour envoyés avec succès.")}const fe=D(!1),ae=D(null);async function Me(E,H){ae.value={Current:0,Total:H.length};const de=await x.EventsSendRelancePaiement({IdDossiers:H});if(de===void 0){ae.value=null;return}await Vl(de,ve=>ae.value=ve,ve=>x.onError("Envoi de la relance",ve)),ae.value=null,I(),x.showMessage("Toutes les relances ont été envoyées avec succès.")}const $e=D(!1);return(E,H)=>(b(),w(T,{"no-gutters":"",class:"ma-2"},{default:l(()=>[e(V,{cols:"6"},{default:l(()=>[e(O,{title:"Dossiers",subtitle:v.value==null?"-":`${v.value.length} affiché(s) / ${v.value.total}`},{append:l(()=>[e(L,{icon:"",size:"small",onClick:H[0]||(H[0]=de=>C.value=!0)},{default:l(()=>[e(pe,{color:"green"},{default:l(()=>[...H[9]||(H[9]=[f("mdi-plus",-1)])]),_:1})]),_:1}),e(ue,{thickness:"1",vertical:"",class:"mx-2"}),e(L,{size:"small"},{prepend:l(()=>[e(pe,null,{default:l(()=>[...H[10]||(H[10]=[f("mdi-send-circle-outline",-1)])]),_:1})]),default:l(()=>[H[11]||(H[11]=f(" Actions ",-1)),e(Se,{activator:"parent"},{default:l(()=>[e(ke,{density:"compact"},{default:l(()=>[e(Y,{title:"Estimation des remises","prepend-icon":"mdi-finance",onClick:H[1]||(H[1]=de=>$e.value=!0)}),e(ue),e(Y,{title:"Documents...",subtitle:"Paramétrer et envoyer les documents d'un séjour","prepend-icon":"mdi-mail",onClick:H[2]||(H[2]=de=>g.value=!0)}),e(ue),e(Y,{title:"Relance de paiement...",subtitle:"Paramétrer et envoyer une relance, pour un séjour","prepend-icon":"mdi-invoice-send",onClick:H[3]||(H[3]=de=>fe.value=!0)})]),_:1})]),_:1})]),_:1})]),default:l(()=>[e(B,null,{default:l(()=>[e(ou,{camps:i.value,"allow-fonds-soutien":U(x).isFondsSoutien,selected:d.value?.Dossier.Dossier.Id,query:a.value,"onUpdate:query":H[4]||(H[4]=de=>a.value=de),onClick:k,onUpdate:n,ref_key:"dossierList",ref:c},null,8,["camps","allow-fonds-soutien","selected","query"])]),_:1})]),_:1},8,["subtitle"])]),_:1}),e(V,{cols:"6"},{default:l(()=>[d.value!=null?(b(),w(iu,{key:0,dossier:d.value,camps:i.value,onUpdateDossier:P,onDeleteDossier:j,onMergeDossier:K,onCreateParticipant:S,onUpdateParticipant:y,onDeleteParticipant:ee,onExpandParticipant:be,onCreateAide:W,onDeleteAide:h,onUpdateAide:A,onDeleteFileAide:te,onUploadFileAide:ne,onCreatePaiement:q,onUpdatePaiement:re,onDeletePaiement:X,onSendMessage:ge,onDeleteMessage:Ve,onSendFacture:J,ref_key:"detailsPannel",ref:s},null,8,["dossier","camps"])):(b(),z("div",cu," Sélectionner un dossier... "))]),_:1}),e(Z,{modelValue:C.value,"onUpdate:modelValue":H[5]||(H[5]=de=>C.value=de),"max-width":"400px"},{default:l(()=>[e(su,{onCreate:_})]),_:1},8,["modelValue"]),e(Z,{modelValue:g.value,"onUpdate:modelValue":H[6]||(H[6]=de=>g.value=de),"max-width":"1000px"},{default:l(()=>[e(ru,{camps:i.value,onSend:R},null,8,["camps"])]),_:1},8,["modelValue"]),e(Z,{modelValue:fe.value,"onUpdate:modelValue":H[7]||(H[7]=de=>fe.value=de),"max-width":"1000px"},{default:l(()=>[e(du,{camps:i.value,onSend:Me},null,8,["camps"])]),_:1},8,["modelValue"]),e(Z,{"model-value":$.value!=null,"max-width":"400px",persistent:""},{default:l(()=>[$.value?(b(),w(Cl,{key:0,title:"Envoi des documents en cours",current:$.value.Current,total:$.value.Total},null,8,["current","total"])):Q("",!0)]),_:1},8,["model-value"]),e(Z,{"model-value":ae.value!=null,"max-width":"400px",persistent:""},{default:l(()=>[ae.value?(b(),w(Cl,{key:0,title:"Envoi des relances en cours",current:ae.value.Current,total:ae.value.Total},null,8,["current","total"])):Q("",!0)]),_:1},8,["model-value"]),e(Z,{modelValue:$e.value,"onUpdate:modelValue":H[8]||(H[8]=de=>$e.value=de),"max-width":"800px"},{default:l(()=>[e(mu,{"all-camps":i.value},null,8,["all-camps"])]),_:1},8,["modelValue"])]),_:1}))}}),pu=G({__name:"inscriptions",setup(t){const o=ul(),s=F(()=>ku(o.currentRoute.value.query)),v=F(()=>s.value.tab||"insc"),a=F(()=>s.value.idDossier);function i(m){const n=o.currentRoute.value;o.push({path:n.path,query:{tab:m}})}return(m,n)=>(b(),z(le,null,[e(yl,{title:"Suivi des inscriptions"},{default:l(()=>[e(Ea,{"model-value":v.value,"onUpdate:modelValue":n[0]||(n[0]=c=>i(c))},{default:l(()=>[e(hl,{value:"insc"},{default:l(()=>[...n[2]||(n[2]=[f("Inscriptions en attente",-1)])]),_:1}),e(hl,{value:"doss"},{default:l(()=>[...n[3]||(n[3]=[f("Suivi des dossiers",-1)])]),_:1})]),_:1},8,["model-value"])]),_:1}),e(Ta,{"model-value":v.value},{default:l(()=>[e(Ol,{value:"insc"},{default:l(()=>[e(Pn,{onGoTo:U(_l),onEmpty:n[1]||(n[1]=c=>U(_l)())},null,8,["onGoTo"])]),_:1}),e(Ol,{value:"doss"},{default:l(()=>[e(vu,{"initial-dossier":a.value},null,8,["initial-dossier"])]),_:1})]),_:1},8,["model-value"])],64))}}),fu=G({__name:"PersonneEdit",props:{personne:{}},emits:["save"],setup(t,{emit:o}){const s=t,v=o,a=D(we(s.personne)),i=F(()=>!!(a.value.Nom&&a.value.Prenom));return(m,n)=>{const c=Oa,u=Ba,r=Ya,d=Ha,p=ja;return b(),w(O,{title:"Editer le profil"},{default:l(()=>[e(B,null,{default:l(()=>[e(za,null,{default:l(()=>[e(T,null,{default:l(()=>[e(V,null,{default:l(()=>[e(me,{autofocus:"","hide-details":"",label:"Nom",density:"compact",variant:"outlined",modelValue:a.value.Nom,"onUpdate:modelValue":n[0]||(n[0]=k=>a.value.Nom=k)},null,8,["modelValue"])]),_:1}),e(V,null,{default:l(()=>[e(me,{"hide-details":"",label:"Prénom",density:"compact",variant:"outlined",modelValue:a.value.Prenom,"onUpdate:modelValue":n[1]||(n[1]=k=>a.value.Prenom=k)},null,8,["modelValue"])]),_:1}),e(V,{cols:"3"},{default:l(()=>[e(c,{modelValue:a.value.Sexe,"onUpdate:modelValue":n[2]||(n[2]=k=>a.value.Sexe=k)},null,8,["modelValue"])]),_:1})]),_:1}),e(T,null,{default:l(()=>[e(V,null,{default:l(()=>[e(u,{modelValue:a.value.DateNaissance,"onUpdate:modelValue":n[3]||(n[3]=k=>a.value.DateNaissance=k)},null,8,["modelValue"])]),_:1}),e(V,null,{default:l(()=>[e(me,{"hide-details":"",label:"Ville de naissance",density:"compact",variant:"outlined",modelValue:a.value.VilleNaissance,"onUpdate:modelValue":n[4]||(n[4]=k=>a.value.VilleNaissance=k)},null,8,["modelValue"])]),_:1}),e(V,null,{default:l(()=>[e(r,{label:"Département de naissance",modelValue:a.value.DepartementNaissance,"onUpdate:modelValue":n[5]||(n[5]=k=>a.value.DepartementNaissance=k)},null,8,["modelValue"])]),_:1}),e(V,null,{default:l(()=>[e(d,{modelValue:a.value.Nationnalite,"onUpdate:modelValue":n[6]||(n[6]=k=>a.value.Nationnalite=k)},null,8,["modelValue"])]),_:1})]),_:1}),e(T,null,{default:l(()=>[e(V,null,{default:l(()=>[e(me,{"hide-details":"",label:"Adresse",density:"compact",variant:"outlined",modelValue:a.value.Adresse,"onUpdate:modelValue":n[7]||(n[7]=k=>a.value.Adresse=k)},null,8,["modelValue"])]),_:1}),e(V,null,{default:l(()=>[e(me,{"hide-details":"",label:"Code postal",density:"compact",variant:"outlined",modelValue:a.value.CodePostal,"onUpdate:modelValue":n[8]||(n[8]=k=>a.value.CodePostal=k)},null,8,["modelValue"])]),_:1}),e(V,null,{default:l(()=>[e(me,{"hide-details":"",label:"Ville",density:"compact",variant:"outlined",modelValue:a.value.Ville,"onUpdate:modelValue":n[9]||(n[9]=k=>a.value.Ville=k)},null,8,["modelValue"])]),_:1}),e(V,null,{default:l(()=>[e(p,{modelValue:a.value.Pays,"onUpdate:modelValue":n[10]||(n[10]=k=>a.value.Pays=k)},null,8,["modelValue"])]),_:1})]),_:1}),e(T,null,{default:l(()=>[e(V,null,{default:l(()=>[e(me,{"hide-details":"",label:"Mail",density:"compact",variant:"outlined",modelValue:a.value.Mail,"onUpdate:modelValue":n[11]||(n[11]=k=>a.value.Mail=k)},null,8,["modelValue"])]),_:1}),e(V,null,{default:l(()=>[e(dt,{label:"Téléphone",modelValue:a.value.Tels,"onUpdate:modelValue":n[12]||(n[12]=k=>a.value.Tels=k),formatter:U(_e).tel},null,8,["modelValue","formatter"])]),_:1})]),_:1})]),_:1})]),_:1}),e(oe,null,{default:l(()=>[e(ie),e(L,{disabled:!i.value,onClick:n[13]||(n[13]=k=>v("save",a.value))},{default:l(()=>[...n[14]||(n[14]=[f("Enregistrer",-1)])]),_:1},8,["disabled"])]),_:1})]),_:1})}}}),yu=G({__name:"annuaire",setup(t){const o=ul(),s=F(()=>Cu(o.currentRoute.value.query)),v=F(()=>s.value.idPersonne);Ae(()=>v.value,()=>v.value!==void 0?r(v.value):null,{immediate:!0});const a=D([]),i=D("");async function m(){if(!i.value)return;const d=await x.PersonnesGet({search:i.value});d!==void 0&&(a.value=d||[])}async function n(){const d=await x.PersonnesCreate();d!==void 0&&(x.showMessage("Profil créé avec succès."),a.value.push(d),Ze(d.Id))}const c=D(null);async function u(d){c.value=null;const p=await x.PersonnesUpdate(d);if(p===void 0)return;x.showMessage("Profil modifié avec succès."),Ze();const k=a.value.findIndex(I=>I.Id==d.Id);a.value[k]=p}async function r(d){const p=await x.PersonnesLoad({id:d});p!==void 0&&(c.value=p)}return(d,p)=>{const k=it;return b(),z(le,null,[e(yl,{title:"Annuaire : personnes et organismes"}),e(O,{class:"my-2 mx-auto","max-width":"600px"},{append:l(()=>[e(L,{color:"green",onClick:n},{default:l(()=>[...p[2]||(p[2]=[f("Créer un nouveau profil",-1)])]),_:1})]),default:l(()=>[e(B,null,{default:l(()=>[e(T,null,{default:l(()=>[e(V,null,{default:l(()=>[e(k,{"prepend-inner-icon":"mdi-magnify",label:"Recherche",modelValue:i.value,"onUpdate:modelValue":[p[0]||(p[0]=I=>i.value=I),m]},null,8,["modelValue"]),e(ke,null,{default:l(()=>[(b(!0),z(le,null,ce(a.value,I=>(b(),w(Y,{title:I.Label,subtitle:U(_e).dateNaissance(I.DateNaissance),"prepend-icon":U(_e).sexeIcon(I.Sexe),onClick:C=>U(Ze)(I.Id)},fl({_:2},[I.IsTemp?{name:"append",fn:l(()=>[e(ye,{"prepend-icon":"mdi-alert",color:"warning"},{default:l(()=>[...p[3]||(p[3]=[f(" Ce profil est temporaire et devrait être identifié. ",-1)])]),_:1})]),key:"0"}:void 0]),1032,["title","subtitle","prepend-icon","onClick"]))),256))]),_:1})]),_:1}),e(V)]),_:1})]),_:1}),c.value!=null?(b(),w(Z,{key:0,"model-value":c.value!=null,"onUpdate:modelValue":p[1]||(p[1]=I=>{c.value=null,U(Ze)(void 0)}),"max-width":"1000px"},{default:l(()=>[e(fu,{personne:c.value,onSave:u},null,8,["personne"])]),_:1},8,["model-value"])):Q("",!0)]),_:1})],64)}}}),bu=[{path:"/",component:Qa},{path:"/camps",component:Cn},{path:"/inscriptions",component:pu},{path:"/annuaire",component:yu}],gu="/backoffice",Xe=_a({history:xa(gu),routes:bu});Xe.onError((t,o)=>{t?.message?.includes?.("Failed to fetch dynamically imported module")?localStorage.getItem("vuetify:dynamic-reload")?console.error("Dynamic import error, reloading page did not fix it",t):(console.log("Reloading page to fix dynamic import error"),localStorage.setItem("vuetify:dynamic-reload","true"),location.assign(o.fullPath)):console.error(t)});Xe.isReady().then(()=>{localStorage.removeItem("vuetify:dynamic-reload")});function pl(t){return t?Number(t):void 0}function Vu(t){const o=t;return{idCamp:pl(o.idCamp),idParticipant:pl(o.idParticipant)}}function Dl(t){Xe.push({path:"/camps",query:{idCamp:t.IdCamp,idParticipant:t.Id}})}function ku(t){const o=t;return{tab:o.tab,idDossier:pl(o.idDossier)}}function _l(t){Xe.push({path:"/inscriptions",query:{tab:"doss",idDossier:t}})}function Cu(t){return{idPersonne:pl(t.idPersonne)}}function Ze(t){Xe.push({path:"/annuaire",query:{idPersonne:t}})}const _u=["innerHTML"],xu=G({__name:"App",setup(t){const o=gl({text:"",color:"secondary",action:void 0,timeout:4e3}),s=D(""),v=D("");return x.onError=(i,m)=>{s.value=i,v.value=m},x.showMessage=(i,m,n)=>{o.text=i,o.color=m||"success",o.action=n,o.timeout=1e4,o.timeout=4e3},ul().beforeEach(async(i,m)=>{if(!x.hasToken()&&i.path!=="/")return{path:"/"}}),(i,m)=>{const n=ba("router-view");return b(),w(Va,null,{default:l(()=>[e(ga,null,{default:l(()=>[e(n),e(Tl,{style:{"z-index":"10000"},app:"","model-value":o.text!="","onUpdate:modelValue":m[1]||(m[1]=c=>o.text=""),timeout:o.timeout,color:o.color,location:"bottom left","close-on-content-click":""},{default:l(()=>[f(M(o.text)+" ",1),o.action?(b(),w(L,{key:0,onClick:m[0]||(m[0]=c=>o.action.action()),class:"ml-2"},{default:l(()=>[f(M(o.action.title),1)]),_:1})):Q("",!0)]),_:1},8,["model-value","timeout","color"]),e(Tl,{app:"","model-value":s.value!="","onUpdate:modelValue":m[2]||(m[2]=c=>s.value=""),timeout:4e3,color:"red"},{default:l(()=>[N("b",null,M(s.value),1),N("div",{innerHTML:v.value},null,8,_u)]),_:1},8,["model-value"])]),_:1})]),_:1})}}}),kt=ka(xu);kt.use(Ca).use(Xe);kt.mount("#app");
