import{d as K,c as F,a as z,F as le,b as e,w as l,V as Ct,e as g,f as xt,g as h,h as b,i as Pt,t as M,r as wt,j as E,o as y,k as D,l as O,m as B,n as me,p as Dt,q as Je,s as L,u as oe,v as St,x as De,y as Pe,z as w,A as Le,B as Re,C as Ke,D as he,E as xl,G as ke,I as Be,H as Gl,M as Kl,J as Xl,K as al,L as It,N as Ye,O as Ue,P as rl,Q as ll,R as Fe,S as Ae,T as He,U as At,W as Ee,X as Zl,Y as se,Z as Sl,_ as Mt,$ as $t,a0 as et,a1 as Ut,a2 as Rt,a3 as U,a4 as lt,a5 as Q,a6 as ce,a7 as _e,a8 as xe,a9 as Ce,aa as nl,ab as tt,ac as Ie,ad as we,ae as Ft,af as dl,ag as Te,ah as Lt,ai as ht,aj as Tt,ak as Et,al as bl,am as Ge,an as Nt,ao as Il,ap as Ot,aq as Bt,ar as jt,as as Al,at as qt,au as Ht,av as Yt,aw as zt,ax as Qt,ay as Wt,az as Jt,aA as Gt,aB as Kt,aC as Xt,aD as Ml,aE as $l,aF as gl,aG as at,aH as Zt,aI as ea,aJ as Vl,aK as la,aL as ta,aM as Ne,aN as aa,aO as tl,aP as na,aQ as ua,aR as ia,aS as sa,aT as oa,aU as ra,aV as Ul,aW as da,aX as ma,aY as ca,aZ as va,a_ as Rl,a$ as Fl,b0 as pa,b1 as fa,b2 as pl,b3 as ya,b4 as Ll,b5 as ba,b6 as ga,b7 as hl,b8 as Va,b9 as ka,ba as _a}from"./VSnackbar-B7oLDl85.js";import{u as ul,c as Ca,a as xa}from"./vue-router-czD6-pQ5.js";import{c as x,V as Pa,a as ml,m as nt,b as kl,_ as il,d as wa,i as Tl,e as _l,f as Da,g as ut,h as Sa,j as sl,k as Ia,l as Aa,n as Ma,o as $a,p as it,q as Ua,r as Ra}from"./InscriptionRow.vue_vue_type_script_setup_true_lang-DEpo9rXc.js";import{V as H,a as ue,b as ie,c as ze,d as Se,e as Ve,f as fe,g as Oe,h as cl,i as El,j as st,k as ot,l as rt}from"./VTextarea-CZqNMGTl.js";import{_ as Xe,a as Fa,V as La,b as ha,c as Ta,d as Nl,e as Ol}from"./VTabs-Bhxgg-ES.js";import{_ as Ze,V as Ea,a as Na}from"./EventSwitch.vue_vue_type_script_setup_true_lang-DF0ZLrBd.js";import{_ as Pl}from"./_plugin-vue_export-helper-DlAUqK2U.js";import{V as Z}from"./VDialog-DrJW0tuP.js";import{V as je}from"./FileCard.vue_vue_type_script_setup_true_lang-Cc796Gse.js";import{V as Bl,_ as dt,a as Oa,b as Ba,c as ja}from"./SexeField.vue_vue_type_script_setup_true_lang-l8kBORDR.js";import{_ as qa}from"./FilesRow.vue_vue_type_script_setup_true_lang-BslE2uCY.js";import{_ as Ha}from"./NationaliteField.vue_vue_type_script_setup_true_lang-DlZl4BSa.js";import{_ as Ya}from"./DepartementField.vue_vue_type_script_setup_true_lang-BYAH3wGc.js";import{V as za}from"./VForm-BOtuACqM.js";import"./VSheet-B6IKcKc5.js";import"./VWindowItem-BpJI4m0l.js";const fl=K({__name:"NavBar",props:{title:{},hideMenu:{type:Boolean}},setup(t){const o="/static/acve/logo.png",s="v0.7.1",v=t,a=F(()=>x.isFondsSoutien);return(i,m)=>(y(),z(le,null,[e(Pa,{app:"","model-value":!v.hideMenu,"expand-on-hover":"",permanent:"",rail:""},{append:l(()=>[e(H,{"prepend-icon":"mdi-account-circle-outline",title:a.value?"Fonds de soutien":"Administrateur"},null,8,["title"]),e(H,{"prepend-icon":"mdi-logout",link:"",to:{path:"/"},color:"primary"},{default:l(()=>[...m[3]||(m[3]=[g(" Se déconnecter ",-1)])]),_:1})]),default:l(()=>[e(H,{"prepend-icon":"mdi-menu",title:`Registro ${s}`},null,8,["title"]),e(ue),e(H,{"prepend-icon":"mdi-bed",link:"",to:{path:"/camps"},color:"primary"},{default:l(()=>[...m[0]||(m[0]=[g(" Séjours ",-1)])]),_:1}),e(H,{"prepend-icon":"mdi-calendar-multiple-check",link:"",to:{path:"/inscriptions"},color:"primary"},{default:l(()=>[...m[1]||(m[1]=[g(" Inscriptions ",-1)])]),_:1}),e(ue),e(H,{"prepend-icon":"mdi-account-multiple",link:"",to:{path:"/annuaire"},color:"primary"},{default:l(()=>[...m[2]||(m[2]=[g(" Annuaire ",-1)])]),_:1}),e(ue)]),_:1},8,["model-value"]),e(Ct,{rounded:"",elevation:"4",color:"secondary"},{append:l(()=>[wt(i.$slots,"default"),m[4]||(m[4]=E("div",{class:"mr-2"},null,-1))]),default:l(()=>[e(xt,null,{default:l(()=>[e(h,null,{default:l(()=>[e(b,{"align-self":"center",cols:"auto"},{default:l(()=>[e(Pt,{width:"60",src:o})]),_:1}),e(b,{"align-self":"center"},{default:l(()=>[g(M(v.title),1)]),_:1})]),_:1})]),_:1})]),_:3})],64))}}),Qa=K({__name:"index",setup(t){const o=ul(),s=D(!1),v=D(""),a=D([]);async function i(){const m=await x.Loggin({password:v.value});m!==void 0&&(m.IsValid?(x.setToken(m.Token,m.IsFondSoutien),x.showMessage("Bienvenue !"),o.push({path:"/inscriptions"})):a.value=["Clé de connection incorrecte."])}return(m,n)=>(y(),z(le,null,[e(fl,{title:"Connection au backoffice","hide-menu":""}),e(St,{class:"fill-height"},{default:l(()=>[e(O,{class:"mx-auto",width:"400px"},{default:l(()=>[e(B,null,{default:l(()=>[e(me,{label:"Clé de connection",modelValue:v.value,"onUpdate:modelValue":n[1]||(n[1]=c=>v.value=c),"error-messages":a.value,type:s.value?void 0:"password",name:"password",onKeydown:n[2]||(n[2]=Dt(Je(()=>v.value.length==0?null:i(),["prevent"]),["enter"]))},{"append-inner":l(()=>[e(L,{class:"ml-2",size:"small",icon:s.value?"mdi-eye":"mdi-eye-off",flat:"",onClick:n[0]||(n[0]=c=>s.value=!s.value)},null,8,["icon"])]),_:1},8,["modelValue","error-messages","type"])]),_:1}),e(oe,null,{default:l(()=>[e(ie),e(L,{disabled:!v.value.length,onClick:i},{default:l(()=>[...n[3]||(n[3]=[g("Se connecter",-1)])]),_:1},8,["disabled"])]),_:1})]),_:1})]),_:1})],64))}}),wl=K({__name:"BoolField",props:De({label:{},hideDetails:{type:Boolean},readonly:{type:Boolean},density:{},persistentHint:{type:Boolean},hint:{}},{modelValue:{type:Boolean,required:!0},modelModifiers:{}}),emits:["update:modelValue"],setup(t){const o=t,s=Pe(t,"modelValue");return(v,a)=>(y(),w(ze,{label:o.label,"model-value":s.value,"onUpdate:modelValue":a[0]||(a[0]=i=>s.value=i||!1),"hide-details":o.hideDetails,readonly:o.readonly,density:o.density,"persistent-hint":o.persistentHint,hint:o.hint},null,8,["label","model-value","hide-details","readonly","density","persistent-hint","hint"]))}}),mt=Re({active:{type:[String,Array],default:void 0},controlHeight:[Number,String],disabled:{type:[Boolean,String,Array],default:null},nextIcon:{type:Be,default:"$next"},prevIcon:{type:Be,default:"$prev"},modeIcon:{type:Be,default:"$subgroup"},text:String,viewMode:{type:String,default:"month"}},"VDatePickerControls"),jl=Le()({name:"VDatePickerControls",props:mt(),emits:{"click:year":()=>!0,"click:month":()=>!0,"click:prev":()=>!0,"click:next":()=>!0,"click:text":()=>!0},setup(t,o){let{emit:s}=o;const{t:v}=Ke(),a=F(()=>Array.isArray(t.disabled)?t.disabled.includes("text"):!!t.disabled),i=F(()=>Array.isArray(t.disabled)?t.disabled.includes("mode"):!!t.disabled),m=F(()=>Array.isArray(t.disabled)?t.disabled.includes("prev"):!!t.disabled),n=F(()=>Array.isArray(t.disabled)?t.disabled.includes("next"):!!t.disabled);function c(){s("click:prev")}function u(){s("click:next")}function d(){s("click:year")}function r(){s("click:month")}return he(()=>E("div",{class:ke(["v-date-picker-controls"]),style:{"--v-date-picker-controls-height":xl(t.controlHeight)}},[e(L,{class:"v-date-picker-controls__month-btn","data-testid":"month-btn",disabled:a.value,text:t.text,variant:"text",rounded:!0,onClick:r},null),e(L,{class:"v-date-picker-controls__mode-btn","data-testid":"year-btn",disabled:i.value,density:"comfortable",icon:t.modeIcon,variant:"text","aria-label":v("$vuetify.datePicker.ariaLabel.selectYear"),onClick:d},null),e(ie,null,null),E("div",{class:"v-date-picker-controls__month"},[e(L,{"data-testid":"prev-month",disabled:m.value,density:"comfortable",icon:t.prevIcon,variant:"text","aria-label":v("$vuetify.datePicker.ariaLabel.previousMonth"),onClick:c},null),e(L,{"data-testid":"next-month",disabled:n.value,icon:t.nextIcon,density:"comfortable",variant:"text","aria-label":v("$vuetify.datePicker.ariaLabel.nextMonth"),onClick:u},null)])])),{}}}),Wa=Re({appendIcon:Be,color:String,header:String,transition:String,onClick:It()},"VDatePickerHeader"),ql=Le()({name:"VDatePickerHeader",props:Wa(),emits:{click:()=>!0,"click:append":()=>!0},setup(t,o){let{emit:s,slots:v}=o;const{backgroundColorClasses:a,backgroundColorStyles:i}=Gl(()=>t.color);function m(){s("click")}function n(){s("click:append")}return he(()=>{const c=!!(v.default||t.header),u=!!(v.append||t.appendIcon);return E("div",{class:ke(["v-date-picker-header",{"v-date-picker-header--clickable":!!t.onClick},a.value]),style:al(i.value),onClick:m},[v.prepend&&E("div",{key:"prepend",class:"v-date-picker-header__prepend"},[v.prepend()]),c&&e(Kl,{key:"content",name:t.transition},{default:()=>[E("div",{key:t.header,class:"v-date-picker-header__content"},[v.default?.()??t.header])]}),u&&E("div",{class:"v-date-picker-header__append"},[v.append?e(Xl,{key:"append-defaults",disabled:!t.appendIcon,defaults:{VBtn:{icon:t.appendIcon,variant:"text"}}},{default:()=>[v.append?.()]}):e(L,{key:"append-btn",icon:t.appendIcon,variant:"text",onClick:n},null)])])}),{}}}),Ja=Re({allowedDates:[Array,Function],disabled:{type:Boolean,default:null},displayValue:null,modelValue:Array,month:[Number,String],max:null,min:null,showAdjacentMonths:Boolean,year:[Number,String],weekdays:{type:Array,default:()=>[0,1,2,3,4,5,6]},weeksInMonth:{type:String,default:"dynamic"},firstDayOfWeek:{type:[Number,String],default:void 0},firstDayOfYear:{type:[Number,String],default:void 0},weekdayFormat:String},"calendar");function Ga(t){const o=Ye(),s=Ue(t,"modelValue",[],_=>rl(_).map(C=>o.date(C))),v=F(()=>t.displayValue?o.date(t.displayValue):s.value.length>0?o.date(s.value[0]):t.min?o.date(t.min):Array.isArray(t.allowedDates)?o.date(t.allowedDates[0]):o.date()),a=Ue(t,"year",void 0,_=>{const C=_!=null?Number(_):o.getYear(v.value);return o.startOfYear(o.setYear(o.date(),C))},_=>o.getYear(_)),i=Ue(t,"month",void 0,_=>{const C=_!=null?Number(_):o.getMonth(v.value),P=o.setYear(o.startOfMonth(o.date()),o.getYear(a.value));return o.setMonth(P,C)},_=>o.getMonth(_)),m=F(()=>{const _=o.toJsDate(o.startOfWeek(o.date(),t.firstDayOfWeek)).getDay();return o.getWeekdays(t.firstDayOfWeek,t.weekdayFormat).filter((C,P)=>t.weekdays.includes((P+_)%7))}),n=F(()=>{const _=o.getWeekArray(i.value,t.firstDayOfWeek),C=_.flat(),P=6*7;if(t.weeksInMonth==="static"&&C.length<P){const j=C[C.length-1];let G=[];for(let S=1;S<=P-C.length;S++)G.push(o.addDays(j,S)),S%7===0&&(_.push(G),G=[])}return _});function c(_,C){return _.filter(P=>t.weekdays.includes(o.toJsDate(P).getDay())).map((P,j)=>{const G=o.toISO(P),S=!o.isSameMonth(P,i.value),f=o.isSameDay(P,o.startOfMonth(i.value)),ee=o.isSameDay(P,o.endOfMonth(i.value)),ye=o.isSameDay(P,i.value),W=t.weekdays.length;return{date:P,formatted:o.format(P,"keyboardDate"),isAdjacent:S,isDisabled:I(P),isEnd:ee,isHidden:S&&!t.showAdjacentMonths,isSame:ye,isSelected:s.value.some(A=>o.isSameDay(P,A)),isStart:f,isToday:o.isSameDay(P,C),isWeekEnd:j%W===W-1,isWeekStart:j%W===0,isoDate:G,localized:o.format(P,"dayOfMonth"),month:o.getMonth(P),year:o.getYear(P)}})}const u=F(()=>{const _=o.startOfWeek(v.value,t.firstDayOfWeek),C=[];for(let j=0;j<=6;j++)C.push(o.addDays(_,j));const P=o.date();return c(C,P)}),d=F(()=>{const _=n.value.flat(),C=o.date();return c(_,C)}),r=F(()=>n.value.map(_=>_.length?o.getWeek(_[0],t.firstDayOfWeek,t.firstDayOfYear):null)),{minDate:p,maxDate:k}=ct(t);function I(_){if(t.disabled)return!0;const C=o.date(_);return p.value&&o.isBefore(o.endOfDay(C),p.value)||k.value&&o.isAfter(C,k.value)?!0:Array.isArray(t.allowedDates)&&t.allowedDates.length>0?!t.allowedDates.some(P=>o.isSameDay(o.date(P),C)):typeof t.allowedDates=="function"?!t.allowedDates(C):!1}return{displayValue:v,daysInMonth:d,daysInWeek:u,genDays:c,model:s,weeksInMonth:n,weekdayLabels:m,weekNumbers:r}}function ct(t){const o=Ye(),s=F(()=>{if(!t.min)return null;const m=o.date(t.min);return o.isValid(m)?m:null}),v=F(()=>{if(!t.max)return null;const m=o.date(t.max);return o.isValid(m)?m:null});function a(m){return s.value&&o.isBefore(m,s.value)?s.value:v.value&&o.isAfter(m,v.value)?v.value:m}function i(m){return(!s.value||o.isAfter(m,s.value))&&(!v.value||o.isBefore(m,v.value))}return{minDate:s,maxDate:v,clampDate:a,isInAllowedRange:i}}const vt=Re({color:String,hideWeekdays:Boolean,multiple:[Boolean,Number,String],showWeek:Boolean,transition:{type:String,default:"picker-transition"},reverseTransition:{type:String,default:"picker-reverse-transition"},...He(Ja(),["displayValue"])},"VDatePickerMonth"),Hl=Le()({name:"VDatePickerMonth",props:vt(),emits:{"update:modelValue":t=>!0,"update:month":t=>!0,"update:year":t=>!0},setup(t,o){let{emit:s,slots:v}=o;const a=D(),{t:i}=Ke(),{daysInMonth:m,model:n,weekNumbers:c,weekdayLabels:u}=Ga(t),d=Ye(),r=ll(),p=ll(),k=ll(!1),I=Fe(()=>k.value?t.reverseTransition:t.transition);t.multiple==="range"&&n.value.length>0&&(r.value=n.value[0],n.value.length>1&&(p.value=n.value[n.value.length-1]));const _=F(()=>{const S=["number","string"].includes(typeof t.multiple)?Number(t.multiple):1/0;return n.value.length>=S});Ae(m,(S,f)=>{f&&(k.value=d.isBefore(S[0].date,f[0].date))});function C(S){const f=d.startOfDay(S);if(n.value.length===0?r.value=void 0:n.value.length===1&&(r.value=n.value[0],p.value=void 0),!r.value)r.value=f,n.value=[r.value];else if(p.value)r.value=S,p.value=void 0,n.value=[r.value];else{if(d.isSameDay(f,r.value)){r.value=void 0,n.value=[];return}else d.isBefore(f,r.value)?(p.value=d.endOfDay(r.value),r.value=f):p.value=d.endOfDay(f);n.value=At(d,r.value,p.value)}}function P(S){const f=d.format(S.date,"fullDateWithWeekday"),ee=S.isToday?"currentDate":"selectDate";return i(`$vuetify.datePicker.ariaLabel.${ee}`,f)}function j(S){const f=n.value.findIndex(ee=>d.isSameDay(ee,S));if(f===-1)n.value=[...n.value,S];else{const ee=[...n.value];ee.splice(f,1),n.value=ee}}function G(S){t.multiple==="range"?C(S):t.multiple?j(S):n.value=[S]}he(()=>E("div",{class:"v-date-picker-month",style:{"--v-date-picker-days-in-week":t.weekdays.length}},[t.showWeek&&E("div",{key:"weeks",class:"v-date-picker-month__weeks"},[!t.hideWeekdays&&E("div",{key:"hide-week-days",class:"v-date-picker-month__day"},[g(" ")]),c.value.map(S=>E("div",{class:ke(["v-date-picker-month__day","v-date-picker-month__day--adjacent"])},[S]))]),e(Kl,{name:I.value},{default:()=>[E("div",{ref:a,key:m.value[0].date?.toString(),class:"v-date-picker-month__days"},[!t.hideWeekdays&&u.value.map(S=>E("div",{class:ke(["v-date-picker-month__day","v-date-picker-month__weekday"])},[S])),m.value.map((S,f)=>{const ee={props:{class:"v-date-picker-month__day-btn",color:S.isSelected||S.isToday?t.color:void 0,disabled:S.isDisabled,icon:!0,ripple:!1,text:S.localized,variant:S.isSelected?"flat":S.isToday?"outlined":"text","aria-label":P(S),"aria-current":S.isToday?"date":void 0,onClick:()=>G(S.date)},item:S,i:f};return _.value&&!S.isSelected&&(S.isDisabled=!0),E("div",{class:ke(["v-date-picker-month__day",{"v-date-picker-month__day--adjacent":S.isAdjacent,"v-date-picker-month__day--hide-adjacent":S.isHidden,"v-date-picker-month__day--selected":S.isSelected,"v-date-picker-month__day--week-end":S.isWeekEnd,"v-date-picker-month__day--week-start":S.isWeekStart}]),"data-v-date":S.isDisabled?void 0:S.isoDate},[(t.showAdjacentMonths||!S.isAdjacent)&&(v.day?.(ee)??e(L,ee.props,null))])})])]})]))}}),pt=Re({color:String,height:[String,Number],min:null,max:null,modelValue:Number,year:Number,allowedMonths:[Array,Function]},"VDatePickerMonths"),Yl=Le()({name:"VDatePickerMonths",props:pt(),emits:{"update:modelValue":t=>!0},setup(t,o){let{emit:s,slots:v}=o;const a=Ye(),i=Ue(t,"modelValue"),m=F(()=>{let c=a.startOfYear(a.date());return t.year&&(c=a.setYear(c,t.year)),Ee(12).map(u=>{const d=a.format(c,"monthShort"),r=a.format(c,"month"),p=!!(!n(u)||t.min&&a.isAfter(a.startOfMonth(a.date(t.min)),c)||t.max&&a.isAfter(c,a.startOfMonth(a.date(t.max))));return c=a.getNextMonth(c),{isDisabled:p,text:d,label:r,value:u}})});Zl(()=>{i.value=i.value??a.getMonth(a.date())});function n(c){return Array.isArray(t.allowedMonths)&&t.allowedMonths.length?t.allowedMonths.includes(c):typeof t.allowedMonths=="function"?t.allowedMonths(c):!0}return he(()=>E("div",{class:"v-date-picker-months",style:{height:xl(t.height)}},[E("div",{class:"v-date-picker-months__content"},[m.value.map((c,u)=>{const d={active:i.value===u,ariaLabel:c.label,color:i.value===u?t.color:void 0,disabled:c.isDisabled,rounded:!0,text:c.text,variant:i.value===c.value?"flat":"text",onClick:()=>r(u)};function r(p){if(i.value===p){s("update:modelValue",i.value);return}i.value=p}return v.month?.({month:c,i:u,props:d})??e(L,se({key:"month"},d),null)})])])),{}}}),ft=Re({color:String,height:[String,Number],min:null,max:null,modelValue:Number,allowedYears:[Array,Function]},"VDatePickerYears"),zl=Le()({name:"VDatePickerYears",props:ft(),directives:{vIntersect:Sl},emits:{"update:modelValue":t=>!0},setup(t,o){let{emit:s,slots:v}=o;const a=Ye(),i=Ue(t,"modelValue"),m=F(()=>{const d=a.getYear(a.date());let r=d-100,p=d+52;t.min&&(r=a.getYear(a.date(t.min))),t.max&&(p=a.getYear(a.date(t.max)));let k=a.startOfYear(a.date());return k=a.setYear(k,r),Ee(p-r+1,r).map(I=>{const _=a.format(k,"year");return k=a.setYear(k,a.getYear(k)+1),{text:_,value:I,isDisabled:!u(I)}})});Zl(()=>{i.value=i.value??a.getYear(a.date())});const n=Mt();function c(){n.el?.focus(),n.el?.scrollIntoView({block:"center"})}function u(d){return Array.isArray(t.allowedYears)&&t.allowedYears.length?t.allowedYears.includes(d):typeof t.allowedYears=="function"?t.allowedYears(d):!0}return he(()=>$t(E("div",{class:"v-date-picker-years",style:{height:xl(t.height)}},[E("div",{class:"v-date-picker-years__content"},[m.value.map((d,r)=>{const p={ref:i.value===d.value?n:void 0,active:i.value===d.value,color:i.value===d.value?t.color:void 0,rounded:!0,text:d.text,disabled:d.isDisabled,variant:i.value===d.value?"flat":"text",onClick:()=>{if(i.value===d.value){s("update:modelValue",i.value);return}i.value=d.value}};return v.year?.({year:d,i:r,props:p})??e(L,se({key:"month"},p),null)})])]),[[Sl,{handler:c},null,{once:!0}]])),{}}}),Ka=Re({header:{type:String,default:"$vuetify.datePicker.header"},headerColor:String,...mt(),...vt({weeksInMonth:"static"}),...He(pt(),["modelValue"]),...He(ft(),["modelValue"]),...nt({title:"$vuetify.datePicker.title"}),modelValue:null},"VDatePicker"),Xa=Le()({name:"VDatePicker",props:Ka(),emits:{"update:modelValue":t=>!0,"update:month":t=>!0,"update:year":t=>!0,"update:viewMode":t=>!0},setup(t,o){let{emit:s,slots:v}=o;const a=Ye(),{t:i}=Ke(),{rtlClasses:m}=et(),n=Ue(t,"modelValue",void 0,V=>rl(V).map($=>a.date($)),V=>t.multiple?V:V[0]),c=Ue(t,"viewMode"),{minDate:u,maxDate:d,clampDate:r}=ct(t),p=F(()=>{const V=a.date(),$=n.value?.[0]?a.date(n.value[0]):r(V);return $&&a.isValid($)?$:V}),k=Fe(()=>t.headerColor??t.color),I=Ue(t,"month"),_=F({get:()=>Number(I.value??a.getMonth(a.startOfMonth(p.value))),set:V=>I.value=V}),C=Ue(t,"year"),P=F({get:()=>Number(C.value??a.getYear(a.startOfYear(a.setMonth(p.value,_.value)))),set:V=>C.value=V}),j=ll(!1),G=F(()=>t.multiple&&n.value.length>1?i("$vuetify.datePicker.itemsSelected",n.value.length):n.value[0]&&a.isValid(n.value[0])?a.format(a.date(n.value[0]),"normalDateWithWeekday"):i(t.header)),S=F(()=>{let V=a.date();return V=a.setDate(V,1),V=a.setMonth(V,_.value),V=a.setYear(V,P.value),a.format(V,"monthAndYear")}),f=Fe(()=>`date-picker-header${j.value?"-reverse":""}-transition`),ee=F(()=>{if(t.disabled)return!0;const V=[];if(c.value!=="month")V.push("prev","next");else{let $=a.date();if($=a.startOfMonth($),$=a.setMonth($,_.value),$=a.setYear($,P.value),u.value){const R=a.addDays(a.startOfMonth($),-1);a.isAfter(u.value,R)&&V.push("prev")}if(d.value){const R=a.addDays(a.endOfMonth($),1);a.isAfter(R,d.value)&&V.push("next")}}return V}),ye=F(()=>t.allowedYears||te),W=F(()=>t.allowedMonths||ne);function A(V,$){const R=t.allowedDates;if(typeof R!="function")return!0;const pe=1+Rt(a,V,$);for(let ae=0;ae<pe;ae++)if(R(a.addDays(V,ae)))return!0;return!1}function te(V){if(typeof t.allowedDates=="function"){const $=a.parseISO(`${V}-01-01`);return A($,a.endOfYear($))}if(Array.isArray(t.allowedDates)&&t.allowedDates.length){for(const $ of t.allowedDates)if(a.getYear(a.date($))===V)return!0;return!1}return!0}function ne(V){if(typeof t.allowedDates=="function"){const $=String(V+1).padStart(2,"0"),R=a.parseISO(`${P.value}-${$}-01`);return A(R,a.endOfMonth(R))}if(Array.isArray(t.allowedDates)&&t.allowedDates.length){for(const $ of t.allowedDates)if(a.getYear(a.date($))===P.value&&a.getMonth(a.date($))===V)return!0;return!1}return!0}function N(){_.value<11?_.value++:(P.value++,_.value=0,J()),ge()}function q(){_.value>0?_.value--:(P.value--,_.value=11,J()),ge()}function re(){c.value="month"}function X(){c.value=c.value==="months"?"month":"months"}function be(){c.value=c.value==="year"?"month":"year"}function ge(){c.value==="months"&&X()}function J(){c.value==="year"&&be()}return Ae(n,(V,$)=>{const R=rl($),pe=rl(V);if(!pe.length)return;const ae=a.date(R[R.length-1]),Me=a.date(pe[pe.length-1]),$e=a.getMonth(Me),T=a.getYear(Me);$e!==_.value&&(_.value=$e,ge()),T!==P.value&&(P.value=T,J()),j.value=a.isBefore(ae,Me)}),he(()=>{const V=ml.filterProps(t),$=jl.filterProps(t),R=ql.filterProps(t),pe=Hl.filterProps(t),ae=He(Yl.filterProps(t),["modelValue"]),Me=He(zl.filterProps(t),["modelValue"]),$e={color:k.value,header:G.value,transition:f.value};return e(ml,se(V,{color:k.value,class:["v-date-picker",`v-date-picker--${c.value}`,{"v-date-picker--show-week":t.showWeek},m.value,t.class],style:t.style}),{title:()=>v.title?.()??E("div",{class:"v-date-picker__title"},[i(t.title)]),header:()=>v.header?e(Xl,{defaults:{VDatePickerHeader:{...$e}}},{default:()=>[v.header?.($e)]}):e(ql,se({key:"header"},R,$e,{onClick:c.value!=="month"?re:void 0}),{prepend:v.prepend,append:v.append}),default:()=>E(le,null,[e(jl,se($,{disabled:ee.value,text:S.value,"onClick:next":N,"onClick:prev":q,"onClick:month":X,"onClick:year":be}),null),e(Ut,{hideOnLeave:!0},{default:()=>[c.value==="months"?e(Yl,se({key:"date-picker-months"},ae,{modelValue:_.value,"onUpdate:modelValue":[T=>_.value=T,ge],min:u.value,max:d.value,year:P.value,allowedMonths:W.value}),{month:v.month}):c.value==="year"?e(zl,se({key:"date-picker-years"},Me,{modelValue:P.value,"onUpdate:modelValue":[T=>P.value=T,J],min:u.value,max:d.value,allowedYears:ye.value}),{year:v.year}):e(Hl,se({key:"date-picker-month"},pe,{modelValue:n.value,"onUpdate:modelValue":T=>n.value=T,month:_.value,"onUpdate:month":[T=>_.value=T,ge],year:P.value,"onUpdate:year":[T=>P.value=T,J],min:u.value,max:d.value}),{day:v.day})]})]),actions:v.actions})}),{}}}),Za=K({__name:"DateField",props:De({label:{},hideDetails:{type:Boolean},readonly:{type:Boolean}},{modelValue:{required:!0},modelModifiers:{}}),emits:["update:modelValue"],setup(t){const o=t,s=Pe(t,"modelValue"),v=Ye();function a(m){i.value=!1,s.value=lt(m)}const i=D(!1);return(m,n)=>o.readonly?(y(),w(me,{key:0,class:"center-text",variant:"outlined",density:"compact","hide-details":o.hideDetails,label:o.label,"model-value":U(v).parseISO(s.value).toLocaleDateString(),readonly:""},null,8,["hide-details","label","model-value"])):(y(),w(Se,{key:1,"close-on-content-click":!1,modelValue:i.value,"onUpdate:modelValue":n[1]||(n[1]=c=>i.value=c)},{activator:l(({props:c})=>[e(me,se({class:"center-text"},c,{variant:"outlined",density:"compact","hide-details":o.hideDetails,label:o.label,"model-value":U(v).parseISO(s.value).toLocaleDateString()}),null,16,["hide-details","label","model-value"])]),default:l(()=>[e(Xa,{"model-value":U(v).parseISO(s.value),"onUpdate:modelValue":n[0]||(n[0]=c=>a(c))},null,8,["model-value"])]),_:1},8,["modelValue"]))}}),yt=Pl(Za,[["__scopeId","data-v-1e184428"]]),en=K({__name:"OptionStatut",props:De({camp:{}},{modelValue:{required:!0},modelModifiers:{}}),emits:["update:modelValue"],setup(t){const o=t,s=Pe(t,"modelValue");function v(){const m=s.value?.length?s.value.map(u=>u.Id):[0],c={Id:Math.max(...m)+1,Label:"",Description:"",Prix:o.camp.Prix.Cent};s.value=(s.value||[]).concat(c),a.value=c}const a=D(null);function i(m){s.value=(s.value||[]).filter(n=>n.Id!=m.Id)}return(m,n)=>{const c=Ze;return y(),w(O,{subtitle:"Le prix dépend du statut du participant, à choisir parmi la liste ci-dessous."},{append:l(()=>[e(L,{icon:"",size:"x-small",onClick:v},{default:l(()=>[e(xe,{color:"green"},{default:l(()=>[...n[4]||(n[4]=[g("mdi-plus",-1)])]),_:1})]),_:1})]),default:l(()=>[a.value!=null?(y(),w(Z,{key:0,"model-value":a.value!=null,"onUpdate:modelValue":n[3]||(n[3]=u=>a.value=null),"max-width":"500px"},{default:l(()=>[e(O,{title:"Modifier le statut"},{default:l(()=>[e(B,null,{default:l(()=>[e(h,null,{default:l(()=>[e(b,{cols:"12"},{default:l(()=>[e(me,{autofocus:"",label:"Statut",modelValue:a.value.Label,"onUpdate:modelValue":n[0]||(n[0]=u=>a.value.Label=u),density:"compact",variant:"outlined","hide-details":""},null,8,["modelValue"])]),_:1}),e(b,{cols:"12"},{default:l(()=>[e(me,{label:"Description",modelValue:a.value.Description,"onUpdate:modelValue":n[1]||(n[1]=u=>a.value.Description=u),density:"compact",variant:"outlined","hide-details":""},null,8,["modelValue"])]),_:1}),e(b,{cols:"12"},{default:l(()=>[e(c,{"model-value":{Cent:a.value.Prix,Currency:o.camp.Prix.Currency},"onUpdate:modelValue":n[2]||(n[2]=u=>a.value.Prix=u.Cent),label:"Prix","readonly-currency":""},null,8,["model-value"])]),_:1})]),_:1})]),_:1})]),_:1})]),_:1},8,["model-value"])):Q("",!0),e(B,{class:"py-0"},{default:l(()=>[e(Ve,null,{default:l(()=>[s.value?.length?Q("",!0):(y(),w(H,{key:0},{default:l(()=>[...n[5]||(n[5]=[E("i",null,"Aucun statut n'est encore défini.",-1)])]),_:1})),(y(!0),z(le,null,ce(s.value,u=>(y(),w(H,{title:u.Label,subtitle:u.Description,onClick:d=>a.value=u},{append:l(()=>[e(h,null,{default:l(()=>[e(b,{"align-self":"center"},{default:l(()=>[e(fe,null,{default:l(()=>[g(M(U(_e).montant({Cent:u.Prix,Currency:t.camp.Prix.Currency})),1)]),_:2},1024)]),_:2},1024),e(b,{"align-self":"center",cols:"auto"},{default:l(()=>[e(L,{icon:"",size:"x-small",class:"my-1",onClick:Je(d=>i(u),["stop"])},{default:l(()=>[e(xe,{color:"red"},{default:l(()=>[...n[6]||(n[6]=[g("mdi-delete",-1)])]),_:1})]),_:1},8,["onClick"])]),_:2},1024)]),_:2},1024)]),_:2},1032,["title","subtitle","onClick"]))),256))]),_:1})]),_:1})]),_:1})}}}),ln=K({__name:"OptionJournee",props:De({camp:{}},{modelValue:{required:!0},modelModifiers:{}}),emits:["update:modelValue"],setup(t){const o=t,s=Pe(t,"modelValue");Ae(()=>s.value,v,{immediate:!0});function v(){const i=o.camp.Duree;s.value?.length!=i&&(s.value=Array.from({length:i}).map(m=>0))}function a(){const i=s.value,m=i[0];for(let n=0;n<i.length;n++)i[n]=m}return(i,m)=>{const n=Ze;return y(),w(O,{subtitle:"Le prix est variable en fonction des jours de participation au camp."},{append:l(()=>[e(je,{text:"Appliquer le prix du premier jour à tous."},{activator:l(({props:c})=>[e(L,se(c,{icon:"mdi-arrow-expand",size:"x-small",disabled:!(s.value||[])[0],onClick:a}),null,16,["disabled"])]),_:1})]),default:l(()=>[e(B,null,{default:l(()=>[e(h,null,{default:l(()=>[(y(!0),z(le,null,ce(s.value,(c,u)=>(y(),w(b,{cols:"3"},{default:l(()=>[e(n,{label:`Jour ${u+1}`,"model-value":{Cent:c,Currency:o.camp.Prix.Currency},"onUpdate:modelValue":d=>s.value[u]=d.Cent,"readonly-currency":""},null,8,["label","model-value","onUpdate:modelValue"])]),_:2},1024))),256))]),_:1})]),_:1})]),_:1})}}}),tn={key:0,class:"text-center"},an=K({__name:"CampOptionsPrix",props:De({camp:{}},{optionPrix:{required:!0},optionPrixModifiers:{},optionQf:{required:!0},optionQfModifiers:{}}),emits:["update:optionPrix","update:optionQf"],setup(t){const o=t,s=Pe(t,"optionPrix"),v=Pe(t,"optionQf"),a=F(()=>Ce.isQuotientFamilialActive(v.value)),i=nl(tt);return(m,n)=>{const c=Xe;return y(),w(O,{title:"Options sur le prix",subtitle:"Permet de modifier le prix de base du séjour",width:"1000px"},{default:l(()=>[e(B,null,{default:l(()=>[e(h,null,{default:l(()=>[e(b,{"align-self":"center"},{default:l(()=>[e(ze,{"model-value":a.value,"onUpdate:modelValue":n[0]||(n[0]=u=>v.value[3]=u?100:0),"hide-details":"",label:"Prix au quotient familial"},null,8,["model-value"])]),_:1}),e(b,{"align-self":"center"},{default:l(()=>[e(c,{suffix:"%",min:0,max:100,disabled:!a.value,"hide-details":"","readonly-currency":"",label:"entre 1 et 359",modelValue:v.value[0],"onUpdate:modelValue":n[1]||(n[1]=u=>v.value[0]=u)},null,8,["disabled","modelValue"])]),_:1}),e(b,{"align-self":"center"},{default:l(()=>[e(c,{suffix:"%",min:0,max:100,disabled:!a.value,"hide-details":"","readonly-currency":"",label:"entre 360 et 564",modelValue:v.value[1],"onUpdate:modelValue":n[2]||(n[2]=u=>v.value[1]=u)},null,8,["disabled","modelValue"])]),_:1}),e(b,{"align-self":"center"},{default:l(()=>[e(c,{suffix:"%",min:0,max:100,disabled:!a.value,"hide-details":"","readonly-currency":"",label:"entre 565 et 714",modelValue:v.value[2],"onUpdate:modelValue":n[3]||(n[3]=u=>v.value[2]=u)},null,8,["disabled","modelValue"])]),_:1}),e(b,{"align-self":"center"},{default:l(()=>[e(c,{suffix:"%",min:0,max:100,disabled:!0,"hide-details":"","readonly-currency":"",label:"plus de 715",modelValue:v.value[3],"onUpdate:modelValue":n[4]||(n[4]=u=>v.value[3]=u)},null,8,["modelValue"])]),_:1})]),_:1}),e(ue,{thickness:"1",class:"my-2"}),e(h,{class:"my-2"},{default:l(()=>[e(b,{"align-self":"center",cols:"4"},{default:l(()=>[e(Oe,{variant:"outlined",density:"comfortable","hide-details":"",items:U(i),label:"Option sur le prix",modelValue:s.value.Active,"onUpdate:modelValue":n[5]||(n[5]=u=>s.value.Active=u)},null,8,["items","modelValue"])]),_:1}),e(b,{"align-self":"center"},{default:l(()=>[s.value.Active==U(Ie).NoOption?(y(),z("div",tn,[...n[8]||(n[8]=[E("i",null,"Aucune modification sur le prix de base.",-1)])])):s.value.Active==U(Ie).PrixStatut?(y(),w(en,{key:1,camp:o.camp,modelValue:s.value.Statuts,"onUpdate:modelValue":n[6]||(n[6]=u=>s.value.Statuts=u)},null,8,["camp","modelValue"])):s.value.Active==U(Ie).PrixJour?(y(),w(ln,{key:2,camp:o.camp,modelValue:s.value.Jours,"onUpdate:modelValue":n[7]||(n[7]=u=>s.value.Jours=u)},null,8,["camp","modelValue"])):Q("",!0)]),_:1})]),_:1})]),_:1})]),_:1})}}}),nn=K({__name:"CampMetaEdit",props:De({metaEntriesHints:{}},{modelValue:{required:!0},modelModifiers:{}}),emits:["update:modelValue"],setup(t){const o=t,s=Pe(t,"modelValue"),v=D(Object.entries(s.value||{}));function a(){const i=Object.fromEntries(v.value);s.value=i}return F(()=>{const i=v.value.map(n=>n[0]);return i.includes("")?!0:new Set(i).size!=v.value.length}),(i,m)=>(y(),w(O,{subtitle:"Métadonnées exposées sur l'API publique"},{append:l(()=>[e(L,{size:"small",class:"ml-2",onClick:m[0]||(m[0]=n=>{v.value.push(["",""]),a()})},{prepend:l(()=>[e(xe,{color:"green"},{default:l(()=>[...m[1]||(m[1]=[g("mdi-plus",-1)])]),_:1})]),default:l(()=>[m[2]||(m[2]=g(" Ajouter une valeur",-1))]),_:1})]),default:l(()=>[e(B,{class:"pt-2"},{default:l(()=>[(y(!0),z(le,null,ce(v.value,(n,c)=>(y(),w(h,null,{default:l(()=>[e(b,{cols:"4"},{default:l(()=>[e(Bl,{variant:"outlined",density:"compact","hide-details":"",label:"Clé",modelValue:n[0],"onUpdate:modelValue":[u=>n[0]=u,a],autofocus:"",items:o.metaEntriesHints.keys},null,8,["modelValue","onUpdate:modelValue","items"])]),_:2},1024),e(b,null,{default:l(()=>[e(Bl,{variant:"outlined",density:"compact","hide-details":"",label:"Valeur",modelValue:n[1],"onUpdate:modelValue":[u=>n[1]=u,a],items:o.metaEntriesHints.values},null,8,["modelValue","onUpdate:modelValue","items"])]),_:2},1024),e(b,{cols:"auto"},{default:l(()=>[e(L,{icon:"",size:"small",flat:"",onClick:u=>{v.value.splice(c,1),a()}},{default:l(()=>[e(xe,{color:"red"},{default:l(()=>[...m[3]||(m[3]=[g("mdi-close",-1)])]),_:1})]),_:1},8,["onClick"])]),_:2},1024)]),_:2},1024))),256))]),_:1})]),_:1}))}}),un=K({__name:"CampEdit",props:{camp:{},preselectionUrl:{},metaEntriesHints:{}},emits:["save"],setup(t,{emit:o}){const s=t,v=o,a=D(we(s.camp)),i=F(()=>new Date(a.value.DateDebut).getFullYear()>=2020&&a.value.Places>=1&&a.value.Nom!=""&&a.value.AgeMax>=a.value.AgeMin&&a.value.OptionQuotientFamilial.every(u=>0<=u&&u<=100)&&!(a.value.OptionPrix.Active==Ie.PrixStatut&&!a.value.OptionPrix.Statuts?.length)&&!(a.value.OptionPrix.Active==Ie.PrixJour&&a.value.OptionPrix.Jours?.length!=a.value.Duree)),m=nl(Ft);function n(u){const d=Ce.isQuotientFamilialActive(u.OptionQuotientFamilial),r=u.OptionPrix.Active!=Ie.NoOption;if(!d&&!r)return"Aucune";const p=[];return Ce.isQuotientFamilialActive(u.OptionQuotientFamilial)&&p.push("Quotient familial"),u.OptionPrix.Active!=Ie.NoOption&&p.push(tt[u.OptionPrix.Active]),p.join(", ")}async function c(){await dl(s.preselectionUrl),x.showMessage("URL copiée dans le presse-papier.")}return(u,d)=>{const r=yt,p=Xe,k=Ze,I=wl;return y(),w(O,{title:"Paramètres du séjour",subtitle:U(Ce).label(s.camp)},{default:l(()=>[e(B,null,{default:l(()=>[e(O,{class:"my-2",subtitle:"Général"},{default:l(()=>[e(B,null,{default:l(()=>[e(h,null,{default:l(()=>[e(b,null,{default:l(()=>[e(me,{autofocus:"","hide-details":"",label:"Nom",density:"compact",variant:"outlined",modelValue:a.value.Nom,"onUpdate:modelValue":d[0]||(d[0]=_=>a.value.Nom=_)},null,8,["modelValue"])]),_:1}),e(b,null,{default:l(()=>[e(me,{"hide-details":"",label:"Lieu",density:"compact",variant:"outlined",modelValue:a.value.Lieu,"onUpdate:modelValue":d[1]||(d[1]=_=>a.value.Lieu=_)},null,8,["modelValue"])]),_:1}),e(b,null,{default:l(()=>[e(me,{"hide-details":"",label:"Numéro d'agrément",density:"compact",variant:"outlined",modelValue:a.value.Agrement,"onUpdate:modelValue":d[2]||(d[2]=_=>a.value.Agrement=_)},null,8,["modelValue"])]),_:1})]),_:1}),e(h,null,{default:l(()=>[e(b,{"align-self":"center"},{default:l(()=>[e(r,{modelValue:a.value.DateDebut,"onUpdate:modelValue":d[3]||(d[3]=_=>a.value.DateDebut=_),label:"Date de début","hide-details":""},null,8,["modelValue"])]),_:1}),e(b,{"align-self":"center"},{default:l(()=>[e(p,{label:"Durée (en jours)",modelValue:a.value.Duree,"onUpdate:modelValue":d[4]||(d[4]=_=>a.value.Duree=_),"hide-details":""},null,8,["modelValue"])]),_:1}),e(b,{"align-self":"center"},{default:l(()=>[e(r,{"model-value":U(Ce).dateFin(a.value),label:"Date de fin",readonly:"","hide-details":""},null,8,["model-value"])]),_:1})]),_:1})]),_:1})]),_:1}),e(O,{class:"my-2",subtitle:"Prix"},{default:l(()=>[e(B,null,{default:l(()=>[e(h,null,{default:l(()=>[e(b,{"align-self":"center",cols:"6"},{default:l(()=>[e(k,{label:"Prix",modelValue:a.value.Prix,"onUpdate:modelValue":d[5]||(d[5]=_=>a.value.Prix=_),"hide-details":""},null,8,["modelValue"])]),_:1}),e(b,{"align-self":"center",cols:"6",class:"text-center"},{default:l(()=>[e(Se,{"close-on-content-click":!1},{activator:l(({props:_})=>[e(me,se(_,{readonly:"",label:"Option sur le prix",variant:"outlined",density:"compact","hide-details":"","model-value":n(a.value)}),null,16,["model-value"])]),default:l(()=>[e(an,{camp:a.value,"option-prix":a.value.OptionPrix,"onUpdate:optionPrix":d[6]||(d[6]=_=>a.value.OptionPrix=_),"option-qf":a.value.OptionQuotientFamilial,"onUpdate:optionQf":d[7]||(d[7]=_=>a.value.OptionQuotientFamilial=_)},null,8,["camp","option-prix","option-qf"])]),_:1})]),_:1})]),_:1})]),_:1})]),_:1}),e(O,{class:"my-2",subtitle:"Visibilité et inscriptions"},{default:l(()=>[e(B,null,{default:l(()=>[e(h,null,{default:l(()=>[e(b,{"align-self":"center"},{default:l(()=>[e(Oe,{label:"Ouverture aux inscriptions",variant:"outlined",density:"compact",items:U(m),"hide-details":"",modelValue:a.value.Statut,"onUpdate:modelValue":d[8]||(d[8]=_=>a.value.Statut=_)},null,8,["items","modelValue"])]),_:1}),e(b,{"align-self":"center"},{default:l(()=>[e(kl,{label:"Camp sans inscription",modelValue:a.value.WithoutInscription,"onUpdate:modelValue":d[9]||(d[9]=_=>a.value.WithoutInscription=_),color:"primary",density:"compact","persistent-hint":"",hint:a.value.WithoutInscription?"Camp externe, uniquement visible sur l'API publique.":""},null,8,["modelValue","hint"])]),_:1})]),_:1})]),_:1})]),_:1}),e(O,{class:"my-2",subtitle:"Filtres sur les inscrits"},{default:l(()=>[e(B,null,{default:l(()=>[e(h,null,{default:l(()=>[e(b,{"align-self":"center"},{default:l(()=>[e(p,{modelValue:a.value.Places,"onUpdate:modelValue":d[10]||(d[10]=_=>a.value.Places=_),label:"Nombre de places"},null,8,["modelValue"])]),_:1}),e(b,{"align-self":"center"},{default:l(()=>[e(p,{modelValue:a.value.AgeMin,"onUpdate:modelValue":d[11]||(d[11]=_=>a.value.AgeMin=_),label:"Âge minimum"},null,8,["modelValue"])]),_:1}),e(b,{"align-self":"center"},{default:l(()=>[e(p,{modelValue:a.value.AgeMax,"onUpdate:modelValue":d[12]||(d[12]=_=>a.value.AgeMax=_),label:"Âge maximum"},null,8,["modelValue"])]),_:1})]),_:1}),e(h,null,{default:l(()=>[e(b,null,{default:l(()=>[e(I,{modelValue:a.value.NeedEquilibreGF,"onUpdate:modelValue":d[13]||(d[13]=_=>a.value.NeedEquilibreGF=_),label:"Equilibre G/F demandé",density:"compact","persistent-hint":"",hint:"Place un inscrit en liste d'attente en cas de déséquilibre Garçons/Filles"},null,8,["modelValue"])]),_:1})]),_:1})]),_:1})]),_:1}),e(O,{class:"my-2",subtitle:"Formulaire d'inscription"},{default:l(()=>[e(B,null,{default:l(()=>[e(h,null,{default:l(()=>[e(b,null,{default:l(()=>[e(me,{label:"Image",density:"compact",variant:"outlined",hint:"URL d'une image affichée sur le formulaire d'inscription","persistent-hint":"",modelValue:a.value.ImageURL,"onUpdate:modelValue":d[14]||(d[14]=_=>a.value.ImageURL=_)},null,8,["modelValue"])]),_:1})]),_:1}),e(h,null,{default:l(()=>[e(b,null,{default:l(()=>[e(cl,{variant:"outlined",density:"compact",label:"Description",hint:"Ce texte est affiché sur le formulaire d'inscription.","persistent-hint":"",rows:"3",modelValue:a.value.Description,"onUpdate:modelValue":d[15]||(d[15]=_=>a.value.Description=_)},null,8,["modelValue"])]),_:1}),e(b,{cols:"2"},{default:l(()=>[e(I,{label:"Navette",modelValue:a.value.Navette.Actif,"onUpdate:modelValue":d[16]||(d[16]=_=>a.value.Navette.Actif=_)},null,8,["modelValue"])]),_:1}),e(b,null,{default:l(()=>[e(cl,{variant:"outlined",density:"compact",label:"Navette",hint:"Ce texte est affiché sur l'espace personnel de suivi.","persistent-hint":"",rows:"3",disabled:!a.value.Navette.Actif,modelValue:a.value.Navette.Commentaire,"onUpdate:modelValue":d[17]||(d[17]=_=>a.value.Navette.Commentaire=_)},null,8,["disabled","modelValue"])]),_:1})]),_:1}),e(h,null,{default:l(()=>[e(b,null,{default:l(()=>[e(me,{density:"compact",variant:"outlined",label:"URL de préselection",hint:"Cette URL permet de sélectionner automatiquement le séjour sur le formulaire d'inscription.","persistent-hint":"",readonly:"","model-value":s.preselectionUrl},{append:l(()=>[e(L,{icon:"mdi-content-copy",size:"small",onClick:c})]),_:1},8,["model-value"])]),_:1})]),_:1})]),_:1})]),_:1}),e(O,{class:"my-2",subtitle:"Autre"},{default:l(()=>[e(B,null,{default:l(()=>[e(h,null,{default:l(()=>[e(b,null,{default:l(()=>[e(me,{label:"Mot de passe",density:"compact",variant:"outlined",hint:"Mot de passe d'accès à la page Directeur","persistent-hint":"",modelValue:a.value.Password,"onUpdate:modelValue":d[18]||(d[18]=_=>a.value.Password=_)},null,8,["modelValue"])]),_:1})]),_:1})]),_:1})]),_:1}),e(nn,{"meta-entries-hints":t.metaEntriesHints,modelValue:a.value.Meta,"onUpdate:modelValue":d[19]||(d[19]=_=>a.value.Meta=_)},null,8,["meta-entries-hints","modelValue"])]),_:1}),e(oe,null,{default:l(()=>[e(ie),e(L,{disabled:!i.value,onClick:d[20]||(d[20]=_=>v("save",a.value))},{default:l(()=>[...d[21]||(d[21]=[g("Enregistrer",-1)])]),_:1},8,["disabled"])]),_:1})]),_:1},8,["subtitle"])}}}),Ql=K({__name:"TauxSelect",props:{modelValue:{required:!0},modelModifiers:{}},emits:["update:modelValue"],setup(t){Te(i);const o=Pe(t,"modelValue"),s=D(null),v=F(()=>{const u=Array.from(a.value.values()).map(d=>({title:d.Label,value:d.Id}));return u.sort((d,r)=>d.title.localeCompare(r.title)),u}),a=D(new Map);async function i(){const u=await x.CampsGetTaux();u!==void 0&&(a.value=Lt(u),o.value.Id>0&&(o.value=we(a.value.get(o.value.Id)),s.value=o.value.Id))}function m(){o.value.Id<=0?(s.value==null&&(s.value=1),o.value=we(a.value.get(s.value))):(s.value=null,o.value.Id=0,o.value.Label="")}function n(u){o.value=we(a.value.get(u))}const c=F(()=>{if(o.value.Id>0)return null;const u=o.value.Label;return Array.from(a.value.values()).map(r=>r.Label).includes(u)?"Ce label est déjà utilisé.":null});return(u,d)=>(y(),w(h,null,{default:l(()=>[e(b,{"align-self":"center"},{default:l(()=>[o.value.Id>0?(y(),w(Oe,{key:0,variant:"outlined",density:"compact","hide-details":"",label:"Taux",items:v.value,modelValue:s.value,"onUpdate:modelValue":[d[0]||(d[0]=r=>s.value=r),n]},null,8,["items","modelValue"])):(y(),w(h,{key:1},{default:l(()=>[e(b,{cols:"12"},{default:l(()=>[e(me,{variant:"outlined",density:"compact",label:"Label",modelValue:o.value.Label,"onUpdate:modelValue":d[1]||(d[1]=r=>o.value.Label=r),disabled:o.value.Id>0,"error-messages":c.value},null,8,["modelValue","disabled","error-messages"])]),_:1}),e(b,null,{default:l(()=>[e(me,{label:`Valeur d'un ${U(Tt)[U(Et).FrancsSuisse]}`,density:"compact",variant:"outlined",type:"number",min:"0.001",suffix:"€",hint:"Valeur en € d'une unité de la monnaie.","persistent-hint":"","model-value":o.value.FrancsSuisse/1e3,"onUpdate:modelValue":d[2]||(d[2]=r=>o.value.FrancsSuisse=U(ht)(Number(r)*1e3)),disabled:o.value.Id>0},null,8,["label","model-value","disabled"])]),_:1})]),_:1}))]),_:1}),e(b,{cols:"auto"},{default:l(()=>[e(ue,{thickness:"2",vertical:"",class:"py-4"},{default:l(()=>[...d[3]||(d[3]=[g("ou",-1)])]),_:1})]),_:1}),e(b,{"align-self":"center",cols:"auto"},{default:l(()=>[e(L,{onClick:m,"prepend-icon":"mdi-toggle-switch"},{default:l(()=>[g(M(o.value.Id>0?"Créer un taux":"Utiliser un taux"),1)]),_:1})]),_:1})]),_:1}))}}),sn=K({__name:"CampStats",props:{stats:{}},setup(t){const o=t;function s(v,a){return`(${_e.pourcent(v,a)} %)`}return(v,a)=>(y(),w(O,{title:"Statut des inscriptions"},{default:l(()=>[e(B,null,{default:l(()=>[e(Ve,{density:"compact"},{default:l(()=>[e(H,{title:"Demandes d'inscriptions"},{append:l(()=>[g(M(o.stats.Inscriptions),1)]),_:1}),e(H,{title:"Filles",subtitle:"Parmi toutes les demandes d'inscription"},{append:l(()=>[g(M(o.stats.InscriptionsFilles)+" "+M(s(o.stats.InscriptionsFilles,o.stats.Inscriptions)),1)]),_:1}),e(H,{title:"Suisses",subtitle:"Parmi toutes les demandes d'inscription"},{append:l(()=>[g(M(o.stats.InscriptionsSuisses)+" "+M(s(o.stats.InscriptionsSuisses,o.stats.Inscriptions)),1)]),_:1}),e(H,{title:"Inscriptions confirmées"},{append:l(()=>[g(M(o.stats.Valides)+" "+M(s(o.stats.Valides,o.stats.Inscriptions)),1)]),_:1}),e(H,{title:"Filles",subtitle:"Parmi les inscriptions confirmées"},{append:l(()=>[g(M(o.stats.ValidesFilles)+" "+M(s(o.stats.ValidesFilles,o.stats.Valides)),1)]),_:1}),e(H,{title:"Suisses",subtitle:"Parmi les inscriptions confirmées"},{append:l(()=>[g(M(o.stats.ValidesSuisses)+" "+M(s(o.stats.ValidesSuisses,o.stats.Valides)),1)]),_:1}),e(H,{title:"A statuer"},{append:l(()=>[g(M(o.stats.AStatuer)+" "+M(s(o.stats.AStatuer,o.stats.Inscriptions)),1)]),_:1}),e(H,{title:"Demandes d'exception"},{append:l(()=>[g(M(o.stats.Exceptions)+" "+M(s(o.stats.Exceptions,o.stats.Inscriptions)),1)]),_:1}),e(H,{title:"Refus"},{append:l(()=>[g(M(o.stats.Refus)+" "+M(s(o.stats.Refus,o.stats.Inscriptions)),1)]),_:1})]),_:1})]),_:1})]),_:1}))}}),on={key:0},rn=K({__name:"CampHeaderRow",props:{camp:{}},emits:["click","edit","edit-taux","delete","show-documents","send-sondage","add-directeur"],setup(t,{emit:o}){const s=t,v=o,a=F(()=>s.camp.Stats.Inscriptions-s.camp.Stats.Valides),i=D(!1),m=F(()=>{switch(new Date(s.camp.Camp.Camp.DateDebut).getUTCMonth()+1){case 7:case 8:return"rgb(45, 185, 187)";case 9:case 10:case 11:return"rgb(190, 150, 60)";case 12:case 1:case 2:case 3:return"rgb(240, 240, 240)";case 4:case 5:case 6:default:return"rgb(190, 228, 100)"}}),n=D(!1),c=D(0),u=F(()=>{const d=s.camp.ParticipantsFiles||[];if(d.length==0)return 0;let r=0;for(const p of d)p.InscritsCount!=0&&(r+=p.UploadedCount/p.InscritsCount);return Math.round(r/d.length*100)});return(d,r)=>{const p=il;return y(),z(le,null,[e(O,{color:m.value,"no-gutters":"",onClick:r[6]||(r[6]=k=>v("click")),class:"my-1"},{default:l(()=>[e(h,{style:al({"background-color":m.value}),class:"px-1","no-gutters":"",justify:"space-between"},{default:l(()=>[e(b,null,{default:l(()=>[e(H,{title:U(Ce).label(s.camp.Camp.Camp),subtitle:`ID : ${s.camp.Camp.Camp.Id}`},null,8,["title","subtitle"])]),_:1}),e(b,{"align-self":"center"},{default:l(()=>[g(M(U(Ce).formatPlage(t.camp.Camp.Camp)),1)]),_:1}),e(b,{cols:"2","align-self":"center"},{default:l(()=>[e(je,{width:"450px",location:"left","content-class":"pa-0"},{activator:l(({props:k})=>[e(bl,se({class:"bg-white border-md border-primary"},k,{max:s.camp.Camp.Camp.Places,"model-value":s.camp.Stats.Valides,height:"36",rounded:"",color:"primary"}),{default:l(()=>[E("strong",null,[g(M(s.camp.Stats.Valides)+"/"+M(s.camp.Camp.Camp.Places)+" ",1),a.value>0?(y(),z("span",on," (+ "+M(a.value)+")",1)):Q("",!0)]),e(xe,{class:"ml-2"},{default:l(()=>[...r[12]||(r[12]=[g("mdi-account-multiple",-1)])]),_:1})]),_:1},16,["max","model-value"])]),default:l(()=>[e(sn,{stats:s.camp.Stats},null,8,["stats"])]),_:1})]),_:1}),e(b,{cols:"1","align-self":"center",class:"px-2"},{default:l(()=>[e(je,{width:"600",location:"left","content-class":"pa-0"},{activator:l(({props:k})=>[e(bl,se({class:"bg-white border-md border-primary"},k,{max:100,"model-value":u.value,height:"36",rounded:"",color:"primary"}),{default:l(()=>[E("strong",null,M(u.value)+" % ",1),e(xe,{class:"ml-2"},{default:l(()=>[...r[13]||(r[13]=[g("mdi-file-upload",-1)])]),_:1})]),_:1},16,["model-value"])]),default:l(()=>[e(O,{title:"Pièces justificatives"},{default:l(()=>[e(B,null,{default:l(()=>[e(Ve,null,{default:l(()=>[(y(!0),z(le,null,ce(s.camp.ParticipantsFiles,k=>(y(),w(H,{title:k.Title},{append:l(()=>[g(M(k.UploadedCount)+" / "+M(k.InscritsCount)+" ("+M(U(_e).pourcent(k.UploadedCount,k.InscritsCount))+" %) ",1)]),_:2},1032,["title"]))),256))]),_:1})]),_:1})]),_:1})]),_:1})]),_:1}),e(b,{cols:"1"}),e(b,{cols:"auto","align-self":"center"},{default:l(()=>[e(Se,null,{activator:l(({props:k})=>[e(L,se(k,{size:"x-small",class:"mx-1",icon:"mdi-dots-vertical"}),null,16)]),default:l(()=>[e(Ve,{density:"compact"},{default:l(()=>[e(H,{"prepend-icon":"mdi-pencil",onClick:r[0]||(r[0]=k=>v("edit"))},{default:l(()=>[...r[14]||(r[14]=[g("Modifier les paramètres",-1)])]),_:1}),e(H,{"prepend-icon":"mdi-currency-eur",onClick:r[1]||(r[1]=k=>v("edit-taux"))},{default:l(()=>[...r[15]||(r[15]=[g("Taux de conversion",-1)])]),_:1}),e(ue,{thickness:"1"}),e(H,{"prepend-icon":"mdi-mail",onClick:r[2]||(r[2]=k=>v("show-documents")),title:"Documents"}),e(ue,{thickness:"1"}),e(H,{"prepend-icon":"mdi-plus",onClick:r[3]||(r[3]=k=>n.value=!0),title:"Ajouter un directeur...",disabled:s.camp.HasDirecteur},null,8,["disabled"]),e(ue,{thickness:"1"}),e(H,{title:"Se connecter à l'espace directeur","prepend-icon":"mdi-open-in-new",href:s.camp.URLDirecteur,target:"_blank"},null,8,["href"]),e(ue,{thickness:"1"}),e(H,{title:"Envoyer le sondage",subtitle:"de fin de séjour","prepend-icon":"mdi-comment-quote",onClick:r[4]||(r[4]=k=>v("send-sondage"))}),e(ue,{thickness:"1"}),e(H,{"prepend-icon":"mdi-delete",disabled:s.camp.Stats.Inscriptions>0,onClick:r[5]||(r[5]=k=>i.value=!0)},{default:l(()=>[...r[16]||(r[16]=[g("Supprimer",-1)])]),_:1},8,["disabled"])]),_:1})]),_:1})]),_:1})]),_:1},8,["style"])]),_:1},8,["color"]),e(Z,{modelValue:i.value,"onUpdate:modelValue":r[8]||(r[8]=k=>i.value=k),"max-width":"600"},{default:l(()=>[e(O,{title:"Confirmer la suppression"},{default:l(()=>[e(B,null,{default:l(()=>[r[17]||(r[17]=g(" Etes vous certain de supprimer le séjour ",-1)),E("b",null,M(U(Ce).label(s.camp.Camp.Camp)),1),r[18]||(r[18]=g(" ? ",-1)),r[19]||(r[19]=E("br",null,null,-1)),r[20]||(r[20]=E("br",null,null,-1)),r[21]||(r[21]=g(" Les éventuels ",-1)),r[22]||(r[22]=E("i",null,"équipiers",-1)),r[23]||(r[23]=g(" déclarés sur ce séjour seront aussi supprimés. ",-1)),r[24]||(r[24]=E("br",null,null,-1)),r[25]||(r[25]=E("br",null,null,-1)),r[26]||(r[26]=g(" Attention, cette opération est irréversible. ",-1))]),_:1}),e(oe,null,{default:l(()=>[e(ie),e(L,{color:"red",onClick:r[7]||(r[7]=k=>{i.value=!1,v("delete")})},{default:l(()=>[...r[27]||(r[27]=[g("Supprimer",-1)])]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"]),e(Z,{modelValue:n.value,"onUpdate:modelValue":r[11]||(r[11]=k=>n.value=k),"max-width":"400px"},{default:l(()=>[e(O,{title:"Ajouter un directeur"},{default:l(()=>[e(B,null,{default:l(()=>[e(p,{"initial-personne":"",label:"Directeur",modelValue:c.value,"onUpdate:modelValue":r[9]||(r[9]=k=>c.value=k),api:U(x)},null,8,["modelValue","api"])]),_:1}),e(oe,null,{default:l(()=>[e(ie),e(L,{disabled:!c.value,onClick:r[10]||(r[10]=k=>{n.value=!1,v("add-directeur",c.value)})},{default:l(()=>[...r[28]||(r[28]=[g("Ajouter",-1)])]),_:1},8,["disabled"])]),_:1})]),_:1})]),_:1},8,["modelValue"])],64)}}}),bt=K({__name:"CampsSelector",props:De({allCamps:{}},{modelValue:{required:!0},modelModifiers:{}}),emits:["update:modelValue"],setup(t){const o=t,s=Pe(t,"modelValue"),v=F(()=>o.allCamps.map(a=>({title:a.Label,value:a.Id})));return(a,i)=>(y(),w(wa,{multiple:"",chips:"","closable-chips":"",items:v.value,modelValue:s.value,"onUpdate:modelValue":i[0]||(i[0]=m=>s.value=m)},null,8,["items","modelValue"]))}}),dn=K({__name:"DocumentsCard",props:{camp:{}},setup(t){const o=t;Te(v);const s=D(null);async function v(){const a=await x.CampsDocuments({idCamp:o.camp.Camp.Camp.Id});a!==void 0&&(s.value=a)}return(a,i)=>{const m=Fa;return s.value!=null?(y(),w(O,{key:0,title:"Documents"},{default:l(()=>[e(B,null,{default:l(()=>[e(Ve,null,{default:l(()=>[e(El,null,{default:l(()=>[...i[0]||(i[0]=[g("Préférences d'affichage",-1)])]),_:1}),e(H,null,{default:l(()=>[e(h,{class:"mb-2"},{default:l(()=>[e(b,null,{default:l(()=>[e(fe,{color:s.value.ToShow.LettreDirecteur?"green":"grey","append-icon":s.value.ToShow.LettreDirecteur?"mdi-check":""},{default:l(()=>[...i[1]||(i[1]=[g("Lettre du directeur",-1)])]),_:1},8,["color","append-icon"])]),_:1}),e(b,null,{default:l(()=>[e(fe,{color:s.value.ToShow.ListeVetements?"green":"grey","append-icon":s.value.ToShow.ListeVetements?"mdi-check":""},{default:l(()=>[...i[2]||(i[2]=[g(" Liste de vêtements",-1)])]),_:1},8,["color","append-icon"])]),_:1}),e(b,null,{default:l(()=>[e(fe,{color:s.value.ToShow.ListeParticipants?"green":"grey","append-icon":s.value.ToShow.ListeParticipants?"mdi-check":""},{default:l(()=>[...i[3]||(i[3]=[g("Liste des participants ",-1)])]),_:1},8,["color","append-icon"])]),_:1})]),_:1})]),_:1}),e(El,null,{default:l(()=>[...i[4]||(i[4]=[g("Documents du séjour",-1)])]),_:1}),(y(!0),z(le,null,ce(s.value.Generated,n=>(y(),w(H,{title:n.NomClient},{append:l(()=>[e(m,{"file-key":n.Key,"is-generated-doc":!0},null,8,["file-key"])]),_:2},1032,["title"]))),256)),(y(!0),z(le,null,ce(s.value.ToRead,n=>(y(),w(H,{title:n.NomClient},{append:l(()=>[e(m,{"file-key":n.Key,"is-generated-doc":!1},null,8,["file-key"])]),_:2},1032,["title"]))),256)),(y(!0),z(le,null,ce(s.value.ToUploadModeles,n=>(y(),w(H,{title:n.NomClient,subtitle:"Document à remplir"},{append:l(()=>[e(m,{"file-key":n.Key,"is-generated-doc":!1},null,8,["file-key"])]),_:2},1032,["title"]))),256))]),_:1})]),_:1})]),_:1})):(y(),w(Ge,{key:1,type:"card"}))}}}),mn={key:0,class:"text-center my-4"},cn=K({__name:"JoomeoPannel",emits:["save"],setup(t,{emit:o}){Te(a);const s=D(null),v=D([]);async function a(){const p=await x.CampsLoadAlbums();p!==void 0&&(s.value=p||[],v.value=[])}function i(p){return s.value.find(k=>k.Camp.Id==p)}const m=D(!1),n=F(()=>m.value||!v.value.length||!s.value?!1:v.value.every(p=>i(p).Camp.JoomeoID==""));async function c(){m.value=!0;const p=await x.CampsCreateAlbums({IdCamps:v.value});m.value=!1,p!==void 0&&(Il(p).forEach(([k,I])=>{i(k).Album=I}),x.showMessage("Albums Joomeo créés avec succès."))}const u=F(()=>m.value||!v.value.length||!s.value?!1:v.value.every(p=>i(p).Camp.JoomeoID!=""&&i(p).HasDirecteur));async function d(){m.value=!0;const p=await x.CampsAddDirecteursToAlbums({IdCamps:v.value,SendMail:!0});m.value=!1,p!==void 0&&(Il(p).forEach(([k,I])=>{i(k).DirecteurPermission=I}),x.showMessage("Directeurs ajoutés avec succès."))}function r(p){return p.type==1&&p.albumAccessRules.allowDownload&&p.albumAccessRules.allowUpload&&p.accessRules.allowDeleteFile&&p.accessRules.allowEditFileCaption}return(p,k)=>(y(),w(O,{title:"Albums Joomeo",subtitle:"Seuls les camps en cours sont affichés."},{append:l(()=>[e(L,{disabled:!n.value,onClick:c},{prepend:l(()=>[e(xe,{color:"green"},{default:l(()=>[...k[1]||(k[1]=[g("mdi-plus",-1)])]),_:1})]),default:l(()=>[k[2]||(k[2]=g(" Créer les albums",-1))]),_:1},8,["disabled"]),e(L,{disabled:!u.value,onClick:d,class:"ml-2","prepend-icon":"mdi-account-eye"},{default:l(()=>[...k[3]||(k[3]=[g(" Ajouter les directeurs",-1)])]),_:1},8,["disabled"])]),default:l(()=>[m.value?(y(),w(bl,{key:0,indeterminate:""})):Q("",!0),e(B,null,{default:l(()=>[s.value==null?(y(),z("div",mn,[e(Nt,{indeterminate:""})])):(y(),w(Ve,{key:1,selected:v.value,"onUpdate:selected":k[0]||(k[0]=I=>v.value=I),"select-strategy":"leaf"},{default:l(()=>[(y(!0),z(le,null,ce(s.value,I=>(y(),w(H,{value:I.Camp.Id,title:U(Ce).label(I.Camp),rounded:"",class:"my-1"},{append:l(()=>[e(h,null,{default:l(()=>[e(b,null,{default:l(()=>[e(fe,{color:I.Album.Id?"primary":void 0},{default:l(()=>[I.Album.Id?(y(),w(je,{key:0,activator:"parent","content-class":"pa-0"},{default:l(()=>[e(O,{title:"Album Joomeo","min-width":"400px"},{default:l(()=>[e(B,null,{default:l(()=>[e(h,null,{default:l(()=>[e(b,{cols:"auto"},{default:l(()=>[...k[4]||(k[4]=[g("Nom",-1)])]),_:1}),e(b,{class:"text-right"},{default:l(()=>[g(M(I.Album.Label),1)]),_:2},1024)]),_:2},1024),e(h,null,{default:l(()=>[e(b,{cols:"auto"},{default:l(()=>[...k[5]||(k[5]=[g("ID",-1)])]),_:1}),e(b,{class:"text-right"},{default:l(()=>[g(M(I.Album.Id),1)]),_:2},1024)]),_:2},1024),e(h,null,{default:l(()=>[e(b,{cols:"auto"},{default:l(()=>[...k[6]||(k[6]=[g("Date de création",-1)])]),_:1}),e(b,{class:"text-right"},{default:l(()=>[g(M(new Date(I.Album.Date).toLocaleDateString("fr")),1)]),_:2},1024)]),_:2},1024),e(h,null,{default:l(()=>[e(b,{cols:"auto"},{default:l(()=>[...k[7]||(k[7]=[g("Nombre de photos",-1)])]),_:1}),e(b,{class:"text-right"},{default:l(()=>[g(M(I.Album.FilesCount),1)]),_:2},1024)]),_:2},1024)]),_:2},1024)]),_:2},1024)]),_:2},1024)):Q("",!0),g(" "+M(I.Album.Id==""?"Pas d'album":`Album créé le ${U(_e).date(I.Album.Date)}`),1)]),_:2},1032,["color"])]),_:2},1024),I.Album.Id?(y(),w(b,{key:0},{default:l(()=>[e(fe,{color:I.HasDirecteur?I.DirecteurPermission.contactid!=""?"green":"orange":"red"},{default:l(()=>[I.DirecteurPermission.contactid?(y(),w(je,{key:0,activator:"parent","content-class":"pa-0"},{default:l(()=>[e(O,{title:"Accès à l'album",subtitle:"Le directeur a accès à l'album."},{default:l(()=>[e(B,null,{default:l(()=>[e(h,null,{default:l(()=>[e(b,null,{default:l(()=>[...k[8]||(k[8]=[g("Email",-1)])]),_:1}),e(b,{class:"text-right"},{default:l(()=>[g(M(I.DirecteurPermission.email),1)]),_:2},1024)]),_:2},1024),e(h,null,{default:l(()=>[e(b,null,{default:l(()=>[...k[9]||(k[9]=[g("Login",-1)])]),_:1}),e(b,{class:"text-right"},{default:l(()=>[g(M(I.DirecteurPermission.login),1)]),_:2},1024)]),_:2},1024),e(h,null,{default:l(()=>[e(b,null,{default:l(()=>[...k[10]||(k[10]=[g("Mot de passe",-1)])]),_:1}),e(b,{class:"text-right"},{default:l(()=>[g(M(I.DirecteurPermission.password),1)]),_:2},1024)]),_:2},1024),e(h,null,{default:l(()=>[e(b,null,{default:l(()=>[...k[11]||(k[11]=[g("Permissions (écriture)",-1)])]),_:1}),e(b,{class:"text-right"},{default:l(()=>[e(xe,{icon:r(I.DirecteurPermission)?"mdi-check":"mdi-warning",color:r(I.DirecteurPermission)?"green":"orange"},null,8,["icon","color"])]),_:2},1024)]),_:2},1024)]),_:2},1024)]),_:2},1024)]),_:2},1024)):Q("",!0),g(" "+M(I.HasDirecteur?I.DirecteurPermission.contactid!=""?"Directeur ajouté":"Directeur à ajouter":"Aucun directeur"),1)]),_:2},1032,["color"])]),_:2},1024)):Q("",!0)]),_:2},1024)]),_:2},1032,["value","title"]))),256))]),_:1},8,["selected"]))]),_:1}),e(oe,null,{default:l(()=>[e(ie)]),_:1})]),_:1}))}});function vn(){const t=D([]);Ot(()=>t.value=[]);function o(s,v){t.value[v]=s}return{refs:t,updateRef:o}}const pn=Re({activeColor:String,start:{type:[Number,String],default:1},modelValue:{type:Number,default:t=>t.start},disabled:Boolean,length:{type:[Number,String],default:1,validator:t=>t%1===0},totalVisible:[Number,String],firstIcon:{type:Be,default:"$first"},prevIcon:{type:Be,default:"$prev"},nextIcon:{type:Be,default:"$next"},lastIcon:{type:Be,default:"$last"},ariaLabel:{type:String,default:"$vuetify.pagination.ariaLabel.root"},pageAriaLabel:{type:String,default:"$vuetify.pagination.ariaLabel.page"},currentPageAriaLabel:{type:String,default:"$vuetify.pagination.ariaLabel.currentPage"},firstAriaLabel:{type:String,default:"$vuetify.pagination.ariaLabel.first"},previousAriaLabel:{type:String,default:"$vuetify.pagination.ariaLabel.previous"},nextAriaLabel:{type:String,default:"$vuetify.pagination.ariaLabel.next"},lastAriaLabel:{type:String,default:"$vuetify.pagination.ariaLabel.last"},ellipsis:{type:String,default:"..."},showFirstLastPage:Boolean,...Xt(),...Kt(),...Gt(),...Jt(),...Wt(),...Qt(),...zt({tag:"nav"}),...Yt(),...Ht({variant:"text"})},"VPagination"),fn=Le()({name:"VPagination",props:pn(),emits:{"update:modelValue":t=>!0,first:t=>!0,prev:t=>!0,next:t=>!0,last:t=>!0},setup(t,o){let{slots:s,emit:v}=o;const a=Ue(t,"modelValue"),{t:i,n:m}=Ke(),{isRtl:n}=et(),{themeClasses:c}=Bt(t),{width:u}=jt(),d=ll(-1);Al(void 0,{scoped:!0});const{resizeRef:r}=qt(W=>{if(!W.length)return;const{target:A,contentRect:te}=W[0],ne=A.querySelector(".v-pagination__list > *");if(!ne)return;const N=te.width,q=ne.offsetWidth+parseFloat(getComputedStyle(ne).marginRight)*2;d.value=_(N,q)}),p=F(()=>parseInt(t.length,10)),k=F(()=>parseInt(t.start,10)),I=F(()=>t.totalVisible!=null?parseInt(t.totalVisible,10):d.value>=0?d.value:_(u.value,58));function _(W,A){const te=t.showFirstLastPage?5:3;return Math.max(0,Math.floor(Number(((W-A*te)/A).toFixed(2))))}const C=F(()=>{if(p.value<=0||isNaN(p.value)||p.value>Number.MAX_SAFE_INTEGER)return[];if(I.value<=0)return[];if(I.value===1)return[a.value];if(p.value<=I.value)return Ee(p.value,k.value);const W=I.value%2===0,A=W?I.value/2:Math.floor(I.value/2),te=W?A:A+1,ne=p.value-A;if(te-a.value>=0)return[...Ee(Math.max(1,I.value-1),k.value),t.ellipsis,p.value];if(a.value-ne>=(W?1:0)){const N=I.value-1,q=p.value-N+k.value;return[k.value,t.ellipsis,...Ee(N,q)]}else{const N=Math.max(1,I.value-2),q=N===1?a.value:a.value-Math.ceil(N/2)+k.value;return[k.value,t.ellipsis,...Ee(N,q),t.ellipsis,p.value]}});function P(W,A,te){W.preventDefault(),a.value=A,te&&v(te,A)}const{refs:j,updateRef:G}=vn();Al({VPaginationBtn:{color:Fe(()=>t.color),border:Fe(()=>t.border),density:Fe(()=>t.density),size:Fe(()=>t.size),variant:Fe(()=>t.variant),rounded:Fe(()=>t.rounded),elevation:Fe(()=>t.elevation)}});const S=F(()=>C.value.map((W,A)=>{const te=ne=>G(ne,A);if(typeof W=="string")return{isActive:!1,key:`ellipsis-${A}`,page:W,props:{ref:te,ellipsis:!0,icon:!0,disabled:!0}};{const ne=W===a.value;return{isActive:ne,key:W,page:m(W),props:{ref:te,ellipsis:!1,icon:!0,disabled:!!t.disabled||Number(t.length)<2,color:ne?t.activeColor:t.color,"aria-current":ne,"aria-label":i(ne?t.currentPageAriaLabel:t.pageAriaLabel,W),onClick:N=>P(N,W)}}}})),f=F(()=>{const W=!!t.disabled||a.value<=k.value,A=!!t.disabled||a.value>=k.value+p.value-1;return{first:t.showFirstLastPage?{icon:n.value?t.lastIcon:t.firstIcon,onClick:te=>P(te,k.value,"first"),disabled:W,"aria-label":i(t.firstAriaLabel),"aria-disabled":W}:void 0,prev:{icon:n.value?t.nextIcon:t.prevIcon,onClick:te=>P(te,a.value-1,"prev"),disabled:W,"aria-label":i(t.previousAriaLabel),"aria-disabled":W},next:{icon:n.value?t.prevIcon:t.nextIcon,onClick:te=>P(te,a.value+1,"next"),disabled:A,"aria-label":i(t.nextAriaLabel),"aria-disabled":A},last:t.showFirstLastPage?{icon:n.value?t.firstIcon:t.lastIcon,onClick:te=>P(te,k.value+p.value-1,"last"),disabled:A,"aria-label":i(t.lastAriaLabel),"aria-disabled":A}:void 0}});function ee(){const W=a.value-k.value;j.value[W]?.$el.focus()}function ye(W){W.key===Ml.left&&!t.disabled&&a.value>Number(t.start)?(a.value=a.value-1,$l(ee)):W.key===Ml.right&&!t.disabled&&a.value<k.value+p.value-1&&(a.value=a.value+1,$l(ee))}return he(()=>e(t.tag,{ref:r,class:ke(["v-pagination",c.value,t.class]),style:al(t.style),role:"navigation","aria-label":i(t.ariaLabel),onKeydown:ye,"data-test":"v-pagination-root"},{default:()=>[E("ul",{class:"v-pagination__list"},[t.showFirstLastPage&&E("li",{key:"first",class:"v-pagination__first","data-test":"v-pagination-first"},[s.first?s.first(f.value.first):e(L,se({_as:"VPaginationBtn"},f.value.first),null)]),E("li",{key:"prev",class:"v-pagination__prev","data-test":"v-pagination-prev"},[s.prev?s.prev(f.value.prev):e(L,se({_as:"VPaginationBtn"},f.value.prev),null)]),S.value.map((W,A)=>E("li",{key:W.key,class:ke(["v-pagination__item",{"v-pagination__item--is-active":W.isActive}]),"data-test":"v-pagination-item"},[s.item?s.item(W):e(L,se({_as:"VPaginationBtn"},W.props),{default:()=>[W.page]})])),E("li",{key:"next",class:"v-pagination__next","data-test":"v-pagination-next"},[s.next?s.next(f.value.next):e(L,se({_as:"VPaginationBtn"},f.value.next),null)]),t.showFirstLastPage&&E("li",{key:"last",class:"v-pagination__last","data-test":"v-pagination-last"},[s.last?s.last(f.value.last):e(L,se({_as:"VPaginationBtn"},f.value.last),null)])])]})),{}}}),yn={key:2},yl=16,bn=K({__name:"CampsList",emits:["show-participants"],setup(t,{emit:o}){const s=o;Te(d);const v=gl(new Map),a=D(!1),i=gl({pattern:"",openOnly:!1}),m=F(()=>{const J=new Set,V=new Set;for(const $ of v.values())for(const R of Object.entries($.Camp.Camp.Meta||{}))J.add(R[0]),V.add(R[1]);return{keys:Array.from(J.keys()).sort(),values:Array.from(V.keys()).sort()}}),n=F(()=>{const J=at(i.pattern),V=Array.from(v.values()).filter($=>Ce.match($.Camp.Camp,J)&&(!i.openOnly||Tl($.Camp)));return V.sort(($,R)=>{const pe=new Date(R.Camp.Camp.DateDebut).valueOf(),ae=new Date($.Camp.Camp.DateDebut).valueOf();return pe==ae?$.Camp.Camp.Id-R.Camp.Camp.Id:pe-ae}),V}),c=F(()=>n.value.slice((k.value-1)*yl,k.value*yl));function u(){k.value>p.value&&(k.value=p.value)}async function d(){a.value=!0;const J=await x.CampsGet();a.value=!1,J!==void 0&&(v.clear(),J?.forEach(V=>v.set(V.Camp.Camp.Id,V)))}async function r(){a.value=!0;const J=await x.CampsCreate();a.value=!1,J!==void 0&&(x.showMessage("Camp ajouté avec succès."),v.set(J.Camp.Camp.Id,J),I.value=J)}const p=F(()=>Math.max(Math.ceil(n.value.length/yl),1)),k=D(1),I=D(null);async function _(J){I.value=null,a.value=!0;const V=await x.CampsUpdate(J);a.value=!1,V!==void 0&&(x.showMessage("Séjour modifié avec succès."),v.get(V.Camp.Id).Camp=V,u())}const C=D(null);async function P(){const J=C.value;if(J==null)return;C.value=null,a.value=!0;const V=await x.CampsSetTaux({IdCamp:J.Camp.Camp.Id,Taux:J.Taux});if(a.value=!1,V===void 0)return;x.showMessage("Taux modifié avec succès.");const $=v.get(J.Camp.Camp.Id);$.Camp.Camp.IdTaux=V.Id,$.Taux=V}const j=D(!1),G=D(5),S=D({Id:1,Label:"",Euros:0,FrancsSuisse:0}),f=F(()=>S.value.Id>0||S.value.Label!=""),ee=F(()=>new Set(Array.from(v.values()).filter(V=>Tl(V.Camp)).map(V=>V.Camp.Camp.IdTaux)).size<=1);async function ye(){j.value=!1,a.value=!0;const J=await x.CampsCreateMany({Count:G.value,Taux:S.value});a.value=!1,J!==void 0&&(x.showMessage("Séjours créés avec succès."),J?.forEach(V=>v.set(V.Camp.Camp.Id,V)))}async function W(J){a.value=!0;const V=await x.CampsDelete({id:J.Camp.Camp.Id});a.value=!1,V!==void 0&&(x.showMessage("Séjour supprimé avec succès."),v.delete(J.Camp.Camp.Id),u())}const A=D(!1);function te(){ne.value=Array.from(v.values()).filter(J=>J.Camp.Camp.Statut!=ea.Ouvert).map(J=>J.Camp.Camp.Id),A.value=!0}const ne=D([]);async function N(){A.value=!1,!(!ne.value.length||await x.CampsOuvreInscriptions({Camps:ne.value})===void 0)&&(x.showMessage("Séjours ouverts aux inscriptions avec succès."),d())}const q=D(null),re=D(null);async function X(J){re.value={Current:0,Total:10};const V=await x.EventsSendSondages({idCamp:J});if(V===void 0){re.value=null;return}await Vl(V,$=>re.value=$,$=>x.onError("Envoi du sondage",$)),re.value=null,x.showMessage("Sondage envoyé avec succès.")}async function be(J,V){await x.CampsCreateEquipier({IdPersonne:J,IdCamp:V,Roles:[la.Direction]})!==void 0&&(v.get(V).HasDirecteur=!0,x.showMessage("Directeur ajouté avec succès."))}const ge=D(!1);return(J,V)=>{const $=Xe;return y(),z(le,null,[e(O,{title:"Séjours",subtitle:v.size},{append:l(()=>[e(h,null,{default:l(()=>[e(b,{"align-self":"center",style:{width:"240px"}},{default:l(()=>[e(me,{label:"Rechercher",variant:"filled",density:"comfortable","hide-details":"","prepend-inner-icon":"mdi-magnify",clearable:"",modelValue:i.pattern,"onUpdate:modelValue":[V[0]||(V[0]=R=>i.pattern=R),V[2]||(V[2]=R=>u())],"onClick:clear":V[1]||(V[1]=R=>{i.pattern="",u()})},null,8,["modelValue"])]),_:1}),e(ue,{vertical:"",thickness:"1"}),e(b,{"align-self":"center",cols:"auto"},{default:l(()=>[e(Se,null,{activator:l(({props:R})=>[e(L,se(R,{color:"success",disabled:a.value,"prepend-icon":"mdi-plus"}),{default:l(()=>[...V[17]||(V[17]=[g(" Créer un séjour ",-1)])]),_:1},16,["disabled"])]),default:l(()=>[e(Ve,{density:"compact"},{default:l(()=>[e(H,{onClick:r,title:"Créer un séjour"}),e(H,{title:"Créer plusieurs séjours...",subtitle:"Permet de choisir les taux de conversion",onClick:V[3]||(V[3]=R=>j.value=!0)})]),_:1})]),_:1})]),_:1}),e(b,{"align-self":"center",cols:"auto"},{default:l(()=>[e(L,{flat:"",icon:"",size:"small"},{default:l(()=>[e(xe,{icon:"mdi-dots-vertical"}),e(Se,{activator:"parent"},{default:l(()=>[e(Ve,{density:"compact"},{default:l(()=>[e(H,{title:"Masquer les camps fermés",subtitle:"N'afficher que les camps ouverts aux inscriptions",onClick:V[5]||(V[5]=R=>i.openOnly=!i.openOnly)},{prepend:l(()=>[e(ze,{class:"mr-2",modelValue:i.openOnly,"onUpdate:modelValue":V[4]||(V[4]=R=>i.openOnly=R),density:"compact","hide-details":""},null,8,["modelValue"])]),_:1}),e(ue,{thickness:"1"}),e(H,{onClick:te,title:"Ouvrir les inscriptions...",subtitle:"sur plusieurs séjours","prepend-icon":"mdi-lock-open"}),e(ue,{thickness:"1"}),e(H,{"prepend-icon":"mdi-file-excel",title:"Exporter",subtitle:"Participants de l'année courante (format Excel)",link:"",href:U(x).CampsDownloadParticipants(new Date().getFullYear(),U(x).authToken)},null,8,["href"])]),_:1})]),_:1})]),_:1})]),_:1})]),_:1})]),default:l(()=>[e(B,{class:"mt-4"},{default:l(()=>[ee.value?Q("",!0):(y(),w(Zt,{key:0,type:"warning"},{default:l(()=>[...V[18]||(V[18]=[g(" Attention, les séjours ouverts aux inscriptions ont des taux de conversion incompatibles ! ",-1)])]),_:1})),a.value?(y(),w(Ge,{key:1})):n.value.length==0?(y(),z("i",yn," Aucun camp ne correspond aux filtres actuels. ")):Q("",!0),(y(!0),z(le,null,ce(c.value,(R,pe)=>(y(),w(rn,{key:pe,camp:R,onClick:ae=>s("show-participants",R),onEdit:ae=>I.value=R,onEditTaux:ae=>C.value=R,onDelete:ae=>W(R),onShowDocuments:ae=>q.value=R,onSendSondage:ae=>X(R.Camp.Camp.Id),onAddDirecteur:ae=>be(ae,R.Camp.Camp.Id)},null,8,["camp","onClick","onEdit","onEditTaux","onDelete","onShowDocuments","onSendSondage","onAddDirecteur"]))),128)),e(fn,{length:p.value,modelValue:k.value,"onUpdate:modelValue":V[6]||(V[6]=R=>k.value=R)},null,8,["length","modelValue"])]),_:1})]),_:1},8,["subtitle"]),e(Z,{"model-value":I.value!=null,"onUpdate:modelValue":V[7]||(V[7]=R=>I.value=null),"max-width":"800px"},{default:l(()=>[I.value!=null?(y(),w(un,{key:0,camp:I.value.Camp.Camp,"preselection-url":I.value.URLPreselection,"meta-entries-hints":m.value,onSave:_},null,8,["camp","preselection-url","meta-entries-hints"])):Q("",!0)]),_:1},8,["model-value"]),e(Z,{"model-value":C.value!=null,"onUpdate:modelValue":V[9]||(V[9]=R=>C.value=null),"max-width":"600"},{default:l(()=>[C.value!=null?(y(),w(O,{key:0,title:"Modifier le taux",subtitle:"La modification n'est possible que si aucun participant n'est enregistré."},{default:l(()=>[e(B,null,{default:l(()=>[e(Ql,{modelValue:C.value.Taux,"onUpdate:modelValue":V[8]||(V[8]=R=>C.value.Taux=R)},null,8,["modelValue"])]),_:1}),e(oe,null,{default:l(()=>[e(ie),e(L,{disabled:C.value.Stats.Inscriptions>0,onClick:P},{default:l(()=>[...V[19]||(V[19]=[g("Modifier",-1)])]),_:1},8,["disabled"])]),_:1})]),_:1})):Q("",!0)]),_:1},8,["model-value"]),e(Z,{modelValue:j.value,"onUpdate:modelValue":V[12]||(V[12]=R=>j.value=R),"max-width":"600"},{default:l(()=>[e(O,{title:"Créer plusieurs séjours",subtitle:"Les séjours seront liés au même taux de conversion"},{default:l(()=>[e(B,null,{default:l(()=>[e(h,null,{default:l(()=>[e(b,null,{default:l(()=>[e($,{label:"Nombre de séjours",modelValue:G.value,"onUpdate:modelValue":V[10]||(V[10]=R=>G.value=R)},null,8,["modelValue"])]),_:1})]),_:1}),e(ue,{thickness:"2",class:"my-2"}),e(Ql,{modelValue:S.value,"onUpdate:modelValue":V[11]||(V[11]=R=>S.value=R)},null,8,["modelValue"])]),_:1}),e(oe,null,{default:l(()=>[e(ie),e(L,{color:"success",onClick:ye,disabled:!f.value},{default:l(()=>[...V[20]||(V[20]=[g("Créer",-1)])]),_:1},8,["disabled"])]),_:1})]),_:1})]),_:1},8,["modelValue"]),e(Z,{modelValue:A.value,"onUpdate:modelValue":V[14]||(V[14]=R=>A.value=R),"max-width":"600"},{default:l(()=>[e(O,{title:"Ouvrir les inscriptions",subtitle:"Ouvre les inscriptions sur les séjours ci-dessous"},{default:l(()=>[e(B,null,{default:l(()=>[e(bt,{"all-camps":Array.from(v.values()).map(R=>U(Ce).toItem(R.Camp)),modelValue:ne.value,"onUpdate:modelValue":V[13]||(V[13]=R=>ne.value=R)},null,8,["all-camps","modelValue"])]),_:1}),e(oe,null,{default:l(()=>[e(ie),e(L,{onClick:N,disabled:!ne.value.length},{default:l(()=>[...V[21]||(V[21]=[g("Ouvrir",-1)])]),_:1},8,["disabled"])]),_:1})]),_:1})]),_:1},8,["modelValue"]),e(Z,{"model-value":q.value!=null,"onUpdate:modelValue":V[15]||(V[15]=R=>q.value=null),"max-width":"800px"},{default:l(()=>[q.value?(y(),w(dn,{key:0,camp:q.value},null,8,["camp"])):Q("",!0)]),_:1},8,["model-value"]),e(Z,{"model-value":re.value!=null,"max-width":"400px",persistent:""},{default:l(()=>[re.value?(y(),w(_l,{key:0,title:"Envoi du sondage en cours",current:re.value.Current,total:re.value.Total},null,8,["current","total"])):Q("",!0)]),_:1},8,["model-value"]),e(Z,{modelValue:ge.value,"onUpdate:modelValue":V[16]||(V[16]=R=>ge.value=R)},{default:l(()=>[e(cn)]),_:1},8,["modelValue"])],64)}}}),gn={key:1},Vn={key:0,class:"text-center font-italic"},kn=K({__name:"CampParticipants",props:{id:{},idParticipant:{}},setup(t){const o=t;Te(async()=>{a(),await n(),c()}),Ae(()=>o.id,n),Ae(()=>o.idParticipant,c);const s=D(!1),v=D([]);async function a(){const S=await x.GetCamps();S!==void 0&&(v.value=S||[])}const i=F(()=>{const S=(m.value?.Participants||[]).map(f=>f);return S.sort(ta.cmp),S}),m=D(null);async function n(){s.value=!0;const S=await x.CampsLoad({idCamp:o.id});s.value=!1,S!==void 0&&(m.value=S)}function c(){if(o.idParticipant===void 0)return;const S=(m.value?.Participants||[]).find(f=>f.Participant.Id==o.idParticipant);S&&(r.value=we(S))}const u=D(null);async function d(){if(u.value==null||m.value==null)return;const S=await x.ParticipantsCreate(u.value);u.value=null,S!==void 0&&(x.showMessage("Participant créé avec succès."),m.value.Participants=(m.value.Participants||[]).concat(S),r.value=we(S))}const r=D(null);async function p(S){if(r.value==null||m.value==null)return;const f=await x.ParticipantsUpdate(S);r.value=null,f!==void 0&&(x.showMessage("Participant modifié avec succès."),n())}const k=D(null);async function I(){if(k.value==null||m.value==null)return;const S=k.value.Participant.Id,f=await x.ParticipantsDelete({id:S});k.value=null,f!==void 0&&(x.showMessage("Participant supprimé avec succès."),m.value.Participants=(m.value.Participants||[]).filter(ee=>ee.Participant.Id!=S))}const _=D(null);async function C(){const S=_.value;S==null||m.value==null||(_.value=null,await x.ParticipantsMove(S)===void 0)||(x.showMessage("Participant déplacé avec succès.",void 0,{title:"Aller au nouveau séjour",action:()=>Dl({IdCamp:S.Target,Id:S.Id})}),m.value.Participants=(m.value.Participants||[]).filter(ee=>ee.Participant.Id!=S.Id))}const P=D(null);async function j(){if(P.value==null)return;const S=P.value.Participant.Id;P.value=null;const f=await x.ParticipantsSetPlaceLiberee({id:S});if(f===void 0||(x.showMessage("Notification de place libérée envoyée avec succès."),m.value==null))return;const ee=m.value.Participants?.find(ye=>ye.Participant.Id==S);ee.Participant=f}const G=D(!1);return(S,f)=>{const ee=Da,ye=Aa,W=il,A=ut,te=Sa,ne=sl,N=Ia;return m.value!=null?(y(),w(O,{key:0,title:"Participants",subtitle:U(Ce).label(m.value.Camp.Camp)},{append:l(()=>[e(L,{color:"green",onClick:f[0]||(f[0]=q=>u.value={IdCamp:o.id,IdDossier:0,IdPersonne:0}),"prepend-icon":"mdi-plus"},{default:l(()=>[...f[11]||(f[11]=[g(" Ajouter un participant",-1)])]),_:1}),e(ue,{thickness:"1",class:"mx-1"}),e(L,{icon:"",size:"small",flat:""},{default:l(()=>[e(xe,null,{default:l(()=>[...f[12]||(f[12]=[g("mdi-dots-vertical",-1)])]),_:1}),e(Se,{activator:"parent"},{default:l(()=>[e(Ve,null,{default:l(()=>[e(H,{"prepend-icon":"mdi-currency-eur",title:"Suivi du règlement",onClick:f[1]||(f[1]=q=>G.value=!0)})]),_:1})]),_:1})]),_:1})]),default:l(()=>[e(B,{class:"mt-4"},{default:l(()=>[s.value?(y(),w(Ge,{key:0,type:"table"})):(y(),z("div",gn,[e(ee),i.value.length?Q("",!0):(y(),z("div",Vn," Aucun participant n'est encore inscrit sur ce séjour. ")),(y(!0),z(le,null,ce(i.value,(q,re)=>(y(),w(ye,{participant:q,index:re},{actions:l(()=>[e(Ve,{density:"comfortable"},{default:l(()=>[e(H,{title:"Modifier","prepend-icon":"mdi-pencil",onClick:X=>r.value=q},null,8,["onClick"]),e(ue),e(H,{title:"Changer de camp...","prepend-icon":"mdi-file-move",onClick:X=>_.value={Id:q.Participant.Id,Target:0}},null,8,["onClick"]),e(H,{title:"Notifier d'une place disponible.",subtitle:"Envoi un email","prepend-icon":"mdi-email-alert",disabled:q.Participant.Statut==U(tl).Inscrit||q.Participant.Statut==U(tl).EnAttenteReponse,onClick:X=>P.value=q},null,8,["disabled","onClick"]),e(ue),e(H,{title:"Aller à la personne",subtitle:`(ID : ${q.Personne.Id})`,onClick:X=>U(We)(q.Personne.Id)},null,8,["subtitle","onClick"]),e(H,{title:"Aller au dossier",subtitle:`(ID : ${q.Participant.IdDossier})`,onClick:X=>U(Cl)(q.Participant.IdDossier)},null,8,["subtitle","onClick"]),e(ue),e(H,{title:"Supprimer","prepend-icon":"mdi-delete",onClick:X=>k.value=q},null,8,["onClick"])]),_:2},1024)]),_:2},1032,["participant","index"]))),256))]))]),_:1}),u.value!=null?(y(),w(Z,{key:0,"model-value":u.value!=null,"onUpdate:modelValue":f[4]||(f[4]=q=>u.value=null),"max-width":"600px"},{default:l(()=>[e(O,{title:"Créer un participant"},{default:l(()=>[e(B,null,{default:l(()=>[e(h,null,{default:l(()=>[e(b,{cols:"12"},{default:l(()=>[e(W,{label:"Participant",modelValue:u.value.IdPersonne,"onUpdate:modelValue":f[2]||(f[2]=q=>u.value.IdPersonne=q),"initial-personne":"",api:{SelectPersonne:U(x).SelectPersonne.bind(U(x))}},null,8,["modelValue","api"])]),_:1}),e(b,{cols:"12"},{default:l(()=>[e(A,{modelValue:u.value.IdDossier,"onUpdate:modelValue":f[3]||(f[3]=q=>u.value.IdDossier=q)},null,8,["modelValue"])]),_:1})]),_:1})]),_:1}),e(oe,null,{default:l(()=>[e(ie),e(L,{color:"green",onClick:d,disabled:!(u.value.IdDossier&&u.value.IdPersonne)},{default:l(()=>[...f[13]||(f[13]=[g("Créer",-1)])]),_:1},8,["disabled"])]),_:1})]),_:1})]),_:1},8,["model-value"])):Q("",!0),r.value!=null?(y(),w(Z,{key:1,"model-value":r.value!=null,"onUpdate:modelValue":f[5]||(f[5]=q=>r.value=null),"max-width":"800px"},{default:l(()=>[e(te,{participant:r.value.Participant,personne:r.value.Personne,api:{SelectPersonne:U(x).SelectPersonne.bind(U(x))},onSave:p},null,8,["participant","personne","api"])]),_:1},8,["model-value"])):Q("",!0),k.value!=null?(y(),w(Z,{key:2,"model-value":k.value!=null,"onUpdate:modelValue":f[6]||(f[6]=q=>k.value=null),"max-width":"600px"},{default:l(()=>[e(O,{title:"Supprimer le participant"},{default:l(()=>[e(B,null,{default:l(()=>[f[14]||(f[14]=g(" Confirmez-vous la suppression du participant ",-1)),E("b",null,M(U(Ne).label(k.value.Personne)),1),f[15]||(f[15]=g(" ? ",-1)),f[16]||(f[16]=E("br",null,null,-1)),f[17]||(f[17]=E("br",null,null,-1)),f[18]||(f[18]=g(" Attention, cette opération est irréversible. ",-1))]),_:1}),e(oe,null,{default:l(()=>[e(ie),e(L,{color:"red",onClick:I},{default:l(()=>[...f[19]||(f[19]=[g("Supprimer",-1)])]),_:1})]),_:1})]),_:1})]),_:1},8,["model-value"])):Q("",!0),_.value!=null?(y(),w(Z,{key:3,"model-value":_.value!=null,"onUpdate:modelValue":f[8]||(f[8]=q=>_.value=null),"max-width":"500px"},{default:l(()=>[e(O,{title:"Déplacer le participant"},{default:l(()=>[e(B,null,{default:l(()=>[e(ne,{label:"Nouveau séjour",camps:v.value,modelValue:_.value.Target,"onUpdate:modelValue":f[7]||(f[7]=q=>_.value.Target=q)},null,8,["camps","modelValue"])]),_:1}),e(oe,null,{default:l(()=>[e(ie),e(L,{onClick:C,disabled:_.value.Target==o.id||!_.value.Target},{default:l(()=>[...f[20]||(f[20]=[g("Déplacer",-1)])]),_:1},8,["disabled"])]),_:1})]),_:1})]),_:1},8,["model-value"])):Q("",!0),P.value!=null?(y(),w(Z,{key:4,"model-value":P.value!=null,"onUpdate:modelValue":f[9]||(f[9]=q=>P.value=null),"max-width":"500px"},{default:l(()=>[e(O,{title:"Notifier d'une place disponible"},{default:l(()=>[e(B,null,{default:l(()=>[g(" Confirmez-vous l'envoi d'une notification au responsable de "+M(U(Ne).label(P.value.Personne))+" indiquant qu'une place est disponible ? ",1),f[21]||(f[21]=E("br",null,null,-1)),f[22]||(f[22]=E("br",null,null,-1)),g(" Le nouveau statut de "+M(P.value.Personne.Prenom)+" sera : ",1),E("i",null,M(U(aa)[U(tl).EnAttenteReponse]),1),f[23]||(f[23]=g(". ",-1))]),_:1}),e(oe,null,{default:l(()=>[e(ie),e(L,{onClick:j},{default:l(()=>[...f[24]||(f[24]=[g("Notifier",-1)])]),_:1})]),_:1})]),_:1})]),_:1},8,["model-value"])):Q("",!0),e(Z,{modelValue:G.value,"onUpdate:modelValue":f[10]||(f[10]=q=>G.value=q),"max-width":"700px"},{default:l(()=>[e(N,{data:m.value},null,8,["data"])]),_:1},8,["modelValue"])]),_:1},8,["subtitle"])):(y(),w(Ge,{key:1,type:"card"}))}}}),_n=K({__name:"camps",setup(t){const o=ul(),s=F(()=>Vu(o.currentRoute.value.query)),v=F(()=>s.value.idCamp);function a(m){const n=o.currentRoute.value;o.push({path:n.path,query:{idCamp:m.Camp.Camp.Id}})}function i(){const m=o.currentRoute.value;o.push({path:m.path,query:{}})}return(m,n)=>(y(),z(le,null,[e(fl,{title:"Gestion des séjours"},{default:l(()=>[v.value!==null?(y(),w(L,{key:0,onClick:i,"prepend-icon":"mdi-view-list"},{default:l(()=>[...n[0]||(n[0]=[g(" Retour à la liste",-1)])]),_:1})):Q("",!0)]),_:1}),v.value===void 0?(y(),w(bn,{key:0,onShowParticipants:a})):(y(),w(kn,{key:1,id:v.value,"id-participant":s.value.idParticipant},null,8,["id","id-participant"]))],64))}}),gt=K({__name:"MergeCard",props:{from:{}},emits:["merge"],setup(t,{emit:o}){const s=t,v=o,a=D(0),i=D(!0);return(m,n)=>{const c=ut;return y(),w(O,{title:"Fusionner le dossier vers",subtitle:"Les participants, paiements et messages seront copiés vers le dossier cible."},{default:l(()=>[e(B,null,{default:l(()=>[e(h,null,{default:l(()=>[e(b,{cols:"12"},{default:l(()=>[e(c,{modelValue:a.value,"onUpdate:modelValue":n[0]||(n[0]=u=>a.value=u)},null,8,["modelValue"])]),_:1}),e(b,{cols:"12"},{default:l(()=>[e(ze,{density:"compact",label:"Notifier par email",hint:"Le reponsable du dossier absorbé sera averti du changement d'espace personnel.","persistent-hint":"",modelValue:i.value,"onUpdate:modelValue":n[1]||(n[1]=u=>i.value=u)},null,8,["modelValue"])]),_:1})]),_:1})]),_:1}),e(oe,null,{default:l(()=>[e(ie),e(L,{disabled:a.value==0||a.value==s.from,onClick:n[2]||(n[2]=u=>v("merge",{From:s.from,To:a.value,Notifie:i.value}))},{default:l(()=>[...n[3]||(n[3]=[g("Fusionner",-1)])]),_:1},8,["disabled"])]),_:1})]),_:1})}}}),Cn={key:1,class:"text-center font-italic"},xn={key:2},Pn=K({__name:"PannelInscriptions",emits:["goTo","empty"],setup(t,{emit:o}){const s=o,v=D(!1);Te(async()=>{await i(),a.value.length||s("empty")});const a=D([]);async function i(){v.value=!0;const _=await x.InscriptionsGet();v.value=!1,_!==void 0&&(a.value=_||[])}const m=D(""),n=F(()=>{const _=at(m.value);return a.value.filter(C=>Ne.match(C.Responsable,_)||C.Participants?.some(P=>Ne.match(P.Personne,_)||Ce.match(P.Camp,_)))});async function c(_,C){const P=await x.InscriptionsIdentifiePersonne({IdDossier:_,Target:C});if(P===void 0)return;x.showMessage("Profil identifié avec succès.");const j=a.value.findIndex(G=>G.Dossier.Id==_);a.value[j]=P}const u=D(null);async function d(_,C){if(!u.value)return;const P=u.value.inscription.Dossier.Id;u.value=null;const j=await x.InscriptionsValide({IdDossier:P,Statuts:_,SendMail:C});if(j!==void 0)if(j.Dossier.IsValidated)x.showMessage("Inscription validée avec succès.","",{title:"Aller au dossier",action:()=>s("goTo",P)}),a.value=a.value.filter(G=>G.Dossier.Id!=P);else{x.showMessage("Participant validé avec succès.");const G=a.value.findIndex(S=>S.Dossier.Id==P);a.value[G]=j}}async function r(_){await x.DossiersDelete({id:_.Dossier.Id})!==void 0&&(x.showMessage("Inscription supprimée avec succès."),a.value=a.value.filter(P=>P.Dossier.Id!=_.Dossier.Id))}async function p(_,C){if(await x.ParticipantsDelete({id:C})===void 0)return;x.showMessage("Participant supprimé avec succès.");const j=a.value.find(G=>G.Dossier.Id==_);j.Participants=(j.Participants||[]).filter(G=>G.Participant.Id!=C)}const k=D(null);async function I(_){k.value=null,await x.DossiersMerge(_)!==void 0&&(x.showMessage("Inscriptions fusionnées avec succès."),i())}return(_,C)=>{const P=$a;return y(),w(O,{title:"Inscriptions",subtitle:"En attente de validation",class:"ma-2"},{append:l(()=>[e(me,{width:"300","append-inner-icon":"mdi-magnify",label:"Rechercher","hide-details":"",modelValue:m.value,"onUpdate:modelValue":C[0]||(C[0]=j=>m.value=j)},null,8,["modelValue"])]),default:l(()=>[e(B,null,{default:l(()=>[v.value?(y(),w(Ge,{key:0})):a.value.length?(y(),z("div",xn,[(y(!0),z(le,null,ce(n.value,(j,G)=>(y(),w(Ma,{class:"my-1",user:null,key:G,inscription:j,onIdentifie:S=>c(j.Dossier.Id,S),onValide:S=>u.value={inscription:j,participants:S===void 0?void 0:[S]},onMerge:S=>k.value=j.Dossier.Id,onDelete:S=>r(j),onDeleteParticipant:S=>p(j.Dossier.Id,S),api:{SearchSimilaires:U(x).InscriptionsSearchSimilaires.bind(U(x)),SelectPersonne:U(x).SelectPersonne.bind(U(x))}},null,8,["inscription","onIdentifie","onValide","onMerge","onDelete","onDeleteParticipant","api"]))),128))])):(y(),z("div",Cn," Il n'y a aucune inscription à valider. "))]),_:1}),e(Z,{"model-value":k.value!=null,"onUpdate:modelValue":C[1]||(C[1]=j=>k.value=null),"max-width":"600px"},{default:l(()=>[k.value!=null?(y(),w(gt,{key:0,from:k.value,onMerge:I},null,8,["from"])):Q("",!0)]),_:1},8,["model-value"]),e(Z,{"model-value":u.value!=null,"onUpdate:modelValue":C[2]||(C[2]=j=>u.value=null),"max-width":"800px"},{default:l(()=>[u.value?(y(),w(P,{key:0,inscription:u.value.inscription,"id-participants":u.value.participants,onValide:d},null,8,["inscription","id-participants"])):Q("",!0)]),_:1},8,["model-value"])]),_:1})}}}),wn={class:"text-grey"},Dn={class:"text-grey"},Sn={key:0},In=K({__name:"FactureCard",props:{dossier:{}},setup(t){const o=t,s=F(()=>(o.dossier.Participants||[]).filter(n=>n.Participant.Statut!=tl.Inscrit).map(n=>Ne.label(n.Personne))),v=F(()=>(o.dossier.Participants||[]).filter(n=>n.Participant.Statut==tl.Inscrit).map(n=>({Label:Ne.label(n.Personne),Camp:Ce.label(n.Camp),Prix:_e.montant(n.Camp.Prix),Bilan:o.dossier.Bilan.Inscrits[n.Participant.Id]})));function a(n){return!!(n.Remises.ReducInscrits||n.Remises.ReducEquipiers||n.Remises.ReducSpeciale.Cent)}function i(n){const c=[];return n.ReducInscrits&&c.push(`Enfants : ${n.ReducInscrits}%`),n.ReducEquipiers&&c.push(`Enfants : ${n.ReducEquipiers}%`),n.ReducSpeciale.Cent&&c.push(`Remise : ${_e.montant(n.ReducSpeciale)}`),c.join("  ;  ")}const m=F(()=>{const n=Object.values(o.dossier.Paiements||{});return n.sort((c,u)=>new Date(c.Time).valueOf()-new Date(u.Time).valueOf()),n});return(n,c)=>(y(),w(O,{title:"Suivi financier",subtitle:s.value.length?`Les participants en liste d'attente (${s.value.join(", ")}) ne sont pas pris en compte.`:"","min-width":"900px"},{default:l(()=>[e(B,null,{default:l(()=>[e(h,null,{default:l(()=>[e(b,{cols:"3"},{default:l(()=>[...c[0]||(c[0]=[g("Participant",-1)])]),_:1}),e(b,{cols:"2",class:"text-center"},{default:l(()=>[...c[1]||(c[1]=[g("Prix du séjour",-1)])]),_:1}),e(b,{cols:"2",class:"text-center"},{default:l(()=>[...c[2]||(c[2]=[g("Prix avec option",-1)])]),_:1}),e(b,{cols:"3",class:"text-center"},{default:l(()=>[...c[3]||(c[3]=[g("Aides extérieures",-1)])]),_:1}),e(b,{cols:"2",class:"text-right"},{default:l(()=>[...c[4]||(c[4]=[g("Sous-total",-1)])]),_:1})]),_:1}),e(ue,{thickness:"1",class:"my-2"}),(y(!0),z(le,null,ce(v.value,u=>(y(),z(le,null,[e(h,null,{default:l(()=>[e(b,{"align-self":"center",cols:"3"},{default:l(()=>[g(M(u.Label)+" ",1),c[5]||(c[5]=E("br",null,null,-1)),E("span",wn,M(u.Camp),1)]),_:2},1024),e(b,{"align-self":"center",cols:"2",class:"text-center"},{default:l(()=>[g(M(u.Prix),1)]),_:2},1024),e(b,{"align-self":"center",cols:"2",class:"text-center"},{default:l(()=>[g(M(U(_e).montant(u.Bilan.AvecOption))+" ",1),c[6]||(c[6]=E("br",null,null,-1)),E("span",Dn,M(u.Bilan.AvecOptionDescription),1)]),_:2},1024),e(b,{"align-self":"center",cols:"3",class:"text-center"},{default:l(()=>[u.Bilan.Aides?.length?Q("",!0):(y(),z("span",Sn,"-")),(y(!0),z(le,null,ce(u.Bilan.Aides,d=>(y(),w(fe,null,{default:l(()=>[g(M(d.Structure)+" : "+M(U(_e).montant(d.Montant)),1)]),_:2},1024))),256))]),_:2},1024),e(b,{"align-self":"center",cols:"2",class:"text-right"},{default:l(()=>[g(M(u.Bilan.AvecAides),1)]),_:2},1024)]),_:2},1024),a(u.Bilan)?(y(),w(h,{key:0,"no-gutters":""},{default:l(()=>[e(b,{cols:"10",class:"text-right"},{default:l(()=>[E("i",null,M(i(u.Bilan.Remises)),1)]),_:2},1024),e(b,{cols:"2",class:"text-right"},{default:l(()=>[g(M(u.Bilan.Net),1)]),_:2},1024)]),_:2},1024)):Q("",!0)],64))),256)),e(ue,{thickness:"1",class:"my-2"}),e(h,null,{default:l(()=>[e(b,{cols:"10",class:"text-right"},{default:l(()=>[...c[7]||(c[7]=[g("Total demandé",-1)])]),_:1}),e(b,{cols:"2",class:"text-right"},{default:l(()=>[g(M(o.dossier.Bilan.Demande),1)]),_:1})]),_:1}),e(ue,{thickness:"1",class:"my-2"}),(y(!0),z(le,null,ce(m.value,u=>(y(),w(h,null,{default:l(()=>[e(b,null,{default:l(()=>[g(" Paiement de "+M(u.Payeur)+", le "+M(U(_e).date(u.Time)),1)]),_:2},1024),e(b,{cols:"2",class:"text-right"},{default:l(()=>[g(M(u.IsRemboursement?"+":"-")+M(U(_e).montant(u.Montant)),1)]),_:2},1024)]),_:2},1024))),256)),e(h,null,{default:l(()=>[e(b,{cols:"10",class:"text-right"},{default:l(()=>[...c[8]||(c[8]=[g("Solde",-1)])]),_:1}),e(b,{cols:"2",class:"text-right"},{default:l(()=>[E("b",null,M(o.dossier.Bilan.Restant),1)]),_:1})]),_:1})]),_:1})]),_:1},8,["subtitle"]))}});function qe(t){let o=arguments.length>1&&arguments[1]!==void 0?arguments[1]:2;return String(t).padStart(o,"0")}const An=Re({allowedValues:Function,ampm:Boolean,color:String,disabled:Boolean,displayedValue:null,double:Boolean,format:{type:Function,default:t=>t},max:{type:Number,required:!0},min:{type:Number,required:!0},scrollable:Boolean,readonly:Boolean,rotate:{type:Number,default:0},step:{type:Number,default:1},modelValue:{type:Number}},"VTimePickerClock"),Wl=Le()({name:"VTimePickerClock",props:An(),emits:{change:t=>!0,input:t=>!0},setup(t,o){let{emit:s}=o;const v=D(null),a=D(null),i=D(void 0),m=D(!1),n=D(null),c=D(null),u=na(V=>s("change",V),750),{textColorClasses:d,textColorStyles:r}=ua(()=>t.color),{backgroundColorClasses:p,backgroundColorStyles:k}=Gl(()=>t.color),I=F(()=>t.max-t.min+1),_=F(()=>t.double?I.value/2:I.value),C=F(()=>360/_.value),P=F(()=>C.value*Math.PI/180),j=F(()=>t.modelValue==null?t.min:t.modelValue),G=F(()=>.62),S=F(()=>{const V=[];for(let $=t.min;$<=t.max;$=$+t.step)V.push($);return V});Ae(()=>t.modelValue,V=>{i.value=V});function f(V){i.value!==V&&(i.value=V),s("input",V)}function ee(V){return!t.allowedValues||t.allowedValues(V)}function ye(V){if(!t.scrollable||t.disabled)return;V.preventDefault();const $=Math.sign(-V.deltaY||1);let R=j.value;do R=R+$,R=(R-t.min+I.value)%I.value+t.min;while(!ee(R)&&R!==j.value);R!==t.displayedValue&&f(R),u(R)}function W(V){return t.double&&V-t.min>=_.value}function A(V){return W(V)?G.value:1}function te(V){const $=t.rotate*Math.PI/180;return{x:Math.sin((V-t.min)*P.value+$)*A(V),y:-Math.cos((V-t.min)*P.value+$)*A(V)}}function ne(V,$){const R=(Math.round(V/C.value)+($?_.value:0))%I.value+t.min;return V<360-C.value/2?R:$?t.max-_.value+1:t.min}function N(V){const{x:$,y:R}=te(V);return{left:`${Math.round(50+$*50)}%`,top:`${Math.round(50+R*50)}%`}}function q(V,$){const R=$.x-V.x,pe=$.y-V.y;return Math.sqrt(R*R+pe*pe)}function re(V,$){const R=2*Math.atan2($.y-V.y-q(V,$),$.x-V.x);return Math.abs(R*180/Math.PI)}function X(V){n.value===null&&(n.value=V),c.value=V,f(V)}function be(V){if(V.preventDefault(),!m.value&&V.type!=="click"||!v.value)return;const{width:$,top:R,left:pe}=v.value?.getBoundingClientRect(),{width:ae}=a.value?.getBoundingClientRect()??{width:0},{clientX:Me,clientY:$e}="touches"in V?V.touches[0]:V,T={x:$/2,y:-$/2},Y={x:Me-pe,y:R-$e},de=Math.round(re(T,Y)-t.rotate+360)%360,ve=t.double&&q(T,Y)<(ae+ae*G.value)/4,_t=Math.ceil(15/C.value);let Qe;for(let ol=0;ol<_t;ol++)if(Qe=ne(de+ol*C.value,ve),ee(Qe)||(Qe=ne(de-ol*C.value,ve),ee(Qe)))return X(Qe)}function ge(V){t.disabled||(V.preventDefault(),window.addEventListener("mousemove",be),window.addEventListener("touchmove",be),window.addEventListener("mouseup",J),window.addEventListener("touchend",J),n.value=null,c.value=null,m.value=!0,be(V))}function J(V){V.stopPropagation(),window.removeEventListener("mousemove",be),window.removeEventListener("touchmove",be),window.removeEventListener("mouseup",J),window.removeEventListener("touchend",J),m.value=!1,c.value!==null&&ee(c.value)&&s("change",c.value)}he(()=>E("div",{class:ke([{"v-time-picker-clock":!0,"v-time-picker-clock--indeterminate":t.modelValue==null,"v-time-picker-clock--readonly":t.readonly}]),onMousedown:ge,onTouchstart:ge,onWheel:ye,ref:v},[E("div",{class:"v-time-picker-clock__inner",ref:a},[E("div",{class:ke([{"v-time-picker-clock__hand":!0,"v-time-picker-clock__hand--inner":W(t.modelValue)},d.value]),style:al([{transform:`rotate(${t.rotate+C.value*(j.value-t.min)}deg) scaleY(${A(j.value)})`},r.value])},null),S.value.map(V=>{const $=V===j.value;return E("div",{class:ke([{"v-time-picker-clock__item":!0,"v-time-picker-clock__item--active":$,"v-time-picker-clock__item--disabled":t.disabled||!ee(V)},$&&p.value]),style:al([N(V),$&&k.value])},[E("span",null,[t.format(V)])])})])]))}}),Mn=Re({ampm:Boolean,color:String,disabled:Boolean,hour:Number,minute:Number,second:Number,period:String,readonly:Boolean,useSeconds:Boolean,value:Number,viewMode:String},"VTimePickerControls"),Jl=Le()({name:"VTimePickerControls",props:Mn(),emits:{"update:period":t=>!0,"update:viewMode":t=>!0},setup(t,o){let{emit:s,slots:v}=o;const{t:a}=Ke();return he(()=>{let i=t.hour;return t.ampm&&(i=i?(i-1)%12+1:12),E("div",{class:"v-time-picker-controls"},[E("div",{class:ke({"v-time-picker-controls__time":!0,"v-time-picker-controls__time--with-seconds":t.useSeconds})},[e(L,{active:t.viewMode==="hour",color:t.viewMode==="hour"?t.color:void 0,disabled:t.disabled,variant:"tonal",class:ke({"v-time-picker-controls__time__btn":!0,"v-time-picker-controls__time--with-ampm__btn":t.ampm,"v-time-picker-controls__time--with-seconds__btn":t.useSeconds}),text:t.hour==null?"--":qe(`${i}`),onClick:()=>s("update:viewMode","hour")},null),E("span",{class:ke(["v-time-picker-controls__time__separator",{"v-time-picker-controls--with-seconds__time__separator":t.useSeconds}])},[g(":")]),e(L,{active:t.viewMode==="minute",color:t.viewMode==="minute"?t.color:void 0,class:ke({"v-time-picker-controls__time__btn":!0,"v-time-picker-controls__time__btn__active":t.viewMode==="minute","v-time-picker-controls__time--with-ampm__btn":t.ampm,"v-time-picker-controls__time--with-seconds__btn":t.useSeconds}),disabled:t.disabled,variant:"tonal",text:t.minute==null?"--":qe(t.minute),onClick:()=>s("update:viewMode","minute")},null),t.useSeconds&&E("span",{class:ke(["v-time-picker-controls__time__separator",{"v-time-picker-controls--with-seconds__time__separator":t.useSeconds}]),key:"secondsDivider"},[g(":")]),t.useSeconds&&e(L,{key:"secondsVal",active:t.viewMode==="second",color:t.viewMode==="second"?t.color:void 0,variant:"tonal",onClick:()=>s("update:viewMode","second"),class:ke({"v-time-picker-controls__time__btn":!0,"v-time-picker-controls__time__btn__active":t.viewMode==="second","v-time-picker-controls__time--with-seconds__btn":t.useSeconds}),disabled:t.disabled,text:t.second==null?"--":qe(t.second)},null),t.ampm&&E("div",{class:"v-time-picker-controls__ampm"},[e(L,{active:t.period==="am",color:t.period==="am"?t.color:void 0,class:ke({"v-time-picker-controls__ampm__am":!0,"v-time-picker-controls__ampm__btn":!0,"v-time-picker-controls__ampm__btn__active":t.period==="am"}),disabled:t.disabled,text:a("$vuetify.timePicker.am"),variant:t.disabled&&t.period==="am"?"elevated":"tonal",onClick:()=>t.period!=="am"?s("update:period","am"):null},null),e(L,{active:t.period==="pm",color:t.period==="pm"?t.color:void 0,class:ke({"v-time-picker-controls__ampm__pm":!0,"v-time-picker-controls__ampm__btn":!0,"v-time-picker-controls__ampm__btn__active":t.period==="pm"}),disabled:t.disabled,text:a("$vuetify.timePicker.pm"),variant:t.disabled&&t.period==="pm"?"elevated":"tonal",onClick:()=>t.period!=="pm"?s("update:period","pm"):null},null)])])])}),{}}}),$n=Ee(24),Vt=Ee(12),Un=Vt.map(t=>t+12);Ee(60);const Rn=Re({allowedHours:[Function,Array],allowedMinutes:[Function,Array],allowedSeconds:[Function,Array],disabled:Boolean,format:{type:String,default:"ampm"},max:String,min:String,viewMode:{type:String,default:"hour"},period:{type:String,default:"am",validator:t=>["am","pm"].includes(t)},modelValue:null,readonly:Boolean,scrollable:Boolean,useSeconds:Boolean,...He(nt({title:"$vuetify.timePicker.title"}),["landscape"])},"VTimePicker"),Fn=Le()({name:"VTimePicker",props:Rn(),emits:{"update:hour":t=>!0,"update:minute":t=>!0,"update:period":t=>!0,"update:second":t=>!0,"update:modelValue":t=>!0,"update:viewMode":t=>!0},setup(t,o){let{emit:s,slots:v}=o;const{t:a}=Ke(),i=D(null),m=D(null),n=D(null),c=D(null),u=D(null),d=D(null),r=Ue(t,"period","am"),p=Ue(t,"viewMode","hour"),k=D(null),I=D(null),_=F(()=>{let N;if(t.allowedHours instanceof Array?N=X=>t.allowedHours.includes(X):N=t.allowedHours,!t.min&&!t.max)return N;const q=t.min?Number(t.min.split(":")[0]):0,re=t.max?Number(t.max.split(":")[0]):23;return X=>X>=Number(q)&&X<=Number(re)&&(!N||N(X))}),C=F(()=>{let N;const q=!_.value||i.value===null||_.value(i.value);if(t.allowedMinutes instanceof Array?N=$=>t.allowedMinutes.includes($):N=t.allowedMinutes,!t.min&&!t.max)return q?N:()=>!1;const[re,X]=t.min?t.min.split(":").map(Number):[0,0],[be,ge]=t.max?t.max.split(":").map(Number):[23,59],J=re*60+Number(X),V=be*60+Number(ge);return $=>{const R=60*i.value+$;return R>=J&&R<=V&&q&&(!N||N($))}}),P=F(()=>{let N;const re=(!_.value||i.value===null||_.value(i.value))&&(!C.value||m.value===null||C.value(m.value));if(t.allowedSeconds instanceof Array?N=ae=>t.allowedSeconds.includes(ae):N=t.allowedSeconds,!t.min&&!t.max)return re?N:()=>!1;const[X,be,ge]=t.min?t.min.split(":").map(Number):[0,0,0],[J,V,$]=t.max?t.max.split(":").map(Number):[23,59,59],R=X*3600+be*60+Number(ge||0),pe=J*3600+V*60+Number($||0);return ae=>{const Me=3600*i.value+60*m.value+ae;return Me>=R&&Me<=pe&&re&&(!N||N(ae))}}),j=F(()=>t.format==="ampm");Ae(()=>t.period,N=>A(N)),Ae(()=>t.modelValue,N=>ye(N)),Te(()=>{ye(t.modelValue)});function G(){return i.value!=null&&m.value!=null&&(!t.useSeconds||n.value!=null)?`${qe(i.value)}:${qe(m.value)}`+(t.useSeconds?`:${qe(n.value)}`:""):null}function S(){const N=G();N!==null&&s("update:modelValue",N)}function f(N){return N?(N-1)%12+1:12}function ee(N,q){return N%12+(q==="pm"?12:0)}function ye(N){if(N==null||N==="")i.value=null,m.value=null,n.value=null;else if(N instanceof Date)i.value=N.getHours(),m.value=N.getMinutes(),n.value=N.getSeconds();else{const[q,,re,,X,be]=N.trim().toLowerCase().match(/^(\d+):(\d+)(:(\d+))?([ap]m)?$/)||new Array(6);i.value=be?ee(parseInt(q,10),be):parseInt(q,10),m.value=parseInt(re,10),n.value=parseInt(X||0,10)}r.value=i.value==null||i.value<12?"am":"pm"}function W(N,q){const re=_.value;if(!re)return q;const X=j.value?q<12?Vt:Un:$n;return((X.find(ge=>re((ge+q)%X.length+X[0]))||0)+q)%X.length+X[0]}function A(N){if(r.value=N,i.value!=null){const q=i.value+(r.value==="am"?-12:12);i.value=W("hour",q)}return s("update:period",N),S(),!0}function te(N){p.value==="hour"?i.value=j.value?ee(N,r.value):N:p.value==="minute"?m.value=N:n.value=N}function ne(N){switch(p.value||"hour"){case"hour":s("update:hour",N);break;case"minute":s("update:minute",N);break;case"second":s("update:second",N);break}const q=i.value!==null&&m.value!==null&&(t.useSeconds?n.value!==null:!0);p.value==="hour"?p.value="minute":t.useSeconds&&p.value==="minute"&&(p.value="second"),!(i.value===c.value&&m.value===u.value&&(!t.useSeconds||n.value===d.value)||G()===null)&&(c.value=i.value,u.value=m.value,t.useSeconds&&(d.value=n.value),q&&S())}he(()=>{const N=ml.filterProps(t),q=Jl.filterProps(t),re=Wl.filterProps(He(t,["format","modelValue","min","max"]));return e(ml,se(N,{color:void 0,class:["v-time-picker",t.class],style:t.style}),{title:()=>v.title?.()??E("div",{class:"v-time-picker__title"},[a(t.title)]),header:()=>e(Jl,se(q,{ampm:j.value,hour:i.value,minute:m.value,period:r.value,second:n.value,viewMode:p.value,"onUpdate:period":X=>A(X),"onUpdate:viewMode":X=>p.value=X,ref:k}),null),default:()=>e(Wl,se(re,{allowedValues:p.value==="hour"?_.value:p.value==="minute"?C.value:P.value,double:p.value==="hour"&&!j.value,format:p.value==="hour"?j.value?f:X=>X:X=>qe(X,2),max:p.value==="hour"?j.value&&r.value==="am"?11:23:59,min:p.value==="hour"&&j.value&&r.value==="pm"?12:0,size:20,step:p.value==="hour"?1:5,modelValue:p.value==="hour"?i.value:p.value==="minute"?m.value:n.value,onChange:ne,onInput:te,ref:I}),null),actions:v.actions})})}}),Ln=K({__name:"TimeField",props:De({hideDetails:{type:Boolean},readonly:{type:Boolean}},{modelValue:{required:!0},modelModifiers:{}}),emits:["update:modelValue"],setup(t){const o=t,s=Pe(t,"modelValue"),v=F(()=>new Date(s.value).toLocaleTimeString(void 0,{hour:"numeric",minute:"numeric"}));function a(n){const[c,u]=n.split(":"),d=new Date(s.value);d.setHours(Number(c),Number(u)),s.value=d.toISOString()}function i(n){const c=new Date(n),u=new Date(s.value);c.setHours(u.getHours(),u.getMinutes(),u.getSeconds()),s.value=c.toISOString()}const m=D(!1);return(n,c)=>{const u=yt;return y(),w(h,{"no-gutters":""},{default:l(()=>[e(b,null,{default:l(()=>[e(u,{class:"mr-2",label:"Date","model-value":U(lt)(new Date(s.value)),"onUpdate:modelValue":i,"hide-details":o.hideDetails,readonly:o.readonly},null,8,["model-value","hide-details","readonly"])]),_:1}),e(b,{cols:"auto"},{default:l(()=>[...c[1]||(c[1]=[E("div",{class:"ma-2"},null,-1)])]),_:1}),e(b,null,{default:l(()=>[e(Se,{"close-on-content-click":!1,modelValue:m.value,"onUpdate:modelValue":c[0]||(c[0]=d=>m.value=d)},{activator:l(({props:d})=>[e(me,se({class:"center-text"},d,{variant:"outlined",density:"compact","hide-details":o.hideDetails,label:"Moment","model-value":v.value}),null,16,["hide-details","model-value"])]),default:l(()=>[e(Fn,{"model-value":new Date(s.value),"onUpdate:modelValue":a,format:"24hr"},null,8,["model-value"])]),_:1},8,["modelValue"])]),_:1})]),_:1})}}}),hn=Pl(Ln,[["__scopeId","data-v-32955f86"]]),Tn=K({__name:"ModePaiementField",props:De({hideDetails:{type:Boolean},readonly:{type:Boolean},rules:{}},{modelValue:{required:!0},modelModifiers:{}}),emits:["update:modelValue"],setup(t){const o=t,s=Pe(t,"modelValue"),v=nl(ia);return(a,i)=>(y(),w(Oe,{label:"Mode de paiement",variant:"outlined",density:"compact",items:U(v),readonly:o.readonly,"hide-details":o.hideDetails,modelValue:s.value,"onUpdate:modelValue":i[0]||(i[0]=m=>s.value=m),rules:o.rules},null,8,["items","readonly","hide-details","modelValue","rules"]))}}),En=K({__name:"PaiementEditCard",props:{paiement:{}},emits:["update","delete"],setup(t,{emit:o}){const s=t,v=o,a=D(we(s.paiement)),i=F(()=>!0),m=D(!1);return(n,c)=>{const u=Tn,d=Ze,r=hn;return y(),w(O,{title:"Modifier le paiement"},{default:l(()=>[e(Z,{modelValue:m.value,"onUpdate:modelValue":c[1]||(c[1]=p=>m.value=p),"max-width":"400px"},{default:l(()=>[e(O,{title:"Confirmation"},{default:l(()=>[e(B,null,{default:l(()=>[...c[11]||(c[11]=[g(" Confirmez-vous la suppression de ce paiement ? ",-1),E("br",null,null,-1),E("br",null,null,-1),g(" Attention, cette opération est irréversible. ",-1)])]),_:1}),e(oe,null,{default:l(()=>[e(ie),e(L,{color:"red",onClick:c[0]||(c[0]=p=>{m.value=!1,v("delete")})},{default:l(()=>[...c[12]||(c[12]=[g("Supprimer",-1)])]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"]),e(B,null,{default:l(()=>[e(h,null,{default:l(()=>[e(b,null,{default:l(()=>[e(me,{density:"compact",variant:"outlined","hide-details":"",label:"Payé par",modelValue:a.value.Payeur,"onUpdate:modelValue":c[2]||(c[2]=p=>a.value.Payeur=p)},null,8,["modelValue"])]),_:1}),e(b,null,{default:l(()=>[e(me,{density:"compact",variant:"outlined","hide-details":"",label:"Description (optionelle)",modelValue:a.value.Label,"onUpdate:modelValue":c[3]||(c[3]=p=>a.value.Label=p)},null,8,["modelValue"])]),_:1})]),_:1}),e(h,null,{default:l(()=>[e(b,null,{default:l(()=>[e(u,{modelValue:a.value.Mode,"onUpdate:modelValue":c[4]||(c[4]=p=>a.value.Mode=p),"hide-details":""},null,8,["modelValue"])]),_:1}),e(b,null,{default:l(()=>[e(d,{label:"Montant",modelValue:a.value.Montant,"onUpdate:modelValue":c[5]||(c[5]=p=>a.value.Montant=p),"hide-details":""},null,8,["modelValue"])]),_:1})]),_:1}),e(h,null,{default:l(()=>[e(b,null,{default:l(()=>[e(ze,{"hide-details":"",density:"compact",label:"Remboursement ?",modelValue:a.value.IsRemboursement,"onUpdate:modelValue":c[6]||(c[6]=p=>a.value.IsRemboursement=p)},null,8,["modelValue"])]),_:1})]),_:1}),e(h,null,{default:l(()=>[e(b,null,{default:l(()=>[e(r,{modelValue:a.value.Time,"onUpdate:modelValue":c[7]||(c[7]=p=>a.value.Time=p),"hide-details":""},null,8,["modelValue"])]),_:1})]),_:1}),e(h,null,{default:l(()=>[e(b,null,{default:l(()=>[e(me,{density:"compact",variant:"outlined",label:"Détails (optionnel)",modelValue:a.value.Details,"onUpdate:modelValue":c[8]||(c[8]=p=>a.value.Details=p)},null,8,["modelValue"])]),_:1})]),_:1})]),_:1}),e(oe,null,{default:l(()=>[e(L,{color:"red",onClick:c[9]||(c[9]=p=>m.value=!0)},{default:l(()=>[...c[13]||(c[13]=[g("Supprimer le paiement",-1)])]),_:1}),e(ie),e(L,{onClick:c[10]||(c[10]=p=>v("update",a.value)),disabled:!i.value},{default:l(()=>[...c[14]||(c[14]=[g("Enregistrer",-1)])]),_:1},8,["disabled"])]),_:1})]),_:1})}}}),Nn=K({__name:"DossierEditCard",props:{responsable:{},dossier:{}},emits:["save"],setup(t,{emit:o}){const s=t,v=o,a=D(we(s.dossier));return(i,m)=>{const n=il,c=dt,u=wl;return y(),w(O,null,{default:l(()=>[e(B,null,{default:l(()=>[e(h,null,{default:l(()=>[e(b,null,{default:l(()=>[e(n,{label:"Responsable","initial-personne":s.responsable,"model-value":a.value.IdResponsable,"onUpdate:modelValue":m[0]||(m[0]=d=>d?a.value.IdResponsable=d:void 0),api:{SelectPersonne:U(x).SelectPersonne.bind(U(x))}},null,8,["initial-personne","model-value","api"])]),_:1})]),_:1}),e(h,null,{default:l(()=>[e(b,null,{default:l(()=>[e(c,{label:"Adresses mail en copie",modelValue:a.value.CopiesMails,"onUpdate:modelValue":m[1]||(m[1]=d=>a.value.CopiesMails=d),rule:U(sa).validMails()},null,8,["modelValue","rule"])]),_:1})]),_:1}),e(h,null,{default:l(()=>[e(b,null,{default:l(()=>[e(u,{"hide-details":"",modelValue:a.value.PartageAdressesOK,"onUpdate:modelValue":m[2]||(m[2]=d=>a.value.PartageAdressesOK=d),label:"Partage des coordonnées"},null,8,["modelValue"])]),_:1})]),_:1}),e(h,null,{default:l(()=>[e(b,null,{default:l(()=>[e(u,{"hide-details":"",modelValue:a.value.DemandeFondSoutien,"onUpdate:modelValue":m[3]||(m[3]=d=>a.value.DemandeFondSoutien=d),label:"Demande le fonds de soutien"},null,8,["modelValue"])]),_:1})]),_:1})]),_:1}),e(oe,null,{default:l(()=>[e(ie),e(L,{onClick:m[4]||(m[4]=d=>v("save",a.value))},{default:l(()=>[...m[5]||(m[5]=[g("Enregistrer",-1)])]),_:1})]),_:1})]),_:1})}}}),On=K({__name:"OptionJournee",props:De({camp:{}},{modelValue:{required:!0},modelModifiers:{}}),emits:["update:modelValue"],setup(t){const o=t,s=Pe(t,"modelValue"),v=F(()=>(o.camp.OptionPrix.Jours||[]).map((a,i)=>i));return(a,i)=>(y(),w(O,null,{default:l(()=>[e(B,null,{default:l(()=>[i[1]||(i[1]=E("div",{class:"text-grey mb-2"}," Le prix est variable en fonction des jours de participation au camp. ",-1)),e(oa,{class:"overflow-x-auto",color:"secondary",multiple:"","model-value":s.value?.length?s.value:v.value,"onUpdate:modelValue":i[0]||(i[0]=m=>s.value=m.length==v.value.length?[]:m)},{default:l(()=>[(y(!0),z(le,null,ce(o.camp.OptionPrix.Jours,(m,n)=>(y(),w(L,null,{default:l(()=>[g("J "+M(n+1),1)]),_:2},1024))),256))]),_:1},8,["model-value"])]),_:1})]),_:1}))}}),Bn=K({__name:"OptionStatut",props:De({camp:{}},{modelValue:{required:!0},modelModifiers:{}}),emits:["update:modelValue"],setup(t){const o=t,s=Pe(t,"modelValue"),v=F(()=>(o.camp.OptionPrix.Statuts||[]).map(i=>({value:i.Id,title:i.Label,subtitle:i.Description}))),a=F(()=>v.value.map(i=>i.value).includes(s.value));return(i,m)=>(y(),w(O,null,{default:l(()=>[e(B,null,{default:l(()=>[m[1]||(m[1]=E("div",{class:"text-grey mb-4"},"Le prix dépend du statut du participant.",-1)),e(Oe,{clearable:"",items:v.value,label:"Statut","model-value":a.value?s.value:null,"onUpdate:modelValue":m[0]||(m[0]=n=>s.value=n??0),variant:"outlined",density:"comfortable","hide-details":""},{item:l(({item:n,props:c})=>[e(H,se(c,{title:n.title,subtitle:n.raw.subtitle}),null,16,["title","subtitle"])]),_:1},8,["items","model-value"])]),_:1})]),_:1}))}}),jn={key:2},qn=K({__name:"ParticipantOptionPrix",props:{camp:{},optionAndQf:{}},emits:["update"],setup(t,{emit:o}){const s=t,v=o,a=D(we(s.optionAndQf));return Ae(()=>s.optionAndQf,()=>a.value=we(s.optionAndQf)),(i,m)=>{const n=Xe;return y(),w(O,{title:"Prix variable",width:"800px"},{default:l(()=>[e(B,null,{default:l(()=>[e(h,{justify:"space-evenly"},{default:l(()=>[e(b,{"align-self":"center",cols:"3"},{default:l(()=>[e(n,{modelValue:a.value.quotientFamilial,"onUpdate:modelValue":m[0]||(m[0]=c=>a.value.quotientFamilial=c),label:"Quotient familial","hide-details":""},null,8,["modelValue"])]),_:1}),e(ue,{thickness:"2",vertical:""}),e(b,{"align-self":"center",cols:"8"},{default:l(()=>[s.camp.OptionPrix.Active==U(Ie).PrixJour?(y(),w(On,{key:0,camp:s.camp,modelValue:a.value.options.Jour,"onUpdate:modelValue":m[1]||(m[1]=c=>a.value.options.Jour=c)},null,8,["camp","modelValue"])):s.camp.OptionPrix.Active==U(Ie).PrixStatut?(y(),w(Bn,{key:1,camp:s.camp,modelValue:a.value.options.IdStatut,"onUpdate:modelValue":m[2]||(m[2]=c=>a.value.options.IdStatut=c)},null,8,["camp","modelValue"])):(y(),z("div",jn,"Le camp ne propose pas d'option sur le prix."))]),_:1})]),_:1})]),_:1}),e(oe,null,{default:l(()=>[e(ie),e(L,{onClick:m[3]||(m[3]=c=>v("update",a.value))},{default:l(()=>[...m[4]||(m[4]=[g("Enregistrer",-1)])]),_:1})]),_:1})]),_:1})}}}),Hn={key:1,class:"mx-1"},Yn={key:2,class:"mx-1"},zn={key:3},Qn={key:4,class:"mx-1"},Wn=K({__name:"RemisesChip",props:{remises:{}},emits:["update"],setup(t,{emit:o}){const s=t,v=o,a=F(()=>i.value.ReducInscrits!=0||i.value.ReducEquipiers!=0||i.value.ReducSpeciale.Cent!=0),i=D(we(s.remises));Ae(()=>s.remises,()=>i.value=we(s.remises));const m=D(!1);return(n,c)=>{const u=Xe,d=Ze;return y(),w(Se,{"close-on-content-click":!1,location:"bottom",modelValue:m.value,"onUpdate:modelValue":c[4]||(c[4]=r=>m.value=r)},{activator:l(({props:r})=>[e(O,se(r,{elevation:"1",color:"grey-lighten-2"}),{default:l(()=>[e(B,{class:"py-1 px-1"},{default:l(()=>[a.value?Q("",!0):(y(),z(le,{key:0},[g(" Pas de remises ")],64)),i.value.ReducInscrits?(y(),z("span",Hn," Inscrits : "+M(i.value.ReducInscrits)+"% ",1)):Q("",!0),i.value.ReducEquipiers?(y(),z("span",Yn," Equipiers : "+M(i.value.ReducEquipiers)+"% ",1)):Q("",!0),(i.value.ReducInscrits||i.value.ReducEquipiers)&&i.value.ReducSpeciale.Cent?(y(),z("br",zn)):Q("",!0),i.value.ReducSpeciale.Cent?(y(),z("span",Qn," Remise : "+M(U(_e).montant(i.value.ReducSpeciale)),1)):Q("",!0)]),_:1})]),_:1},16)]),default:l(()=>[e(O,{title:"Modifier les remises",width:"400px"},{default:l(()=>[e(B,null,{default:l(()=>[e(h,null,{default:l(()=>[e(b,null,{default:l(()=>[e(u,{modelValue:i.value.ReducInscrits,"onUpdate:modelValue":c[0]||(c[0]=r=>i.value.ReducInscrits=r),label:"Remise inscrits","hide-details":"",suffix:"%"},null,8,["modelValue"])]),_:1}),e(b,null,{default:l(()=>[e(u,{modelValue:i.value.ReducEquipiers,"onUpdate:modelValue":c[1]||(c[1]=r=>i.value.ReducEquipiers=r),label:"Remise équipiers","hide-details":"",suffix:"%"},null,8,["modelValue"])]),_:1})]),_:1}),e(h,null,{default:l(()=>[e(b,null,{default:l(()=>[e(d,{class:"mt-2",modelValue:i.value.ReducSpeciale,"onUpdate:modelValue":c[2]||(c[2]=r=>i.value.ReducSpeciale=r),label:"Remise spéciale","hide-details":""},null,8,["modelValue"])]),_:1})]),_:1})]),_:1}),e(oe,null,{default:l(()=>[e(ie),e(L,{onClick:c[3]||(c[3]=r=>{v("update",i.value),m.value=!1})},{default:l(()=>[...c[5]||(c[5]=[g("Enregistrer",-1)])]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"])}}}),Jn=Pl(Wn,[["__scopeId","data-v-cc911118"]]),Gn=K({__name:"AideEditCard",props:{aide:{},file:{},structures:{},participant:{}},emits:["save","deleteFile","uploadFile","showStructureaides"],setup(t,{emit:o}){const s=t,v=o,a=D(we(s.aide)),i=F(()=>Object.values(s.structures).map(m=>({value:m.Id,title:m.Nom})));return(m,n)=>{const c=wl,u=Ze,d=Xe,r=qa;return y(),w(O,{title:"Modifier l'aide extérieure",subtitle:`pour ${U(Ne).label(s.participant.Personne)} - ${U(Ce).label(s.participant.Camp)}`},{append:l(()=>[e(L,{onClick:n[0]||(n[0]=p=>v("showStructureaides"))},{default:l(()=>[e(xe,null,{default:l(()=>[...n[9]||(n[9]=[g("mdi-view-list",-1)])]),_:1}),n[10]||(n[10]=g(" Structures",-1))]),_:1})]),default:l(()=>[e(B,null,{default:l(()=>[e(h,null,{default:l(()=>[e(b,null,{default:l(()=>[e(Oe,{variant:"outlined",density:"comfortable",label:"Structure",items:i.value,modelValue:a.value.IdStructureaide,"onUpdate:modelValue":n[1]||(n[1]=p=>a.value.IdStructureaide=p)},null,8,["items","modelValue"])]),_:1}),e(b,null,{default:l(()=>[e(c,{modelValue:a.value.Valide,"onUpdate:modelValue":n[2]||(n[2]=p=>a.value.Valide=p),label:"Aide validée","hide-details":""},null,8,["modelValue"])]),_:1})]),_:1}),e(h,null,{default:l(()=>[e(b,{"align-self":"center"},{default:l(()=>[e(u,{modelValue:a.value.Valeur,"onUpdate:modelValue":n[3]||(n[3]=p=>a.value.Valeur=p),label:"Montant","hide-details":""},null,8,["modelValue"])]),_:1}),e(b,{"align-self":"center",cols:"auto"},{default:l(()=>[e(c,{"hide-details":"",label:"Par jour",modelValue:a.value.ParJour,"onUpdate:modelValue":n[4]||(n[4]=p=>a.value.ParJour=p)},null,8,["modelValue"])]),_:1}),e(b,{"align-self":"center"},{default:l(()=>[e(d,{label:"Limite",suffix:"jours",modelValue:a.value.NbJoursMax,"onUpdate:modelValue":n[5]||(n[5]=p=>a.value.NbJoursMax=p),disabled:!a.value.ParJour,hint:"0 pour ne pas limiter",min:0,"persistent-hint":""},null,8,["modelValue","disabled"])]),_:1})]),_:1}),e(r,{class:"mt-4",files:s.file?[s.file]:[],title:"Document justificatif","max-docs":1,"in-upload":!1,onDelete:n[6]||(n[6]=p=>v("deleteFile")),onUpload:n[7]||(n[7]=p=>v("uploadFile",p))},null,8,["files"])]),_:1}),e(oe,null,{default:l(()=>[e(ie),e(L,{onClick:n[8]||(n[8]=p=>v("save",a.value))},{default:l(()=>[...n[11]||(n[11]=[g("Enregistrer",-1)])]),_:1})]),_:1})]),_:1},8,["subtitle"])}}}),Kn=K({__name:"StructuresPannel",props:{modelValue:{required:!0},modelModifiers:{}},emits:["update:modelValue"],setup(t){const o=Pe(t,"modelValue"),s=F(()=>Object.values(o.value||{}).sort((c,u)=>c.Nom.localeCompare(u.Nom)));async function v(){const c=await x.StructureaideCreate();if(c===void 0)return;x.showMessage("Structure créée avec succès.");const u=o.value||{};u[c.Id]=c,o.value=u,a.value=c}const a=D(null);async function i(){const c=a.value;if(c==null||(a.value=null,await x.StructureaideUpdate(c)===void 0))return;x.showMessage("Structure modifiée avec succès.");const d=o.value||{};d[c.Id]=c,o.value=d}const m=D(null);async function n(){const c=m.value;if(c==null||(m.value=null,await x.StructureaideDelete({id:c.Id})===void 0))return;const d=o.value||{};delete d[c.Id],o.value=d,x.showMessage("Structure supprimée avec succès.")}return(c,u)=>(y(),w(O,{title:"Structures d'aide",subtitle:"Organismes pouvant distribuer une aide extérieure"},{append:l(()=>[e(L,{onClick:v},{prepend:l(()=>[e(xe,{color:"green"},{default:l(()=>[...u[5]||(u[5]=[g("mdi-plus",-1)])]),_:1})]),default:l(()=>[u[6]||(u[6]=g(" Ajouter une structure ",-1))]),_:1})]),default:l(()=>[e(B,{class:"overflow-y-auto"},{default:l(()=>[(y(!0),z(le,null,ce(s.value,d=>(y(),w(h,null,{default:l(()=>[e(b,{"align-self":"center"},{default:l(()=>[e(st,null,{default:l(()=>[g(M(d.Nom),1)]),_:2},1024),e(ot,null,{default:l(()=>[g(M(d.Immatriculation),1)]),_:2},1024)]),_:2},1024),e(b,{"align-self":"center",style:{"font-size":"smaller"}},{default:l(()=>[(y(!0),z(le,null,ce(d.Info.split(`
`),r=>(y(),z("div",null,M(r),1))),256))]),_:2},1024),e(b,{"align-self":"center",cols:"auto"},{default:l(()=>[e(Se,null,{activator:l(({props:r})=>[e(L,se({icon:"mdi-dots-vertical"},{ref_for:!0},r,{size:"x-small"}),null,16)]),default:l(()=>[e(Ve,null,{default:l(()=>[e(H,{title:"Modifier","prepend-icon":"mdi-pencil",onClick:r=>a.value=U(we)(d)},null,8,["onClick"]),e(H,{title:"Supprimer","prepend-icon":"mdi-delete",onClick:r=>m.value=d},null,8,["onClick"])]),_:2},1024)]),_:2},1024)]),_:2},1024)]),_:2},1024))),256))]),_:1}),e(Z,{"model-value":a.value!=null,"onUpdate:modelValue":u[3]||(u[3]=d=>a.value=null),"max-width":"600px"},{default:l(()=>[a.value!=null?(y(),w(O,{key:0,title:"Modifier la structure"},{default:l(()=>[e(B,null,{default:l(()=>[e(h,null,{default:l(()=>[e(b,null,{default:l(()=>[e(me,{variant:"outlined",density:"compact",label:"Nom",modelValue:a.value.Nom,"onUpdate:modelValue":u[0]||(u[0]=d=>a.value.Nom=d),"hide-details":""},null,8,["modelValue"])]),_:1}),e(b,null,{default:l(()=>[e(me,{variant:"outlined",density:"compact",label:"Immatriculation",modelValue:a.value.Immatriculation,"onUpdate:modelValue":u[1]||(u[1]=d=>a.value.Immatriculation=d),"hide-details":""},null,8,["modelValue"])]),_:1})]),_:1}),e(h,null,{default:l(()=>[e(b,null,{default:l(()=>[e(cl,{variant:"outlined",density:"compact",label:"Informations",modelValue:a.value.Info,"onUpdate:modelValue":u[2]||(u[2]=d=>a.value.Info=d),"hide-details":""},null,8,["modelValue"])]),_:1})]),_:1})]),_:1}),e(oe,null,{default:l(()=>[e(ie),e(L,{onClick:i},{default:l(()=>[...u[7]||(u[7]=[g("Enregistrer",-1)])]),_:1})]),_:1})]),_:1})):Q("",!0)]),_:1},8,["model-value"]),e(Z,{"model-value":m.value!=null,"onUpdate:modelValue":u[4]||(u[4]=d=>m.value=null),"max-width":"450px"},{default:l(()=>[m.value!=null?(y(),w(O,{key:0,title:"Confirmation"},{default:l(()=>[e(B,null,{default:l(()=>[g(" Confirmez-vous la suppression de la structure "+M(m.value.Nom)+" ? ",1),u[8]||(u[8]=E("br",null,null,-1)),u[9]||(u[9]=E("br",null,null,-1)),u[10]||(u[10]=g(" Attention, cette opération est irréversible. ",-1))]),_:1}),e(oe,null,{default:l(()=>[e(ie),e(L,{color:"red",onClick:n},{default:l(()=>[...u[11]||(u[11]=[g("Supprimer",-1)])]),_:1})]),_:1})]),_:1})):Q("",!0)]),_:1},8,["model-value"])]),_:1}))}}),Xn={key:0},Zn={key:1},eu=K({__name:"DossierParticipantRow",props:De({participant:{},aides:{},aidesFiles:{},hasManyParticipants:{type:Boolean}},{structures:{required:!0},structuresModifiers:{}}),emits:De(["update","delete","createAide","updateAide","deleteAide","deleteFileAide","uploadFileAide","expand"],["update:structures"]),setup(t,{emit:o}){const s=t,v=Pe(t,"structures"),a=o,i=F(()=>{const _=Object.values(s.aides||{});return _.sort((C,P)=>C.Id-P.Id),_}),m=F(()=>s.participant.Camp.OptionPrix.Active==Ie.NoOption&&!Ce.isQuotientFamilialActive(s.participant.Camp.OptionQuotientFamilial));function n(_){switch(s.participant.Camp.OptionPrix.Active){case Ie.NoOption:return"Séjour sans option";case Ie.PrixJour:const C=_.Jour?.length||0;return C==0?"Présent tous les jours":`Présent ${C} jour${C>1?"s":""}`;case Ie.PrixStatut:const P=s.participant.Camp.OptionPrix.Statuts?.find(j=>j.Id==_.IdStatut);return P?`Statut ${P.Label}`:"Pas d'option."}}const c=D(!1),u=D(!1),d=F(()=>Object.values(v.value).map(_=>({value:_.Id,title:_.Nom})).sort((_,C)=>_.title.localeCompare(C.title))),r=D(null),p=D(null),k=D(null),I=D(!1);return(_,C)=>(y(),w(h,null,{default:l(()=>[e(b,{"align-self":"center",cols:"3"},{default:l(()=>[e(st,null,{default:l(()=>[E("a",{href:"/camps",onClick:C[0]||(C[0]=Je(P=>U(Dl)(s.participant.Participant),["prevent"]))},M(U(Ne).label(s.participant.Personne)),1)]),_:1}),e(ot,null,{default:l(()=>[g(M(U(Ce).label(s.participant.Camp)),1)]),_:1})]),_:1}),e(b,{"align-self":"center",cols:"2",class:"text-center"},{default:l(()=>[e(Se,{disabled:m.value,"close-on-content-click":!1,modelValue:c.value,"onUpdate:modelValue":C[2]||(C[2]=P=>c.value=P)},{activator:l(({props:P})=>[e(O,se(P,{elevation:m.value?0:1,color:"grey-lighten-2"}),{default:l(()=>[e(B,{class:"py-1 px-1"},{default:l(()=>[m.value?(y(),z("div",Xn,"Camp sans option")):(y(),z("div",Zn,[g(M(s.participant.Participant.QuotientFamilial?`QF ${s.participant.Participant.QuotientFamilial}.`:"Pas de QF.")+" ",1),C[22]||(C[22]=E("br",null,null,-1)),g(" "+M(n(s.participant.Participant.OptionPrix)),1)]))]),_:1})]),_:1},16,["elevation"])]),default:l(()=>[e(qn,{camp:s.participant.Camp,"option-and-qf":{options:s.participant.Participant.OptionPrix,quotientFamilial:s.participant.Participant.QuotientFamilial},onUpdate:C[1]||(C[1]=P=>{s.participant.Participant.OptionPrix=P.options,s.participant.Participant.QuotientFamilial=P.quotientFamilial,c.value=!1,a("update",s.participant.Participant)})},null,8,["camp","option-and-qf"])]),_:1},8,["disabled","modelValue"])]),_:1}),e(b,{"align-self":"center",class:"text-center"},{default:l(()=>[i.value.length?Q("",!0):(y(),w(fe,{key:0,label:""},{default:l(()=>[...C[23]||(C[23]=[g("Aucune aide",-1)])]),_:1})),(y(!0),z(le,null,ce(i.value,P=>(y(),w(fe,{class:"my-1","prepend-icon":"mdi-cash-plus",color:P.Valide?"green":"orange",onClick:j=>p.value=P},{close:l(()=>[e(xe,{icon:"mdi-close-circle",onClick:Je(j=>k.value=P,["stop"])},null,8,["onClick"])]),default:l(()=>[g(" "+M(v.value[P.IdStructureaide].Nom)+" : "+M(U(_e).montant(P.Valeur)),1)]),_:2},1032,["color","onClick"]))),256))]),_:1}),e(b,{"align-self":"center",class:"text-center",cols:"3"},{default:l(()=>[e(Jn,{remises:s.participant.Participant.Remises,onUpdate:C[3]||(C[3]=P=>{s.participant.Participant.Remises=P,a("update",s.participant.Participant)})},null,8,["remises"])]),_:1}),e(b,{"align-self":"center",cols:"auto"},{default:l(()=>[e(Se,{location:"left"},{activator:l(({props:P})=>[e(L,se(P,{icon:"mdi-dots-vertical",size:"small"}),null,16)]),default:l(()=>[e(Ve,{density:"comfortable"},{default:l(()=>[e(H,{title:"Ajouter une aide","prepend-icon":"mdi-cash-plus",onClick:C[4]||(C[4]=P=>r.value={IdParticipant:s.participant.Participant.Id,IdStructure:0})}),e(ue),s.hasManyParticipants?(y(),w(H,{key:0,"prepend-icon":"mdi-arrow-expand",title:"Étendre les options et remises",subtitle:"... au reste du dossier",onClick:C[5]||(C[5]=P=>a("expand"))})):Q("",!0),e(ue),e(H,{title:"Supprimer","prepend-icon":"mdi-delete",onClick:C[6]||(C[6]=P=>u.value=!0)})]),_:1})]),_:1})]),_:1}),e(Z,{modelValue:u.value,"onUpdate:modelValue":C[8]||(C[8]=P=>u.value=P),"max-width":"600px"},{default:l(()=>[e(O,{title:"Supprimer le participant"},{default:l(()=>[e(B,null,{default:l(()=>[...C[24]||(C[24]=[g(" Confirmez-vous la suppression de ce participant ? ",-1),E("br",null,null,-1),g(" Attention, cette opération est irréversible. ",-1)])]),_:1}),e(oe,null,{default:l(()=>[e(ie),e(L,{color:"red",onClick:C[7]||(C[7]=P=>{a("delete"),u.value=!1})},{default:l(()=>[...C[25]||(C[25]=[g("Supprimer",-1)])]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"]),e(Z,{modelValue:I.value,"onUpdate:modelValue":C[10]||(C[10]=P=>I.value=P),"max-width":"650px"},{default:l(()=>[e(Kn,{modelValue:v.value,"onUpdate:modelValue":C[9]||(C[9]=P=>v.value=P)},null,8,["modelValue"])]),_:1},8,["modelValue"]),r.value!=null?(y(),w(Z,{key:0,"model-value":r.value!=null,"onUpdate:modelValue":C[14]||(C[14]=P=>r.value=null),width:"600px"},{default:l(()=>[e(O,{title:"Ajouter une aide extérieure"},{append:l(()=>[e(L,{onClick:C[11]||(C[11]=P=>I.value=!0),"prepend-icon":"mdi-view-list"},{default:l(()=>[...C[26]||(C[26]=[g(" Structures",-1)])]),_:1})]),default:l(()=>[e(B,null,{default:l(()=>[e(Oe,{variant:"outlined",density:"comfortable",label:"Structure",items:d.value,"model-value":r.value.IdStructure==0?null:r.value.IdStructure,"onUpdate:modelValue":C[12]||(C[12]=P=>r.value.IdStructure=P)},null,8,["items","model-value"])]),_:1}),e(oe,null,{default:l(()=>[e(ie),e(L,{color:"green",onClick:C[13]||(C[13]=P=>{a("createAide",r.value),r.value=null}),disabled:r.value.IdStructure==0},{default:l(()=>[...C[27]||(C[27]=[g("Créer",-1)])]),_:1},8,["disabled"])]),_:1})]),_:1})]),_:1},8,["model-value"])):Q("",!0),p.value!=null?(y(),w(Z,{key:1,"model-value":p.value!=null,"onUpdate:modelValue":C[19]||(C[19]=P=>p.value=null),"max-width":"800px"},{default:l(()=>[e(Gn,{aide:p.value,file:t.aidesFiles[p.value.Id],structures:v.value,participant:s.participant,onShowStructureaides:C[15]||(C[15]=P=>I.value=!0),onSave:C[16]||(C[16]=P=>{a("updateAide",P),p.value=null}),onDeleteFile:C[17]||(C[17]=P=>a("deleteFileAide",p.value.Id)),onUploadFile:C[18]||(C[18]=P=>a("uploadFileAide",P,p.value.Id))},null,8,["aide","file","structures","participant"])]),_:1},8,["model-value"])):Q("",!0),k.value!=null?(y(),w(Z,{key:2,"model-value":k.value!=null,"onUpdate:modelValue":C[21]||(C[21]=P=>k.value=null),"max-width":"600px"},{default:l(()=>[e(O,{title:"Supprimer l'aide"},{default:l(()=>[e(B,null,{default:l(()=>[...C[28]||(C[28]=[g(" Confirmez-vous la suppression de l'aide extérieure ? ",-1),E("br",null,null,-1),g(" Attention, cette opération est irréversible. ",-1)])]),_:1}),e(oe,null,{default:l(()=>[e(ie),e(L,{color:"red",onClick:C[20]||(C[20]=P=>{a("deleteAide",k.value.Id),k.value=null})},{default:l(()=>[...C[29]||(C[29]=[g("Supprimer",-1)])]),_:1})]),_:1})]),_:1})]),_:1},8,["model-value"])):Q("",!0)]),_:1}))}}),lu=K({__name:"DossierEditor",props:{dossier:{},camps:{}},emits:["updateDossier","createParticipant","updateParticipant","deleteParticipant","expandParticipant","createAide","updateAide","deleteAide","deleteFileAide","uploadFileAide"],setup(t,{emit:o}){const s=t,v=o,a=D(null);Te(n);const i=D(!0),m=D({});async function n(){const c=await x.StructureaidesGet();c!==void 0&&(i.value=!1,m.value=c||{})}return(c,u)=>(y(),w(O,{title:"Modifier le dossier"},{append:l(()=>[e(L,{onClick:u[0]||(u[0]=d=>a.value={IdCamp:0,IdPersonne:0,IdDossier:s.dossier.Dossier.Dossier.Id})},{prepend:l(()=>[e(xe,{color:"green"},{default:l(()=>[...u[9]||(u[9]=[g("mdi-plus",-1)])]),_:1})]),default:l(()=>[u[10]||(u[10]=g(" Ajouter un participant",-1))]),_:1})]),default:l(()=>[e(B,null,{default:l(()=>[e(h,null,{default:l(()=>[e(b,{cols:"3"},{default:l(()=>[e(Nn,{responsable:s.dossier.Dossier.Responsable,dossier:s.dossier.Dossier.Dossier,onSave:u[1]||(u[1]=d=>v("updateDossier",d))},null,8,["responsable","dossier"])]),_:1}),e(ue,{thickness:"2",vertical:""}),i.value?Q("",!0):(y(),w(b,{key:0},{default:l(()=>[u[11]||(u[11]=E("div",{class:"my-1"},null,-1)),(y(!0),z(le,null,ce(s.dossier.Dossier.Participants,d=>(y(),w(eu,{participant:d,aides:(s.dossier.Dossier.Aides||{})[d.Participant.Id],"aides-files":s.dossier.Dossier.AidesFiles||{},"has-many-participants":(s.dossier.Dossier.Participants?.length||0)>1,structures:m.value,"onUpdate:structures":u[2]||(u[2]=r=>m.value=r),onCreateAide:u[3]||(u[3]=r=>v("createAide",r)),onDeleteAide:u[4]||(u[4]=r=>v("deleteAide",r)),onUpdateAide:u[5]||(u[5]=r=>v("updateAide",r)),onDeleteFileAide:u[6]||(u[6]=r=>v("deleteFileAide",r)),onUploadFileAide:u[7]||(u[7]=(r,p)=>v("uploadFileAide",r,p)),onUpdate:u[8]||(u[8]=r=>v("updateParticipant",r)),onDelete:r=>v("deleteParticipant",d.Participant.Id),onExpand:r=>v("expandParticipant",d.Participant)},null,8,["participant","aides","aides-files","has-many-participants","structures","onDelete","onExpand"]))),256))]),_:1}))]),_:1})]),_:1})]),_:1}))}}),tu={class:"mr-1"},au=["onClick"],nu={class:"overflow-y-auto",style:{"max-height":"65vh"}},uu=["href"],iu=K({__name:"DossierDetailsPannel",props:{dossier:{},camps:{}},emits:["updateDossier","deleteDossier","mergeDossier","createParticipant","updateParticipant","deleteParticipant","expandParticipant","createAide","updateAide","deleteAide","deleteFileAide","uploadFileAide","createPaiement","updatePaiement","deletePaiement","sendMessage","deleteMessage","sendFacture"],setup(t,{expose:o,emit:s}){const v=t,a=s;o({showEditPaiement:r,showEditDossier:c});const i=F(()=>ra(v.dossier.Dossier,x.isFondsSoutien?Ul.FondSoutien:Ul.Backoffice)),m=D(!1),n=D(!1);function c(){n.value=!0}const u=D(null),d=D(null);function r(S){d.value=S}const p="ACVE",k=D(!1);async function I(){await dl(v.dossier.EspacepersoURL),x.showMessage("Lien vers l'espace personnel copié.")}async function _(){await dl(v.dossier.VirementCode),x.showMessage("Identifiant de virement copié.")}async function C(S){await dl(S),x.showMessage("IBAN copié.")}const P=D(!1),j=D(!1),G=D("");return(S,f)=>{const ee=Na,ye=sl,W=il;return y(),w(O,{class:"ml-2"},{title:l(()=>[f[36]||(f[36]=g(" Responsable ",-1)),E("a",{href:"/annuaire",onClick:f[0]||(f[0]=Je(A=>U(We)(v.dossier.Dossier.IdResponsable),["prevent"]))},M(v.dossier.Dossier.Responsable),1)]),subtitle:l(()=>[f[37]||(f[37]=g(" Participants ",-1)),(y(!0),z(le,null,ce(v.dossier.Dossier.Participants,A=>(y(),z("span",tu,[E("a",{href:"/camps",onClick:Je(te=>U(Dl)(A.Participant),["prevent"])},M(U(Ne).prenomN(A.Personne)),9,au)]))),256))]),append:l(()=>[e(L,{icon:"mdi-pencil",onClick:f[1]||(f[1]=A=>n.value=!0),class:"mx-1"}),e(Se,null,{activator:l(({props:A})=>[e(L,se(A,{icon:"mdi-dots-vertical",size:"small",class:"mx-1"}),null,16)]),default:l(()=>[e(Ve,{density:"compact"},{default:l(()=>[e(H,{"prepend-icon":"mdi-email",onClick:f[2]||(f[2]=A=>j.value=!0),title:"Envoyer un message",subtitle:"Notification par email"}),e(H,{"prepend-icon":"mdi-invoice-send",onClick:f[3]||(f[3]=A=>a("sendFacture")),title:"Envoyer une demande de règlement",subtitle:"Notification par email"}),e(ue),e(H,{"prepend-icon":"mdi-cash-plus",onClick:f[4]||(f[4]=A=>a("createPaiement")),title:"Ajouter un paiement"}),e(ue),e(H,{"prepend-icon":"mdi-link",onClick:f[5]||(f[5]=A=>k.value=!0),title:"Afficher les identifiants"}),e(ue),e(H,{"prepend-icon":"mdi-file-move",onClick:f[6]||(f[6]=A=>P.value=!0),title:"Fusionner vers ..."}),e(ue),e(H,{onClick:f[7]||(f[7]=A=>m.value=!0),title:"Supprimer"},{prepend:l(()=>[e(xe,{color:"red"},{default:l(()=>[...f[38]||(f[38]=[g("mdi-delete",-1)])]),_:1})]),_:1})]),_:1})]),_:1})]),default:l(()=>[e(B,null,{default:l(()=>[e(h,null,{default:l(()=>[e(b,{class:"ml-2 mb-1 text-center"},{default:l(()=>[e(Se,null,{activator:l(({props:A})=>[e(fe,se(A,{"prepend-icon":"mdi-currency-eur",color:U(_e).colorStatutPaiement(v.dossier.Dossier.Bilan.Statut)}),{default:l(()=>[g(M(v.dossier.Dossier.Bilan.Recu)+" payé sur "+M(v.dossier.Dossier.Bilan.Demande),1)]),_:1},16,["color"])]),default:l(()=>[e(In,{dossier:v.dossier.Dossier},null,8,["dossier"])]),_:1})]),_:1})]),_:1}),E("div",nu,[e(Ea,{side:"end",class:"mt-4",density:"compact"},{default:l(()=>[(y(!0),z(le,null,ce(i.value,(A,te)=>(y(),w(ee,{event:A,key:te,onEditPaiement:f[8]||(f[8]=ne=>d.value=ne),onDeleteMessage:f[9]||(f[9]=ne=>a("deleteMessage",ne))},null,8,["event"]))),128))]),_:1})])]),_:1}),e(Z,{modelValue:m.value,"onUpdate:modelValue":f[11]||(f[11]=A=>m.value=A),"max-width":"600px"},{default:l(()=>[e(O,{title:"Supprimer le dossier"},{default:l(()=>[e(B,null,{default:l(()=>[...f[39]||(f[39]=[g(" Confirmez-vous la suppression du dossier et de ses participants ? ",-1),E("br",null,null,-1),E("br",null,null,-1),g(" Attention, cette opération est irréversible. ",-1)])]),_:1}),e(oe,null,{default:l(()=>[e(ie),e(L,{color:"red",onClick:f[10]||(f[10]=A=>{a("deleteDossier"),m.value=!1})},{default:l(()=>[...f[40]||(f[40]=[g("Supprimer",-1)])]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"]),u.value!=null?(y(),w(Z,{key:0,"model-value":u.value!=null,"onUpdate:modelValue":f[15]||(f[15]=A=>u.value=null),"max-width":"600px"},{default:l(()=>[e(O,{title:"Ajouter un participant"},{default:l(()=>[e(B,null,{default:l(()=>[e(h,null,{default:l(()=>[e(b,{cols:"12"},{default:l(()=>[e(ye,{label:"Camp",camps:v.camps,modelValue:u.value.IdCamp,"onUpdate:modelValue":f[12]||(f[12]=A=>u.value.IdCamp=A)},null,8,["camps","modelValue"])]),_:1}),e(b,{cols:"12"},{default:l(()=>[e(W,{label:"Personne","initial-personne":"",modelValue:u.value.IdPersonne,"onUpdate:modelValue":f[13]||(f[13]=A=>u.value.IdPersonne=A),api:{SelectPersonne:U(x).SelectPersonne.bind(U(x))}},null,8,["modelValue","api"])]),_:1})]),_:1})]),_:1}),e(oe,null,{default:l(()=>[e(ie),e(L,{color:"green",disabled:u.value.IdPersonne==0||u.value.IdCamp==0,onClick:f[14]||(f[14]=A=>{a("createParticipant",u.value),u.value=null})},{default:l(()=>[...f[41]||(f[41]=[g("Ajouter",-1)])]),_:1},8,["disabled"])]),_:1})]),_:1})]),_:1},8,["model-value"])):Q("",!0),e(Z,{modelValue:n.value,"onUpdate:modelValue":f[26]||(f[26]=A=>n.value=A)},{default:l(()=>[e(lu,{dossier:v.dossier,camps:v.camps,onUpdateDossier:f[16]||(f[16]=A=>a("updateDossier",A)),onCreateParticipant:f[17]||(f[17]=A=>a("createParticipant",A)),onUpdateParticipant:f[18]||(f[18]=A=>a("updateParticipant",A)),onDeleteParticipant:f[19]||(f[19]=A=>a("deleteParticipant",A)),onExpandParticipant:f[20]||(f[20]=A=>a("expandParticipant",A)),onCreateAide:f[21]||(f[21]=A=>a("createAide",A)),onUpdateAide:f[22]||(f[22]=A=>a("updateAide",A)),onDeleteAide:f[23]||(f[23]=A=>a("deleteAide",A)),onDeleteFileAide:f[24]||(f[24]=A=>a("deleteFileAide",A)),onUploadFileAide:f[25]||(f[25]=(A,te)=>a("uploadFileAide",A,te))},null,8,["dossier","camps"])]),_:1},8,["modelValue"]),d.value!=null?(y(),w(Z,{key:1,"model-value":d.value!=null,"onUpdate:modelValue":f[29]||(f[29]=A=>d.value=null),"max-width":"600px"},{default:l(()=>[e(En,{paiement:d.value,onUpdate:f[27]||(f[27]=A=>{a("updatePaiement",A),d.value=null}),onDelete:f[28]||(f[28]=A=>{a("deletePaiement",d.value),d.value=null})},null,8,["paiement"])]),_:1},8,["model-value"])):Q("",!0),e(Z,{modelValue:k.value,"onUpdate:modelValue":f[30]||(f[30]=A=>k.value=A),"max-width":"800px"},{default:l(()=>[e(O,{title:"Liens et identifiants"},{default:l(()=>[e(B,null,{default:l(()=>[e(h,null,{default:l(()=>[e(b,{cols:"3"},{default:l(()=>[...f[42]||(f[42]=[g("Espace personnel",-1)])]),_:1}),e(b,{class:"text-truncate"},{default:l(()=>[E("a",{href:v.dossier.EspacepersoURL,target:"_blank"},M(v.dossier.EspacepersoURL),9,uu)]),_:1}),e(b,{"align-self":"center",cols:"auto"},{default:l(()=>[e(L,{size:"small",icon:"mdi-content-copy",onClick:I})]),_:1})]),_:1}),(y(!0),z(le,null,ce(v.dossier.BankAccounts,A=>(y(),w(h,null,{default:l(()=>[e(b,{cols:"3"},{default:l(()=>[g("RIB ("+M(U(p))+")",1)]),_:1}),e(b,{cols:"3"},{default:l(()=>[g(M(A[0]),1)]),_:2},1024),e(b,null,{default:l(()=>[g(M(A[1]),1)]),_:2},1024),e(b,{"align-self":"center",cols:"auto"},{default:l(()=>[e(L,{size:"small",icon:"mdi-content-copy",onClick:()=>C(A[1])},null,8,["onClick"])]),_:2},1024)]),_:2},1024))),256)),e(h,null,{default:l(()=>[e(b,{cols:"3"},{default:l(()=>[...f[43]||(f[43]=[g("Identification de virement",-1)])]),_:1}),e(b,null,{default:l(()=>[g(M(v.dossier.VirementCode),1)]),_:1}),e(b,{"align-self":"center",cols:"auto"},{default:l(()=>[e(L,{size:"small",icon:"mdi-content-copy",onClick:_})]),_:1})]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"]),e(Z,{modelValue:P.value,"onUpdate:modelValue":f[32]||(f[32]=A=>P.value=A),"max-width":"600px"},{default:l(()=>[e(gt,{from:v.dossier.Dossier.Dossier.Id,onMerge:f[31]||(f[31]=A=>{a("mergeDossier",A),P.value=!1})},null,8,["from"])]),_:1},8,["modelValue"]),e(Z,{modelValue:j.value,"onUpdate:modelValue":f[35]||(f[35]=A=>j.value=A),"max-width":"600px"},{default:l(()=>[e(O,{title:"Nouveau message",subtitle:"Envoie un message sur le fil de suivi et une notification par mail."},{default:l(()=>[e(B,null,{default:l(()=>[e(h,null,{default:l(()=>[e(b,null,{default:l(()=>[e(cl,{rows:"5",variant:"outlined",modelValue:G.value,"onUpdate:modelValue":f[33]||(f[33]=A=>G.value=A)},null,8,["modelValue"])]),_:1})]),_:1})]),_:1}),e(oe,null,{default:l(()=>[e(ie),e(L,{disabled:!G.value.length,onClickOnce:f[34]||(f[34]=A=>{a("sendMessage",G.value),j.value=!1})},{default:l(()=>[...f[44]||(f[44]=[g("Envoyer",-1)])]),_:1},8,["disabled"])]),_:1})]),_:1})]),_:1},8,["modelValue"])]),_:1})}}}),su=K({__name:"CreateDossierCard",emits:["create"],setup(t,{emit:o}){const s=o,v=D(0);return(a,i)=>{const m=il;return y(),w(O,{title:"Créer un dossier"},{default:l(()=>[e(B,null,{default:l(()=>[e(h,null,{default:l(()=>[e(b,null,{default:l(()=>[e(m,{label:"Responsable légal",modelValue:v.value,"onUpdate:modelValue":i[0]||(i[0]=n=>v.value=n),"initial-personne":"",api:{SelectPersonne:U(x).SelectPersonne.bind(U(x))}},null,8,["modelValue","api"])]),_:1})]),_:1})]),_:1}),e(oe,null,{default:l(()=>[e(ie),e(L,{color:"green",disabled:v.value==0,onClick:i[1]||(i[1]=n=>s("create",v.value))},{default:l(()=>[...i[2]||(i[2]=[g("Créer",-1)])]),_:1},8,["disabled"])]),_:1})]),_:1})}}}),ou=K({__name:"DossierList",props:De({camps:{},allowFondsSoutien:{type:Boolean},selected:{}},{query:{required:!0},queryModifiers:{}}),emits:De(["click","update"],["update:query"]),setup(t,{expose:o,emit:s}){const v=t,a=s,i=Pe(t,"query");o({searchDossiers:n}),Ae(()=>i.value,n,{immediate:!0});const m=D(null);async function n(){const c=await x.DossiersSearch(i.value);c!==void 0&&(m.value=c,a("update",c))}return(c,u)=>{const d=sl,r=it;return y(),z("div",null,[e(h,null,{default:l(()=>[e(b,{"align-self":"center"},{default:l(()=>[e(r,{density:"compact",variant:"outlined","prepend-inner-icon":"mdi-magnify",label:"Rechercher un dossier","hide-details":"",clearable:"",modelValue:i.value.Pattern,"onUpdate:modelValue":[u[5]||(u[5]=p=>i.value.Pattern=p),n]},{"append-inner":l(()=>[i.value.IdCamp.Valid?(y(),w(fe,{key:0,class:"ml-1",size:"small","prepend-icon":"mdi-bed"},{default:l(()=>[g(M(v.camps.find(p=>p.Id==i.value.IdCamp.Id)?.Label),1)]),_:1})):Q("",!0),i.value.Attente!=U(pa).EmptyQA?(y(),w(fe,{key:1,class:"ml-1",size:"small","prepend-icon":"mdi-clock"},{default:l(()=>[g(M(U(Rl)[i.value.Attente]),1)]),_:1})):Q("",!0),i.value.Reglement!=U(fa).EmptyQR?(y(),w(fe,{key:2,class:"ml-1",size:"small","prepend-icon":"mdi-currency-eur"},{default:l(()=>[g(M(U(Fl)[i.value.Reglement]),1)]),_:1})):Q("",!0),i.value.OnlyFondSoutien?(y(),w(fe,{key:3,class:"ml-1",size:"small"},{default:l(()=>[...u[6]||(u[6]=[g(" Fonds de soutien ",-1)])]),_:1})):Q("",!0)]),append:l(()=>[e(Se,{location:"left top","close-on-content-click":!1},{activator:l(({props:p})=>[e(L,se(p,{size:"small",variant:"flat",icon:""}),{default:l(()=>[e(xe,null,{default:l(()=>[...u[7]||(u[7]=[g("mdi-filter-cog",-1)])]),_:1}),e(je,{activator:"parent",text:"Autres critères de recherche"})]),_:1},16)]),default:l(()=>[e(O,{"min-width":"400px",title:"Filtrer les dossiers"},{default:l(()=>[e(B,null,{default:l(()=>[e(h,null,{default:l(()=>[e(b,null,{default:l(()=>[e(d,{label:"Camp",camps:v.camps,"model-value":U(ca)(U(va)(i.value.IdCamp)),"onUpdate:modelValue":u[0]||(u[0]=p=>{i.value.IdCamp=U(da)(U(ma)(p)),n()})},null,8,["camps","model-value"])]),_:1})]),_:1}),e(h,null,{default:l(()=>[e(b,null,{default:l(()=>[e(Oe,{density:"compact",variant:"outlined",label:"Liste d'attente",modelValue:i.value.Attente,"onUpdate:modelValue":[u[1]||(u[1]=p=>i.value.Attente=p),n],items:U(nl)(U(Rl)),"hide-details":""},null,8,["modelValue","items"])]),_:1})]),_:1}),e(h,null,{default:l(()=>[e(b,null,{default:l(()=>[e(Oe,{density:"compact",variant:"outlined",label:"Réglement",modelValue:i.value.Reglement,"onUpdate:modelValue":[u[2]||(u[2]=p=>i.value.Reglement=p),n],items:U(nl)(U(Fl)),"hide-details":""},null,8,["modelValue","items"])]),_:1})]),_:1}),e(h,null,{default:l(()=>[e(b,null,{default:l(()=>[e(kl,{label:"Trier selon les nouveaux messages",hint:"Affiche les nouveaux messages en premier.","persistent-hint":"",density:"compact",color:"light-blue-darken-3",modelValue:i.value.SortByNewMessages,"onUpdate:modelValue":[u[3]||(u[3]=p=>i.value.SortByNewMessages=p),n]},null,8,["modelValue"])]),_:1})]),_:1}),v.allowFondsSoutien?(y(),w(h,{key:0},{default:l(()=>[e(b,null,{default:l(()=>[e(kl,{label:"Fonds de soutien",hint:"N'affiche que les dossiers demandant le fonds de soutien.","persistent-hint":"",density:"compact",color:"orange",modelValue:i.value.OnlyFondSoutien,"onUpdate:modelValue":[u[4]||(u[4]=p=>i.value.OnlyFondSoutien=p),n]},null,8,["modelValue"])]),_:1})]),_:1})):Q("",!0)]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"])]),_:1})]),_:1}),m.value!=null?(y(),w(Ve,{key:0,class:"mt-2",selected:v.selected?[v.selected]:void 0},{default:l(()=>[m.value.Dossiers?.length?Q("",!0):(y(),w(H,{key:0,class:"text-center"},{default:l(()=>[...u[8]||(u[8]=[E("i",null,"Aucun dossier ne correspond à votre recherche.",-1)])]),_:1})),(y(!0),z(le,null,ce(m.value.Dossiers,(p,k)=>(y(),w(H,{rounded:"",key:k,title:p.Responsable,subtitle:p.Participants,value:p.Id,onClick:I=>a("click",p),class:"my-1"},pl({_:2},[p.NewMessages?{name:"append",fn:l(()=>[e(La,{color:"light-blue-darken-3",content:p.NewMessages},null,8,["content"])]),key:"0"}:void 0]),1032,["title","subtitle","value","onClick"]))),128))]),_:1},8,["selected"])):Q("",!0)])}}}),ru=K({__name:"SendDocumentsCampCard",props:{camps:{}},emits:["send"],setup(t,{emit:o}){const s=t,v=o,a=D(0),i=D(null);async function m(){const u=await x.EventsSendDocumentsCampPreview({idCamp:a.value});u!==void 0&&(i.value=u,n.value=(u.Dossiers||[]).filter(d=>!d.DocumentsSent).map(d=>d.Id))}const n=D([]),c=F(()=>n.value.length==(i.value?.Dossiers||[]).length);return(u,d)=>{const r=sl;return y(),w(O,{title:"Envoyer les documents d'un séjour"},{default:l(()=>[e(B,null,{default:l(()=>[e(h,null,{default:l(()=>[e(b,{"align-self":"center",cols:"5"},{default:l(()=>[e(r,{camps:s.camps,label:"Séjour",modelValue:a.value,"onUpdate:modelValue":[d[0]||(d[0]=p=>a.value=p),m]},null,8,["camps","modelValue"])]),_:1}),e(b,{"align-self":"center"},{default:l(()=>[i.value?(y(),w(O,{key:0,subtitle:"Dossiers à contacter"},pl({default:l(()=>[e(B,null,{default:l(()=>[e(Ve,{selectable:"",selected:n.value,"onUpdate:selected":d[2]||(d[2]=p=>n.value=p),"select-strategy":"leaf"},{default:l(()=>[(y(!0),z(le,null,ce(i.value.Dossiers,p=>(y(),w(H,{title:p.Responsable,subtitle:p.Participants,value:p.Id,rounded:"",class:"my-1"},{append:l(({isSelected:k,select:I})=>[e(h,null,{default:l(()=>[e(b,null,{default:l(()=>[p.DocumentsSent?(y(),w(fe,{key:0,color:"green",class:"mr-2"},{default:l(()=>[...d[4]||(d[4]=[g("Envoyés",-1)])]),_:1})):Q("",!0)]),_:2},1024),e(b,null,{default:l(()=>[e(rt,{density:"compact","hide-details":"","model-value":k,"onUpdate:modelValue":I},null,8,["model-value","onUpdate:modelValue"])]),_:2},1024)]),_:2},1024)]),_:2},1032,["title","subtitle","value"]))),256))]),_:1},8,["selected"])]),_:1})]),_:2},[i.value.Dossiers?.length?{name:"append",fn:l(()=>[e(ze,{label:"Tout sélectionner",density:"compact","hide-details":"",indeterminate:!!n.value.length&&n.value.length!=(i.value.Dossiers||[]).length,"model-value":n.value.length==(i.value.Dossiers||[]).length,"onUpdate:modelValue":d[1]||(d[1]=p=>n.value=c.value?[]:(i.value.Dossiers||[]).map(k=>k.Id))},null,8,["indeterminate","model-value"])]),key:"0"}:void 0]),1024)):Q("",!0)]),_:1})]),_:1})]),_:1}),e(oe,null,{default:l(()=>[e(ie),e(L,{disabled:!a.value||!n.value.length,onClick:d[3]||(d[3]=p=>v("send",a.value,n.value)),"prepend-icon":"mdi-send"},{default:l(()=>[...d[5]||(d[5]=[g(" Envoyer ",-1)])]),_:1},8,["disabled"])]),_:1})]),_:1})}}}),du=K({__name:"SendRelancePaiementCard",props:{camps:{}},emits:["send"],setup(t,{emit:o}){const s=t,v=o,a=D(0),i=D([]);async function m(){const u=await x.EventsSendRelancePaiementPreview({idCamp:a.value});u!==void 0&&(i.value=u||[],n.value=(u||[]).map(d=>d.Id))}const n=D([]),c=F(()=>n.value.length==i.value.length);return(u,d)=>{const r=sl;return y(),w(O,{title:"Envoyer une relance de paiement"},{default:l(()=>[e(B,null,{default:l(()=>[e(h,null,{default:l(()=>[e(b,{"align-self":"center",cols:"5"},{default:l(()=>[e(r,{camps:s.camps,label:"Séjour",modelValue:a.value,"onUpdate:modelValue":[d[0]||(d[0]=p=>a.value=p),m]},null,8,["camps","modelValue"])]),_:1}),e(b,{"align-self":"center"},{default:l(()=>[i.value?(y(),w(O,{key:0,subtitle:"Dossiers à relancer"},pl({default:l(()=>[e(B,null,{default:l(()=>[e(Ve,{selectable:"",selected:n.value,"onUpdate:selected":d[2]||(d[2]=p=>n.value=p),"select-strategy":"leaf",density:"comfortable"},{default:l(()=>[(y(!0),z(le,null,ce(i.value,(p,k)=>(y(),w(H,{key:p.Id,title:p.Responsable,subtitle:U(ya)(p.LastEventFacture)?"":`Dernière demande : ${U(_e).time(p.LastEventFacture)}`,value:p.Id,rounded:"",class:"my-1"},{append:l(({isSelected:I,select:_})=>[e(h,null,{default:l(()=>[e(b,{"align-self":"center"},{default:l(()=>[e(fe,{class:"mr-2",color:U(_e).colorStatutPaiement(p.Bilan.Statut)},{default:l(()=>[g(M(p.Bilan.Recu)+" / "+M(p.Bilan.Demande),1)]),_:2},1032,["color"])]),_:2},1024),e(b,{"align-self":"center"},{default:l(()=>[e(rt,{density:"compact","hide-details":"","model-value":I,"onUpdate:modelValue":_},null,8,["model-value","onUpdate:modelValue"])]),_:2},1024)]),_:2},1024)]),_:2},1032,["title","subtitle","value"]))),128))]),_:1},8,["selected"])]),_:1})]),_:2},[i.value.length?{name:"append",fn:l(()=>[e(ze,{label:"Tout sélectionner",density:"compact","hide-details":"",indeterminate:!!n.value.length&&n.value.length!=i.value.length,"model-value":n.value.length==i.value.length,"onUpdate:modelValue":d[1]||(d[1]=p=>n.value=c.value?[]:i.value.map(k=>k.Id))},null,8,["indeterminate","model-value"])]),key:"0"}:void 0]),1024)):Q("",!0)]),_:1})]),_:1})]),_:1}),e(oe,null,{default:l(()=>[e(ie),e(L,{disabled:!a.value||!n.value.length,onClick:d[3]||(d[3]=p=>v("send",a.value,n.value)),"prepend-icon":"mdi-send"},{default:l(()=>[...d[4]||(d[4]=[g(" Envoyer ",-1)])]),_:1},8,["disabled"])]),_:1})]),_:1})}}}),mu=K({__name:"RemisesHintsCard",props:{allCamps:{}},setup(t){const o=t;Te(()=>{a.value=o.allCamps.filter(u=>!u.IsOld).map(u=>u.Id),m()});const s=D([]),v=D(!1),a=D([]),i=D(null);async function m(){const u=await x.DossiersRemisesHint({IdCamps:a.value});u!==void 0&&(i.value=u||[])}const n=D([]);async function c(){const u=i.value;if(!n.value.length||!u)return;const d=n.value.map(p=>u[p]),r=await x.DossiersApplyRemisesHints(d);n.value=[],r!==void 0&&(x.showMessage("Remises appliquées avec succès."),m())}return(u,d)=>(y(),w(O,{title:"Estimer les remises",subtitle:"Seules les nouvelles remises sont affichées."},{append:l(()=>[e(L,{onClick:d[0]||(d[0]=r=>{s.value=a.value,v.value=!0}),"prepend-icon":"mdi-cog"},{default:l(()=>[...d[5]||(d[5]=[g(" Séjours ",-1)])]),_:1}),e(ue,{vertical:"",thickness:"1",class:"mx-2"}),e(L,{disabled:!n.value.length,onClick:c},{default:l(()=>[...d[6]||(d[6]=[g("Appliquer les remises",-1)])]),_:1},8,["disabled"])]),default:l(()=>[e(B,null,{default:l(()=>[i.value==null?(y(),w(Ge,{key:0})):(y(),w(Ve,{key:1,"select-strategy":"leaf",selected:n.value,"onUpdate:selected":d[1]||(d[1]=r=>n.value=r),color:"primary"},{default:l(()=>[i.value.length?Q("",!0):(y(),w(H,{key:0,class:"font-italic"},{default:l(()=>[...d[7]||(d[7]=[g(" Aucune nouvelle remise à appliquer. ",-1)])]),_:1})),(y(!0),z(le,null,ce(i.value,(r,p)=>(y(),w(H,{title:r.Personne,subtitle:r.Camp,value:p,rounded:"",class:"my-1"},{append:l(()=>[e(h,{style:{width:"200px"}},{default:l(()=>[e(b,{cols:"6"},{default:l(()=>[r.Hint.ReducInscrits?(y(),w(fe,{key:0,"prepend-icon":"mdi-account-multiple",class:"mx-1",elevation:"1"},{default:l(()=>[g(M(r.Hint.ReducInscrits)+" % ",1),e(je,{activator:"parent","content-class":"ma-0 pa-0"},{default:l(()=>[e(O,{subtitle:"Autres inscrits de la même famille"},{default:l(()=>[e(B,null,{default:l(()=>[(y(!0),z(le,null,ce(r.AutresInscrits,k=>(y(),w(fe,{class:"mx-1"},{default:l(()=>[g(M(k.Personne)+" ("+M(k.Camp)+")",1)]),_:2},1024))),256))]),_:2},1024)]),_:2},1024)]),_:2},1024)]),_:2},1024)):Q("",!0)]),_:2},1024),e(b,{cols:"6"},{default:l(()=>[r.Hint.ReducEquipiers?(y(),w(fe,{key:0,"prepend-icon":"mdi-account-hard-hat",class:"mx-1",elevation:"1"},{default:l(()=>[g(M(r.Hint.ReducEquipiers)+" % ",1),e(je,{activator:"parent","content-class":"ma-0 pa-0"},{default:l(()=>[e(O,{subtitle:"Equipiers de la même famille"},{default:l(()=>[e(B,null,{default:l(()=>[(y(!0),z(le,null,ce(r.Equipiers,k=>(y(),w(fe,{class:"mx-1"},{default:l(()=>[g(M(k.Personne)+" ("+M(k.Camp)+")",1)]),_:2},1024))),256))]),_:2},1024)]),_:2},1024)]),_:2},1024)]),_:2},1024)):Q("",!0)]),_:2},1024)]),_:2},1024)]),_:2},1032,["title","subtitle","value"]))),256))]),_:1},8,["selected"]))]),_:1}),e(Z,{modelValue:v.value,"onUpdate:modelValue":d[4]||(d[4]=r=>v.value=r),"max-width":"600px"},{default:l(()=>[e(O,{title:"Choix des séjours"},{default:l(()=>[e(B,null,{default:l(()=>[e(bt,{"all-camps":o.allCamps,modelValue:s.value,"onUpdate:modelValue":d[2]||(d[2]=r=>s.value=r)},null,8,["all-camps","modelValue"])]),_:1}),e(oe,null,{default:l(()=>[e(ie),e(L,{onClick:d[3]||(d[3]=r=>{a.value=s.value,v.value=!1,m()})},{default:l(()=>[...d[8]||(d[8]=[g("Appliquer",-1)])]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"])]),_:1}))}}),cu={key:1,class:"text-center font-italic my-6"},vu=K({__name:"PannelDossiers",props:{initialDossier:{}},setup(t){const o=t;Te(()=>{m(),o.initialDossier!==void 0&&d(o.initialDossier)}),Ae(()=>o.initialDossier,()=>{o.initialDossier!==void 0&&d(o.initialDossier)});const s=Ll("detailsPannel"),v=D(null),a=D(Ua()),i=D([]);async function m(){const T=await x.GetCamps();T!==void 0&&(i.value=T||[])}function n(T){v.value={length:T.Dossiers?.length||0,total:T.Total}}const c=Ll("dossierList");function u(){c.value?.searchDossiers()}async function d(T){await p(T),a.value=Ra(T)}const r=D(null);async function p(T){const Y=await x.DossiersLoad({id:T});Y!==void 0&&(r.value=Y)}async function k(T){p(T.Id),await x.EventsMarkMessagesSeen({idDossier:T.Id})!==void 0&&u()}async function I(){r.value!=null&&p(r.value.Dossier.Dossier.Id)}const _=D(!1);async function C(T){_.value=!1;const Y=await x.DossiersCreate({idResponsable:T});Y!==void 0&&(x.showMessage("Dossier créé avec succès."),await d(Y.Id),s.value?.showEditDossier())}async function P(T){const Y=await x.DossiersUpdate(T);Y!==void 0&&(x.showMessage("Dossier mis à jour avec succès."),r.value!=null&&(r.value.Dossier.Dossier=T,r.value.Dossier.Responsable=Y.Responsable),u())}async function j(){if(r.value==null)return;const T=r.value.Dossier.Dossier.Id;await x.DossiersDelete({id:T})!==void 0&&(x.showMessage("Dossier supprimé avec succès."),r.value=null,u())}async function G(T){await x.DossiersMerge(T)!==void 0&&(x.showMessage("Dossier fusionné avec succès."),u(),p(T.To))}async function S(T){await x.ParticipantsCreate(T)!==void 0&&(x.showMessage("Participant ajouté avec succès."),I())}async function f(T){await x.ParticipantsUpdate(T)!==void 0&&(x.showMessage("Réglages du participant modifiés avec succès."),I())}async function ee(T){await x.ParticipantsDelete({id:T})!==void 0&&(x.showMessage("Participant supprimé avec succès."),I())}async function ye(T){if(r.value==null)return;const Y=r.value.Dossier.Participants?.map(ve=>ve.Participant).filter(ve=>ve.Id!=T.Id)||[];!Y.length||(Y.forEach(ve=>{ve.Remises=T.Remises,ve.QuotientFamilial=T.QuotientFamilial,ve.IdCamp==T.IdCamp&&(ve.OptionPrix=T.OptionPrix)}),(await Promise.all(Y.map(ve=>x.ParticipantsUpdate(ve)))).includes(void 0))||(x.showMessage("Réglages des participants modifiés avec succès."),I())}async function W(T){const Y=await x.AidesCreate(T);if(Y===void 0||(x.showMessage("Aide ajoutée avec succès."),r.value==null))return;const de=r.value.Dossier.Aides||{},ve=de[T.IdParticipant]||{};ve[Y.Id]=Y,de[T.IdParticipant]=ve,r.value.Dossier.Aides=de}async function A(T){await x.AidesUpdate(T)!==void 0&&(x.showMessage("Aide modifiée avec succès."),I())}async function te(T){await x.AidesJustificatifDelete({idAide:T})!==void 0&&(x.showMessage("Justificatif supprimé avec succès."),r.value!=null&&r.value.Dossier.AidesFiles&&delete r.value.Dossier.AidesFiles[T])}async function ne(T,Y){const de=await x.AidesJustificatifUpload(T,{idAide:Y});if(de!==void 0&&(x.showMessage("Justificatif téléversé avec succès."),r.value!=null)){const ve=r.value.Dossier.AidesFiles||{};ve[Y]=de,r.value.Dossier.AidesFiles=ve}}async function N(T){await x.AidesDelete({id:T})!==void 0&&(x.showMessage("Aide supprimée avec succès."),I())}async function q(){if(r.value==null)return;const T=await x.PaiementsCreate({idDossier:r.value.Dossier.Dossier.Id});T!==void 0&&(x.showMessage("Paiement créé avec succès."),I(),s.value?.showEditPaiement(T))}async function re(T){await x.PaiementsUpdate(T)!==void 0&&(x.showMessage("Paiement modifié avec succès."),I())}async function X(T){await x.PaiementsDelete({id:T.Id})!==void 0&&(x.showMessage("Paiement supprimé avec succès."),I())}async function be(T){r.value==null||await x.EventsSendMessage({IdDossier:r.value.Dossier.Dossier.Id,Contenu:T})===void 0||(x.showMessage("Message envoyé avec succès."),I())}async function ge(T){await x.EventsDelete({id:T.Id})!==void 0&&(x.showMessage("Message supprimé avec succès."),I())}async function J(){r.value==null||await x.EventsSendFacture({idDossier:r.value.Dossier.Dossier.Id})===void 0||(x.showMessage("Demande de règlement envoyé avec succès."),I())}const V=D(!1),$=D(null);async function R(T,Y){$.value={Current:0,Total:Y.length};const de=await x.EventsSendDocumentsCamp({IdCamp:T,IdDossiers:Y});if(de===void 0){$.value=null;return}await Vl(de,ve=>$.value=ve,ve=>x.onError("Envoi des documents",ve)),$.value=null,I(),x.showMessage("Documents du séjour envoyés avec succès.")}const pe=D(!1),ae=D(null);async function Me(T,Y){ae.value={Current:0,Total:Y.length};const de=await x.EventsSendRelancePaiement({IdDossiers:Y});if(de===void 0){ae.value=null;return}await Vl(de,ve=>ae.value=ve,ve=>x.onError("Envoi de la relance",ve)),ae.value=null,I(),x.showMessage("Toutes les relances ont été envoyées avec succès.")}const $e=D(!1);return(T,Y)=>(y(),w(h,{"no-gutters":"",class:"ma-2"},{default:l(()=>[e(b,{cols:"6"},{default:l(()=>[e(O,{title:"Dossiers",subtitle:v.value==null?"-":`${v.value.length} affiché(s) / ${v.value.total}`},{append:l(()=>[e(L,{icon:"",size:"small",onClick:Y[0]||(Y[0]=de=>_.value=!0)},{default:l(()=>[e(xe,{color:"green"},{default:l(()=>[...Y[9]||(Y[9]=[g("mdi-plus",-1)])]),_:1})]),_:1}),e(ue,{thickness:"1",vertical:"",class:"mx-2"}),e(L,{size:"small","prepend-icon":"mdi-send-circle-outline"},{default:l(()=>[Y[10]||(Y[10]=g(" Actions ",-1)),e(Se,{activator:"parent"},{default:l(()=>[e(Ve,{density:"compact"},{default:l(()=>[e(H,{title:"Estimation des remises","prepend-icon":"mdi-finance",onClick:Y[1]||(Y[1]=de=>$e.value=!0)}),e(ue),e(H,{title:"Documents...",subtitle:"Paramétrer et envoyer les documents d'un séjour","prepend-icon":"mdi-mail",onClick:Y[2]||(Y[2]=de=>V.value=!0)}),e(ue),e(H,{title:"Relance de paiement...",subtitle:"Paramétrer et envoyer une relance, pour un séjour","prepend-icon":"mdi-invoice-send",onClick:Y[3]||(Y[3]=de=>pe.value=!0)})]),_:1})]),_:1})]),_:1})]),default:l(()=>[e(B,null,{default:l(()=>[e(ou,{camps:i.value,"allow-fonds-soutien":U(x).isFondsSoutien,selected:r.value?.Dossier.Dossier.Id,query:a.value,"onUpdate:query":Y[4]||(Y[4]=de=>a.value=de),onClick:k,onUpdate:n,ref_key:"dossierList",ref:c},null,8,["camps","allow-fonds-soutien","selected","query"])]),_:1})]),_:1},8,["subtitle"])]),_:1}),e(b,{cols:"6"},{default:l(()=>[r.value!=null?(y(),w(iu,{key:0,dossier:r.value,camps:i.value,onUpdateDossier:P,onDeleteDossier:j,onMergeDossier:G,onCreateParticipant:S,onUpdateParticipant:f,onDeleteParticipant:ee,onExpandParticipant:ye,onCreateAide:W,onDeleteAide:N,onUpdateAide:A,onDeleteFileAide:te,onUploadFileAide:ne,onCreatePaiement:q,onUpdatePaiement:re,onDeletePaiement:X,onSendMessage:be,onDeleteMessage:ge,onSendFacture:J,ref_key:"detailsPannel",ref:s},null,8,["dossier","camps"])):(y(),z("div",cu," Sélectionner un dossier... "))]),_:1}),e(Z,{modelValue:_.value,"onUpdate:modelValue":Y[5]||(Y[5]=de=>_.value=de),"max-width":"400px"},{default:l(()=>[e(su,{onCreate:C})]),_:1},8,["modelValue"]),e(Z,{modelValue:V.value,"onUpdate:modelValue":Y[6]||(Y[6]=de=>V.value=de),"max-width":"1000px"},{default:l(()=>[e(ru,{camps:i.value,onSend:R},null,8,["camps"])]),_:1},8,["modelValue"]),e(Z,{modelValue:pe.value,"onUpdate:modelValue":Y[7]||(Y[7]=de=>pe.value=de),"max-width":"1000px"},{default:l(()=>[e(du,{camps:i.value,onSend:Me},null,8,["camps"])]),_:1},8,["modelValue"]),e(Z,{"model-value":$.value!=null,"max-width":"400px",persistent:""},{default:l(()=>[$.value?(y(),w(_l,{key:0,title:"Envoi des documents en cours",current:$.value.Current,total:$.value.Total},null,8,["current","total"])):Q("",!0)]),_:1},8,["model-value"]),e(Z,{"model-value":ae.value!=null,"max-width":"400px",persistent:""},{default:l(()=>[ae.value?(y(),w(_l,{key:0,title:"Envoi des relances en cours",current:ae.value.Current,total:ae.value.Total},null,8,["current","total"])):Q("",!0)]),_:1},8,["model-value"]),e(Z,{modelValue:$e.value,"onUpdate:modelValue":Y[8]||(Y[8]=de=>$e.value=de),"max-width":"800px"},{default:l(()=>[e(mu,{"all-camps":i.value},null,8,["all-camps"])]),_:1},8,["modelValue"])]),_:1}))}}),pu=K({__name:"inscriptions",setup(t){const o=ul(),s=F(()=>ku(o.currentRoute.value.query)),v=F(()=>s.value.tab||"insc"),a=F(()=>s.value.idDossier);function i(m){const n=o.currentRoute.value;o.push({path:n.path,query:{tab:m}})}return(m,n)=>(y(),z(le,null,[e(fl,{title:"Suivi des inscriptions"},{default:l(()=>[e(Ta,{"model-value":v.value,"onUpdate:modelValue":n[0]||(n[0]=c=>i(c))},{default:l(()=>[e(Nl,{value:"insc"},{default:l(()=>[...n[2]||(n[2]=[g("Inscriptions en attente",-1)])]),_:1}),e(Nl,{value:"doss"},{default:l(()=>[...n[3]||(n[3]=[g("Suivi des dossiers",-1)])]),_:1})]),_:1},8,["model-value"])]),_:1}),e(ha,{"model-value":v.value},{default:l(()=>[e(Ol,{value:"insc"},{default:l(()=>[e(Pn,{onGoTo:U(Cl),onEmpty:n[1]||(n[1]=c=>U(Cl)())},null,8,["onGoTo"])]),_:1}),e(Ol,{value:"doss"},{default:l(()=>[e(vu,{"initial-dossier":a.value},null,8,["initial-dossier"])]),_:1})]),_:1},8,["model-value"])],64))}}),fu=K({__name:"PersonneEdit",props:{personne:{}},emits:["save"],setup(t,{emit:o}){const s=t,v=o,a=D(we(s.personne)),i=F(()=>!!(a.value.Nom&&a.value.Prenom));return(m,n)=>{const c=Oa,u=Ba,d=Ya,r=Ha,p=ja;return y(),w(O,{title:"Editer le profil"},{default:l(()=>[e(B,null,{default:l(()=>[e(za,null,{default:l(()=>[e(h,null,{default:l(()=>[e(b,null,{default:l(()=>[e(me,{autofocus:"","hide-details":"",label:"Nom",density:"compact",variant:"outlined",modelValue:a.value.Nom,"onUpdate:modelValue":n[0]||(n[0]=k=>a.value.Nom=k)},null,8,["modelValue"])]),_:1}),e(b,null,{default:l(()=>[e(me,{"hide-details":"",label:"Prénom",density:"compact",variant:"outlined",modelValue:a.value.Prenom,"onUpdate:modelValue":n[1]||(n[1]=k=>a.value.Prenom=k)},null,8,["modelValue"])]),_:1}),e(b,{cols:"3"},{default:l(()=>[e(c,{modelValue:a.value.Sexe,"onUpdate:modelValue":n[2]||(n[2]=k=>a.value.Sexe=k)},null,8,["modelValue"])]),_:1})]),_:1}),e(h,null,{default:l(()=>[e(b,null,{default:l(()=>[e(u,{modelValue:a.value.DateNaissance,"onUpdate:modelValue":n[3]||(n[3]=k=>a.value.DateNaissance=k)},null,8,["modelValue"])]),_:1}),e(b,null,{default:l(()=>[e(me,{"hide-details":"",label:"Ville de naissance",density:"compact",variant:"outlined",modelValue:a.value.VilleNaissance,"onUpdate:modelValue":n[4]||(n[4]=k=>a.value.VilleNaissance=k)},null,8,["modelValue"])]),_:1}),e(b,null,{default:l(()=>[e(d,{label:"Département de naissance",modelValue:a.value.DepartementNaissance,"onUpdate:modelValue":n[5]||(n[5]=k=>a.value.DepartementNaissance=k)},null,8,["modelValue"])]),_:1}),e(b,null,{default:l(()=>[e(r,{modelValue:a.value.Nationnalite,"onUpdate:modelValue":n[6]||(n[6]=k=>a.value.Nationnalite=k)},null,8,["modelValue"])]),_:1})]),_:1}),e(h,null,{default:l(()=>[e(b,null,{default:l(()=>[e(me,{"hide-details":"",label:"Adresse",density:"compact",variant:"outlined",modelValue:a.value.Adresse,"onUpdate:modelValue":n[7]||(n[7]=k=>a.value.Adresse=k)},null,8,["modelValue"])]),_:1}),e(b,null,{default:l(()=>[e(me,{"hide-details":"",label:"Code postal",density:"compact",variant:"outlined",modelValue:a.value.CodePostal,"onUpdate:modelValue":n[8]||(n[8]=k=>a.value.CodePostal=k)},null,8,["modelValue"])]),_:1}),e(b,null,{default:l(()=>[e(me,{"hide-details":"",label:"Ville",density:"compact",variant:"outlined",modelValue:a.value.Ville,"onUpdate:modelValue":n[9]||(n[9]=k=>a.value.Ville=k)},null,8,["modelValue"])]),_:1}),e(b,null,{default:l(()=>[e(p,{modelValue:a.value.Pays,"onUpdate:modelValue":n[10]||(n[10]=k=>a.value.Pays=k)},null,8,["modelValue"])]),_:1})]),_:1}),e(h,null,{default:l(()=>[e(b,null,{default:l(()=>[e(me,{"hide-details":"",label:"Mail",density:"compact",variant:"outlined",modelValue:a.value.Mail,"onUpdate:modelValue":n[11]||(n[11]=k=>a.value.Mail=k)},null,8,["modelValue"])]),_:1}),e(b,null,{default:l(()=>[e(dt,{label:"Téléphone",modelValue:a.value.Tels,"onUpdate:modelValue":n[12]||(n[12]=k=>a.value.Tels=k),formatter:U(_e).tel},null,8,["modelValue","formatter"])]),_:1})]),_:1})]),_:1})]),_:1}),e(oe,null,{default:l(()=>[e(ie),e(L,{disabled:!i.value,onClick:n[13]||(n[13]=k=>v("save",a.value))},{default:l(()=>[...n[14]||(n[14]=[g("Enregistrer",-1)])]),_:1},8,["disabled"])]),_:1})]),_:1})}}}),yu=K({__name:"annuaire",setup(t){const o=ul(),s=F(()=>_u(o.currentRoute.value.query)),v=F(()=>s.value.idPersonne);Ae(()=>v.value,()=>v.value!==void 0?d(v.value):null,{immediate:!0});const a=D([]),i=D("");async function m(){if(!i.value)return;const r=await x.PersonnesGet({search:i.value});r!==void 0&&(a.value=r||[])}async function n(){const r=await x.PersonnesCreate();r!==void 0&&(x.showMessage("Profil créé avec succès."),a.value.push(r),We(r.Id))}const c=D(null);async function u(r){c.value=null;const p=await x.PersonnesUpdate(r);if(p===void 0)return;x.showMessage("Profil modifié avec succès."),We();const k=a.value.findIndex(I=>I.Id==r.Id);a.value[k]=p}async function d(r){const p=await x.PersonnesLoad({id:r});p!==void 0&&(c.value=p)}return(r,p)=>{const k=it;return y(),z(le,null,[e(fl,{title:"Annuaire : personnes et organismes"}),e(O,{class:"my-2 mx-auto","max-width":"600px"},{append:l(()=>[e(L,{color:"green",onClick:n},{default:l(()=>[...p[2]||(p[2]=[g("Créer un nouveau profil",-1)])]),_:1})]),default:l(()=>[e(B,null,{default:l(()=>[e(h,null,{default:l(()=>[e(b,null,{default:l(()=>[e(k,{"prepend-inner-icon":"mdi-magnify",label:"Recherche",modelValue:i.value,"onUpdate:modelValue":[p[0]||(p[0]=I=>i.value=I),m]},null,8,["modelValue"]),e(Ve,null,{default:l(()=>[(y(!0),z(le,null,ce(a.value,I=>(y(),w(H,{title:I.Label,subtitle:U(_e).dateNaissance(I.DateNaissance),"prepend-icon":U(_e).sexeIcon(I.Sexe),onClick:_=>U(We)(I.Id)},pl({_:2},[I.IsTemp?{name:"append",fn:l(()=>[e(fe,{"prepend-icon":"mdi-alert",color:"warning"},{default:l(()=>[...p[3]||(p[3]=[g(" Ce profil est temporaire et devrait être identifié. ",-1)])]),_:1})]),key:"0"}:void 0]),1032,["title","subtitle","prepend-icon","onClick"]))),256))]),_:1})]),_:1}),e(b)]),_:1})]),_:1}),c.value!=null?(y(),w(Z,{key:0,"model-value":c.value!=null,"onUpdate:modelValue":p[1]||(p[1]=I=>{c.value=null,U(We)(void 0)}),"max-width":"1000px"},{default:l(()=>[e(fu,{personne:c.value,onSave:u},null,8,["personne"])]),_:1},8,["model-value"])):Q("",!0)]),_:1})],64)}}}),bu=[{path:"/",component:Qa},{path:"/camps",component:_n},{path:"/inscriptions",component:pu},{path:"/annuaire",component:yu}],gu="/backoffice",el=Ca({history:xa(gu),routes:bu});el.onError((t,o)=>{t?.message?.includes?.("Failed to fetch dynamically imported module")?localStorage.getItem("vuetify:dynamic-reload")?console.error("Dynamic import error, reloading page did not fix it",t):(console.log("Reloading page to fix dynamic import error"),localStorage.setItem("vuetify:dynamic-reload","true"),location.assign(o.fullPath)):console.error(t)});el.isReady().then(()=>{localStorage.removeItem("vuetify:dynamic-reload")});function vl(t){return t?Number(t):void 0}function Vu(t){const o=t;return{idCamp:vl(o.idCamp),idParticipant:vl(o.idParticipant)}}function Dl(t){el.push({path:"/camps",query:{idCamp:t.IdCamp,idParticipant:t.Id}})}function ku(t){const o=t;return{tab:o.tab,idDossier:vl(o.idDossier)}}function Cl(t){el.push({path:"/inscriptions",query:{tab:"doss",idDossier:t}})}function _u(t){return{idPersonne:vl(t.idPersonne)}}function We(t){el.push({path:"/annuaire",query:{idPersonne:t}})}const Cu=["innerHTML"],xu=K({__name:"App",setup(t){const o=gl({text:"",color:"secondary",action:void 0,timeout:4e3}),s=D(""),v=D("");return x.onError=(i,m)=>{s.value=i,v.value=m},x.showMessage=(i,m,n)=>{o.text=i,o.color=m||"success",o.action=n,o.timeout=1e4,o.timeout=4e3},ul().beforeEach(async(i,m)=>{if(!x.hasToken()&&i.path!=="/")return{path:"/"}}),(i,m)=>{const n=ba("router-view");return y(),w(Va,null,{default:l(()=>[e(ga,null,{default:l(()=>[e(n),e(hl,{style:{"z-index":"10000"},app:"","model-value":o.text!="","onUpdate:modelValue":m[1]||(m[1]=c=>o.text=""),timeout:o.timeout,color:o.color,location:"bottom left","close-on-content-click":""},{default:l(()=>[g(M(o.text)+" ",1),o.action?(y(),w(L,{key:0,onClick:m[0]||(m[0]=c=>o.action.action()),class:"ml-2"},{default:l(()=>[g(M(o.action.title),1)]),_:1})):Q("",!0)]),_:1},8,["model-value","timeout","color"]),e(hl,{app:"","model-value":s.value!="","onUpdate:modelValue":m[2]||(m[2]=c=>s.value=""),timeout:4e3,color:"red"},{default:l(()=>[E("b",null,M(s.value),1),E("div",{innerHTML:v.value},null,8,Cu)]),_:1},8,["model-value"])]),_:1})]),_:1})}}}),kt=ka(xu);kt.use(_a).use(el);kt.mount("#app");
