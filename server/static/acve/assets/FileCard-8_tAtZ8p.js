import{$i as e,Ai as t,Br as n,D as r,Gi as i,Li as a,M as o,Mi as s,Ni as c,O as l,Ri as u,S as d,Sa as f,St as p,Ta as m,Tr as h,U as g,Ut as _,Wi as v,Xt as y,Yr as b,_ as x,f as S,fi as C,fr as w,g as T,ga as ee,gi as E,hr as te,ji as D,k as O,la as k,ma as A,oa as j,ri as M,sa as ne,ur as N,va as P,w as F,x as I,xa as L,xr as R,zi as z}from"./VSnackbar-DhWVHYEy.js";import{o as B,s as re,v as V,x as H}from"./VSelect-DnTwfvci.js";function ie(){function e(e){return[...e.dataTransfer?.items??[]].filter(e=>e.kind===`file`).map(e=>e.webkitGetAsEntry()).filter(Boolean).length>0||[...e.dataTransfer?.files??[]].length>0}async function t(e){let t=[],n=[...e.dataTransfer?.items??[]].filter(e=>e.kind===`file`).map(e=>e.webkitGetAsEntry()).filter(Boolean);if(n.length)for(let e of n){let n=await U(e,W(`.`,e));t.push(...n.map(e=>e.file))}else t.push(...e.dataTransfer?.files??[]);return t}return{handleDrop:t,hasFilesOrFolders:e}}function U(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:``;return new Promise((n,r)=>{e.isFile?e.file(e=>n([{file:e,path:t}]),r):e.isDirectory&&e.createReader().readEntries(async e=>{let r=[];for(let n of e)r.push(...await U(n,W(t,n)));n(r)})})}function W(e,t){return t.isDirectory?`${e}/${t.name}`:e}const G=h({filterByType:String},`file-accept`);function ae(e){let t=D(()=>e.filterByType?K(e.filterByType):null);function n(e){if(t.value){let n=e.filter(t.value);return{accepted:n,rejected:e.filter(e=>!n.includes(e))}}return{accepted:e,rejected:[]}}return{filterAccepted:n}}function K(e){let t=e.split(`,`).map(e=>e.trim().toLowerCase()),n=t.filter(e=>e.startsWith(`.`)),r=t.filter(e=>e.endsWith(`/*`)),i=t.filter(e=>!n.includes(e)&&!r.includes(e));return e=>{let t=e.name.split(`.`).at(-1)?.toLowerCase()??``,a=e.type.split(`/`).at(0)?.toLowerCase()??``;return i.includes(e.type)||n.includes(`.${t}`)||r.includes(`${a}/*`)}}const q=h({chips:Boolean,counter:Boolean,counterSizeString:{type:String,default:`$vuetify.fileInput.counterSize`},counterString:{type:String,default:`$vuetify.fileInput.counter`},hideInput:Boolean,multiple:Boolean,showSize:{type:[Boolean,Number,String],default:!1,validator:e=>typeof e==`boolean`||[1e3,1024].includes(Number(e))},truncateLength:{type:[Number,String],default:22},...C(x({prependIcon:`$file`}),[`direction`]),modelValue:{type:[Array,Object],default:e=>e.multiple?[]:null,validator:e=>E(e).every(e=>typeof e==`object`&&!!e)},...G(),...d({clearable:!0})},`VFileInput`),J=R()({name:`VFileInput`,inheritAttrs:!1,props:q(),emits:{"click:control":e=>!0,"mousedown:control":e=>!0,"update:focused":e=>!0,"update:modelValue":e=>!0,rejected:e=>!0},setup(e,a){let{attrs:o,emit:c,slots:l}=a,{t:d}=N(),{filterAccepted:p}=ae(e),m=w(e,`modelValue`,e.modelValue,e=>E(e),t=>!e.multiple&&Array.isArray(t)?t[0]:t),{isFocused:h,focus:g,blur:_}=F(e),y=D(()=>typeof e.showSize==`boolean`?void 0:e.showSize),x=D(()=>(m.value??[]).reduce((e,t)=>{let{size:n=0}=t;return e+n},0)),C=D(()=>M(x.value,y.value)),O=D(()=>(m.value??[]).map(t=>{let{name:n=``,size:r=0}=t,i=Y(n);return e.showSize?`${i} (${M(r,y.value)})`:i})),k=D(()=>{let t=m.value?.length??0;return e.showSize?d(e.counterSizeString,t,C.value):d(e.counterString,t)}),j=A(),L=A(),R=A(),z=P(()=>h.value||e.active),B=D(()=>[`plain`,`underlined`].includes(e.variant)),V=ee(!1),{handleDrop:H,hasFilesOrFolders:U}=ie();function W(){R.value!==document.activeElement&&R.value?.focus(),h.value||g()}function G(e){R.value?.click()}function K(e){c(`mousedown:control`,e)}function q(e){R.value?.click(),c(`click:control`,e)}function J(t){t.stopPropagation(),W(),i(()=>{m.value=[],n(e[`onClick:clear`],t)})}function Y(t){if(t.length<Number(e.truncateLength))return t;let n=Math.floor((Number(e.truncateLength)-1)/2);return`${t.slice(0,n)}…${t.slice(t.length-n)}`}function X(e){e.preventDefault(),e.stopImmediatePropagation(),V.value=!0}function Z(e){e.preventDefault(),V.value=!1}async function Q(e){e.preventDefault(),e.stopImmediatePropagation(),V.value=!1,!(!R.value||!U(e))&&$(await H(e))}function oe(t){!t.target||t.repack||(e.filterByType?$([...t.target.files]):m.value=[...t.target.files??[]])}function $(e){let t=new DataTransfer,{accepted:n,rejected:r}=p(e);r.length&&c(`rejected`,r);for(let e of n)t.items.add(e);R.value.files=t.files,m.value=[...t.files];let i=new Event(`change`,{bubbles:!0});i.repack=!0,R.value.dispatchEvent(i)}return ne(m,e=>{(!Array.isArray(e)||!e.length)&&R.value&&(R.value.value=``)}),te(()=>{let n=!!(l.counter||e.counter),i=!!(n||l.details),[a,c]=b(o),{modelValue:d,...p}=T.filterProps(e),g={...I.filterProps(e),"onClick:clear":J},y=o.webkitdirectory!==void 0&&o.webkitdirectory!==!1,S=o.accept?String(o.accept):void 0,w=y?void 0:e.filterByType??S;return u(T,v({ref:j,modelValue:e.multiple?m.value:m.value[0],class:[`v-file-input`,{"v-file-input--chips":!!e.chips,"v-file-input--dragging":V.value,"v-file-input--hide":e.hideInput,"v-input--plain-underlined":B.value},e.class],style:e.style,"onClick:prepend":G},a,p,{centerAffix:!B.value,focused:h.value}),{...l,default:n=>{let{id:r,isDisabled:i,isDirty:a,isReadonly:o,isValid:d,hasDetails:p}=n;return u(I,v({ref:L,prependIcon:e.prependIcon,onMousedown:K,onClick:q,"onClick:prependInner":e[`onClick:prependInner`],"onClick:appendInner":e[`onClick:appendInner`]},g,{id:r.value,active:z.value||a.value,dirty:a.value||e.dirty,disabled:i.value,focused:h.value,details:p.value,error:d.value===!1,onDragover:X,onDrop:Q}),{...l,default:n=>{let{props:{class:r,...a},controlRef:d}=n;return s(t,null,[s(`input`,v({ref:e=>R.value=d.value=e,type:`file`,accept:w,readonly:o.value,disabled:i.value,multiple:e.multiple,name:e.name,onClick:e=>{e.stopPropagation(),o.value&&e.preventDefault(),W()},onChange:oe,onDragleave:Z,onFocus:W,onBlur:_},a,c),null),s(`div`,{class:f(r)},[!!m.value?.length&&!e.hideInput&&(l.selection?l.selection({fileNames:O.value,totalBytes:x.value,totalBytesReadable:C.value}):e.chips?O.value.map(e=>u(re,{key:e,size:`small`,text:e},null)):O.value.join(`, `))])])}})},details:i?i=>s(t,null,[l.details?.(i),n&&s(t,null,[s(`span`,null,null),u(r,{active:!!m.value?.length,value:k.value,disabled:e.disabled},l.counter)])]):void 0})}),S({},j,L,R)}});var Y=5e6,X=z({__name:`FileInput`,props:{label:{}},emits:[`update`],setup(t,{expose:n,emit:r}){let a=t,o=r,s=A(null);function l(e){return e?e.size<=Y||`Taille maximale : ${Y/1e6}MB`:!0}function u(){s.value&&s.value.size>Y||o(`update`,s.value)}n({openDialog:f});let d=j(`input`);function f(){i(()=>d.value?.click())}return(t,n)=>(e(),c(J,{label:a.label,density:`comfortable`,accept:`.jpg,.jpeg,.png,.pdf`,multiple:!1,modelValue:s.value,"onUpdate:modelValue":[n[0]||=e=>s.value=e,u],rules:[l],"show-size":``,ref_key:`input`,ref:d},null,8,[`label`,`modelValue`,`rules`]))}}),Z={class:`text-right ml-2`},Q=z({__name:`FileCard`,props:{file:{},readonly:{type:Boolean}},emits:[`delete`],setup(t,{emit:n}){let r=t,i=n;return(t,n)=>(e(),c(B,null,{activator:k(({props:e})=>[u(l,v({class:`my-2`},e),{default:k(()=>[u(p,{cover:``,src:L(y).LoadMiniature(r.file.Key),width:`56px`},null,8,[`src`])]),_:1},16)]),default:k(()=>[u(l,null,{default:k(()=>[u(O,{class:`px-0`},{default:k(()=>[u(V,{"min-width":`400`,title:r.file.NomClient,subtitle:L(_).size(r.file.Taille)},{append:k(()=>[s(`div`,Z,[n[1]||=a(` téléversé le `,-1),n[2]||=s(`br`,null,null,-1),a(` `+m(L(_).time(r.file.Uploaded)),1)])]),_:1},8,[`title`,`subtitle`])]),_:1}),u(o,null,{default:k(()=>[u(g,{onClick:n[0]||=e=>i(`delete`),color:`red`},{default:k(()=>[...n[3]||=[a(` Supprimer `,-1)]]),_:1}),u(H),u(g,{href:L(y).LoadDocument(r.file.Key)},{default:k(()=>[...n[4]||=[a(` Télécharger `,-1)]]),_:1},8,[`href`])]),_:1})]),_:1})]),_:1}))}});export{X as n,Q as t};