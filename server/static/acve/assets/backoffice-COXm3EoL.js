import{$ as e,$i as t,$t as n,Ai as r,An as i,B as a,Bn as o,Bt as s,Fi as c,Gn as l,Gr as u,Gt as d,H as f,Hn as p,Ht as m,Ii as h,Jn as g,Jt as _,Kr as v,Li as y,Ln as b,M as x,Mi as S,Ni as C,O as w,Oi as T,Ot as E,Pi as D,Qt as ee,Ri as O,Rn as k,Sa as te,St as A,Ta as j,Ti as ne,Tr as re,U as M,Ui as N,Un as ie,Ur as ae,Ut as P,V as oe,Vn as se,Wi as F,Wn as ce,Wt as le,Yn as ue,Yt as de,Zi as fe,Zn as pe,Zt as me,aa as I,an as he,da as ge,en as _e,f as ve,fa as ye,fi as be,fr as xe,ga as Se,gt as Ce,hr as we,ht as Te,i as Ee,in as De,ji as L,jn as Oe,k as R,ki as ke,kn as Ae,kt as je,la as z,ln as Me,ma as B,mn as Ne,mt as Pe,n as Fe,na as Ie,nt as Le,oa as Re,ot as ze,pn as Be,qt as Ve,r as He,ra as Ue,rn as We,rt as V,sa as Ge,sn as Ke,t as qe,ta as H,tn as Je,u as U,ur as Ye,va as Xe,wa as Ze,xa as W,xr as Qe,z as G,zi as K,zn as $e}from"./VSnackbar-DhWVHYEy.js";import{S as q,_ as et,b as tt,d as nt,m as J,o as rt,s as Y,t as it,u as at,v as X,x as Z,y as ot}from"./VSelect-DnTwfvci.js";import{n as st,r as ct,t as lt}from"./vue-router-GM-65Eg4.js";import{_ as Q,a as ut,b as dt,c as ft,d as pt,f as mt,g as ht,h as gt,i as _t,l as vt,m as yt,n as bt,o as xt,p as St,r as Ct,s as wt,t as Tt,u as Et,v as Dt,y as Ot}from"./InscriptionRow-LlgzS2DN.js";import{i as kt,n as At,o as jt,r as Mt,s as Nt,t as Pt}from"./VTabs-CSrkZP1n.js";import{t as Ft}from"./MontantField-iwKvqL7h.js";import{n as It,r as Lt,t as Rt}from"./ModePaiementField-BHKPt8BB.js";import{t as zt}from"./VBadge-CxXoAL7T.js";import{n as Bt,t as Vt}from"./VPicker-Baq8ixj1.js";import"./VSheet-CnP_f2OJ.js";import{t as Ht}from"./_plugin-vue_export-helper-U-kLyCs_.js";import{t as $}from"./VDialog-Dqbc3wep.js";import{t as Ut}from"./VTooltip-DbN28CfL.js";import{t as Wt}from"./VCombobox-D9zORXhw.js";import{t as Gt}from"./VTextarea-RUdQTRRh.js";import{t as Kt}from"./VAlert-NSb7LNaO.js";import{t as qt}from"./VForm--6njAJId.js";import{n as Jt,t as Yt}from"./EventSwitch-D2bOJv6J.js";import{n as Xt,o as Zt,r as Qt,t as $t}from"./SexeField-BtIQJ-eU.js";import"./FileCard-8_tAtZ8p.js";import{t as en}from"./FilesRow-xQEQMD_B.js";import"./VWindowItem-DjMYodms.js";import{t as tn}from"./NationaliteField-DSZMYlGJ.js";import{t as nn}from"./DepartementField-Dz0MWtpE.js";var rn=K({__name:`NavBar`,props:{title:{},hideMenu:{type:Boolean}},setup(e){let n=e,i=L(()=>Q.isFondsSoutien);return(e,o)=>(t(),c(r,null,[O(gt,{app:``,"model-value":!n.hideMenu,"expand-on-hover":``,permanent:``,rail:``},{append:z(()=>[O(X,{"prepend-icon":`mdi-account-circle-outline`,title:i.value?`Fonds de soutien`:`Administrateur`},null,8,[`title`]),O(X,{"prepend-icon":`mdi-logout`,link:``,to:{path:`/`},color:`primary`,onClick:o[0]||=e=>W(ht).clear()},{default:z(()=>[...o[4]||=[y(` Se déconnecter `,-1)]]),_:1})]),default:z(()=>[O(X,{"prepend-icon":`mdi-menu`,title:`Registro - Backoffice`,subtitle:`v0.9.1`}),O(q),O(X,{"prepend-icon":`mdi-bed`,link:``,to:{path:`/camps`},color:`primary`},{default:z(()=>[...o[1]||=[y(` Séjours `,-1)]]),_:1}),O(X,{"prepend-icon":`mdi-calendar-multiple-check`,link:``,to:{path:`/inscriptions`},color:`primary`},{default:z(()=>[...o[2]||=[y(` Inscriptions `,-1)]]),_:1}),O(q),O(X,{"prepend-icon":`mdi-account-multiple`,link:``,to:{path:`/annuaire`},color:`primary`},{default:z(()=>[...o[3]||=[y(` Annuaire `,-1)]]),_:1}),O(q)]),_:1},8,[`model-value`]),O(Ce,{rounded:``,elevation:`4`,color:`primary`},{append:z(()=>[Ie(e.$slots,`default`),o[5]||=S(`div`,{class:`mr-2`},null,-1)]),default:z(()=>[O(f,null,{default:z(()=>[O(G,null,{default:z(()=>[O(a,{"align-self":`center`,cols:`auto`},{default:z(()=>[O(A,{width:`150`,src:`/static/acve/logo.png`})]),_:1}),O(a,{"align-self":`center`},{default:z(()=>[y(j(n.title),1)]),_:1})]),_:1})]),_:1})]),_:3})],64))}}),an=K({__name:`index`,setup(e){let n=ct(),i=B(!1),a=B(``),o=B([]);async function s(){let e=await Q.Loggin({password:a.value});e!==void 0&&(e.IsValid?(Q.setToken(e.Token,e.IsFondSoutien),ht.set(e.Token),Q.showMessage(`Bienvenue !`),n.push({path:`/inscriptions`})):o.value=[`Clé de connection incorrecte.`])}return(e,n)=>(t(),c(r,null,[O(rn,{title:`Connection au backoffice`,"hide-menu":``}),O(oe,{class:`fill-height`},{default:z(()=>[O(w,{class:`mx-auto`,width:`400px`},{default:z(()=>[O(R,null,{default:z(()=>[S(`form`,null,[O(U,{label:`Clé de connection`,modelValue:a.value,"onUpdate:modelValue":n[1]||=e=>a.value=e,"error-messages":o.value,type:i.value?void 0:`password`,name:`password`,onKeydown:n[2]||=T(ke(()=>a.value.length==0?null:s(),[`prevent`]),[`enter`]),autocomplete:`current-password`},{"append-inner":z(()=>[O(M,{class:`ml-2`,size:`small`,icon:i.value?`mdi-eye`:`mdi-eye-off`,flat:``,onClick:n[0]||=e=>i.value=!i.value},null,8,[`icon`])]),_:1},8,[`modelValue`,`error-messages`,`type`])])]),_:1}),O(x,null,{default:z(()=>[O(Z),O(M,{disabled:!a.value.length,onClick:s},{default:z(()=>[...n[3]||=[y(`Se connecter`,-1)]]),_:1},8,[`disabled`])]),_:1})]),_:1})]),_:1})],64))}}),on=K({__name:`BoolField`,props:N({label:{},hideDetails:{type:Boolean},readonly:{type:Boolean},density:{},persistentHint:{type:Boolean},hint:{}},{modelValue:{type:Boolean,required:!0},modelModifiers:{}}),emits:[`update:modelValue`],setup(e){let n=e,r=I(e,`modelValue`);return(e,i)=>(t(),C(at,{label:n.label,"model-value":r.value,"onUpdate:modelValue":i[0]||=e=>r.value=e||!1,"hide-details":n.hideDetails,readonly:n.readonly,density:n.density,"persistent-hint":n.persistentHint,hint:n.hint},null,8,[`label`,`model-value`,`hide-details`,`readonly`,`density`,`persistent-hint`,`hint`]))}}),sn=K({__name:`OptionStatut`,props:N({camp:{}},{modelValue:{required:!0},modelModifiers:{}}),emits:[`update:modelValue`],setup(e){let n=e,i=I(e,`modelValue`);function o(){let e=i.value?.length?i.value.map(e=>e.Id):[0],t={Id:Math.max(...e)+1,Label:``,Description:``,Prix:n.camp.Prix.Cent};i.value=(i.value||[]).concat(t),s.value=t}let s=B(null);function l(e){i.value=(i.value||[]).filter(t=>t.Id!=e.Id)}return(u,d)=>{let f=Ft;return t(),C(w,{subtitle:`Le prix dépend du statut du participant, à choisir parmi la liste ci-dessous.`},{append:z(()=>[O(M,{icon:``,size:`x-small`,onClick:o},{default:z(()=>[O(V,{color:`green`},{default:z(()=>[...d[4]||=[y(`mdi-plus`,-1)]]),_:1})]),_:1})]),default:z(()=>[s.value==null?D(``,!0):(t(),C($,{key:0,"model-value":s.value!=null,"onUpdate:modelValue":d[3]||=e=>s.value=null,"max-width":`500px`},{default:z(()=>[O(w,{title:`Modifier le statut`},{default:z(()=>[O(R,null,{default:z(()=>[O(G,null,{default:z(()=>[O(a,{cols:`12`},{default:z(()=>[O(U,{autofocus:``,label:`Statut`,modelValue:s.value.Label,"onUpdate:modelValue":d[0]||=e=>s.value.Label=e,density:`compact`,variant:`outlined`,"hide-details":``},null,8,[`modelValue`])]),_:1}),O(a,{cols:`12`},{default:z(()=>[O(U,{label:`Description`,modelValue:s.value.Description,"onUpdate:modelValue":d[1]||=e=>s.value.Description=e,density:`compact`,variant:`outlined`,"hide-details":``},null,8,[`modelValue`])]),_:1}),O(a,{cols:`12`},{default:z(()=>[O(f,{"model-value":{Cent:s.value.Prix,Currency:n.camp.Prix.Currency},"onUpdate:modelValue":d[2]||=e=>s.value.Prix=e.Cent,label:`Prix`,"readonly-currency":``},null,8,[`model-value`])]),_:1})]),_:1})]),_:1})]),_:1})]),_:1},8,[`model-value`])),O(R,{class:`py-0`},{default:z(()=>[O(J,null,{default:z(()=>[i.value?.length?D(``,!0):(t(),C(X,{key:0},{default:z(()=>[...d[5]||=[S(`i`,null,`Aucun statut n'est encore défini.`,-1)]]),_:1})),(t(!0),c(r,null,H(i.value,n=>(t(),C(X,{title:n.Label,subtitle:n.Description,onClick:e=>s.value=n},{append:z(()=>[O(G,null,{default:z(()=>[O(a,{"align-self":`center`},{default:z(()=>[O(Y,null,{default:z(()=>[y(j(W(P).montant({Cent:n.Prix,Currency:e.camp.Prix.Currency})),1)]),_:2},1024)]),_:2},1024),O(a,{"align-self":`center`,cols:`auto`},{default:z(()=>[O(M,{icon:``,size:`x-small`,class:`my-1`,onClick:ke(e=>l(n),[`stop`])},{default:z(()=>[O(V,{color:`red`},{default:z(()=>[...d[6]||=[y(`mdi-delete`,-1)]]),_:1})]),_:1},8,[`onClick`])]),_:2},1024)]),_:2},1024)]),_:2},1032,[`title`,`subtitle`,`onClick`]))),256))]),_:1})]),_:1})]),_:1})}}}),cn=K({__name:`OptionJournee`,props:N({camp:{}},{modelValue:{required:!0},modelModifiers:{}}),emits:[`update:modelValue`],setup(e){let n=e,i=I(e,`modelValue`);Ge(()=>i.value,o,{immediate:!0});function o(){let e=n.camp.Duree;i.value?.length!=e&&(i.value=Array.from({length:e}).map(e=>0))}function s(){let e=i.value,t=e[0];for(let n=0;n<e.length;n++)e[n]=t}return(e,o)=>{let l=Ft;return t(),C(w,{subtitle:`Le prix est variable en fonction des jours de participation au camp.`},{append:z(()=>[O(Ut,{text:`Appliquer le prix du premier jour à tous.`},{activator:z(({props:e})=>[O(M,F(e,{icon:`mdi-arrow-expand`,size:`x-small`,disabled:!(i.value||[])[0],onClick:s}),null,16,[`disabled`])]),_:1})]),default:z(()=>[O(R,null,{default:z(()=>[O(G,null,{default:z(()=>[(t(!0),c(r,null,H(i.value,(e,r)=>(t(),C(a,{cols:`3`},{default:z(()=>[O(l,{label:`Jour ${r+1}`,"model-value":{Cent:e,Currency:n.camp.Prix.Currency},"onUpdate:modelValue":e=>i.value[r]=e.Cent,"readonly-currency":``},null,8,[`label`,`model-value`,`onUpdate:modelValue`])]),_:2},1024))),256))]),_:1})]),_:1})]),_:1})}}}),ln={key:0,class:`text-center`},un=K({__name:`CampOptionsPrix`,props:N({camp:{}},{optionPrix:{required:!0},optionPrixModifiers:{},optionQf:{required:!0},optionQfModifiers:{}}),emits:[`update:optionPrix`,`update:optionQf`],setup(e){let n=e,r=I(e,`optionPrix`),i=I(e,`optionQf`),o=L(()=>s.isQuotientFamilialActive(i.value)),l=Ke(k);return(e,s)=>{let u=Nt;return t(),C(w,{title:`Options sur le prix`,subtitle:`Permet de modifier le prix de base du séjour`,width:`1000px`},{default:z(()=>[O(R,null,{default:z(()=>[O(G,null,{default:z(()=>[O(a,{"align-self":`center`},{default:z(()=>[O(at,{"model-value":o.value,"onUpdate:modelValue":s[0]||=e=>i.value[3]=e?100:0,"hide-details":``,label:`Prix au quotient familial`},null,8,[`model-value`])]),_:1}),O(a,{"align-self":`center`},{default:z(()=>[O(u,{suffix:`%`,min:0,max:100,disabled:!o.value,"hide-details":``,"readonly-currency":``,label:`entre 1 et 359`,modelValue:i.value[0],"onUpdate:modelValue":s[1]||=e=>i.value[0]=e},null,8,[`disabled`,`modelValue`])]),_:1}),O(a,{"align-self":`center`},{default:z(()=>[O(u,{suffix:`%`,min:0,max:100,disabled:!o.value,"hide-details":``,"readonly-currency":``,label:`entre 360 et 564`,modelValue:i.value[1],"onUpdate:modelValue":s[2]||=e=>i.value[1]=e},null,8,[`disabled`,`modelValue`])]),_:1}),O(a,{"align-self":`center`},{default:z(()=>[O(u,{suffix:`%`,min:0,max:100,disabled:!o.value,"hide-details":``,"readonly-currency":``,label:`entre 565 et 714`,modelValue:i.value[2],"onUpdate:modelValue":s[3]||=e=>i.value[2]=e},null,8,[`disabled`,`modelValue`])]),_:1}),O(a,{"align-self":`center`},{default:z(()=>[O(u,{suffix:`%`,min:0,max:100,disabled:!0,"hide-details":``,"readonly-currency":``,label:`plus de 715`,modelValue:i.value[3],"onUpdate:modelValue":s[4]||=e=>i.value[3]=e},null,8,[`modelValue`])]),_:1})]),_:1}),O(q,{thickness:`1`,class:`my-2`}),O(G,{class:`my-2`},{default:z(()=>[O(a,{"align-self":`center`,cols:`4`},{default:z(()=>[O(it,{variant:`outlined`,density:`comfortable`,"hide-details":``,items:W(l),label:`Option sur le prix`,modelValue:r.value.Active,"onUpdate:modelValue":s[5]||=e=>r.value.Active=e},null,8,[`items`,`modelValue`])]),_:1}),O(a,{"align-self":`center`},{default:z(()=>[r.value.Active==W(b).NoOption?(t(),c(`div`,ln,[...s[8]||=[S(`i`,null,`Aucune modification sur le prix de base.`,-1)]])):r.value.Active==W(b).PrixStatut?(t(),C(sn,{key:1,camp:n.camp,modelValue:r.value.Statuts,"onUpdate:modelValue":s[6]||=e=>r.value.Statuts=e},null,8,[`camp`,`modelValue`])):r.value.Active==W(b).PrixJour?(t(),C(cn,{key:2,camp:n.camp,modelValue:r.value.Jours,"onUpdate:modelValue":s[7]||=e=>r.value.Jours=e},null,8,[`camp`,`modelValue`])):D(``,!0)]),_:1})]),_:1})]),_:1})]),_:1})}}}),dn=K({__name:`CampMetaEdit`,props:N({metaEntriesHints:{}},{modelValue:{required:!0},modelModifiers:{}}),emits:[`update:modelValue`],setup(e){let n=e,i=I(e,`modelValue`),o=B(Object.entries(i.value||{}));function s(){i.value=Object.fromEntries(o.value)}return L(()=>{let e=o.value.map(e=>e[0]);return e.includes(``)?!0:new Set(e).size!=o.value.length}),(e,i)=>(t(),C(w,{subtitle:`Métadonnées exposées sur l'API publique`},{append:z(()=>[O(M,{size:`small`,class:`ml-2`,onClick:i[0]||=e=>{o.value.push([``,``]),s()}},{prepend:z(()=>[O(V,{color:`green`},{default:z(()=>[...i[1]||=[y(`mdi-plus`,-1)]]),_:1})]),default:z(()=>[i[2]||=y(` Ajouter une valeur`,-1)]),_:1})]),default:z(()=>[O(R,{class:`pt-2`},{default:z(()=>[(t(!0),c(r,null,H(o.value,(e,r)=>(t(),C(G,null,{default:z(()=>[O(a,{cols:`4`},{default:z(()=>[O(Wt,{variant:`outlined`,density:`compact`,"hide-details":``,label:`Clé`,modelValue:e[0],"onUpdate:modelValue":[t=>e[0]=t,s],autofocus:``,items:n.metaEntriesHints.keys},null,8,[`modelValue`,`onUpdate:modelValue`,`items`])]),_:2},1024),O(a,null,{default:z(()=>[O(Wt,{variant:`outlined`,density:`compact`,"hide-details":``,label:`Valeur`,modelValue:e[1],"onUpdate:modelValue":[t=>e[1]=t,s],items:n.metaEntriesHints.values},null,8,[`modelValue`,`onUpdate:modelValue`,`items`])]),_:2},1024),O(a,{cols:`auto`},{default:z(()=>[O(M,{icon:``,size:`small`,flat:``,onClick:e=>{o.value.splice(r,1),s()}},{default:z(()=>[O(V,{color:`red`},{default:z(()=>[...i[3]||=[y(`mdi-close`,-1)]]),_:1})]),_:1},8,[`onClick`])]),_:2},1024)]),_:2},1024))),256))]),_:1})]),_:1}))}}),fn=K({__name:`CampEdit`,props:{camp:{},preselectionUrl:{},metaEntriesHints:{}},emits:[`save`],setup(e,{emit:n}){let r=e,i=n,o=B(_(r.camp)),c=L(()=>new Date(o.value.DateDebut).getFullYear()>=2020&&o.value.Places>=1&&o.value.Nom!=``&&o.value.AgeMax>=o.value.AgeMin&&o.value.OptionQuotientFamilial.every(e=>0<=e&&e<=100)&&!(o.value.OptionPrix.Active==b.PrixStatut&&!o.value.OptionPrix.Statuts?.length)&&!(o.value.OptionPrix.Active==b.PrixJour&&o.value.OptionPrix.Jours?.length!=o.value.Duree)),u=Ke(l);function d(e){let t=s.isQuotientFamilialActive(e.OptionQuotientFamilial),n=e.OptionPrix.Active!=b.NoOption;if(!t&&!n)return`Aucune`;let r=[];return s.isQuotientFamilialActive(e.OptionQuotientFamilial)&&r.push(`Quotient familial`),e.OptionPrix.Active!=b.NoOption&&r.push(k[e.OptionPrix.Active]),r.join(`, `)}async function f(){await de(r.preselectionUrl),Q.showMessage(`URL copiée dans le presse-papier.`)}return(n,l)=>{let p=Lt,m=Nt,h=Ft,g=on;return t(),C(w,{title:`Paramètres du séjour`,subtitle:W(s).label(r.camp)},{default:z(()=>[O(R,null,{default:z(()=>[O(w,{class:`my-2`,subtitle:`Général`},{default:z(()=>[O(R,null,{default:z(()=>[O(G,null,{default:z(()=>[O(a,null,{default:z(()=>[O(U,{autofocus:``,"hide-details":``,label:`Nom`,density:`compact`,variant:`outlined`,modelValue:o.value.Nom,"onUpdate:modelValue":l[0]||=e=>o.value.Nom=e},null,8,[`modelValue`])]),_:1}),O(a,null,{default:z(()=>[O(U,{"hide-details":``,label:`Lieu`,density:`compact`,variant:`outlined`,modelValue:o.value.Lieu,"onUpdate:modelValue":l[1]||=e=>o.value.Lieu=e},null,8,[`modelValue`])]),_:1}),O(a,null,{default:z(()=>[O(U,{"hide-details":``,label:`Numéro d'agrément`,density:`compact`,variant:`outlined`,modelValue:o.value.Agrement,"onUpdate:modelValue":l[2]||=e=>o.value.Agrement=e},null,8,[`modelValue`])]),_:1})]),_:1}),O(G,null,{default:z(()=>[O(a,{"align-self":`center`},{default:z(()=>[O(p,{modelValue:o.value.DateDebut,"onUpdate:modelValue":l[3]||=e=>o.value.DateDebut=e,label:`Date de début`,"hide-details":``},null,8,[`modelValue`])]),_:1}),O(a,{"align-self":`center`},{default:z(()=>[O(m,{label:`Durée (en jours)`,modelValue:o.value.Duree,"onUpdate:modelValue":l[4]||=e=>o.value.Duree=e,"hide-details":``},null,8,[`modelValue`])]),_:1}),O(a,{"align-self":`center`},{default:z(()=>[O(p,{"model-value":W(s).dateFin(o.value),label:`Date de fin`,readonly:``,"hide-details":``},null,8,[`model-value`])]),_:1})]),_:1})]),_:1})]),_:1}),O(w,{class:`my-2`,subtitle:`Prix`},{default:z(()=>[O(R,null,{default:z(()=>[O(G,null,{default:z(()=>[O(a,{"align-self":`center`,cols:`6`},{default:z(()=>[O(h,{label:`Prix`,modelValue:o.value.Prix,"onUpdate:modelValue":l[5]||=e=>o.value.Prix=e,"hide-details":``},null,8,[`modelValue`])]),_:1}),O(a,{"align-self":`center`,cols:`6`,class:`text-center`},{default:z(()=>[O(rt,{"close-on-content-click":!1},{activator:z(({props:e})=>[O(U,F(e,{readonly:``,label:`Option sur le prix`,variant:`outlined`,density:`compact`,"hide-details":``,"model-value":d(o.value)}),null,16,[`model-value`])]),default:z(()=>[O(un,{camp:o.value,"option-prix":o.value.OptionPrix,"onUpdate:optionPrix":l[6]||=e=>o.value.OptionPrix=e,"option-qf":o.value.OptionQuotientFamilial,"onUpdate:optionQf":l[7]||=e=>o.value.OptionQuotientFamilial=e},null,8,[`camp`,`option-prix`,`option-qf`])]),_:1})]),_:1})]),_:1})]),_:1})]),_:1}),O(w,{class:`my-2`,subtitle:`Visibilité et inscriptions`},{default:z(()=>[O(R,null,{default:z(()=>[O(G,null,{default:z(()=>[O(a,{"align-self":`center`},{default:z(()=>[O(it,{label:`Ouverture aux inscriptions`,variant:`outlined`,density:`compact`,items:W(u),"hide-details":``,modelValue:o.value.Statut,"onUpdate:modelValue":l[8]||=e=>o.value.Statut=e},null,8,[`items`,`modelValue`])]),_:1}),O(a,{"align-self":`center`},{default:z(()=>[O(yt,{label:`Inscription externe`,modelValue:o.value.InscriptionExterne,"onUpdate:modelValue":l[9]||=e=>o.value.InscriptionExterne=e,color:`primary`,density:`compact`,"persistent-hint":``,hint:o.value.InscriptionExterne?`Camp externe, uniquement visible sur l'API publique.`:``},null,8,[`modelValue`,`hint`])]),_:1})]),_:1})]),_:1})]),_:1}),O(w,{class:`my-2`,subtitle:`Filtres sur les inscrits`},{default:z(()=>[O(R,null,{default:z(()=>[O(G,null,{default:z(()=>[O(a,{"align-self":`center`},{default:z(()=>[O(m,{modelValue:o.value.Places,"onUpdate:modelValue":l[10]||=e=>o.value.Places=e,label:`Nombre de places`},null,8,[`modelValue`])]),_:1}),O(a,{"align-self":`center`},{default:z(()=>[O(m,{modelValue:o.value.AgeMin,"onUpdate:modelValue":l[11]||=e=>o.value.AgeMin=e,label:`Âge minimum`},null,8,[`modelValue`])]),_:1}),O(a,{"align-self":`center`},{default:z(()=>[O(m,{modelValue:o.value.AgeMax,"onUpdate:modelValue":l[12]||=e=>o.value.AgeMax=e,label:`Âge maximum`},null,8,[`modelValue`])]),_:1})]),_:1}),O(G,null,{default:z(()=>[O(a,null,{default:z(()=>[O(g,{modelValue:o.value.NeedEquilibreGF,"onUpdate:modelValue":l[13]||=e=>o.value.NeedEquilibreGF=e,label:`Equilibre G/F demandé`,density:`compact`,"persistent-hint":``,hint:`Place un inscrit en liste d'attente en cas de déséquilibre Garçons/Filles`},null,8,[`modelValue`])]),_:1})]),_:1})]),_:1})]),_:1}),O(w,{class:`my-2`,subtitle:`Formulaire d'inscription`},{default:z(()=>[O(R,null,{default:z(()=>[O(G,null,{default:z(()=>[O(a,null,{default:z(()=>[O(U,{label:`Image`,density:`compact`,variant:`outlined`,hint:`URL d'une image affichée sur le formulaire d'inscription`,"persistent-hint":``,modelValue:o.value.ImageURL,"onUpdate:modelValue":l[14]||=e=>o.value.ImageURL=e},null,8,[`modelValue`])]),_:1})]),_:1}),O(G,null,{default:z(()=>[O(a,null,{default:z(()=>[O(Gt,{variant:`outlined`,density:`compact`,label:`Description`,hint:`Ce texte est affiché sur le formulaire d'inscription.`,"persistent-hint":``,rows:`3`,modelValue:o.value.Description,"onUpdate:modelValue":l[15]||=e=>o.value.Description=e},null,8,[`modelValue`])]),_:1}),O(a,{cols:`2`},{default:z(()=>[O(g,{label:`Navette`,modelValue:o.value.Navette.Actif,"onUpdate:modelValue":l[16]||=e=>o.value.Navette.Actif=e},null,8,[`modelValue`])]),_:1}),O(a,null,{default:z(()=>[O(Gt,{variant:`outlined`,density:`compact`,label:`Navette`,hint:`Ce texte est affiché sur l'espace personnel de suivi.`,"persistent-hint":``,rows:`3`,disabled:!o.value.Navette.Actif,modelValue:o.value.Navette.Commentaire,"onUpdate:modelValue":l[17]||=e=>o.value.Navette.Commentaire=e},null,8,[`disabled`,`modelValue`])]),_:1})]),_:1}),O(G,null,{default:z(()=>[O(a,null,{default:z(()=>[O(U,{density:`compact`,variant:`outlined`,label:`URL de préselection`,hint:`Cette URL permet de sélectionner automatiquement le séjour sur le formulaire d'inscription.`,"persistent-hint":``,readonly:``,"model-value":r.preselectionUrl},{append:z(()=>[O(M,{icon:`mdi-content-copy`,size:`small`,onClick:f})]),_:1},8,[`model-value`])]),_:1})]),_:1})]),_:1})]),_:1}),O(w,{class:`my-2`,subtitle:`Autre`},{default:z(()=>[O(R,null,{default:z(()=>[O(G,null,{default:z(()=>[O(a,null,{default:z(()=>[O(U,{label:`Mot de passe`,density:`compact`,variant:`outlined`,hint:`Mot de passe d'accès à la page Directeur`,"persistent-hint":``,modelValue:o.value.Password,"onUpdate:modelValue":l[18]||=e=>o.value.Password=e},null,8,[`modelValue`])]),_:1})]),_:1})]),_:1})]),_:1}),O(dn,{"meta-entries-hints":e.metaEntriesHints,modelValue:o.value.Meta,"onUpdate:modelValue":l[19]||=e=>o.value.Meta=e},null,8,[`meta-entries-hints`,`modelValue`])]),_:1}),O(x,null,{default:z(()=>[O(Z),O(M,{disabled:!c.value,onClick:l[20]||=e=>i(`save`,o.value)},{default:z(()=>[...l[21]||=[y(`Enregistrer`,-1)]]),_:1},8,[`disabled`])]),_:1})]),_:1},8,[`subtitle`])}}}),pn=K({__name:`TauxSelect`,props:{modelValue:{required:!0},modelModifiers:{}},emits:[`update:modelValue`],setup(e){fe(c);let n=I(e,`modelValue`),r=B(null),o=L(()=>{let e=Array.from(s.value.values()).map(e=>({title:e.Label,subtitle:e.Description,value:e.Id}));return e.sort((e,t)=>e.title.localeCompare(t.title)),e}),s=B(new Map);async function c(){let e=await Q.CampsGetTaux();e!==void 0&&(s.value=me(e),n.value.Id>0&&(n.value=_(s.value.get(n.value.Id)),r.value=n.value.Id))}function l(){n.value.Id<=0?(r.value??=1,n.value=_(s.value.get(r.value))):(r.value=null,n.value.Id=0,n.value.Label=``)}function u(e){n.value=_(s.value.get(e))}let d=L(()=>{if(n.value.Id>0)return null;let e=n.value.Label;return Array.from(s.value.values()).map(e=>e.Label).includes(e)?`Ce label est déjà utilisé.`:null});return(e,s)=>(t(),C(G,null,{default:z(()=>[O(a,{"align-self":`center`},{default:z(()=>[n.value.Id>0?(t(),C(it,{key:0,variant:`outlined`,density:`compact`,"hide-details":``,label:`Taux`,items:o.value,modelValue:r.value,"onUpdate:modelValue":[s[0]||=e=>r.value=e,u]},{item:z(({item:e,props:t})=>[O(X,F(t,{title:e.title,subtitle:e.raw.subtitle}),null,16,[`title`,`subtitle`])]),selection:z(({item:e})=>[O(X,{density:`compact`,title:e.title,subtitle:e.raw.subtitle},null,8,[`title`,`subtitle`])]),_:1},8,[`items`,`modelValue`])):(t(),C(G,{key:1},{default:z(()=>[O(a,{cols:`12`},{default:z(()=>[O(U,{variant:`outlined`,density:`compact`,label:`Label`,modelValue:n.value.Label,"onUpdate:modelValue":s[1]||=e=>n.value.Label=e,disabled:n.value.Id>0,"error-messages":d.value},null,8,[`modelValue`,`disabled`,`error-messages`])]),_:1}),O(a,null,{default:z(()=>[O(U,{label:`Valeur d'un ${W(Oe)[W(i).FrancsSuisse]}`,density:`compact`,variant:`outlined`,type:`number`,min:`0.001`,suffix:`€`,hint:`Valeur en € d'une unité de la monnaie.`,"persistent-hint":``,"model-value":n.value.FrancsSuisse/1e3,"onUpdate:modelValue":s[2]||=e=>n.value.FrancsSuisse=W(he)(Number(e)*1e3),disabled:n.value.Id>0},null,8,[`label`,`model-value`,`disabled`])]),_:1})]),_:1}))]),_:1}),O(a,{cols:`auto`},{default:z(()=>[O(q,{thickness:`2`,vertical:``,class:`py-4`},{default:z(()=>[...s[3]||=[y(`ou`,-1)]]),_:1})]),_:1}),O(a,{"align-self":`center`,cols:`auto`},{default:z(()=>[O(M,{onClick:l,"prepend-icon":`mdi-toggle-switch`},{default:z(()=>[y(j(n.value.Id>0?`Créer un taux`:`Utiliser un taux`),1)]),_:1})]),_:1})]),_:1}))}}),mn=K({__name:`CampStats`,props:{stats:{}},setup(e){let n=e;function r(e,t){return`(${P.pourcent(e,t)} %)`}return(e,i)=>(t(),C(w,{title:`Statut des inscriptions`},{default:z(()=>[O(R,null,{default:z(()=>[O(J,{density:`compact`},{default:z(()=>[O(X,{title:`Demandes d'inscriptions`},{append:z(()=>[y(j(n.stats.Inscriptions),1)]),_:1}),O(X,{title:`Filles`,subtitle:`Parmi toutes les demandes d'inscription`},{append:z(()=>[y(j(n.stats.InscriptionsFilles)+` `+j(r(n.stats.InscriptionsFilles,n.stats.Inscriptions)),1)]),_:1}),O(X,{title:`Suisses`,subtitle:`Parmi toutes les demandes d'inscription`},{append:z(()=>[y(j(n.stats.InscriptionsSuisses)+` `+j(r(n.stats.InscriptionsSuisses,n.stats.Inscriptions)),1)]),_:1}),O(X,{title:`Inscriptions confirmées`},{append:z(()=>[y(j(n.stats.Valides)+` `+j(r(n.stats.Valides,n.stats.Inscriptions)),1)]),_:1}),O(X,{title:`Filles`,subtitle:`Parmi les inscriptions confirmées`},{append:z(()=>[y(j(n.stats.ValidesFilles)+` `+j(r(n.stats.ValidesFilles,n.stats.Valides)),1)]),_:1}),O(X,{title:`Suisses`,subtitle:`Parmi les inscriptions confirmées`},{append:z(()=>[y(j(n.stats.ValidesSuisses)+` `+j(r(n.stats.ValidesSuisses,n.stats.Valides)),1)]),_:1}),O(X,{title:`A statuer`},{append:z(()=>[y(j(n.stats.AStatuer)+` `+j(r(n.stats.AStatuer,n.stats.Inscriptions)),1)]),_:1}),O(X,{title:`Demandes d'exception`},{append:z(()=>[y(j(n.stats.Exceptions)+` `+j(r(n.stats.Exceptions,n.stats.Inscriptions)),1)]),_:1}),O(X,{title:`Refus`},{append:z(()=>[y(j(n.stats.Refus)+` `+j(r(n.stats.Refus,n.stats.Inscriptions)),1)]),_:1})]),_:1})]),_:1})]),_:1}))}}),hn={key:0},gn=K({__name:`CampHeaderRow`,props:{camp:{}},emits:[`click`,`edit`,`edit-taux`,`delete`,`show-documents`,`send-sondage`,`add-directeur`],setup(n,{emit:i}){let o=n,l=i,u=L(()=>o.camp.Stats.Inscriptions-o.camp.Stats.Valides),d=B(!1),f=L(()=>{switch(new Date(o.camp.Camp.Camp.DateDebut).getUTCMonth()+1){case 7:case 8:return`rgb(45, 185, 187)`;case 9:case 10:case 11:return`rgb(190, 150, 60)`;case 12:case 1:case 2:case 3:return`rgb(240, 240, 240)`;default:return`rgb(190, 228, 100)`}}),p=B(!1),m=B(0),h=L(()=>{let e=o.camp.ParticipantsFiles||[];if(e.length==0)return 0;let t=0;for(let n of e)n.InscritsCount!=0&&(t+=n.UploadedCount/n.InscritsCount);return Math.round(t/e.length*100)});return(i,g)=>{let _=mt;return t(),c(r,null,[O(w,{color:f.value,"no-gutters":``,onClick:g[6]||=e=>l(`click`),class:`my-1`},{default:z(()=>[O(G,{style:Ze({"background-color":f.value}),class:`px-1`,"no-gutters":``,justify:`space-between`},{default:z(()=>[O(a,null,{default:z(()=>[O(X,{title:W(s).label(o.camp.Camp.Camp),subtitle:`ID : ${o.camp.Camp.Camp.Id}`},null,8,[`title`,`subtitle`])]),_:1}),O(a,{"align-self":`center`},{default:z(()=>[y(j(W(s).formatPlage(n.camp.Camp.Camp)),1)]),_:1}),O(a,{cols:`2`,"align-self":`center`},{default:z(()=>[O(Ut,{width:`450px`,location:`left`,"content-class":`pa-0`},{activator:z(({props:n})=>[O(e,F({class:`bg-white border-md border-primary`},n,{max:o.camp.Camp.Camp.Places,"model-value":o.camp.Stats.Valides,height:`36`,rounded:``,color:`primary`}),{default:z(()=>[S(`strong`,null,[y(j(o.camp.Stats.Valides)+`/`+j(o.camp.Camp.Camp.Places)+` `,1),u.value>0?(t(),c(`span`,hn,` (+ `+j(u.value)+`)`,1)):D(``,!0)]),O(V,{class:`ml-2`},{default:z(()=>[...g[12]||=[y(`mdi-account-multiple`,-1)]]),_:1})]),_:1},16,[`max`,`model-value`])]),default:z(()=>[O(mn,{stats:o.camp.Stats},null,8,[`stats`])]),_:1})]),_:1}),O(a,{cols:`1`,"align-self":`center`,class:`px-2`},{default:z(()=>[O(Ut,{width:`600`,location:`left`,"content-class":`pa-0`},{activator:z(({props:t})=>[O(e,F({class:`bg-white border-md border-primary`},t,{max:100,"model-value":h.value,height:`36`,rounded:``,color:`primary`}),{default:z(()=>[S(`strong`,null,j(h.value)+` % `,1),O(V,{class:`ml-2`},{default:z(()=>[...g[13]||=[y(`mdi-file-upload`,-1)]]),_:1})]),_:1},16,[`model-value`])]),default:z(()=>[O(w,{title:`Pièces justificatives`},{default:z(()=>[O(R,null,{default:z(()=>[O(J,null,{default:z(()=>[(t(!0),c(r,null,H(o.camp.ParticipantsFiles,e=>(t(),C(X,{title:e.Title},{append:z(()=>[y(j(e.UploadedCount)+` / `+j(e.InscritsCount)+` (`+j(W(P).pourcent(e.UploadedCount,e.InscritsCount))+` %) `,1)]),_:2},1032,[`title`]))),256))]),_:1})]),_:1})]),_:1})]),_:1})]),_:1}),O(a,{cols:`1`}),O(a,{cols:`auto`,"align-self":`center`},{default:z(()=>[O(rt,null,{activator:z(({props:e})=>[O(M,F(e,{size:`x-small`,class:`mx-1`,icon:`mdi-dots-vertical`}),null,16)]),default:z(()=>[O(J,{density:`compact`},{default:z(()=>[O(X,{"prepend-icon":`mdi-pencil`,onClick:g[0]||=e=>l(`edit`)},{default:z(()=>[...g[14]||=[y(`Modifier les paramètres`,-1)]]),_:1}),O(X,{"prepend-icon":`mdi-currency-eur`,onClick:g[1]||=e=>l(`edit-taux`)},{default:z(()=>[...g[15]||=[y(`Taux de conversion`,-1)]]),_:1}),O(q,{thickness:`1`}),O(X,{"prepend-icon":`mdi-mail`,onClick:g[2]||=e=>l(`show-documents`),title:`Documents`}),O(q,{thickness:`1`}),O(X,{"prepend-icon":`mdi-plus`,onClick:g[3]||=e=>p.value=!0,title:`Ajouter un directeur...`,disabled:o.camp.HasDirecteur},null,8,[`disabled`]),O(q,{thickness:`1`}),O(X,{title:`Se connecter à l'espace directeur`,"prepend-icon":`mdi-open-in-new`,href:o.camp.URLDirecteur,target:`_blank`},null,8,[`href`]),O(q,{thickness:`1`}),O(X,{title:`Envoyer le sondage`,subtitle:`de fin de séjour`,"prepend-icon":`mdi-comment-quote`,onClick:g[4]||=e=>l(`send-sondage`)}),O(q,{thickness:`1`}),O(X,{"prepend-icon":`mdi-delete`,disabled:o.camp.Stats.Inscriptions>0,onClick:g[5]||=e=>d.value=!0},{default:z(()=>[...g[16]||=[y(`Supprimer`,-1)]]),_:1},8,[`disabled`])]),_:1})]),_:1})]),_:1})]),_:1},8,[`style`])]),_:1},8,[`color`]),O($,{modelValue:d.value,"onUpdate:modelValue":g[8]||=e=>d.value=e,"max-width":`600`},{default:z(()=>[O(w,{title:`Confirmer la suppression`},{default:z(()=>[O(R,null,{default:z(()=>[g[17]||=y(` Etes vous certain de supprimer le séjour `,-1),S(`b`,null,j(W(s).label(o.camp.Camp.Camp)),1),g[18]||=y(` ? `,-1),g[19]||=S(`br`,null,null,-1),g[20]||=S(`br`,null,null,-1),g[21]||=y(` Les éventuels `,-1),g[22]||=S(`i`,null,`équipiers`,-1),g[23]||=y(` déclarés sur ce séjour seront aussi supprimés. `,-1),g[24]||=S(`br`,null,null,-1),g[25]||=S(`br`,null,null,-1),g[26]||=y(` Attention, cette opération est irréversible. `,-1)]),_:1}),O(x,null,{default:z(()=>[O(Z),O(M,{color:`red`,onClick:g[7]||=e=>{d.value=!1,l(`delete`)}},{default:z(()=>[...g[27]||=[y(`Supprimer`,-1)]]),_:1})]),_:1})]),_:1})]),_:1},8,[`modelValue`]),O($,{modelValue:p.value,"onUpdate:modelValue":g[11]||=e=>p.value=e,"max-width":`400px`},{default:z(()=>[O(w,{title:`Ajouter un directeur`},{default:z(()=>[O(R,null,{default:z(()=>[O(_,{"initial-personne":``,label:`Directeur`,modelValue:m.value,"onUpdate:modelValue":g[9]||=e=>m.value=e,api:W(Q)},null,8,[`modelValue`,`api`])]),_:1}),O(x,null,{default:z(()=>[O(Z),O(M,{disabled:!m.value,onClick:g[10]||=e=>{p.value=!1,l(`add-directeur`,m.value)}},{default:z(()=>[...g[28]||=[y(`Ajouter`,-1)]]),_:1},8,[`disabled`])]),_:1})]),_:1})]),_:1},8,[`modelValue`])],64)}}}),_n=K({__name:`CampsSelector`,props:N({allCamps:{}},{modelValue:{required:!0},modelModifiers:{}}),emits:[`update:modelValue`],setup(e){let n=e,r=I(e,`modelValue`),i=L(()=>n.allCamps.map(e=>({title:e.Label,value:e.Id})));return(e,n)=>(t(),C(St,{multiple:``,chips:``,"closable-chips":``,items:i.value,modelValue:r.value,"onUpdate:modelValue":n[0]||=e=>r.value=e},null,8,[`items`,`modelValue`]))}}),vn=K({__name:`DocumentsCard`,props:{camp:{}},setup(e){let n=e;fe(o);let i=B(null);async function o(){let e=await Q.CampsDocuments({idCamp:n.camp.Camp.Camp.Id});e!==void 0&&(i.value=e)}return(e,n)=>{let o=jt;return i.value==null?(t(),C(Ee,{key:1,type:`card`})):(t(),C(w,{key:0,title:`Documents`},{default:z(()=>[O(R,null,{default:z(()=>[O(J,null,{default:z(()=>[O(et,null,{default:z(()=>[...n[0]||=[y(`Préférences d'affichage`,-1)]]),_:1}),O(X,null,{default:z(()=>[O(G,{class:`mb-2`},{default:z(()=>[O(a,null,{default:z(()=>[O(Y,{color:i.value.ToShow.LettreDirecteur?`green`:`grey`,"append-icon":i.value.ToShow.LettreDirecteur?`mdi-check`:``},{default:z(()=>[...n[1]||=[y(`Lettre du directeur`,-1)]]),_:1},8,[`color`,`append-icon`])]),_:1}),O(a,null,{default:z(()=>[O(Y,{color:i.value.ToShow.ListeVetements?`green`:`grey`,"append-icon":i.value.ToShow.ListeVetements?`mdi-check`:``},{default:z(()=>[...n[2]||=[y(` Liste de vêtements`,-1)]]),_:1},8,[`color`,`append-icon`])]),_:1}),O(a,null,{default:z(()=>[O(Y,{color:i.value.ToShow.ListeParticipants?`green`:`grey`,"append-icon":i.value.ToShow.ListeParticipants?`mdi-check`:``},{default:z(()=>[...n[3]||=[y(`Liste des participants `,-1)]]),_:1},8,[`color`,`append-icon`])]),_:1})]),_:1})]),_:1}),O(et,null,{default:z(()=>[...n[4]||=[y(`Documents du séjour`,-1)]]),_:1}),(t(!0),c(r,null,H(i.value.Generated,e=>(t(),C(X,{title:e.NomClient},{append:z(()=>[O(o,{"file-key":e.Key,"is-generated-doc":!0},null,8,[`file-key`])]),_:2},1032,[`title`]))),256)),(t(!0),c(r,null,H(i.value.ToRead,e=>(t(),C(X,{title:e.NomClient},{append:z(()=>[O(o,{"file-key":e.Key,"is-generated-doc":!1},null,8,[`file-key`])]),_:2},1032,[`title`]))),256)),(t(!0),c(r,null,H(i.value.ToUploadModeles,e=>(t(),C(X,{title:e.NomClient,subtitle:`Document à remplir`},{append:z(()=>[O(o,{"file-key":e.Key,"is-generated-doc":!1},null,8,[`file-key`])]),_:2},1032,[`title`]))),256))]),_:1})]),_:1})]),_:1}))}}}),yn={key:0,class:`text-center my-4`},bn={key:1},xn=[`href`],Sn=K({__name:`AlbumsPhotosPannel`,setup(n,{emit:i}){fe(u);let o=B(null),l=B([]);async function u(){let e=await Q.CampsLoadAlbums();e!==void 0&&(o.value=e,l.value=[])}function d(e){return(o.value?.Camps||[]).find(t=>t.Camp.Id==e)}let f=B(!1),p=L(()=>f.value||!l.value.length||!o.value?!1:l.value.every(e=>d(e).Album.Id==``));async function m(){f.value=!0;let e=await Q.CampsCreateAlbums({IdCamps:l.value});f.value=!1,e!==void 0&&(De(e).forEach(([e,t])=>{d(e).Album=t}),Q.showMessage(`Albums photos créés avec succès.`))}let h=L(()=>f.value||!l.value.length||!o.value?!1:l.value.every(e=>d(e).Album.Id!=``)),g=B(!1);async function _(){g.value=!1,f.value=!0;for(let e of l.value)if(await Q.CampsDeleteAlbum({idCamp:e})===void 0)break;f.value=!1,Q.showMessage(`Albums photos supprimés avec succès.`),u()}return(n,i)=>(t(),C(w,{title:`Albums photos`,subtitle:`Seuls les camps en cours sont affichés.`},{append:z(()=>[O(M,{disabled:!p.value,onClick:m,class:`mx-2`},{prepend:z(()=>[O(V,{color:`green`},{default:z(()=>[...i[3]||=[y(`mdi-plus`,-1)]]),_:1})]),default:z(()=>[i[4]||=y(` Créer`,-1)]),_:1},8,[`disabled`]),O(M,{disabled:!h.value,onClick:i[0]||=e=>g.value=!0},{prepend:z(()=>[O(V,{color:`red`},{default:z(()=>[...i[5]||=[y(`mdi-delete`,-1)]]),_:1})]),default:z(()=>[i[6]||=y(` Supprimer`,-1)]),_:1},8,[`disabled`])]),default:z(()=>[f.value?(t(),C(e,{key:0,indeterminate:``})):D(``,!0),O(R,null,{default:z(()=>[o.value==null?(t(),c(`div`,yn,[O(Le,{indeterminate:``})])):(t(),c(`div`,bn,[O(w,{variant:`outlined`},{default:z(()=>[O(R,null,{default:z(()=>[O(G,null,{default:z(()=>[O(a,null,{default:z(()=>[...i[7]||=[y(`Hébergement des photos`,-1)]]),_:1}),O(a,{class:`text-right`},{default:z(()=>[S(`a`,{href:o.value.HostURL},j(o.value.HostURL),9,xn)]),_:1})]),_:1})]),_:1})]),_:1}),O(J,{selected:l.value,"onUpdate:selected":i[1]||=e=>l.value=e,"select-strategy":`leaf`},{default:z(()=>[(t(!0),c(r,null,H(o.value.Camps,e=>(t(),C(X,{value:e.Camp.Id,title:W(s).label(e.Camp),rounded:``,class:`my-1`},{append:z(()=>[O(Y,{color:e.Album.Id?`success`:void 0},{default:z(()=>[e.Album.Id?(t(),C(Ut,{key:0,activator:`parent`,"content-class":`pa-0`},{default:z(()=>[O(w,{title:`Album photo`,"min-width":`400px`},{default:z(()=>[O(R,null,{default:z(()=>[O(G,null,{default:z(()=>[O(a,{cols:`auto`},{default:z(()=>[...i[8]||=[y(`Nom`,-1)]]),_:1}),O(a,{class:`text-right`},{default:z(()=>[y(j(e.Album.albumName),1)]),_:2},1024)]),_:2},1024),O(G,null,{default:z(()=>[O(a,{cols:`auto`},{default:z(()=>[...i[9]||=[y(`ID`,-1)]]),_:1}),O(a,{class:`text-right`},{default:z(()=>[y(j(e.Album.Id),1)]),_:2},1024)]),_:2},1024),O(G,null,{default:z(()=>[O(a,{cols:`auto`},{default:z(()=>[...i[10]||=[y(`Date de création`,-1)]]),_:1}),O(a,{class:`text-right`},{default:z(()=>[y(j(new Date(e.Album.createdAt).toLocaleDateString(`fr`)),1)]),_:2},1024)]),_:2},1024),O(G,null,{default:z(()=>[O(a,{cols:`auto`},{default:z(()=>[...i[11]||=[y(`Nombre de photos`,-1)]]),_:1}),O(a,{class:`text-right`},{default:z(()=>[y(j(e.Album.assetCount),1)]),_:2},1024)]),_:2},1024)]),_:2},1024)]),_:2},1024)]),_:2},1024)):D(``,!0),y(` `+j(e.Album.Id==``?`Pas d'album`:`Album créé le ${W(P).date(e.Album.createdAt)}`),1)]),_:2},1032,[`color`])]),_:2},1032,[`value`,`title`]))),256))]),_:1},8,[`selected`])]))]),_:1}),O($,{modelValue:g.value,"onUpdate:modelValue":i[2]||=e=>g.value=e,"max-width":`600px`},{default:z(()=>[O(w,{title:`Confirmer la suppression`},{default:z(()=>[O(R,null,{default:z(()=>[...i[12]||=[y(` Confirmez-vous la suppression des albums sélectionnés ? `,-1),S(`br`,null,null,-1),S(`br`,null,null,-1),y(` Les liens de partage ne seront plus valides. `,-1),S(`br`,null,null,-1),y(` Les photos ou vidéos elles-mêmes ne seront pas supprimées. `,-1)]]),_:1}),O(x,null,{default:z(()=>[O(Z),O(M,{color:`red`,onClick:_},{default:z(()=>[...i[13]||=[y(`Supprimer`,-1)]]),_:1})]),_:1})]),_:1})]),_:1},8,[`modelValue`])]),_:1}))}}),Cn=K({__name:`CampsSondagesPannel`,props:{allCamps:{}},emits:[`close`],setup(e,{emit:n}){let i=e,o=n;fe(f);let l=B(new Date(Date.now()).getFullYear()),u=L(()=>Array.from(new Set(i.allCamps.map(e=>s.year(e.Camp.Camp))).keys()).sort()),d=B(null);async function f(){let e=await Q.CampsLoadSondages({year:l.value});e!==void 0&&(d.value=e)}let p=B(null),m=L(()=>p.value==null?null:(d.value?.Sondages||{})[p.value]);return(e,n)=>(t(),C(w,{title:`Avis sur les séjours`},{append:z(()=>[O(M,{icon:`mdi-close`,onClick:n[0]||=e=>o(`close`),flat:``})]),default:z(()=>[O(R,null,{default:z(()=>[O(G,null,{default:z(()=>[O(a,{cols:`3`},{default:z(()=>[O(G,null,{default:z(()=>[O(a,{cols:`12`},{default:z(()=>[O(it,{label:`Année`,variant:`outlined`,density:`comfortable`,"hide-details":``,items:u.value,modelValue:l.value,"onUpdate:modelValue":[n[1]||=e=>l.value=e,f]},null,8,[`items`,`modelValue`])]),_:1}),d.value?(t(),C(a,{key:0,cols:`12`},{default:z(()=>[O(J,{selected:p.value,"onUpdate:selected":n[2]||=e=>p.value=e,"select-strategy":`single-leaf`},{default:z(()=>[(t(!0),c(r,null,H(d.value.Camps,e=>(t(),C(X,{rounded:``,title:W(s).label(e),value:e.Id,key:e.Id},{append:z(()=>[O(zt,{inline:``,content:((d.value.Sondages||{})[e.Id].Sondages||[]).length},null,8,[`content`])]),_:2},1032,[`title`,`value`]))),128))]),_:1},8,[`selected`])]),_:1})):D(``,!0)]),_:1})]),_:1}),O(a,{cols:`9`},{default:z(()=>[m.value?(t(),C(Et,{key:0,sondages:m.value},null,8,[`sondages`])):D(``,!0)]),_:1})]),_:1})]),_:1})]),_:1}))}}),wn={key:2},Tn=16,En=K({__name:`CampsList`,emits:[`show-participants`],setup(e,{emit:n}){let i=n;fe(h);let o=ye(new Map),l=B(!1),u=ye({pattern:``,openOnly:!1}),d=L(()=>{let e=new Set,t=new Set;for(let n of o.values())for(let r of Object.entries(n.Camp.Camp.Meta||{}))e.add(r[0]),t.add(r[1]);return{keys:Array.from(e.keys()).sort(),values:Array.from(t.keys()).sort()}}),f=L(()=>{let e=ee(u.pattern),t=Array.from(o.values()).filter(t=>s.match(t.Camp.Camp,e)&&(!u.openOnly||dt(t.Camp)));return t.sort((e,t)=>{let n=new Date(t.Camp.Camp.DateDebut).valueOf(),r=new Date(e.Camp.Camp.DateDebut).valueOf();return n==r?e.Camp.Camp.Id-t.Camp.Camp.Id:n-r}),t}),p=L(()=>f.value.slice((v.value-1)*Tn,v.value*Tn));function m(){v.value>_.value&&(v.value=_.value)}async function h(){l.value=!0;let e=await Q.CampsGet();l.value=!1,e!==void 0&&(o.clear(),e?.forEach(e=>o.set(e.Camp.Camp.Id,e)))}async function g(){l.value=!0;let e=await Q.CampsCreate();l.value=!1,e!==void 0&&(Q.showMessage(`Camp ajouté avec succès.`),o.set(e.Camp.Camp.Id,e),b.value=e)}let _=L(()=>Math.max(Math.ceil(f.value.length/Tn),1)),v=B(1),b=B(null);async function S(e){b.value=null,l.value=!0;let t=await Q.CampsUpdate(e);l.value=!1,t!==void 0&&(Q.showMessage(`Séjour modifié avec succès.`),o.get(t.Camp.Id).Camp=t,m())}let T=B(null);async function E(){let e=T.value;if(e==null)return;T.value=null,l.value=!0;let t=await Q.CampsSetTaux({IdCamp:e.Camp.Camp.Id,Taux:e.Taux});if(l.value=!1,t===void 0)return;Q.showMessage(`Taux modifié avec succès.`);let n=o.get(e.Camp.Camp.Id);n.Camp.Camp.IdTaux=t.Id,n.Taux=t}let k=B(!1),te=B(5),A=B({Id:1,Label:``,Euros:0,FrancsSuisse:0}),j=L(()=>A.value.Id>0||A.value.Label!=``),ne=L(()=>new Set(Array.from(o.values()).filter(e=>dt(e.Camp)).map(e=>e.Camp.Camp.IdTaux)).size<=1);async function re(){k.value=!1,l.value=!0;let e=await Q.CampsCreateMany({Count:te.value,Taux:A.value});l.value=!1,e!==void 0&&(Q.showMessage(`Séjours créés avec succès.`),e?.forEach(e=>o.set(e.Camp.Camp.Id,e)))}async function N(e){l.value=!0;let t=await Q.CampsDelete({id:e.Camp.Camp.Id});l.value=!1,t!==void 0&&(Q.showMessage(`Séjour supprimé avec succès.`),o.delete(e.Camp.Camp.Id),m())}let ae=B(!1);function P(){oe.value=Array.from(o.values()).filter(e=>e.Camp.Camp.Statut!=ce.Ouvert).map(e=>e.Camp.Camp.Id),ae.value=!0}let oe=B([]);async function se(){ae.value=!1,oe.value.length&&await Q.CampsOuvreInscriptions({Camps:oe.value})!==void 0&&(Q.showMessage(`Séjours ouverts aux inscriptions avec succès.`),h())}let le=B(null),ue=B(null);async function de(e){ue.value={Current:0,Total:10};let t=await Q.EventsSendSondages({idCamp:e});if(t===void 0){ue.value=null;return}await We(t,e=>ue.value=e,e=>Q.onError(`Envoi du sondage`,e)),ue.value=null,Q.showMessage(`Sondage envoyé avec succès.`)}async function pe(e,t){await Q.CampsCreateEquipier({IdPersonne:e,IdCamp:t,Roles:[ie.Direction]})!==void 0&&(o.get(t).HasDirecteur=!0,Q.showMessage(`Directeur ajouté avec succès.`))}let me=B(!1),I=B(!1);return(e,n)=>{let h=Nt;return t(),c(r,null,[O(w,{title:`Séjours`,subtitle:o.size,class:`ma-2`},{append:z(()=>[O(G,null,{default:z(()=>[O(a,{"align-self":`center`,style:{width:`240px`}},{default:z(()=>[O(U,{label:`Rechercher`,variant:`outlined`,density:`comfortable`,"hide-details":``,"prepend-inner-icon":`mdi-magnify`,clearable:``,modelValue:u.pattern,"onUpdate:modelValue":[n[0]||=e=>u.pattern=e,n[2]||=e=>m()],"onClick:clear":n[1]||=e=>{u.pattern=``,m()}},null,8,[`modelValue`])]),_:1}),O(q,{vertical:``,thickness:`1`}),O(a,{"align-self":`center`,cols:`auto`},{default:z(()=>[O(rt,null,{activator:z(({props:e})=>[O(M,F(e,{color:`success`,disabled:l.value,"prepend-icon":`mdi-plus`}),{default:z(()=>[...n[21]||=[y(` Créer un séjour `,-1)]]),_:1},16,[`disabled`])]),default:z(()=>[O(J,{density:`compact`},{default:z(()=>[O(X,{onClick:g,title:`Créer un séjour`}),O(X,{title:`Créer plusieurs séjours...`,subtitle:`Permet de choisir les taux de conversion`,onClick:n[3]||=e=>k.value=!0})]),_:1})]),_:1})]),_:1}),O(a,{"align-self":`center`,cols:`auto`},{default:z(()=>[O(M,{flat:``,icon:``,size:`small`},{default:z(()=>[O(V,{icon:`mdi-dots-vertical`}),O(rt,{activator:`parent`},{default:z(()=>[O(J,{density:`compact`},{default:z(()=>[O(X,{title:`Masquer les camps fermés`,subtitle:`N'afficher que les camps ouverts aux inscriptions`,onClick:n[5]||=e=>u.openOnly=!u.openOnly},{prepend:z(()=>[O(at,{class:`mr-2`,modelValue:u.openOnly,"onUpdate:modelValue":n[4]||=e=>u.openOnly=e,density:`compact`,"hide-details":``},null,8,[`modelValue`])]),_:1}),O(q,{thickness:`1`}),O(X,{onClick:n[6]||=e=>me.value=!0,title:`Configurer les albums photos...`,"prepend-icon":`mdi-image-album`}),O(q,{thickness:`1`}),O(X,{onClick:P,title:`Ouvrir les inscriptions...`,subtitle:`sur plusieurs séjours`,"prepend-icon":`mdi-lock-open`}),O(q,{thickness:`1`}),O(X,{onClick:n[7]||=e=>I.value=!0,title:`Avis sur les séjours...`,"prepend-icon":`mdi-comment-quote`}),O(q,{thickness:`1`}),O(X,{"prepend-icon":`mdi-file-excel`,title:`Exporter`,subtitle:`Participants de l'année courante (format Excel)`,link:``,href:W(Q).CampsDownloadParticipants(new Date().getFullYear(),W(Q).authToken)},null,8,[`href`])]),_:1})]),_:1})]),_:1})]),_:1})]),_:1})]),default:z(()=>[O(R,{class:`mt-4`},{default:z(()=>[ne.value?D(``,!0):(t(),C(Kt,{key:0,type:`warning`},{default:z(()=>[...n[22]||=[y(` Attention, les séjours ouverts aux inscriptions ont des taux de conversion incompatibles ! `,-1)]]),_:1})),l.value?(t(),C(Ee,{key:1})):f.value.length==0?(t(),c(`i`,wn,` Aucun camp ne correspond aux filtres actuels. `)):D(``,!0),(t(!0),c(r,null,H(p.value,(e,n)=>(t(),C(gn,{key:n,camp:e,onClick:t=>i(`show-participants`,e),onEdit:t=>b.value=e,onEditTaux:t=>T.value=e,onDelete:t=>N(e),onShowDocuments:t=>le.value=e,onSendSondage:t=>de(e.Camp.Camp.Id),onAddDirecteur:t=>pe(t,e.Camp.Camp.Id)},null,8,[`camp`,`onClick`,`onEdit`,`onEditTaux`,`onDelete`,`onShowDocuments`,`onSendSondage`,`onAddDirecteur`]))),128)),O(It,{length:_.value,modelValue:v.value,"onUpdate:modelValue":n[8]||=e=>v.value=e},null,8,[`length`,`modelValue`])]),_:1})]),_:1},8,[`subtitle`]),O($,{"model-value":b.value!=null,"onUpdate:modelValue":n[9]||=e=>b.value=null,"max-width":`800px`},{default:z(()=>[b.value==null?D(``,!0):(t(),C(fn,{key:0,camp:b.value.Camp.Camp,"preselection-url":b.value.URLPreselection,"meta-entries-hints":d.value,onSave:S},null,8,[`camp`,`preselection-url`,`meta-entries-hints`]))]),_:1},8,[`model-value`]),O($,{"model-value":T.value!=null,"onUpdate:modelValue":n[11]||=e=>T.value=null,"max-width":`600`},{default:z(()=>[T.value==null?D(``,!0):(t(),C(w,{key:0,title:`Modifier le taux`,subtitle:`La modification n'est possible que si aucun participant n'est enregistré.`},{default:z(()=>[O(R,null,{default:z(()=>[O(pn,{modelValue:T.value.Taux,"onUpdate:modelValue":n[10]||=e=>T.value.Taux=e},null,8,[`modelValue`])]),_:1}),O(x,null,{default:z(()=>[O(Z),O(M,{disabled:T.value.Stats.Inscriptions>0,onClick:E},{default:z(()=>[...n[23]||=[y(`Modifier`,-1)]]),_:1},8,[`disabled`])]),_:1})]),_:1}))]),_:1},8,[`model-value`]),O($,{modelValue:k.value,"onUpdate:modelValue":n[14]||=e=>k.value=e,"max-width":`600`},{default:z(()=>[O(w,{title:`Créer plusieurs séjours`,subtitle:`Les séjours seront liés au même taux de conversion`},{default:z(()=>[O(R,null,{default:z(()=>[O(G,null,{default:z(()=>[O(a,null,{default:z(()=>[O(h,{label:`Nombre de séjours`,modelValue:te.value,"onUpdate:modelValue":n[12]||=e=>te.value=e},null,8,[`modelValue`])]),_:1})]),_:1}),O(q,{thickness:`2`,class:`my-2`}),O(pn,{modelValue:A.value,"onUpdate:modelValue":n[13]||=e=>A.value=e},null,8,[`modelValue`])]),_:1}),O(x,null,{default:z(()=>[O(Z),O(M,{color:`success`,onClick:re,disabled:!j.value},{default:z(()=>[...n[24]||=[y(`Créer`,-1)]]),_:1},8,[`disabled`])]),_:1})]),_:1})]),_:1},8,[`modelValue`]),O($,{modelValue:ae.value,"onUpdate:modelValue":n[16]||=e=>ae.value=e,"max-width":`600`},{default:z(()=>[O(w,{title:`Ouvrir les inscriptions`,subtitle:`Ouvre les inscriptions sur les séjours ci-dessous`},{default:z(()=>[O(R,null,{default:z(()=>[O(_n,{"all-camps":Array.from(o.values()).map(e=>W(s).toItem(e.Camp)),modelValue:oe.value,"onUpdate:modelValue":n[15]||=e=>oe.value=e},null,8,[`all-camps`,`modelValue`])]),_:1}),O(x,null,{default:z(()=>[O(Z),O(M,{onClick:se,disabled:!oe.value.length},{default:z(()=>[...n[25]||=[y(`Ouvrir`,-1)]]),_:1},8,[`disabled`])]),_:1})]),_:1})]),_:1},8,[`modelValue`]),O($,{"model-value":le.value!=null,"onUpdate:modelValue":n[17]||=e=>le.value=null,"max-width":`800px`},{default:z(()=>[le.value?(t(),C(vn,{key:0,camp:le.value},null,8,[`camp`])):D(``,!0)]),_:1},8,[`model-value`]),O($,{"model-value":ue.value!=null,"max-width":`400px`,persistent:``},{default:z(()=>[ue.value?(t(),C(pt,{key:0,title:`Envoi du sondage en cours`,current:ue.value.Current,total:ue.value.Total},null,8,[`current`,`total`])):D(``,!0)]),_:1},8,[`model-value`]),O($,{modelValue:me.value,"onUpdate:modelValue":n[18]||=e=>me.value=e,"max-width":`800px`},{default:z(()=>[O(Sn)]),_:1},8,[`modelValue`]),O($,{modelValue:I.value,"onUpdate:modelValue":n[20]||=e=>I.value=e,fullscreen:``},{default:z(()=>[O(Cn,{"all-camps":Array.from(o.values()),onClose:n[19]||=e=>I.value=!1},null,8,[`all-camps`])]),_:1},8,[`modelValue`])],64)}}}),Dn={key:1},On={key:0,class:`text-center font-italic`},kn=K({__name:`CampParticipants`,props:{id:{},idParticipant:{}},setup(e){let n=e;fe(async()=>{l(),await p(),m()}),Ge(()=>n.id,p),Ge(()=>n.idParticipant,m);let i=B(!1),o=B([]);async function l(){let e=await Q.GetCamps();e!==void 0&&(o.value=e||[])}let u=L(()=>{let e=(f.value?.Participants||[]).map(e=>e);return e.sort(le.cmp),e}),f=B(null);async function p(){i.value=!0;let e=await Q.CampsLoad({idCamp:n.id});i.value=!1,e!==void 0&&(f.value=e)}function m(){if(n.idParticipant===void 0)return;let e=(f.value?.Participants||[]).find(e=>e.Participant.Id==n.idParticipant);e&&(b.value=_(e))}let h=B(null);async function v(){if(h.value==null||f.value==null)return;let e=await Q.ParticipantsCreate(h.value);h.value=null,e!==void 0&&(Q.showMessage(`Participant créé avec succès.`),f.value.Participants=(f.value.Participants||[]).concat(e),b.value=_(e))}let b=B(null);async function T(e){if(b.value==null||f.value==null)return;let t=await Q.ParticipantsUpdate(e);b.value=null,t!==void 0&&(Q.showMessage(`Participant modifié avec succès.`),p())}let E=B(null);async function ee(){if(E.value==null||f.value==null)return;let e=E.value.Participant.Id,t=await Q.ParticipantsDelete({id:e});E.value=null,t!==void 0&&(Q.showMessage(`Participant supprimé avec succès.`),f.value.Participants=(f.value.Participants||[]).filter(t=>t.Participant.Id!=e))}let k=B(null);async function te(){let e=k.value;e==null||f.value==null||(k.value=null,await Q.ParticipantsMove(e)!==void 0&&(Q.showMessage(`Participant déplacé avec succès.`,void 0,{title:`Aller au nouveau séjour`,action:()=>zr({IdCamp:e.Target,Id:e.Id})}),f.value.Participants=(f.value.Participants||[]).filter(t=>t.Participant.Id!=e.Id)))}let A=B(null);async function ne(){if(A.value==null)return;let e=A.value.Participant.Id;A.value=null;let t=await Q.ParticipantsSetPlaceLiberee({id:e});if(t===void 0||(Q.showMessage(`Notification de place libérée envoyée avec succès.`),f.value==null))return;let n=f.value.Participants?.find(t=>t.Participant.Id==e);n.Participant=t}let re=B(!1);return(e,l)=>{let p=_t,m=ut,_=mt,N=wt,ie=xt,ae=ft,P=vt;return f.value==null?(t(),C(Ee,{key:1,type:`card`})):(t(),C(w,{key:0,title:`Participants`,subtitle:W(s).label(f.value.Camp.Camp)},{append:z(()=>[O(M,{color:`green`,onClick:l[0]||=e=>h.value={IdCamp:n.id,IdDossier:0,IdPersonne:0},"prepend-icon":`mdi-plus`},{default:z(()=>[...l[11]||=[y(` Ajouter un participant`,-1)]]),_:1}),O(q,{thickness:`1`,class:`mx-1`}),O(M,{icon:``,size:`small`,flat:``},{default:z(()=>[O(V,null,{default:z(()=>[...l[12]||=[y(`mdi-dots-vertical`,-1)]]),_:1}),O(rt,{activator:`parent`},{default:z(()=>[O(J,null,{default:z(()=>[O(X,{"prepend-icon":`mdi-currency-eur`,title:`Suivi du règlement`,onClick:l[1]||=e=>re.value=!0})]),_:1})]),_:1})]),_:1})]),default:z(()=>[O(R,{class:`mt-4`},{default:z(()=>[i.value?(t(),C(Ee,{key:0,type:`table`})):(t(),c(`div`,Dn,[O(p),u.value.length?D(``,!0):(t(),c(`div`,On,` Aucun participant n'est encore inscrit sur ce séjour. `)),(t(!0),c(r,null,H(u.value,(e,n)=>(t(),C(m,{participant:e,index:n},{actions:z(()=>[O(J,{density:`comfortable`},{default:z(()=>[O(X,{title:`Modifier`,"prepend-icon":`mdi-pencil`,onClick:t=>b.value=e},null,8,[`onClick`]),O(q),O(X,{title:`Changer de camp...`,"prepend-icon":`mdi-file-move`,onClick:t=>k.value={Id:e.Participant.Id,Target:0}},null,8,[`onClick`]),O(X,{title:`Notifier d'une place disponible.`,subtitle:`Envoi un email`,"prepend-icon":`mdi-email-alert`,disabled:e.Participant.Statut==W(g).Inscrit||e.Participant.Statut==W(g).EnAttenteReponse,onClick:t=>A.value=e},null,8,[`disabled`,`onClick`]),O(q),O(X,{title:`Aller à la personne`,subtitle:`(ID : ${e.Personne.Id})`,onClick:t=>W(Ur)(e.Personne.Id)},null,8,[`subtitle`,`onClick`]),O(X,{title:`Aller au dossier`,subtitle:`(ID : ${e.Participant.IdDossier})`,onClick:t=>W(Vr)(e.Participant.IdDossier)},null,8,[`subtitle`,`onClick`]),O(q),O(X,{title:`Supprimer`,"prepend-icon":`mdi-delete`,onClick:t=>E.value=e},null,8,[`onClick`])]),_:2},1024)]),_:2},1032,[`participant`,`index`]))),256))]))]),_:1}),h.value==null?D(``,!0):(t(),C($,{key:0,"model-value":h.value!=null,"onUpdate:modelValue":l[4]||=e=>h.value=null,"max-width":`600px`},{default:z(()=>[O(w,{title:`Créer un participant`},{default:z(()=>[O(R,null,{default:z(()=>[O(G,null,{default:z(()=>[O(a,{cols:`12`},{default:z(()=>[O(_,{label:`Participant`,modelValue:h.value.IdPersonne,"onUpdate:modelValue":l[2]||=e=>h.value.IdPersonne=e,"initial-personne":``,api:{SelectPersonne:W(Q).SelectPersonne.bind(W(Q))}},null,8,[`modelValue`,`api`])]),_:1}),O(a,{cols:`12`},{default:z(()=>[O(N,{modelValue:h.value.IdDossier,"onUpdate:modelValue":l[3]||=e=>h.value.IdDossier=e},null,8,[`modelValue`])]),_:1})]),_:1})]),_:1}),O(x,null,{default:z(()=>[O(Z),O(M,{color:`green`,onClick:v,disabled:!(h.value.IdDossier&&h.value.IdPersonne)},{default:z(()=>[...l[13]||=[y(`Créer`,-1)]]),_:1},8,[`disabled`])]),_:1})]),_:1})]),_:1},8,[`model-value`])),b.value==null?D(``,!0):(t(),C($,{key:1,"model-value":b.value!=null,"onUpdate:modelValue":l[5]||=e=>b.value=null,"max-width":`800px`},{default:z(()=>[O(ie,{participant:b.value.Participant,personne:b.value.Personne,api:{SelectPersonne:W(Q).SelectPersonne.bind(W(Q))},onSave:T},null,8,[`participant`,`personne`,`api`])]),_:1},8,[`model-value`])),E.value==null?D(``,!0):(t(),C($,{key:2,"model-value":E.value!=null,"onUpdate:modelValue":l[6]||=e=>E.value=null,"max-width":`600px`},{default:z(()=>[O(w,{title:`Supprimer le participant`},{default:z(()=>[O(R,null,{default:z(()=>[l[14]||=y(` Confirmez-vous la suppression du participant `,-1),S(`b`,null,j(W(d).label(E.value.Personne)),1),l[15]||=y(` ? `,-1),l[16]||=S(`br`,null,null,-1),l[17]||=S(`br`,null,null,-1),l[18]||=y(` Attention, cette opération est irréversible. `,-1)]),_:1}),O(x,null,{default:z(()=>[O(Z),O(M,{color:`red`,onClick:ee},{default:z(()=>[...l[19]||=[y(`Supprimer`,-1)]]),_:1})]),_:1})]),_:1})]),_:1},8,[`model-value`])),k.value==null?D(``,!0):(t(),C($,{key:3,"model-value":k.value!=null,"onUpdate:modelValue":l[8]||=e=>k.value=null,"max-width":`500px`},{default:z(()=>[O(w,{title:`Déplacer le participant`},{default:z(()=>[O(R,null,{default:z(()=>[O(ae,{label:`Nouveau séjour`,camps:o.value,modelValue:k.value.Target,"onUpdate:modelValue":l[7]||=e=>k.value.Target=e},null,8,[`camps`,`modelValue`])]),_:1}),O(x,null,{default:z(()=>[O(Z),O(M,{onClick:te,disabled:k.value.Target==n.id||!k.value.Target},{default:z(()=>[...l[20]||=[y(`Déplacer`,-1)]]),_:1},8,[`disabled`])]),_:1})]),_:1})]),_:1},8,[`model-value`])),A.value==null?D(``,!0):(t(),C($,{key:4,"model-value":A.value!=null,"onUpdate:modelValue":l[9]||=e=>A.value=null,"max-width":`500px`},{default:z(()=>[O(w,{title:`Notifier d'une place disponible`},{default:z(()=>[O(R,null,{default:z(()=>[y(` Confirmez-vous l'envoi d'une notification au responsable de `+j(W(d).label(A.value.Personne))+` indiquant qu'une place est disponible ? `,1),l[21]||=S(`br`,null,null,-1),l[22]||=S(`br`,null,null,-1),y(` Le nouveau statut de `+j(A.value.Personne.Prenom)+` sera : `,1),S(`i`,null,j(W(ue)[W(g).EnAttenteReponse]),1),l[23]||=y(`. `,-1)]),_:1}),O(x,null,{default:z(()=>[O(Z),O(M,{onClick:ne},{default:z(()=>[...l[24]||=[y(`Notifier`,-1)]]),_:1})]),_:1})]),_:1})]),_:1},8,[`model-value`])),O($,{modelValue:re.value,"onUpdate:modelValue":l[10]||=e=>re.value=e,"max-width":`700px`},{default:z(()=>[O(P,{data:f.value},null,8,[`data`])]),_:1},8,[`modelValue`])]),_:1},8,[`subtitle`]))}}}),An=K({__name:`camps`,setup(e){let n=ct(),i=L(()=>Rr(n.currentRoute.value.query)),a=L(()=>i.value.idCamp);function o(e){let t=n.currentRoute.value;n.push({path:t.path,query:{idCamp:e.Camp.Camp.Id}})}function s(){let e=n.currentRoute.value;n.push({path:e.path,query:{}})}return(e,n)=>(t(),c(r,null,[O(rn,{title:`Gestion des séjours`},{default:z(()=>[a.value===null?D(``,!0):(t(),C(M,{key:0,onClick:s,"prepend-icon":`mdi-view-list`},{default:z(()=>[...n[0]||=[y(` Retour à la liste`,-1)]]),_:1}))]),_:1}),a.value===void 0?(t(),C(En,{key:0,onShowParticipants:o})):(t(),C(kn,{key:1,id:a.value,"id-participant":i.value.idParticipant},null,8,[`id`,`id-participant`]))],64))}}),jn=K({__name:`MergeCard`,props:{from:{}},emits:[`merge`],setup(e,{emit:n}){let r=e,i=n,o=B(0),s=B(!0);return(e,n)=>{let c=wt;return t(),C(w,{title:`Fusionner le dossier vers`,subtitle:`Les participants, paiements et messages seront copiés vers le dossier cible.`},{default:z(()=>[O(R,null,{default:z(()=>[O(G,null,{default:z(()=>[O(a,{cols:`12`},{default:z(()=>[O(c,{modelValue:o.value,"onUpdate:modelValue":n[0]||=e=>o.value=e},null,8,[`modelValue`])]),_:1}),O(a,{cols:`12`},{default:z(()=>[O(at,{density:`compact`,label:`Notifier par email`,hint:`Le reponsable du dossier absorbé sera averti du changement d'espace personnel.`,"persistent-hint":``,modelValue:s.value,"onUpdate:modelValue":n[1]||=e=>s.value=e},null,8,[`modelValue`])]),_:1})]),_:1})]),_:1}),O(x,null,{default:z(()=>[O(Z),O(M,{disabled:o.value==0||o.value==r.from,onClick:n[2]||=e=>i(`merge`,{From:r.from,To:o.value,Notifie:s.value})},{default:z(()=>[...n[3]||=[y(`Fusionner`,-1)]]),_:1},8,[`disabled`])]),_:1})]),_:1})}}}),Mn={key:1,class:`text-center font-italic`},Nn={key:2},Pn=K({__name:`PannelInscriptions`,emits:[`goTo`,`empty`],setup(e,{emit:n}){let i=n,a=B(!1);fe(async()=>{await l(),o.value.length||i(`empty`)});let o=B([]);async function l(){a.value=!0;let e=await Q.InscriptionsGet();a.value=!1,e!==void 0&&(o.value=e||[])}let u=B(``),f=L(()=>{let e=ee(u.value);return o.value.filter(t=>d.match(t.Responsable,e)||t.Participants?.some(t=>d.match(t.Personne,e)||s.match(t.Camp,e)))});async function p(e,t){let n=await Q.InscriptionsIdentifiePersonne({IdDossier:e,Target:t});if(n===void 0)return;Q.showMessage(`Profil identifié avec succès.`);let r=o.value.findIndex(t=>t.Dossier.Id==e);o.value[r]=n}let m=B(null);async function h(e,t){if(!m.value)return;let n=m.value.inscription.Dossier.Id;m.value=null;let r=await Q.InscriptionsValide({IdDossier:n,Statuts:e,SendMail:t});if(r!==void 0)if(r.Dossier.IsValidated)Q.showMessage(`Inscription validée avec succès.`,``,{title:`Aller au dossier`,action:()=>i(`goTo`,n)}),o.value=o.value.filter(e=>e.Dossier.Id!=n);else{Q.showMessage(`Participant validé avec succès.`);let e=o.value.findIndex(e=>e.Dossier.Id==n);o.value[e]=r}}async function g(e){await Q.DossiersDelete({id:e.Dossier.Id})!==void 0&&(Q.showMessage(`Inscription supprimée avec succès.`),o.value=o.value.filter(t=>t.Dossier.Id!=e.Dossier.Id))}async function _(e,t){if(await Q.ParticipantsDelete({id:t})===void 0)return;Q.showMessage(`Participant supprimé avec succès.`);let n=o.value.find(t=>t.Dossier.Id==e);n.Participants=(n.Participants||[]).filter(e=>e.Participant.Id!=t)}let v=B(null);async function y(e){v.value=null,await Q.DossiersMerge(e)!==void 0&&(Q.showMessage(`Inscriptions fusionnées avec succès.`),l())}return(e,n)=>{let i=Ct;return t(),C(w,{title:`Inscriptions`,subtitle:`En attente de validation`,class:`ma-2`},{append:z(()=>[O(U,{width:`300`,"append-inner-icon":`mdi-magnify`,label:`Rechercher`,"hide-details":``,modelValue:u.value,"onUpdate:modelValue":n[0]||=e=>u.value=e},null,8,[`modelValue`])]),default:z(()=>[O(R,null,{default:z(()=>[a.value?(t(),C(Ee,{key:0})):o.value.length?(t(),c(`div`,Nn,[(t(!0),c(r,null,H(f.value,(e,n)=>(t(),C(Tt,{class:`my-1`,user:null,key:n,inscription:e,onIdentifie:t=>p(e.Dossier.Id,t),onValide:t=>m.value={inscription:e,participants:t===void 0?void 0:[t]},onMerge:t=>v.value=e.Dossier.Id,onDelete:t=>g(e),onDeleteParticipant:t=>_(e.Dossier.Id,t),api:{SearchSimilaires:W(Q).InscriptionsSearchSimilaires.bind(W(Q)),SelectPersonne:W(Q).SelectPersonne.bind(W(Q))}},null,8,[`inscription`,`onIdentifie`,`onValide`,`onMerge`,`onDelete`,`onDeleteParticipant`,`api`]))),128))])):(t(),c(`div`,Mn,` Il n'y a aucune inscription à valider. `))]),_:1}),O($,{"model-value":v.value!=null,"onUpdate:modelValue":n[1]||=e=>v.value=null,"max-width":`600px`},{default:z(()=>[v.value==null?D(``,!0):(t(),C(jn,{key:0,from:v.value,onMerge:y},null,8,[`from`]))]),_:1},8,[`model-value`]),O($,{"model-value":m.value!=null,"onUpdate:modelValue":n[2]||=e=>m.value=null,"max-width":`800px`},{default:z(()=>[m.value?(t(),C(i,{key:0,inscription:m.value.inscription,"id-participants":m.value.participants,onValide:h},null,8,[`inscription`,`id-participants`])):D(``,!0)]),_:1},8,[`model-value`])]),_:1})}}}),Fn={class:`text-grey`},In={class:`text-grey`},Ln={key:0},Rn=K({__name:`FactureCard`,props:{dossier:{}},setup(e){let n=e,i=L(()=>(n.dossier.Participants||[]).filter(e=>e.Participant.Statut!=g.Inscrit).map(e=>d.label(e.Personne))),o=L(()=>(n.dossier.Participants||[]).filter(e=>e.Participant.Statut==g.Inscrit).map(e=>({Label:d.label(e.Personne),Camp:s.label(e.Camp),Prix:P.montant(e.Camp.Prix),Bilan:n.dossier.Bilan.Inscrits[e.Participant.Id]})));function l(e){return!!(e.Remises.Famille||e.Remises.Equipiers||e.Remises.Speciale.Cent)}function u(e){let t=[];return e.Famille&&t.push(`Enfants : ${e.Famille}%`),e.Equipiers&&t.push(`Enfants : ${e.Equipiers}%`),e.Speciale.Cent&&t.push(`Remise : ${P.montant(e.Speciale)}`),t.join(`  ;  `)}let f=L(()=>{let e=Object.values(n.dossier.Paiements||{});return e.sort((e,t)=>new Date(e.Time).valueOf()-new Date(t.Time).valueOf()),e});return(e,s)=>(t(),C(w,{title:`Suivi financier`,subtitle:i.value.length?`Les participants en liste d'attente (${i.value.join(`, `)}) ne sont pas pris en compte.`:``,"min-width":`900px`},{default:z(()=>[O(R,null,{default:z(()=>[O(G,null,{default:z(()=>[O(a,{cols:`3`},{default:z(()=>[...s[0]||=[y(`Participant`,-1)]]),_:1}),O(a,{cols:`2`,class:`text-center`},{default:z(()=>[...s[1]||=[y(`Prix du séjour`,-1)]]),_:1}),O(a,{cols:`2`,class:`text-center`},{default:z(()=>[...s[2]||=[y(`Prix avec option`,-1)]]),_:1}),O(a,{cols:`3`,class:`text-center`},{default:z(()=>[...s[3]||=[y(`Aides extérieures`,-1)]]),_:1}),O(a,{cols:`2`,class:`text-right`},{default:z(()=>[...s[4]||=[y(`Sous-total`,-1)]]),_:1})]),_:1}),O(q,{thickness:`1`,class:`my-2`}),(t(!0),c(r,null,H(o.value,e=>(t(),c(r,null,[O(G,null,{default:z(()=>[O(a,{"align-self":`center`,cols:`3`},{default:z(()=>[y(j(e.Label)+` `,1),s[5]||=S(`br`,null,null,-1),S(`span`,Fn,j(e.Camp),1)]),_:2},1024),O(a,{"align-self":`center`,cols:`2`,class:`text-center`},{default:z(()=>[y(j(e.Prix),1)]),_:2},1024),O(a,{"align-self":`center`,cols:`2`,class:`text-center`},{default:z(()=>[y(j(W(P).montant(e.Bilan.AvecOption))+` `,1),s[6]||=S(`br`,null,null,-1),S(`span`,In,j(e.Bilan.AvecOptionDescription),1)]),_:2},1024),O(a,{"align-self":`center`,cols:`3`,class:`text-center`},{default:z(()=>[e.Bilan.Aides?.length?D(``,!0):(t(),c(`span`,Ln,`-`)),(t(!0),c(r,null,H(e.Bilan.Aides,e=>(t(),C(Y,null,{default:z(()=>[y(j(e.Structure)+` : `+j(W(P).montant(e.Montant)),1)]),_:2},1024))),256))]),_:2},1024),O(a,{"align-self":`center`,cols:`2`,class:`text-right`},{default:z(()=>[y(j(e.Bilan.AvecAides),1)]),_:2},1024)]),_:2},1024),l(e.Bilan)?(t(),C(G,{key:0,"no-gutters":``},{default:z(()=>[O(a,{cols:`10`,class:`text-right`},{default:z(()=>[S(`i`,null,j(u(e.Bilan.Remises)),1)]),_:2},1024),O(a,{cols:`2`,class:`text-right`},{default:z(()=>[y(j(e.Bilan.Net),1)]),_:2},1024)]),_:2},1024)):D(``,!0)],64))),256)),O(q,{thickness:`1`,class:`my-2`}),O(G,null,{default:z(()=>[O(a,{cols:`10`,class:`text-right`},{default:z(()=>[...s[7]||=[y(`Total demandé`,-1)]]),_:1}),O(a,{cols:`2`,class:`text-right`},{default:z(()=>[y(j(n.dossier.Bilan.Demande),1)]),_:1})]),_:1}),O(q,{thickness:`1`,class:`my-2`}),(t(!0),c(r,null,H(f.value,e=>(t(),C(G,null,{default:z(()=>[O(a,null,{default:z(()=>[y(` Paiement de `+j(e.Payeur)+`, le `+j(W(P).date(e.Time)),1)]),_:2},1024),O(a,{cols:`2`,class:`text-right`},{default:z(()=>[y(j(e.IsRemboursement?`+`:`-`)+j(W(P).montant(e.Montant)),1)]),_:2},1024)]),_:2},1024))),256)),O(G,null,{default:z(()=>[O(a,{cols:`10`,class:`text-right`},{default:z(()=>[...s[8]||=[y(`Solde`,-1)]]),_:1}),O(a,{cols:`2`,class:`text-right`},{default:z(()=>[S(`b`,null,j(n.dossier.Bilan.Restant),1)]),_:1})]),_:1})]),_:1})]),_:1},8,[`subtitle`]))}});const zn=re({allowedValues:Function,ampm:Boolean,color:String,disabled:Boolean,displayedValue:null,double:Boolean,format:{type:Function,default:e=>e},max:{type:Number,required:!0},min:{type:Number,required:!0},scrollable:Boolean,readonly:Boolean,rotate:{type:Number,default:0},step:{type:Number,default:1},modelValue:{type:Number}},`VTimePickerClock`),Bn=Qe()({name:`VTimePickerClock`,props:zn(),emits:{change:e=>!0,input:e=>!0},setup(e,t){let{emit:n}=t,r=B(null),i=B(null),a=B(void 0),o=B(!1),s=B(null),c=B(null),l=v(e=>n(`change`,e),750),{textColorClasses:u,textColorStyles:d}=je(()=>e.color),{backgroundColorClasses:f,backgroundColorStyles:p}=E(()=>e.color),m=L(()=>e.max-e.min+1),h=L(()=>e.double?m.value/2:m.value),g=L(()=>360/h.value),_=L(()=>g.value*Math.PI/180),y=L(()=>e.modelValue==null?e.min:e.modelValue),b=L(()=>.62),x=L(()=>{let t=[];for(let n=e.min;n<=e.max;n+=e.step)t.push(n);return t});Ge(()=>e.modelValue,e=>{a.value=e});function C(e){a.value!==e&&(a.value=e),n(`input`,e)}function w(t){return!e.allowedValues||e.allowedValues(t)}function T(t){if(!e.scrollable||e.disabled)return;t.preventDefault();let n=Math.sign(-t.deltaY||1),r=y.value;do r+=n,r=(r-e.min+m.value)%m.value+e.min;while(!w(r)&&r!==y.value);r!==e.displayedValue&&C(r),l(r)}function D(t){return e.double&&t-e.min>=h.value}function ee(e){return D(e)?b.value:1}function O(t){let n=e.rotate*Math.PI/180;return{x:Math.sin((t-e.min)*_.value+n)*ee(t),y:-Math.cos((t-e.min)*_.value+n)*ee(t)}}function k(t,n){let r=(Math.round(t/g.value)+(n?h.value:0))%m.value+e.min;return t<360-g.value/2?r:n?e.max-h.value+1:e.min}function A(e){let{x:t,y:n}=O(e);return{left:`${Math.round(50+t*50)}%`,top:`${Math.round(50+n*50)}%`}}function j(e,t){let n=t.x-e.x,r=t.y-e.y;return Math.sqrt(n*n+r*r)}function ne(e,t){let n=2*Math.atan2(t.y-e.y-j(e,t),t.x-e.x);return Math.abs(n*180/Math.PI)}function re(e){s.value===null&&(s.value=e),c.value=e,C(e)}function M(t){if(t.preventDefault(),!o.value&&t.type!==`click`||!r.value)return;let{width:n,top:a,left:s}=r.value?.getBoundingClientRect(),{width:c}=i.value?.getBoundingClientRect()??{width:0},{clientX:l,clientY:u}=`touches`in t?t.touches[0]:t,d={x:n/2,y:-n/2},f={x:l-s,y:a-u},p=Math.round(ne(d,f)-e.rotate+360)%360,m=e.double&&j(d,f)<(c+c*b.value)/4,h=Math.ceil(15/g.value),_;for(let e=0;e<h;e++)if(_=k(p+e*g.value,m),w(_)||(_=k(p-e*g.value,m),w(_)))return re(_)}function N(t){e.disabled||(t.preventDefault(),window.addEventListener(`mousemove`,M),window.addEventListener(`touchmove`,M),window.addEventListener(`mouseup`,ie),window.addEventListener(`touchend`,ie),s.value=null,c.value=null,o.value=!0,M(t))}function ie(e){e.stopPropagation(),ae(),o.value=!1,c.value!==null&&w(c.value)&&n(`change`,c.value)}function ae(){window.removeEventListener(`mousemove`,M),window.removeEventListener(`touchmove`,M),window.removeEventListener(`mouseup`,ie),window.removeEventListener(`touchend`,ie)}ge(ae),we(()=>S(`div`,{class:te([{"v-time-picker-clock":!0,"v-time-picker-clock--indeterminate":e.modelValue==null,"v-time-picker-clock--readonly":e.readonly}]),onMousedown:N,onTouchstart:N,onWheel:T,ref:r},[S(`div`,{class:`v-time-picker-clock__inner`,ref:i},[S(`div`,{class:te([{"v-time-picker-clock__hand":!0,"v-time-picker-clock__hand--inner":D(e.modelValue)},u.value]),style:Ze([{transform:`rotate(${e.rotate+g.value*(y.value-e.min)}deg) scaleY(${ee(y.value)})`},d.value])},null),x.value.map(t=>{let n=t===y.value;return S(`div`,{class:te([{"v-time-picker-clock__item":!0,"v-time-picker-clock__item--active":n,"v-time-picker-clock__item--disabled":e.disabled||!w(t)},n&&f.value]),style:Ze([A(t),n&&p.value])},[S(`span`,null,[e.format(t)])])})])]))}}),Vn=re({active:Boolean,color:String,disabled:Boolean,label:String,modelValue:String,readonly:Boolean},`VTimePickerField`),Hn=Qe()({name:`VTimePickerField`,inheritAttrs:!1,props:Vn(),emits:{"update:modelValue":e=>!0},setup(e,t){let{emit:n,attrs:r}=t,{textColorClasses:i,textColorStyles:a}=je(()=>e.color),o=B(),s=Se(!1);function c(e){if([`Backspace`,`Delete`].includes(e.key)){e.preventDefault();let t=e.target;t.value=``,n(`update:modelValue`,null)}}return we(()=>S(`div`,null,[O(U,F({ref:o,_as:`VTimePickerField`,autocomplete:`off`,class:[`v-time-picker-controls__time__field`,{"v-time-picker-controls__time__field--active":e.active},e.active?i.value:[]],style:e.active?a.value:[],disabled:e.disabled,variant:`solo-filled`,inputmode:`numeric`,hideDetails:!0,flat:!0,modelValue:e.modelValue??(s.value?``:`--`),"onUpdate:modelValue":e=>n(`update:modelValue`,e),onKeydown:c,onFocus:()=>s.value=!0,onBlur:()=>s.value=!1},r),null),S(`div`,{class:`v-time-picker-controls__field-label`},[e.label])])),ve({},o)}});function Un(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:2;return String(e).padStart(t,`0`)}function Wn(e){return e?(e-1)%12+1:12}function Gn(e,t){return e%12+(t===`pm`?12:0)}function Kn(e){let t=e.replaceAll(/\D/g,``);return t.length>0?Number(t):null}function qn(e,t,n){if(n){if(e===12&&t)return{value:1};if(e===11&&t)return{value:12,togglePeriod:!0};if(e===12&&!t)return{value:11,togglePeriod:!0};if(e===1&&!t)return{value:12}}else{if(e===23&&t)return{value:0};if(e===0&&!t)return{value:23}}return{value:e+(t?1:-1)}}function Jn(e,t){return e===59&&t?0:e===0&&!t?59:e+(t?1:-1)}const Yn=re({ampm:Boolean,color:String,disabled:Boolean,hour:[Number,String],minute:[Number,String],second:[Number,String],period:String,readonly:Boolean,useSeconds:Boolean,value:Number,viewMode:String},`VTimePickerControls`),Xn=Qe()({name:`VTimePickerControls`,props:Yn(),emits:{"update:period":e=>!0,"update:viewMode":e=>!0,"update:hour":e=>!0,"update:minute":e=>!0,"update:second":e=>!0},setup(e,t){let{emit:n,slots:r}=t,{t:i}=Ye(),a={in:t=>{if(t==null||isNaN(Number(t)))return null;let n=Number(t);return e.ampm?Un(Wn(n)):Un(n)},out:t=>{if(isNaN(Number(t))||t==null||t===``)return null;let n=typeof t==`string`?Kn(t):Number(t);return n===null?null:e.ampm?Gn(n,e.period??`am`):ae(n,0,23)}},o=xe(e,`hour`,void 0,a.in,a.out),s={in:e=>e!=null&&!isNaN(Number(e))?Un(`${e}`):null,out:e=>{if(isNaN(Number(e))||e==null||e===``)return null;let t=typeof e==`string`?Kn(e):Number(e);return t===null?null:ae(t,0,59)}},c=xe(e,`minute`,void 0,s.in,s.out),l=xe(e,`second`,void 0,s.in,s.out);function u(t){if(![`ArrowUp`,`ArrowDown`].includes(t.key))return;t.preventDefault(),t.stopPropagation();let r=Number(o.value??0),i=e.ampm?e.period??`am`:null,{value:a,togglePeriod:s}=qn(r,t.key===`ArrowUp`,i);o.value=Un(a),s&&n(`update:period`,e.period===`am`?`pm`:`am`)}function d(e){[`ArrowUp`,`ArrowDown`].includes(e.key)&&(e.preventDefault(),e.stopPropagation(),c.value=Jn(Number(c.value),e.key===`ArrowUp`))}function f(e){[`ArrowUp`,`ArrowDown`].includes(e.key)&&(e.preventDefault(),e.stopPropagation(),l.value=Jn(Number(l.value),e.key===`ArrowUp`))}function p(t,n,r){return i=>{if(!i.data)return;let a=i.target,{value:o,selectionStart:s,selectionEnd:c}=a??{};if(Kn(i.data)===null){i.preventDefault();return}let l=o?o.slice(0,s)+i.data+o.slice(c):i.data;if(l.length>2){if(s===c&&c===0&&i.data.trim().startsWith(`0`)){i.preventDefault(),a.value=l.trim().substring(0,2),r(a.value),i.data.trim().length===1&&a.setSelectionRange(1,1);return}if(s===c&&c===1&&o.startsWith(`0`)){i.preventDefault(),a.value=l.trim().substring(0,2),r(a.value);return}let t=e.viewMode===`hour`?e.ampm?12:23:59;if(Kn(l)>t){i.preventDefault(),a.value=Un(String(Kn(i.data)).substring(0,2)),r(a.value);return}}n(t(l))&&i.preventDefault()}}let m=B(),h=B(),g=B();Ge(()=>e.viewMode,(e,t)=>{switch(t){case`hour`:m.value.blur();break;case`minute`:h.value.blur();break;case`second`:g.value.blur();break}});let _=p(a.out,e=>a.in(e)===o.value,e=>o.value=e),v=p(s.out,e=>s.in(e)===c.value,e=>c.value=e),b=p(s.out,e=>s.in(e)===l.value,e=>l.value=e);return we(()=>S(`div`,{class:`v-time-picker-controls`},[S(`div`,{class:te({"v-time-picker-controls__time":!0,"v-time-picker-controls__time--with-ampm":e.ampm,"v-time-picker-controls__time--with-seconds":e.useSeconds})},[O(Hn,{ref:m,active:e.viewMode===`hour`,color:e.color,disabled:e.disabled,label:i(`$vuetify.timePicker.hour`),modelValue:o.value,"onUpdate:modelValue":e=>o.value=e,onKeydown:u,onBeforeinput:_,onFocus:()=>n(`update:viewMode`,`hour`)},null),S(`span`,{class:`v-time-picker-controls__time__separator`},[y(`:`)]),O(Hn,{ref:h,active:e.viewMode===`minute`,color:e.color,disabled:e.disabled,label:i(`$vuetify.timePicker.minute`),modelValue:c.value,"onUpdate:modelValue":e=>c.value=e,onKeydown:d,onBeforeinput:v,onFocus:()=>n(`update:viewMode`,`minute`)},null),e.useSeconds&&S(`span`,{key:`secondsDivider`,class:`v-time-picker-controls__time__separator`},[y(`:`)]),e.useSeconds&&O(Hn,{key:`secondsVal`,ref:g,active:e.viewMode===`second`,color:e.color,disabled:e.disabled,label:i(`$vuetify.timePicker.second`),modelValue:l.value,"onUpdate:modelValue":e=>l.value=e,onKeydown:f,onBeforeinput:b,onFocus:()=>n(`update:viewMode`,`second`)},null),e.ampm&&S(`div`,{class:`v-time-picker-controls__ampm`},[O(M,{active:e.period===`am`,color:e.period===`am`?e.color:void 0,class:te({"v-time-picker-controls__ampm__am":!0,"v-time-picker-controls__ampm__btn":!0,"v-time-picker-controls__ampm__btn__active":e.period===`am`}),disabled:e.disabled,text:i(`$vuetify.timePicker.am`),variant:e.disabled&&e.period===`am`?`elevated`:`tonal`,onClick:()=>e.period===`am`?null:n(`update:period`,`am`)},null),O(M,{active:e.period===`pm`,color:e.period===`pm`?e.color:void 0,class:te({"v-time-picker-controls__ampm__pm":!0,"v-time-picker-controls__ampm__btn":!0,"v-time-picker-controls__ampm__btn__active":e.period===`pm`}),disabled:e.disabled,text:i(`$vuetify.timePicker.pm`),variant:e.disabled&&e.period===`pm`?`elevated`:`tonal`,onClick:()=>e.period===`pm`?null:n(`update:period`,`pm`)},null)])])])),{}}});var Zn=u(24),Qn=u(12),$n=Qn.map(e=>e+12),er=u(60);const tr=re({allowedHours:[Function,Array],allowedMinutes:[Function,Array],allowedSeconds:[Function,Array],disabled:Boolean,format:{type:String,default:`ampm`},max:String,min:String,viewMode:{type:String,default:`hour`},period:{type:String,default:`am`,validator:e=>[`am`,`pm`].includes(e)},modelValue:null,readonly:Boolean,scrollable:Boolean,useSeconds:Boolean,variant:{type:String,default:`dial`},...be(Bt({title:`$vuetify.timePicker.title`}),[`landscape`]),...Pe()},`VTimePicker`),nr=Qe()({name:`VTimePicker`,props:tr(),emits:{"update:hour":e=>!0,"update:minute":e=>!0,"update:period":e=>!0,"update:second":e=>!0,"update:modelValue":e=>!0,"update:viewMode":e=>!0},setup(e,t){let{emit:n,slots:r}=t,{t:i}=Ye(),{densityClasses:a}=Te(e),o=B(null),s=B(null),c=B(null),l=B(null),u=B(null),d=B(null),f=xe(e,`period`,`am`),p=xe(e,`viewMode`,`hour`),m=B(null),h=B(null),g=L(()=>{let t;if(t=e.allowedHours instanceof Array?t=>e.allowedHours.includes(t):e.allowedHours,!e.min&&!e.max)return t;let n=e.min?Number(e.min.split(`:`)[0]):0,r=e.max?Number(e.max.split(`:`)[0]):23;return e=>e>=Number(n)&&e<=Number(r)&&(!t||t(e))}),_=L(()=>{let t,n=!g.value||o.value===null||g.value(o.value);if(t=e.allowedMinutes instanceof Array?t=>e.allowedMinutes.includes(t):e.allowedMinutes,!e.min&&!e.max)return n?t:()=>!1;let[r,i]=e.min?e.min.split(`:`).map(Number):[0,0],[a,s]=e.max?e.max.split(`:`).map(Number):[23,59],c=r*60+Number(i),l=a*60+Number(s);return e=>{let r=60*o.value+e;return r>=c&&r<=l&&n&&(!t||t(e))}}),v=L(()=>{let t,n=(!g.value||o.value===null||g.value(o.value))&&(!_.value||s.value===null||_.value(s.value));if(t=e.allowedSeconds instanceof Array?t=>e.allowedSeconds.includes(t):e.allowedSeconds,!e.min&&!e.max)return n?t:()=>!1;let[r,i,a]=e.min?e.min.split(`:`).map(Number):[0,0,0],[c,l,u]=e.max?e.max.split(`:`).map(Number):[23,59,59],d=r*3600+i*60+Number(a||0),f=c*3600+l*60+Number(u||0);return e=>{let r=3600*o.value+60*s.value+e;return r>=d&&r<=f&&n&&(!t||t(e))}}),y=L(()=>e.format===`ampm`),b=Xe(()=>e.modelValue!==null&&o.value===null&&s.value===null&&(!e.useSeconds||c.value===null));function x(){let t=C();t!==null&&t!==e.modelValue&&n(`update:modelValue`,t),b.value&&n(`update:modelValue`,null)}Ge(o,x),Ge(s,x),Ge(c,x),Ge(()=>e.period,e=>E(e)),Ge(()=>e.modelValue,e=>w(e)),Ge(()=>e.useSeconds,(e,t)=>{t&&!e&&p.value===`second`&&(p.value=`minute`),!e&&c.value!==null&&(c.value=null)}),fe(()=>{w(e.modelValue)});function C(){return o.value!=null&&s.value!=null&&(!e.useSeconds||c.value!=null)?`${Un(o.value)}:${Un(s.value)}`+(e.useSeconds?`:${Un(c.value)}`:``):null}function w(e){if(e==null||e===``)o.value=null,s.value=null,c.value=null;else if(e instanceof Date)o.value=e.getHours(),s.value=e.getMinutes(),c.value=e.getSeconds();else{let[t,,n,,r,i]=e.trim().toLowerCase().match(/^(\d+):(\d+)(:(\d+))?([ap]m)?$/)||[,,,,,,];o.value=i?Gn(parseInt(t,10),i):parseInt(t,10),s.value=parseInt(n,10),c.value=parseInt(r||0,10)}f.value=o.value==null||o.value<12?`am`:`pm`}function T(e,t){let n=e===`hour`?g.value:e===`minute`?_.value:v.value;if(!n)return t;let r=e===`minute`||e===`second`?er:y.value?t<12?Qn:$n:Zn;return((r.find(e=>n((e+t)%r.length+r[0]))||0)+t)%r.length+r[0]}function E(e){return f.value=e,o.value!=null&&(o.value=T(`hour`,o.value+(f.value===`am`?-12:12))),n(`update:period`,e),x(),!0}function D(e){p.value===`hour`?o.value=y.value?Gn(e,f.value):e:p.value===`minute`?s.value=e:c.value=e}function ee(t){switch(p.value||`hour`){case`hour`:n(`update:hour`,t);break;case`minute`:n(`update:minute`,t);break;case`second`:n(`update:second`,t);break;default:break}let r=o.value!==null&&s.value!==null&&(e.useSeconds?c.value!==null:!0);p.value===`hour`?p.value=`minute`:e.useSeconds&&p.value===`minute`&&(p.value=`second`),!(o.value===l.value&&s.value===u.value&&(!e.useSeconds||c.value===d.value))&&C()!==null&&(l.value=o.value,u.value=s.value,e.useSeconds&&(d.value=c.value),r&&x())}we(()=>{let t=be(Vt.filterProps(e),[`hideHeader`]),n=Xn.filterProps(e),l=Bn.filterProps(be(e,[`format`,`modelValue`,`min`,`max`]));return O(Vt,F(t,{color:void 0,class:[`v-time-picker`,`v-time-picker--variant-${e.variant}`,e.class,a.value],hideHeader:e.hideHeader&&e.variant!==`input`,style:e.style}),{title:()=>r.title?.()??S(`div`,{class:`v-time-picker__title`},[i(e.title)]),header:()=>O(Xn,F(n,{ampm:y.value,hour:o.value,minute:s.value,period:f.value,second:c.value,viewMode:p.value,"onUpdate:hour":e=>o.value=e,"onUpdate:minute":e=>s.value=e,"onUpdate:period":e=>E(e),"onUpdate:second":e=>c.value=e,"onUpdate:viewMode":e=>p.value=e,ref:m}),null),default:()=>O(Bn,F(l,{allowedValues:p.value===`hour`?g.value:p.value===`minute`?_.value:v.value,double:p.value===`hour`&&!y.value,format:p.value===`hour`?y.value?Wn:e=>e:e=>Un(e,2),max:p.value===`hour`?y.value&&f.value===`am`?11:23:59,min:p.value===`hour`&&y.value&&f.value===`pm`?12:0,size:20,step:p.value===`hour`?1:5,modelValue:p.value===`hour`?o.value:p.value===`minute`?s.value:c.value,onChange:ee,onInput:D,ref:h}),null),actions:r.actions})})}});var rr=Ht(K({__name:`TimeField`,props:N({hideDetails:{type:Boolean},readonly:{type:Boolean}},{modelValue:{required:!0},modelModifiers:{}}),emits:[`update:modelValue`],setup(e){let n=e,r=I(e,`modelValue`),i=L(()=>new Date(r.value).toLocaleTimeString(void 0,{hour:`numeric`,minute:`numeric`}));function o(e){let[t,n]=e.split(`:`),i=new Date(r.value);i.setHours(Number(t),Number(n)),r.value=i.toISOString()}function s(e){let t=new Date(e),n=new Date(r.value);t.setHours(n.getHours(),n.getMinutes(),n.getSeconds()),r.value=t.toISOString()}let c=B(!1);return(e,l)=>{let u=Lt;return t(),C(G,{"no-gutters":``},{default:z(()=>[O(a,null,{default:z(()=>[O(u,{class:`mr-2`,label:`Date`,"model-value":W(Ne)(new Date(r.value)),"onUpdate:modelValue":s,"hide-details":n.hideDetails,readonly:n.readonly},null,8,[`model-value`,`hide-details`,`readonly`])]),_:1}),O(a,{cols:`auto`},{default:z(()=>[...l[1]||=[S(`div`,{class:`ma-2`},null,-1)]]),_:1}),O(a,null,{default:z(()=>[O(rt,{"close-on-content-click":!1,modelValue:c.value,"onUpdate:modelValue":l[0]||=e=>c.value=e},{activator:z(({props:e})=>[O(U,F({class:`center-text`},e,{variant:`outlined`,density:`compact`,"hide-details":n.hideDetails,label:`Moment`,"model-value":i.value}),null,16,[`hide-details`,`model-value`])]),default:z(()=>[O(nr,{"model-value":new Date(r.value),"onUpdate:modelValue":o,format:`24hr`},null,8,[`model-value`])]),_:1},8,[`modelValue`])]),_:1})]),_:1})}}}),[[`__scopeId`,`data-v-32955f86`]]),ir=K({__name:`PaiementEditCard`,props:{paiement:{}},emits:[`update`,`delete`],setup(e,{emit:n}){let r=e,i=n,o=B(_(r.paiement)),s=L(()=>!0),c=B(!1);return(e,n)=>{let r=Rt,l=Ft,u=rr;return t(),C(w,{title:`Modifier le paiement`},{default:z(()=>[O($,{modelValue:c.value,"onUpdate:modelValue":n[1]||=e=>c.value=e,"max-width":`400px`},{default:z(()=>[O(w,{title:`Confirmation`},{default:z(()=>[O(R,null,{default:z(()=>[...n[11]||=[y(` Confirmez-vous la suppression de ce paiement ? `,-1),S(`br`,null,null,-1),S(`br`,null,null,-1),y(` Attention, cette opération est irréversible. `,-1)]]),_:1}),O(x,null,{default:z(()=>[O(Z),O(M,{color:`red`,onClick:n[0]||=e=>{c.value=!1,i(`delete`)}},{default:z(()=>[...n[12]||=[y(`Supprimer`,-1)]]),_:1})]),_:1})]),_:1})]),_:1},8,[`modelValue`]),O(R,null,{default:z(()=>[O(G,null,{default:z(()=>[O(a,null,{default:z(()=>[O(U,{density:`compact`,variant:`outlined`,"hide-details":``,label:`Payé par`,modelValue:o.value.Payeur,"onUpdate:modelValue":n[2]||=e=>o.value.Payeur=e},null,8,[`modelValue`])]),_:1}),O(a,null,{default:z(()=>[O(U,{density:`compact`,variant:`outlined`,"hide-details":``,label:`Description (optionelle)`,modelValue:o.value.Label,"onUpdate:modelValue":n[3]||=e=>o.value.Label=e},null,8,[`modelValue`])]),_:1})]),_:1}),O(G,null,{default:z(()=>[O(a,null,{default:z(()=>[O(r,{modelValue:o.value.Mode,"onUpdate:modelValue":n[4]||=e=>o.value.Mode=e,"hide-details":``},null,8,[`modelValue`])]),_:1}),O(a,null,{default:z(()=>[O(l,{label:`Montant`,modelValue:o.value.Montant,"onUpdate:modelValue":n[5]||=e=>o.value.Montant=e,"hide-details":``},null,8,[`modelValue`])]),_:1})]),_:1}),O(G,null,{default:z(()=>[O(a,null,{default:z(()=>[O(at,{"hide-details":``,density:`compact`,label:`Remboursement ?`,modelValue:o.value.IsRemboursement,"onUpdate:modelValue":n[6]||=e=>o.value.IsRemboursement=e},null,8,[`modelValue`])]),_:1})]),_:1}),O(G,null,{default:z(()=>[O(a,null,{default:z(()=>[O(u,{modelValue:o.value.Time,"onUpdate:modelValue":n[7]||=e=>o.value.Time=e,"hide-details":``},null,8,[`modelValue`])]),_:1})]),_:1}),O(G,null,{default:z(()=>[O(a,null,{default:z(()=>[O(U,{density:`compact`,variant:`outlined`,label:`Détails (optionnel)`,modelValue:o.value.Details,"onUpdate:modelValue":n[8]||=e=>o.value.Details=e},null,8,[`modelValue`])]),_:1})]),_:1})]),_:1}),O(x,null,{default:z(()=>[O(M,{color:`red`,onClick:n[9]||=e=>c.value=!0},{default:z(()=>[...n[13]||=[y(`Supprimer le paiement`,-1)]]),_:1}),O(Z),O(M,{onClick:n[10]||=e=>i(`update`,o.value),disabled:!s.value},{default:z(()=>[...n[14]||=[y(`Enregistrer`,-1)]]),_:1},8,[`disabled`])]),_:1})]),_:1})}}}),ar=K({__name:`DossierEditCard`,props:{responsable:{},dossier:{}},emits:[`save`],setup(e,{emit:n}){let r=e,i=n,o=B(_(r.dossier));return(e,n)=>{let s=mt,c=Zt,l=on;return t(),C(w,null,{default:z(()=>[O(R,null,{default:z(()=>[O(G,null,{default:z(()=>[O(a,null,{default:z(()=>[O(s,{label:`Responsable`,"initial-personne":r.responsable,"model-value":o.value.IdResponsable,"onUpdate:modelValue":n[0]||=e=>e?o.value.IdResponsable=e:void 0,api:{SelectPersonne:W(Q).SelectPersonne.bind(W(Q))}},null,8,[`initial-personne`,`model-value`,`api`])]),_:1})]),_:1}),O(G,null,{default:z(()=>[O(a,null,{default:z(()=>[O(c,{label:`Adresses mail en copie`,modelValue:o.value.CopiesMails,"onUpdate:modelValue":n[1]||=e=>o.value.CopiesMails=e,rule:W(m).validMails()},null,8,[`modelValue`,`rule`])]),_:1})]),_:1}),O(G,null,{default:z(()=>[O(a,null,{default:z(()=>[O(l,{"hide-details":``,modelValue:o.value.PartageAdressesOK,"onUpdate:modelValue":n[2]||=e=>o.value.PartageAdressesOK=e,label:`Partage des coordonnées`},null,8,[`modelValue`])]),_:1})]),_:1}),O(G,null,{default:z(()=>[O(a,null,{default:z(()=>[O(l,{"hide-details":``,modelValue:o.value.DemandeFondSoutien,"onUpdate:modelValue":n[3]||=e=>o.value.DemandeFondSoutien=e,label:`Demande le fonds de soutien`},null,8,[`modelValue`])]),_:1})]),_:1})]),_:1}),O(x,null,{default:z(()=>[O(Z),O(M,{onClick:n[4]||=e=>i(`save`,o.value)},{default:z(()=>[...n[5]||=[y(`Enregistrer`,-1)]]),_:1})]),_:1})]),_:1})}}}),or=K({__name:`OptionJournee`,props:N({camp:{}},{modelValue:{required:!0},modelModifiers:{}}),emits:[`update:modelValue`],setup(e){let n=e,i=I(e,`modelValue`),a=L(()=>(n.camp.OptionPrix.Jours||[]).map((e,t)=>t));return(e,o)=>(t(),C(w,null,{default:z(()=>[O(R,null,{default:z(()=>[o[1]||=S(`div`,{class:`text-grey mb-2`},` Le prix est variable en fonction des jours de participation au camp. `,-1),O(ze,{class:`overflow-x-auto`,color:`primary`,multiple:``,"model-value":i.value?.length?i.value:a.value,"onUpdate:modelValue":o[0]||=e=>i.value=e.length==a.value.length?[]:e},{default:z(()=>[(t(!0),c(r,null,H(n.camp.OptionPrix.Jours,(e,n)=>(t(),C(M,null,{default:z(()=>[y(`J `+j(n+1),1)]),_:2},1024))),256))]),_:1},8,[`model-value`])]),_:1})]),_:1}))}}),sr=K({__name:`OptionStatut`,props:N({camp:{}},{modelValue:{required:!0},modelModifiers:{}}),emits:[`update:modelValue`],setup(e){let n=e,r=I(e,`modelValue`),i=L(()=>(n.camp.OptionPrix.Statuts||[]).map(e=>({value:e.Id,title:e.Label,subtitle:e.Description}))),a=L(()=>i.value.map(e=>e.value).includes(r.value));return(e,n)=>(t(),C(w,null,{default:z(()=>[O(R,null,{default:z(()=>[n[1]||=S(`div`,{class:`text-grey mb-4`},`Le prix dépend du statut du participant.`,-1),O(it,{clearable:``,items:i.value,label:`Statut`,"model-value":a.value?r.value:null,"onUpdate:modelValue":n[0]||=e=>r.value=e??0,variant:`outlined`,density:`comfortable`,"hide-details":``},{item:z(({item:e,props:t})=>[O(X,F(t,{title:e.title,subtitle:e.raw.subtitle}),null,16,[`title`,`subtitle`])]),_:1},8,[`items`,`model-value`])]),_:1})]),_:1}))}}),cr={key:2},lr=K({__name:`ParticipantOptionPrix`,props:{camp:{},optionAndQf:{}},emits:[`update`],setup(e,{emit:n}){let r=e,i=n,o=B(_(r.optionAndQf));return Ge(()=>r.optionAndQf,()=>o.value=_(r.optionAndQf)),(e,n)=>{let s=Nt;return t(),C(w,{title:`Prix variable`,width:`800px`},{default:z(()=>[O(R,null,{default:z(()=>[O(G,{justify:`space-evenly`},{default:z(()=>[O(a,{"align-self":`center`,cols:`3`},{default:z(()=>[O(s,{modelValue:o.value.quotientFamilial,"onUpdate:modelValue":n[0]||=e=>o.value.quotientFamilial=e,label:`Quotient familial`,"hide-details":``},null,8,[`modelValue`])]),_:1}),O(q,{thickness:`2`,vertical:``}),O(a,{"align-self":`center`,cols:`8`},{default:z(()=>[r.camp.OptionPrix.Active==W(b).PrixJour?(t(),C(or,{key:0,camp:r.camp,modelValue:o.value.options.Jour,"onUpdate:modelValue":n[1]||=e=>o.value.options.Jour=e},null,8,[`camp`,`modelValue`])):r.camp.OptionPrix.Active==W(b).PrixStatut?(t(),C(sr,{key:1,camp:r.camp,modelValue:o.value.options.IdStatut,"onUpdate:modelValue":n[2]||=e=>o.value.options.IdStatut=e},null,8,[`camp`,`modelValue`])):(t(),c(`div`,cr,`Le camp ne propose pas d'option sur le prix.`))]),_:1})]),_:1})]),_:1}),O(x,null,{default:z(()=>[O(Z),O(M,{onClick:n[3]||=e=>i(`update`,o.value)},{default:z(()=>[...n[4]||=[y(`Enregistrer`,-1)]]),_:1})]),_:1})]),_:1})}}}),ur={key:1,class:`mx-1`},dr={key:2,class:`mx-1`},fr={key:3},pr={key:4,class:`mx-1`},mr=Ht(K({__name:`RemisesChip`,props:{remises:{}},emits:[`update`],setup(e,{emit:n}){let i=e,o=n,s=L(()=>l.value.Famille!=0||l.value.Equipiers!=0||l.value.Speciale.Cent!=0),l=B(_(i.remises));Ge(()=>i.remises,()=>l.value=_(i.remises));let u=B(!1);return(e,n)=>{let i=Nt,d=Ft;return t(),C(rt,{"close-on-content-click":!1,location:`bottom`,modelValue:u.value,"onUpdate:modelValue":n[4]||=e=>u.value=e},{activator:z(({props:e})=>[O(w,F(e,{elevation:`1`,color:`grey-lighten-2`}),{default:z(()=>[O(R,{class:`py-1 px-1`},{default:z(()=>[s.value?D(``,!0):(t(),c(r,{key:0},[y(` Pas de remises `)],64)),l.value.Famille?(t(),c(`span`,ur,` Inscrits : `+j(l.value.Famille)+`% `,1)):D(``,!0),l.value.Equipiers?(t(),c(`span`,dr,` Equipiers : `+j(l.value.Equipiers)+`% `,1)):D(``,!0),(l.value.Famille||l.value.Equipiers)&&l.value.Speciale.Cent?(t(),c(`br`,fr)):D(``,!0),l.value.Speciale.Cent?(t(),c(`span`,pr,` Remise : `+j(W(P).montant(l.value.Speciale)),1)):D(``,!0)]),_:1})]),_:1},16)]),default:z(()=>[O(w,{title:`Modifier les remises`,width:`400px`},{default:z(()=>[O(R,null,{default:z(()=>[O(G,null,{default:z(()=>[O(a,null,{default:z(()=>[O(i,{modelValue:l.value.Famille,"onUpdate:modelValue":n[0]||=e=>l.value.Famille=e,label:`Remise inscrits`,"hide-details":``,suffix:`%`},null,8,[`modelValue`])]),_:1}),O(a,null,{default:z(()=>[O(i,{modelValue:l.value.Equipiers,"onUpdate:modelValue":n[1]||=e=>l.value.Equipiers=e,label:`Remise équipiers`,"hide-details":``,suffix:`%`},null,8,[`modelValue`])]),_:1})]),_:1}),O(G,null,{default:z(()=>[O(a,null,{default:z(()=>[O(d,{class:`mt-2`,modelValue:l.value.Speciale,"onUpdate:modelValue":n[2]||=e=>l.value.Speciale=e,label:`Remise spéciale`,"hide-details":``},null,8,[`modelValue`])]),_:1})]),_:1})]),_:1}),O(x,null,{default:z(()=>[O(Z),O(M,{onClick:n[3]||=e=>{o(`update`,l.value),u.value=!1}},{default:z(()=>[...n[5]||=[y(`Enregistrer`,-1)]]),_:1})]),_:1})]),_:1})]),_:1},8,[`modelValue`])}}}),[[`__scopeId`,`data-v-06eacfe8`]]),hr=K({__name:`AideEditCard`,props:{aide:{},file:{},structures:{},participant:{}},emits:[`save`,`deleteFile`,`uploadFile`,`showStructureaides`],setup(e,{emit:n}){let r=e,i=n,o=B(_(r.aide)),c=L(()=>Object.values(r.structures).map(e=>({value:e.Id,title:e.Nom})));return(e,n)=>{let l=on,u=Ft,f=Nt,p=en;return t(),C(w,{title:`Modifier l'aide extérieure`,subtitle:`pour ${W(d).label(r.participant.Personne)} - ${W(s).label(r.participant.Camp)}`},{append:z(()=>[O(M,{onClick:n[0]||=e=>i(`showStructureaides`)},{default:z(()=>[O(V,null,{default:z(()=>[...n[9]||=[y(`mdi-view-list`,-1)]]),_:1}),n[10]||=y(` Structures`,-1)]),_:1})]),default:z(()=>[O(R,null,{default:z(()=>[O(G,null,{default:z(()=>[O(a,null,{default:z(()=>[O(it,{variant:`outlined`,density:`comfortable`,label:`Structure`,items:c.value,modelValue:o.value.IdStructureaide,"onUpdate:modelValue":n[1]||=e=>o.value.IdStructureaide=e},null,8,[`items`,`modelValue`])]),_:1}),O(a,null,{default:z(()=>[O(l,{modelValue:o.value.Valide,"onUpdate:modelValue":n[2]||=e=>o.value.Valide=e,label:`Aide validée`,"hide-details":``},null,8,[`modelValue`])]),_:1})]),_:1}),O(G,null,{default:z(()=>[O(a,{"align-self":`center`},{default:z(()=>[O(u,{modelValue:o.value.Valeur,"onUpdate:modelValue":n[3]||=e=>o.value.Valeur=e,label:`Montant`,"hide-details":``},null,8,[`modelValue`])]),_:1}),O(a,{"align-self":`center`,cols:`auto`},{default:z(()=>[O(l,{"hide-details":``,label:`Par jour`,modelValue:o.value.ParJour,"onUpdate:modelValue":n[4]||=e=>o.value.ParJour=e},null,8,[`modelValue`])]),_:1}),O(a,{"align-self":`center`},{default:z(()=>[O(f,{label:`Limite`,suffix:`jours`,modelValue:o.value.NbJoursMax,"onUpdate:modelValue":n[5]||=e=>o.value.NbJoursMax=e,disabled:!o.value.ParJour,hint:`0 pour ne pas limiter`,min:0,"persistent-hint":``},null,8,[`modelValue`,`disabled`])]),_:1})]),_:1}),O(p,{class:`mt-4`,files:r.file?[r.file]:[],title:`Document justificatif`,"max-docs":1,"in-upload":!1,onDelete:n[6]||=e=>i(`deleteFile`),onUpload:n[7]||=e=>i(`uploadFile`,e)},null,8,[`files`])]),_:1}),O(x,null,{default:z(()=>[O(Z),O(M,{onClick:n[8]||=e=>i(`save`,o.value)},{default:z(()=>[...n[11]||=[y(`Enregistrer`,-1)]]),_:1})]),_:1})]),_:1},8,[`subtitle`])}}}),gr=K({__name:`StructuresPannel`,props:{modelValue:{required:!0},modelModifiers:{}},emits:[`update:modelValue`],setup(e){let n=I(e,`modelValue`),i=L(()=>Object.values(n.value||{}).sort((e,t)=>e.Nom.localeCompare(t.Nom)));async function o(){let e=await Q.StructureaideCreate();if(e===void 0)return;Q.showMessage(`Structure créée avec succès.`);let t=n.value||{};t[e.Id]=e,n.value=t,s.value=e}let s=B(null);async function l(){let e=s.value;if(e==null||(s.value=null,await Q.StructureaideUpdate(e)===void 0))return;Q.showMessage(`Structure modifiée avec succès.`);let t=n.value||{};t[e.Id]=e,n.value=t}let u=B(null);async function d(){let e=u.value;if(e==null||(u.value=null,await Q.StructureaideDelete({id:e.Id})===void 0))return;let t=n.value||{};delete t[e.Id],n.value=t,Q.showMessage(`Structure supprimée avec succès.`)}return(e,n)=>(t(),C(w,{title:`Structures d'aide`,subtitle:`Organismes pouvant distribuer une aide extérieure`},{append:z(()=>[O(M,{onClick:o},{prepend:z(()=>[O(V,{color:`green`},{default:z(()=>[...n[5]||=[y(`mdi-plus`,-1)]]),_:1})]),default:z(()=>[n[6]||=y(` Ajouter une structure `,-1)]),_:1})]),default:z(()=>[O(R,{class:`overflow-y-auto`},{default:z(()=>[(t(!0),c(r,null,H(i.value,e=>(t(),C(G,null,{default:z(()=>[O(a,{"align-self":`center`},{default:z(()=>[O(ot,null,{default:z(()=>[y(j(e.Nom),1)]),_:2},1024),O(tt,null,{default:z(()=>[y(j(e.Immatriculation),1)]),_:2},1024)]),_:2},1024),O(a,{"align-self":`center`,style:{"font-size":`smaller`}},{default:z(()=>[(t(!0),c(r,null,H(e.Info.split(`
`),e=>(t(),c(`div`,null,j(e),1))),256))]),_:2},1024),O(a,{"align-self":`center`,cols:`auto`},{default:z(()=>[O(rt,null,{activator:z(({props:e})=>[O(M,F({icon:`mdi-dots-vertical`},{ref_for:!0},e,{size:`x-small`}),null,16)]),default:z(()=>[O(J,null,{default:z(()=>[O(X,{title:`Modifier`,"prepend-icon":`mdi-pencil`,onClick:t=>s.value=W(_)(e)},null,8,[`onClick`]),O(X,{title:`Supprimer`,"prepend-icon":`mdi-delete`,onClick:t=>u.value=e},null,8,[`onClick`])]),_:2},1024)]),_:2},1024)]),_:2},1024)]),_:2},1024))),256))]),_:1}),O($,{"model-value":s.value!=null,"onUpdate:modelValue":n[3]||=e=>s.value=null,"max-width":`600px`},{default:z(()=>[s.value==null?D(``,!0):(t(),C(w,{key:0,title:`Modifier la structure`},{default:z(()=>[O(R,null,{default:z(()=>[O(G,null,{default:z(()=>[O(a,null,{default:z(()=>[O(U,{variant:`outlined`,density:`compact`,label:`Nom`,modelValue:s.value.Nom,"onUpdate:modelValue":n[0]||=e=>s.value.Nom=e,"hide-details":``},null,8,[`modelValue`])]),_:1}),O(a,null,{default:z(()=>[O(U,{variant:`outlined`,density:`compact`,label:`Immatriculation`,modelValue:s.value.Immatriculation,"onUpdate:modelValue":n[1]||=e=>s.value.Immatriculation=e,"hide-details":``},null,8,[`modelValue`])]),_:1})]),_:1}),O(G,null,{default:z(()=>[O(a,null,{default:z(()=>[O(Gt,{variant:`outlined`,density:`compact`,label:`Informations`,modelValue:s.value.Info,"onUpdate:modelValue":n[2]||=e=>s.value.Info=e,"hide-details":``},null,8,[`modelValue`])]),_:1})]),_:1})]),_:1}),O(x,null,{default:z(()=>[O(Z),O(M,{onClick:l},{default:z(()=>[...n[7]||=[y(`Enregistrer`,-1)]]),_:1})]),_:1})]),_:1}))]),_:1},8,[`model-value`]),O($,{"model-value":u.value!=null,"onUpdate:modelValue":n[4]||=e=>u.value=null,"max-width":`450px`},{default:z(()=>[u.value==null?D(``,!0):(t(),C(w,{key:0,title:`Confirmation`},{default:z(()=>[O(R,null,{default:z(()=>[y(` Confirmez-vous la suppression de la structure `+j(u.value.Nom)+` ? `,1),n[8]||=S(`br`,null,null,-1),n[9]||=S(`br`,null,null,-1),n[10]||=y(` Attention, cette opération est irréversible. `,-1)]),_:1}),O(x,null,{default:z(()=>[O(Z),O(M,{color:`red`,onClick:d},{default:z(()=>[...n[11]||=[y(`Supprimer`,-1)]]),_:1})]),_:1})]),_:1}))]),_:1},8,[`model-value`])]),_:1}))}}),_r={key:0},vr={key:1},yr=K({__name:`DossierParticipantRow`,props:N({participant:{},aides:{},aidesFiles:{},hasManyParticipants:{type:Boolean}},{structures:{required:!0},structuresModifiers:{}}),emits:N([`update`,`delete`,`createAide`,`updateAide`,`deleteAide`,`deleteFileAide`,`uploadFileAide`,`expand`],[`update:structures`]),setup(e,{emit:n}){let i=e,o=I(e,`structures`),l=n,u=L(()=>{let e=Object.values(i.aides||{});return e.sort((e,t)=>e.Id-t.Id),e}),f=L(()=>i.participant.Camp.OptionPrix.Active==b.NoOption&&!s.isQuotientFamilialActive(i.participant.Camp.OptionQuotientFamilial));function p(e){switch(i.participant.Camp.OptionPrix.Active){case b.NoOption:return`Séjour sans option`;case b.PrixJour:let t=e.Jour?.length||0;return t==0?`Présent tous les jours`:`Présent ${t} jour${t>1?`s`:``}`;case b.PrixStatut:let n=i.participant.Camp.OptionPrix.Statuts?.find(t=>t.Id==e.IdStatut);return n?`Statut ${n.Label}`:`Pas d'option.`}}let m=B(!1),h=B(!1),g=L(()=>Object.values(o.value).map(e=>({value:e.Id,title:e.Nom})).sort((e,t)=>e.title.localeCompare(t.title))),_=B(null),v=B(null),T=B(null),E=B(!1);return(n,b)=>(t(),C(G,null,{default:z(()=>[O(a,{"align-self":`center`,cols:`3`},{default:z(()=>[O(ot,null,{default:z(()=>[S(`a`,{href:`/camps`,onClick:b[0]||=ke(e=>W(zr)(i.participant.Participant),[`prevent`])},j(W(d).label(i.participant.Personne)),1)]),_:1}),O(tt,null,{default:z(()=>[y(j(W(s).label(i.participant.Camp)),1)]),_:1})]),_:1}),O(a,{"align-self":`center`,cols:`2`,class:`text-center`},{default:z(()=>[O(rt,{disabled:f.value,"close-on-content-click":!1,modelValue:m.value,"onUpdate:modelValue":b[2]||=e=>m.value=e},{activator:z(({props:e})=>[O(w,F(e,{elevation:f.value?0:1,color:`grey-lighten-2`}),{default:z(()=>[O(R,{class:`py-1 px-1`},{default:z(()=>[f.value?(t(),c(`div`,_r,`Camp sans option`)):(t(),c(`div`,vr,[y(j(i.participant.Participant.QuotientFamilial?`QF ${i.participant.Participant.QuotientFamilial}.`:`Pas de QF.`)+` `,1),b[22]||=S(`br`,null,null,-1),y(` `+j(p(i.participant.Participant.OptionPrix)),1)]))]),_:1})]),_:1},16,[`elevation`])]),default:z(()=>[O(lr,{camp:i.participant.Camp,"option-and-qf":{options:i.participant.Participant.OptionPrix,quotientFamilial:i.participant.Participant.QuotientFamilial},onUpdate:b[1]||=e=>{i.participant.Participant.OptionPrix=e.options,i.participant.Participant.QuotientFamilial=e.quotientFamilial,m.value=!1,l(`update`,i.participant.Participant)}},null,8,[`camp`,`option-and-qf`])]),_:1},8,[`disabled`,`modelValue`])]),_:1}),O(a,{"align-self":`center`,class:`text-center`},{default:z(()=>[u.value.length?D(``,!0):(t(),C(Y,{key:0,label:``},{default:z(()=>[...b[23]||=[y(`Aucune aide`,-1)]]),_:1})),(t(!0),c(r,null,H(u.value,e=>(t(),C(Y,{class:`my-1`,"prepend-icon":`mdi-cash-plus`,color:e.Valide?`green`:`orange`,onClick:t=>v.value=e},{close:z(()=>[O(V,{icon:`mdi-close-circle`,onClick:ke(t=>T.value=e,[`stop`])},null,8,[`onClick`])]),default:z(()=>[y(` `+j(o.value[e.IdStructureaide].Nom)+` : `+j(W(P).montant(e.Valeur)),1)]),_:2},1032,[`color`,`onClick`]))),256))]),_:1}),O(a,{"align-self":`center`,class:`text-center`,cols:`3`},{default:z(()=>[O(mr,{remises:i.participant.Participant.Remises,onUpdate:b[3]||=e=>{i.participant.Participant.Remises=e,l(`update`,i.participant.Participant)}},null,8,[`remises`])]),_:1}),O(a,{"align-self":`center`,cols:`auto`},{default:z(()=>[O(rt,{location:`left`},{activator:z(({props:e})=>[O(M,F(e,{icon:`mdi-dots-vertical`,size:`small`}),null,16)]),default:z(()=>[O(J,{density:`comfortable`},{default:z(()=>[O(X,{title:`Ajouter une aide`,"prepend-icon":`mdi-cash-plus`,onClick:b[4]||=e=>_.value={IdParticipant:i.participant.Participant.Id,IdStructure:0}}),O(q),i.hasManyParticipants?(t(),C(X,{key:0,"prepend-icon":`mdi-arrow-expand`,title:`Étendre les options et remises`,subtitle:`... au reste du dossier`,onClick:b[5]||=e=>l(`expand`)})):D(``,!0),O(q),O(X,{title:`Supprimer`,"prepend-icon":`mdi-delete`,onClick:b[6]||=e=>h.value=!0})]),_:1})]),_:1})]),_:1}),O($,{modelValue:h.value,"onUpdate:modelValue":b[8]||=e=>h.value=e,"max-width":`600px`},{default:z(()=>[O(w,{title:`Supprimer le participant`},{default:z(()=>[O(R,null,{default:z(()=>[...b[24]||=[y(` Confirmez-vous la suppression de ce participant ? `,-1),S(`br`,null,null,-1),y(` Attention, cette opération est irréversible. `,-1)]]),_:1}),O(x,null,{default:z(()=>[O(Z),O(M,{color:`red`,onClick:b[7]||=e=>{l(`delete`),h.value=!1}},{default:z(()=>[...b[25]||=[y(`Supprimer`,-1)]]),_:1})]),_:1})]),_:1})]),_:1},8,[`modelValue`]),O($,{modelValue:E.value,"onUpdate:modelValue":b[10]||=e=>E.value=e,"max-width":`650px`},{default:z(()=>[O(gr,{modelValue:o.value,"onUpdate:modelValue":b[9]||=e=>o.value=e},null,8,[`modelValue`])]),_:1},8,[`modelValue`]),_.value==null?D(``,!0):(t(),C($,{key:0,"model-value":_.value!=null,"onUpdate:modelValue":b[14]||=e=>_.value=null,width:`600px`},{default:z(()=>[O(w,{title:`Ajouter une aide extérieure`},{append:z(()=>[O(M,{onClick:b[11]||=e=>E.value=!0,"prepend-icon":`mdi-view-list`},{default:z(()=>[...b[26]||=[y(` Structures`,-1)]]),_:1})]),default:z(()=>[O(R,null,{default:z(()=>[O(it,{variant:`outlined`,density:`comfortable`,label:`Structure`,items:g.value,"model-value":_.value.IdStructure==0?null:_.value.IdStructure,"onUpdate:modelValue":b[12]||=e=>_.value.IdStructure=e},null,8,[`items`,`model-value`])]),_:1}),O(x,null,{default:z(()=>[O(Z),O(M,{color:`green`,onClick:b[13]||=e=>{l(`createAide`,_.value),_.value=null},disabled:_.value.IdStructure==0},{default:z(()=>[...b[27]||=[y(`Créer`,-1)]]),_:1},8,[`disabled`])]),_:1})]),_:1})]),_:1},8,[`model-value`])),v.value==null?D(``,!0):(t(),C($,{key:1,"model-value":v.value!=null,"onUpdate:modelValue":b[19]||=e=>v.value=null,"max-width":`800px`},{default:z(()=>[O(hr,{aide:v.value,file:e.aidesFiles[v.value.Id],structures:o.value,participant:i.participant,onShowStructureaides:b[15]||=e=>E.value=!0,onSave:b[16]||=e=>{l(`updateAide`,e),v.value=null},onDeleteFile:b[17]||=e=>l(`deleteFileAide`,v.value.Id),onUploadFile:b[18]||=e=>l(`uploadFileAide`,e,v.value.Id)},null,8,[`aide`,`file`,`structures`,`participant`])]),_:1},8,[`model-value`])),T.value==null?D(``,!0):(t(),C($,{key:2,"model-value":T.value!=null,"onUpdate:modelValue":b[21]||=e=>T.value=null,"max-width":`600px`},{default:z(()=>[O(w,{title:`Supprimer l'aide`},{default:z(()=>[O(R,null,{default:z(()=>[...b[28]||=[y(` Confirmez-vous la suppression de l'aide extérieure ? `,-1),S(`br`,null,null,-1),y(` Attention, cette opération est irréversible. `,-1)]]),_:1}),O(x,null,{default:z(()=>[O(Z),O(M,{color:`red`,onClick:b[20]||=e=>{l(`deleteAide`,T.value.Id),T.value=null}},{default:z(()=>[...b[29]||=[y(`Supprimer`,-1)]]),_:1})]),_:1})]),_:1})]),_:1},8,[`model-value`]))]),_:1}))}}),br=K({__name:`DossierEditor`,props:{dossier:{},camps:{}},emits:[`updateDossier`,`createParticipant`,`updateParticipant`,`deleteParticipant`,`expandParticipant`,`createAide`,`updateAide`,`deleteAide`,`deleteFileAide`,`uploadFileAide`],setup(e,{emit:n}){let i=e,o=n,s=B(null);fe(d);let l=B(!0),u=B({});async function d(){let e=await Q.StructureaidesGet();e!==void 0&&(l.value=!1,u.value=e||{})}return(e,n)=>(t(),C(w,{title:`Modifier le dossier`},{append:z(()=>[O(M,{onClick:n[0]||=e=>s.value={IdCamp:0,IdPersonne:0,IdDossier:i.dossier.Dossier.Dossier.Id}},{prepend:z(()=>[O(V,{color:`green`},{default:z(()=>[...n[9]||=[y(`mdi-plus`,-1)]]),_:1})]),default:z(()=>[n[10]||=y(` Ajouter un participant`,-1)]),_:1})]),default:z(()=>[O(R,null,{default:z(()=>[O(G,null,{default:z(()=>[O(a,{cols:`3`},{default:z(()=>[O(ar,{responsable:i.dossier.Dossier.Responsable,dossier:i.dossier.Dossier.Dossier,onSave:n[1]||=e=>o(`updateDossier`,e)},null,8,[`responsable`,`dossier`])]),_:1}),O(q,{thickness:`2`,vertical:``}),l.value?D(``,!0):(t(),C(a,{key:0},{default:z(()=>[n[11]||=S(`div`,{class:`my-1`},null,-1),(t(!0),c(r,null,H(i.dossier.Dossier.Participants,e=>(t(),C(yr,{participant:e,aides:(i.dossier.Dossier.Aides||{})[e.Participant.Id],"aides-files":i.dossier.Dossier.AidesFiles||{},"has-many-participants":(i.dossier.Dossier.Participants?.length||0)>1,structures:u.value,"onUpdate:structures":n[2]||=e=>u.value=e,onCreateAide:n[3]||=e=>o(`createAide`,e),onDeleteAide:n[4]||=e=>o(`deleteAide`,e),onUpdateAide:n[5]||=e=>o(`updateAide`,e),onDeleteFileAide:n[6]||=e=>o(`deleteFileAide`,e),onUploadFileAide:n[7]||=(e,t)=>o(`uploadFileAide`,e,t),onUpdate:n[8]||=e=>o(`updateParticipant`,e),onDelete:t=>o(`deleteParticipant`,e.Participant.Id),onExpand:t=>o(`expandParticipant`,e.Participant)},null,8,[`participant`,`aides`,`aides-files`,`has-many-participants`,`structures`,`onDelete`,`onExpand`]))),256))]),_:1}))]),_:1})]),_:1})]),_:1}))}}),xr={class:`mr-1`},Sr=[`onClick`],Cr={class:`overflow-y-auto`,style:{"max-height":`65vh`}},wr=[`href`],Tr=K({__name:`DossierDetailsPannel`,props:{dossier:{},camps:{}},emits:[`updateDossier`,`deleteDossier`,`mergeDossier`,`createParticipant`,`updateParticipant`,`deleteParticipant`,`expandParticipant`,`createAide`,`updateAide`,`deleteAide`,`deleteFileAide`,`uploadFileAide`,`createPaiement`,`updatePaiement`,`deletePaiement`,`sendMessage`,`deleteMessage`,`sendFacture`],setup(e,{expose:n,emit:i}){let o=e,s=i;n({showEditPaiement:g,showEditDossier:p});let l=L(()=>Ve(o.dossier.Dossier,Q.isFondsSoutien?Ae.FondSoutien:Ae.Backoffice)),u=B(!1),f=B(!1);function p(){f.value=!0}let m=B(null),h=B(null);function g(e){h.value=e}let _=B(!1);async function v(){await de(o.dossier.EspacepersoURL),Q.showMessage(`Lien vers l'espace personnel copié.`)}async function b(){await de(o.dossier.VirementCode),Q.showMessage(`Identifiant de virement copié.`)}async function T(e){await de(e),Q.showMessage(`IBAN copié.`)}let E=B(!1),ee=B(!1),k=B(``);return(e,n)=>{let i=Yt,p=ft,g=mt;return t(),C(w,{class:`ml-2`},{title:z(()=>[n[36]||=y(` Responsable `,-1),S(`a`,{href:`/annuaire`,onClick:n[0]||=ke(e=>W(Ur)(o.dossier.Dossier.IdResponsable),[`prevent`])},j(o.dossier.Dossier.Responsable),1)]),subtitle:z(()=>[n[37]||=y(` Participants `,-1),(t(!0),c(r,null,H(o.dossier.Dossier.Participants,e=>(t(),c(`span`,xr,[S(`a`,{href:`/camps`,onClick:ke(t=>W(zr)(e.Participant),[`prevent`])},j(W(d).prenomN(e.Personne)),9,Sr)]))),256))]),append:z(()=>[O(M,{icon:`mdi-pencil`,onClick:n[1]||=e=>f.value=!0,class:`mx-1`}),O(rt,null,{activator:z(({props:e})=>[O(M,F(e,{icon:`mdi-dots-vertical`,size:`small`,class:`mx-1`}),null,16)]),default:z(()=>[O(J,{density:`compact`},{default:z(()=>[O(X,{"prepend-icon":`mdi-email`,onClick:n[2]||=e=>ee.value=!0,title:`Envoyer un message`,subtitle:`Notification par email`}),O(X,{"prepend-icon":`mdi-invoice-send`,onClick:n[3]||=e=>s(`sendFacture`),title:`Envoyer une demande de règlement`,subtitle:`Notification par email`}),O(q),O(X,{"prepend-icon":`mdi-cash-plus`,onClick:n[4]||=e=>s(`createPaiement`),title:`Ajouter un paiement`}),O(q),O(X,{"prepend-icon":`mdi-link`,onClick:n[5]||=e=>_.value=!0,title:`Afficher les identifiants`}),O(q),O(X,{"prepend-icon":`mdi-file-move`,onClick:n[6]||=e=>E.value=!0,title:`Fusionner vers ...`}),O(q),O(X,{onClick:n[7]||=e=>u.value=!0,title:`Supprimer`},{prepend:z(()=>[O(V,{color:`red`},{default:z(()=>[...n[38]||=[y(`mdi-delete`,-1)]]),_:1})]),_:1})]),_:1})]),_:1})]),default:z(()=>[O(R,null,{default:z(()=>[O(G,null,{default:z(()=>[O(a,{class:`ml-2 mb-1 text-center`},{default:z(()=>[O(rt,null,{activator:z(({props:e})=>[O(Y,F(e,{"prepend-icon":`mdi-currency-eur`,color:W(P).colorStatutPaiement(o.dossier.Dossier.Bilan.Statut)}),{default:z(()=>[y(j(o.dossier.Dossier.Bilan.Recu)+` payé sur `+j(o.dossier.Dossier.Bilan.Demande),1)]),_:1},16,[`color`])]),default:z(()=>[O(Rn,{dossier:o.dossier.Dossier},null,8,[`dossier`])]),_:1})]),_:1})]),_:1}),S(`div`,Cr,[O(Jt,{side:`end`,class:`mt-4`,density:`compact`},{default:z(()=>[(t(!0),c(r,null,H(l.value,(e,r)=>(t(),C(i,{event:e,key:r,onEditPaiement:n[8]||=e=>h.value=e,onDeleteMessage:n[9]||=e=>s(`deleteMessage`,e)},null,8,[`event`]))),128))]),_:1})])]),_:1}),O($,{modelValue:u.value,"onUpdate:modelValue":n[11]||=e=>u.value=e,"max-width":`600px`},{default:z(()=>[O(w,{title:`Supprimer le dossier`},{default:z(()=>[O(R,null,{default:z(()=>[...n[39]||=[y(` Confirmez-vous la suppression du dossier et de ses participants ? `,-1),S(`br`,null,null,-1),S(`br`,null,null,-1),y(` Attention, cette opération est irréversible. `,-1)]]),_:1}),O(x,null,{default:z(()=>[O(Z),O(M,{color:`red`,onClick:n[10]||=e=>{s(`deleteDossier`),u.value=!1}},{default:z(()=>[...n[40]||=[y(`Supprimer`,-1)]]),_:1})]),_:1})]),_:1})]),_:1},8,[`modelValue`]),m.value==null?D(``,!0):(t(),C($,{key:0,"model-value":m.value!=null,"onUpdate:modelValue":n[15]||=e=>m.value=null,"max-width":`600px`},{default:z(()=>[O(w,{title:`Ajouter un participant`},{default:z(()=>[O(R,null,{default:z(()=>[O(G,null,{default:z(()=>[O(a,{cols:`12`},{default:z(()=>[O(p,{label:`Camp`,camps:o.camps,modelValue:m.value.IdCamp,"onUpdate:modelValue":n[12]||=e=>m.value.IdCamp=e},null,8,[`camps`,`modelValue`])]),_:1}),O(a,{cols:`12`},{default:z(()=>[O(g,{label:`Personne`,"initial-personne":``,modelValue:m.value.IdPersonne,"onUpdate:modelValue":n[13]||=e=>m.value.IdPersonne=e,api:{SelectPersonne:W(Q).SelectPersonne.bind(W(Q))}},null,8,[`modelValue`,`api`])]),_:1})]),_:1})]),_:1}),O(x,null,{default:z(()=>[O(Z),O(M,{color:`green`,disabled:m.value.IdPersonne==0||m.value.IdCamp==0,onClick:n[14]||=e=>{s(`createParticipant`,m.value),m.value=null}},{default:z(()=>[...n[41]||=[y(`Ajouter`,-1)]]),_:1},8,[`disabled`])]),_:1})]),_:1})]),_:1},8,[`model-value`])),O($,{modelValue:f.value,"onUpdate:modelValue":n[26]||=e=>f.value=e},{default:z(()=>[O(br,{dossier:o.dossier,camps:o.camps,onUpdateDossier:n[16]||=e=>s(`updateDossier`,e),onCreateParticipant:n[17]||=e=>s(`createParticipant`,e),onUpdateParticipant:n[18]||=e=>s(`updateParticipant`,e),onDeleteParticipant:n[19]||=e=>s(`deleteParticipant`,e),onExpandParticipant:n[20]||=e=>s(`expandParticipant`,e),onCreateAide:n[21]||=e=>s(`createAide`,e),onUpdateAide:n[22]||=e=>s(`updateAide`,e),onDeleteAide:n[23]||=e=>s(`deleteAide`,e),onDeleteFileAide:n[24]||=e=>s(`deleteFileAide`,e),onUploadFileAide:n[25]||=(e,t)=>s(`uploadFileAide`,e,t)},null,8,[`dossier`,`camps`])]),_:1},8,[`modelValue`]),h.value==null?D(``,!0):(t(),C($,{key:1,"model-value":h.value!=null,"onUpdate:modelValue":n[29]||=e=>h.value=null,"max-width":`600px`},{default:z(()=>[O(ir,{paiement:h.value,onUpdate:n[27]||=e=>{s(`updatePaiement`,e),h.value=null},onDelete:n[28]||=e=>{s(`deletePaiement`,h.value),h.value=null}},null,8,[`paiement`])]),_:1},8,[`model-value`])),O($,{modelValue:_.value,"onUpdate:modelValue":n[30]||=e=>_.value=e,"max-width":`800px`},{default:z(()=>[O(w,{title:`Liens et identifiants`},{default:z(()=>[O(R,null,{default:z(()=>[O(G,null,{default:z(()=>[O(a,{cols:`3`},{default:z(()=>[...n[42]||=[y(`Espace personnel`,-1)]]),_:1}),O(a,{class:`text-truncate`},{default:z(()=>[S(`a`,{href:o.dossier.EspacepersoURL,target:`_blank`},j(o.dossier.EspacepersoURL),9,wr)]),_:1}),O(a,{"align-self":`center`,cols:`auto`},{default:z(()=>[O(M,{size:`small`,icon:`mdi-content-copy`,onClick:v})]),_:1})]),_:1}),(t(!0),c(r,null,H(o.dossier.BankAccounts,e=>(t(),C(G,null,{default:z(()=>[O(a,{cols:`3`},{default:z(()=>[y(`RIB (`+j(W(`ACVE`))+`)`,1)]),_:1}),O(a,{cols:`3`},{default:z(()=>[y(j(e[0]),1)]),_:2},1024),O(a,null,{default:z(()=>[y(j(e[1]),1)]),_:2},1024),O(a,{"align-self":`center`,cols:`auto`},{default:z(()=>[O(M,{size:`small`,icon:`mdi-content-copy`,onClick:()=>T(e[1])},null,8,[`onClick`])]),_:2},1024)]),_:2},1024))),256)),O(G,null,{default:z(()=>[O(a,{cols:`3`},{default:z(()=>[...n[43]||=[y(`Identification de virement`,-1)]]),_:1}),O(a,null,{default:z(()=>[y(j(o.dossier.VirementCode),1)]),_:1}),O(a,{"align-self":`center`,cols:`auto`},{default:z(()=>[O(M,{size:`small`,icon:`mdi-content-copy`,onClick:b})]),_:1})]),_:1})]),_:1})]),_:1})]),_:1},8,[`modelValue`]),O($,{modelValue:E.value,"onUpdate:modelValue":n[32]||=e=>E.value=e,"max-width":`600px`},{default:z(()=>[O(jn,{from:o.dossier.Dossier.Dossier.Id,onMerge:n[31]||=e=>{s(`mergeDossier`,e),E.value=!1}},null,8,[`from`])]),_:1},8,[`modelValue`]),O($,{modelValue:ee.value,"onUpdate:modelValue":n[35]||=e=>ee.value=e,"max-width":`600px`},{default:z(()=>[O(w,{title:`Nouveau message`,subtitle:`Envoie un message sur le fil de suivi et une notification par mail.`},{default:z(()=>[O(R,null,{default:z(()=>[O(G,null,{default:z(()=>[O(a,null,{default:z(()=>[O(Gt,{rows:`5`,variant:`outlined`,modelValue:k.value,"onUpdate:modelValue":n[33]||=e=>k.value=e},null,8,[`modelValue`])]),_:1})]),_:1})]),_:1}),O(x,null,{default:z(()=>[O(Z),O(M,{disabled:!k.value.length,onClickOnce:n[34]||=e=>{s(`sendMessage`,k.value),ee.value=!1}},{default:z(()=>[...n[44]||=[y(`Envoyer`,-1)]]),_:1},8,[`disabled`])]),_:1})]),_:1})]),_:1},8,[`modelValue`])]),_:1})}}}),Er=K({__name:`CreateDossierCard`,emits:[`create`],setup(e,{emit:n}){let r=n,i=B(0);return(e,n)=>{let o=mt;return t(),C(w,{title:`Créer un dossier`},{default:z(()=>[O(R,null,{default:z(()=>[O(G,null,{default:z(()=>[O(a,null,{default:z(()=>[O(o,{label:`Responsable légal`,modelValue:i.value,"onUpdate:modelValue":n[0]||=e=>i.value=e,"initial-personne":``,api:{SelectPersonne:W(Q).SelectPersonne.bind(W(Q))}},null,8,[`modelValue`,`api`])]),_:1})]),_:1})]),_:1}),O(x,null,{default:z(()=>[O(Z),O(M,{color:`green`,disabled:i.value==0,onClick:n[1]||=e=>r(`create`,i.value)},{default:z(()=>[...n[2]||=[y(`Créer`,-1)]]),_:1},8,[`disabled`])]),_:1})]),_:1})}}}),Dr=K({__name:`DossierList`,props:N({camps:{},allowFondsSoutien:{type:Boolean},selected:{}},{query:{required:!0},queryModifiers:{}}),emits:N([`click`,`update`],[`update:query`]),setup(e,{expose:i,emit:s}){let l=e,u=s,d=I(e,`query`);i({searchDossiers:m}),Ge(()=>d.value,m,{immediate:!0});let f=B(null);async function m(){let e=await Q.DossiersSearch(d.value);e!==void 0&&(f.value=e,u(`update`,e))}return(e,i)=>{let s=ft,g=bt;return t(),c(`div`,null,[O(G,null,{default:z(()=>[O(a,{"align-self":`center`},{default:z(()=>[O(g,{density:`compact`,variant:`outlined`,"prepend-inner-icon":`mdi-magnify`,label:`Rechercher un dossier`,"hide-details":``,clearable:``,modelValue:d.value.Pattern,"onUpdate:modelValue":[i[5]||=e=>d.value.Pattern=e,m]},{"append-inner":z(()=>[d.value.IdCamp.Valid?(t(),C(Y,{key:0,class:`ml-1`,size:`small`,"prepend-icon":`mdi-bed`},{default:z(()=>[y(j(l.camps.find(e=>e.Id==d.value.IdCamp.Id)?.Label),1)]),_:1})):D(``,!0),d.value.Attente==W($e).EmptyQA?D(``,!0):(t(),C(Y,{key:1,class:`ml-1`,size:`small`,"prepend-icon":`mdi-clock`},{default:z(()=>[y(j(W(o)[d.value.Attente]),1)]),_:1})),d.value.Reglement==W(se).EmptyQR?D(``,!0):(t(),C(Y,{key:2,class:`ml-1`,size:`small`,"prepend-icon":`mdi-currency-eur`},{default:z(()=>[y(j(W(p)[d.value.Reglement]),1)]),_:1})),d.value.OnlyFondSoutien?(t(),C(Y,{key:3,class:`ml-1`,size:`small`},{default:z(()=>[...i[6]||=[y(` Fonds de soutien `,-1)]]),_:1})):D(``,!0)]),append:z(()=>[O(rt,{location:`left top`,"close-on-content-click":!1},{activator:z(({props:e})=>[O(M,F(e,{size:`small`,variant:`flat`,icon:``}),{default:z(()=>[O(V,null,{default:z(()=>[...i[7]||=[y(`mdi-filter-cog`,-1)]]),_:1}),O(Ut,{activator:`parent`,text:`Autres critères de recherche`})]),_:1},16)]),default:z(()=>[O(w,{"min-width":`400px`,title:`Filtrer les dossiers`},{default:z(()=>[O(R,null,{default:z(()=>[O(G,null,{default:z(()=>[O(a,null,{default:z(()=>[O(s,{label:`Camp`,camps:l.camps,"model-value":W(_e)(W(Je)(d.value.IdCamp)),"onUpdate:modelValue":i[0]||=e=>{d.value.IdCamp=W(n)(W(Me)(e)),m()}},null,8,[`camps`,`model-value`])]),_:1})]),_:1}),O(G,null,{default:z(()=>[O(a,null,{default:z(()=>[O(it,{density:`compact`,variant:`outlined`,label:`Liste d'attente`,modelValue:d.value.Attente,"onUpdate:modelValue":[i[1]||=e=>d.value.Attente=e,m],items:W(Ke)(W(o)),"hide-details":``},null,8,[`modelValue`,`items`])]),_:1})]),_:1}),O(G,null,{default:z(()=>[O(a,null,{default:z(()=>[O(it,{density:`compact`,variant:`outlined`,label:`Réglement`,modelValue:d.value.Reglement,"onUpdate:modelValue":[i[2]||=e=>d.value.Reglement=e,m],items:W(Ke)(W(p)),"hide-details":``},null,8,[`modelValue`,`items`])]),_:1})]),_:1}),O(G,null,{default:z(()=>[O(a,null,{default:z(()=>[O(yt,{label:`Trier selon les nouveaux messages`,hint:`Affiche les nouveaux messages en premier.`,"persistent-hint":``,density:`compact`,color:`light-blue-darken-3`,modelValue:d.value.SortByNewMessages,"onUpdate:modelValue":[i[3]||=e=>d.value.SortByNewMessages=e,m]},null,8,[`modelValue`])]),_:1})]),_:1}),l.allowFondsSoutien?(t(),C(G,{key:0},{default:z(()=>[O(a,null,{default:z(()=>[O(yt,{label:`Fonds de soutien`,hint:`N'affiche que les dossiers demandant le fonds de soutien.`,"persistent-hint":``,density:`compact`,color:`orange`,modelValue:d.value.OnlyFondSoutien,"onUpdate:modelValue":[i[4]||=e=>d.value.OnlyFondSoutien=e,m]},null,8,[`modelValue`])]),_:1})]),_:1})):D(``,!0)]),_:1})]),_:1})]),_:1})]),_:1},8,[`modelValue`])]),_:1})]),_:1}),f.value==null?D(``,!0):(t(),C(J,{key:0,class:`mt-2`,selected:l.selected?[l.selected]:void 0},{default:z(()=>[f.value.Dossiers?.length?D(``,!0):(t(),C(X,{key:0,class:`text-center`},{default:z(()=>[...i[8]||=[S(`i`,null,`Aucun dossier ne correspond à votre recherche.`,-1)]]),_:1})),(t(!0),c(r,null,H(f.value.Dossiers,(e,n)=>(t(),C(X,{rounded:``,key:n,title:e.Responsable,subtitle:e.Participants,value:e.Id,onClick:t=>u(`click`,e),class:`my-1`},h({_:2},[e.NewMessages?{name:`append`,fn:z(()=>[O(zt,{color:`light-blue-darken-3`,content:e.NewMessages},null,8,[`content`])]),key:`0`}:void 0]),1032,[`title`,`subtitle`,`value`,`onClick`]))),128))]),_:1},8,[`selected`]))])}}}),Or=K({__name:`SendDocumentsCampCard`,props:{camps:{}},emits:[`send`],setup(e,{emit:n}){let i=e,o=n,s=B(0),l=B(null);async function u(){let e=await Q.EventsSendDocumentsCampPreview({idCamp:s.value});e!==void 0&&(l.value=e,d.value=(e.Dossiers||[]).filter(e=>!e.DocumentsSent).map(e=>e.Id))}let d=B([]),f=L(()=>d.value.length==(l.value?.Dossiers||[]).length);return(e,n)=>{let p=ft;return t(),C(w,{title:`Envoyer les documents d'un séjour`},{default:z(()=>[O(R,null,{default:z(()=>[O(G,null,{default:z(()=>[O(a,{"align-self":`center`,cols:`5`},{default:z(()=>[O(p,{camps:i.camps,label:`Séjour`,modelValue:s.value,"onUpdate:modelValue":[n[0]||=e=>s.value=e,u]},null,8,[`camps`,`modelValue`])]),_:1}),O(a,{"align-self":`center`},{default:z(()=>[l.value?(t(),C(w,{key:0,subtitle:`Dossiers à contacter`},h({default:z(()=>[O(R,null,{default:z(()=>[O(J,{selectable:``,selected:d.value,"onUpdate:selected":n[2]||=e=>d.value=e,"select-strategy":`leaf`},{default:z(()=>[(t(!0),c(r,null,H(l.value.Dossiers,e=>(t(),C(X,{title:e.Responsable,subtitle:e.Participants,value:e.Id,rounded:``,class:`my-1`},{append:z(({isSelected:r,select:i})=>[O(G,null,{default:z(()=>[O(a,null,{default:z(()=>[e.DocumentsSent?(t(),C(Y,{key:0,color:`green`,class:`mr-2`},{default:z(()=>[...n[4]||=[y(`Envoyés`,-1)]]),_:1})):D(``,!0)]),_:2},1024),O(a,null,{default:z(()=>[O(nt,{density:`compact`,"hide-details":``,"model-value":r,"onUpdate:modelValue":i},null,8,[`model-value`,`onUpdate:modelValue`])]),_:2},1024)]),_:2},1024)]),_:2},1032,[`title`,`subtitle`,`value`]))),256))]),_:1},8,[`selected`])]),_:1})]),_:2},[l.value.Dossiers?.length?{name:`append`,fn:z(()=>[O(at,{label:`Tout sélectionner`,density:`compact`,"hide-details":``,indeterminate:!!d.value.length&&d.value.length!=(l.value.Dossiers||[]).length,"model-value":d.value.length==(l.value.Dossiers||[]).length,"onUpdate:modelValue":n[1]||=e=>d.value=f.value?[]:(l.value.Dossiers||[]).map(e=>e.Id)},null,8,[`indeterminate`,`model-value`])]),key:`0`}:void 0]),1024)):D(``,!0)]),_:1})]),_:1})]),_:1}),O(x,null,{default:z(()=>[O(Z),O(M,{disabled:!s.value||!d.value.length,onClick:n[3]||=e=>o(`send`,s.value,d.value),"prepend-icon":`mdi-send`},{default:z(()=>[...n[5]||=[y(` Envoyer `,-1)]]),_:1},8,[`disabled`])]),_:1})]),_:1})}}}),kr=K({__name:`SendRelancePaiementCard`,props:{camps:{}},emits:[`send`],setup(e,{emit:n}){let i=e,o=n,s=B(0),l=B([]);async function u(){let e=await Q.EventsSendRelancePaiementPreview({idCamp:s.value});e!==void 0&&(l.value=e||[],d.value=(e||[]).map(e=>e.Id))}let d=B([]),f=L(()=>d.value.length==l.value.length);return(e,n)=>{let p=ft;return t(),C(w,{title:`Envoyer une relance de paiement`},{default:z(()=>[O(R,null,{default:z(()=>[O(G,null,{default:z(()=>[O(a,{"align-self":`center`,cols:`5`},{default:z(()=>[O(p,{camps:i.camps,label:`Séjour`,modelValue:s.value,"onUpdate:modelValue":[n[0]||=e=>s.value=e,u]},null,8,[`camps`,`modelValue`])]),_:1}),O(a,{"align-self":`center`},{default:z(()=>[l.value?(t(),C(w,{key:0,subtitle:`Dossiers à relancer`},h({default:z(()=>[O(R,null,{default:z(()=>[O(J,{selectable:``,selected:d.value,"onUpdate:selected":n[2]||=e=>d.value=e,"select-strategy":`leaf`,density:`comfortable`},{default:z(()=>[(t(!0),c(r,null,H(l.value,(e,n)=>(t(),C(X,{key:e.Id,title:e.Responsable,subtitle:W(Be)(e.LastEventFacture)?``:`Dernière demande : ${W(P).time(e.LastEventFacture)}`,value:e.Id,rounded:``,class:`my-1`},{append:z(({isSelected:t,select:n})=>[O(G,null,{default:z(()=>[O(a,{"align-self":`center`},{default:z(()=>[O(Y,{class:`mr-2`,color:W(P).colorStatutPaiement(e.Bilan.Statut)},{default:z(()=>[y(j(e.Bilan.Recu)+` / `+j(e.Bilan.Demande),1)]),_:2},1032,[`color`])]),_:2},1024),O(a,{"align-self":`center`},{default:z(()=>[O(nt,{density:`compact`,"hide-details":``,"model-value":t,"onUpdate:modelValue":n},null,8,[`model-value`,`onUpdate:modelValue`])]),_:2},1024)]),_:2},1024)]),_:2},1032,[`title`,`subtitle`,`value`]))),128))]),_:1},8,[`selected`])]),_:1})]),_:2},[l.value.length?{name:`append`,fn:z(()=>[O(at,{label:`Tout sélectionner`,density:`compact`,"hide-details":``,indeterminate:!!d.value.length&&d.value.length!=l.value.length,"model-value":d.value.length==l.value.length,"onUpdate:modelValue":n[1]||=e=>d.value=f.value?[]:l.value.map(e=>e.Id)},null,8,[`indeterminate`,`model-value`])]),key:`0`}:void 0]),1024)):D(``,!0)]),_:1})]),_:1})]),_:1}),O(x,null,{default:z(()=>[O(Z),O(M,{disabled:!s.value||!d.value.length,onClick:n[3]||=e=>o(`send`,s.value,d.value),"prepend-icon":`mdi-send`},{default:z(()=>[...n[4]||=[y(` Envoyer `,-1)]]),_:1},8,[`disabled`])]),_:1})]),_:1})}}}),Ar=K({__name:`RemisesHintsCard`,props:{allCamps:{}},setup(e){let n=e;fe(()=>{s.value=n.allCamps.filter(e=>!e.IsOld).map(e=>e.Id),u()});let i=B([]),o=B(!1),s=B([]),l=B(null);async function u(){let e=await Q.DossiersRemisesHint({IdCamps:s.value});e!==void 0&&(l.value=e||[])}let d=B([]);async function f(){let e=l.value;if(!d.value.length||!e)return;let t=d.value.map(t=>e[t]),n=await Q.DossiersApplyRemisesHints(t);d.value=[],n!==void 0&&(Q.showMessage(`Remises appliquées avec succès.`),u())}return(e,p)=>(t(),C(w,{title:`Estimer les remises`,subtitle:`Seules les nouvelles remises sont affichées.`},{append:z(()=>[O(M,{onClick:p[0]||=e=>{i.value=s.value,o.value=!0},"prepend-icon":`mdi-cog`},{default:z(()=>[...p[5]||=[y(` Séjours `,-1)]]),_:1}),O(q,{vertical:``,thickness:`1`,class:`mx-2`}),O(M,{disabled:!d.value.length,onClick:f},{default:z(()=>[...p[6]||=[y(`Appliquer les remises`,-1)]]),_:1},8,[`disabled`])]),default:z(()=>[O(R,null,{default:z(()=>[l.value==null?(t(),C(Ee,{key:0})):(t(),C(J,{key:1,"select-strategy":`leaf`,selected:d.value,"onUpdate:selected":p[1]||=e=>d.value=e,color:`primary`},{default:z(()=>[l.value.length?D(``,!0):(t(),C(X,{key:0,class:`font-italic`},{default:z(()=>[...p[7]||=[y(` Aucune nouvelle remise à appliquer. `,-1)]]),_:1})),(t(!0),c(r,null,H(l.value,(e,n)=>(t(),C(X,{title:e.Personne,subtitle:e.Camp,value:n,rounded:``,class:`my-1`},{append:z(()=>[O(G,{style:{width:`200px`}},{default:z(()=>[O(a,{cols:`6`},{default:z(()=>[e.Hint.Famille?(t(),C(Y,{key:0,"prepend-icon":`mdi-account-multiple`,class:`mx-1`,elevation:`1`},{default:z(()=>[y(j(e.Hint.Famille)+` % `,1),O(Ut,{activator:`parent`,"content-class":`ma-0 pa-0`},{default:z(()=>[O(w,{subtitle:`Autres inscrits de la même famille`},{default:z(()=>[O(R,null,{default:z(()=>[(t(!0),c(r,null,H(e.AutresInscrits,e=>(t(),C(Y,{class:`mx-1`},{default:z(()=>[y(j(e.Personne)+` (`+j(e.Camp)+`)`,1)]),_:2},1024))),256))]),_:2},1024)]),_:2},1024)]),_:2},1024)]),_:2},1024)):D(``,!0)]),_:2},1024),O(a,{cols:`6`},{default:z(()=>[e.Hint.Equipiers?(t(),C(Y,{key:0,"prepend-icon":`mdi-account-hard-hat`,class:`mx-1`,elevation:`1`},{default:z(()=>[y(j(e.Hint.Equipiers)+` % `,1),O(Ut,{activator:`parent`,"content-class":`ma-0 pa-0`},{default:z(()=>[O(w,{subtitle:`Equipiers de la même famille`},{default:z(()=>[O(R,null,{default:z(()=>[(t(!0),c(r,null,H(e.Equipiers,e=>(t(),C(Y,{class:`mx-1`},{default:z(()=>[y(j(e.Personne)+` (`+j(e.Camp)+`)`,1)]),_:2},1024))),256))]),_:2},1024)]),_:2},1024)]),_:2},1024)]),_:2},1024)):D(``,!0)]),_:2},1024)]),_:2},1024)]),_:2},1032,[`title`,`subtitle`,`value`]))),256))]),_:1},8,[`selected`]))]),_:1}),O($,{modelValue:o.value,"onUpdate:modelValue":p[4]||=e=>o.value=e,"max-width":`600px`},{default:z(()=>[O(w,{title:`Choix des séjours`},{default:z(()=>[O(R,null,{default:z(()=>[O(_n,{"all-camps":n.allCamps,modelValue:i.value,"onUpdate:modelValue":p[2]||=e=>i.value=e},null,8,[`all-camps`,`modelValue`])]),_:1}),O(x,null,{default:z(()=>[O(Z),O(M,{onClick:p[3]||=e=>{s.value=i.value,o.value=!1,u()}},{default:z(()=>[...p[8]||=[y(`Appliquer`,-1)]]),_:1})]),_:1})]),_:1})]),_:1},8,[`modelValue`])]),_:1}))}}),jr={key:1,class:`text-center font-italic my-6`},Mr=K({__name:`PannelDossiers`,props:{initialDossier:{}},setup(e){let n=e;fe(()=>{l(),n.initialDossier!==void 0&&p(n.initialDossier)}),Ge(()=>n.initialDossier,()=>{n.initialDossier!==void 0&&p(n.initialDossier)});let r=Re(`detailsPannel`),i=B(null),o=B(Dt()),s=B([]);async function l(){let e=await Q.GetCamps();e!==void 0&&(s.value=e||[])}function u(e){i.value={length:e.Dossiers?.length||0,total:e.Total}}let d=Re(`dossierList`);function f(){d.value?.searchDossiers()}async function p(e){await h(e),o.value=Ot(e)}let m=B(null);async function h(e){let t=await Q.DossiersLoad({id:e});t!==void 0&&(m.value=t)}async function g(e){h(e.Id),await Q.EventsMarkMessagesSeen({idDossier:e.Id})!==void 0&&f()}async function _(){m.value!=null&&h(m.value.Dossier.Dossier.Id)}let v=B(!1);async function b(e){v.value=!1;let t=await Q.DossiersCreate({idResponsable:e});t!==void 0&&(Q.showMessage(`Dossier créé avec succès.`),await p(t.Id),r.value?.showEditDossier())}async function x(e){let t=await Q.DossiersUpdate(e);t!==void 0&&(Q.showMessage(`Dossier mis à jour avec succès.`),m.value!=null&&(m.value.Dossier.Dossier=e,m.value.Dossier.Responsable=t.Responsable),f())}async function S(){if(m.value==null)return;let e=m.value.Dossier.Dossier.Id;await Q.DossiersDelete({id:e})!==void 0&&(Q.showMessage(`Dossier supprimé avec succès.`),m.value=null,f())}async function T(e){await Q.DossiersMerge(e)!==void 0&&(Q.showMessage(`Dossier fusionné avec succès.`),f(),h(e.To))}async function E(e){await Q.ParticipantsCreate(e)!==void 0&&(Q.showMessage(`Participant ajouté avec succès.`),_())}async function ee(e){await Q.ParticipantsUpdate(e)!==void 0&&(Q.showMessage(`Réglages du participant modifiés avec succès.`),_())}async function k(e){await Q.ParticipantsDelete({id:e})!==void 0&&(Q.showMessage(`Participant supprimé avec succès.`),_())}async function te(e){if(m.value==null)return;let t=m.value.Dossier.Participants?.map(e=>e.Participant).filter(t=>t.Id!=e.Id)||[];t.length&&(t.forEach(t=>{t.Remises=e.Remises,t.QuotientFamilial=e.QuotientFamilial,t.IdCamp==e.IdCamp&&(t.OptionPrix=e.OptionPrix)}),!(await Promise.all(t.map(e=>Q.ParticipantsUpdate(e)))).includes(void 0)&&(Q.showMessage(`Réglages des participants modifiés avec succès.`),_()))}async function A(e){let t=await Q.AidesCreate(e);if(t===void 0||(Q.showMessage(`Aide ajoutée avec succès.`),m.value==null))return;let n=m.value.Dossier.Aides||{},r=n[e.IdParticipant]||{};r[t.Id]=t,n[e.IdParticipant]=r,m.value.Dossier.Aides=n}async function j(e){await Q.AidesUpdate(e)!==void 0&&(Q.showMessage(`Aide modifiée avec succès.`),_())}async function ne(e){await Q.AidesJustificatifDelete({idAide:e})!==void 0&&(Q.showMessage(`Justificatif supprimé avec succès.`),m.value!=null&&m.value.Dossier.AidesFiles&&delete m.value.Dossier.AidesFiles[e])}async function re(e,t){let n=await Q.AidesJustificatifUpload(e,{idAide:t});if(n!==void 0&&(Q.showMessage(`Justificatif téléversé avec succès.`),m.value!=null)){let e=m.value.Dossier.AidesFiles||{};e[t]=n,m.value.Dossier.AidesFiles=e}}async function N(e){await Q.AidesDelete({id:e})!==void 0&&(Q.showMessage(`Aide supprimée avec succès.`),_())}async function ie(){if(m.value==null)return;let e=await Q.PaiementsCreate({idDossier:m.value.Dossier.Dossier.Id});e!==void 0&&(Q.showMessage(`Paiement créé avec succès.`),_(),r.value?.showEditPaiement(e))}async function ae(e){await Q.PaiementsUpdate(e)!==void 0&&(Q.showMessage(`Paiement modifié avec succès.`),_())}async function P(e){await Q.PaiementsDelete({id:e.Id})!==void 0&&(Q.showMessage(`Paiement supprimé avec succès.`),_())}async function oe(e){m.value!=null&&await Q.EventsSendMessage({IdDossier:m.value.Dossier.Dossier.Id,Contenu:e})!==void 0&&(Q.showMessage(`Message envoyé avec succès.`),_())}async function se(e){await Q.EventsDelete({id:e.Id})!==void 0&&(Q.showMessage(`Message supprimé avec succès.`),_())}async function F(){m.value!=null&&await Q.EventsSendFacture({idDossier:m.value.Dossier.Dossier.Id})!==void 0&&(Q.showMessage(`Demande de règlement envoyé avec succès.`),_())}let ce=B(!1),le=B(null);async function ue(e,t){le.value={Current:0,Total:t.length};let n=await Q.EventsSendDocumentsCamp({IdCamp:e,IdDossiers:t});if(n===void 0){le.value=null;return}await We(n,e=>le.value=e,e=>Q.onError(`Envoi des documents`,e)),le.value=null,_(),Q.showMessage(`Documents du séjour envoyés avec succès.`)}let de=B(!1),pe=B(null);async function me(e,t){pe.value={Current:0,Total:t.length};let n=await Q.EventsSendRelancePaiement({IdDossiers:t});if(n===void 0){pe.value=null;return}await We(n,e=>pe.value=e,e=>Q.onError(`Envoi de la relance`,e)),pe.value=null,_(),Q.showMessage(`Toutes les relances ont été envoyées avec succès.`)}let I=B(!1);return(e,n)=>(t(),C(G,{"no-gutters":``,class:`ma-2`},{default:z(()=>[O(a,{cols:`6`},{default:z(()=>[O(w,{title:`Dossiers`,subtitle:i.value==null?`-`:`${i.value.length} affiché(s) / ${i.value.total}`},{append:z(()=>[O(M,{icon:``,size:`small`,onClick:n[0]||=e=>v.value=!0},{default:z(()=>[O(V,{color:`green`},{default:z(()=>[...n[9]||=[y(`mdi-plus`,-1)]]),_:1})]),_:1}),O(q,{thickness:`1`,vertical:``,class:`mx-2`}),O(M,{size:`small`,"prepend-icon":`mdi-send-circle-outline`},{default:z(()=>[n[10]||=y(` Actions `,-1),O(rt,{activator:`parent`},{default:z(()=>[O(J,{density:`compact`},{default:z(()=>[O(X,{title:`Estimation des remises`,"prepend-icon":`mdi-finance`,onClick:n[1]||=e=>I.value=!0}),O(q),O(X,{title:`Documents...`,subtitle:`Paramétrer et envoyer les documents d'un séjour`,"prepend-icon":`mdi-mail`,onClick:n[2]||=e=>ce.value=!0}),O(q),O(X,{title:`Relance de paiement...`,subtitle:`Paramétrer et envoyer une relance, pour un séjour`,"prepend-icon":`mdi-invoice-send`,onClick:n[3]||=e=>de.value=!0})]),_:1})]),_:1})]),_:1})]),default:z(()=>[O(R,null,{default:z(()=>[O(Dr,{camps:s.value,"allow-fonds-soutien":W(Q).isFondsSoutien,selected:m.value?.Dossier.Dossier.Id,query:o.value,"onUpdate:query":n[4]||=e=>o.value=e,onClick:g,onUpdate:u,ref_key:`dossierList`,ref:d},null,8,[`camps`,`allow-fonds-soutien`,`selected`,`query`])]),_:1})]),_:1},8,[`subtitle`])]),_:1}),O(a,{cols:`6`},{default:z(()=>[m.value==null?(t(),c(`div`,jr,` Sélectionner un dossier... `)):(t(),C(Tr,{key:0,dossier:m.value,camps:s.value,onUpdateDossier:x,onDeleteDossier:S,onMergeDossier:T,onCreateParticipant:E,onUpdateParticipant:ee,onDeleteParticipant:k,onExpandParticipant:te,onCreateAide:A,onDeleteAide:N,onUpdateAide:j,onDeleteFileAide:ne,onUploadFileAide:re,onCreatePaiement:ie,onUpdatePaiement:ae,onDeletePaiement:P,onSendMessage:oe,onDeleteMessage:se,onSendFacture:F,ref_key:`detailsPannel`,ref:r},null,8,[`dossier`,`camps`]))]),_:1}),O($,{modelValue:v.value,"onUpdate:modelValue":n[5]||=e=>v.value=e,"max-width":`400px`},{default:z(()=>[O(Er,{onCreate:b})]),_:1},8,[`modelValue`]),O($,{modelValue:ce.value,"onUpdate:modelValue":n[6]||=e=>ce.value=e,"max-width":`1000px`},{default:z(()=>[O(Or,{camps:s.value,onSend:ue},null,8,[`camps`])]),_:1},8,[`modelValue`]),O($,{modelValue:de.value,"onUpdate:modelValue":n[7]||=e=>de.value=e,"max-width":`1000px`},{default:z(()=>[O(kr,{camps:s.value,onSend:me},null,8,[`camps`])]),_:1},8,[`modelValue`]),O($,{"model-value":le.value!=null,"max-width":`400px`,persistent:``},{default:z(()=>[le.value?(t(),C(pt,{key:0,title:`Envoi des documents en cours`,current:le.value.Current,total:le.value.Total},null,8,[`current`,`total`])):D(``,!0)]),_:1},8,[`model-value`]),O($,{"model-value":pe.value!=null,"max-width":`400px`,persistent:``},{default:z(()=>[pe.value?(t(),C(pt,{key:0,title:`Envoi des relances en cours`,current:pe.value.Current,total:pe.value.Total},null,8,[`current`,`total`])):D(``,!0)]),_:1},8,[`model-value`]),O($,{modelValue:I.value,"onUpdate:modelValue":n[8]||=e=>I.value=e,"max-width":`800px`},{default:z(()=>[O(Ar,{"all-camps":s.value},null,8,[`all-camps`])]),_:1},8,[`modelValue`])]),_:1}))}}),Nr=K({__name:`inscriptions`,setup(e){let n=ct(),i=L(()=>Br(n.currentRoute.value.query)),a=L(()=>i.value.tab||`insc`),o=L(()=>i.value.idDossier);function s(e){let t=n.currentRoute.value;n.push({path:t.path,query:{tab:e}})}return(e,n)=>(t(),c(r,null,[O(rn,{title:`Suivi des inscriptions`},{default:z(()=>[O(Pt,{"model-value":a.value,"onUpdate:modelValue":n[0]||=e=>s(e)},{default:z(()=>[O(kt,{value:`insc`},{default:z(()=>[...n[2]||=[y(`Inscriptions en attente`,-1)]]),_:1}),O(kt,{value:`doss`},{default:z(()=>[...n[3]||=[y(`Suivi des dossiers`,-1)]]),_:1})]),_:1},8,[`model-value`])]),_:1}),O(Mt,{"model-value":a.value},{default:z(()=>[O(At,{value:`insc`},{default:z(()=>[O(Pn,{onGoTo:W(Vr),onEmpty:n[1]||=e=>W(Vr)()},null,8,[`onGoTo`])]),_:1}),O(At,{value:`doss`},{default:z(()=>[O(Mr,{"initial-dossier":o.value},null,8,[`initial-dossier`])]),_:1})]),_:1},8,[`model-value`])],64))}}),Pr=K({__name:`PersonneEdit`,props:{personne:{}},emits:[`save`],setup(e,{emit:n}){let r=e,i=n,o=B(_(r.personne)),s=L(()=>!!(o.value.Nom&&o.value.Prenom));return(e,n)=>{let r=$t,c=Xt,l=nn,u=tn,d=Qt;return t(),C(w,{title:`Editer le profil`},{default:z(()=>[O(R,null,{default:z(()=>[O(qt,null,{default:z(()=>[O(G,null,{default:z(()=>[O(a,null,{default:z(()=>[O(U,{autofocus:``,"hide-details":``,label:`Nom`,density:`compact`,variant:`outlined`,modelValue:o.value.Nom,"onUpdate:modelValue":n[0]||=e=>o.value.Nom=e},null,8,[`modelValue`])]),_:1}),O(a,null,{default:z(()=>[O(U,{"hide-details":``,label:`Prénom`,density:`compact`,variant:`outlined`,modelValue:o.value.Prenom,"onUpdate:modelValue":n[1]||=e=>o.value.Prenom=e},null,8,[`modelValue`])]),_:1}),O(a,{cols:`3`},{default:z(()=>[O(r,{modelValue:o.value.Sexe,"onUpdate:modelValue":n[2]||=e=>o.value.Sexe=e},null,8,[`modelValue`])]),_:1})]),_:1}),O(G,null,{default:z(()=>[O(a,null,{default:z(()=>[O(c,{modelValue:o.value.DateNaissance,"onUpdate:modelValue":n[3]||=e=>o.value.DateNaissance=e},null,8,[`modelValue`])]),_:1}),O(a,null,{default:z(()=>[O(U,{"hide-details":``,label:`Ville de naissance`,density:`compact`,variant:`outlined`,modelValue:o.value.VilleNaissance,"onUpdate:modelValue":n[4]||=e=>o.value.VilleNaissance=e},null,8,[`modelValue`])]),_:1}),O(a,null,{default:z(()=>[O(l,{label:`Département de naissance`,modelValue:o.value.DepartementNaissance,"onUpdate:modelValue":n[5]||=e=>o.value.DepartementNaissance=e},null,8,[`modelValue`])]),_:1}),O(a,null,{default:z(()=>[O(u,{modelValue:o.value.Nationnalite,"onUpdate:modelValue":n[6]||=e=>o.value.Nationnalite=e},null,8,[`modelValue`])]),_:1})]),_:1}),O(G,null,{default:z(()=>[O(a,null,{default:z(()=>[O(U,{"hide-details":``,label:`Adresse`,density:`compact`,variant:`outlined`,modelValue:o.value.Adresse,"onUpdate:modelValue":n[7]||=e=>o.value.Adresse=e},null,8,[`modelValue`])]),_:1}),O(a,null,{default:z(()=>[O(U,{"hide-details":``,label:`Code postal`,density:`compact`,variant:`outlined`,modelValue:o.value.CodePostal,"onUpdate:modelValue":n[8]||=e=>o.value.CodePostal=e},null,8,[`modelValue`])]),_:1}),O(a,null,{default:z(()=>[O(U,{"hide-details":``,label:`Ville`,density:`compact`,variant:`outlined`,modelValue:o.value.Ville,"onUpdate:modelValue":n[9]||=e=>o.value.Ville=e},null,8,[`modelValue`])]),_:1}),O(a,null,{default:z(()=>[O(d,{modelValue:o.value.Pays,"onUpdate:modelValue":n[10]||=e=>o.value.Pays=e},null,8,[`modelValue`])]),_:1})]),_:1}),O(G,null,{default:z(()=>[O(a,null,{default:z(()=>[O(U,{"hide-details":``,label:`Mail`,density:`compact`,variant:`outlined`,modelValue:o.value.Mail,"onUpdate:modelValue":n[11]||=e=>o.value.Mail=e},null,8,[`modelValue`])]),_:1}),O(a,null,{default:z(()=>[O(Zt,{label:`Téléphone`,modelValue:o.value.Tels,"onUpdate:modelValue":n[12]||=e=>o.value.Tels=e,formatter:o.value.Pays==`CH`?W(P).telCh:W(P).telFr},null,8,[`modelValue`,`formatter`])]),_:1})]),_:1})]),_:1})]),_:1}),O(x,null,{default:z(()=>[O(Z),O(M,{disabled:!s.value,onClick:n[13]||=e=>i(`save`,o.value)},{default:z(()=>[...n[14]||=[y(`Enregistrer`,-1)]]),_:1},8,[`disabled`])]),_:1})]),_:1})}}}),Fr=[{path:`/`,component:an},{path:`/camps`,component:An},{path:`/inscriptions`,component:Nr},{path:`/annuaire`,component:K({__name:`annuaire`,setup(e){let n=ct(),i=L(()=>Hr(n.currentRoute.value.query)),o=L(()=>i.value.idPersonne);Ge(()=>o.value,()=>o.value===void 0?null:m(o.value),{immediate:!0});let s=B([]),l=B(``);async function u(){if(!l.value)return;let e=await Q.PersonnesGet({search:l.value});e!==void 0&&(s.value=e||[])}async function d(){let e=await Q.PersonnesCreate();e!==void 0&&(Q.showMessage(`Profil créé avec succès.`),s.value.push(e),Ur(e.Id))}let f=B(null);async function p(e){f.value=null;let t=await Q.PersonnesUpdate(e);if(t===void 0)return;Q.showMessage(`Profil modifié avec succès.`),Ur();let n=s.value.findIndex(t=>t.Id==e.Id);s.value[n]=t}async function m(e){let t=await Q.PersonnesLoad({id:e});t!==void 0&&(f.value=t)}return(e,n)=>{let i=bt;return t(),c(r,null,[O(rn,{title:`Annuaire : personnes et organismes`}),O(w,{class:`my-2 mx-auto`,"max-width":`600px`},{append:z(()=>[O(M,{color:`green`,onClick:d},{default:z(()=>[...n[2]||=[y(`Créer un nouveau profil`,-1)]]),_:1})]),default:z(()=>[O(R,null,{default:z(()=>[O(G,null,{default:z(()=>[O(a,null,{default:z(()=>[O(i,{"prepend-inner-icon":`mdi-magnify`,label:`Recherche`,modelValue:l.value,"onUpdate:modelValue":[n[0]||=e=>l.value=e,u]},null,8,[`modelValue`]),O(J,null,{default:z(()=>[(t(!0),c(r,null,H(s.value,e=>(t(),C(X,{title:e.Label,subtitle:W(P).dateNaissance(e.DateNaissance),"prepend-icon":W(P).sexeIcon(e.Sexe),onClick:t=>W(Ur)(e.Id)},h({_:2},[e.IsTemp?{name:`append`,fn:z(()=>[O(Y,{"prepend-icon":`mdi-alert`,color:`warning`},{default:z(()=>[...n[3]||=[y(` Ce profil est temporaire et devrait être identifié. `,-1)]]),_:1})]),key:`0`}:void 0]),1032,[`title`,`subtitle`,`prepend-icon`,`onClick`]))),256))]),_:1})]),_:1}),O(a)]),_:1})]),_:1}),f.value==null?D(``,!0):(t(),C($,{key:0,"model-value":f.value!=null,"onUpdate:modelValue":n[1]||=e=>{f.value=null,W(Ur)(void 0)},"max-width":`1000px`},{default:z(()=>[O(Pr,{personne:f.value,onSave:p},null,8,[`personne`])]),_:1},8,[`model-value`]))]),_:1})],64)}}})}],Ir=lt({history:st(`/backoffice`),routes:Fr});Ir.onError((e,t)=>{e?.message?.includes?.(`Failed to fetch dynamically imported module`)?localStorage.getItem(`vuetify:dynamic-reload`)?console.error(`Dynamic import error, reloading page did not fix it`,e):(console.log(`Reloading page to fix dynamic import error`),localStorage.setItem(`vuetify:dynamic-reload`,`true`),location.assign(t.fullPath)):console.error(e)}),Ir.isReady().then(()=>{localStorage.removeItem(`vuetify:dynamic-reload`)});function Lr(e){return e?Number(e):void 0}function Rr(e){let t=e;return{idCamp:Lr(t.idCamp),idParticipant:Lr(t.idParticipant)}}function zr(e){Ir.push({path:`/camps`,query:{idCamp:e.IdCamp,idParticipant:e.Id}})}function Br(e){let t=e;return{tab:t.tab,idDossier:Lr(t.idDossier)}}function Vr(e){Ir.push({path:`/inscriptions`,query:{tab:`doss`,idDossier:e}})}function Hr(e){return{idPersonne:Lr(e.idPersonne)}}function Ur(e){Ir.push({path:`/annuaire`,query:{idPersonne:e}})}var Wr=[`innerHTML`],Gr=ne(K({__name:`App`,setup(e){let n=ye({text:``,color:`accent`,action:void 0,timeout:4e3}),r=B(``),i=B(``);return Q.onError=(e,t)=>{r.value=e,i.value=t},Q.showMessage=(e,t,r)=>{n.text=e,n.color=t||`success`,n.action=r,n.timeout=1e4,n.timeout=4e3},ct().beforeEach(async(e,t)=>{if(Q.hasToken())return;let n=ht.get();if(n){let t=await Q.Loggin({password:n});if(t&&t.IsValid)return Q.setToken(t.Token,t.IsFondSoutien),Q.showMessage(`Bienvenue !`),e.path==`/`?{path:`/inscriptions`}:void 0}if(e.path!==`/`)return{path:`/`}}),(e,a)=>{let o=Ue(`router-view`);return t(),C(He,null,{default:z(()=>[O(Fe,null,{default:z(()=>[O(o),O(qe,{style:{"z-index":`10000`},app:``,"model-value":n.text!=``,"onUpdate:modelValue":a[1]||=e=>n.text=``,timeout:n.timeout,color:n.color,location:`bottom left`,"close-on-content-click":``},{default:z(()=>[y(j(n.text)+` `,1),n.action?(t(),C(M,{key:0,onClick:a[0]||=e=>n.action.action(),class:`ml-2`},{default:z(()=>[y(j(n.action.title),1)]),_:1})):D(``,!0)]),_:1},8,[`model-value`,`timeout`,`color`]),O(qe,{app:``,"model-value":r.value!=``,"onUpdate:modelValue":a[2]||=e=>r.value=``,timeout:4e3,color:`red`},{default:z(()=>[S(`b`,null,j(r.value),1),S(`div`,{innerHTML:i.value},null,8,Wr)]),_:1},8,[`model-value`])]),_:1})]),_:1})}}}));Gr.use(pe).use(Ir),Gr.mount(`#app`);