import{Bi as e,Ca as t,D as n,Ea as r,Er as i,Gi as a,Ki as o,M as s,Mi as c,Ni as l,O as u,Pi as d,Ri as f,S as p,Sa as m,Sr as h,St as g,U as _,Ut as v,Vr as y,Xr as b,Xt as x,_ as S,_a as C,_i as w,ca as ee,dr as te,ea as T,f as E,g as D,gr as ne,ha as O,ii as k,ji as A,k as j,pi as M,pr as N,sa as P,ua as F,w as I,x as L,ya as R,zi as z}from"./VSnackbar-DKsX373a.js";import{o as B,s as re,v as V,x as H}from"./VSelect-DKlba4X0.js";function ie(){function e(e){return[...e.dataTransfer?.items??[]].filter(e=>e.kind===`file`).map(e=>e.webkitGetAsEntry()).filter(Boolean).length>0||[...e.dataTransfer?.files??[]].length>0}async function t(e){let t=[],n=[...e.dataTransfer?.items??[]].filter(e=>e.kind===`file`).map(e=>e.webkitGetAsEntry()).filter(Boolean);if(n.length)for(let e of n){let n=await U(e,W(`.`,e));t.push(...n.map(e=>e.file))}else t.push(...e.dataTransfer?.files??[]);return t}return{handleDrop:t,hasFilesOrFolders:e}}function U(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:``;return new Promise((n,r)=>{e.isFile?e.file(e=>n([{file:e,path:t}]),r):e.isDirectory&&e.createReader().readEntries(async e=>{let r=[];for(let n of e)r.push(...await U(n,W(t,n)));n(r)})})}function W(e,t){return t.isDirectory?`${e}/${t.name}`:e}const G=i({filterByType:String},`file-accept`);function ae(e){let t=c(()=>e.filterByType?K(e.filterByType):null);function n(e){if(t.value){let n=e.filter(t.value);return{accepted:n,rejected:e.filter(e=>!n.includes(e))}}return{accepted:e,rejected:[]}}return{filterAccepted:n}}function K(e){let t=e.split(`,`).map(e=>e.trim().toLowerCase()),n=t.filter(e=>e.startsWith(`.`)),r=t.filter(e=>e.endsWith(`/*`)),i=t.filter(e=>!n.includes(e)&&!r.includes(e));return e=>{let t=e.name.split(`.`).at(-1)?.toLowerCase()??``,a=e.type.split(`/`).at(0)?.toLowerCase()??``;return i.includes(e.type)||n.includes(`.${t}`)||r.includes(`${a}/*`)}}const q=i({chips:Boolean,counter:Boolean,counterSizeString:{type:String,default:`$vuetify.fileInput.counterSize`},counterString:{type:String,default:`$vuetify.fileInput.counter`},hideInput:Boolean,multiple:Boolean,showSize:{type:[Boolean,Number,String],default:!1,validator:e=>typeof e==`boolean`||[1e3,1024].includes(Number(e))},truncateLength:{type:[Number,String],default:22},...M(S({prependIcon:`$file`}),[`direction`]),modelValue:{type:[Array,Object],default:e=>e.multiple?[]:null,validator:e=>w(e).every(e=>typeof e==`object`&&!!e)},...G(),...p({clearable:!0})},`VFileInput`),J=h()({name:`VFileInput`,inheritAttrs:!1,props:q(),emits:{"click:control":e=>!0,"mousedown:control":e=>!0,"update:focused":e=>!0,"update:modelValue":e=>!0,rejected:e=>!0},setup(e,r){let{attrs:i,emit:s,slots:u}=r,{t:d}=te(),{filterAccepted:f}=ae(e),p=N(e,`modelValue`,e.modelValue,e=>w(e),t=>!e.multiple&&Array.isArray(t)?t[0]:t),{isFocused:m,focus:h,blur:g}=I(e),_=c(()=>typeof e.showSize==`boolean`?void 0:e.showSize),v=c(()=>(p.value??[]).reduce((e,t)=>{let{size:n=0}=t;return e+n},0)),x=c(()=>k(v.value,_.value)),S=c(()=>(p.value??[]).map(t=>{let{name:n=``,size:r=0}=t,i=Y(n);return e.showSize?`${i} (${k(r,_.value)})`:i})),T=c(()=>{let t=p.value?.length??0;return e.showSize?d(e.counterSizeString,t,x.value):d(e.counterString,t)}),j=O(),M=O(),P=O(),F=R(()=>m.value||e.active),B=c(()=>[`plain`,`underlined`].includes(e.variant)),V=C(!1),{handleDrop:H,hasFilesOrFolders:U}=ie();function W(){P.value!==document.activeElement&&P.value?.focus(),m.value||h()}function G(e){P.value?.click()}function K(e){s(`mousedown:control`,e)}function q(e){P.value?.click(),s(`click:control`,e)}function J(t){t.stopPropagation(),W(),o(()=>{p.value=[],y(e[`onClick:clear`],t)})}function Y(t){if(t.length<Number(e.truncateLength))return t;let n=Math.floor((Number(e.truncateLength)-1)/2);return`${t.slice(0,n)}…${t.slice(t.length-n)}`}function X(e){e.preventDefault(),e.stopImmediatePropagation(),V.value=!0}function Z(e){e.preventDefault(),V.value=!1}async function Q(e){e.preventDefault(),e.stopImmediatePropagation(),V.value=!1,!(!P.value||!U(e))&&$(await H(e))}function oe(t){!t.target||t.repack||(e.filterByType?$([...t.target.files]):p.value=[...t.target.files??[]])}function $(e){let t=new DataTransfer,{accepted:n,rejected:r}=f(e);r.length&&s(`rejected`,r);for(let e of n)t.items.add(e);P.value.files=t.files,p.value=[...t.files];let i=new Event(`change`,{bubbles:!0});i.repack=!0,P.value.dispatchEvent(i)}return ee(p,e=>{(!Array.isArray(e)||!e.length)&&P.value&&(P.value.value=``)}),ne(()=>{let r=!!(u.counter||e.counter),o=!!(r||u.details),[s,c]=b(i),{modelValue:d,...f}=D.filterProps(e),h={...L.filterProps(e),"onClick:clear":J},_=i.webkitdirectory!==void 0&&i.webkitdirectory!==!1,y=i.accept?String(i.accept):void 0,C=_?void 0:e.filterByType??y;return z(D,a({ref:j,modelValue:e.multiple?p.value:p.value[0],class:[`v-file-input`,{"v-file-input--chips":!!e.chips,"v-file-input--dragging":V.value,"v-file-input--hide":e.hideInput,"v-input--plain-underlined":B.value},e.class],style:e.style,"onClick:prepend":G},s,f,{centerAffix:!B.value,focused:m.value}),{...u,default:n=>{let{id:r,isDisabled:i,isDirty:o,isReadonly:s,isValid:d,hasDetails:f}=n;return z(L,a({ref:M,prependIcon:e.prependIcon,onMousedown:K,onClick:q,"onClick:prependInner":e[`onClick:prependInner`],"onClick:appendInner":e[`onClick:appendInner`]},h,{id:r.value,active:F.value||o.value,dirty:o.value||e.dirty,disabled:i.value,focused:m.value,details:f.value,error:d.value===!1,onDragover:X,onDrop:Q}),{...u,default:n=>{let{props:{class:r,...o},controlRef:d}=n;return l(A,null,[l(`input`,a({ref:e=>P.value=d.value=e,type:`file`,accept:C,readonly:s.value,disabled:i.value,multiple:e.multiple,name:e.name,onClick:e=>{e.stopPropagation(),s.value&&e.preventDefault(),W()},onChange:oe,onDragleave:Z,onFocus:W,onBlur:g},o,c),null),l(`div`,{class:t(r)},[!!p.value?.length&&!e.hideInput&&(u.selection?u.selection({fileNames:S.value,totalBytes:v.value,totalBytesReadable:x.value}):e.chips?S.value.map(e=>z(re,{key:e,size:`small`,text:e},null)):S.value.join(`, `))])])}})},details:o?t=>l(A,null,[u.details?.(t),r&&l(A,null,[l(`span`,null,null),z(n,{active:!!p.value?.length,value:T.value,disabled:e.disabled},u.counter)])]):void 0})}),E({},j,M,P)}});var Y=5e6,X=e({__name:`FileInput`,props:{label:{}},emits:[`update`],setup(e,{expose:t,emit:n}){let r=e,i=n,a=O(null);function s(e){return e?e.size<=Y||`Taille maximale : ${Y/1e6}MB`:!0}function c(){a.value&&a.value.size>Y||i(`update`,a.value)}t({openDialog:u});let l=P(`input`);function u(){o(()=>l.value?.click())}return(e,t)=>(T(),d(J,{label:r.label,density:`comfortable`,accept:`.jpg,.jpeg,.png,.pdf`,multiple:!1,modelValue:a.value,"onUpdate:modelValue":[t[0]||=e=>a.value=e,c],rules:[s],"show-size":``,ref_key:`input`,ref:l},null,8,[`label`,`modelValue`,`rules`]))}}),Z={class:`text-right ml-2`},Q=e({__name:`FileCard`,props:{file:{},readonly:{type:Boolean}},emits:[`delete`],setup(e,{emit:t}){let n=e,i=t;return(e,t)=>(T(),d(B,null,{activator:F(({props:e})=>[z(u,a({class:`my-2`},e),{default:F(()=>[z(g,{cover:``,src:m(x).LoadMiniature(n.file.Key),width:`56px`},null,8,[`src`])]),_:1},16)]),default:F(()=>[z(u,null,{default:F(()=>[z(j,{class:`px-0`},{default:F(()=>[z(V,{"min-width":`400`,title:n.file.NomClient,subtitle:m(v).size(n.file.Taille)},{append:F(()=>[l(`div`,Z,[t[1]||=f(` téléversé le `,-1),t[2]||=l(`br`,null,null,-1),f(` `+r(m(v).time(n.file.Uploaded)),1)])]),_:1},8,[`title`,`subtitle`])]),_:1}),z(s,null,{default:F(()=>[z(_,{onClick:t[0]||=e=>i(`delete`),color:`red`},{default:F(()=>[...t[3]||=[f(` Supprimer `,-1)]]),_:1}),z(H),z(_,{href:m(x).LoadDocument(n.file.Key)},{default:F(()=>[...t[4]||=[f(` Télécharger `,-1)]]),_:1},8,[`href`])]),_:1})]),_:1})]),_:1}))}});export{X as n,Q as t};