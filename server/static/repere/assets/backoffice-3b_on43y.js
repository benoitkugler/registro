import{d as K,c as h,a as z,F as le,b as e,w as l,V as Ct,e as g,f as _t,g as E,h as k,i as xt,t as U,r as Pt,j as R,o as y,k as D,l as O,m as B,n as me,p as wt,q as Je,s as L,u as oe,v as Dt,x as De,y as Pe,z as w,A as he,B as Fe,C as Ke,D as Re,E as xl,G as Ce,I as Be,H as Jl,M as Gl,J as Kl,K as al,L as St,N as Ye,O as Ue,P as rl,Q as ll,R as Le,S as Ae,T as je,U as It,W as Ee,X as Xl,Y as se,Z as Sl,_ as At,$ as Mt,a0 as Zl,a1 as $t,a2 as Ut,a3 as $,a4 as et,a5 as Q,a6 as ce,a7 as Ve,a8 as xe,a9 as _e,aa as nl,ab as lt,ac as Ie,ad as we,ae as Ft,af as dl,ag as Te,ah as Lt,ai as ht,aj as Rt,ak as Tt,al as bl,am as Ge,an as Et,ao as Nt,ap as Ot,aq as Bt,ar as qt,as as Il,at as jt,au as Ht,av as Yt,aw as zt,ax as Qt,ay as Wt,az as Jt,aA as Gt,aB as Kt,aC as Xt,aD as Al,aE as Ml,aF as gl,aG as tt,aH as Zt,aI as ea,aJ as Vl,aK as la,aL as ta,aM as Ne,aN as aa,aO as tl,aP as na,aQ as ua,aR as ia,aS as sa,aT as oa,aU as ra,aV as $l,aW as da,aX as ma,aY as ca,aZ as va,a_ as Ul,a$ as Fl,b0 as pa,b1 as fa,b2 as pl,b3 as ya,b4 as Ll,b5 as ba,b6 as ga,b7 as hl,b8 as Va,b9 as ka,ba as Ca}from"./VSnackbar-CSHeDWX4.js";import{u as ul,c as _a,a as xa}from"./vue-router-4ePUxSH7.js";import{c as x,V as Pa,a as ml,m as at,b as kl,_ as il,d as wa,i as Rl,e as Cl,f as Da,g as nt,h as Sa,j as sl,k as Ia,l as Aa,n as Ma,o as $a,p as ut,q as Ua,r as Fa}from"./InscriptionRow.vue_vue_type_script_setup_true_lang-BC7GJXVw.js";import{V as H,a as ue,b as ie,c as ze,d as Se,e as ke,f as ge,g as Oe,h as cl,i as Tl,j as it,k as st,l as ot}from"./VTextarea-BhYI7Lz3.js";import{_ as Xe,a as La,V as ha,b as Ra,c as Ta,d as El,e as Nl}from"./VTabs-C_IsDY2P.js";import{_ as Ze,V as Ea,a as Na}from"./EventSwitch.vue_vue_type_script_setup_true_lang-BPBMEuvJ.js";import{_ as Pl}from"./_plugin-vue_export-helper-DlAUqK2U.js";import{V as X}from"./VDialog-D-NDet4o.js";import{V as He}from"./FileCard.vue_vue_type_script_setup_true_lang-CF1p9pY0.js";import{V as Ol,_ as rt,a as Oa,b as Ba,c as qa}from"./SexeField.vue_vue_type_script_setup_true_lang-ntENXTkQ.js";import{_ as ja}from"./FilesRow.vue_vue_type_script_setup_true_lang-DEkqIW7i.js";import{_ as Ha}from"./NationaliteField.vue_vue_type_script_setup_true_lang-DNIfQGyi.js";import{_ as Ya}from"./DepartementField.vue_vue_type_script_setup_true_lang-DVcPhcAH.js";import{V as za}from"./VForm-C2cAte8c.js";import"./VSheet-DnGvwv1Q.js";import"./VWindowItem-DdInNP99.js";const fl=K({__name:"NavBar",props:{title:{},hideMenu:{type:Boolean}},setup(t){const o="/static/repere/logo.png",i="v0.8.0",v=t,a=h(()=>x.isFondsSoutien);return(s,m)=>(y(),z(le,null,[e(Pa,{app:"","model-value":!v.hideMenu,"expand-on-hover":"",permanent:"",rail:""},{append:l(()=>[e(H,{"prepend-icon":"mdi-account-circle-outline",title:a.value?"Fonds de soutien":"Administrateur"},null,8,["title"]),e(H,{"prepend-icon":"mdi-logout",link:"",to:{path:"/"},color:"primary"},{default:l(()=>[...m[3]||(m[3]=[g(" Se déconnecter ",-1)])]),_:1})]),default:l(()=>[e(H,{"prepend-icon":"mdi-menu",title:`Registro ${i}`},null,8,["title"]),e(ue),e(H,{"prepend-icon":"mdi-bed",link:"",to:{path:"/camps"},color:"primary"},{default:l(()=>[...m[0]||(m[0]=[g(" Séjours ",-1)])]),_:1}),e(H,{"prepend-icon":"mdi-calendar-multiple-check",link:"",to:{path:"/inscriptions"},color:"primary"},{default:l(()=>[...m[1]||(m[1]=[g(" Inscriptions ",-1)])]),_:1}),e(ue),e(H,{"prepend-icon":"mdi-account-multiple",link:"",to:{path:"/annuaire"},color:"primary"},{default:l(()=>[...m[2]||(m[2]=[g(" Annuaire ",-1)])]),_:1}),e(ue)]),_:1},8,["model-value"]),e(Ct,{rounded:"",elevation:"4",color:"secondary"},{append:l(()=>[Pt(s.$slots,"default"),m[4]||(m[4]=R("div",{class:"mr-2"},null,-1))]),default:l(()=>[e(_t,null,{default:l(()=>[e(E,null,{default:l(()=>[e(k,{"align-self":"center",cols:"auto"},{default:l(()=>[e(xt,{width:"60",src:o})]),_:1}),e(k,{"align-self":"center"},{default:l(()=>[g(U(v.title),1)]),_:1})]),_:1})]),_:1})]),_:3})],64))}}),Qa=K({__name:"index",setup(t){const o=ul(),i=D(!1),v=D(""),a=D([]);async function s(){const m=await x.Loggin({password:v.value});m!==void 0&&(m.IsValid?(x.setToken(m.Token,m.IsFondSoutien),x.showMessage("Bienvenue !"),o.push({path:"/inscriptions"})):a.value=["Clé de connection incorrecte."])}return(m,n)=>(y(),z(le,null,[e(fl,{title:"Connection au backoffice","hide-menu":""}),e(Dt,{class:"fill-height"},{default:l(()=>[e(O,{class:"mx-auto",width:"400px"},{default:l(()=>[e(B,null,{default:l(()=>[e(me,{label:"Clé de connection",modelValue:v.value,"onUpdate:modelValue":n[1]||(n[1]=c=>v.value=c),"error-messages":a.value,type:i.value?void 0:"password",name:"password",onKeydown:n[2]||(n[2]=wt(Je(()=>v.value.length==0?null:s(),["prevent"]),["enter"]))},{"append-inner":l(()=>[e(L,{class:"ml-2",size:"small",icon:i.value?"mdi-eye":"mdi-eye-off",flat:"",onClick:n[0]||(n[0]=c=>i.value=!i.value)},null,8,["icon"])]),_:1},8,["modelValue","error-messages","type"])]),_:1}),e(oe,null,{default:l(()=>[e(ie),e(L,{disabled:!v.value.length,onClick:s},{default:l(()=>[...n[3]||(n[3]=[g("Se connecter",-1)])]),_:1},8,["disabled"])]),_:1})]),_:1})]),_:1})],64))}}),wl=K({__name:"BoolField",props:De({label:{},hideDetails:{type:Boolean},readonly:{type:Boolean},density:{},persistentHint:{type:Boolean},hint:{}},{modelValue:{type:Boolean,required:!0},modelModifiers:{}}),emits:["update:modelValue"],setup(t){const o=t,i=Pe(t,"modelValue");return(v,a)=>(y(),w(ze,{label:o.label,"model-value":i.value,"onUpdate:modelValue":a[0]||(a[0]=s=>i.value=s||!1),"hide-details":o.hideDetails,readonly:o.readonly,density:o.density,"persistent-hint":o.persistentHint,hint:o.hint},null,8,["label","model-value","hide-details","readonly","density","persistent-hint","hint"]))}}),dt=Fe({active:{type:[String,Array],default:void 0},controlHeight:[Number,String],disabled:{type:[Boolean,String,Array],default:null},nextIcon:{type:Be,default:"$next"},prevIcon:{type:Be,default:"$prev"},modeIcon:{type:Be,default:"$subgroup"},text:String,viewMode:{type:String,default:"month"}},"VDatePickerControls"),Bl=he()({name:"VDatePickerControls",props:dt(),emits:{"click:year":()=>!0,"click:month":()=>!0,"click:prev":()=>!0,"click:next":()=>!0,"click:text":()=>!0},setup(t,o){let{emit:i}=o;const{t:v}=Ke(),a=h(()=>Array.isArray(t.disabled)?t.disabled.includes("text"):!!t.disabled),s=h(()=>Array.isArray(t.disabled)?t.disabled.includes("mode"):!!t.disabled),m=h(()=>Array.isArray(t.disabled)?t.disabled.includes("prev"):!!t.disabled),n=h(()=>Array.isArray(t.disabled)?t.disabled.includes("next"):!!t.disabled);function c(){i("click:prev")}function u(){i("click:next")}function r(){i("click:year")}function d(){i("click:month")}return Re(()=>R("div",{class:Ce(["v-date-picker-controls"]),style:{"--v-date-picker-controls-height":xl(t.controlHeight)}},[e(L,{class:"v-date-picker-controls__month-btn","data-testid":"month-btn",disabled:a.value,text:t.text,variant:"text",rounded:!0,onClick:d},null),e(L,{class:"v-date-picker-controls__mode-btn","data-testid":"year-btn",disabled:s.value,density:"comfortable",icon:t.modeIcon,variant:"text","aria-label":v("$vuetify.datePicker.ariaLabel.selectYear"),onClick:r},null),e(ie,null,null),R("div",{class:"v-date-picker-controls__month"},[e(L,{"data-testid":"prev-month",disabled:m.value,density:"comfortable",icon:t.prevIcon,variant:"text","aria-label":v("$vuetify.datePicker.ariaLabel.previousMonth"),onClick:c},null),e(L,{"data-testid":"next-month",disabled:n.value,icon:t.nextIcon,density:"comfortable",variant:"text","aria-label":v("$vuetify.datePicker.ariaLabel.nextMonth"),onClick:u},null)])])),{}}}),Wa=Fe({appendIcon:Be,color:String,header:String,transition:String,onClick:St()},"VDatePickerHeader"),ql=he()({name:"VDatePickerHeader",props:Wa(),emits:{click:()=>!0,"click:append":()=>!0},setup(t,o){let{emit:i,slots:v}=o;const{backgroundColorClasses:a,backgroundColorStyles:s}=Jl(()=>t.color);function m(){i("click")}function n(){i("click:append")}return Re(()=>{const c=!!(v.default||t.header),u=!!(v.append||t.appendIcon);return R("div",{class:Ce(["v-date-picker-header",{"v-date-picker-header--clickable":!!t.onClick},a.value]),style:al(s.value),onClick:m},[v.prepend&&R("div",{key:"prepend",class:"v-date-picker-header__prepend"},[v.prepend()]),c&&e(Gl,{key:"content",name:t.transition},{default:()=>[R("div",{key:t.header,class:"v-date-picker-header__content"},[v.default?.()??t.header])]}),u&&R("div",{class:"v-date-picker-header__append"},[v.append?e(Kl,{key:"append-defaults",disabled:!t.appendIcon,defaults:{VBtn:{icon:t.appendIcon,variant:"text"}}},{default:()=>[v.append?.()]}):e(L,{key:"append-btn",icon:t.appendIcon,variant:"text",onClick:n},null)])])}),{}}}),Ja=Fe({allowedDates:[Array,Function],disabled:{type:Boolean,default:null},displayValue:null,modelValue:Array,month:[Number,String],max:null,min:null,showAdjacentMonths:Boolean,year:[Number,String],weekdays:{type:Array,default:()=>[0,1,2,3,4,5,6]},weeksInMonth:{type:String,default:"dynamic"},firstDayOfWeek:{type:[Number,String],default:void 0},firstDayOfYear:{type:[Number,String],default:void 0},weekdayFormat:String},"calendar");function Ga(t){const o=Ye(),i=Ue(t,"modelValue",[],C=>rl(C).map(_=>o.date(_))),v=h(()=>t.displayValue?o.date(t.displayValue):i.value.length>0?o.date(i.value[0]):t.min?o.date(t.min):Array.isArray(t.allowedDates)?o.date(t.allowedDates[0]):o.date()),a=Ue(t,"year",void 0,C=>{const _=C!=null?Number(C):o.getYear(v.value);return o.startOfYear(o.setYear(o.date(),_))},C=>o.getYear(C)),s=Ue(t,"month",void 0,C=>{const _=C!=null?Number(C):o.getMonth(v.value),P=o.setYear(o.startOfMonth(o.date()),o.getYear(a.value));return o.setMonth(P,_)},C=>o.getMonth(C)),m=h(()=>{const C=o.toJsDate(o.startOfWeek(o.date(),t.firstDayOfWeek)).getDay();return o.getWeekdays(t.firstDayOfWeek,t.weekdayFormat).filter((_,P)=>t.weekdays.includes((P+C)%7))}),n=h(()=>{const C=o.getWeekArray(s.value,t.firstDayOfWeek),_=C.flat(),P=6*7;if(t.weeksInMonth==="static"&&_.length<P){const q=_[_.length-1];let G=[];for(let S=1;S<=P-_.length;S++)G.push(o.addDays(q,S)),S%7===0&&(C.push(G),G=[])}return C});function c(C,_){return C.filter(P=>t.weekdays.includes(o.toJsDate(P).getDay())).map((P,q)=>{const G=o.toISO(P),S=!o.isSameMonth(P,s.value),f=o.isSameDay(P,o.startOfMonth(s.value)),ee=o.isSameDay(P,o.endOfMonth(s.value)),fe=o.isSameDay(P,s.value),W=t.weekdays.length;return{date:P,formatted:o.format(P,"keyboardDate"),isAdjacent:S,isDisabled:A(P),isEnd:ee,isHidden:S&&!t.showAdjacentMonths,isSame:fe,isSelected:i.value.some(I=>o.isSameDay(P,I)),isStart:f,isToday:o.isSameDay(P,_),isWeekEnd:q%W===W-1,isWeekStart:q%W===0,isoDate:G,localized:o.format(P,"dayOfMonth"),month:o.getMonth(P),year:o.getYear(P)}})}const u=h(()=>{const C=o.startOfWeek(v.value,t.firstDayOfWeek),_=[];for(let q=0;q<=6;q++)_.push(o.addDays(C,q));const P=o.date();return c(_,P)}),r=h(()=>{const C=n.value.flat(),_=o.date();return c(C,_)}),d=h(()=>n.value.map(C=>C.length?o.getWeek(C[0],t.firstDayOfWeek,t.firstDayOfYear):null)),{minDate:p,maxDate:V}=mt(t);function A(C){if(t.disabled)return!0;const _=o.date(C);return p.value&&o.isBefore(o.endOfDay(_),p.value)||V.value&&o.isAfter(_,V.value)?!0:Array.isArray(t.allowedDates)&&t.allowedDates.length>0?!t.allowedDates.some(P=>o.isSameDay(o.date(P),_)):typeof t.allowedDates=="function"?!t.allowedDates(_):!1}return{displayValue:v,daysInMonth:r,daysInWeek:u,genDays:c,model:i,weeksInMonth:n,weekdayLabels:m,weekNumbers:d}}function mt(t){const o=Ye(),i=h(()=>{if(!t.min)return null;const m=o.date(t.min);return o.isValid(m)?m:null}),v=h(()=>{if(!t.max)return null;const m=o.date(t.max);return o.isValid(m)?m:null});function a(m){return i.value&&o.isBefore(m,i.value)?i.value:v.value&&o.isAfter(m,v.value)?v.value:m}function s(m){return(!i.value||o.isAfter(m,i.value))&&(!v.value||o.isBefore(m,v.value))}return{minDate:i,maxDate:v,clampDate:a,isInAllowedRange:s}}const ct=Fe({color:String,hideWeekdays:Boolean,multiple:[Boolean,Number,String],showWeek:Boolean,transition:{type:String,default:"picker-transition"},reverseTransition:{type:String,default:"picker-reverse-transition"},...je(Ja(),["displayValue"])},"VDatePickerMonth"),jl=he()({name:"VDatePickerMonth",props:ct(),emits:{"update:modelValue":t=>!0,"update:month":t=>!0,"update:year":t=>!0},setup(t,o){let{emit:i,slots:v}=o;const a=D(),{t:s}=Ke(),{daysInMonth:m,model:n,weekNumbers:c,weekdayLabels:u}=Ga(t),r=Ye(),d=ll(),p=ll(),V=ll(!1),A=Le(()=>V.value?t.reverseTransition:t.transition);t.multiple==="range"&&n.value.length>0&&(d.value=n.value[0],n.value.length>1&&(p.value=n.value[n.value.length-1]));const C=h(()=>{const S=["number","string"].includes(typeof t.multiple)?Number(t.multiple):1/0;return n.value.length>=S});Ae(m,(S,f)=>{f&&(V.value=r.isBefore(S[0].date,f[0].date))});function _(S){const f=r.startOfDay(S);if(n.value.length===0?d.value=void 0:n.value.length===1&&(d.value=n.value[0],p.value=void 0),!d.value)d.value=f,n.value=[d.value];else if(p.value)d.value=S,p.value=void 0,n.value=[d.value];else{if(r.isSameDay(f,d.value)){d.value=void 0,n.value=[];return}else r.isBefore(f,d.value)?(p.value=r.endOfDay(d.value),d.value=f):p.value=r.endOfDay(f);n.value=It(r,d.value,p.value)}}function P(S){const f=r.format(S.date,"fullDateWithWeekday"),ee=S.isToday?"currentDate":"selectDate";return s(`$vuetify.datePicker.ariaLabel.${ee}`,f)}function q(S){const f=n.value.findIndex(ee=>r.isSameDay(ee,S));if(f===-1)n.value=[...n.value,S];else{const ee=[...n.value];ee.splice(f,1),n.value=ee}}function G(S){t.multiple==="range"?_(S):t.multiple?q(S):n.value=[S]}Re(()=>R("div",{class:"v-date-picker-month",style:{"--v-date-picker-days-in-week":t.weekdays.length}},[t.showWeek&&R("div",{key:"weeks",class:"v-date-picker-month__weeks"},[!t.hideWeekdays&&R("div",{key:"hide-week-days",class:"v-date-picker-month__day"},[g(" ")]),c.value.map(S=>R("div",{class:Ce(["v-date-picker-month__day","v-date-picker-month__day--adjacent"])},[S]))]),e(Gl,{name:A.value},{default:()=>[R("div",{ref:a,key:m.value[0].date?.toString(),class:"v-date-picker-month__days"},[!t.hideWeekdays&&u.value.map(S=>R("div",{class:Ce(["v-date-picker-month__day","v-date-picker-month__weekday"])},[S])),m.value.map((S,f)=>{const ee={props:{class:"v-date-picker-month__day-btn",color:S.isSelected||S.isToday?t.color:void 0,disabled:S.isDisabled,icon:!0,ripple:!1,text:S.localized,variant:S.isSelected?"flat":S.isToday?"outlined":"text","aria-label":P(S),"aria-current":S.isToday?"date":void 0,onClick:()=>G(S.date)},item:S,i:f};return C.value&&!S.isSelected&&(S.isDisabled=!0),R("div",{class:Ce(["v-date-picker-month__day",{"v-date-picker-month__day--adjacent":S.isAdjacent,"v-date-picker-month__day--hide-adjacent":S.isHidden,"v-date-picker-month__day--selected":S.isSelected,"v-date-picker-month__day--week-end":S.isWeekEnd,"v-date-picker-month__day--week-start":S.isWeekStart}]),"data-v-date":S.isDisabled?void 0:S.isoDate},[(t.showAdjacentMonths||!S.isAdjacent)&&(v.day?.(ee)??e(L,ee.props,null))])})])]})]))}}),vt=Fe({color:String,height:[String,Number],min:null,max:null,modelValue:Number,year:Number,allowedMonths:[Array,Function]},"VDatePickerMonths"),Hl=he()({name:"VDatePickerMonths",props:vt(),emits:{"update:modelValue":t=>!0},setup(t,o){let{emit:i,slots:v}=o;const a=Ye(),s=Ue(t,"modelValue"),m=h(()=>{let c=a.startOfYear(a.date());return t.year&&(c=a.setYear(c,t.year)),Ee(12).map(u=>{const r=a.format(c,"monthShort"),d=a.format(c,"month"),p=!!(!n(u)||t.min&&a.isAfter(a.startOfMonth(a.date(t.min)),c)||t.max&&a.isAfter(c,a.startOfMonth(a.date(t.max))));return c=a.getNextMonth(c),{isDisabled:p,text:r,label:d,value:u}})});Xl(()=>{s.value=s.value??a.getMonth(a.date())});function n(c){return Array.isArray(t.allowedMonths)&&t.allowedMonths.length?t.allowedMonths.includes(c):typeof t.allowedMonths=="function"?t.allowedMonths(c):!0}return Re(()=>R("div",{class:"v-date-picker-months",style:{height:xl(t.height)}},[R("div",{class:"v-date-picker-months__content"},[m.value.map((c,u)=>{const r={active:s.value===u,ariaLabel:c.label,color:s.value===u?t.color:void 0,disabled:c.isDisabled,rounded:!0,text:c.text,variant:s.value===c.value?"flat":"text",onClick:()=>d(u)};function d(p){if(s.value===p){i("update:modelValue",s.value);return}s.value=p}return v.month?.({month:c,i:u,props:r})??e(L,se({key:"month"},r),null)})])])),{}}}),pt=Fe({color:String,height:[String,Number],min:null,max:null,modelValue:Number,allowedYears:[Array,Function]},"VDatePickerYears"),Yl=he()({name:"VDatePickerYears",props:pt(),directives:{vIntersect:Sl},emits:{"update:modelValue":t=>!0},setup(t,o){let{emit:i,slots:v}=o;const a=Ye(),s=Ue(t,"modelValue"),m=h(()=>{const r=a.getYear(a.date());let d=r-100,p=r+52;t.min&&(d=a.getYear(a.date(t.min))),t.max&&(p=a.getYear(a.date(t.max)));let V=a.startOfYear(a.date());return V=a.setYear(V,d),Ee(p-d+1,d).map(A=>{const C=a.format(V,"year");return V=a.setYear(V,a.getYear(V)+1),{text:C,value:A,isDisabled:!u(A)}})});Xl(()=>{s.value=s.value??a.getYear(a.date())});const n=At();function c(){n.el?.focus(),n.el?.scrollIntoView({block:"center"})}function u(r){return Array.isArray(t.allowedYears)&&t.allowedYears.length?t.allowedYears.includes(r):typeof t.allowedYears=="function"?t.allowedYears(r):!0}return Re(()=>Mt(R("div",{class:"v-date-picker-years",style:{height:xl(t.height)}},[R("div",{class:"v-date-picker-years__content"},[m.value.map((r,d)=>{const p={ref:s.value===r.value?n:void 0,active:s.value===r.value,color:s.value===r.value?t.color:void 0,rounded:!0,text:r.text,disabled:r.isDisabled,variant:s.value===r.value?"flat":"text",onClick:()=>{if(s.value===r.value){i("update:modelValue",s.value);return}s.value=r.value}};return v.year?.({year:r,i:d,props:p})??e(L,se({key:"month"},p),null)})])]),[[Sl,{handler:c},null,{once:!0}]])),{}}}),Ka=Fe({header:{type:String,default:"$vuetify.datePicker.header"},headerColor:String,...dt(),...ct({weeksInMonth:"static"}),...je(vt(),["modelValue"]),...je(pt(),["modelValue"]),...at({title:"$vuetify.datePicker.title"}),modelValue:null},"VDatePicker"),Xa=he()({name:"VDatePicker",props:Ka(),emits:{"update:modelValue":t=>!0,"update:month":t=>!0,"update:year":t=>!0,"update:viewMode":t=>!0},setup(t,o){let{emit:i,slots:v}=o;const a=Ye(),{t:s}=Ke(),{rtlClasses:m}=Zl(),n=Ue(t,"modelValue",void 0,b=>rl(b).map(M=>a.date(M)),b=>t.multiple?b:b[0]),c=Ue(t,"viewMode"),{minDate:u,maxDate:r,clampDate:d}=mt(t),p=h(()=>{const b=a.date(),M=n.value?.[0]?a.date(n.value[0]):d(b);return M&&a.isValid(M)?M:b}),V=Le(()=>t.headerColor??t.color),A=Ue(t,"month"),C=h({get:()=>Number(A.value??a.getMonth(a.startOfMonth(p.value))),set:b=>A.value=b}),_=Ue(t,"year"),P=h({get:()=>Number(_.value??a.getYear(a.startOfYear(a.setMonth(p.value,C.value)))),set:b=>_.value=b}),q=ll(!1),G=h(()=>t.multiple&&n.value.length>1?s("$vuetify.datePicker.itemsSelected",n.value.length):n.value[0]&&a.isValid(n.value[0])?a.format(a.date(n.value[0]),"normalDateWithWeekday"):s(t.header)),S=h(()=>{let b=a.date();return b=a.setDate(b,1),b=a.setMonth(b,C.value),b=a.setYear(b,P.value),a.format(b,"monthAndYear")}),f=Le(()=>`date-picker-header${q.value?"-reverse":""}-transition`),ee=h(()=>{if(t.disabled)return!0;const b=[];if(c.value!=="month")b.push("prev","next");else{let M=a.date();if(M=a.startOfMonth(M),M=a.setMonth(M,C.value),M=a.setYear(M,P.value),u.value){const F=a.addDays(a.startOfMonth(M),-1);a.isAfter(u.value,F)&&b.push("prev")}if(r.value){const F=a.addDays(a.endOfMonth(M),1);a.isAfter(F,r.value)&&b.push("next")}}return b}),fe=h(()=>t.allowedYears||te),W=h(()=>t.allowedMonths||ne);function I(b,M){const F=t.allowedDates;if(typeof F!="function")return!0;const pe=1+Ut(a,b,M);for(let ae=0;ae<pe;ae++)if(F(a.addDays(b,ae)))return!0;return!1}function te(b){if(typeof t.allowedDates=="function"){const M=a.parseISO(`${b}-01-01`);return I(M,a.endOfYear(M))}if(Array.isArray(t.allowedDates)&&t.allowedDates.length){for(const M of t.allowedDates)if(a.getYear(a.date(M))===b)return!0;return!1}return!0}function ne(b){if(typeof t.allowedDates=="function"){const M=String(b+1).padStart(2,"0"),F=a.parseISO(`${P.value}-${M}-01`);return I(F,a.endOfMonth(F))}if(Array.isArray(t.allowedDates)&&t.allowedDates.length){for(const M of t.allowedDates)if(a.getYear(a.date(M))===P.value&&a.getMonth(a.date(M))===b)return!0;return!1}return!0}function N(){C.value<11?C.value++:(P.value++,C.value=0,J()),be()}function j(){C.value>0?C.value--:(P.value--,C.value=11,J()),be()}function re(){c.value="month"}function Z(){c.value=c.value==="months"?"month":"months"}function ye(){c.value=c.value==="year"?"month":"year"}function be(){c.value==="months"&&Z()}function J(){c.value==="year"&&ye()}return Ae(n,(b,M)=>{const F=rl(M),pe=rl(b);if(!pe.length)return;const ae=a.date(F[F.length-1]),Me=a.date(pe[pe.length-1]),$e=a.getMonth(Me),T=a.getYear(Me);$e!==C.value&&(C.value=$e,be()),T!==P.value&&(P.value=T,J()),q.value=a.isBefore(ae,Me)}),Re(()=>{const b=ml.filterProps(t),M=Bl.filterProps(t),F=ql.filterProps(t),pe=jl.filterProps(t),ae=je(Hl.filterProps(t),["modelValue"]),Me=je(Yl.filterProps(t),["modelValue"]),$e={color:V.value,header:G.value,transition:f.value};return e(ml,se(b,{color:V.value,class:["v-date-picker",`v-date-picker--${c.value}`,{"v-date-picker--show-week":t.showWeek},m.value,t.class],style:t.style}),{title:()=>v.title?.()??R("div",{class:"v-date-picker__title"},[s(t.title)]),header:()=>v.header?e(Kl,{defaults:{VDatePickerHeader:{...$e}}},{default:()=>[v.header?.($e)]}):e(ql,se({key:"header"},F,$e,{onClick:c.value!=="month"?re:void 0}),{prepend:v.prepend,append:v.append}),default:()=>R(le,null,[e(Bl,se(M,{disabled:ee.value,text:S.value,"onClick:next":N,"onClick:prev":j,"onClick:month":Z,"onClick:year":ye}),null),e($t,{hideOnLeave:!0},{default:()=>[c.value==="months"?e(Hl,se({key:"date-picker-months"},ae,{modelValue:C.value,"onUpdate:modelValue":[T=>C.value=T,be],min:u.value,max:r.value,year:P.value,allowedMonths:W.value}),{month:v.month}):c.value==="year"?e(Yl,se({key:"date-picker-years"},Me,{modelValue:P.value,"onUpdate:modelValue":[T=>P.value=T,J],min:u.value,max:r.value,allowedYears:fe.value}),{year:v.year}):e(jl,se({key:"date-picker-month"},pe,{modelValue:n.value,"onUpdate:modelValue":T=>n.value=T,month:C.value,"onUpdate:month":[T=>C.value=T,be],year:P.value,"onUpdate:year":[T=>P.value=T,J],min:u.value,max:r.value}),{day:v.day})]})]),actions:v.actions})}),{}}}),Za=K({__name:"DateField",props:De({label:{},hideDetails:{type:Boolean},readonly:{type:Boolean}},{modelValue:{required:!0},modelModifiers:{}}),emits:["update:modelValue"],setup(t){const o=t,i=Pe(t,"modelValue"),v=Ye();function a(m){s.value=!1,i.value=et(m)}const s=D(!1);return(m,n)=>o.readonly?(y(),w(me,{key:0,class:"center-text",variant:"outlined",density:"compact","hide-details":o.hideDetails,label:o.label,"model-value":$(v).parseISO(i.value).toLocaleDateString(),readonly:""},null,8,["hide-details","label","model-value"])):(y(),w(Se,{key:1,"close-on-content-click":!1,modelValue:s.value,"onUpdate:modelValue":n[1]||(n[1]=c=>s.value=c)},{activator:l(({props:c})=>[e(me,se({class:"center-text"},c,{variant:"outlined",density:"compact","hide-details":o.hideDetails,label:o.label,"model-value":$(v).parseISO(i.value).toLocaleDateString()}),null,16,["hide-details","label","model-value"])]),default:l(()=>[e(Xa,{"model-value":$(v).parseISO(i.value),"onUpdate:modelValue":n[0]||(n[0]=c=>a(c))},null,8,["model-value"])]),_:1},8,["modelValue"]))}}),ft=Pl(Za,[["__scopeId","data-v-1e184428"]]),en=K({__name:"OptionStatut",props:De({camp:{}},{modelValue:{required:!0},modelModifiers:{}}),emits:["update:modelValue"],setup(t){const o=t,i=Pe(t,"modelValue");function v(){const m=i.value?.length?i.value.map(u=>u.Id):[0],c={Id:Math.max(...m)+1,Label:"",Description:"",Prix:o.camp.Prix.Cent};i.value=(i.value||[]).concat(c),a.value=c}const a=D(null);function s(m){i.value=(i.value||[]).filter(n=>n.Id!=m.Id)}return(m,n)=>{const c=Ze;return y(),w(O,{subtitle:"Le prix dépend du statut du participant, à choisir parmi la liste ci-dessous."},{append:l(()=>[e(L,{icon:"",size:"x-small",onClick:v},{default:l(()=>[e(xe,{color:"green"},{default:l(()=>[...n[4]||(n[4]=[g("mdi-plus",-1)])]),_:1})]),_:1})]),default:l(()=>[a.value!=null?(y(),w(X,{key:0,"model-value":a.value!=null,"onUpdate:modelValue":n[3]||(n[3]=u=>a.value=null),"max-width":"500px"},{default:l(()=>[e(O,{title:"Modifier le statut"},{default:l(()=>[e(B,null,{default:l(()=>[e(E,null,{default:l(()=>[e(k,{cols:"12"},{default:l(()=>[e(me,{autofocus:"",label:"Statut",modelValue:a.value.Label,"onUpdate:modelValue":n[0]||(n[0]=u=>a.value.Label=u),density:"compact",variant:"outlined","hide-details":""},null,8,["modelValue"])]),_:1}),e(k,{cols:"12"},{default:l(()=>[e(me,{label:"Description",modelValue:a.value.Description,"onUpdate:modelValue":n[1]||(n[1]=u=>a.value.Description=u),density:"compact",variant:"outlined","hide-details":""},null,8,["modelValue"])]),_:1}),e(k,{cols:"12"},{default:l(()=>[e(c,{"model-value":{Cent:a.value.Prix,Currency:o.camp.Prix.Currency},"onUpdate:modelValue":n[2]||(n[2]=u=>a.value.Prix=u.Cent),label:"Prix","readonly-currency":""},null,8,["model-value"])]),_:1})]),_:1})]),_:1})]),_:1})]),_:1},8,["model-value"])):Q("",!0),e(B,{class:"py-0"},{default:l(()=>[e(ke,null,{default:l(()=>[i.value?.length?Q("",!0):(y(),w(H,{key:0},{default:l(()=>[...n[5]||(n[5]=[R("i",null,"Aucun statut n'est encore défini.",-1)])]),_:1})),(y(!0),z(le,null,ce(i.value,u=>(y(),w(H,{title:u.Label,subtitle:u.Description,onClick:r=>a.value=u},{append:l(()=>[e(E,null,{default:l(()=>[e(k,{"align-self":"center"},{default:l(()=>[e(ge,null,{default:l(()=>[g(U($(Ve).montant({Cent:u.Prix,Currency:t.camp.Prix.Currency})),1)]),_:2},1024)]),_:2},1024),e(k,{"align-self":"center",cols:"auto"},{default:l(()=>[e(L,{icon:"",size:"x-small",class:"my-1",onClick:Je(r=>s(u),["stop"])},{default:l(()=>[e(xe,{color:"red"},{default:l(()=>[...n[6]||(n[6]=[g("mdi-delete",-1)])]),_:1})]),_:1},8,["onClick"])]),_:2},1024)]),_:2},1024)]),_:2},1032,["title","subtitle","onClick"]))),256))]),_:1})]),_:1})]),_:1})}}}),ln=K({__name:"OptionJournee",props:De({camp:{}},{modelValue:{required:!0},modelModifiers:{}}),emits:["update:modelValue"],setup(t){const o=t,i=Pe(t,"modelValue");Ae(()=>i.value,v,{immediate:!0});function v(){const s=o.camp.Duree;i.value?.length!=s&&(i.value=Array.from({length:s}).map(m=>0))}function a(){const s=i.value,m=s[0];for(let n=0;n<s.length;n++)s[n]=m}return(s,m)=>{const n=Ze;return y(),w(O,{subtitle:"Le prix est variable en fonction des jours de participation au camp."},{append:l(()=>[e(He,{text:"Appliquer le prix du premier jour à tous."},{activator:l(({props:c})=>[e(L,se(c,{icon:"mdi-arrow-expand",size:"x-small",disabled:!(i.value||[])[0],onClick:a}),null,16,["disabled"])]),_:1})]),default:l(()=>[e(B,null,{default:l(()=>[e(E,null,{default:l(()=>[(y(!0),z(le,null,ce(i.value,(c,u)=>(y(),w(k,{cols:"3"},{default:l(()=>[e(n,{label:`Jour ${u+1}`,"model-value":{Cent:c,Currency:o.camp.Prix.Currency},"onUpdate:modelValue":r=>i.value[u]=r.Cent,"readonly-currency":""},null,8,["label","model-value","onUpdate:modelValue"])]),_:2},1024))),256))]),_:1})]),_:1})]),_:1})}}}),tn={key:0,class:"text-center"},an=K({__name:"CampOptionsPrix",props:De({camp:{}},{optionPrix:{required:!0},optionPrixModifiers:{},optionQf:{required:!0},optionQfModifiers:{}}),emits:["update:optionPrix","update:optionQf"],setup(t){const o=t,i=Pe(t,"optionPrix"),v=Pe(t,"optionQf"),a=h(()=>_e.isQuotientFamilialActive(v.value)),s=nl(lt);return(m,n)=>{const c=Xe;return y(),w(O,{title:"Options sur le prix",subtitle:"Permet de modifier le prix de base du séjour",width:"1000px"},{default:l(()=>[e(B,null,{default:l(()=>[e(E,null,{default:l(()=>[e(k,{"align-self":"center"},{default:l(()=>[e(ze,{"model-value":a.value,"onUpdate:modelValue":n[0]||(n[0]=u=>v.value[3]=u?100:0),"hide-details":"",label:"Prix au quotient familial"},null,8,["model-value"])]),_:1}),e(k,{"align-self":"center"},{default:l(()=>[e(c,{suffix:"%",min:0,max:100,disabled:!a.value,"hide-details":"","readonly-currency":"",label:"entre 1 et 359",modelValue:v.value[0],"onUpdate:modelValue":n[1]||(n[1]=u=>v.value[0]=u)},null,8,["disabled","modelValue"])]),_:1}),e(k,{"align-self":"center"},{default:l(()=>[e(c,{suffix:"%",min:0,max:100,disabled:!a.value,"hide-details":"","readonly-currency":"",label:"entre 360 et 564",modelValue:v.value[1],"onUpdate:modelValue":n[2]||(n[2]=u=>v.value[1]=u)},null,8,["disabled","modelValue"])]),_:1}),e(k,{"align-self":"center"},{default:l(()=>[e(c,{suffix:"%",min:0,max:100,disabled:!a.value,"hide-details":"","readonly-currency":"",label:"entre 565 et 714",modelValue:v.value[2],"onUpdate:modelValue":n[3]||(n[3]=u=>v.value[2]=u)},null,8,["disabled","modelValue"])]),_:1}),e(k,{"align-self":"center"},{default:l(()=>[e(c,{suffix:"%",min:0,max:100,disabled:!0,"hide-details":"","readonly-currency":"",label:"plus de 715",modelValue:v.value[3],"onUpdate:modelValue":n[4]||(n[4]=u=>v.value[3]=u)},null,8,["modelValue"])]),_:1})]),_:1}),e(ue,{thickness:"1",class:"my-2"}),e(E,{class:"my-2"},{default:l(()=>[e(k,{"align-self":"center",cols:"4"},{default:l(()=>[e(Oe,{variant:"outlined",density:"comfortable","hide-details":"",items:$(s),label:"Option sur le prix",modelValue:i.value.Active,"onUpdate:modelValue":n[5]||(n[5]=u=>i.value.Active=u)},null,8,["items","modelValue"])]),_:1}),e(k,{"align-self":"center"},{default:l(()=>[i.value.Active==$(Ie).NoOption?(y(),z("div",tn,[...n[8]||(n[8]=[R("i",null,"Aucune modification sur le prix de base.",-1)])])):i.value.Active==$(Ie).PrixStatut?(y(),w(en,{key:1,camp:o.camp,modelValue:i.value.Statuts,"onUpdate:modelValue":n[6]||(n[6]=u=>i.value.Statuts=u)},null,8,["camp","modelValue"])):i.value.Active==$(Ie).PrixJour?(y(),w(ln,{key:2,camp:o.camp,modelValue:i.value.Jours,"onUpdate:modelValue":n[7]||(n[7]=u=>i.value.Jours=u)},null,8,["camp","modelValue"])):Q("",!0)]),_:1})]),_:1})]),_:1})]),_:1})}}}),nn=K({__name:"CampMetaEdit",props:De({metaEntriesHints:{}},{modelValue:{required:!0},modelModifiers:{}}),emits:["update:modelValue"],setup(t){const o=t,i=Pe(t,"modelValue"),v=D(Object.entries(i.value||{}));function a(){const s=Object.fromEntries(v.value);i.value=s}return h(()=>{const s=v.value.map(n=>n[0]);return s.includes("")?!0:new Set(s).size!=v.value.length}),(s,m)=>(y(),w(O,{subtitle:"Métadonnées exposées sur l'API publique"},{append:l(()=>[e(L,{size:"small",class:"ml-2",onClick:m[0]||(m[0]=n=>{v.value.push(["",""]),a()})},{prepend:l(()=>[e(xe,{color:"green"},{default:l(()=>[...m[1]||(m[1]=[g("mdi-plus",-1)])]),_:1})]),default:l(()=>[m[2]||(m[2]=g(" Ajouter une valeur",-1))]),_:1})]),default:l(()=>[e(B,{class:"pt-2"},{default:l(()=>[(y(!0),z(le,null,ce(v.value,(n,c)=>(y(),w(E,null,{default:l(()=>[e(k,{cols:"4"},{default:l(()=>[e(Ol,{variant:"outlined",density:"compact","hide-details":"",label:"Clé",modelValue:n[0],"onUpdate:modelValue":[u=>n[0]=u,a],autofocus:"",items:o.metaEntriesHints.keys},null,8,["modelValue","onUpdate:modelValue","items"])]),_:2},1024),e(k,null,{default:l(()=>[e(Ol,{variant:"outlined",density:"compact","hide-details":"",label:"Valeur",modelValue:n[1],"onUpdate:modelValue":[u=>n[1]=u,a],items:o.metaEntriesHints.values},null,8,["modelValue","onUpdate:modelValue","items"])]),_:2},1024),e(k,{cols:"auto"},{default:l(()=>[e(L,{icon:"",size:"small",flat:"",onClick:u=>{v.value.splice(c,1),a()}},{default:l(()=>[e(xe,{color:"red"},{default:l(()=>[...m[3]||(m[3]=[g("mdi-close",-1)])]),_:1})]),_:1},8,["onClick"])]),_:2},1024)]),_:2},1024))),256))]),_:1})]),_:1}))}}),un=K({__name:"CampEdit",props:{camp:{},preselectionUrl:{},metaEntriesHints:{}},emits:["save"],setup(t,{emit:o}){const i=t,v=o,a=D(we(i.camp)),s=h(()=>new Date(a.value.DateDebut).getFullYear()>=2020&&a.value.Places>=1&&a.value.Nom!=""&&a.value.AgeMax>=a.value.AgeMin&&a.value.OptionQuotientFamilial.every(u=>0<=u&&u<=100)&&!(a.value.OptionPrix.Active==Ie.PrixStatut&&!a.value.OptionPrix.Statuts?.length)&&!(a.value.OptionPrix.Active==Ie.PrixJour&&a.value.OptionPrix.Jours?.length!=a.value.Duree)),m=nl(Ft);function n(u){const r=_e.isQuotientFamilialActive(u.OptionQuotientFamilial),d=u.OptionPrix.Active!=Ie.NoOption;if(!r&&!d)return"Aucune";const p=[];return _e.isQuotientFamilialActive(u.OptionQuotientFamilial)&&p.push("Quotient familial"),u.OptionPrix.Active!=Ie.NoOption&&p.push(lt[u.OptionPrix.Active]),p.join(", ")}async function c(){await dl(i.preselectionUrl),x.showMessage("URL copiée dans le presse-papier.")}return(u,r)=>{const d=ft,p=Xe,V=Ze,A=wl;return y(),w(O,{title:"Paramètres du séjour",subtitle:$(_e).label(i.camp)},{default:l(()=>[e(B,null,{default:l(()=>[e(O,{class:"my-2",subtitle:"Général"},{default:l(()=>[e(B,null,{default:l(()=>[e(E,null,{default:l(()=>[e(k,null,{default:l(()=>[e(me,{autofocus:"","hide-details":"",label:"Nom",density:"compact",variant:"outlined",modelValue:a.value.Nom,"onUpdate:modelValue":r[0]||(r[0]=C=>a.value.Nom=C)},null,8,["modelValue"])]),_:1}),e(k,null,{default:l(()=>[e(me,{"hide-details":"",label:"Lieu",density:"compact",variant:"outlined",modelValue:a.value.Lieu,"onUpdate:modelValue":r[1]||(r[1]=C=>a.value.Lieu=C)},null,8,["modelValue"])]),_:1}),e(k,null,{default:l(()=>[e(me,{"hide-details":"",label:"Numéro d'agrément",density:"compact",variant:"outlined",modelValue:a.value.Agrement,"onUpdate:modelValue":r[2]||(r[2]=C=>a.value.Agrement=C)},null,8,["modelValue"])]),_:1})]),_:1}),e(E,null,{default:l(()=>[e(k,{"align-self":"center"},{default:l(()=>[e(d,{modelValue:a.value.DateDebut,"onUpdate:modelValue":r[3]||(r[3]=C=>a.value.DateDebut=C),label:"Date de début","hide-details":""},null,8,["modelValue"])]),_:1}),e(k,{"align-self":"center"},{default:l(()=>[e(p,{label:"Durée (en jours)",modelValue:a.value.Duree,"onUpdate:modelValue":r[4]||(r[4]=C=>a.value.Duree=C),"hide-details":""},null,8,["modelValue"])]),_:1}),e(k,{"align-self":"center"},{default:l(()=>[e(d,{"model-value":$(_e).dateFin(a.value),label:"Date de fin",readonly:"","hide-details":""},null,8,["model-value"])]),_:1})]),_:1})]),_:1})]),_:1}),e(O,{class:"my-2",subtitle:"Prix"},{default:l(()=>[e(B,null,{default:l(()=>[e(E,null,{default:l(()=>[e(k,{"align-self":"center",cols:"6"},{default:l(()=>[e(V,{label:"Prix",modelValue:a.value.Prix,"onUpdate:modelValue":r[5]||(r[5]=C=>a.value.Prix=C),"hide-details":""},null,8,["modelValue"])]),_:1}),e(k,{"align-self":"center",cols:"6",class:"text-center"},{default:l(()=>[e(Se,{"close-on-content-click":!1},{activator:l(({props:C})=>[e(me,se(C,{readonly:"",label:"Option sur le prix",variant:"outlined",density:"compact","hide-details":"","model-value":n(a.value)}),null,16,["model-value"])]),default:l(()=>[e(an,{camp:a.value,"option-prix":a.value.OptionPrix,"onUpdate:optionPrix":r[6]||(r[6]=C=>a.value.OptionPrix=C),"option-qf":a.value.OptionQuotientFamilial,"onUpdate:optionQf":r[7]||(r[7]=C=>a.value.OptionQuotientFamilial=C)},null,8,["camp","option-prix","option-qf"])]),_:1})]),_:1})]),_:1})]),_:1})]),_:1}),e(O,{class:"my-2",subtitle:"Visibilité et inscriptions"},{default:l(()=>[e(B,null,{default:l(()=>[e(E,null,{default:l(()=>[e(k,{"align-self":"center"},{default:l(()=>[e(Oe,{label:"Ouverture aux inscriptions",variant:"outlined",density:"compact",items:$(m),"hide-details":"",modelValue:a.value.Statut,"onUpdate:modelValue":r[8]||(r[8]=C=>a.value.Statut=C)},null,8,["items","modelValue"])]),_:1}),e(k,{"align-self":"center"},{default:l(()=>[e(kl,{label:"Inscription externe",modelValue:a.value.InscriptionExterne,"onUpdate:modelValue":r[9]||(r[9]=C=>a.value.InscriptionExterne=C),color:"primary",density:"compact","persistent-hint":"",hint:a.value.InscriptionExterne?"Camp externe, uniquement visible sur l'API publique.":""},null,8,["modelValue","hint"])]),_:1})]),_:1})]),_:1})]),_:1}),e(O,{class:"my-2",subtitle:"Filtres sur les inscrits"},{default:l(()=>[e(B,null,{default:l(()=>[e(E,null,{default:l(()=>[e(k,{"align-self":"center"},{default:l(()=>[e(p,{modelValue:a.value.Places,"onUpdate:modelValue":r[10]||(r[10]=C=>a.value.Places=C),label:"Nombre de places"},null,8,["modelValue"])]),_:1}),e(k,{"align-self":"center"},{default:l(()=>[e(p,{modelValue:a.value.AgeMin,"onUpdate:modelValue":r[11]||(r[11]=C=>a.value.AgeMin=C),label:"Âge minimum"},null,8,["modelValue"])]),_:1}),e(k,{"align-self":"center"},{default:l(()=>[e(p,{modelValue:a.value.AgeMax,"onUpdate:modelValue":r[12]||(r[12]=C=>a.value.AgeMax=C),label:"Âge maximum"},null,8,["modelValue"])]),_:1})]),_:1}),e(E,null,{default:l(()=>[e(k,null,{default:l(()=>[e(A,{modelValue:a.value.NeedEquilibreGF,"onUpdate:modelValue":r[13]||(r[13]=C=>a.value.NeedEquilibreGF=C),label:"Equilibre G/F demandé",density:"compact","persistent-hint":"",hint:"Place un inscrit en liste d'attente en cas de déséquilibre Garçons/Filles"},null,8,["modelValue"])]),_:1})]),_:1})]),_:1})]),_:1}),e(O,{class:"my-2",subtitle:"Formulaire d'inscription"},{default:l(()=>[e(B,null,{default:l(()=>[e(E,null,{default:l(()=>[e(k,null,{default:l(()=>[e(me,{label:"Image",density:"compact",variant:"outlined",hint:"URL d'une image affichée sur le formulaire d'inscription","persistent-hint":"",modelValue:a.value.ImageURL,"onUpdate:modelValue":r[14]||(r[14]=C=>a.value.ImageURL=C)},null,8,["modelValue"])]),_:1})]),_:1}),e(E,null,{default:l(()=>[e(k,null,{default:l(()=>[e(cl,{variant:"outlined",density:"compact",label:"Description",hint:"Ce texte est affiché sur le formulaire d'inscription.","persistent-hint":"",rows:"3",modelValue:a.value.Description,"onUpdate:modelValue":r[15]||(r[15]=C=>a.value.Description=C)},null,8,["modelValue"])]),_:1}),e(k,{cols:"2"},{default:l(()=>[e(A,{label:"Navette",modelValue:a.value.Navette.Actif,"onUpdate:modelValue":r[16]||(r[16]=C=>a.value.Navette.Actif=C)},null,8,["modelValue"])]),_:1}),e(k,null,{default:l(()=>[e(cl,{variant:"outlined",density:"compact",label:"Navette",hint:"Ce texte est affiché sur l'espace personnel de suivi.","persistent-hint":"",rows:"3",disabled:!a.value.Navette.Actif,modelValue:a.value.Navette.Commentaire,"onUpdate:modelValue":r[17]||(r[17]=C=>a.value.Navette.Commentaire=C)},null,8,["disabled","modelValue"])]),_:1})]),_:1}),e(E,null,{default:l(()=>[e(k,null,{default:l(()=>[e(me,{density:"compact",variant:"outlined",label:"URL de préselection",hint:"Cette URL permet de sélectionner automatiquement le séjour sur le formulaire d'inscription.","persistent-hint":"",readonly:"","model-value":i.preselectionUrl},{append:l(()=>[e(L,{icon:"mdi-content-copy",size:"small",onClick:c})]),_:1},8,["model-value"])]),_:1})]),_:1})]),_:1})]),_:1}),e(O,{class:"my-2",subtitle:"Autre"},{default:l(()=>[e(B,null,{default:l(()=>[e(E,null,{default:l(()=>[e(k,null,{default:l(()=>[e(me,{label:"Mot de passe",density:"compact",variant:"outlined",hint:"Mot de passe d'accès à la page Directeur","persistent-hint":"",modelValue:a.value.Password,"onUpdate:modelValue":r[18]||(r[18]=C=>a.value.Password=C)},null,8,["modelValue"])]),_:1})]),_:1})]),_:1})]),_:1}),e(nn,{"meta-entries-hints":t.metaEntriesHints,modelValue:a.value.Meta,"onUpdate:modelValue":r[19]||(r[19]=C=>a.value.Meta=C)},null,8,["meta-entries-hints","modelValue"])]),_:1}),e(oe,null,{default:l(()=>[e(ie),e(L,{disabled:!s.value,onClick:r[20]||(r[20]=C=>v("save",a.value))},{default:l(()=>[...r[21]||(r[21]=[g("Enregistrer",-1)])]),_:1},8,["disabled"])]),_:1})]),_:1},8,["subtitle"])}}}),zl=K({__name:"TauxSelect",props:{modelValue:{required:!0},modelModifiers:{}},emits:["update:modelValue"],setup(t){Te(s);const o=Pe(t,"modelValue"),i=D(null),v=h(()=>{const u=Array.from(a.value.values()).map(r=>({title:r.Label,value:r.Id}));return u.sort((r,d)=>r.title.localeCompare(d.title)),u}),a=D(new Map);async function s(){const u=await x.CampsGetTaux();u!==void 0&&(a.value=Lt(u),o.value.Id>0&&(o.value=we(a.value.get(o.value.Id)),i.value=o.value.Id))}function m(){o.value.Id<=0?(i.value==null&&(i.value=1),o.value=we(a.value.get(i.value))):(i.value=null,o.value.Id=0,o.value.Label="")}function n(u){o.value=we(a.value.get(u))}const c=h(()=>{if(o.value.Id>0)return null;const u=o.value.Label;return Array.from(a.value.values()).map(d=>d.Label).includes(u)?"Ce label est déjà utilisé.":null});return(u,r)=>(y(),w(E,null,{default:l(()=>[e(k,{"align-self":"center"},{default:l(()=>[o.value.Id>0?(y(),w(Oe,{key:0,variant:"outlined",density:"compact","hide-details":"",label:"Taux",items:v.value,modelValue:i.value,"onUpdate:modelValue":[r[0]||(r[0]=d=>i.value=d),n]},null,8,["items","modelValue"])):(y(),w(E,{key:1},{default:l(()=>[e(k,{cols:"12"},{default:l(()=>[e(me,{variant:"outlined",density:"compact",label:"Label",modelValue:o.value.Label,"onUpdate:modelValue":r[1]||(r[1]=d=>o.value.Label=d),disabled:o.value.Id>0,"error-messages":c.value},null,8,["modelValue","disabled","error-messages"])]),_:1}),e(k,null,{default:l(()=>[e(me,{label:`Valeur d'un ${$(Rt)[$(Tt).FrancsSuisse]}`,density:"compact",variant:"outlined",type:"number",min:"0.001",suffix:"€",hint:"Valeur en € d'une unité de la monnaie.","persistent-hint":"","model-value":o.value.FrancsSuisse/1e3,"onUpdate:modelValue":r[2]||(r[2]=d=>o.value.FrancsSuisse=$(ht)(Number(d)*1e3)),disabled:o.value.Id>0},null,8,["label","model-value","disabled"])]),_:1})]),_:1}))]),_:1}),e(k,{cols:"auto"},{default:l(()=>[e(ue,{thickness:"2",vertical:"",class:"py-4"},{default:l(()=>[...r[3]||(r[3]=[g("ou",-1)])]),_:1})]),_:1}),e(k,{"align-self":"center",cols:"auto"},{default:l(()=>[e(L,{onClick:m,"prepend-icon":"mdi-toggle-switch"},{default:l(()=>[g(U(o.value.Id>0?"Créer un taux":"Utiliser un taux"),1)]),_:1})]),_:1})]),_:1}))}}),sn=K({__name:"CampStats",props:{stats:{}},setup(t){const o=t;function i(v,a){return`(${Ve.pourcent(v,a)} %)`}return(v,a)=>(y(),w(O,{title:"Statut des inscriptions"},{default:l(()=>[e(B,null,{default:l(()=>[e(ke,{density:"compact"},{default:l(()=>[e(H,{title:"Demandes d'inscriptions"},{append:l(()=>[g(U(o.stats.Inscriptions),1)]),_:1}),e(H,{title:"Filles",subtitle:"Parmi toutes les demandes d'inscription"},{append:l(()=>[g(U(o.stats.InscriptionsFilles)+" "+U(i(o.stats.InscriptionsFilles,o.stats.Inscriptions)),1)]),_:1}),e(H,{title:"Suisses",subtitle:"Parmi toutes les demandes d'inscription"},{append:l(()=>[g(U(o.stats.InscriptionsSuisses)+" "+U(i(o.stats.InscriptionsSuisses,o.stats.Inscriptions)),1)]),_:1}),e(H,{title:"Inscriptions confirmées"},{append:l(()=>[g(U(o.stats.Valides)+" "+U(i(o.stats.Valides,o.stats.Inscriptions)),1)]),_:1}),e(H,{title:"Filles",subtitle:"Parmi les inscriptions confirmées"},{append:l(()=>[g(U(o.stats.ValidesFilles)+" "+U(i(o.stats.ValidesFilles,o.stats.Valides)),1)]),_:1}),e(H,{title:"Suisses",subtitle:"Parmi les inscriptions confirmées"},{append:l(()=>[g(U(o.stats.ValidesSuisses)+" "+U(i(o.stats.ValidesSuisses,o.stats.Valides)),1)]),_:1}),e(H,{title:"A statuer"},{append:l(()=>[g(U(o.stats.AStatuer)+" "+U(i(o.stats.AStatuer,o.stats.Inscriptions)),1)]),_:1}),e(H,{title:"Demandes d'exception"},{append:l(()=>[g(U(o.stats.Exceptions)+" "+U(i(o.stats.Exceptions,o.stats.Inscriptions)),1)]),_:1}),e(H,{title:"Refus"},{append:l(()=>[g(U(o.stats.Refus)+" "+U(i(o.stats.Refus,o.stats.Inscriptions)),1)]),_:1})]),_:1})]),_:1})]),_:1}))}}),on={key:0},rn=K({__name:"CampHeaderRow",props:{camp:{}},emits:["click","edit","edit-taux","delete","show-documents","send-sondage","add-directeur"],setup(t,{emit:o}){const i=t,v=o,a=h(()=>i.camp.Stats.Inscriptions-i.camp.Stats.Valides),s=D(!1),m=h(()=>{switch(new Date(i.camp.Camp.Camp.DateDebut).getUTCMonth()+1){case 7:case 8:return"rgb(45, 185, 187)";case 9:case 10:case 11:return"rgb(190, 150, 60)";case 12:case 1:case 2:case 3:return"rgb(240, 240, 240)";case 4:case 5:case 6:default:return"rgb(190, 228, 100)"}}),n=D(!1),c=D(0),u=h(()=>{const r=i.camp.ParticipantsFiles||[];if(r.length==0)return 0;let d=0;for(const p of r)p.InscritsCount!=0&&(d+=p.UploadedCount/p.InscritsCount);return Math.round(d/r.length*100)});return(r,d)=>{const p=il;return y(),z(le,null,[e(O,{color:m.value,"no-gutters":"",onClick:d[6]||(d[6]=V=>v("click")),class:"my-1"},{default:l(()=>[e(E,{style:al({"background-color":m.value}),class:"px-1","no-gutters":"",justify:"space-between"},{default:l(()=>[e(k,null,{default:l(()=>[e(H,{title:$(_e).label(i.camp.Camp.Camp),subtitle:`ID : ${i.camp.Camp.Camp.Id}`},null,8,["title","subtitle"])]),_:1}),e(k,{"align-self":"center"},{default:l(()=>[g(U($(_e).formatPlage(t.camp.Camp.Camp)),1)]),_:1}),e(k,{cols:"2","align-self":"center"},{default:l(()=>[e(He,{width:"450px",location:"left","content-class":"pa-0"},{activator:l(({props:V})=>[e(bl,se({class:"bg-white border-md border-primary"},V,{max:i.camp.Camp.Camp.Places,"model-value":i.camp.Stats.Valides,height:"36",rounded:"",color:"primary"}),{default:l(()=>[R("strong",null,[g(U(i.camp.Stats.Valides)+"/"+U(i.camp.Camp.Camp.Places)+" ",1),a.value>0?(y(),z("span",on," (+ "+U(a.value)+")",1)):Q("",!0)]),e(xe,{class:"ml-2"},{default:l(()=>[...d[12]||(d[12]=[g("mdi-account-multiple",-1)])]),_:1})]),_:1},16,["max","model-value"])]),default:l(()=>[e(sn,{stats:i.camp.Stats},null,8,["stats"])]),_:1})]),_:1}),e(k,{cols:"1","align-self":"center",class:"px-2"},{default:l(()=>[e(He,{width:"600",location:"left","content-class":"pa-0"},{activator:l(({props:V})=>[e(bl,se({class:"bg-white border-md border-primary"},V,{max:100,"model-value":u.value,height:"36",rounded:"",color:"primary"}),{default:l(()=>[R("strong",null,U(u.value)+" % ",1),e(xe,{class:"ml-2"},{default:l(()=>[...d[13]||(d[13]=[g("mdi-file-upload",-1)])]),_:1})]),_:1},16,["model-value"])]),default:l(()=>[e(O,{title:"Pièces justificatives"},{default:l(()=>[e(B,null,{default:l(()=>[e(ke,null,{default:l(()=>[(y(!0),z(le,null,ce(i.camp.ParticipantsFiles,V=>(y(),w(H,{title:V.Title},{append:l(()=>[g(U(V.UploadedCount)+" / "+U(V.InscritsCount)+" ("+U($(Ve).pourcent(V.UploadedCount,V.InscritsCount))+" %) ",1)]),_:2},1032,["title"]))),256))]),_:1})]),_:1})]),_:1})]),_:1})]),_:1}),e(k,{cols:"1"}),e(k,{cols:"auto","align-self":"center"},{default:l(()=>[e(Se,null,{activator:l(({props:V})=>[e(L,se(V,{size:"x-small",class:"mx-1",icon:"mdi-dots-vertical"}),null,16)]),default:l(()=>[e(ke,{density:"compact"},{default:l(()=>[e(H,{"prepend-icon":"mdi-pencil",onClick:d[0]||(d[0]=V=>v("edit"))},{default:l(()=>[...d[14]||(d[14]=[g("Modifier les paramètres",-1)])]),_:1}),e(H,{"prepend-icon":"mdi-currency-eur",onClick:d[1]||(d[1]=V=>v("edit-taux"))},{default:l(()=>[...d[15]||(d[15]=[g("Taux de conversion",-1)])]),_:1}),e(ue,{thickness:"1"}),e(H,{"prepend-icon":"mdi-mail",onClick:d[2]||(d[2]=V=>v("show-documents")),title:"Documents"}),e(ue,{thickness:"1"}),e(H,{"prepend-icon":"mdi-plus",onClick:d[3]||(d[3]=V=>n.value=!0),title:"Ajouter un directeur...",disabled:i.camp.HasDirecteur},null,8,["disabled"]),e(ue,{thickness:"1"}),e(H,{title:"Se connecter à l'espace directeur","prepend-icon":"mdi-open-in-new",href:i.camp.URLDirecteur,target:"_blank"},null,8,["href"]),e(ue,{thickness:"1"}),e(H,{title:"Envoyer le sondage",subtitle:"de fin de séjour","prepend-icon":"mdi-comment-quote",onClick:d[4]||(d[4]=V=>v("send-sondage"))}),e(ue,{thickness:"1"}),e(H,{"prepend-icon":"mdi-delete",disabled:i.camp.Stats.Inscriptions>0,onClick:d[5]||(d[5]=V=>s.value=!0)},{default:l(()=>[...d[16]||(d[16]=[g("Supprimer",-1)])]),_:1},8,["disabled"])]),_:1})]),_:1})]),_:1})]),_:1},8,["style"])]),_:1},8,["color"]),e(X,{modelValue:s.value,"onUpdate:modelValue":d[8]||(d[8]=V=>s.value=V),"max-width":"600"},{default:l(()=>[e(O,{title:"Confirmer la suppression"},{default:l(()=>[e(B,null,{default:l(()=>[d[17]||(d[17]=g(" Etes vous certain de supprimer le séjour ",-1)),R("b",null,U($(_e).label(i.camp.Camp.Camp)),1),d[18]||(d[18]=g(" ? ",-1)),d[19]||(d[19]=R("br",null,null,-1)),d[20]||(d[20]=R("br",null,null,-1)),d[21]||(d[21]=g(" Les éventuels ",-1)),d[22]||(d[22]=R("i",null,"équipiers",-1)),d[23]||(d[23]=g(" déclarés sur ce séjour seront aussi supprimés. ",-1)),d[24]||(d[24]=R("br",null,null,-1)),d[25]||(d[25]=R("br",null,null,-1)),d[26]||(d[26]=g(" Attention, cette opération est irréversible. ",-1))]),_:1}),e(oe,null,{default:l(()=>[e(ie),e(L,{color:"red",onClick:d[7]||(d[7]=V=>{s.value=!1,v("delete")})},{default:l(()=>[...d[27]||(d[27]=[g("Supprimer",-1)])]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"]),e(X,{modelValue:n.value,"onUpdate:modelValue":d[11]||(d[11]=V=>n.value=V),"max-width":"400px"},{default:l(()=>[e(O,{title:"Ajouter un directeur"},{default:l(()=>[e(B,null,{default:l(()=>[e(p,{"initial-personne":"",label:"Directeur",modelValue:c.value,"onUpdate:modelValue":d[9]||(d[9]=V=>c.value=V),api:$(x)},null,8,["modelValue","api"])]),_:1}),e(oe,null,{default:l(()=>[e(ie),e(L,{disabled:!c.value,onClick:d[10]||(d[10]=V=>{n.value=!1,v("add-directeur",c.value)})},{default:l(()=>[...d[28]||(d[28]=[g("Ajouter",-1)])]),_:1},8,["disabled"])]),_:1})]),_:1})]),_:1},8,["modelValue"])],64)}}}),yt=K({__name:"CampsSelector",props:De({allCamps:{}},{modelValue:{required:!0},modelModifiers:{}}),emits:["update:modelValue"],setup(t){const o=t,i=Pe(t,"modelValue"),v=h(()=>o.allCamps.map(a=>({title:a.Label,value:a.Id})));return(a,s)=>(y(),w(wa,{multiple:"",chips:"","closable-chips":"",items:v.value,modelValue:i.value,"onUpdate:modelValue":s[0]||(s[0]=m=>i.value=m)},null,8,["items","modelValue"]))}}),dn=K({__name:"DocumentsCard",props:{camp:{}},setup(t){const o=t;Te(v);const i=D(null);async function v(){const a=await x.CampsDocuments({idCamp:o.camp.Camp.Camp.Id});a!==void 0&&(i.value=a)}return(a,s)=>{const m=La;return i.value!=null?(y(),w(O,{key:0,title:"Documents"},{default:l(()=>[e(B,null,{default:l(()=>[e(ke,null,{default:l(()=>[e(Tl,null,{default:l(()=>[...s[0]||(s[0]=[g("Préférences d'affichage",-1)])]),_:1}),e(H,null,{default:l(()=>[e(E,{class:"mb-2"},{default:l(()=>[e(k,null,{default:l(()=>[e(ge,{color:i.value.ToShow.LettreDirecteur?"green":"grey","append-icon":i.value.ToShow.LettreDirecteur?"mdi-check":""},{default:l(()=>[...s[1]||(s[1]=[g("Lettre du directeur",-1)])]),_:1},8,["color","append-icon"])]),_:1}),e(k,null,{default:l(()=>[e(ge,{color:i.value.ToShow.ListeVetements?"green":"grey","append-icon":i.value.ToShow.ListeVetements?"mdi-check":""},{default:l(()=>[...s[2]||(s[2]=[g(" Liste de vêtements",-1)])]),_:1},8,["color","append-icon"])]),_:1}),e(k,null,{default:l(()=>[e(ge,{color:i.value.ToShow.ListeParticipants?"green":"grey","append-icon":i.value.ToShow.ListeParticipants?"mdi-check":""},{default:l(()=>[...s[3]||(s[3]=[g("Liste des participants ",-1)])]),_:1},8,["color","append-icon"])]),_:1})]),_:1})]),_:1}),e(Tl,null,{default:l(()=>[...s[4]||(s[4]=[g("Documents du séjour",-1)])]),_:1}),(y(!0),z(le,null,ce(i.value.Generated,n=>(y(),w(H,{title:n.NomClient},{append:l(()=>[e(m,{"file-key":n.Key,"is-generated-doc":!0},null,8,["file-key"])]),_:2},1032,["title"]))),256)),(y(!0),z(le,null,ce(i.value.ToRead,n=>(y(),w(H,{title:n.NomClient},{append:l(()=>[e(m,{"file-key":n.Key,"is-generated-doc":!1},null,8,["file-key"])]),_:2},1032,["title"]))),256)),(y(!0),z(le,null,ce(i.value.ToUploadModeles,n=>(y(),w(H,{title:n.NomClient,subtitle:"Document à remplir"},{append:l(()=>[e(m,{"file-key":n.Key,"is-generated-doc":!1},null,8,["file-key"])]),_:2},1032,["title"]))),256))]),_:1})]),_:1})]),_:1})):(y(),w(Ge,{key:1,type:"card"}))}}}),mn={key:0,class:"text-center my-4"},cn={key:1},vn=["href"],pn=K({__name:"AlbumsPhotosPannel",emits:["save"],setup(t,{emit:o}){Te(a);const i=D(null),v=D([]);async function a(){const p=await x.CampsLoadAlbums();p!==void 0&&(i.value=p,v.value=[])}function s(p){return(i.value?.Camps||[]).find(V=>V.Camp.Id==p)}const m=D(!1),n=h(()=>m.value||!v.value.length||!i.value?!1:v.value.every(p=>s(p).Album.Id==""));async function c(){m.value=!0;const p=await x.CampsCreateAlbums({IdCamps:v.value});m.value=!1,p!==void 0&&(Nt(p).forEach(([V,A])=>{s(V).Album=A}),x.showMessage("Albums photos créés avec succès."))}const u=h(()=>m.value||!v.value.length||!i.value?!1:v.value.every(p=>s(p).Album.Id!="")),r=D(!1);async function d(){r.value=!1,m.value=!0;for(const p of v.value)if(await x.CampsDeleteAlbum({idCamp:p})===void 0)break;m.value=!1,x.showMessage("Albums photos supprimés avec succès."),a()}return(p,V)=>(y(),w(O,{title:"Albums photos",subtitle:"Seuls les camps en cours sont affichés."},{append:l(()=>[e(L,{disabled:!n.value,onClick:c,class:"mx-2"},{prepend:l(()=>[e(xe,{color:"green"},{default:l(()=>[...V[3]||(V[3]=[g("mdi-plus",-1)])]),_:1})]),default:l(()=>[V[4]||(V[4]=g(" Créer",-1))]),_:1},8,["disabled"]),e(L,{disabled:!u.value,onClick:V[0]||(V[0]=A=>r.value=!0)},{prepend:l(()=>[e(xe,{color:"red"},{default:l(()=>[...V[5]||(V[5]=[g("mdi-delete",-1)])]),_:1})]),default:l(()=>[V[6]||(V[6]=g(" Supprimer",-1))]),_:1},8,["disabled"])]),default:l(()=>[m.value?(y(),w(bl,{key:0,indeterminate:""})):Q("",!0),e(B,null,{default:l(()=>[i.value==null?(y(),z("div",mn,[e(Et,{indeterminate:""})])):(y(),z("div",cn,[e(O,{variant:"outlined"},{default:l(()=>[e(B,null,{default:l(()=>[e(E,null,{default:l(()=>[e(k,null,{default:l(()=>[...V[7]||(V[7]=[g("Hébergement des photos",-1)])]),_:1}),e(k,{class:"text-right"},{default:l(()=>[R("a",{href:i.value.HostURL},U(i.value.HostURL),9,vn)]),_:1})]),_:1})]),_:1})]),_:1}),e(ke,{selected:v.value,"onUpdate:selected":V[1]||(V[1]=A=>v.value=A),"select-strategy":"leaf"},{default:l(()=>[(y(!0),z(le,null,ce(i.value.Camps,A=>(y(),w(H,{value:A.Camp.Id,title:$(_e).label(A.Camp),rounded:"",class:"my-1"},{append:l(()=>[e(ge,{color:A.Album.Id?"success":void 0},{default:l(()=>[A.Album.Id?(y(),w(He,{key:0,activator:"parent","content-class":"pa-0"},{default:l(()=>[e(O,{title:"Album photo","min-width":"400px"},{default:l(()=>[e(B,null,{default:l(()=>[e(E,null,{default:l(()=>[e(k,{cols:"auto"},{default:l(()=>[...V[8]||(V[8]=[g("Nom",-1)])]),_:1}),e(k,{class:"text-right"},{default:l(()=>[g(U(A.Album.albumName),1)]),_:2},1024)]),_:2},1024),e(E,null,{default:l(()=>[e(k,{cols:"auto"},{default:l(()=>[...V[9]||(V[9]=[g("ID",-1)])]),_:1}),e(k,{class:"text-right"},{default:l(()=>[g(U(A.Album.Id),1)]),_:2},1024)]),_:2},1024),e(E,null,{default:l(()=>[e(k,{cols:"auto"},{default:l(()=>[...V[10]||(V[10]=[g("Date de création",-1)])]),_:1}),e(k,{class:"text-right"},{default:l(()=>[g(U(new Date(A.Album.createdAt).toLocaleDateString("fr")),1)]),_:2},1024)]),_:2},1024),e(E,null,{default:l(()=>[e(k,{cols:"auto"},{default:l(()=>[...V[11]||(V[11]=[g("Nombre de photos",-1)])]),_:1}),e(k,{class:"text-right"},{default:l(()=>[g(U(A.Album.assetCount),1)]),_:2},1024)]),_:2},1024)]),_:2},1024)]),_:2},1024)]),_:2},1024)):Q("",!0),g(" "+U(A.Album.Id==""?"Pas d'album":`Album créé le ${$(Ve).date(A.Album.createdAt)}`),1)]),_:2},1032,["color"])]),_:2},1032,["value","title"]))),256))]),_:1},8,["selected"])]))]),_:1}),e(X,{modelValue:r.value,"onUpdate:modelValue":V[2]||(V[2]=A=>r.value=A),"max-width":"600px"},{default:l(()=>[e(O,{title:"Confirmer la suppression"},{default:l(()=>[e(B,null,{default:l(()=>[...V[12]||(V[12]=[g(" Confirmez-vous la suppression des albums sélectionnés ? ",-1),R("br",null,null,-1),R("br",null,null,-1),g(" Les liens de partage ne seront plus valides. ",-1),R("br",null,null,-1),g(" Les photos ou vidéos elles-mêmes ne seront pas supprimées. ",-1)])]),_:1}),e(oe,null,{default:l(()=>[e(ie),e(L,{color:"red",onClick:d},{default:l(()=>[...V[13]||(V[13]=[g("Supprimer",-1)])]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"])]),_:1}))}});function fn(){const t=D([]);Ot(()=>t.value=[]);function o(i,v){t.value[v]=i}return{refs:t,updateRef:o}}const yn=Fe({activeColor:String,start:{type:[Number,String],default:1},modelValue:{type:Number,default:t=>t.start},disabled:Boolean,length:{type:[Number,String],default:1,validator:t=>t%1===0},totalVisible:[Number,String],firstIcon:{type:Be,default:"$first"},prevIcon:{type:Be,default:"$prev"},nextIcon:{type:Be,default:"$next"},lastIcon:{type:Be,default:"$last"},ariaLabel:{type:String,default:"$vuetify.pagination.ariaLabel.root"},pageAriaLabel:{type:String,default:"$vuetify.pagination.ariaLabel.page"},currentPageAriaLabel:{type:String,default:"$vuetify.pagination.ariaLabel.currentPage"},firstAriaLabel:{type:String,default:"$vuetify.pagination.ariaLabel.first"},previousAriaLabel:{type:String,default:"$vuetify.pagination.ariaLabel.previous"},nextAriaLabel:{type:String,default:"$vuetify.pagination.ariaLabel.next"},lastAriaLabel:{type:String,default:"$vuetify.pagination.ariaLabel.last"},ellipsis:{type:String,default:"..."},showFirstLastPage:Boolean,...Xt(),...Kt(),...Gt(),...Jt(),...Wt(),...Qt(),...zt({tag:"nav"}),...Yt(),...Ht({variant:"text"})},"VPagination"),bn=he()({name:"VPagination",props:yn(),emits:{"update:modelValue":t=>!0,first:t=>!0,prev:t=>!0,next:t=>!0,last:t=>!0},setup(t,o){let{slots:i,emit:v}=o;const a=Ue(t,"modelValue"),{t:s,n:m}=Ke(),{isRtl:n}=Zl(),{themeClasses:c}=Bt(t),{width:u}=qt(),r=ll(-1);Il(void 0,{scoped:!0});const{resizeRef:d}=jt(W=>{if(!W.length)return;const{target:I,contentRect:te}=W[0],ne=I.querySelector(".v-pagination__list > *");if(!ne)return;const N=te.width,j=ne.offsetWidth+parseFloat(getComputedStyle(ne).marginRight)*2;r.value=C(N,j)}),p=h(()=>parseInt(t.length,10)),V=h(()=>parseInt(t.start,10)),A=h(()=>t.totalVisible!=null?parseInt(t.totalVisible,10):r.value>=0?r.value:C(u.value,58));function C(W,I){const te=t.showFirstLastPage?5:3;return Math.max(0,Math.floor(Number(((W-I*te)/I).toFixed(2))))}const _=h(()=>{if(p.value<=0||isNaN(p.value)||p.value>Number.MAX_SAFE_INTEGER)return[];if(A.value<=0)return[];if(A.value===1)return[a.value];if(p.value<=A.value)return Ee(p.value,V.value);const W=A.value%2===0,I=W?A.value/2:Math.floor(A.value/2),te=W?I:I+1,ne=p.value-I;if(te-a.value>=0)return[...Ee(Math.max(1,A.value-1),V.value),t.ellipsis,p.value];if(a.value-ne>=(W?1:0)){const N=A.value-1,j=p.value-N+V.value;return[V.value,t.ellipsis,...Ee(N,j)]}else{const N=Math.max(1,A.value-2),j=N===1?a.value:a.value-Math.ceil(N/2)+V.value;return[V.value,t.ellipsis,...Ee(N,j),t.ellipsis,p.value]}});function P(W,I,te){W.preventDefault(),a.value=I,te&&v(te,I)}const{refs:q,updateRef:G}=fn();Il({VPaginationBtn:{color:Le(()=>t.color),border:Le(()=>t.border),density:Le(()=>t.density),size:Le(()=>t.size),variant:Le(()=>t.variant),rounded:Le(()=>t.rounded),elevation:Le(()=>t.elevation)}});const S=h(()=>_.value.map((W,I)=>{const te=ne=>G(ne,I);if(typeof W=="string")return{isActive:!1,key:`ellipsis-${I}`,page:W,props:{ref:te,ellipsis:!0,icon:!0,disabled:!0}};{const ne=W===a.value;return{isActive:ne,key:W,page:m(W),props:{ref:te,ellipsis:!1,icon:!0,disabled:!!t.disabled||Number(t.length)<2,color:ne?t.activeColor:t.color,"aria-current":ne,"aria-label":s(ne?t.currentPageAriaLabel:t.pageAriaLabel,W),onClick:N=>P(N,W)}}}})),f=h(()=>{const W=!!t.disabled||a.value<=V.value,I=!!t.disabled||a.value>=V.value+p.value-1;return{first:t.showFirstLastPage?{icon:n.value?t.lastIcon:t.firstIcon,onClick:te=>P(te,V.value,"first"),disabled:W,"aria-label":s(t.firstAriaLabel),"aria-disabled":W}:void 0,prev:{icon:n.value?t.nextIcon:t.prevIcon,onClick:te=>P(te,a.value-1,"prev"),disabled:W,"aria-label":s(t.previousAriaLabel),"aria-disabled":W},next:{icon:n.value?t.prevIcon:t.nextIcon,onClick:te=>P(te,a.value+1,"next"),disabled:I,"aria-label":s(t.nextAriaLabel),"aria-disabled":I},last:t.showFirstLastPage?{icon:n.value?t.firstIcon:t.lastIcon,onClick:te=>P(te,V.value+p.value-1,"last"),disabled:I,"aria-label":s(t.lastAriaLabel),"aria-disabled":I}:void 0}});function ee(){const W=a.value-V.value;q.value[W]?.$el.focus()}function fe(W){W.key===Al.left&&!t.disabled&&a.value>Number(t.start)?(a.value=a.value-1,Ml(ee)):W.key===Al.right&&!t.disabled&&a.value<V.value+p.value-1&&(a.value=a.value+1,Ml(ee))}return Re(()=>e(t.tag,{ref:d,class:Ce(["v-pagination",c.value,t.class]),style:al(t.style),role:"navigation","aria-label":s(t.ariaLabel),onKeydown:fe,"data-test":"v-pagination-root"},{default:()=>[R("ul",{class:"v-pagination__list"},[t.showFirstLastPage&&R("li",{key:"first",class:"v-pagination__first","data-test":"v-pagination-first"},[i.first?i.first(f.value.first):e(L,se({_as:"VPaginationBtn"},f.value.first),null)]),R("li",{key:"prev",class:"v-pagination__prev","data-test":"v-pagination-prev"},[i.prev?i.prev(f.value.prev):e(L,se({_as:"VPaginationBtn"},f.value.prev),null)]),S.value.map((W,I)=>R("li",{key:W.key,class:Ce(["v-pagination__item",{"v-pagination__item--is-active":W.isActive}]),"data-test":"v-pagination-item"},[i.item?i.item(W):e(L,se({_as:"VPaginationBtn"},W.props),{default:()=>[W.page]})])),R("li",{key:"next",class:"v-pagination__next","data-test":"v-pagination-next"},[i.next?i.next(f.value.next):e(L,se({_as:"VPaginationBtn"},f.value.next),null)]),t.showFirstLastPage&&R("li",{key:"last",class:"v-pagination__last","data-test":"v-pagination-last"},[i.last?i.last(f.value.last):e(L,se({_as:"VPaginationBtn"},f.value.last),null)])])]})),{}}}),gn={key:2},yl=16,Vn=K({__name:"CampsList",emits:["show-participants"],setup(t,{emit:o}){const i=o;Te(r);const v=gl(new Map),a=D(!1),s=gl({pattern:"",openOnly:!1}),m=h(()=>{const J=new Set,b=new Set;for(const M of v.values())for(const F of Object.entries(M.Camp.Camp.Meta||{}))J.add(F[0]),b.add(F[1]);return{keys:Array.from(J.keys()).sort(),values:Array.from(b.keys()).sort()}}),n=h(()=>{const J=tt(s.pattern),b=Array.from(v.values()).filter(M=>_e.match(M.Camp.Camp,J)&&(!s.openOnly||Rl(M.Camp)));return b.sort((M,F)=>{const pe=new Date(F.Camp.Camp.DateDebut).valueOf(),ae=new Date(M.Camp.Camp.DateDebut).valueOf();return pe==ae?M.Camp.Camp.Id-F.Camp.Camp.Id:pe-ae}),b}),c=h(()=>n.value.slice((V.value-1)*yl,V.value*yl));function u(){V.value>p.value&&(V.value=p.value)}async function r(){a.value=!0;const J=await x.CampsGet();a.value=!1,J!==void 0&&(v.clear(),J?.forEach(b=>v.set(b.Camp.Camp.Id,b)))}async function d(){a.value=!0;const J=await x.CampsCreate();a.value=!1,J!==void 0&&(x.showMessage("Camp ajouté avec succès."),v.set(J.Camp.Camp.Id,J),A.value=J)}const p=h(()=>Math.max(Math.ceil(n.value.length/yl),1)),V=D(1),A=D(null);async function C(J){A.value=null,a.value=!0;const b=await x.CampsUpdate(J);a.value=!1,b!==void 0&&(x.showMessage("Séjour modifié avec succès."),v.get(b.Camp.Id).Camp=b,u())}const _=D(null);async function P(){const J=_.value;if(J==null)return;_.value=null,a.value=!0;const b=await x.CampsSetTaux({IdCamp:J.Camp.Camp.Id,Taux:J.Taux});if(a.value=!1,b===void 0)return;x.showMessage("Taux modifié avec succès.");const M=v.get(J.Camp.Camp.Id);M.Camp.Camp.IdTaux=b.Id,M.Taux=b}const q=D(!1),G=D(5),S=D({Id:1,Label:"",Euros:0,FrancsSuisse:0}),f=h(()=>S.value.Id>0||S.value.Label!=""),ee=h(()=>new Set(Array.from(v.values()).filter(b=>Rl(b.Camp)).map(b=>b.Camp.Camp.IdTaux)).size<=1);async function fe(){q.value=!1,a.value=!0;const J=await x.CampsCreateMany({Count:G.value,Taux:S.value});a.value=!1,J!==void 0&&(x.showMessage("Séjours créés avec succès."),J?.forEach(b=>v.set(b.Camp.Camp.Id,b)))}async function W(J){a.value=!0;const b=await x.CampsDelete({id:J.Camp.Camp.Id});a.value=!1,b!==void 0&&(x.showMessage("Séjour supprimé avec succès."),v.delete(J.Camp.Camp.Id),u())}const I=D(!1);function te(){ne.value=Array.from(v.values()).filter(J=>J.Camp.Camp.Statut!=ea.Ouvert).map(J=>J.Camp.Camp.Id),I.value=!0}const ne=D([]);async function N(){I.value=!1,!(!ne.value.length||await x.CampsOuvreInscriptions({Camps:ne.value})===void 0)&&(x.showMessage("Séjours ouverts aux inscriptions avec succès."),r())}const j=D(null),re=D(null);async function Z(J){re.value={Current:0,Total:10};const b=await x.EventsSendSondages({idCamp:J});if(b===void 0){re.value=null;return}await Vl(b,M=>re.value=M,M=>x.onError("Envoi du sondage",M)),re.value=null,x.showMessage("Sondage envoyé avec succès.")}async function ye(J,b){await x.CampsCreateEquipier({IdPersonne:J,IdCamp:b,Roles:[la.Direction]})!==void 0&&(v.get(b).HasDirecteur=!0,x.showMessage("Directeur ajouté avec succès."))}const be=D(!1);return(J,b)=>{const M=Xe;return y(),z(le,null,[e(O,{title:"Séjours",subtitle:v.size},{append:l(()=>[e(E,null,{default:l(()=>[e(k,{"align-self":"center",style:{width:"240px"}},{default:l(()=>[e(me,{label:"Rechercher",variant:"filled",density:"comfortable","hide-details":"","prepend-inner-icon":"mdi-magnify",clearable:"",modelValue:s.pattern,"onUpdate:modelValue":[b[0]||(b[0]=F=>s.pattern=F),b[2]||(b[2]=F=>u())],"onClick:clear":b[1]||(b[1]=F=>{s.pattern="",u()})},null,8,["modelValue"])]),_:1}),e(ue,{vertical:"",thickness:"1"}),e(k,{"align-self":"center",cols:"auto"},{default:l(()=>[e(Se,null,{activator:l(({props:F})=>[e(L,se(F,{color:"success",disabled:a.value,"prepend-icon":"mdi-plus"}),{default:l(()=>[...b[18]||(b[18]=[g(" Créer un séjour ",-1)])]),_:1},16,["disabled"])]),default:l(()=>[e(ke,{density:"compact"},{default:l(()=>[e(H,{onClick:d,title:"Créer un séjour"}),e(H,{title:"Créer plusieurs séjours...",subtitle:"Permet de choisir les taux de conversion",onClick:b[3]||(b[3]=F=>q.value=!0)})]),_:1})]),_:1})]),_:1}),e(k,{"align-self":"center",cols:"auto"},{default:l(()=>[e(L,{flat:"",icon:"",size:"small"},{default:l(()=>[e(xe,{icon:"mdi-dots-vertical"}),e(Se,{activator:"parent"},{default:l(()=>[e(ke,{density:"compact"},{default:l(()=>[e(H,{title:"Masquer les camps fermés",subtitle:"N'afficher que les camps ouverts aux inscriptions",onClick:b[5]||(b[5]=F=>s.openOnly=!s.openOnly)},{prepend:l(()=>[e(ze,{class:"mr-2",modelValue:s.openOnly,"onUpdate:modelValue":b[4]||(b[4]=F=>s.openOnly=F),density:"compact","hide-details":""},null,8,["modelValue"])]),_:1}),e(ue,{thickness:"1"}),e(H,{onClick:b[6]||(b[6]=F=>be.value=!0),title:"Configurer les albums photos...","prepend-icon":"mdi-image-album"}),e(ue,{thickness:"1"}),e(H,{onClick:te,title:"Ouvrir les inscriptions...",subtitle:"sur plusieurs séjours","prepend-icon":"mdi-lock-open"}),e(ue,{thickness:"1"}),e(H,{"prepend-icon":"mdi-file-excel",title:"Exporter",subtitle:"Participants de l'année courante (format Excel)",link:"",href:$(x).CampsDownloadParticipants(new Date().getFullYear(),$(x).authToken)},null,8,["href"])]),_:1})]),_:1})]),_:1})]),_:1})]),_:1})]),default:l(()=>[e(B,{class:"mt-4"},{default:l(()=>[ee.value?Q("",!0):(y(),w(Zt,{key:0,type:"warning"},{default:l(()=>[...b[19]||(b[19]=[g(" Attention, les séjours ouverts aux inscriptions ont des taux de conversion incompatibles ! ",-1)])]),_:1})),a.value?(y(),w(Ge,{key:1})):n.value.length==0?(y(),z("i",gn," Aucun camp ne correspond aux filtres actuels. ")):Q("",!0),(y(!0),z(le,null,ce(c.value,(F,pe)=>(y(),w(rn,{key:pe,camp:F,onClick:ae=>i("show-participants",F),onEdit:ae=>A.value=F,onEditTaux:ae=>_.value=F,onDelete:ae=>W(F),onShowDocuments:ae=>j.value=F,onSendSondage:ae=>Z(F.Camp.Camp.Id),onAddDirecteur:ae=>ye(ae,F.Camp.Camp.Id)},null,8,["camp","onClick","onEdit","onEditTaux","onDelete","onShowDocuments","onSendSondage","onAddDirecteur"]))),128)),e(bn,{length:p.value,modelValue:V.value,"onUpdate:modelValue":b[7]||(b[7]=F=>V.value=F)},null,8,["length","modelValue"])]),_:1})]),_:1},8,["subtitle"]),e(X,{"model-value":A.value!=null,"onUpdate:modelValue":b[8]||(b[8]=F=>A.value=null),"max-width":"800px"},{default:l(()=>[A.value!=null?(y(),w(un,{key:0,camp:A.value.Camp.Camp,"preselection-url":A.value.URLPreselection,"meta-entries-hints":m.value,onSave:C},null,8,["camp","preselection-url","meta-entries-hints"])):Q("",!0)]),_:1},8,["model-value"]),e(X,{"model-value":_.value!=null,"onUpdate:modelValue":b[10]||(b[10]=F=>_.value=null),"max-width":"600"},{default:l(()=>[_.value!=null?(y(),w(O,{key:0,title:"Modifier le taux",subtitle:"La modification n'est possible que si aucun participant n'est enregistré."},{default:l(()=>[e(B,null,{default:l(()=>[e(zl,{modelValue:_.value.Taux,"onUpdate:modelValue":b[9]||(b[9]=F=>_.value.Taux=F)},null,8,["modelValue"])]),_:1}),e(oe,null,{default:l(()=>[e(ie),e(L,{disabled:_.value.Stats.Inscriptions>0,onClick:P},{default:l(()=>[...b[20]||(b[20]=[g("Modifier",-1)])]),_:1},8,["disabled"])]),_:1})]),_:1})):Q("",!0)]),_:1},8,["model-value"]),e(X,{modelValue:q.value,"onUpdate:modelValue":b[13]||(b[13]=F=>q.value=F),"max-width":"600"},{default:l(()=>[e(O,{title:"Créer plusieurs séjours",subtitle:"Les séjours seront liés au même taux de conversion"},{default:l(()=>[e(B,null,{default:l(()=>[e(E,null,{default:l(()=>[e(k,null,{default:l(()=>[e(M,{label:"Nombre de séjours",modelValue:G.value,"onUpdate:modelValue":b[11]||(b[11]=F=>G.value=F)},null,8,["modelValue"])]),_:1})]),_:1}),e(ue,{thickness:"2",class:"my-2"}),e(zl,{modelValue:S.value,"onUpdate:modelValue":b[12]||(b[12]=F=>S.value=F)},null,8,["modelValue"])]),_:1}),e(oe,null,{default:l(()=>[e(ie),e(L,{color:"success",onClick:fe,disabled:!f.value},{default:l(()=>[...b[21]||(b[21]=[g("Créer",-1)])]),_:1},8,["disabled"])]),_:1})]),_:1})]),_:1},8,["modelValue"]),e(X,{modelValue:I.value,"onUpdate:modelValue":b[15]||(b[15]=F=>I.value=F),"max-width":"600"},{default:l(()=>[e(O,{title:"Ouvrir les inscriptions",subtitle:"Ouvre les inscriptions sur les séjours ci-dessous"},{default:l(()=>[e(B,null,{default:l(()=>[e(yt,{"all-camps":Array.from(v.values()).map(F=>$(_e).toItem(F.Camp)),modelValue:ne.value,"onUpdate:modelValue":b[14]||(b[14]=F=>ne.value=F)},null,8,["all-camps","modelValue"])]),_:1}),e(oe,null,{default:l(()=>[e(ie),e(L,{onClick:N,disabled:!ne.value.length},{default:l(()=>[...b[22]||(b[22]=[g("Ouvrir",-1)])]),_:1},8,["disabled"])]),_:1})]),_:1})]),_:1},8,["modelValue"]),e(X,{"model-value":j.value!=null,"onUpdate:modelValue":b[16]||(b[16]=F=>j.value=null),"max-width":"800px"},{default:l(()=>[j.value?(y(),w(dn,{key:0,camp:j.value},null,8,["camp"])):Q("",!0)]),_:1},8,["model-value"]),e(X,{"model-value":re.value!=null,"max-width":"400px",persistent:""},{default:l(()=>[re.value?(y(),w(Cl,{key:0,title:"Envoi du sondage en cours",current:re.value.Current,total:re.value.Total},null,8,["current","total"])):Q("",!0)]),_:1},8,["model-value"]),e(X,{modelValue:be.value,"onUpdate:modelValue":b[17]||(b[17]=F=>be.value=F),"max-width":"800px"},{default:l(()=>[e(pn)]),_:1},8,["modelValue"])],64)}}}),kn={key:1},Cn={key:0,class:"text-center font-italic"},_n=K({__name:"CampParticipants",props:{id:{},idParticipant:{}},setup(t){const o=t;Te(async()=>{a(),await n(),c()}),Ae(()=>o.id,n),Ae(()=>o.idParticipant,c);const i=D(!1),v=D([]);async function a(){const S=await x.GetCamps();S!==void 0&&(v.value=S||[])}const s=h(()=>{const S=(m.value?.Participants||[]).map(f=>f);return S.sort(ta.cmp),S}),m=D(null);async function n(){i.value=!0;const S=await x.CampsLoad({idCamp:o.id});i.value=!1,S!==void 0&&(m.value=S)}function c(){if(o.idParticipant===void 0)return;const S=(m.value?.Participants||[]).find(f=>f.Participant.Id==o.idParticipant);S&&(d.value=we(S))}const u=D(null);async function r(){if(u.value==null||m.value==null)return;const S=await x.ParticipantsCreate(u.value);u.value=null,S!==void 0&&(x.showMessage("Participant créé avec succès."),m.value.Participants=(m.value.Participants||[]).concat(S),d.value=we(S))}const d=D(null);async function p(S){if(d.value==null||m.value==null)return;const f=await x.ParticipantsUpdate(S);d.value=null,f!==void 0&&(x.showMessage("Participant modifié avec succès."),n())}const V=D(null);async function A(){if(V.value==null||m.value==null)return;const S=V.value.Participant.Id,f=await x.ParticipantsDelete({id:S});V.value=null,f!==void 0&&(x.showMessage("Participant supprimé avec succès."),m.value.Participants=(m.value.Participants||[]).filter(ee=>ee.Participant.Id!=S))}const C=D(null);async function _(){const S=C.value;S==null||m.value==null||(C.value=null,await x.ParticipantsMove(S)===void 0)||(x.showMessage("Participant déplacé avec succès.",void 0,{title:"Aller au nouveau séjour",action:()=>Dl({IdCamp:S.Target,Id:S.Id})}),m.value.Participants=(m.value.Participants||[]).filter(ee=>ee.Participant.Id!=S.Id))}const P=D(null);async function q(){if(P.value==null)return;const S=P.value.Participant.Id;P.value=null;const f=await x.ParticipantsSetPlaceLiberee({id:S});if(f===void 0||(x.showMessage("Notification de place libérée envoyée avec succès."),m.value==null))return;const ee=m.value.Participants?.find(fe=>fe.Participant.Id==S);ee.Participant=f}const G=D(!1);return(S,f)=>{const ee=Da,fe=Aa,W=il,I=nt,te=Sa,ne=sl,N=Ia;return m.value!=null?(y(),w(O,{key:0,title:"Participants",subtitle:$(_e).label(m.value.Camp.Camp)},{append:l(()=>[e(L,{color:"green",onClick:f[0]||(f[0]=j=>u.value={IdCamp:o.id,IdDossier:0,IdPersonne:0}),"prepend-icon":"mdi-plus"},{default:l(()=>[...f[11]||(f[11]=[g(" Ajouter un participant",-1)])]),_:1}),e(ue,{thickness:"1",class:"mx-1"}),e(L,{icon:"",size:"small",flat:""},{default:l(()=>[e(xe,null,{default:l(()=>[...f[12]||(f[12]=[g("mdi-dots-vertical",-1)])]),_:1}),e(Se,{activator:"parent"},{default:l(()=>[e(ke,null,{default:l(()=>[e(H,{"prepend-icon":"mdi-currency-eur",title:"Suivi du règlement",onClick:f[1]||(f[1]=j=>G.value=!0)})]),_:1})]),_:1})]),_:1})]),default:l(()=>[e(B,{class:"mt-4"},{default:l(()=>[i.value?(y(),w(Ge,{key:0,type:"table"})):(y(),z("div",kn,[e(ee),s.value.length?Q("",!0):(y(),z("div",Cn," Aucun participant n'est encore inscrit sur ce séjour. ")),(y(!0),z(le,null,ce(s.value,(j,re)=>(y(),w(fe,{participant:j,index:re},{actions:l(()=>[e(ke,{density:"comfortable"},{default:l(()=>[e(H,{title:"Modifier","prepend-icon":"mdi-pencil",onClick:Z=>d.value=j},null,8,["onClick"]),e(ue),e(H,{title:"Changer de camp...","prepend-icon":"mdi-file-move",onClick:Z=>C.value={Id:j.Participant.Id,Target:0}},null,8,["onClick"]),e(H,{title:"Notifier d'une place disponible.",subtitle:"Envoi un email","prepend-icon":"mdi-email-alert",disabled:j.Participant.Statut==$(tl).Inscrit||j.Participant.Statut==$(tl).EnAttenteReponse,onClick:Z=>P.value=j},null,8,["disabled","onClick"]),e(ue),e(H,{title:"Aller à la personne",subtitle:`(ID : ${j.Personne.Id})`,onClick:Z=>$(We)(j.Personne.Id)},null,8,["subtitle","onClick"]),e(H,{title:"Aller au dossier",subtitle:`(ID : ${j.Participant.IdDossier})`,onClick:Z=>$(_l)(j.Participant.IdDossier)},null,8,["subtitle","onClick"]),e(ue),e(H,{title:"Supprimer","prepend-icon":"mdi-delete",onClick:Z=>V.value=j},null,8,["onClick"])]),_:2},1024)]),_:2},1032,["participant","index"]))),256))]))]),_:1}),u.value!=null?(y(),w(X,{key:0,"model-value":u.value!=null,"onUpdate:modelValue":f[4]||(f[4]=j=>u.value=null),"max-width":"600px"},{default:l(()=>[e(O,{title:"Créer un participant"},{default:l(()=>[e(B,null,{default:l(()=>[e(E,null,{default:l(()=>[e(k,{cols:"12"},{default:l(()=>[e(W,{label:"Participant",modelValue:u.value.IdPersonne,"onUpdate:modelValue":f[2]||(f[2]=j=>u.value.IdPersonne=j),"initial-personne":"",api:{SelectPersonne:$(x).SelectPersonne.bind($(x))}},null,8,["modelValue","api"])]),_:1}),e(k,{cols:"12"},{default:l(()=>[e(I,{modelValue:u.value.IdDossier,"onUpdate:modelValue":f[3]||(f[3]=j=>u.value.IdDossier=j)},null,8,["modelValue"])]),_:1})]),_:1})]),_:1}),e(oe,null,{default:l(()=>[e(ie),e(L,{color:"green",onClick:r,disabled:!(u.value.IdDossier&&u.value.IdPersonne)},{default:l(()=>[...f[13]||(f[13]=[g("Créer",-1)])]),_:1},8,["disabled"])]),_:1})]),_:1})]),_:1},8,["model-value"])):Q("",!0),d.value!=null?(y(),w(X,{key:1,"model-value":d.value!=null,"onUpdate:modelValue":f[5]||(f[5]=j=>d.value=null),"max-width":"800px"},{default:l(()=>[e(te,{participant:d.value.Participant,personne:d.value.Personne,api:{SelectPersonne:$(x).SelectPersonne.bind($(x))},onSave:p},null,8,["participant","personne","api"])]),_:1},8,["model-value"])):Q("",!0),V.value!=null?(y(),w(X,{key:2,"model-value":V.value!=null,"onUpdate:modelValue":f[6]||(f[6]=j=>V.value=null),"max-width":"600px"},{default:l(()=>[e(O,{title:"Supprimer le participant"},{default:l(()=>[e(B,null,{default:l(()=>[f[14]||(f[14]=g(" Confirmez-vous la suppression du participant ",-1)),R("b",null,U($(Ne).label(V.value.Personne)),1),f[15]||(f[15]=g(" ? ",-1)),f[16]||(f[16]=R("br",null,null,-1)),f[17]||(f[17]=R("br",null,null,-1)),f[18]||(f[18]=g(" Attention, cette opération est irréversible. ",-1))]),_:1}),e(oe,null,{default:l(()=>[e(ie),e(L,{color:"red",onClick:A},{default:l(()=>[...f[19]||(f[19]=[g("Supprimer",-1)])]),_:1})]),_:1})]),_:1})]),_:1},8,["model-value"])):Q("",!0),C.value!=null?(y(),w(X,{key:3,"model-value":C.value!=null,"onUpdate:modelValue":f[8]||(f[8]=j=>C.value=null),"max-width":"500px"},{default:l(()=>[e(O,{title:"Déplacer le participant"},{default:l(()=>[e(B,null,{default:l(()=>[e(ne,{label:"Nouveau séjour",camps:v.value,modelValue:C.value.Target,"onUpdate:modelValue":f[7]||(f[7]=j=>C.value.Target=j)},null,8,["camps","modelValue"])]),_:1}),e(oe,null,{default:l(()=>[e(ie),e(L,{onClick:_,disabled:C.value.Target==o.id||!C.value.Target},{default:l(()=>[...f[20]||(f[20]=[g("Déplacer",-1)])]),_:1},8,["disabled"])]),_:1})]),_:1})]),_:1},8,["model-value"])):Q("",!0),P.value!=null?(y(),w(X,{key:4,"model-value":P.value!=null,"onUpdate:modelValue":f[9]||(f[9]=j=>P.value=null),"max-width":"500px"},{default:l(()=>[e(O,{title:"Notifier d'une place disponible"},{default:l(()=>[e(B,null,{default:l(()=>[g(" Confirmez-vous l'envoi d'une notification au responsable de "+U($(Ne).label(P.value.Personne))+" indiquant qu'une place est disponible ? ",1),f[21]||(f[21]=R("br",null,null,-1)),f[22]||(f[22]=R("br",null,null,-1)),g(" Le nouveau statut de "+U(P.value.Personne.Prenom)+" sera : ",1),R("i",null,U($(aa)[$(tl).EnAttenteReponse]),1),f[23]||(f[23]=g(". ",-1))]),_:1}),e(oe,null,{default:l(()=>[e(ie),e(L,{onClick:q},{default:l(()=>[...f[24]||(f[24]=[g("Notifier",-1)])]),_:1})]),_:1})]),_:1})]),_:1},8,["model-value"])):Q("",!0),e(X,{modelValue:G.value,"onUpdate:modelValue":f[10]||(f[10]=j=>G.value=j),"max-width":"700px"},{default:l(()=>[e(N,{data:m.value},null,8,["data"])]),_:1},8,["modelValue"])]),_:1},8,["subtitle"])):(y(),w(Ge,{key:1,type:"card"}))}}}),xn=K({__name:"camps",setup(t){const o=ul(),i=h(()=>Cu(o.currentRoute.value.query)),v=h(()=>i.value.idCamp);function a(m){const n=o.currentRoute.value;o.push({path:n.path,query:{idCamp:m.Camp.Camp.Id}})}function s(){const m=o.currentRoute.value;o.push({path:m.path,query:{}})}return(m,n)=>(y(),z(le,null,[e(fl,{title:"Gestion des séjours"},{default:l(()=>[v.value!==null?(y(),w(L,{key:0,onClick:s,"prepend-icon":"mdi-view-list"},{default:l(()=>[...n[0]||(n[0]=[g(" Retour à la liste",-1)])]),_:1})):Q("",!0)]),_:1}),v.value===void 0?(y(),w(Vn,{key:0,onShowParticipants:a})):(y(),w(_n,{key:1,id:v.value,"id-participant":i.value.idParticipant},null,8,["id","id-participant"]))],64))}}),bt=K({__name:"MergeCard",props:{from:{}},emits:["merge"],setup(t,{emit:o}){const i=t,v=o,a=D(0),s=D(!0);return(m,n)=>{const c=nt;return y(),w(O,{title:"Fusionner le dossier vers",subtitle:"Les participants, paiements et messages seront copiés vers le dossier cible."},{default:l(()=>[e(B,null,{default:l(()=>[e(E,null,{default:l(()=>[e(k,{cols:"12"},{default:l(()=>[e(c,{modelValue:a.value,"onUpdate:modelValue":n[0]||(n[0]=u=>a.value=u)},null,8,["modelValue"])]),_:1}),e(k,{cols:"12"},{default:l(()=>[e(ze,{density:"compact",label:"Notifier par email",hint:"Le reponsable du dossier absorbé sera averti du changement d'espace personnel.","persistent-hint":"",modelValue:s.value,"onUpdate:modelValue":n[1]||(n[1]=u=>s.value=u)},null,8,["modelValue"])]),_:1})]),_:1})]),_:1}),e(oe,null,{default:l(()=>[e(ie),e(L,{disabled:a.value==0||a.value==i.from,onClick:n[2]||(n[2]=u=>v("merge",{From:i.from,To:a.value,Notifie:s.value}))},{default:l(()=>[...n[3]||(n[3]=[g("Fusionner",-1)])]),_:1},8,["disabled"])]),_:1})]),_:1})}}}),Pn={key:1,class:"text-center font-italic"},wn={key:2},Dn=K({__name:"PannelInscriptions",emits:["goTo","empty"],setup(t,{emit:o}){const i=o,v=D(!1);Te(async()=>{await s(),a.value.length||i("empty")});const a=D([]);async function s(){v.value=!0;const C=await x.InscriptionsGet();v.value=!1,C!==void 0&&(a.value=C||[])}const m=D(""),n=h(()=>{const C=tt(m.value);return a.value.filter(_=>Ne.match(_.Responsable,C)||_.Participants?.some(P=>Ne.match(P.Personne,C)||_e.match(P.Camp,C)))});async function c(C,_){const P=await x.InscriptionsIdentifiePersonne({IdDossier:C,Target:_});if(P===void 0)return;x.showMessage("Profil identifié avec succès.");const q=a.value.findIndex(G=>G.Dossier.Id==C);a.value[q]=P}const u=D(null);async function r(C,_){if(!u.value)return;const P=u.value.inscription.Dossier.Id;u.value=null;const q=await x.InscriptionsValide({IdDossier:P,Statuts:C,SendMail:_});if(q!==void 0)if(q.Dossier.IsValidated)x.showMessage("Inscription validée avec succès.","",{title:"Aller au dossier",action:()=>i("goTo",P)}),a.value=a.value.filter(G=>G.Dossier.Id!=P);else{x.showMessage("Participant validé avec succès.");const G=a.value.findIndex(S=>S.Dossier.Id==P);a.value[G]=q}}async function d(C){await x.DossiersDelete({id:C.Dossier.Id})!==void 0&&(x.showMessage("Inscription supprimée avec succès."),a.value=a.value.filter(P=>P.Dossier.Id!=C.Dossier.Id))}async function p(C,_){if(await x.ParticipantsDelete({id:_})===void 0)return;x.showMessage("Participant supprimé avec succès.");const q=a.value.find(G=>G.Dossier.Id==C);q.Participants=(q.Participants||[]).filter(G=>G.Participant.Id!=_)}const V=D(null);async function A(C){V.value=null,await x.DossiersMerge(C)!==void 0&&(x.showMessage("Inscriptions fusionnées avec succès."),s())}return(C,_)=>{const P=$a;return y(),w(O,{title:"Inscriptions",subtitle:"En attente de validation",class:"ma-2"},{append:l(()=>[e(me,{width:"300","append-inner-icon":"mdi-magnify",label:"Rechercher","hide-details":"",modelValue:m.value,"onUpdate:modelValue":_[0]||(_[0]=q=>m.value=q)},null,8,["modelValue"])]),default:l(()=>[e(B,null,{default:l(()=>[v.value?(y(),w(Ge,{key:0})):a.value.length?(y(),z("div",wn,[(y(!0),z(le,null,ce(n.value,(q,G)=>(y(),w(Ma,{class:"my-1",user:null,key:G,inscription:q,onIdentifie:S=>c(q.Dossier.Id,S),onValide:S=>u.value={inscription:q,participants:S===void 0?void 0:[S]},onMerge:S=>V.value=q.Dossier.Id,onDelete:S=>d(q),onDeleteParticipant:S=>p(q.Dossier.Id,S),api:{SearchSimilaires:$(x).InscriptionsSearchSimilaires.bind($(x)),SelectPersonne:$(x).SelectPersonne.bind($(x))}},null,8,["inscription","onIdentifie","onValide","onMerge","onDelete","onDeleteParticipant","api"]))),128))])):(y(),z("div",Pn," Il n'y a aucune inscription à valider. "))]),_:1}),e(X,{"model-value":V.value!=null,"onUpdate:modelValue":_[1]||(_[1]=q=>V.value=null),"max-width":"600px"},{default:l(()=>[V.value!=null?(y(),w(bt,{key:0,from:V.value,onMerge:A},null,8,["from"])):Q("",!0)]),_:1},8,["model-value"]),e(X,{"model-value":u.value!=null,"onUpdate:modelValue":_[2]||(_[2]=q=>u.value=null),"max-width":"800px"},{default:l(()=>[u.value?(y(),w(P,{key:0,inscription:u.value.inscription,"id-participants":u.value.participants,onValide:r},null,8,["inscription","id-participants"])):Q("",!0)]),_:1},8,["model-value"])]),_:1})}}}),Sn={class:"text-grey"},In={class:"text-grey"},An={key:0},Mn=K({__name:"FactureCard",props:{dossier:{}},setup(t){const o=t,i=h(()=>(o.dossier.Participants||[]).filter(n=>n.Participant.Statut!=tl.Inscrit).map(n=>Ne.label(n.Personne))),v=h(()=>(o.dossier.Participants||[]).filter(n=>n.Participant.Statut==tl.Inscrit).map(n=>({Label:Ne.label(n.Personne),Camp:_e.label(n.Camp),Prix:Ve.montant(n.Camp.Prix),Bilan:o.dossier.Bilan.Inscrits[n.Participant.Id]})));function a(n){return!!(n.Remises.Famille||n.Remises.Equipiers||n.Remises.Speciale.Cent)}function s(n){const c=[];return n.Famille&&c.push(`Enfants : ${n.Famille}%`),n.Equipiers&&c.push(`Enfants : ${n.Equipiers}%`),n.Speciale.Cent&&c.push(`Remise : ${Ve.montant(n.Speciale)}`),c.join("  ;  ")}const m=h(()=>{const n=Object.values(o.dossier.Paiements||{});return n.sort((c,u)=>new Date(c.Time).valueOf()-new Date(u.Time).valueOf()),n});return(n,c)=>(y(),w(O,{title:"Suivi financier",subtitle:i.value.length?`Les participants en liste d'attente (${i.value.join(", ")}) ne sont pas pris en compte.`:"","min-width":"900px"},{default:l(()=>[e(B,null,{default:l(()=>[e(E,null,{default:l(()=>[e(k,{cols:"3"},{default:l(()=>[...c[0]||(c[0]=[g("Participant",-1)])]),_:1}),e(k,{cols:"2",class:"text-center"},{default:l(()=>[...c[1]||(c[1]=[g("Prix du séjour",-1)])]),_:1}),e(k,{cols:"2",class:"text-center"},{default:l(()=>[...c[2]||(c[2]=[g("Prix avec option",-1)])]),_:1}),e(k,{cols:"3",class:"text-center"},{default:l(()=>[...c[3]||(c[3]=[g("Aides extérieures",-1)])]),_:1}),e(k,{cols:"2",class:"text-right"},{default:l(()=>[...c[4]||(c[4]=[g("Sous-total",-1)])]),_:1})]),_:1}),e(ue,{thickness:"1",class:"my-2"}),(y(!0),z(le,null,ce(v.value,u=>(y(),z(le,null,[e(E,null,{default:l(()=>[e(k,{"align-self":"center",cols:"3"},{default:l(()=>[g(U(u.Label)+" ",1),c[5]||(c[5]=R("br",null,null,-1)),R("span",Sn,U(u.Camp),1)]),_:2},1024),e(k,{"align-self":"center",cols:"2",class:"text-center"},{default:l(()=>[g(U(u.Prix),1)]),_:2},1024),e(k,{"align-self":"center",cols:"2",class:"text-center"},{default:l(()=>[g(U($(Ve).montant(u.Bilan.AvecOption))+" ",1),c[6]||(c[6]=R("br",null,null,-1)),R("span",In,U(u.Bilan.AvecOptionDescription),1)]),_:2},1024),e(k,{"align-self":"center",cols:"3",class:"text-center"},{default:l(()=>[u.Bilan.Aides?.length?Q("",!0):(y(),z("span",An,"-")),(y(!0),z(le,null,ce(u.Bilan.Aides,r=>(y(),w(ge,null,{default:l(()=>[g(U(r.Structure)+" : "+U($(Ve).montant(r.Montant)),1)]),_:2},1024))),256))]),_:2},1024),e(k,{"align-self":"center",cols:"2",class:"text-right"},{default:l(()=>[g(U(u.Bilan.AvecAides),1)]),_:2},1024)]),_:2},1024),a(u.Bilan)?(y(),w(E,{key:0,"no-gutters":""},{default:l(()=>[e(k,{cols:"10",class:"text-right"},{default:l(()=>[R("i",null,U(s(u.Bilan.Remises)),1)]),_:2},1024),e(k,{cols:"2",class:"text-right"},{default:l(()=>[g(U(u.Bilan.Net),1)]),_:2},1024)]),_:2},1024)):Q("",!0)],64))),256)),e(ue,{thickness:"1",class:"my-2"}),e(E,null,{default:l(()=>[e(k,{cols:"10",class:"text-right"},{default:l(()=>[...c[7]||(c[7]=[g("Total demandé",-1)])]),_:1}),e(k,{cols:"2",class:"text-right"},{default:l(()=>[g(U(o.dossier.Bilan.Demande),1)]),_:1})]),_:1}),e(ue,{thickness:"1",class:"my-2"}),(y(!0),z(le,null,ce(m.value,u=>(y(),w(E,null,{default:l(()=>[e(k,null,{default:l(()=>[g(" Paiement de "+U(u.Payeur)+", le "+U($(Ve).date(u.Time)),1)]),_:2},1024),e(k,{cols:"2",class:"text-right"},{default:l(()=>[g(U(u.IsRemboursement?"+":"-")+U($(Ve).montant(u.Montant)),1)]),_:2},1024)]),_:2},1024))),256)),e(E,null,{default:l(()=>[e(k,{cols:"10",class:"text-right"},{default:l(()=>[...c[8]||(c[8]=[g("Solde",-1)])]),_:1}),e(k,{cols:"2",class:"text-right"},{default:l(()=>[R("b",null,U(o.dossier.Bilan.Restant),1)]),_:1})]),_:1})]),_:1})]),_:1},8,["subtitle"]))}});function qe(t){let o=arguments.length>1&&arguments[1]!==void 0?arguments[1]:2;return String(t).padStart(o,"0")}const $n=Fe({allowedValues:Function,ampm:Boolean,color:String,disabled:Boolean,displayedValue:null,double:Boolean,format:{type:Function,default:t=>t},max:{type:Number,required:!0},min:{type:Number,required:!0},scrollable:Boolean,readonly:Boolean,rotate:{type:Number,default:0},step:{type:Number,default:1},modelValue:{type:Number}},"VTimePickerClock"),Ql=he()({name:"VTimePickerClock",props:$n(),emits:{change:t=>!0,input:t=>!0},setup(t,o){let{emit:i}=o;const v=D(null),a=D(null),s=D(void 0),m=D(!1),n=D(null),c=D(null),u=na(b=>i("change",b),750),{textColorClasses:r,textColorStyles:d}=ua(()=>t.color),{backgroundColorClasses:p,backgroundColorStyles:V}=Jl(()=>t.color),A=h(()=>t.max-t.min+1),C=h(()=>t.double?A.value/2:A.value),_=h(()=>360/C.value),P=h(()=>_.value*Math.PI/180),q=h(()=>t.modelValue==null?t.min:t.modelValue),G=h(()=>.62),S=h(()=>{const b=[];for(let M=t.min;M<=t.max;M=M+t.step)b.push(M);return b});Ae(()=>t.modelValue,b=>{s.value=b});function f(b){s.value!==b&&(s.value=b),i("input",b)}function ee(b){return!t.allowedValues||t.allowedValues(b)}function fe(b){if(!t.scrollable||t.disabled)return;b.preventDefault();const M=Math.sign(-b.deltaY||1);let F=q.value;do F=F+M,F=(F-t.min+A.value)%A.value+t.min;while(!ee(F)&&F!==q.value);F!==t.displayedValue&&f(F),u(F)}function W(b){return t.double&&b-t.min>=C.value}function I(b){return W(b)?G.value:1}function te(b){const M=t.rotate*Math.PI/180;return{x:Math.sin((b-t.min)*P.value+M)*I(b),y:-Math.cos((b-t.min)*P.value+M)*I(b)}}function ne(b,M){const F=(Math.round(b/_.value)+(M?C.value:0))%A.value+t.min;return b<360-_.value/2?F:M?t.max-C.value+1:t.min}function N(b){const{x:M,y:F}=te(b);return{left:`${Math.round(50+M*50)}%`,top:`${Math.round(50+F*50)}%`}}function j(b,M){const F=M.x-b.x,pe=M.y-b.y;return Math.sqrt(F*F+pe*pe)}function re(b,M){const F=2*Math.atan2(M.y-b.y-j(b,M),M.x-b.x);return Math.abs(F*180/Math.PI)}function Z(b){n.value===null&&(n.value=b),c.value=b,f(b)}function ye(b){if(b.preventDefault(),!m.value&&b.type!=="click"||!v.value)return;const{width:M,top:F,left:pe}=v.value?.getBoundingClientRect(),{width:ae}=a.value?.getBoundingClientRect()??{width:0},{clientX:Me,clientY:$e}="touches"in b?b.touches[0]:b,T={x:M/2,y:-M/2},Y={x:Me-pe,y:F-$e},de=Math.round(re(T,Y)-t.rotate+360)%360,ve=t.double&&j(T,Y)<(ae+ae*G.value)/4,kt=Math.ceil(15/_.value);let Qe;for(let ol=0;ol<kt;ol++)if(Qe=ne(de+ol*_.value,ve),ee(Qe)||(Qe=ne(de-ol*_.value,ve),ee(Qe)))return Z(Qe)}function be(b){t.disabled||(b.preventDefault(),window.addEventListener("mousemove",ye),window.addEventListener("touchmove",ye),window.addEventListener("mouseup",J),window.addEventListener("touchend",J),n.value=null,c.value=null,m.value=!0,ye(b))}function J(b){b.stopPropagation(),window.removeEventListener("mousemove",ye),window.removeEventListener("touchmove",ye),window.removeEventListener("mouseup",J),window.removeEventListener("touchend",J),m.value=!1,c.value!==null&&ee(c.value)&&i("change",c.value)}Re(()=>R("div",{class:Ce([{"v-time-picker-clock":!0,"v-time-picker-clock--indeterminate":t.modelValue==null,"v-time-picker-clock--readonly":t.readonly}]),onMousedown:be,onTouchstart:be,onWheel:fe,ref:v},[R("div",{class:"v-time-picker-clock__inner",ref:a},[R("div",{class:Ce([{"v-time-picker-clock__hand":!0,"v-time-picker-clock__hand--inner":W(t.modelValue)},r.value]),style:al([{transform:`rotate(${t.rotate+_.value*(q.value-t.min)}deg) scaleY(${I(q.value)})`},d.value])},null),S.value.map(b=>{const M=b===q.value;return R("div",{class:Ce([{"v-time-picker-clock__item":!0,"v-time-picker-clock__item--active":M,"v-time-picker-clock__item--disabled":t.disabled||!ee(b)},M&&p.value]),style:al([N(b),M&&V.value])},[R("span",null,[t.format(b)])])})])]))}}),Un=Fe({ampm:Boolean,color:String,disabled:Boolean,hour:Number,minute:Number,second:Number,period:String,readonly:Boolean,useSeconds:Boolean,value:Number,viewMode:String},"VTimePickerControls"),Wl=he()({name:"VTimePickerControls",props:Un(),emits:{"update:period":t=>!0,"update:viewMode":t=>!0},setup(t,o){let{emit:i,slots:v}=o;const{t:a}=Ke();return Re(()=>{let s=t.hour;return t.ampm&&(s=s?(s-1)%12+1:12),R("div",{class:"v-time-picker-controls"},[R("div",{class:Ce({"v-time-picker-controls__time":!0,"v-time-picker-controls__time--with-seconds":t.useSeconds})},[e(L,{active:t.viewMode==="hour",color:t.viewMode==="hour"?t.color:void 0,disabled:t.disabled,variant:"tonal",class:Ce({"v-time-picker-controls__time__btn":!0,"v-time-picker-controls__time--with-ampm__btn":t.ampm,"v-time-picker-controls__time--with-seconds__btn":t.useSeconds}),text:t.hour==null?"--":qe(`${s}`),onClick:()=>i("update:viewMode","hour")},null),R("span",{class:Ce(["v-time-picker-controls__time__separator",{"v-time-picker-controls--with-seconds__time__separator":t.useSeconds}])},[g(":")]),e(L,{active:t.viewMode==="minute",color:t.viewMode==="minute"?t.color:void 0,class:Ce({"v-time-picker-controls__time__btn":!0,"v-time-picker-controls__time__btn__active":t.viewMode==="minute","v-time-picker-controls__time--with-ampm__btn":t.ampm,"v-time-picker-controls__time--with-seconds__btn":t.useSeconds}),disabled:t.disabled,variant:"tonal",text:t.minute==null?"--":qe(t.minute),onClick:()=>i("update:viewMode","minute")},null),t.useSeconds&&R("span",{class:Ce(["v-time-picker-controls__time__separator",{"v-time-picker-controls--with-seconds__time__separator":t.useSeconds}]),key:"secondsDivider"},[g(":")]),t.useSeconds&&e(L,{key:"secondsVal",active:t.viewMode==="second",color:t.viewMode==="second"?t.color:void 0,variant:"tonal",onClick:()=>i("update:viewMode","second"),class:Ce({"v-time-picker-controls__time__btn":!0,"v-time-picker-controls__time__btn__active":t.viewMode==="second","v-time-picker-controls__time--with-seconds__btn":t.useSeconds}),disabled:t.disabled,text:t.second==null?"--":qe(t.second)},null),t.ampm&&R("div",{class:"v-time-picker-controls__ampm"},[e(L,{active:t.period==="am",color:t.period==="am"?t.color:void 0,class:Ce({"v-time-picker-controls__ampm__am":!0,"v-time-picker-controls__ampm__btn":!0,"v-time-picker-controls__ampm__btn__active":t.period==="am"}),disabled:t.disabled,text:a("$vuetify.timePicker.am"),variant:t.disabled&&t.period==="am"?"elevated":"tonal",onClick:()=>t.period!=="am"?i("update:period","am"):null},null),e(L,{active:t.period==="pm",color:t.period==="pm"?t.color:void 0,class:Ce({"v-time-picker-controls__ampm__pm":!0,"v-time-picker-controls__ampm__btn":!0,"v-time-picker-controls__ampm__btn__active":t.period==="pm"}),disabled:t.disabled,text:a("$vuetify.timePicker.pm"),variant:t.disabled&&t.period==="pm"?"elevated":"tonal",onClick:()=>t.period!=="pm"?i("update:period","pm"):null},null)])])])}),{}}}),Fn=Ee(24),gt=Ee(12),Ln=gt.map(t=>t+12);Ee(60);const hn=Fe({allowedHours:[Function,Array],allowedMinutes:[Function,Array],allowedSeconds:[Function,Array],disabled:Boolean,format:{type:String,default:"ampm"},max:String,min:String,viewMode:{type:String,default:"hour"},period:{type:String,default:"am",validator:t=>["am","pm"].includes(t)},modelValue:null,readonly:Boolean,scrollable:Boolean,useSeconds:Boolean,...je(at({title:"$vuetify.timePicker.title"}),["landscape"])},"VTimePicker"),Rn=he()({name:"VTimePicker",props:hn(),emits:{"update:hour":t=>!0,"update:minute":t=>!0,"update:period":t=>!0,"update:second":t=>!0,"update:modelValue":t=>!0,"update:viewMode":t=>!0},setup(t,o){let{emit:i,slots:v}=o;const{t:a}=Ke(),s=D(null),m=D(null),n=D(null),c=D(null),u=D(null),r=D(null),d=Ue(t,"period","am"),p=Ue(t,"viewMode","hour"),V=D(null),A=D(null),C=h(()=>{let N;if(t.allowedHours instanceof Array?N=Z=>t.allowedHours.includes(Z):N=t.allowedHours,!t.min&&!t.max)return N;const j=t.min?Number(t.min.split(":")[0]):0,re=t.max?Number(t.max.split(":")[0]):23;return Z=>Z>=Number(j)&&Z<=Number(re)&&(!N||N(Z))}),_=h(()=>{let N;const j=!C.value||s.value===null||C.value(s.value);if(t.allowedMinutes instanceof Array?N=M=>t.allowedMinutes.includes(M):N=t.allowedMinutes,!t.min&&!t.max)return j?N:()=>!1;const[re,Z]=t.min?t.min.split(":").map(Number):[0,0],[ye,be]=t.max?t.max.split(":").map(Number):[23,59],J=re*60+Number(Z),b=ye*60+Number(be);return M=>{const F=60*s.value+M;return F>=J&&F<=b&&j&&(!N||N(M))}}),P=h(()=>{let N;const re=(!C.value||s.value===null||C.value(s.value))&&(!_.value||m.value===null||_.value(m.value));if(t.allowedSeconds instanceof Array?N=ae=>t.allowedSeconds.includes(ae):N=t.allowedSeconds,!t.min&&!t.max)return re?N:()=>!1;const[Z,ye,be]=t.min?t.min.split(":").map(Number):[0,0,0],[J,b,M]=t.max?t.max.split(":").map(Number):[23,59,59],F=Z*3600+ye*60+Number(be||0),pe=J*3600+b*60+Number(M||0);return ae=>{const Me=3600*s.value+60*m.value+ae;return Me>=F&&Me<=pe&&re&&(!N||N(ae))}}),q=h(()=>t.format==="ampm");Ae(()=>t.period,N=>I(N)),Ae(()=>t.modelValue,N=>fe(N)),Te(()=>{fe(t.modelValue)});function G(){return s.value!=null&&m.value!=null&&(!t.useSeconds||n.value!=null)?`${qe(s.value)}:${qe(m.value)}`+(t.useSeconds?`:${qe(n.value)}`:""):null}function S(){const N=G();N!==null&&i("update:modelValue",N)}function f(N){return N?(N-1)%12+1:12}function ee(N,j){return N%12+(j==="pm"?12:0)}function fe(N){if(N==null||N==="")s.value=null,m.value=null,n.value=null;else if(N instanceof Date)s.value=N.getHours(),m.value=N.getMinutes(),n.value=N.getSeconds();else{const[j,,re,,Z,ye]=N.trim().toLowerCase().match(/^(\d+):(\d+)(:(\d+))?([ap]m)?$/)||new Array(6);s.value=ye?ee(parseInt(j,10),ye):parseInt(j,10),m.value=parseInt(re,10),n.value=parseInt(Z||0,10)}d.value=s.value==null||s.value<12?"am":"pm"}function W(N,j){const re=C.value;if(!re)return j;const Z=q.value?j<12?gt:Ln:Fn;return((Z.find(be=>re((be+j)%Z.length+Z[0]))||0)+j)%Z.length+Z[0]}function I(N){if(d.value=N,s.value!=null){const j=s.value+(d.value==="am"?-12:12);s.value=W("hour",j)}return i("update:period",N),S(),!0}function te(N){p.value==="hour"?s.value=q.value?ee(N,d.value):N:p.value==="minute"?m.value=N:n.value=N}function ne(N){switch(p.value||"hour"){case"hour":i("update:hour",N);break;case"minute":i("update:minute",N);break;case"second":i("update:second",N);break}const j=s.value!==null&&m.value!==null&&(t.useSeconds?n.value!==null:!0);p.value==="hour"?p.value="minute":t.useSeconds&&p.value==="minute"&&(p.value="second"),!(s.value===c.value&&m.value===u.value&&(!t.useSeconds||n.value===r.value)||G()===null)&&(c.value=s.value,u.value=m.value,t.useSeconds&&(r.value=n.value),j&&S())}Re(()=>{const N=ml.filterProps(t),j=Wl.filterProps(t),re=Ql.filterProps(je(t,["format","modelValue","min","max"]));return e(ml,se(N,{color:void 0,class:["v-time-picker",t.class],style:t.style}),{title:()=>v.title?.()??R("div",{class:"v-time-picker__title"},[a(t.title)]),header:()=>e(Wl,se(j,{ampm:q.value,hour:s.value,minute:m.value,period:d.value,second:n.value,viewMode:p.value,"onUpdate:period":Z=>I(Z),"onUpdate:viewMode":Z=>p.value=Z,ref:V}),null),default:()=>e(Ql,se(re,{allowedValues:p.value==="hour"?C.value:p.value==="minute"?_.value:P.value,double:p.value==="hour"&&!q.value,format:p.value==="hour"?q.value?f:Z=>Z:Z=>qe(Z,2),max:p.value==="hour"?q.value&&d.value==="am"?11:23:59,min:p.value==="hour"&&q.value&&d.value==="pm"?12:0,size:20,step:p.value==="hour"?1:5,modelValue:p.value==="hour"?s.value:p.value==="minute"?m.value:n.value,onChange:ne,onInput:te,ref:A}),null),actions:v.actions})})}}),Tn=K({__name:"TimeField",props:De({hideDetails:{type:Boolean},readonly:{type:Boolean}},{modelValue:{required:!0},modelModifiers:{}}),emits:["update:modelValue"],setup(t){const o=t,i=Pe(t,"modelValue"),v=h(()=>new Date(i.value).toLocaleTimeString(void 0,{hour:"numeric",minute:"numeric"}));function a(n){const[c,u]=n.split(":"),r=new Date(i.value);r.setHours(Number(c),Number(u)),i.value=r.toISOString()}function s(n){const c=new Date(n),u=new Date(i.value);c.setHours(u.getHours(),u.getMinutes(),u.getSeconds()),i.value=c.toISOString()}const m=D(!1);return(n,c)=>{const u=ft;return y(),w(E,{"no-gutters":""},{default:l(()=>[e(k,null,{default:l(()=>[e(u,{class:"mr-2",label:"Date","model-value":$(et)(new Date(i.value)),"onUpdate:modelValue":s,"hide-details":o.hideDetails,readonly:o.readonly},null,8,["model-value","hide-details","readonly"])]),_:1}),e(k,{cols:"auto"},{default:l(()=>[...c[1]||(c[1]=[R("div",{class:"ma-2"},null,-1)])]),_:1}),e(k,null,{default:l(()=>[e(Se,{"close-on-content-click":!1,modelValue:m.value,"onUpdate:modelValue":c[0]||(c[0]=r=>m.value=r)},{activator:l(({props:r})=>[e(me,se({class:"center-text"},r,{variant:"outlined",density:"compact","hide-details":o.hideDetails,label:"Moment","model-value":v.value}),null,16,["hide-details","model-value"])]),default:l(()=>[e(Rn,{"model-value":new Date(i.value),"onUpdate:modelValue":a,format:"24hr"},null,8,["model-value"])]),_:1},8,["modelValue"])]),_:1})]),_:1})}}}),En=Pl(Tn,[["__scopeId","data-v-32955f86"]]),Nn=K({__name:"ModePaiementField",props:De({hideDetails:{type:Boolean},readonly:{type:Boolean},rules:{}},{modelValue:{required:!0},modelModifiers:{}}),emits:["update:modelValue"],setup(t){const o=t,i=Pe(t,"modelValue"),v=nl(ia);return(a,s)=>(y(),w(Oe,{label:"Mode de paiement",variant:"outlined",density:"compact",items:$(v),readonly:o.readonly,"hide-details":o.hideDetails,modelValue:i.value,"onUpdate:modelValue":s[0]||(s[0]=m=>i.value=m),rules:o.rules},null,8,["items","readonly","hide-details","modelValue","rules"]))}}),On=K({__name:"PaiementEditCard",props:{paiement:{}},emits:["update","delete"],setup(t,{emit:o}){const i=t,v=o,a=D(we(i.paiement)),s=h(()=>!0),m=D(!1);return(n,c)=>{const u=Nn,r=Ze,d=En;return y(),w(O,{title:"Modifier le paiement"},{default:l(()=>[e(X,{modelValue:m.value,"onUpdate:modelValue":c[1]||(c[1]=p=>m.value=p),"max-width":"400px"},{default:l(()=>[e(O,{title:"Confirmation"},{default:l(()=>[e(B,null,{default:l(()=>[...c[11]||(c[11]=[g(" Confirmez-vous la suppression de ce paiement ? ",-1),R("br",null,null,-1),R("br",null,null,-1),g(" Attention, cette opération est irréversible. ",-1)])]),_:1}),e(oe,null,{default:l(()=>[e(ie),e(L,{color:"red",onClick:c[0]||(c[0]=p=>{m.value=!1,v("delete")})},{default:l(()=>[...c[12]||(c[12]=[g("Supprimer",-1)])]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"]),e(B,null,{default:l(()=>[e(E,null,{default:l(()=>[e(k,null,{default:l(()=>[e(me,{density:"compact",variant:"outlined","hide-details":"",label:"Payé par",modelValue:a.value.Payeur,"onUpdate:modelValue":c[2]||(c[2]=p=>a.value.Payeur=p)},null,8,["modelValue"])]),_:1}),e(k,null,{default:l(()=>[e(me,{density:"compact",variant:"outlined","hide-details":"",label:"Description (optionelle)",modelValue:a.value.Label,"onUpdate:modelValue":c[3]||(c[3]=p=>a.value.Label=p)},null,8,["modelValue"])]),_:1})]),_:1}),e(E,null,{default:l(()=>[e(k,null,{default:l(()=>[e(u,{modelValue:a.value.Mode,"onUpdate:modelValue":c[4]||(c[4]=p=>a.value.Mode=p),"hide-details":""},null,8,["modelValue"])]),_:1}),e(k,null,{default:l(()=>[e(r,{label:"Montant",modelValue:a.value.Montant,"onUpdate:modelValue":c[5]||(c[5]=p=>a.value.Montant=p),"hide-details":""},null,8,["modelValue"])]),_:1})]),_:1}),e(E,null,{default:l(()=>[e(k,null,{default:l(()=>[e(ze,{"hide-details":"",density:"compact",label:"Remboursement ?",modelValue:a.value.IsRemboursement,"onUpdate:modelValue":c[6]||(c[6]=p=>a.value.IsRemboursement=p)},null,8,["modelValue"])]),_:1})]),_:1}),e(E,null,{default:l(()=>[e(k,null,{default:l(()=>[e(d,{modelValue:a.value.Time,"onUpdate:modelValue":c[7]||(c[7]=p=>a.value.Time=p),"hide-details":""},null,8,["modelValue"])]),_:1})]),_:1}),e(E,null,{default:l(()=>[e(k,null,{default:l(()=>[e(me,{density:"compact",variant:"outlined",label:"Détails (optionnel)",modelValue:a.value.Details,"onUpdate:modelValue":c[8]||(c[8]=p=>a.value.Details=p)},null,8,["modelValue"])]),_:1})]),_:1})]),_:1}),e(oe,null,{default:l(()=>[e(L,{color:"red",onClick:c[9]||(c[9]=p=>m.value=!0)},{default:l(()=>[...c[13]||(c[13]=[g("Supprimer le paiement",-1)])]),_:1}),e(ie),e(L,{onClick:c[10]||(c[10]=p=>v("update",a.value)),disabled:!s.value},{default:l(()=>[...c[14]||(c[14]=[g("Enregistrer",-1)])]),_:1},8,["disabled"])]),_:1})]),_:1})}}}),Bn=K({__name:"DossierEditCard",props:{responsable:{},dossier:{}},emits:["save"],setup(t,{emit:o}){const i=t,v=o,a=D(we(i.dossier));return(s,m)=>{const n=il,c=rt,u=wl;return y(),w(O,null,{default:l(()=>[e(B,null,{default:l(()=>[e(E,null,{default:l(()=>[e(k,null,{default:l(()=>[e(n,{label:"Responsable","initial-personne":i.responsable,"model-value":a.value.IdResponsable,"onUpdate:modelValue":m[0]||(m[0]=r=>r?a.value.IdResponsable=r:void 0),api:{SelectPersonne:$(x).SelectPersonne.bind($(x))}},null,8,["initial-personne","model-value","api"])]),_:1})]),_:1}),e(E,null,{default:l(()=>[e(k,null,{default:l(()=>[e(c,{label:"Adresses mail en copie",modelValue:a.value.CopiesMails,"onUpdate:modelValue":m[1]||(m[1]=r=>a.value.CopiesMails=r),rule:$(sa).validMails()},null,8,["modelValue","rule"])]),_:1})]),_:1}),e(E,null,{default:l(()=>[e(k,null,{default:l(()=>[e(u,{"hide-details":"",modelValue:a.value.PartageAdressesOK,"onUpdate:modelValue":m[2]||(m[2]=r=>a.value.PartageAdressesOK=r),label:"Partage des coordonnées"},null,8,["modelValue"])]),_:1})]),_:1}),e(E,null,{default:l(()=>[e(k,null,{default:l(()=>[e(u,{"hide-details":"",modelValue:a.value.DemandeFondSoutien,"onUpdate:modelValue":m[3]||(m[3]=r=>a.value.DemandeFondSoutien=r),label:"Demande le fonds de soutien"},null,8,["modelValue"])]),_:1})]),_:1})]),_:1}),e(oe,null,{default:l(()=>[e(ie),e(L,{onClick:m[4]||(m[4]=r=>v("save",a.value))},{default:l(()=>[...m[5]||(m[5]=[g("Enregistrer",-1)])]),_:1})]),_:1})]),_:1})}}}),qn=K({__name:"OptionJournee",props:De({camp:{}},{modelValue:{required:!0},modelModifiers:{}}),emits:["update:modelValue"],setup(t){const o=t,i=Pe(t,"modelValue"),v=h(()=>(o.camp.OptionPrix.Jours||[]).map((a,s)=>s));return(a,s)=>(y(),w(O,null,{default:l(()=>[e(B,null,{default:l(()=>[s[1]||(s[1]=R("div",{class:"text-grey mb-2"}," Le prix est variable en fonction des jours de participation au camp. ",-1)),e(oa,{class:"overflow-x-auto",color:"secondary",multiple:"","model-value":i.value?.length?i.value:v.value,"onUpdate:modelValue":s[0]||(s[0]=m=>i.value=m.length==v.value.length?[]:m)},{default:l(()=>[(y(!0),z(le,null,ce(o.camp.OptionPrix.Jours,(m,n)=>(y(),w(L,null,{default:l(()=>[g("J "+U(n+1),1)]),_:2},1024))),256))]),_:1},8,["model-value"])]),_:1})]),_:1}))}}),jn=K({__name:"OptionStatut",props:De({camp:{}},{modelValue:{required:!0},modelModifiers:{}}),emits:["update:modelValue"],setup(t){const o=t,i=Pe(t,"modelValue"),v=h(()=>(o.camp.OptionPrix.Statuts||[]).map(s=>({value:s.Id,title:s.Label,subtitle:s.Description}))),a=h(()=>v.value.map(s=>s.value).includes(i.value));return(s,m)=>(y(),w(O,null,{default:l(()=>[e(B,null,{default:l(()=>[m[1]||(m[1]=R("div",{class:"text-grey mb-4"},"Le prix dépend du statut du participant.",-1)),e(Oe,{clearable:"",items:v.value,label:"Statut","model-value":a.value?i.value:null,"onUpdate:modelValue":m[0]||(m[0]=n=>i.value=n??0),variant:"outlined",density:"comfortable","hide-details":""},{item:l(({item:n,props:c})=>[e(H,se(c,{title:n.title,subtitle:n.raw.subtitle}),null,16,["title","subtitle"])]),_:1},8,["items","model-value"])]),_:1})]),_:1}))}}),Hn={key:2},Yn=K({__name:"ParticipantOptionPrix",props:{camp:{},optionAndQf:{}},emits:["update"],setup(t,{emit:o}){const i=t,v=o,a=D(we(i.optionAndQf));return Ae(()=>i.optionAndQf,()=>a.value=we(i.optionAndQf)),(s,m)=>{const n=Xe;return y(),w(O,{title:"Prix variable",width:"800px"},{default:l(()=>[e(B,null,{default:l(()=>[e(E,{justify:"space-evenly"},{default:l(()=>[e(k,{"align-self":"center",cols:"3"},{default:l(()=>[e(n,{modelValue:a.value.quotientFamilial,"onUpdate:modelValue":m[0]||(m[0]=c=>a.value.quotientFamilial=c),label:"Quotient familial","hide-details":""},null,8,["modelValue"])]),_:1}),e(ue,{thickness:"2",vertical:""}),e(k,{"align-self":"center",cols:"8"},{default:l(()=>[i.camp.OptionPrix.Active==$(Ie).PrixJour?(y(),w(qn,{key:0,camp:i.camp,modelValue:a.value.options.Jour,"onUpdate:modelValue":m[1]||(m[1]=c=>a.value.options.Jour=c)},null,8,["camp","modelValue"])):i.camp.OptionPrix.Active==$(Ie).PrixStatut?(y(),w(jn,{key:1,camp:i.camp,modelValue:a.value.options.IdStatut,"onUpdate:modelValue":m[2]||(m[2]=c=>a.value.options.IdStatut=c)},null,8,["camp","modelValue"])):(y(),z("div",Hn,"Le camp ne propose pas d'option sur le prix."))]),_:1})]),_:1})]),_:1}),e(oe,null,{default:l(()=>[e(ie),e(L,{onClick:m[3]||(m[3]=c=>v("update",a.value))},{default:l(()=>[...m[4]||(m[4]=[g("Enregistrer",-1)])]),_:1})]),_:1})]),_:1})}}}),zn={key:1,class:"mx-1"},Qn={key:2,class:"mx-1"},Wn={key:3},Jn={key:4,class:"mx-1"},Gn=K({__name:"RemisesChip",props:{remises:{}},emits:["update"],setup(t,{emit:o}){const i=t,v=o,a=h(()=>s.value.Famille!=0||s.value.Equipiers!=0||s.value.Speciale.Cent!=0),s=D(we(i.remises));Ae(()=>i.remises,()=>s.value=we(i.remises));const m=D(!1);return(n,c)=>{const u=Xe,r=Ze;return y(),w(Se,{"close-on-content-click":!1,location:"bottom",modelValue:m.value,"onUpdate:modelValue":c[4]||(c[4]=d=>m.value=d)},{activator:l(({props:d})=>[e(O,se(d,{elevation:"1",color:"grey-lighten-2"}),{default:l(()=>[e(B,{class:"py-1 px-1"},{default:l(()=>[a.value?Q("",!0):(y(),z(le,{key:0},[g(" Pas de remises ")],64)),s.value.Famille?(y(),z("span",zn," Inscrits : "+U(s.value.Famille)+"% ",1)):Q("",!0),s.value.Equipiers?(y(),z("span",Qn," Equipiers : "+U(s.value.Equipiers)+"% ",1)):Q("",!0),(s.value.Famille||s.value.Equipiers)&&s.value.Speciale.Cent?(y(),z("br",Wn)):Q("",!0),s.value.Speciale.Cent?(y(),z("span",Jn," Remise : "+U($(Ve).montant(s.value.Speciale)),1)):Q("",!0)]),_:1})]),_:1},16)]),default:l(()=>[e(O,{title:"Modifier les remises",width:"400px"},{default:l(()=>[e(B,null,{default:l(()=>[e(E,null,{default:l(()=>[e(k,null,{default:l(()=>[e(u,{modelValue:s.value.Famille,"onUpdate:modelValue":c[0]||(c[0]=d=>s.value.Famille=d),label:"Remise inscrits","hide-details":"",suffix:"%"},null,8,["modelValue"])]),_:1}),e(k,null,{default:l(()=>[e(u,{modelValue:s.value.Equipiers,"onUpdate:modelValue":c[1]||(c[1]=d=>s.value.Equipiers=d),label:"Remise équipiers","hide-details":"",suffix:"%"},null,8,["modelValue"])]),_:1})]),_:1}),e(E,null,{default:l(()=>[e(k,null,{default:l(()=>[e(r,{class:"mt-2",modelValue:s.value.Speciale,"onUpdate:modelValue":c[2]||(c[2]=d=>s.value.Speciale=d),label:"Remise spéciale","hide-details":""},null,8,["modelValue"])]),_:1})]),_:1})]),_:1}),e(oe,null,{default:l(()=>[e(ie),e(L,{onClick:c[3]||(c[3]=d=>{v("update",s.value),m.value=!1})},{default:l(()=>[...c[5]||(c[5]=[g("Enregistrer",-1)])]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"])}}}),Kn=Pl(Gn,[["__scopeId","data-v-06eacfe8"]]),Xn=K({__name:"AideEditCard",props:{aide:{},file:{},structures:{},participant:{}},emits:["save","deleteFile","uploadFile","showStructureaides"],setup(t,{emit:o}){const i=t,v=o,a=D(we(i.aide)),s=h(()=>Object.values(i.structures).map(m=>({value:m.Id,title:m.Nom})));return(m,n)=>{const c=wl,u=Ze,r=Xe,d=ja;return y(),w(O,{title:"Modifier l'aide extérieure",subtitle:`pour ${$(Ne).label(i.participant.Personne)} - ${$(_e).label(i.participant.Camp)}`},{append:l(()=>[e(L,{onClick:n[0]||(n[0]=p=>v("showStructureaides"))},{default:l(()=>[e(xe,null,{default:l(()=>[...n[9]||(n[9]=[g("mdi-view-list",-1)])]),_:1}),n[10]||(n[10]=g(" Structures",-1))]),_:1})]),default:l(()=>[e(B,null,{default:l(()=>[e(E,null,{default:l(()=>[e(k,null,{default:l(()=>[e(Oe,{variant:"outlined",density:"comfortable",label:"Structure",items:s.value,modelValue:a.value.IdStructureaide,"onUpdate:modelValue":n[1]||(n[1]=p=>a.value.IdStructureaide=p)},null,8,["items","modelValue"])]),_:1}),e(k,null,{default:l(()=>[e(c,{modelValue:a.value.Valide,"onUpdate:modelValue":n[2]||(n[2]=p=>a.value.Valide=p),label:"Aide validée","hide-details":""},null,8,["modelValue"])]),_:1})]),_:1}),e(E,null,{default:l(()=>[e(k,{"align-self":"center"},{default:l(()=>[e(u,{modelValue:a.value.Valeur,"onUpdate:modelValue":n[3]||(n[3]=p=>a.value.Valeur=p),label:"Montant","hide-details":""},null,8,["modelValue"])]),_:1}),e(k,{"align-self":"center",cols:"auto"},{default:l(()=>[e(c,{"hide-details":"",label:"Par jour",modelValue:a.value.ParJour,"onUpdate:modelValue":n[4]||(n[4]=p=>a.value.ParJour=p)},null,8,["modelValue"])]),_:1}),e(k,{"align-self":"center"},{default:l(()=>[e(r,{label:"Limite",suffix:"jours",modelValue:a.value.NbJoursMax,"onUpdate:modelValue":n[5]||(n[5]=p=>a.value.NbJoursMax=p),disabled:!a.value.ParJour,hint:"0 pour ne pas limiter",min:0,"persistent-hint":""},null,8,["modelValue","disabled"])]),_:1})]),_:1}),e(d,{class:"mt-4",files:i.file?[i.file]:[],title:"Document justificatif","max-docs":1,"in-upload":!1,onDelete:n[6]||(n[6]=p=>v("deleteFile")),onUpload:n[7]||(n[7]=p=>v("uploadFile",p))},null,8,["files"])]),_:1}),e(oe,null,{default:l(()=>[e(ie),e(L,{onClick:n[8]||(n[8]=p=>v("save",a.value))},{default:l(()=>[...n[11]||(n[11]=[g("Enregistrer",-1)])]),_:1})]),_:1})]),_:1},8,["subtitle"])}}}),Zn=K({__name:"StructuresPannel",props:{modelValue:{required:!0},modelModifiers:{}},emits:["update:modelValue"],setup(t){const o=Pe(t,"modelValue"),i=h(()=>Object.values(o.value||{}).sort((c,u)=>c.Nom.localeCompare(u.Nom)));async function v(){const c=await x.StructureaideCreate();if(c===void 0)return;x.showMessage("Structure créée avec succès.");const u=o.value||{};u[c.Id]=c,o.value=u,a.value=c}const a=D(null);async function s(){const c=a.value;if(c==null||(a.value=null,await x.StructureaideUpdate(c)===void 0))return;x.showMessage("Structure modifiée avec succès.");const r=o.value||{};r[c.Id]=c,o.value=r}const m=D(null);async function n(){const c=m.value;if(c==null||(m.value=null,await x.StructureaideDelete({id:c.Id})===void 0))return;const r=o.value||{};delete r[c.Id],o.value=r,x.showMessage("Structure supprimée avec succès.")}return(c,u)=>(y(),w(O,{title:"Structures d'aide",subtitle:"Organismes pouvant distribuer une aide extérieure"},{append:l(()=>[e(L,{onClick:v},{prepend:l(()=>[e(xe,{color:"green"},{default:l(()=>[...u[5]||(u[5]=[g("mdi-plus",-1)])]),_:1})]),default:l(()=>[u[6]||(u[6]=g(" Ajouter une structure ",-1))]),_:1})]),default:l(()=>[e(B,{class:"overflow-y-auto"},{default:l(()=>[(y(!0),z(le,null,ce(i.value,r=>(y(),w(E,null,{default:l(()=>[e(k,{"align-self":"center"},{default:l(()=>[e(it,null,{default:l(()=>[g(U(r.Nom),1)]),_:2},1024),e(st,null,{default:l(()=>[g(U(r.Immatriculation),1)]),_:2},1024)]),_:2},1024),e(k,{"align-self":"center",style:{"font-size":"smaller"}},{default:l(()=>[(y(!0),z(le,null,ce(r.Info.split(`
`),d=>(y(),z("div",null,U(d),1))),256))]),_:2},1024),e(k,{"align-self":"center",cols:"auto"},{default:l(()=>[e(Se,null,{activator:l(({props:d})=>[e(L,se({icon:"mdi-dots-vertical"},{ref_for:!0},d,{size:"x-small"}),null,16)]),default:l(()=>[e(ke,null,{default:l(()=>[e(H,{title:"Modifier","prepend-icon":"mdi-pencil",onClick:d=>a.value=$(we)(r)},null,8,["onClick"]),e(H,{title:"Supprimer","prepend-icon":"mdi-delete",onClick:d=>m.value=r},null,8,["onClick"])]),_:2},1024)]),_:2},1024)]),_:2},1024)]),_:2},1024))),256))]),_:1}),e(X,{"model-value":a.value!=null,"onUpdate:modelValue":u[3]||(u[3]=r=>a.value=null),"max-width":"600px"},{default:l(()=>[a.value!=null?(y(),w(O,{key:0,title:"Modifier la structure"},{default:l(()=>[e(B,null,{default:l(()=>[e(E,null,{default:l(()=>[e(k,null,{default:l(()=>[e(me,{variant:"outlined",density:"compact",label:"Nom",modelValue:a.value.Nom,"onUpdate:modelValue":u[0]||(u[0]=r=>a.value.Nom=r),"hide-details":""},null,8,["modelValue"])]),_:1}),e(k,null,{default:l(()=>[e(me,{variant:"outlined",density:"compact",label:"Immatriculation",modelValue:a.value.Immatriculation,"onUpdate:modelValue":u[1]||(u[1]=r=>a.value.Immatriculation=r),"hide-details":""},null,8,["modelValue"])]),_:1})]),_:1}),e(E,null,{default:l(()=>[e(k,null,{default:l(()=>[e(cl,{variant:"outlined",density:"compact",label:"Informations",modelValue:a.value.Info,"onUpdate:modelValue":u[2]||(u[2]=r=>a.value.Info=r),"hide-details":""},null,8,["modelValue"])]),_:1})]),_:1})]),_:1}),e(oe,null,{default:l(()=>[e(ie),e(L,{onClick:s},{default:l(()=>[...u[7]||(u[7]=[g("Enregistrer",-1)])]),_:1})]),_:1})]),_:1})):Q("",!0)]),_:1},8,["model-value"]),e(X,{"model-value":m.value!=null,"onUpdate:modelValue":u[4]||(u[4]=r=>m.value=null),"max-width":"450px"},{default:l(()=>[m.value!=null?(y(),w(O,{key:0,title:"Confirmation"},{default:l(()=>[e(B,null,{default:l(()=>[g(" Confirmez-vous la suppression de la structure "+U(m.value.Nom)+" ? ",1),u[8]||(u[8]=R("br",null,null,-1)),u[9]||(u[9]=R("br",null,null,-1)),u[10]||(u[10]=g(" Attention, cette opération est irréversible. ",-1))]),_:1}),e(oe,null,{default:l(()=>[e(ie),e(L,{color:"red",onClick:n},{default:l(()=>[...u[11]||(u[11]=[g("Supprimer",-1)])]),_:1})]),_:1})]),_:1})):Q("",!0)]),_:1},8,["model-value"])]),_:1}))}}),eu={key:0},lu={key:1},tu=K({__name:"DossierParticipantRow",props:De({participant:{},aides:{},aidesFiles:{},hasManyParticipants:{type:Boolean}},{structures:{required:!0},structuresModifiers:{}}),emits:De(["update","delete","createAide","updateAide","deleteAide","deleteFileAide","uploadFileAide","expand"],["update:structures"]),setup(t,{emit:o}){const i=t,v=Pe(t,"structures"),a=o,s=h(()=>{const C=Object.values(i.aides||{});return C.sort((_,P)=>_.Id-P.Id),C}),m=h(()=>i.participant.Camp.OptionPrix.Active==Ie.NoOption&&!_e.isQuotientFamilialActive(i.participant.Camp.OptionQuotientFamilial));function n(C){switch(i.participant.Camp.OptionPrix.Active){case Ie.NoOption:return"Séjour sans option";case Ie.PrixJour:const _=C.Jour?.length||0;return _==0?"Présent tous les jours":`Présent ${_} jour${_>1?"s":""}`;case Ie.PrixStatut:const P=i.participant.Camp.OptionPrix.Statuts?.find(q=>q.Id==C.IdStatut);return P?`Statut ${P.Label}`:"Pas d'option."}}const c=D(!1),u=D(!1),r=h(()=>Object.values(v.value).map(C=>({value:C.Id,title:C.Nom})).sort((C,_)=>C.title.localeCompare(_.title))),d=D(null),p=D(null),V=D(null),A=D(!1);return(C,_)=>(y(),w(E,null,{default:l(()=>[e(k,{"align-self":"center",cols:"3"},{default:l(()=>[e(it,null,{default:l(()=>[R("a",{href:"/camps",onClick:_[0]||(_[0]=Je(P=>$(Dl)(i.participant.Participant),["prevent"]))},U($(Ne).label(i.participant.Personne)),1)]),_:1}),e(st,null,{default:l(()=>[g(U($(_e).label(i.participant.Camp)),1)]),_:1})]),_:1}),e(k,{"align-self":"center",cols:"2",class:"text-center"},{default:l(()=>[e(Se,{disabled:m.value,"close-on-content-click":!1,modelValue:c.value,"onUpdate:modelValue":_[2]||(_[2]=P=>c.value=P)},{activator:l(({props:P})=>[e(O,se(P,{elevation:m.value?0:1,color:"grey-lighten-2"}),{default:l(()=>[e(B,{class:"py-1 px-1"},{default:l(()=>[m.value?(y(),z("div",eu,"Camp sans option")):(y(),z("div",lu,[g(U(i.participant.Participant.QuotientFamilial?`QF ${i.participant.Participant.QuotientFamilial}.`:"Pas de QF.")+" ",1),_[22]||(_[22]=R("br",null,null,-1)),g(" "+U(n(i.participant.Participant.OptionPrix)),1)]))]),_:1})]),_:1},16,["elevation"])]),default:l(()=>[e(Yn,{camp:i.participant.Camp,"option-and-qf":{options:i.participant.Participant.OptionPrix,quotientFamilial:i.participant.Participant.QuotientFamilial},onUpdate:_[1]||(_[1]=P=>{i.participant.Participant.OptionPrix=P.options,i.participant.Participant.QuotientFamilial=P.quotientFamilial,c.value=!1,a("update",i.participant.Participant)})},null,8,["camp","option-and-qf"])]),_:1},8,["disabled","modelValue"])]),_:1}),e(k,{"align-self":"center",class:"text-center"},{default:l(()=>[s.value.length?Q("",!0):(y(),w(ge,{key:0,label:""},{default:l(()=>[..._[23]||(_[23]=[g("Aucune aide",-1)])]),_:1})),(y(!0),z(le,null,ce(s.value,P=>(y(),w(ge,{class:"my-1","prepend-icon":"mdi-cash-plus",color:P.Valide?"green":"orange",onClick:q=>p.value=P},{close:l(()=>[e(xe,{icon:"mdi-close-circle",onClick:Je(q=>V.value=P,["stop"])},null,8,["onClick"])]),default:l(()=>[g(" "+U(v.value[P.IdStructureaide].Nom)+" : "+U($(Ve).montant(P.Valeur)),1)]),_:2},1032,["color","onClick"]))),256))]),_:1}),e(k,{"align-self":"center",class:"text-center",cols:"3"},{default:l(()=>[e(Kn,{remises:i.participant.Participant.Remises,onUpdate:_[3]||(_[3]=P=>{i.participant.Participant.Remises=P,a("update",i.participant.Participant)})},null,8,["remises"])]),_:1}),e(k,{"align-self":"center",cols:"auto"},{default:l(()=>[e(Se,{location:"left"},{activator:l(({props:P})=>[e(L,se(P,{icon:"mdi-dots-vertical",size:"small"}),null,16)]),default:l(()=>[e(ke,{density:"comfortable"},{default:l(()=>[e(H,{title:"Ajouter une aide","prepend-icon":"mdi-cash-plus",onClick:_[4]||(_[4]=P=>d.value={IdParticipant:i.participant.Participant.Id,IdStructure:0})}),e(ue),i.hasManyParticipants?(y(),w(H,{key:0,"prepend-icon":"mdi-arrow-expand",title:"Étendre les options et remises",subtitle:"... au reste du dossier",onClick:_[5]||(_[5]=P=>a("expand"))})):Q("",!0),e(ue),e(H,{title:"Supprimer","prepend-icon":"mdi-delete",onClick:_[6]||(_[6]=P=>u.value=!0)})]),_:1})]),_:1})]),_:1}),e(X,{modelValue:u.value,"onUpdate:modelValue":_[8]||(_[8]=P=>u.value=P),"max-width":"600px"},{default:l(()=>[e(O,{title:"Supprimer le participant"},{default:l(()=>[e(B,null,{default:l(()=>[..._[24]||(_[24]=[g(" Confirmez-vous la suppression de ce participant ? ",-1),R("br",null,null,-1),g(" Attention, cette opération est irréversible. ",-1)])]),_:1}),e(oe,null,{default:l(()=>[e(ie),e(L,{color:"red",onClick:_[7]||(_[7]=P=>{a("delete"),u.value=!1})},{default:l(()=>[..._[25]||(_[25]=[g("Supprimer",-1)])]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"]),e(X,{modelValue:A.value,"onUpdate:modelValue":_[10]||(_[10]=P=>A.value=P),"max-width":"650px"},{default:l(()=>[e(Zn,{modelValue:v.value,"onUpdate:modelValue":_[9]||(_[9]=P=>v.value=P)},null,8,["modelValue"])]),_:1},8,["modelValue"]),d.value!=null?(y(),w(X,{key:0,"model-value":d.value!=null,"onUpdate:modelValue":_[14]||(_[14]=P=>d.value=null),width:"600px"},{default:l(()=>[e(O,{title:"Ajouter une aide extérieure"},{append:l(()=>[e(L,{onClick:_[11]||(_[11]=P=>A.value=!0),"prepend-icon":"mdi-view-list"},{default:l(()=>[..._[26]||(_[26]=[g(" Structures",-1)])]),_:1})]),default:l(()=>[e(B,null,{default:l(()=>[e(Oe,{variant:"outlined",density:"comfortable",label:"Structure",items:r.value,"model-value":d.value.IdStructure==0?null:d.value.IdStructure,"onUpdate:modelValue":_[12]||(_[12]=P=>d.value.IdStructure=P)},null,8,["items","model-value"])]),_:1}),e(oe,null,{default:l(()=>[e(ie),e(L,{color:"green",onClick:_[13]||(_[13]=P=>{a("createAide",d.value),d.value=null}),disabled:d.value.IdStructure==0},{default:l(()=>[..._[27]||(_[27]=[g("Créer",-1)])]),_:1},8,["disabled"])]),_:1})]),_:1})]),_:1},8,["model-value"])):Q("",!0),p.value!=null?(y(),w(X,{key:1,"model-value":p.value!=null,"onUpdate:modelValue":_[19]||(_[19]=P=>p.value=null),"max-width":"800px"},{default:l(()=>[e(Xn,{aide:p.value,file:t.aidesFiles[p.value.Id],structures:v.value,participant:i.participant,onShowStructureaides:_[15]||(_[15]=P=>A.value=!0),onSave:_[16]||(_[16]=P=>{a("updateAide",P),p.value=null}),onDeleteFile:_[17]||(_[17]=P=>a("deleteFileAide",p.value.Id)),onUploadFile:_[18]||(_[18]=P=>a("uploadFileAide",P,p.value.Id))},null,8,["aide","file","structures","participant"])]),_:1},8,["model-value"])):Q("",!0),V.value!=null?(y(),w(X,{key:2,"model-value":V.value!=null,"onUpdate:modelValue":_[21]||(_[21]=P=>V.value=null),"max-width":"600px"},{default:l(()=>[e(O,{title:"Supprimer l'aide"},{default:l(()=>[e(B,null,{default:l(()=>[..._[28]||(_[28]=[g(" Confirmez-vous la suppression de l'aide extérieure ? ",-1),R("br",null,null,-1),g(" Attention, cette opération est irréversible. ",-1)])]),_:1}),e(oe,null,{default:l(()=>[e(ie),e(L,{color:"red",onClick:_[20]||(_[20]=P=>{a("deleteAide",V.value.Id),V.value=null})},{default:l(()=>[..._[29]||(_[29]=[g("Supprimer",-1)])]),_:1})]),_:1})]),_:1})]),_:1},8,["model-value"])):Q("",!0)]),_:1}))}}),au=K({__name:"DossierEditor",props:{dossier:{},camps:{}},emits:["updateDossier","createParticipant","updateParticipant","deleteParticipant","expandParticipant","createAide","updateAide","deleteAide","deleteFileAide","uploadFileAide"],setup(t,{emit:o}){const i=t,v=o,a=D(null);Te(n);const s=D(!0),m=D({});async function n(){const c=await x.StructureaidesGet();c!==void 0&&(s.value=!1,m.value=c||{})}return(c,u)=>(y(),w(O,{title:"Modifier le dossier"},{append:l(()=>[e(L,{onClick:u[0]||(u[0]=r=>a.value={IdCamp:0,IdPersonne:0,IdDossier:i.dossier.Dossier.Dossier.Id})},{prepend:l(()=>[e(xe,{color:"green"},{default:l(()=>[...u[9]||(u[9]=[g("mdi-plus",-1)])]),_:1})]),default:l(()=>[u[10]||(u[10]=g(" Ajouter un participant",-1))]),_:1})]),default:l(()=>[e(B,null,{default:l(()=>[e(E,null,{default:l(()=>[e(k,{cols:"3"},{default:l(()=>[e(Bn,{responsable:i.dossier.Dossier.Responsable,dossier:i.dossier.Dossier.Dossier,onSave:u[1]||(u[1]=r=>v("updateDossier",r))},null,8,["responsable","dossier"])]),_:1}),e(ue,{thickness:"2",vertical:""}),s.value?Q("",!0):(y(),w(k,{key:0},{default:l(()=>[u[11]||(u[11]=R("div",{class:"my-1"},null,-1)),(y(!0),z(le,null,ce(i.dossier.Dossier.Participants,r=>(y(),w(tu,{participant:r,aides:(i.dossier.Dossier.Aides||{})[r.Participant.Id],"aides-files":i.dossier.Dossier.AidesFiles||{},"has-many-participants":(i.dossier.Dossier.Participants?.length||0)>1,structures:m.value,"onUpdate:structures":u[2]||(u[2]=d=>m.value=d),onCreateAide:u[3]||(u[3]=d=>v("createAide",d)),onDeleteAide:u[4]||(u[4]=d=>v("deleteAide",d)),onUpdateAide:u[5]||(u[5]=d=>v("updateAide",d)),onDeleteFileAide:u[6]||(u[6]=d=>v("deleteFileAide",d)),onUploadFileAide:u[7]||(u[7]=(d,p)=>v("uploadFileAide",d,p)),onUpdate:u[8]||(u[8]=d=>v("updateParticipant",d)),onDelete:d=>v("deleteParticipant",r.Participant.Id),onExpand:d=>v("expandParticipant",r.Participant)},null,8,["participant","aides","aides-files","has-many-participants","structures","onDelete","onExpand"]))),256))]),_:1}))]),_:1})]),_:1})]),_:1}))}}),nu={class:"mr-1"},uu=["onClick"],iu={class:"overflow-y-auto",style:{"max-height":"65vh"}},su=["href"],ou=K({__name:"DossierDetailsPannel",props:{dossier:{},camps:{}},emits:["updateDossier","deleteDossier","mergeDossier","createParticipant","updateParticipant","deleteParticipant","expandParticipant","createAide","updateAide","deleteAide","deleteFileAide","uploadFileAide","createPaiement","updatePaiement","deletePaiement","sendMessage","deleteMessage","sendFacture"],setup(t,{expose:o,emit:i}){const v=t,a=i;o({showEditPaiement:d,showEditDossier:c});const s=h(()=>ra(v.dossier.Dossier,x.isFondsSoutien?$l.FondSoutien:$l.Backoffice)),m=D(!1),n=D(!1);function c(){n.value=!0}const u=D(null),r=D(null);function d(S){r.value=S}const p="Repère",V=D(!1);async function A(){await dl(v.dossier.EspacepersoURL),x.showMessage("Lien vers l'espace personnel copié.")}async function C(){await dl(v.dossier.VirementCode),x.showMessage("Identifiant de virement copié.")}async function _(S){await dl(S),x.showMessage("IBAN copié.")}const P=D(!1),q=D(!1),G=D("");return(S,f)=>{const ee=Na,fe=sl,W=il;return y(),w(O,{class:"ml-2"},{title:l(()=>[f[36]||(f[36]=g(" Responsable ",-1)),R("a",{href:"/annuaire",onClick:f[0]||(f[0]=Je(I=>$(We)(v.dossier.Dossier.IdResponsable),["prevent"]))},U(v.dossier.Dossier.Responsable),1)]),subtitle:l(()=>[f[37]||(f[37]=g(" Participants ",-1)),(y(!0),z(le,null,ce(v.dossier.Dossier.Participants,I=>(y(),z("span",nu,[R("a",{href:"/camps",onClick:Je(te=>$(Dl)(I.Participant),["prevent"])},U($(Ne).prenomN(I.Personne)),9,uu)]))),256))]),append:l(()=>[e(L,{icon:"mdi-pencil",onClick:f[1]||(f[1]=I=>n.value=!0),class:"mx-1"}),e(Se,null,{activator:l(({props:I})=>[e(L,se(I,{icon:"mdi-dots-vertical",size:"small",class:"mx-1"}),null,16)]),default:l(()=>[e(ke,{density:"compact"},{default:l(()=>[e(H,{"prepend-icon":"mdi-email",onClick:f[2]||(f[2]=I=>q.value=!0),title:"Envoyer un message",subtitle:"Notification par email"}),e(H,{"prepend-icon":"mdi-invoice-send",onClick:f[3]||(f[3]=I=>a("sendFacture")),title:"Envoyer une demande de règlement",subtitle:"Notification par email"}),e(ue),e(H,{"prepend-icon":"mdi-cash-plus",onClick:f[4]||(f[4]=I=>a("createPaiement")),title:"Ajouter un paiement"}),e(ue),e(H,{"prepend-icon":"mdi-link",onClick:f[5]||(f[5]=I=>V.value=!0),title:"Afficher les identifiants"}),e(ue),e(H,{"prepend-icon":"mdi-file-move",onClick:f[6]||(f[6]=I=>P.value=!0),title:"Fusionner vers ..."}),e(ue),e(H,{onClick:f[7]||(f[7]=I=>m.value=!0),title:"Supprimer"},{prepend:l(()=>[e(xe,{color:"red"},{default:l(()=>[...f[38]||(f[38]=[g("mdi-delete",-1)])]),_:1})]),_:1})]),_:1})]),_:1})]),default:l(()=>[e(B,null,{default:l(()=>[e(E,null,{default:l(()=>[e(k,{class:"ml-2 mb-1 text-center"},{default:l(()=>[e(Se,null,{activator:l(({props:I})=>[e(ge,se(I,{"prepend-icon":"mdi-currency-eur",color:$(Ve).colorStatutPaiement(v.dossier.Dossier.Bilan.Statut)}),{default:l(()=>[g(U(v.dossier.Dossier.Bilan.Recu)+" payé sur "+U(v.dossier.Dossier.Bilan.Demande),1)]),_:1},16,["color"])]),default:l(()=>[e(Mn,{dossier:v.dossier.Dossier},null,8,["dossier"])]),_:1})]),_:1})]),_:1}),R("div",iu,[e(Ea,{side:"end",class:"mt-4",density:"compact"},{default:l(()=>[(y(!0),z(le,null,ce(s.value,(I,te)=>(y(),w(ee,{event:I,key:te,onEditPaiement:f[8]||(f[8]=ne=>r.value=ne),onDeleteMessage:f[9]||(f[9]=ne=>a("deleteMessage",ne))},null,8,["event"]))),128))]),_:1})])]),_:1}),e(X,{modelValue:m.value,"onUpdate:modelValue":f[11]||(f[11]=I=>m.value=I),"max-width":"600px"},{default:l(()=>[e(O,{title:"Supprimer le dossier"},{default:l(()=>[e(B,null,{default:l(()=>[...f[39]||(f[39]=[g(" Confirmez-vous la suppression du dossier et de ses participants ? ",-1),R("br",null,null,-1),R("br",null,null,-1),g(" Attention, cette opération est irréversible. ",-1)])]),_:1}),e(oe,null,{default:l(()=>[e(ie),e(L,{color:"red",onClick:f[10]||(f[10]=I=>{a("deleteDossier"),m.value=!1})},{default:l(()=>[...f[40]||(f[40]=[g("Supprimer",-1)])]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"]),u.value!=null?(y(),w(X,{key:0,"model-value":u.value!=null,"onUpdate:modelValue":f[15]||(f[15]=I=>u.value=null),"max-width":"600px"},{default:l(()=>[e(O,{title:"Ajouter un participant"},{default:l(()=>[e(B,null,{default:l(()=>[e(E,null,{default:l(()=>[e(k,{cols:"12"},{default:l(()=>[e(fe,{label:"Camp",camps:v.camps,modelValue:u.value.IdCamp,"onUpdate:modelValue":f[12]||(f[12]=I=>u.value.IdCamp=I)},null,8,["camps","modelValue"])]),_:1}),e(k,{cols:"12"},{default:l(()=>[e(W,{label:"Personne","initial-personne":"",modelValue:u.value.IdPersonne,"onUpdate:modelValue":f[13]||(f[13]=I=>u.value.IdPersonne=I),api:{SelectPersonne:$(x).SelectPersonne.bind($(x))}},null,8,["modelValue","api"])]),_:1})]),_:1})]),_:1}),e(oe,null,{default:l(()=>[e(ie),e(L,{color:"green",disabled:u.value.IdPersonne==0||u.value.IdCamp==0,onClick:f[14]||(f[14]=I=>{a("createParticipant",u.value),u.value=null})},{default:l(()=>[...f[41]||(f[41]=[g("Ajouter",-1)])]),_:1},8,["disabled"])]),_:1})]),_:1})]),_:1},8,["model-value"])):Q("",!0),e(X,{modelValue:n.value,"onUpdate:modelValue":f[26]||(f[26]=I=>n.value=I)},{default:l(()=>[e(au,{dossier:v.dossier,camps:v.camps,onUpdateDossier:f[16]||(f[16]=I=>a("updateDossier",I)),onCreateParticipant:f[17]||(f[17]=I=>a("createParticipant",I)),onUpdateParticipant:f[18]||(f[18]=I=>a("updateParticipant",I)),onDeleteParticipant:f[19]||(f[19]=I=>a("deleteParticipant",I)),onExpandParticipant:f[20]||(f[20]=I=>a("expandParticipant",I)),onCreateAide:f[21]||(f[21]=I=>a("createAide",I)),onUpdateAide:f[22]||(f[22]=I=>a("updateAide",I)),onDeleteAide:f[23]||(f[23]=I=>a("deleteAide",I)),onDeleteFileAide:f[24]||(f[24]=I=>a("deleteFileAide",I)),onUploadFileAide:f[25]||(f[25]=(I,te)=>a("uploadFileAide",I,te))},null,8,["dossier","camps"])]),_:1},8,["modelValue"]),r.value!=null?(y(),w(X,{key:1,"model-value":r.value!=null,"onUpdate:modelValue":f[29]||(f[29]=I=>r.value=null),"max-width":"600px"},{default:l(()=>[e(On,{paiement:r.value,onUpdate:f[27]||(f[27]=I=>{a("updatePaiement",I),r.value=null}),onDelete:f[28]||(f[28]=I=>{a("deletePaiement",r.value),r.value=null})},null,8,["paiement"])]),_:1},8,["model-value"])):Q("",!0),e(X,{modelValue:V.value,"onUpdate:modelValue":f[30]||(f[30]=I=>V.value=I),"max-width":"800px"},{default:l(()=>[e(O,{title:"Liens et identifiants"},{default:l(()=>[e(B,null,{default:l(()=>[e(E,null,{default:l(()=>[e(k,{cols:"3"},{default:l(()=>[...f[42]||(f[42]=[g("Espace personnel",-1)])]),_:1}),e(k,{class:"text-truncate"},{default:l(()=>[R("a",{href:v.dossier.EspacepersoURL,target:"_blank"},U(v.dossier.EspacepersoURL),9,su)]),_:1}),e(k,{"align-self":"center",cols:"auto"},{default:l(()=>[e(L,{size:"small",icon:"mdi-content-copy",onClick:A})]),_:1})]),_:1}),(y(!0),z(le,null,ce(v.dossier.BankAccounts,I=>(y(),w(E,null,{default:l(()=>[e(k,{cols:"3"},{default:l(()=>[g("RIB ("+U($(p))+")",1)]),_:1}),e(k,{cols:"3"},{default:l(()=>[g(U(I[0]),1)]),_:2},1024),e(k,null,{default:l(()=>[g(U(I[1]),1)]),_:2},1024),e(k,{"align-self":"center",cols:"auto"},{default:l(()=>[e(L,{size:"small",icon:"mdi-content-copy",onClick:()=>_(I[1])},null,8,["onClick"])]),_:2},1024)]),_:2},1024))),256)),e(E,null,{default:l(()=>[e(k,{cols:"3"},{default:l(()=>[...f[43]||(f[43]=[g("Identification de virement",-1)])]),_:1}),e(k,null,{default:l(()=>[g(U(v.dossier.VirementCode),1)]),_:1}),e(k,{"align-self":"center",cols:"auto"},{default:l(()=>[e(L,{size:"small",icon:"mdi-content-copy",onClick:C})]),_:1})]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"]),e(X,{modelValue:P.value,"onUpdate:modelValue":f[32]||(f[32]=I=>P.value=I),"max-width":"600px"},{default:l(()=>[e(bt,{from:v.dossier.Dossier.Dossier.Id,onMerge:f[31]||(f[31]=I=>{a("mergeDossier",I),P.value=!1})},null,8,["from"])]),_:1},8,["modelValue"]),e(X,{modelValue:q.value,"onUpdate:modelValue":f[35]||(f[35]=I=>q.value=I),"max-width":"600px"},{default:l(()=>[e(O,{title:"Nouveau message",subtitle:"Envoie un message sur le fil de suivi et une notification par mail."},{default:l(()=>[e(B,null,{default:l(()=>[e(E,null,{default:l(()=>[e(k,null,{default:l(()=>[e(cl,{rows:"5",variant:"outlined",modelValue:G.value,"onUpdate:modelValue":f[33]||(f[33]=I=>G.value=I)},null,8,["modelValue"])]),_:1})]),_:1})]),_:1}),e(oe,null,{default:l(()=>[e(ie),e(L,{disabled:!G.value.length,onClickOnce:f[34]||(f[34]=I=>{a("sendMessage",G.value),q.value=!1})},{default:l(()=>[...f[44]||(f[44]=[g("Envoyer",-1)])]),_:1},8,["disabled"])]),_:1})]),_:1})]),_:1},8,["modelValue"])]),_:1})}}}),ru=K({__name:"CreateDossierCard",emits:["create"],setup(t,{emit:o}){const i=o,v=D(0);return(a,s)=>{const m=il;return y(),w(O,{title:"Créer un dossier"},{default:l(()=>[e(B,null,{default:l(()=>[e(E,null,{default:l(()=>[e(k,null,{default:l(()=>[e(m,{label:"Responsable légal",modelValue:v.value,"onUpdate:modelValue":s[0]||(s[0]=n=>v.value=n),"initial-personne":"",api:{SelectPersonne:$(x).SelectPersonne.bind($(x))}},null,8,["modelValue","api"])]),_:1})]),_:1})]),_:1}),e(oe,null,{default:l(()=>[e(ie),e(L,{color:"green",disabled:v.value==0,onClick:s[1]||(s[1]=n=>i("create",v.value))},{default:l(()=>[...s[2]||(s[2]=[g("Créer",-1)])]),_:1},8,["disabled"])]),_:1})]),_:1})}}}),du=K({__name:"DossierList",props:De({camps:{},allowFondsSoutien:{type:Boolean},selected:{}},{query:{required:!0},queryModifiers:{}}),emits:De(["click","update"],["update:query"]),setup(t,{expose:o,emit:i}){const v=t,a=i,s=Pe(t,"query");o({searchDossiers:n}),Ae(()=>s.value,n,{immediate:!0});const m=D(null);async function n(){const c=await x.DossiersSearch(s.value);c!==void 0&&(m.value=c,a("update",c))}return(c,u)=>{const r=sl,d=ut;return y(),z("div",null,[e(E,null,{default:l(()=>[e(k,{"align-self":"center"},{default:l(()=>[e(d,{density:"compact",variant:"outlined","prepend-inner-icon":"mdi-magnify",label:"Rechercher un dossier","hide-details":"",clearable:"",modelValue:s.value.Pattern,"onUpdate:modelValue":[u[5]||(u[5]=p=>s.value.Pattern=p),n]},{"append-inner":l(()=>[s.value.IdCamp.Valid?(y(),w(ge,{key:0,class:"ml-1",size:"small","prepend-icon":"mdi-bed"},{default:l(()=>[g(U(v.camps.find(p=>p.Id==s.value.IdCamp.Id)?.Label),1)]),_:1})):Q("",!0),s.value.Attente!=$(pa).EmptyQA?(y(),w(ge,{key:1,class:"ml-1",size:"small","prepend-icon":"mdi-clock"},{default:l(()=>[g(U($(Ul)[s.value.Attente]),1)]),_:1})):Q("",!0),s.value.Reglement!=$(fa).EmptyQR?(y(),w(ge,{key:2,class:"ml-1",size:"small","prepend-icon":"mdi-currency-eur"},{default:l(()=>[g(U($(Fl)[s.value.Reglement]),1)]),_:1})):Q("",!0),s.value.OnlyFondSoutien?(y(),w(ge,{key:3,class:"ml-1",size:"small"},{default:l(()=>[...u[6]||(u[6]=[g(" Fonds de soutien ",-1)])]),_:1})):Q("",!0)]),append:l(()=>[e(Se,{location:"left top","close-on-content-click":!1},{activator:l(({props:p})=>[e(L,se(p,{size:"small",variant:"flat",icon:""}),{default:l(()=>[e(xe,null,{default:l(()=>[...u[7]||(u[7]=[g("mdi-filter-cog",-1)])]),_:1}),e(He,{activator:"parent",text:"Autres critères de recherche"})]),_:1},16)]),default:l(()=>[e(O,{"min-width":"400px",title:"Filtrer les dossiers"},{default:l(()=>[e(B,null,{default:l(()=>[e(E,null,{default:l(()=>[e(k,null,{default:l(()=>[e(r,{label:"Camp",camps:v.camps,"model-value":$(ca)($(va)(s.value.IdCamp)),"onUpdate:modelValue":u[0]||(u[0]=p=>{s.value.IdCamp=$(da)($(ma)(p)),n()})},null,8,["camps","model-value"])]),_:1})]),_:1}),e(E,null,{default:l(()=>[e(k,null,{default:l(()=>[e(Oe,{density:"compact",variant:"outlined",label:"Liste d'attente",modelValue:s.value.Attente,"onUpdate:modelValue":[u[1]||(u[1]=p=>s.value.Attente=p),n],items:$(nl)($(Ul)),"hide-details":""},null,8,["modelValue","items"])]),_:1})]),_:1}),e(E,null,{default:l(()=>[e(k,null,{default:l(()=>[e(Oe,{density:"compact",variant:"outlined",label:"Réglement",modelValue:s.value.Reglement,"onUpdate:modelValue":[u[2]||(u[2]=p=>s.value.Reglement=p),n],items:$(nl)($(Fl)),"hide-details":""},null,8,["modelValue","items"])]),_:1})]),_:1}),e(E,null,{default:l(()=>[e(k,null,{default:l(()=>[e(kl,{label:"Trier selon les nouveaux messages",hint:"Affiche les nouveaux messages en premier.","persistent-hint":"",density:"compact",color:"light-blue-darken-3",modelValue:s.value.SortByNewMessages,"onUpdate:modelValue":[u[3]||(u[3]=p=>s.value.SortByNewMessages=p),n]},null,8,["modelValue"])]),_:1})]),_:1}),v.allowFondsSoutien?(y(),w(E,{key:0},{default:l(()=>[e(k,null,{default:l(()=>[e(kl,{label:"Fonds de soutien",hint:"N'affiche que les dossiers demandant le fonds de soutien.","persistent-hint":"",density:"compact",color:"orange",modelValue:s.value.OnlyFondSoutien,"onUpdate:modelValue":[u[4]||(u[4]=p=>s.value.OnlyFondSoutien=p),n]},null,8,["modelValue"])]),_:1})]),_:1})):Q("",!0)]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"])]),_:1})]),_:1}),m.value!=null?(y(),w(ke,{key:0,class:"mt-2",selected:v.selected?[v.selected]:void 0},{default:l(()=>[m.value.Dossiers?.length?Q("",!0):(y(),w(H,{key:0,class:"text-center"},{default:l(()=>[...u[8]||(u[8]=[R("i",null,"Aucun dossier ne correspond à votre recherche.",-1)])]),_:1})),(y(!0),z(le,null,ce(m.value.Dossiers,(p,V)=>(y(),w(H,{rounded:"",key:V,title:p.Responsable,subtitle:p.Participants,value:p.Id,onClick:A=>a("click",p),class:"my-1"},pl({_:2},[p.NewMessages?{name:"append",fn:l(()=>[e(ha,{color:"light-blue-darken-3",content:p.NewMessages},null,8,["content"])]),key:"0"}:void 0]),1032,["title","subtitle","value","onClick"]))),128))]),_:1},8,["selected"])):Q("",!0)])}}}),mu=K({__name:"SendDocumentsCampCard",props:{camps:{}},emits:["send"],setup(t,{emit:o}){const i=t,v=o,a=D(0),s=D(null);async function m(){const u=await x.EventsSendDocumentsCampPreview({idCamp:a.value});u!==void 0&&(s.value=u,n.value=(u.Dossiers||[]).filter(r=>!r.DocumentsSent).map(r=>r.Id))}const n=D([]),c=h(()=>n.value.length==(s.value?.Dossiers||[]).length);return(u,r)=>{const d=sl;return y(),w(O,{title:"Envoyer les documents d'un séjour"},{default:l(()=>[e(B,null,{default:l(()=>[e(E,null,{default:l(()=>[e(k,{"align-self":"center",cols:"5"},{default:l(()=>[e(d,{camps:i.camps,label:"Séjour",modelValue:a.value,"onUpdate:modelValue":[r[0]||(r[0]=p=>a.value=p),m]},null,8,["camps","modelValue"])]),_:1}),e(k,{"align-self":"center"},{default:l(()=>[s.value?(y(),w(O,{key:0,subtitle:"Dossiers à contacter"},pl({default:l(()=>[e(B,null,{default:l(()=>[e(ke,{selectable:"",selected:n.value,"onUpdate:selected":r[2]||(r[2]=p=>n.value=p),"select-strategy":"leaf"},{default:l(()=>[(y(!0),z(le,null,ce(s.value.Dossiers,p=>(y(),w(H,{title:p.Responsable,subtitle:p.Participants,value:p.Id,rounded:"",class:"my-1"},{append:l(({isSelected:V,select:A})=>[e(E,null,{default:l(()=>[e(k,null,{default:l(()=>[p.DocumentsSent?(y(),w(ge,{key:0,color:"green",class:"mr-2"},{default:l(()=>[...r[4]||(r[4]=[g("Envoyés",-1)])]),_:1})):Q("",!0)]),_:2},1024),e(k,null,{default:l(()=>[e(ot,{density:"compact","hide-details":"","model-value":V,"onUpdate:modelValue":A},null,8,["model-value","onUpdate:modelValue"])]),_:2},1024)]),_:2},1024)]),_:2},1032,["title","subtitle","value"]))),256))]),_:1},8,["selected"])]),_:1})]),_:2},[s.value.Dossiers?.length?{name:"append",fn:l(()=>[e(ze,{label:"Tout sélectionner",density:"compact","hide-details":"",indeterminate:!!n.value.length&&n.value.length!=(s.value.Dossiers||[]).length,"model-value":n.value.length==(s.value.Dossiers||[]).length,"onUpdate:modelValue":r[1]||(r[1]=p=>n.value=c.value?[]:(s.value.Dossiers||[]).map(V=>V.Id))},null,8,["indeterminate","model-value"])]),key:"0"}:void 0]),1024)):Q("",!0)]),_:1})]),_:1})]),_:1}),e(oe,null,{default:l(()=>[e(ie),e(L,{disabled:!a.value||!n.value.length,onClick:r[3]||(r[3]=p=>v("send",a.value,n.value)),"prepend-icon":"mdi-send"},{default:l(()=>[...r[5]||(r[5]=[g(" Envoyer ",-1)])]),_:1},8,["disabled"])]),_:1})]),_:1})}}}),cu=K({__name:"SendRelancePaiementCard",props:{camps:{}},emits:["send"],setup(t,{emit:o}){const i=t,v=o,a=D(0),s=D([]);async function m(){const u=await x.EventsSendRelancePaiementPreview({idCamp:a.value});u!==void 0&&(s.value=u||[],n.value=(u||[]).map(r=>r.Id))}const n=D([]),c=h(()=>n.value.length==s.value.length);return(u,r)=>{const d=sl;return y(),w(O,{title:"Envoyer une relance de paiement"},{default:l(()=>[e(B,null,{default:l(()=>[e(E,null,{default:l(()=>[e(k,{"align-self":"center",cols:"5"},{default:l(()=>[e(d,{camps:i.camps,label:"Séjour",modelValue:a.value,"onUpdate:modelValue":[r[0]||(r[0]=p=>a.value=p),m]},null,8,["camps","modelValue"])]),_:1}),e(k,{"align-self":"center"},{default:l(()=>[s.value?(y(),w(O,{key:0,subtitle:"Dossiers à relancer"},pl({default:l(()=>[e(B,null,{default:l(()=>[e(ke,{selectable:"",selected:n.value,"onUpdate:selected":r[2]||(r[2]=p=>n.value=p),"select-strategy":"leaf",density:"comfortable"},{default:l(()=>[(y(!0),z(le,null,ce(s.value,(p,V)=>(y(),w(H,{key:p.Id,title:p.Responsable,subtitle:$(ya)(p.LastEventFacture)?"":`Dernière demande : ${$(Ve).time(p.LastEventFacture)}`,value:p.Id,rounded:"",class:"my-1"},{append:l(({isSelected:A,select:C})=>[e(E,null,{default:l(()=>[e(k,{"align-self":"center"},{default:l(()=>[e(ge,{class:"mr-2",color:$(Ve).colorStatutPaiement(p.Bilan.Statut)},{default:l(()=>[g(U(p.Bilan.Recu)+" / "+U(p.Bilan.Demande),1)]),_:2},1032,["color"])]),_:2},1024),e(k,{"align-self":"center"},{default:l(()=>[e(ot,{density:"compact","hide-details":"","model-value":A,"onUpdate:modelValue":C},null,8,["model-value","onUpdate:modelValue"])]),_:2},1024)]),_:2},1024)]),_:2},1032,["title","subtitle","value"]))),128))]),_:1},8,["selected"])]),_:1})]),_:2},[s.value.length?{name:"append",fn:l(()=>[e(ze,{label:"Tout sélectionner",density:"compact","hide-details":"",indeterminate:!!n.value.length&&n.value.length!=s.value.length,"model-value":n.value.length==s.value.length,"onUpdate:modelValue":r[1]||(r[1]=p=>n.value=c.value?[]:s.value.map(V=>V.Id))},null,8,["indeterminate","model-value"])]),key:"0"}:void 0]),1024)):Q("",!0)]),_:1})]),_:1})]),_:1}),e(oe,null,{default:l(()=>[e(ie),e(L,{disabled:!a.value||!n.value.length,onClick:r[3]||(r[3]=p=>v("send",a.value,n.value)),"prepend-icon":"mdi-send"},{default:l(()=>[...r[4]||(r[4]=[g(" Envoyer ",-1)])]),_:1},8,["disabled"])]),_:1})]),_:1})}}}),vu=K({__name:"RemisesHintsCard",props:{allCamps:{}},setup(t){const o=t;Te(()=>{a.value=o.allCamps.filter(u=>!u.IsOld).map(u=>u.Id),m()});const i=D([]),v=D(!1),a=D([]),s=D(null);async function m(){const u=await x.DossiersRemisesHint({IdCamps:a.value});u!==void 0&&(s.value=u||[])}const n=D([]);async function c(){const u=s.value;if(!n.value.length||!u)return;const r=n.value.map(p=>u[p]),d=await x.DossiersApplyRemisesHints(r);n.value=[],d!==void 0&&(x.showMessage("Remises appliquées avec succès."),m())}return(u,r)=>(y(),w(O,{title:"Estimer les remises",subtitle:"Seules les nouvelles remises sont affichées."},{append:l(()=>[e(L,{onClick:r[0]||(r[0]=d=>{i.value=a.value,v.value=!0}),"prepend-icon":"mdi-cog"},{default:l(()=>[...r[5]||(r[5]=[g(" Séjours ",-1)])]),_:1}),e(ue,{vertical:"",thickness:"1",class:"mx-2"}),e(L,{disabled:!n.value.length,onClick:c},{default:l(()=>[...r[6]||(r[6]=[g("Appliquer les remises",-1)])]),_:1},8,["disabled"])]),default:l(()=>[e(B,null,{default:l(()=>[s.value==null?(y(),w(Ge,{key:0})):(y(),w(ke,{key:1,"select-strategy":"leaf",selected:n.value,"onUpdate:selected":r[1]||(r[1]=d=>n.value=d),color:"primary"},{default:l(()=>[s.value.length?Q("",!0):(y(),w(H,{key:0,class:"font-italic"},{default:l(()=>[...r[7]||(r[7]=[g(" Aucune nouvelle remise à appliquer. ",-1)])]),_:1})),(y(!0),z(le,null,ce(s.value,(d,p)=>(y(),w(H,{title:d.Personne,subtitle:d.Camp,value:p,rounded:"",class:"my-1"},{append:l(()=>[e(E,{style:{width:"200px"}},{default:l(()=>[e(k,{cols:"6"},{default:l(()=>[d.Hint.Famille?(y(),w(ge,{key:0,"prepend-icon":"mdi-account-multiple",class:"mx-1",elevation:"1"},{default:l(()=>[g(U(d.Hint.Famille)+" % ",1),e(He,{activator:"parent","content-class":"ma-0 pa-0"},{default:l(()=>[e(O,{subtitle:"Autres inscrits de la même famille"},{default:l(()=>[e(B,null,{default:l(()=>[(y(!0),z(le,null,ce(d.AutresInscrits,V=>(y(),w(ge,{class:"mx-1"},{default:l(()=>[g(U(V.Personne)+" ("+U(V.Camp)+")",1)]),_:2},1024))),256))]),_:2},1024)]),_:2},1024)]),_:2},1024)]),_:2},1024)):Q("",!0)]),_:2},1024),e(k,{cols:"6"},{default:l(()=>[d.Hint.Equipiers?(y(),w(ge,{key:0,"prepend-icon":"mdi-account-hard-hat",class:"mx-1",elevation:"1"},{default:l(()=>[g(U(d.Hint.Equipiers)+" % ",1),e(He,{activator:"parent","content-class":"ma-0 pa-0"},{default:l(()=>[e(O,{subtitle:"Equipiers de la même famille"},{default:l(()=>[e(B,null,{default:l(()=>[(y(!0),z(le,null,ce(d.Equipiers,V=>(y(),w(ge,{class:"mx-1"},{default:l(()=>[g(U(V.Personne)+" ("+U(V.Camp)+")",1)]),_:2},1024))),256))]),_:2},1024)]),_:2},1024)]),_:2},1024)]),_:2},1024)):Q("",!0)]),_:2},1024)]),_:2},1024)]),_:2},1032,["title","subtitle","value"]))),256))]),_:1},8,["selected"]))]),_:1}),e(X,{modelValue:v.value,"onUpdate:modelValue":r[4]||(r[4]=d=>v.value=d),"max-width":"600px"},{default:l(()=>[e(O,{title:"Choix des séjours"},{default:l(()=>[e(B,null,{default:l(()=>[e(yt,{"all-camps":o.allCamps,modelValue:i.value,"onUpdate:modelValue":r[2]||(r[2]=d=>i.value=d)},null,8,["all-camps","modelValue"])]),_:1}),e(oe,null,{default:l(()=>[e(ie),e(L,{onClick:r[3]||(r[3]=d=>{a.value=i.value,v.value=!1,m()})},{default:l(()=>[...r[8]||(r[8]=[g("Appliquer",-1)])]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"])]),_:1}))}}),pu={key:1,class:"text-center font-italic my-6"},fu=K({__name:"PannelDossiers",props:{initialDossier:{}},setup(t){const o=t;Te(()=>{m(),o.initialDossier!==void 0&&r(o.initialDossier)}),Ae(()=>o.initialDossier,()=>{o.initialDossier!==void 0&&r(o.initialDossier)});const i=Ll("detailsPannel"),v=D(null),a=D(Ua()),s=D([]);async function m(){const T=await x.GetCamps();T!==void 0&&(s.value=T||[])}function n(T){v.value={length:T.Dossiers?.length||0,total:T.Total}}const c=Ll("dossierList");function u(){c.value?.searchDossiers()}async function r(T){await p(T),a.value=Fa(T)}const d=D(null);async function p(T){const Y=await x.DossiersLoad({id:T});Y!==void 0&&(d.value=Y)}async function V(T){p(T.Id),await x.EventsMarkMessagesSeen({idDossier:T.Id})!==void 0&&u()}async function A(){d.value!=null&&p(d.value.Dossier.Dossier.Id)}const C=D(!1);async function _(T){C.value=!1;const Y=await x.DossiersCreate({idResponsable:T});Y!==void 0&&(x.showMessage("Dossier créé avec succès."),await r(Y.Id),i.value?.showEditDossier())}async function P(T){const Y=await x.DossiersUpdate(T);Y!==void 0&&(x.showMessage("Dossier mis à jour avec succès."),d.value!=null&&(d.value.Dossier.Dossier=T,d.value.Dossier.Responsable=Y.Responsable),u())}async function q(){if(d.value==null)return;const T=d.value.Dossier.Dossier.Id;await x.DossiersDelete({id:T})!==void 0&&(x.showMessage("Dossier supprimé avec succès."),d.value=null,u())}async function G(T){await x.DossiersMerge(T)!==void 0&&(x.showMessage("Dossier fusionné avec succès."),u(),p(T.To))}async function S(T){await x.ParticipantsCreate(T)!==void 0&&(x.showMessage("Participant ajouté avec succès."),A())}async function f(T){await x.ParticipantsUpdate(T)!==void 0&&(x.showMessage("Réglages du participant modifiés avec succès."),A())}async function ee(T){await x.ParticipantsDelete({id:T})!==void 0&&(x.showMessage("Participant supprimé avec succès."),A())}async function fe(T){if(d.value==null)return;const Y=d.value.Dossier.Participants?.map(ve=>ve.Participant).filter(ve=>ve.Id!=T.Id)||[];!Y.length||(Y.forEach(ve=>{ve.Remises=T.Remises,ve.QuotientFamilial=T.QuotientFamilial,ve.IdCamp==T.IdCamp&&(ve.OptionPrix=T.OptionPrix)}),(await Promise.all(Y.map(ve=>x.ParticipantsUpdate(ve)))).includes(void 0))||(x.showMessage("Réglages des participants modifiés avec succès."),A())}async function W(T){const Y=await x.AidesCreate(T);if(Y===void 0||(x.showMessage("Aide ajoutée avec succès."),d.value==null))return;const de=d.value.Dossier.Aides||{},ve=de[T.IdParticipant]||{};ve[Y.Id]=Y,de[T.IdParticipant]=ve,d.value.Dossier.Aides=de}async function I(T){await x.AidesUpdate(T)!==void 0&&(x.showMessage("Aide modifiée avec succès."),A())}async function te(T){await x.AidesJustificatifDelete({idAide:T})!==void 0&&(x.showMessage("Justificatif supprimé avec succès."),d.value!=null&&d.value.Dossier.AidesFiles&&delete d.value.Dossier.AidesFiles[T])}async function ne(T,Y){const de=await x.AidesJustificatifUpload(T,{idAide:Y});if(de!==void 0&&(x.showMessage("Justificatif téléversé avec succès."),d.value!=null)){const ve=d.value.Dossier.AidesFiles||{};ve[Y]=de,d.value.Dossier.AidesFiles=ve}}async function N(T){await x.AidesDelete({id:T})!==void 0&&(x.showMessage("Aide supprimée avec succès."),A())}async function j(){if(d.value==null)return;const T=await x.PaiementsCreate({idDossier:d.value.Dossier.Dossier.Id});T!==void 0&&(x.showMessage("Paiement créé avec succès."),A(),i.value?.showEditPaiement(T))}async function re(T){await x.PaiementsUpdate(T)!==void 0&&(x.showMessage("Paiement modifié avec succès."),A())}async function Z(T){await x.PaiementsDelete({id:T.Id})!==void 0&&(x.showMessage("Paiement supprimé avec succès."),A())}async function ye(T){d.value==null||await x.EventsSendMessage({IdDossier:d.value.Dossier.Dossier.Id,Contenu:T})===void 0||(x.showMessage("Message envoyé avec succès."),A())}async function be(T){await x.EventsDelete({id:T.Id})!==void 0&&(x.showMessage("Message supprimé avec succès."),A())}async function J(){d.value==null||await x.EventsSendFacture({idDossier:d.value.Dossier.Dossier.Id})===void 0||(x.showMessage("Demande de règlement envoyé avec succès."),A())}const b=D(!1),M=D(null);async function F(T,Y){M.value={Current:0,Total:Y.length};const de=await x.EventsSendDocumentsCamp({IdCamp:T,IdDossiers:Y});if(de===void 0){M.value=null;return}await Vl(de,ve=>M.value=ve,ve=>x.onError("Envoi des documents",ve)),M.value=null,A(),x.showMessage("Documents du séjour envoyés avec succès.")}const pe=D(!1),ae=D(null);async function Me(T,Y){ae.value={Current:0,Total:Y.length};const de=await x.EventsSendRelancePaiement({IdDossiers:Y});if(de===void 0){ae.value=null;return}await Vl(de,ve=>ae.value=ve,ve=>x.onError("Envoi de la relance",ve)),ae.value=null,A(),x.showMessage("Toutes les relances ont été envoyées avec succès.")}const $e=D(!1);return(T,Y)=>(y(),w(E,{"no-gutters":"",class:"ma-2"},{default:l(()=>[e(k,{cols:"6"},{default:l(()=>[e(O,{title:"Dossiers",subtitle:v.value==null?"-":`${v.value.length} affiché(s) / ${v.value.total}`},{append:l(()=>[e(L,{icon:"",size:"small",onClick:Y[0]||(Y[0]=de=>C.value=!0)},{default:l(()=>[e(xe,{color:"green"},{default:l(()=>[...Y[9]||(Y[9]=[g("mdi-plus",-1)])]),_:1})]),_:1}),e(ue,{thickness:"1",vertical:"",class:"mx-2"}),e(L,{size:"small","prepend-icon":"mdi-send-circle-outline"},{default:l(()=>[Y[10]||(Y[10]=g(" Actions ",-1)),e(Se,{activator:"parent"},{default:l(()=>[e(ke,{density:"compact"},{default:l(()=>[e(H,{title:"Estimation des remises","prepend-icon":"mdi-finance",onClick:Y[1]||(Y[1]=de=>$e.value=!0)}),e(ue),e(H,{title:"Documents...",subtitle:"Paramétrer et envoyer les documents d'un séjour","prepend-icon":"mdi-mail",onClick:Y[2]||(Y[2]=de=>b.value=!0)}),e(ue),e(H,{title:"Relance de paiement...",subtitle:"Paramétrer et envoyer une relance, pour un séjour","prepend-icon":"mdi-invoice-send",onClick:Y[3]||(Y[3]=de=>pe.value=!0)})]),_:1})]),_:1})]),_:1})]),default:l(()=>[e(B,null,{default:l(()=>[e(du,{camps:s.value,"allow-fonds-soutien":$(x).isFondsSoutien,selected:d.value?.Dossier.Dossier.Id,query:a.value,"onUpdate:query":Y[4]||(Y[4]=de=>a.value=de),onClick:V,onUpdate:n,ref_key:"dossierList",ref:c},null,8,["camps","allow-fonds-soutien","selected","query"])]),_:1})]),_:1},8,["subtitle"])]),_:1}),e(k,{cols:"6"},{default:l(()=>[d.value!=null?(y(),w(ou,{key:0,dossier:d.value,camps:s.value,onUpdateDossier:P,onDeleteDossier:q,onMergeDossier:G,onCreateParticipant:S,onUpdateParticipant:f,onDeleteParticipant:ee,onExpandParticipant:fe,onCreateAide:W,onDeleteAide:N,onUpdateAide:I,onDeleteFileAide:te,onUploadFileAide:ne,onCreatePaiement:j,onUpdatePaiement:re,onDeletePaiement:Z,onSendMessage:ye,onDeleteMessage:be,onSendFacture:J,ref_key:"detailsPannel",ref:i},null,8,["dossier","camps"])):(y(),z("div",pu," Sélectionner un dossier... "))]),_:1}),e(X,{modelValue:C.value,"onUpdate:modelValue":Y[5]||(Y[5]=de=>C.value=de),"max-width":"400px"},{default:l(()=>[e(ru,{onCreate:_})]),_:1},8,["modelValue"]),e(X,{modelValue:b.value,"onUpdate:modelValue":Y[6]||(Y[6]=de=>b.value=de),"max-width":"1000px"},{default:l(()=>[e(mu,{camps:s.value,onSend:F},null,8,["camps"])]),_:1},8,["modelValue"]),e(X,{modelValue:pe.value,"onUpdate:modelValue":Y[7]||(Y[7]=de=>pe.value=de),"max-width":"1000px"},{default:l(()=>[e(cu,{camps:s.value,onSend:Me},null,8,["camps"])]),_:1},8,["modelValue"]),e(X,{"model-value":M.value!=null,"max-width":"400px",persistent:""},{default:l(()=>[M.value?(y(),w(Cl,{key:0,title:"Envoi des documents en cours",current:M.value.Current,total:M.value.Total},null,8,["current","total"])):Q("",!0)]),_:1},8,["model-value"]),e(X,{"model-value":ae.value!=null,"max-width":"400px",persistent:""},{default:l(()=>[ae.value?(y(),w(Cl,{key:0,title:"Envoi des relances en cours",current:ae.value.Current,total:ae.value.Total},null,8,["current","total"])):Q("",!0)]),_:1},8,["model-value"]),e(X,{modelValue:$e.value,"onUpdate:modelValue":Y[8]||(Y[8]=de=>$e.value=de),"max-width":"800px"},{default:l(()=>[e(vu,{"all-camps":s.value},null,8,["all-camps"])]),_:1},8,["modelValue"])]),_:1}))}}),yu=K({__name:"inscriptions",setup(t){const o=ul(),i=h(()=>_u(o.currentRoute.value.query)),v=h(()=>i.value.tab||"insc"),a=h(()=>i.value.idDossier);function s(m){const n=o.currentRoute.value;o.push({path:n.path,query:{tab:m}})}return(m,n)=>(y(),z(le,null,[e(fl,{title:"Suivi des inscriptions"},{default:l(()=>[e(Ta,{"model-value":v.value,"onUpdate:modelValue":n[0]||(n[0]=c=>s(c))},{default:l(()=>[e(El,{value:"insc"},{default:l(()=>[...n[2]||(n[2]=[g("Inscriptions en attente",-1)])]),_:1}),e(El,{value:"doss"},{default:l(()=>[...n[3]||(n[3]=[g("Suivi des dossiers",-1)])]),_:1})]),_:1},8,["model-value"])]),_:1}),e(Ra,{"model-value":v.value},{default:l(()=>[e(Nl,{value:"insc"},{default:l(()=>[e(Dn,{onGoTo:$(_l),onEmpty:n[1]||(n[1]=c=>$(_l)())},null,8,["onGoTo"])]),_:1}),e(Nl,{value:"doss"},{default:l(()=>[e(fu,{"initial-dossier":a.value},null,8,["initial-dossier"])]),_:1})]),_:1},8,["model-value"])],64))}}),bu=K({__name:"PersonneEdit",props:{personne:{}},emits:["save"],setup(t,{emit:o}){const i=t,v=o,a=D(we(i.personne)),s=h(()=>!!(a.value.Nom&&a.value.Prenom));return(m,n)=>{const c=Oa,u=Ba,r=Ya,d=Ha,p=qa;return y(),w(O,{title:"Editer le profil"},{default:l(()=>[e(B,null,{default:l(()=>[e(za,null,{default:l(()=>[e(E,null,{default:l(()=>[e(k,null,{default:l(()=>[e(me,{autofocus:"","hide-details":"",label:"Nom",density:"compact",variant:"outlined",modelValue:a.value.Nom,"onUpdate:modelValue":n[0]||(n[0]=V=>a.value.Nom=V)},null,8,["modelValue"])]),_:1}),e(k,null,{default:l(()=>[e(me,{"hide-details":"",label:"Prénom",density:"compact",variant:"outlined",modelValue:a.value.Prenom,"onUpdate:modelValue":n[1]||(n[1]=V=>a.value.Prenom=V)},null,8,["modelValue"])]),_:1}),e(k,{cols:"3"},{default:l(()=>[e(c,{modelValue:a.value.Sexe,"onUpdate:modelValue":n[2]||(n[2]=V=>a.value.Sexe=V)},null,8,["modelValue"])]),_:1})]),_:1}),e(E,null,{default:l(()=>[e(k,null,{default:l(()=>[e(u,{modelValue:a.value.DateNaissance,"onUpdate:modelValue":n[3]||(n[3]=V=>a.value.DateNaissance=V)},null,8,["modelValue"])]),_:1}),e(k,null,{default:l(()=>[e(me,{"hide-details":"",label:"Ville de naissance",density:"compact",variant:"outlined",modelValue:a.value.VilleNaissance,"onUpdate:modelValue":n[4]||(n[4]=V=>a.value.VilleNaissance=V)},null,8,["modelValue"])]),_:1}),e(k,null,{default:l(()=>[e(r,{label:"Département de naissance",modelValue:a.value.DepartementNaissance,"onUpdate:modelValue":n[5]||(n[5]=V=>a.value.DepartementNaissance=V)},null,8,["modelValue"])]),_:1}),e(k,null,{default:l(()=>[e(d,{modelValue:a.value.Nationnalite,"onUpdate:modelValue":n[6]||(n[6]=V=>a.value.Nationnalite=V)},null,8,["modelValue"])]),_:1})]),_:1}),e(E,null,{default:l(()=>[e(k,null,{default:l(()=>[e(me,{"hide-details":"",label:"Adresse",density:"compact",variant:"outlined",modelValue:a.value.Adresse,"onUpdate:modelValue":n[7]||(n[7]=V=>a.value.Adresse=V)},null,8,["modelValue"])]),_:1}),e(k,null,{default:l(()=>[e(me,{"hide-details":"",label:"Code postal",density:"compact",variant:"outlined",modelValue:a.value.CodePostal,"onUpdate:modelValue":n[8]||(n[8]=V=>a.value.CodePostal=V)},null,8,["modelValue"])]),_:1}),e(k,null,{default:l(()=>[e(me,{"hide-details":"",label:"Ville",density:"compact",variant:"outlined",modelValue:a.value.Ville,"onUpdate:modelValue":n[9]||(n[9]=V=>a.value.Ville=V)},null,8,["modelValue"])]),_:1}),e(k,null,{default:l(()=>[e(p,{modelValue:a.value.Pays,"onUpdate:modelValue":n[10]||(n[10]=V=>a.value.Pays=V)},null,8,["modelValue"])]),_:1})]),_:1}),e(E,null,{default:l(()=>[e(k,null,{default:l(()=>[e(me,{"hide-details":"",label:"Mail",density:"compact",variant:"outlined",modelValue:a.value.Mail,"onUpdate:modelValue":n[11]||(n[11]=V=>a.value.Mail=V)},null,8,["modelValue"])]),_:1}),e(k,null,{default:l(()=>[e(rt,{label:"Téléphone",modelValue:a.value.Tels,"onUpdate:modelValue":n[12]||(n[12]=V=>a.value.Tels=V),formatter:a.value.Pays=="CH"?$(Ve).telCh:$(Ve).telFr},null,8,["modelValue","formatter"])]),_:1})]),_:1})]),_:1})]),_:1}),e(oe,null,{default:l(()=>[e(ie),e(L,{disabled:!s.value,onClick:n[13]||(n[13]=V=>v("save",a.value))},{default:l(()=>[...n[14]||(n[14]=[g("Enregistrer",-1)])]),_:1},8,["disabled"])]),_:1})]),_:1})}}}),gu=K({__name:"annuaire",setup(t){const o=ul(),i=h(()=>xu(o.currentRoute.value.query)),v=h(()=>i.value.idPersonne);Ae(()=>v.value,()=>v.value!==void 0?r(v.value):null,{immediate:!0});const a=D([]),s=D("");async function m(){if(!s.value)return;const d=await x.PersonnesGet({search:s.value});d!==void 0&&(a.value=d||[])}async function n(){const d=await x.PersonnesCreate();d!==void 0&&(x.showMessage("Profil créé avec succès."),a.value.push(d),We(d.Id))}const c=D(null);async function u(d){c.value=null;const p=await x.PersonnesUpdate(d);if(p===void 0)return;x.showMessage("Profil modifié avec succès."),We();const V=a.value.findIndex(A=>A.Id==d.Id);a.value[V]=p}async function r(d){const p=await x.PersonnesLoad({id:d});p!==void 0&&(c.value=p)}return(d,p)=>{const V=ut;return y(),z(le,null,[e(fl,{title:"Annuaire : personnes et organismes"}),e(O,{class:"my-2 mx-auto","max-width":"600px"},{append:l(()=>[e(L,{color:"green",onClick:n},{default:l(()=>[...p[2]||(p[2]=[g("Créer un nouveau profil",-1)])]),_:1})]),default:l(()=>[e(B,null,{default:l(()=>[e(E,null,{default:l(()=>[e(k,null,{default:l(()=>[e(V,{"prepend-inner-icon":"mdi-magnify",label:"Recherche",modelValue:s.value,"onUpdate:modelValue":[p[0]||(p[0]=A=>s.value=A),m]},null,8,["modelValue"]),e(ke,null,{default:l(()=>[(y(!0),z(le,null,ce(a.value,A=>(y(),w(H,{title:A.Label,subtitle:$(Ve).dateNaissance(A.DateNaissance),"prepend-icon":$(Ve).sexeIcon(A.Sexe),onClick:C=>$(We)(A.Id)},pl({_:2},[A.IsTemp?{name:"append",fn:l(()=>[e(ge,{"prepend-icon":"mdi-alert",color:"warning"},{default:l(()=>[...p[3]||(p[3]=[g(" Ce profil est temporaire et devrait être identifié. ",-1)])]),_:1})]),key:"0"}:void 0]),1032,["title","subtitle","prepend-icon","onClick"]))),256))]),_:1})]),_:1}),e(k)]),_:1})]),_:1}),c.value!=null?(y(),w(X,{key:0,"model-value":c.value!=null,"onUpdate:modelValue":p[1]||(p[1]=A=>{c.value=null,$(We)(void 0)}),"max-width":"1000px"},{default:l(()=>[e(bu,{personne:c.value,onSave:u},null,8,["personne"])]),_:1},8,["model-value"])):Q("",!0)]),_:1})],64)}}}),Vu=[{path:"/",component:Qa},{path:"/camps",component:xn},{path:"/inscriptions",component:yu},{path:"/annuaire",component:gu}],ku="/backoffice",el=_a({history:xa(ku),routes:Vu});el.onError((t,o)=>{t?.message?.includes?.("Failed to fetch dynamically imported module")?localStorage.getItem("vuetify:dynamic-reload")?console.error("Dynamic import error, reloading page did not fix it",t):(console.log("Reloading page to fix dynamic import error"),localStorage.setItem("vuetify:dynamic-reload","true"),location.assign(o.fullPath)):console.error(t)});el.isReady().then(()=>{localStorage.removeItem("vuetify:dynamic-reload")});function vl(t){return t?Number(t):void 0}function Cu(t){const o=t;return{idCamp:vl(o.idCamp),idParticipant:vl(o.idParticipant)}}function Dl(t){el.push({path:"/camps",query:{idCamp:t.IdCamp,idParticipant:t.Id}})}function _u(t){const o=t;return{tab:o.tab,idDossier:vl(o.idDossier)}}function _l(t){el.push({path:"/inscriptions",query:{tab:"doss",idDossier:t}})}function xu(t){return{idPersonne:vl(t.idPersonne)}}function We(t){el.push({path:"/annuaire",query:{idPersonne:t}})}const Pu=["innerHTML"],wu=K({__name:"App",setup(t){const o=gl({text:"",color:"secondary",action:void 0,timeout:4e3}),i=D(""),v=D("");return x.onError=(s,m)=>{i.value=s,v.value=m},x.showMessage=(s,m,n)=>{o.text=s,o.color=m||"success",o.action=n,o.timeout=1e4,o.timeout=4e3},ul().beforeEach(async(s,m)=>{if(!x.hasToken()&&s.path!=="/")return{path:"/"}}),(s,m)=>{const n=ba("router-view");return y(),w(Va,null,{default:l(()=>[e(ga,null,{default:l(()=>[e(n),e(hl,{style:{"z-index":"10000"},app:"","model-value":o.text!="","onUpdate:modelValue":m[1]||(m[1]=c=>o.text=""),timeout:o.timeout,color:o.color,location:"bottom left","close-on-content-click":""},{default:l(()=>[g(U(o.text)+" ",1),o.action?(y(),w(L,{key:0,onClick:m[0]||(m[0]=c=>o.action.action()),class:"ml-2"},{default:l(()=>[g(U(o.action.title),1)]),_:1})):Q("",!0)]),_:1},8,["model-value","timeout","color"]),e(hl,{app:"","model-value":i.value!="","onUpdate:modelValue":m[2]||(m[2]=c=>i.value=""),timeout:4e3,color:"red"},{default:l(()=>[R("b",null,U(i.value),1),R("div",{innerHTML:v.value},null,8,Pu)]),_:1},8,["model-value"])]),_:1})]),_:1})}}}),Vt=ka(wu);Vt.use(Ca).use(el);Vt.mount("#app");
