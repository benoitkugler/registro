import{d as W,c as Q,a as j,F as Z,b as e,w as l,V as Yl,e as b,f as Wl,g as $,h as V,i as Zl,t as S,r as Xl,j as z,o as f,k as P,l as E,m as T,n as se,p as hl,q as Oe,s as F,u as le,v as et,x as Se,y as we,z as x,A as J,B as ne,C as I,D as ve,E as ye,G as Ue,H as fe,I as ce,J as Ze,O as $l,K as De,L as Ce,S as lt,M as We,N as $e,P as tt,Q as at,R as nt,T as ut,U as al,W as nl,X as qe,Y as it,Z as st,_ as ul,$ as Ml,a0 as ot,a1 as il,a2 as rt,a3 as dt,a4 as Me,a5 as mt,a6 as Qe,a7 as dl,a8 as ml,a9 as pt,aa as vt,ab as ct,ac as pl,ad as Ae,ae as Fl,af as Vl,ag as El,ah as vl,ai as ft,aj as Vt,ak as bt,al as yt,am as bl,an as gt,ao as Ct,ap as _t,aq as xt,ar as yl,as as gl,at as Pt,au as wt,av as el,aw as kt,ax as Cl,ay as Dt,az as St,aA as _l,aB as It,aC as At,aD as Ut}from"./VSnackbar-DjTXu2vS.js";import{u as Je,c as $t,a as Mt}from"./vue-router-DhuRQqel.js";import{c as C,V as Ft,a as sl,_ as Ge,b as Et,d as Tt,i as xl,e as ol,f as Lt,g as Tl,h as Rt,j as Ke,k as Nt,l as Ot,m as qt,n as jt,o as Ll,p as Bt,q as Ht}from"./InscriptionRow.vue_vue_type_script_setup_true_lang-0TQ4wdQD.js";import{V as L,a as h,b as te,c as Le,d as me,e as de,f as Fe,g as ke,h as Pl,i as Rl,j as Nl,k as Ol}from"./VSelect-CQ7zLifY.js";import{_ as je,a as zt,V as ql,b as Qt,c as Jt,d as wl,e as kl}from"./VTabs-CFILxdlJ.js";import{_ as Be}from"./MontantField.vue_vue_type_script_setup_true_lang-CYt-FEBp.js";import{_ as jl,V as Gt,a as Kt}from"./ModePaiementField.vue_vue_type_script_setup_true_lang-BirtaBIj.js";import{V as Y}from"./VDialog-nMpKnxn7.js";import{V as Te}from"./VTooltip-IA12wETG.js";import{V as Dl}from"./VCombobox-CxHbsS3S.js";import{V as Xe}from"./VTextarea-BiqIEbJy.js";import{V as Yt}from"./VAlert-BeNrVbyd.js";import{V as Wt,_ as Zt}from"./EventSwitch.vue_vue_type_script_setup_true_lang-Dd0YE7Yq.js";import{V as Sl,m as Xt}from"./VPicker-BteX4UTw.js";import{_ as Bl}from"./_plugin-vue_export-helper-DlAUqK2U.js";import{_ as Hl,a as ht,b as ea,c as la}from"./SexeField.vue_vue_type_script_setup_true_lang-D-m1ETBI.js";import{_ as ta}from"./FilesRow.vue_vue_type_script_setup_true_lang-SueMgL26.js";import{_ as aa}from"./NationaliteField.vue_vue_type_script_setup_true_lang-o_WMkowJ.js";import{_ as na}from"./DepartementField.vue_vue_type_script_setup_true_lang-CR7nP5-l.js";import{V as ua}from"./VForm-DMgsgxDF.js";import"./filter-Tl1Ck8H0.js";import"./VWindowItem-jd4WVZkp.js";import"./VSheet-B9YKrkqe.js";import"./FileCard.vue_vue_type_script_setup_true_lang-B8kS8t68.js";const ll=W({__name:"NavBar",props:{title:{},hideMenu:{type:Boolean}},setup(u){const v="/static/repere/logo.png",i="v0.8.1",p=u,t=Q(()=>C.isFondsSoutien);return(s,d)=>(f(),j(Z,null,[e(Ft,{app:"","model-value":!p.hideMenu,"expand-on-hover":"",permanent:"",rail:""},{append:l(()=>[e(L,{"prepend-icon":"mdi-account-circle-outline",title:t.value?"Fonds de soutien":"Administrateur"},null,8,["title"]),e(L,{"prepend-icon":"mdi-logout",link:"",to:{path:"/"},color:"primary"},{default:l(()=>[...d[3]||(d[3]=[b(" Se déconnecter ",-1)])]),_:1})]),default:l(()=>[e(L,{"prepend-icon":"mdi-menu",title:`Registro ${i}`},null,8,["title"]),e(h),e(L,{"prepend-icon":"mdi-bed",link:"",to:{path:"/camps"},color:"primary"},{default:l(()=>[...d[0]||(d[0]=[b(" Séjours ",-1)])]),_:1}),e(L,{"prepend-icon":"mdi-calendar-multiple-check",link:"",to:{path:"/inscriptions"},color:"primary"},{default:l(()=>[...d[1]||(d[1]=[b(" Inscriptions ",-1)])]),_:1}),e(h),e(L,{"prepend-icon":"mdi-account-multiple",link:"",to:{path:"/annuaire"},color:"primary"},{default:l(()=>[...d[2]||(d[2]=[b(" Annuaire ",-1)])]),_:1}),e(h)]),_:1},8,["model-value"]),e(Yl,{rounded:"",elevation:"4",color:"secondary"},{append:l(()=>[Xl(s.$slots,"default"),d[4]||(d[4]=z("div",{class:"mr-2"},null,-1))]),default:l(()=>[e(Wl,null,{default:l(()=>[e($,null,{default:l(()=>[e(V,{"align-self":"center",cols:"auto"},{default:l(()=>[e(Zl,{width:"60",src:v})]),_:1}),e(V,{"align-self":"center"},{default:l(()=>[b(S(p.title),1)]),_:1})]),_:1})]),_:1})]),_:3})],64))}}),ia=W({__name:"index",setup(u){const v=Je(),i=P(!1),p=P(""),t=P([]);async function s(){const d=await C.Loggin({password:p.value});d!==void 0&&(d.IsValid?(C.setToken(d.Token,d.IsFondSoutien),C.showMessage("Bienvenue !"),v.push({path:"/inscriptions"})):t.value=["Clé de connection incorrecte."])}return(d,a)=>(f(),j(Z,null,[e(ll,{title:"Connection au backoffice","hide-menu":""}),e(et,{class:"fill-height"},{default:l(()=>[e(E,{class:"mx-auto",width:"400px"},{default:l(()=>[e(T,null,{default:l(()=>[e(se,{label:"Clé de connection",modelValue:p.value,"onUpdate:modelValue":a[1]||(a[1]=m=>p.value=m),"error-messages":t.value,type:i.value?void 0:"password",name:"password",onKeydown:a[2]||(a[2]=hl(Oe(()=>p.value.length==0?null:s(),["prevent"]),["enter"]))},{"append-inner":l(()=>[e(F,{class:"ml-2",size:"small",icon:i.value?"mdi-eye":"mdi-eye-off",flat:"",onClick:a[0]||(a[0]=m=>i.value=!i.value)},null,8,["icon"])]),_:1},8,["modelValue","error-messages","type"])]),_:1}),e(le,null,{default:l(()=>[e(te),e(F,{disabled:!p.value.length,onClick:s},{default:l(()=>[...a[3]||(a[3]=[b("Se connecter",-1)])]),_:1},8,["disabled"])]),_:1})]),_:1})]),_:1})],64))}}),cl=W({__name:"BoolField",props:Se({label:{},hideDetails:{type:Boolean},readonly:{type:Boolean},density:{},persistentHint:{type:Boolean},hint:{}},{modelValue:{type:Boolean,required:!0},modelModifiers:{}}),emits:["update:modelValue"],setup(u){const v=u,i=we(u,"modelValue");return(p,t)=>(f(),x(Le,{label:v.label,"model-value":i.value,"onUpdate:modelValue":t[0]||(t[0]=s=>i.value=s||!1),"hide-details":v.hideDetails,readonly:v.readonly,density:v.density,"persistent-hint":v.persistentHint,hint:v.hint},null,8,["label","model-value","hide-details","readonly","density","persistent-hint","hint"]))}}),sa=W({__name:"OptionStatut",props:Se({camp:{}},{modelValue:{required:!0},modelModifiers:{}}),emits:["update:modelValue"],setup(u){const v=u,i=we(u,"modelValue");function p(){const d=i.value?.length?i.value.map(n=>n.Id):[0],m={Id:Math.max(...d)+1,Label:"",Description:"",Prix:v.camp.Prix.Cent};i.value=(i.value||[]).concat(m),t.value=m}const t=P(null);function s(d){i.value=(i.value||[]).filter(a=>a.Id!=d.Id)}return(d,a)=>{const m=Be;return f(),x(E,{subtitle:"Le prix dépend du statut du participant, à choisir parmi la liste ci-dessous."},{append:l(()=>[e(F,{icon:"",size:"x-small",onClick:p},{default:l(()=>[e(ye,{color:"green"},{default:l(()=>[...a[4]||(a[4]=[b("mdi-plus",-1)])]),_:1})]),_:1})]),default:l(()=>[t.value!=null?(f(),x(Y,{key:0,"model-value":t.value!=null,"onUpdate:modelValue":a[3]||(a[3]=n=>t.value=null),"max-width":"500px"},{default:l(()=>[e(E,{title:"Modifier le statut"},{default:l(()=>[e(T,null,{default:l(()=>[e($,null,{default:l(()=>[e(V,{cols:"12"},{default:l(()=>[e(se,{autofocus:"",label:"Statut",modelValue:t.value.Label,"onUpdate:modelValue":a[0]||(a[0]=n=>t.value.Label=n),density:"compact",variant:"outlined","hide-details":""},null,8,["modelValue"])]),_:1}),e(V,{cols:"12"},{default:l(()=>[e(se,{label:"Description",modelValue:t.value.Description,"onUpdate:modelValue":a[1]||(a[1]=n=>t.value.Description=n),density:"compact",variant:"outlined","hide-details":""},null,8,["modelValue"])]),_:1}),e(V,{cols:"12"},{default:l(()=>[e(m,{"model-value":{Cent:t.value.Prix,Currency:v.camp.Prix.Currency},"onUpdate:modelValue":a[2]||(a[2]=n=>t.value.Prix=n.Cent),label:"Prix","readonly-currency":""},null,8,["model-value"])]),_:1})]),_:1})]),_:1})]),_:1})]),_:1},8,["model-value"])):J("",!0),e(T,{class:"py-0"},{default:l(()=>[e(me,null,{default:l(()=>[i.value?.length?J("",!0):(f(),x(L,{key:0},{default:l(()=>[...a[5]||(a[5]=[z("i",null,"Aucun statut n'est encore défini.",-1)])]),_:1})),(f(!0),j(Z,null,ne(i.value,n=>(f(),x(L,{title:n.Label,subtitle:n.Description,onClick:r=>t.value=n},{append:l(()=>[e($,null,{default:l(()=>[e(V,{"align-self":"center"},{default:l(()=>[e(de,null,{default:l(()=>[b(S(I(ve).montant({Cent:n.Prix,Currency:u.camp.Prix.Currency})),1)]),_:2},1024)]),_:2},1024),e(V,{"align-self":"center",cols:"auto"},{default:l(()=>[e(F,{icon:"",size:"x-small",class:"my-1",onClick:Oe(r=>s(n),["stop"])},{default:l(()=>[e(ye,{color:"red"},{default:l(()=>[...a[6]||(a[6]=[b("mdi-delete",-1)])]),_:1})]),_:1},8,["onClick"])]),_:2},1024)]),_:2},1024)]),_:2},1032,["title","subtitle","onClick"]))),256))]),_:1})]),_:1})]),_:1})}}}),oa=W({__name:"OptionJournee",props:Se({camp:{}},{modelValue:{required:!0},modelModifiers:{}}),emits:["update:modelValue"],setup(u){const v=u,i=we(u,"modelValue");Ue(()=>i.value,p,{immediate:!0});function p(){const s=v.camp.Duree;i.value?.length!=s&&(i.value=Array.from({length:s}).map(d=>0))}function t(){const s=i.value,d=s[0];for(let a=0;a<s.length;a++)s[a]=d}return(s,d)=>{const a=Be;return f(),x(E,{subtitle:"Le prix est variable en fonction des jours de participation au camp."},{append:l(()=>[e(Te,{text:"Appliquer le prix du premier jour à tous."},{activator:l(({props:m})=>[e(F,fe(m,{icon:"mdi-arrow-expand",size:"x-small",disabled:!(i.value||[])[0],onClick:t}),null,16,["disabled"])]),_:1})]),default:l(()=>[e(T,null,{default:l(()=>[e($,null,{default:l(()=>[(f(!0),j(Z,null,ne(i.value,(m,n)=>(f(),x(V,{cols:"3"},{default:l(()=>[e(a,{label:`Jour ${n+1}`,"model-value":{Cent:m,Currency:v.camp.Prix.Currency},"onUpdate:modelValue":r=>i.value[n]=r.Cent,"readonly-currency":""},null,8,["label","model-value","onUpdate:modelValue"])]),_:2},1024))),256))]),_:1})]),_:1})]),_:1})}}}),ra={key:0,class:"text-center"},da=W({__name:"CampOptionsPrix",props:Se({camp:{}},{optionPrix:{required:!0},optionPrixModifiers:{},optionQf:{required:!0},optionQfModifiers:{}}),emits:["update:optionPrix","update:optionQf"],setup(u){const v=u,i=we(u,"optionPrix"),p=we(u,"optionQf"),t=Q(()=>ce.isQuotientFamilialActive(p.value)),s=Ze($l);return(d,a)=>{const m=je;return f(),x(E,{title:"Options sur le prix",subtitle:"Permet de modifier le prix de base du séjour",width:"1000px"},{default:l(()=>[e(T,null,{default:l(()=>[e($,null,{default:l(()=>[e(V,{"align-self":"center"},{default:l(()=>[e(Le,{"model-value":t.value,"onUpdate:modelValue":a[0]||(a[0]=n=>p.value[3]=n?100:0),"hide-details":"",label:"Prix au quotient familial"},null,8,["model-value"])]),_:1}),e(V,{"align-self":"center"},{default:l(()=>[e(m,{suffix:"%",min:0,max:100,disabled:!t.value,"hide-details":"","readonly-currency":"",label:"entre 1 et 359",modelValue:p.value[0],"onUpdate:modelValue":a[1]||(a[1]=n=>p.value[0]=n)},null,8,["disabled","modelValue"])]),_:1}),e(V,{"align-self":"center"},{default:l(()=>[e(m,{suffix:"%",min:0,max:100,disabled:!t.value,"hide-details":"","readonly-currency":"",label:"entre 360 et 564",modelValue:p.value[1],"onUpdate:modelValue":a[2]||(a[2]=n=>p.value[1]=n)},null,8,["disabled","modelValue"])]),_:1}),e(V,{"align-self":"center"},{default:l(()=>[e(m,{suffix:"%",min:0,max:100,disabled:!t.value,"hide-details":"","readonly-currency":"",label:"entre 565 et 714",modelValue:p.value[2],"onUpdate:modelValue":a[3]||(a[3]=n=>p.value[2]=n)},null,8,["disabled","modelValue"])]),_:1}),e(V,{"align-self":"center"},{default:l(()=>[e(m,{suffix:"%",min:0,max:100,disabled:!0,"hide-details":"","readonly-currency":"",label:"plus de 715",modelValue:p.value[3],"onUpdate:modelValue":a[4]||(a[4]=n=>p.value[3]=n)},null,8,["modelValue"])]),_:1})]),_:1}),e(h,{thickness:"1",class:"my-2"}),e($,{class:"my-2"},{default:l(()=>[e(V,{"align-self":"center",cols:"4"},{default:l(()=>[e(Fe,{variant:"outlined",density:"comfortable","hide-details":"",items:I(s),label:"Option sur le prix",modelValue:i.value.Active,"onUpdate:modelValue":a[5]||(a[5]=n=>i.value.Active=n)},null,8,["items","modelValue"])]),_:1}),e(V,{"align-self":"center"},{default:l(()=>[i.value.Active==I(De).NoOption?(f(),j("div",ra,[...a[8]||(a[8]=[z("i",null,"Aucune modification sur le prix de base.",-1)])])):i.value.Active==I(De).PrixStatut?(f(),x(sa,{key:1,camp:v.camp,modelValue:i.value.Statuts,"onUpdate:modelValue":a[6]||(a[6]=n=>i.value.Statuts=n)},null,8,["camp","modelValue"])):i.value.Active==I(De).PrixJour?(f(),x(oa,{key:2,camp:v.camp,modelValue:i.value.Jours,"onUpdate:modelValue":a[7]||(a[7]=n=>i.value.Jours=n)},null,8,["camp","modelValue"])):J("",!0)]),_:1})]),_:1})]),_:1})]),_:1})}}}),ma=W({__name:"CampMetaEdit",props:Se({metaEntriesHints:{}},{modelValue:{required:!0},modelModifiers:{}}),emits:["update:modelValue"],setup(u){const v=u,i=we(u,"modelValue"),p=P(Object.entries(i.value||{}));function t(){const s=Object.fromEntries(p.value);i.value=s}return Q(()=>{const s=p.value.map(a=>a[0]);return s.includes("")?!0:new Set(s).size!=p.value.length}),(s,d)=>(f(),x(E,{subtitle:"Métadonnées exposées sur l'API publique"},{append:l(()=>[e(F,{size:"small",class:"ml-2",onClick:d[0]||(d[0]=a=>{p.value.push(["",""]),t()})},{prepend:l(()=>[e(ye,{color:"green"},{default:l(()=>[...d[1]||(d[1]=[b("mdi-plus",-1)])]),_:1})]),default:l(()=>[d[2]||(d[2]=b(" Ajouter une valeur",-1))]),_:1})]),default:l(()=>[e(T,{class:"pt-2"},{default:l(()=>[(f(!0),j(Z,null,ne(p.value,(a,m)=>(f(),x($,null,{default:l(()=>[e(V,{cols:"4"},{default:l(()=>[e(Dl,{variant:"outlined",density:"compact","hide-details":"",label:"Clé",modelValue:a[0],"onUpdate:modelValue":[n=>a[0]=n,t],autofocus:"",items:v.metaEntriesHints.keys},null,8,["modelValue","onUpdate:modelValue","items"])]),_:2},1024),e(V,null,{default:l(()=>[e(Dl,{variant:"outlined",density:"compact","hide-details":"",label:"Valeur",modelValue:a[1],"onUpdate:modelValue":[n=>a[1]=n,t],items:v.metaEntriesHints.values},null,8,["modelValue","onUpdate:modelValue","items"])]),_:2},1024),e(V,{cols:"auto"},{default:l(()=>[e(F,{icon:"",size:"small",flat:"",onClick:n=>{p.value.splice(m,1),t()}},{default:l(()=>[e(ye,{color:"red"},{default:l(()=>[...d[3]||(d[3]=[b("mdi-close",-1)])]),_:1})]),_:1},8,["onClick"])]),_:2},1024)]),_:2},1024))),256))]),_:1})]),_:1}))}}),pa=W({__name:"CampEdit",props:{camp:{},preselectionUrl:{},metaEntriesHints:{}},emits:["save"],setup(u,{emit:v}){const i=u,p=v,t=P(Ce(i.camp)),s=Q(()=>new Date(t.value.DateDebut).getFullYear()>=2020&&t.value.Places>=1&&t.value.Nom!=""&&t.value.AgeMax>=t.value.AgeMin&&t.value.OptionQuotientFamilial.every(n=>0<=n&&n<=100)&&!(t.value.OptionPrix.Active==De.PrixStatut&&!t.value.OptionPrix.Statuts?.length)&&!(t.value.OptionPrix.Active==De.PrixJour&&t.value.OptionPrix.Jours?.length!=t.value.Duree)),d=Ze(lt);function a(n){const r=ce.isQuotientFamilialActive(n.OptionQuotientFamilial),o=n.OptionPrix.Active!=De.NoOption;if(!r&&!o)return"Aucune";const c=[];return ce.isQuotientFamilialActive(n.OptionQuotientFamilial)&&c.push("Quotient familial"),n.OptionPrix.Active!=De.NoOption&&c.push($l[n.OptionPrix.Active]),c.join(", ")}async function m(){await We(i.preselectionUrl),C.showMessage("URL copiée dans le presse-papier.")}return(n,r)=>{const o=jl,c=je,g=Be,M=cl;return f(),x(E,{title:"Paramètres du séjour",subtitle:I(ce).label(i.camp)},{default:l(()=>[e(T,null,{default:l(()=>[e(E,{class:"my-2",subtitle:"Général"},{default:l(()=>[e(T,null,{default:l(()=>[e($,null,{default:l(()=>[e(V,null,{default:l(()=>[e(se,{autofocus:"","hide-details":"",label:"Nom",density:"compact",variant:"outlined",modelValue:t.value.Nom,"onUpdate:modelValue":r[0]||(r[0]=k=>t.value.Nom=k)},null,8,["modelValue"])]),_:1}),e(V,null,{default:l(()=>[e(se,{"hide-details":"",label:"Lieu",density:"compact",variant:"outlined",modelValue:t.value.Lieu,"onUpdate:modelValue":r[1]||(r[1]=k=>t.value.Lieu=k)},null,8,["modelValue"])]),_:1}),e(V,null,{default:l(()=>[e(se,{"hide-details":"",label:"Numéro d'agrément",density:"compact",variant:"outlined",modelValue:t.value.Agrement,"onUpdate:modelValue":r[2]||(r[2]=k=>t.value.Agrement=k)},null,8,["modelValue"])]),_:1})]),_:1}),e($,null,{default:l(()=>[e(V,{"align-self":"center"},{default:l(()=>[e(o,{modelValue:t.value.DateDebut,"onUpdate:modelValue":r[3]||(r[3]=k=>t.value.DateDebut=k),label:"Date de début","hide-details":""},null,8,["modelValue"])]),_:1}),e(V,{"align-self":"center"},{default:l(()=>[e(c,{label:"Durée (en jours)",modelValue:t.value.Duree,"onUpdate:modelValue":r[4]||(r[4]=k=>t.value.Duree=k),"hide-details":""},null,8,["modelValue"])]),_:1}),e(V,{"align-self":"center"},{default:l(()=>[e(o,{"model-value":I(ce).dateFin(t.value),label:"Date de fin",readonly:"","hide-details":""},null,8,["model-value"])]),_:1})]),_:1})]),_:1})]),_:1}),e(E,{class:"my-2",subtitle:"Prix"},{default:l(()=>[e(T,null,{default:l(()=>[e($,null,{default:l(()=>[e(V,{"align-self":"center",cols:"6"},{default:l(()=>[e(g,{label:"Prix",modelValue:t.value.Prix,"onUpdate:modelValue":r[5]||(r[5]=k=>t.value.Prix=k),"hide-details":""},null,8,["modelValue"])]),_:1}),e(V,{"align-self":"center",cols:"6",class:"text-center"},{default:l(()=>[e(ke,{"close-on-content-click":!1},{activator:l(({props:k})=>[e(se,fe(k,{readonly:"",label:"Option sur le prix",variant:"outlined",density:"compact","hide-details":"","model-value":a(t.value)}),null,16,["model-value"])]),default:l(()=>[e(da,{camp:t.value,"option-prix":t.value.OptionPrix,"onUpdate:optionPrix":r[6]||(r[6]=k=>t.value.OptionPrix=k),"option-qf":t.value.OptionQuotientFamilial,"onUpdate:optionQf":r[7]||(r[7]=k=>t.value.OptionQuotientFamilial=k)},null,8,["camp","option-prix","option-qf"])]),_:1})]),_:1})]),_:1})]),_:1})]),_:1}),e(E,{class:"my-2",subtitle:"Visibilité et inscriptions"},{default:l(()=>[e(T,null,{default:l(()=>[e($,null,{default:l(()=>[e(V,{"align-self":"center"},{default:l(()=>[e(Fe,{label:"Ouverture aux inscriptions",variant:"outlined",density:"compact",items:I(d),"hide-details":"",modelValue:t.value.Statut,"onUpdate:modelValue":r[8]||(r[8]=k=>t.value.Statut=k)},null,8,["items","modelValue"])]),_:1}),e(V,{"align-self":"center"},{default:l(()=>[e(sl,{label:"Inscription externe",modelValue:t.value.InscriptionExterne,"onUpdate:modelValue":r[9]||(r[9]=k=>t.value.InscriptionExterne=k),color:"primary",density:"compact","persistent-hint":"",hint:t.value.InscriptionExterne?"Camp externe, uniquement visible sur l'API publique.":""},null,8,["modelValue","hint"])]),_:1})]),_:1})]),_:1})]),_:1}),e(E,{class:"my-2",subtitle:"Filtres sur les inscrits"},{default:l(()=>[e(T,null,{default:l(()=>[e($,null,{default:l(()=>[e(V,{"align-self":"center"},{default:l(()=>[e(c,{modelValue:t.value.Places,"onUpdate:modelValue":r[10]||(r[10]=k=>t.value.Places=k),label:"Nombre de places"},null,8,["modelValue"])]),_:1}),e(V,{"align-self":"center"},{default:l(()=>[e(c,{modelValue:t.value.AgeMin,"onUpdate:modelValue":r[11]||(r[11]=k=>t.value.AgeMin=k),label:"Âge minimum"},null,8,["modelValue"])]),_:1}),e(V,{"align-self":"center"},{default:l(()=>[e(c,{modelValue:t.value.AgeMax,"onUpdate:modelValue":r[12]||(r[12]=k=>t.value.AgeMax=k),label:"Âge maximum"},null,8,["modelValue"])]),_:1})]),_:1}),e($,null,{default:l(()=>[e(V,null,{default:l(()=>[e(M,{modelValue:t.value.NeedEquilibreGF,"onUpdate:modelValue":r[13]||(r[13]=k=>t.value.NeedEquilibreGF=k),label:"Equilibre G/F demandé",density:"compact","persistent-hint":"",hint:"Place un inscrit en liste d'attente en cas de déséquilibre Garçons/Filles"},null,8,["modelValue"])]),_:1})]),_:1})]),_:1})]),_:1}),e(E,{class:"my-2",subtitle:"Formulaire d'inscription"},{default:l(()=>[e(T,null,{default:l(()=>[e($,null,{default:l(()=>[e(V,null,{default:l(()=>[e(se,{label:"Image",density:"compact",variant:"outlined",hint:"URL d'une image affichée sur le formulaire d'inscription","persistent-hint":"",modelValue:t.value.ImageURL,"onUpdate:modelValue":r[14]||(r[14]=k=>t.value.ImageURL=k)},null,8,["modelValue"])]),_:1})]),_:1}),e($,null,{default:l(()=>[e(V,null,{default:l(()=>[e(Xe,{variant:"outlined",density:"compact",label:"Description",hint:"Ce texte est affiché sur le formulaire d'inscription.","persistent-hint":"",rows:"3",modelValue:t.value.Description,"onUpdate:modelValue":r[15]||(r[15]=k=>t.value.Description=k)},null,8,["modelValue"])]),_:1}),e(V,{cols:"2"},{default:l(()=>[e(M,{label:"Navette",modelValue:t.value.Navette.Actif,"onUpdate:modelValue":r[16]||(r[16]=k=>t.value.Navette.Actif=k)},null,8,["modelValue"])]),_:1}),e(V,null,{default:l(()=>[e(Xe,{variant:"outlined",density:"compact",label:"Navette",hint:"Ce texte est affiché sur l'espace personnel de suivi.","persistent-hint":"",rows:"3",disabled:!t.value.Navette.Actif,modelValue:t.value.Navette.Commentaire,"onUpdate:modelValue":r[17]||(r[17]=k=>t.value.Navette.Commentaire=k)},null,8,["disabled","modelValue"])]),_:1})]),_:1}),e($,null,{default:l(()=>[e(V,null,{default:l(()=>[e(se,{density:"compact",variant:"outlined",label:"URL de préselection",hint:"Cette URL permet de sélectionner automatiquement le séjour sur le formulaire d'inscription.","persistent-hint":"",readonly:"","model-value":i.preselectionUrl},{append:l(()=>[e(F,{icon:"mdi-content-copy",size:"small",onClick:m})]),_:1},8,["model-value"])]),_:1})]),_:1})]),_:1})]),_:1}),e(E,{class:"my-2",subtitle:"Autre"},{default:l(()=>[e(T,null,{default:l(()=>[e($,null,{default:l(()=>[e(V,null,{default:l(()=>[e(se,{label:"Mot de passe",density:"compact",variant:"outlined",hint:"Mot de passe d'accès à la page Directeur","persistent-hint":"",modelValue:t.value.Password,"onUpdate:modelValue":r[18]||(r[18]=k=>t.value.Password=k)},null,8,["modelValue"])]),_:1})]),_:1})]),_:1})]),_:1}),e(ma,{"meta-entries-hints":u.metaEntriesHints,modelValue:t.value.Meta,"onUpdate:modelValue":r[19]||(r[19]=k=>t.value.Meta=k)},null,8,["meta-entries-hints","modelValue"])]),_:1}),e(le,null,{default:l(()=>[e(te),e(F,{disabled:!s.value,onClick:r[20]||(r[20]=k=>p("save",t.value))},{default:l(()=>[...r[21]||(r[21]=[b("Enregistrer",-1)])]),_:1},8,["disabled"])]),_:1})]),_:1},8,["subtitle"])}}}),Il=W({__name:"TauxSelect",props:{modelValue:{required:!0},modelModifiers:{}},emits:["update:modelValue"],setup(u){$e(s);const v=we(u,"modelValue"),i=P(null),p=Q(()=>{const n=Array.from(t.value.values()).map(r=>({title:r.Label,value:r.Id}));return n.sort((r,o)=>r.title.localeCompare(o.title)),n}),t=P(new Map);async function s(){const n=await C.CampsGetTaux();n!==void 0&&(t.value=tt(n),v.value.Id>0&&(v.value=Ce(t.value.get(v.value.Id)),i.value=v.value.Id))}function d(){v.value.Id<=0?(i.value==null&&(i.value=1),v.value=Ce(t.value.get(i.value))):(i.value=null,v.value.Id=0,v.value.Label="")}function a(n){v.value=Ce(t.value.get(n))}const m=Q(()=>{if(v.value.Id>0)return null;const n=v.value.Label;return Array.from(t.value.values()).map(o=>o.Label).includes(n)?"Ce label est déjà utilisé.":null});return(n,r)=>(f(),x($,null,{default:l(()=>[e(V,{"align-self":"center"},{default:l(()=>[v.value.Id>0?(f(),x(Fe,{key:0,variant:"outlined",density:"compact","hide-details":"",label:"Taux",items:p.value,modelValue:i.value,"onUpdate:modelValue":[r[0]||(r[0]=o=>i.value=o),a]},null,8,["items","modelValue"])):(f(),x($,{key:1},{default:l(()=>[e(V,{cols:"12"},{default:l(()=>[e(se,{variant:"outlined",density:"compact",label:"Label",modelValue:v.value.Label,"onUpdate:modelValue":r[1]||(r[1]=o=>v.value.Label=o),disabled:v.value.Id>0,"error-messages":m.value},null,8,["modelValue","disabled","error-messages"])]),_:1}),e(V,null,{default:l(()=>[e(se,{label:`Valeur d'un ${I(nt)[I(ut).FrancsSuisse]}`,density:"compact",variant:"outlined",type:"number",min:"0.001",suffix:"€",hint:"Valeur en € d'une unité de la monnaie.","persistent-hint":"","model-value":v.value.FrancsSuisse/1e3,"onUpdate:modelValue":r[2]||(r[2]=o=>v.value.FrancsSuisse=I(at)(Number(o)*1e3)),disabled:v.value.Id>0},null,8,["label","model-value","disabled"])]),_:1})]),_:1}))]),_:1}),e(V,{cols:"auto"},{default:l(()=>[e(h,{thickness:"2",vertical:"",class:"py-4"},{default:l(()=>[...r[3]||(r[3]=[b("ou",-1)])]),_:1})]),_:1}),e(V,{"align-self":"center",cols:"auto"},{default:l(()=>[e(F,{onClick:d,"prepend-icon":"mdi-toggle-switch"},{default:l(()=>[b(S(v.value.Id>0?"Créer un taux":"Utiliser un taux"),1)]),_:1})]),_:1})]),_:1}))}}),va=W({__name:"CampStats",props:{stats:{}},setup(u){const v=u;function i(p,t){return`(${ve.pourcent(p,t)} %)`}return(p,t)=>(f(),x(E,{title:"Statut des inscriptions"},{default:l(()=>[e(T,null,{default:l(()=>[e(me,{density:"compact"},{default:l(()=>[e(L,{title:"Demandes d'inscriptions"},{append:l(()=>[b(S(v.stats.Inscriptions),1)]),_:1}),e(L,{title:"Filles",subtitle:"Parmi toutes les demandes d'inscription"},{append:l(()=>[b(S(v.stats.InscriptionsFilles)+" "+S(i(v.stats.InscriptionsFilles,v.stats.Inscriptions)),1)]),_:1}),e(L,{title:"Suisses",subtitle:"Parmi toutes les demandes d'inscription"},{append:l(()=>[b(S(v.stats.InscriptionsSuisses)+" "+S(i(v.stats.InscriptionsSuisses,v.stats.Inscriptions)),1)]),_:1}),e(L,{title:"Inscriptions confirmées"},{append:l(()=>[b(S(v.stats.Valides)+" "+S(i(v.stats.Valides,v.stats.Inscriptions)),1)]),_:1}),e(L,{title:"Filles",subtitle:"Parmi les inscriptions confirmées"},{append:l(()=>[b(S(v.stats.ValidesFilles)+" "+S(i(v.stats.ValidesFilles,v.stats.Valides)),1)]),_:1}),e(L,{title:"Suisses",subtitle:"Parmi les inscriptions confirmées"},{append:l(()=>[b(S(v.stats.ValidesSuisses)+" "+S(i(v.stats.ValidesSuisses,v.stats.Valides)),1)]),_:1}),e(L,{title:"A statuer"},{append:l(()=>[b(S(v.stats.AStatuer)+" "+S(i(v.stats.AStatuer,v.stats.Inscriptions)),1)]),_:1}),e(L,{title:"Demandes d'exception"},{append:l(()=>[b(S(v.stats.Exceptions)+" "+S(i(v.stats.Exceptions,v.stats.Inscriptions)),1)]),_:1}),e(L,{title:"Refus"},{append:l(()=>[b(S(v.stats.Refus)+" "+S(i(v.stats.Refus,v.stats.Inscriptions)),1)]),_:1})]),_:1})]),_:1})]),_:1}))}}),ca={key:0},fa=W({__name:"CampHeaderRow",props:{camp:{}},emits:["click","edit","edit-taux","delete","show-documents","send-sondage","add-directeur"],setup(u,{emit:v}){const i=u,p=v,t=Q(()=>i.camp.Stats.Inscriptions-i.camp.Stats.Valides),s=P(!1),d=Q(()=>{switch(new Date(i.camp.Camp.Camp.DateDebut).getUTCMonth()+1){case 7:case 8:return"rgb(45, 185, 187)";case 9:case 10:case 11:return"rgb(190, 150, 60)";case 12:case 1:case 2:case 3:return"rgb(240, 240, 240)";case 4:case 5:case 6:default:return"rgb(190, 228, 100)"}}),a=P(!1),m=P(0),n=Q(()=>{const r=i.camp.ParticipantsFiles||[];if(r.length==0)return 0;let o=0;for(const c of r)c.InscritsCount!=0&&(o+=c.UploadedCount/c.InscritsCount);return Math.round(o/r.length*100)});return(r,o)=>{const c=Ge;return f(),j(Z,null,[e(E,{color:d.value,"no-gutters":"",onClick:o[6]||(o[6]=g=>p("click")),class:"my-1"},{default:l(()=>[e($,{style:al({"background-color":d.value}),class:"px-1","no-gutters":"",justify:"space-between"},{default:l(()=>[e(V,null,{default:l(()=>[e(L,{title:I(ce).label(i.camp.Camp.Camp),subtitle:`ID : ${i.camp.Camp.Camp.Id}`},null,8,["title","subtitle"])]),_:1}),e(V,{"align-self":"center"},{default:l(()=>[b(S(I(ce).formatPlage(u.camp.Camp.Camp)),1)]),_:1}),e(V,{cols:"2","align-self":"center"},{default:l(()=>[e(Te,{width:"450px",location:"left","content-class":"pa-0"},{activator:l(({props:g})=>[e(nl,fe({class:"bg-white border-md border-primary"},g,{max:i.camp.Camp.Camp.Places,"model-value":i.camp.Stats.Valides,height:"36",rounded:"",color:"primary"}),{default:l(()=>[z("strong",null,[b(S(i.camp.Stats.Valides)+"/"+S(i.camp.Camp.Camp.Places)+" ",1),t.value>0?(f(),j("span",ca," (+ "+S(t.value)+")",1)):J("",!0)]),e(ye,{class:"ml-2"},{default:l(()=>[...o[12]||(o[12]=[b("mdi-account-multiple",-1)])]),_:1})]),_:1},16,["max","model-value"])]),default:l(()=>[e(va,{stats:i.camp.Stats},null,8,["stats"])]),_:1})]),_:1}),e(V,{cols:"1","align-self":"center",class:"px-2"},{default:l(()=>[e(Te,{width:"600",location:"left","content-class":"pa-0"},{activator:l(({props:g})=>[e(nl,fe({class:"bg-white border-md border-primary"},g,{max:100,"model-value":n.value,height:"36",rounded:"",color:"primary"}),{default:l(()=>[z("strong",null,S(n.value)+" % ",1),e(ye,{class:"ml-2"},{default:l(()=>[...o[13]||(o[13]=[b("mdi-file-upload",-1)])]),_:1})]),_:1},16,["model-value"])]),default:l(()=>[e(E,{title:"Pièces justificatives"},{default:l(()=>[e(T,null,{default:l(()=>[e(me,null,{default:l(()=>[(f(!0),j(Z,null,ne(i.camp.ParticipantsFiles,g=>(f(),x(L,{title:g.Title},{append:l(()=>[b(S(g.UploadedCount)+" / "+S(g.InscritsCount)+" ("+S(I(ve).pourcent(g.UploadedCount,g.InscritsCount))+" %) ",1)]),_:2},1032,["title"]))),256))]),_:1})]),_:1})]),_:1})]),_:1})]),_:1}),e(V,{cols:"1"}),e(V,{cols:"auto","align-self":"center"},{default:l(()=>[e(ke,null,{activator:l(({props:g})=>[e(F,fe(g,{size:"x-small",class:"mx-1",icon:"mdi-dots-vertical"}),null,16)]),default:l(()=>[e(me,{density:"compact"},{default:l(()=>[e(L,{"prepend-icon":"mdi-pencil",onClick:o[0]||(o[0]=g=>p("edit"))},{default:l(()=>[...o[14]||(o[14]=[b("Modifier les paramètres",-1)])]),_:1}),e(L,{"prepend-icon":"mdi-currency-eur",onClick:o[1]||(o[1]=g=>p("edit-taux"))},{default:l(()=>[...o[15]||(o[15]=[b("Taux de conversion",-1)])]),_:1}),e(h,{thickness:"1"}),e(L,{"prepend-icon":"mdi-mail",onClick:o[2]||(o[2]=g=>p("show-documents")),title:"Documents"}),e(h,{thickness:"1"}),e(L,{"prepend-icon":"mdi-plus",onClick:o[3]||(o[3]=g=>a.value=!0),title:"Ajouter un directeur...",disabled:i.camp.HasDirecteur},null,8,["disabled"]),e(h,{thickness:"1"}),e(L,{title:"Se connecter à l'espace directeur","prepend-icon":"mdi-open-in-new",href:i.camp.URLDirecteur,target:"_blank"},null,8,["href"]),e(h,{thickness:"1"}),e(L,{title:"Envoyer le sondage",subtitle:"de fin de séjour","prepend-icon":"mdi-comment-quote",onClick:o[4]||(o[4]=g=>p("send-sondage"))}),e(h,{thickness:"1"}),e(L,{"prepend-icon":"mdi-delete",disabled:i.camp.Stats.Inscriptions>0,onClick:o[5]||(o[5]=g=>s.value=!0)},{default:l(()=>[...o[16]||(o[16]=[b("Supprimer",-1)])]),_:1},8,["disabled"])]),_:1})]),_:1})]),_:1})]),_:1},8,["style"])]),_:1},8,["color"]),e(Y,{modelValue:s.value,"onUpdate:modelValue":o[8]||(o[8]=g=>s.value=g),"max-width":"600"},{default:l(()=>[e(E,{title:"Confirmer la suppression"},{default:l(()=>[e(T,null,{default:l(()=>[o[17]||(o[17]=b(" Etes vous certain de supprimer le séjour ",-1)),z("b",null,S(I(ce).label(i.camp.Camp.Camp)),1),o[18]||(o[18]=b(" ? ",-1)),o[19]||(o[19]=z("br",null,null,-1)),o[20]||(o[20]=z("br",null,null,-1)),o[21]||(o[21]=b(" Les éventuels ",-1)),o[22]||(o[22]=z("i",null,"équipiers",-1)),o[23]||(o[23]=b(" déclarés sur ce séjour seront aussi supprimés. ",-1)),o[24]||(o[24]=z("br",null,null,-1)),o[25]||(o[25]=z("br",null,null,-1)),o[26]||(o[26]=b(" Attention, cette opération est irréversible. ",-1))]),_:1}),e(le,null,{default:l(()=>[e(te),e(F,{color:"red",onClick:o[7]||(o[7]=g=>{s.value=!1,p("delete")})},{default:l(()=>[...o[27]||(o[27]=[b("Supprimer",-1)])]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"]),e(Y,{modelValue:a.value,"onUpdate:modelValue":o[11]||(o[11]=g=>a.value=g),"max-width":"400px"},{default:l(()=>[e(E,{title:"Ajouter un directeur"},{default:l(()=>[e(T,null,{default:l(()=>[e(c,{"initial-personne":"",label:"Directeur",modelValue:m.value,"onUpdate:modelValue":o[9]||(o[9]=g=>m.value=g),api:I(C)},null,8,["modelValue","api"])]),_:1}),e(le,null,{default:l(()=>[e(te),e(F,{disabled:!m.value,onClick:o[10]||(o[10]=g=>{a.value=!1,p("add-directeur",m.value)})},{default:l(()=>[...o[28]||(o[28]=[b("Ajouter",-1)])]),_:1},8,["disabled"])]),_:1})]),_:1})]),_:1},8,["modelValue"])],64)}}}),zl=W({__name:"CampsSelector",props:Se({allCamps:{}},{modelValue:{required:!0},modelModifiers:{}}),emits:["update:modelValue"],setup(u){const v=u,i=we(u,"modelValue"),p=Q(()=>v.allCamps.map(t=>({title:t.Label,value:t.Id})));return(t,s)=>(f(),x(Et,{multiple:"",chips:"","closable-chips":"",items:p.value,modelValue:i.value,"onUpdate:modelValue":s[0]||(s[0]=d=>i.value=d)},null,8,["items","modelValue"]))}}),Va=W({__name:"DocumentsCard",props:{camp:{}},setup(u){const v=u;$e(p);const i=P(null);async function p(){const t=await C.CampsDocuments({idCamp:v.camp.Camp.Camp.Id});t!==void 0&&(i.value=t)}return(t,s)=>{const d=zt;return i.value!=null?(f(),x(E,{key:0,title:"Documents"},{default:l(()=>[e(T,null,{default:l(()=>[e(me,null,{default:l(()=>[e(Pl,null,{default:l(()=>[...s[0]||(s[0]=[b("Préférences d'affichage",-1)])]),_:1}),e(L,null,{default:l(()=>[e($,{class:"mb-2"},{default:l(()=>[e(V,null,{default:l(()=>[e(de,{color:i.value.ToShow.LettreDirecteur?"green":"grey","append-icon":i.value.ToShow.LettreDirecteur?"mdi-check":""},{default:l(()=>[...s[1]||(s[1]=[b("Lettre du directeur",-1)])]),_:1},8,["color","append-icon"])]),_:1}),e(V,null,{default:l(()=>[e(de,{color:i.value.ToShow.ListeVetements?"green":"grey","append-icon":i.value.ToShow.ListeVetements?"mdi-check":""},{default:l(()=>[...s[2]||(s[2]=[b(" Liste de vêtements",-1)])]),_:1},8,["color","append-icon"])]),_:1}),e(V,null,{default:l(()=>[e(de,{color:i.value.ToShow.ListeParticipants?"green":"grey","append-icon":i.value.ToShow.ListeParticipants?"mdi-check":""},{default:l(()=>[...s[3]||(s[3]=[b("Liste des participants ",-1)])]),_:1},8,["color","append-icon"])]),_:1})]),_:1})]),_:1}),e(Pl,null,{default:l(()=>[...s[4]||(s[4]=[b("Documents du séjour",-1)])]),_:1}),(f(!0),j(Z,null,ne(i.value.Generated,a=>(f(),x(L,{title:a.NomClient},{append:l(()=>[e(d,{"file-key":a.Key,"is-generated-doc":!0},null,8,["file-key"])]),_:2},1032,["title"]))),256)),(f(!0),j(Z,null,ne(i.value.ToRead,a=>(f(),x(L,{title:a.NomClient},{append:l(()=>[e(d,{"file-key":a.Key,"is-generated-doc":!1},null,8,["file-key"])]),_:2},1032,["title"]))),256)),(f(!0),j(Z,null,ne(i.value.ToUploadModeles,a=>(f(),x(L,{title:a.NomClient,subtitle:"Document à remplir"},{append:l(()=>[e(d,{"file-key":a.Key,"is-generated-doc":!1},null,8,["file-key"])]),_:2},1032,["title"]))),256))]),_:1})]),_:1})]),_:1})):(f(),x(qe,{key:1,type:"card"}))}}}),ba={key:0,class:"text-center my-4"},ya={key:1},ga=["href"],Ca=W({__name:"AlbumsPhotosPannel",setup(u,{emit:v}){$e(t);const i=P(null),p=P([]);async function t(){const c=await C.CampsLoadAlbums();c!==void 0&&(i.value=c,p.value=[])}function s(c){return(i.value?.Camps||[]).find(g=>g.Camp.Id==c)}const d=P(!1),a=Q(()=>d.value||!p.value.length||!i.value?!1:p.value.every(c=>s(c).Album.Id==""));async function m(){d.value=!0;const c=await C.CampsCreateAlbums({IdCamps:p.value});d.value=!1,c!==void 0&&(st(c).forEach(([g,M])=>{s(g).Album=M}),C.showMessage("Albums photos créés avec succès."))}const n=Q(()=>d.value||!p.value.length||!i.value?!1:p.value.every(c=>s(c).Album.Id!="")),r=P(!1);async function o(){r.value=!1,d.value=!0;for(const c of p.value)if(await C.CampsDeleteAlbum({idCamp:c})===void 0)break;d.value=!1,C.showMessage("Albums photos supprimés avec succès."),t()}return(c,g)=>(f(),x(E,{title:"Albums photos",subtitle:"Seuls les camps en cours sont affichés."},{append:l(()=>[e(F,{disabled:!a.value,onClick:m,class:"mx-2"},{prepend:l(()=>[e(ye,{color:"green"},{default:l(()=>[...g[3]||(g[3]=[b("mdi-plus",-1)])]),_:1})]),default:l(()=>[g[4]||(g[4]=b(" Créer",-1))]),_:1},8,["disabled"]),e(F,{disabled:!n.value,onClick:g[0]||(g[0]=M=>r.value=!0)},{prepend:l(()=>[e(ye,{color:"red"},{default:l(()=>[...g[5]||(g[5]=[b("mdi-delete",-1)])]),_:1})]),default:l(()=>[g[6]||(g[6]=b(" Supprimer",-1))]),_:1},8,["disabled"])]),default:l(()=>[d.value?(f(),x(nl,{key:0,indeterminate:""})):J("",!0),e(T,null,{default:l(()=>[i.value==null?(f(),j("div",ba,[e(it,{indeterminate:""})])):(f(),j("div",ya,[e(E,{variant:"outlined"},{default:l(()=>[e(T,null,{default:l(()=>[e($,null,{default:l(()=>[e(V,null,{default:l(()=>[...g[7]||(g[7]=[b("Hébergement des photos",-1)])]),_:1}),e(V,{class:"text-right"},{default:l(()=>[z("a",{href:i.value.HostURL},S(i.value.HostURL),9,ga)]),_:1})]),_:1})]),_:1})]),_:1}),e(me,{selected:p.value,"onUpdate:selected":g[1]||(g[1]=M=>p.value=M),"select-strategy":"leaf"},{default:l(()=>[(f(!0),j(Z,null,ne(i.value.Camps,M=>(f(),x(L,{value:M.Camp.Id,title:I(ce).label(M.Camp),rounded:"",class:"my-1"},{append:l(()=>[e(de,{color:M.Album.Id?"success":void 0},{default:l(()=>[M.Album.Id?(f(),x(Te,{key:0,activator:"parent","content-class":"pa-0"},{default:l(()=>[e(E,{title:"Album photo","min-width":"400px"},{default:l(()=>[e(T,null,{default:l(()=>[e($,null,{default:l(()=>[e(V,{cols:"auto"},{default:l(()=>[...g[8]||(g[8]=[b("Nom",-1)])]),_:1}),e(V,{class:"text-right"},{default:l(()=>[b(S(M.Album.albumName),1)]),_:2},1024)]),_:2},1024),e($,null,{default:l(()=>[e(V,{cols:"auto"},{default:l(()=>[...g[9]||(g[9]=[b("ID",-1)])]),_:1}),e(V,{class:"text-right"},{default:l(()=>[b(S(M.Album.Id),1)]),_:2},1024)]),_:2},1024),e($,null,{default:l(()=>[e(V,{cols:"auto"},{default:l(()=>[...g[10]||(g[10]=[b("Date de création",-1)])]),_:1}),e(V,{class:"text-right"},{default:l(()=>[b(S(new Date(M.Album.createdAt).toLocaleDateString("fr")),1)]),_:2},1024)]),_:2},1024),e($,null,{default:l(()=>[e(V,{cols:"auto"},{default:l(()=>[...g[11]||(g[11]=[b("Nombre de photos",-1)])]),_:1}),e(V,{class:"text-right"},{default:l(()=>[b(S(M.Album.assetCount),1)]),_:2},1024)]),_:2},1024)]),_:2},1024)]),_:2},1024)]),_:2},1024)):J("",!0),b(" "+S(M.Album.Id==""?"Pas d'album":`Album créé le ${I(ve).date(M.Album.createdAt)}`),1)]),_:2},1032,["color"])]),_:2},1032,["value","title"]))),256))]),_:1},8,["selected"])]))]),_:1}),e(Y,{modelValue:r.value,"onUpdate:modelValue":g[2]||(g[2]=M=>r.value=M),"max-width":"600px"},{default:l(()=>[e(E,{title:"Confirmer la suppression"},{default:l(()=>[e(T,null,{default:l(()=>[...g[12]||(g[12]=[b(" Confirmez-vous la suppression des albums sélectionnés ? ",-1),z("br",null,null,-1),z("br",null,null,-1),b(" Les liens de partage ne seront plus valides. ",-1),z("br",null,null,-1),b(" Les photos ou vidéos elles-mêmes ne seront pas supprimées. ",-1)])]),_:1}),e(le,null,{default:l(()=>[e(te),e(F,{color:"red",onClick:o},{default:l(()=>[...g[13]||(g[13]=[b("Supprimer",-1)])]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"])]),_:1}))}}),_a=W({__name:"CampsSondagesPannel",props:{allCamps:{}},emits:["close"],setup(u,{emit:v}){const i=u,p=v;$e(a);const t=P(new Date(Date.now()).getFullYear()),s=Q(()=>Array.from(new Set(i.allCamps.map(r=>ce.year(r.Camp.Camp))).keys()).sort()),d=P(null);async function a(){const r=await C.CampsLoadSondages({year:t.value});r!==void 0&&(d.value=r)}const m=P(null),n=Q(()=>m.value==null?null:(d.value?.Sondages||{})[m.value]);return(r,o)=>(f(),x(E,{title:"Avis sur les séjours"},{append:l(()=>[e(F,{icon:"mdi-close",onClick:o[0]||(o[0]=c=>p("close")),flat:""})]),default:l(()=>[e(T,null,{default:l(()=>[e($,null,{default:l(()=>[e(V,{cols:"3"},{default:l(()=>[e($,null,{default:l(()=>[e(V,{cols:"12"},{default:l(()=>[e(Fe,{label:"Année",variant:"outlined",density:"comfortable","hide-details":"",items:s.value,modelValue:t.value,"onUpdate:modelValue":[o[1]||(o[1]=c=>t.value=c),a]},null,8,["items","modelValue"])]),_:1}),d.value?(f(),x(V,{key:0,cols:"12"},{default:l(()=>[e(me,{selected:m.value,"onUpdate:selected":o[2]||(o[2]=c=>m.value=c),"select-strategy":"single-leaf"},{default:l(()=>[(f(!0),j(Z,null,ne(d.value.Camps,c=>(f(),x(L,{rounded:"",title:I(ce).label(c),value:c.Id,key:c.Id},{append:l(()=>[e(ql,{inline:"",content:((d.value.Sondages||{})[c.Id].Sondages||[]).length},null,8,["content"])]),_:2},1032,["title","value"]))),128))]),_:1},8,["selected"])]),_:1})):J("",!0)]),_:1})]),_:1}),e(V,{cols:"9"},{default:l(()=>[n.value?(f(),x(Tt,{key:0,sondages:n.value},null,8,["sondages"])):J("",!0)]),_:1})]),_:1})]),_:1})]),_:1}))}}),xa={key:2},tl=16,Pa=W({__name:"CampsList",emits:["show-participants"],setup(u,{emit:v}){const i=v;$e(r);const p=ul(new Map),t=P(!1),s=ul({pattern:"",openOnly:!1}),d=Q(()=>{const D=new Set,_=new Set;for(const K of p.values())for(const O of Object.entries(K.Camp.Camp.Meta||{}))D.add(O[0]),_.add(O[1]);return{keys:Array.from(D.keys()).sort(),values:Array.from(_.keys()).sort()}}),a=Q(()=>{const D=Ml(s.pattern),_=Array.from(p.values()).filter(K=>ce.match(K.Camp.Camp,D)&&(!s.openOnly||xl(K.Camp)));return _.sort((K,O)=>{const re=new Date(O.Camp.Camp.DateDebut).valueOf(),be=new Date(K.Camp.Camp.DateDebut).valueOf();return re==be?K.Camp.Camp.Id-O.Camp.Camp.Id:re-be}),_}),m=Q(()=>a.value.slice((g.value-1)*tl,g.value*tl));function n(){g.value>c.value&&(g.value=c.value)}async function r(){t.value=!0;const D=await C.CampsGet();t.value=!1,D!==void 0&&(p.clear(),D?.forEach(_=>p.set(_.Camp.Camp.Id,_)))}async function o(){t.value=!0;const D=await C.CampsCreate();t.value=!1,D!==void 0&&(C.showMessage("Camp ajouté avec succès."),p.set(D.Camp.Camp.Id,D),M.value=D)}const c=Q(()=>Math.max(Math.ceil(a.value.length/tl),1)),g=P(1),M=P(null);async function k(D){M.value=null,t.value=!0;const _=await C.CampsUpdate(D);t.value=!1,_!==void 0&&(C.showMessage("Séjour modifié avec succès."),p.get(_.Camp.Id).Camp=_,n())}const w=P(null);async function A(){const D=w.value;if(D==null)return;w.value=null,t.value=!0;const _=await C.CampsSetTaux({IdCamp:D.Camp.Camp.Id,Taux:D.Taux});if(t.value=!1,_===void 0)return;C.showMessage("Taux modifié avec succès.");const K=p.get(D.Camp.Camp.Id);K.Camp.Camp.IdTaux=_.Id,K.Taux=_}const G=P(!1),ee=P(5),B=P({Id:1,Label:"",Euros:0,FrancsSuisse:0}),y=Q(()=>B.value.Id>0||B.value.Label!=""),oe=Q(()=>new Set(Array.from(p.values()).filter(_=>xl(_.Camp)).map(_=>_.Camp.Camp.IdTaux)).size<=1);async function _e(){G.value=!1,t.value=!0;const D=await C.CampsCreateMany({Count:ee.value,Taux:B.value});t.value=!1,D!==void 0&&(C.showMessage("Séjours créés avec succès."),D?.forEach(_=>p.set(_.Camp.Camp.Id,_)))}async function Ie(D){t.value=!0;const _=await C.CampsDelete({id:D.Camp.Camp.Id});t.value=!1,_!==void 0&&(C.showMessage("Séjour supprimé avec succès."),p.delete(D.Camp.Camp.Id),n())}const U=P(!1);function xe(){pe.value=Array.from(p.values()).filter(D=>D.Camp.Camp.Statut!=ot.Ouvert).map(D=>D.Camp.Camp.Id),U.value=!0}const pe=P([]);async function q(){U.value=!1,!(!pe.value.length||await C.CampsOuvreInscriptions({Camps:pe.value})===void 0)&&(C.showMessage("Séjours ouverts aux inscriptions avec succès."),r())}const H=P(null),ue=P(null);async function X(D){ue.value={Current:0,Total:10};const _=await C.EventsSendSondages({idCamp:D});if(_===void 0){ue.value=null;return}await il(_,K=>ue.value=K,K=>C.onError("Envoi du sondage",K)),ue.value=null,C.showMessage("Sondage envoyé avec succès.")}async function Ve(D,_){await C.CampsCreateEquipier({IdPersonne:D,IdCamp:_,Roles:[rt.Direction]})!==void 0&&(p.get(_).HasDirecteur=!0,C.showMessage("Directeur ajouté avec succès."))}const Pe=P(!1),ge=P(!1);return(D,_)=>{const K=je;return f(),j(Z,null,[e(E,{title:"Séjours",subtitle:p.size,class:"ma-2"},{append:l(()=>[e($,null,{default:l(()=>[e(V,{"align-self":"center",style:{width:"240px"}},{default:l(()=>[e(se,{label:"Rechercher",variant:"outlined",density:"comfortable","hide-details":"","prepend-inner-icon":"mdi-magnify",clearable:"",modelValue:s.pattern,"onUpdate:modelValue":[_[0]||(_[0]=O=>s.pattern=O),_[2]||(_[2]=O=>n())],"onClick:clear":_[1]||(_[1]=O=>{s.pattern="",n()})},null,8,["modelValue"])]),_:1}),e(h,{vertical:"",thickness:"1"}),e(V,{"align-self":"center",cols:"auto"},{default:l(()=>[e(ke,null,{activator:l(({props:O})=>[e(F,fe(O,{color:"success",disabled:t.value,"prepend-icon":"mdi-plus"}),{default:l(()=>[..._[21]||(_[21]=[b(" Créer un séjour ",-1)])]),_:1},16,["disabled"])]),default:l(()=>[e(me,{density:"compact"},{default:l(()=>[e(L,{onClick:o,title:"Créer un séjour"}),e(L,{title:"Créer plusieurs séjours...",subtitle:"Permet de choisir les taux de conversion",onClick:_[3]||(_[3]=O=>G.value=!0)})]),_:1})]),_:1})]),_:1}),e(V,{"align-self":"center",cols:"auto"},{default:l(()=>[e(F,{flat:"",icon:"",size:"small"},{default:l(()=>[e(ye,{icon:"mdi-dots-vertical"}),e(ke,{activator:"parent"},{default:l(()=>[e(me,{density:"compact"},{default:l(()=>[e(L,{title:"Masquer les camps fermés",subtitle:"N'afficher que les camps ouverts aux inscriptions",onClick:_[5]||(_[5]=O=>s.openOnly=!s.openOnly)},{prepend:l(()=>[e(Le,{class:"mr-2",modelValue:s.openOnly,"onUpdate:modelValue":_[4]||(_[4]=O=>s.openOnly=O),density:"compact","hide-details":""},null,8,["modelValue"])]),_:1}),e(h,{thickness:"1"}),e(L,{onClick:_[6]||(_[6]=O=>Pe.value=!0),title:"Configurer les albums photos...","prepend-icon":"mdi-image-album"}),e(h,{thickness:"1"}),e(L,{onClick:xe,title:"Ouvrir les inscriptions...",subtitle:"sur plusieurs séjours","prepend-icon":"mdi-lock-open"}),e(h,{thickness:"1"}),e(L,{onClick:_[7]||(_[7]=O=>ge.value=!0),title:"Avis sur les séjours...","prepend-icon":"mdi-comment-quote"}),e(h,{thickness:"1"}),e(L,{"prepend-icon":"mdi-file-excel",title:"Exporter",subtitle:"Participants de l'année courante (format Excel)",link:"",href:I(C).CampsDownloadParticipants(new Date().getFullYear(),I(C).authToken)},null,8,["href"])]),_:1})]),_:1})]),_:1})]),_:1})]),_:1})]),default:l(()=>[e(T,{class:"mt-4"},{default:l(()=>[oe.value?J("",!0):(f(),x(Yt,{key:0,type:"warning"},{default:l(()=>[..._[22]||(_[22]=[b(" Attention, les séjours ouverts aux inscriptions ont des taux de conversion incompatibles ! ",-1)])]),_:1})),t.value?(f(),x(qe,{key:1})):a.value.length==0?(f(),j("i",xa," Aucun camp ne correspond aux filtres actuels. ")):J("",!0),(f(!0),j(Z,null,ne(m.value,(O,re)=>(f(),x(fa,{key:re,camp:O,onClick:be=>i("show-participants",O),onEdit:be=>M.value=O,onEditTaux:be=>w.value=O,onDelete:be=>Ie(O),onShowDocuments:be=>H.value=O,onSendSondage:be=>X(O.Camp.Camp.Id),onAddDirecteur:be=>Ve(be,O.Camp.Camp.Id)},null,8,["camp","onClick","onEdit","onEditTaux","onDelete","onShowDocuments","onSendSondage","onAddDirecteur"]))),128)),e(Gt,{length:c.value,modelValue:g.value,"onUpdate:modelValue":_[8]||(_[8]=O=>g.value=O)},null,8,["length","modelValue"])]),_:1})]),_:1},8,["subtitle"]),e(Y,{"model-value":M.value!=null,"onUpdate:modelValue":_[9]||(_[9]=O=>M.value=null),"max-width":"800px"},{default:l(()=>[M.value!=null?(f(),x(pa,{key:0,camp:M.value.Camp.Camp,"preselection-url":M.value.URLPreselection,"meta-entries-hints":d.value,onSave:k},null,8,["camp","preselection-url","meta-entries-hints"])):J("",!0)]),_:1},8,["model-value"]),e(Y,{"model-value":w.value!=null,"onUpdate:modelValue":_[11]||(_[11]=O=>w.value=null),"max-width":"600"},{default:l(()=>[w.value!=null?(f(),x(E,{key:0,title:"Modifier le taux",subtitle:"La modification n'est possible que si aucun participant n'est enregistré."},{default:l(()=>[e(T,null,{default:l(()=>[e(Il,{modelValue:w.value.Taux,"onUpdate:modelValue":_[10]||(_[10]=O=>w.value.Taux=O)},null,8,["modelValue"])]),_:1}),e(le,null,{default:l(()=>[e(te),e(F,{disabled:w.value.Stats.Inscriptions>0,onClick:A},{default:l(()=>[..._[23]||(_[23]=[b("Modifier",-1)])]),_:1},8,["disabled"])]),_:1})]),_:1})):J("",!0)]),_:1},8,["model-value"]),e(Y,{modelValue:G.value,"onUpdate:modelValue":_[14]||(_[14]=O=>G.value=O),"max-width":"600"},{default:l(()=>[e(E,{title:"Créer plusieurs séjours",subtitle:"Les séjours seront liés au même taux de conversion"},{default:l(()=>[e(T,null,{default:l(()=>[e($,null,{default:l(()=>[e(V,null,{default:l(()=>[e(K,{label:"Nombre de séjours",modelValue:ee.value,"onUpdate:modelValue":_[12]||(_[12]=O=>ee.value=O)},null,8,["modelValue"])]),_:1})]),_:1}),e(h,{thickness:"2",class:"my-2"}),e(Il,{modelValue:B.value,"onUpdate:modelValue":_[13]||(_[13]=O=>B.value=O)},null,8,["modelValue"])]),_:1}),e(le,null,{default:l(()=>[e(te),e(F,{color:"success",onClick:_e,disabled:!y.value},{default:l(()=>[..._[24]||(_[24]=[b("Créer",-1)])]),_:1},8,["disabled"])]),_:1})]),_:1})]),_:1},8,["modelValue"]),e(Y,{modelValue:U.value,"onUpdate:modelValue":_[16]||(_[16]=O=>U.value=O),"max-width":"600"},{default:l(()=>[e(E,{title:"Ouvrir les inscriptions",subtitle:"Ouvre les inscriptions sur les séjours ci-dessous"},{default:l(()=>[e(T,null,{default:l(()=>[e(zl,{"all-camps":Array.from(p.values()).map(O=>I(ce).toItem(O.Camp)),modelValue:pe.value,"onUpdate:modelValue":_[15]||(_[15]=O=>pe.value=O)},null,8,["all-camps","modelValue"])]),_:1}),e(le,null,{default:l(()=>[e(te),e(F,{onClick:q,disabled:!pe.value.length},{default:l(()=>[..._[25]||(_[25]=[b("Ouvrir",-1)])]),_:1},8,["disabled"])]),_:1})]),_:1})]),_:1},8,["modelValue"]),e(Y,{"model-value":H.value!=null,"onUpdate:modelValue":_[17]||(_[17]=O=>H.value=null),"max-width":"800px"},{default:l(()=>[H.value?(f(),x(Va,{key:0,camp:H.value},null,8,["camp"])):J("",!0)]),_:1},8,["model-value"]),e(Y,{"model-value":ue.value!=null,"max-width":"400px",persistent:""},{default:l(()=>[ue.value?(f(),x(ol,{key:0,title:"Envoi du sondage en cours",current:ue.value.Current,total:ue.value.Total},null,8,["current","total"])):J("",!0)]),_:1},8,["model-value"]),e(Y,{modelValue:Pe.value,"onUpdate:modelValue":_[18]||(_[18]=O=>Pe.value=O),"max-width":"800px"},{default:l(()=>[e(Ca)]),_:1},8,["modelValue"]),e(Y,{modelValue:ge.value,"onUpdate:modelValue":_[20]||(_[20]=O=>ge.value=O),fullscreen:""},{default:l(()=>[e(_a,{"all-camps":Array.from(p.values()),onClose:_[19]||(_[19]=O=>ge.value=!1)},null,8,["all-camps"])]),_:1},8,["modelValue"])],64)}}}),wa={key:1},ka={key:0,class:"text-center font-italic"},Da=W({__name:"CampParticipants",props:{id:{},idParticipant:{}},setup(u){const v=u;$e(async()=>{t(),await a(),m()}),Ue(()=>v.id,a),Ue(()=>v.idParticipant,m);const i=P(!1),p=P([]);async function t(){const B=await C.GetCamps();B!==void 0&&(p.value=B||[])}const s=Q(()=>{const B=(d.value?.Participants||[]).map(y=>y);return B.sort(dt.cmp),B}),d=P(null);async function a(){i.value=!0;const B=await C.CampsLoad({idCamp:v.id});i.value=!1,B!==void 0&&(d.value=B)}function m(){if(v.idParticipant===void 0)return;const B=(d.value?.Participants||[]).find(y=>y.Participant.Id==v.idParticipant);B&&(o.value=Ce(B))}const n=P(null);async function r(){if(n.value==null||d.value==null)return;const B=await C.ParticipantsCreate(n.value);n.value=null,B!==void 0&&(C.showMessage("Participant créé avec succès."),d.value.Participants=(d.value.Participants||[]).concat(B),o.value=Ce(B))}const o=P(null);async function c(B){if(o.value==null||d.value==null)return;const y=await C.ParticipantsUpdate(B);o.value=null,y!==void 0&&(C.showMessage("Participant modifié avec succès."),a())}const g=P(null);async function M(){if(g.value==null||d.value==null)return;const B=g.value.Participant.Id,y=await C.ParticipantsDelete({id:B});g.value=null,y!==void 0&&(C.showMessage("Participant supprimé avec succès."),d.value.Participants=(d.value.Participants||[]).filter(oe=>oe.Participant.Id!=B))}const k=P(null);async function w(){const B=k.value;B==null||d.value==null||(k.value=null,await C.ParticipantsMove(B)===void 0)||(C.showMessage("Participant déplacé avec succès.",void 0,{title:"Aller au nouveau séjour",action:()=>fl({IdCamp:B.Target,Id:B.Id})}),d.value.Participants=(d.value.Participants||[]).filter(oe=>oe.Participant.Id!=B.Id))}const A=P(null);async function G(){if(A.value==null)return;const B=A.value.Participant.Id;A.value=null;const y=await C.ParticipantsSetPlaceLiberee({id:B});if(y===void 0||(C.showMessage("Notification de place libérée envoyée avec succès."),d.value==null))return;const oe=d.value.Participants?.find(_e=>_e.Participant.Id==B);oe.Participant=y}const ee=P(!1);return(B,y)=>{const oe=Lt,_e=Ot,Ie=Ge,U=Tl,xe=Rt,pe=Ke,q=Nt;return d.value!=null?(f(),x(E,{key:0,title:"Participants",subtitle:I(ce).label(d.value.Camp.Camp)},{append:l(()=>[e(F,{color:"green",onClick:y[0]||(y[0]=H=>n.value={IdCamp:v.id,IdDossier:0,IdPersonne:0}),"prepend-icon":"mdi-plus"},{default:l(()=>[...y[11]||(y[11]=[b(" Ajouter un participant",-1)])]),_:1}),e(h,{thickness:"1",class:"mx-1"}),e(F,{icon:"",size:"small",flat:""},{default:l(()=>[e(ye,null,{default:l(()=>[...y[12]||(y[12]=[b("mdi-dots-vertical",-1)])]),_:1}),e(ke,{activator:"parent"},{default:l(()=>[e(me,null,{default:l(()=>[e(L,{"prepend-icon":"mdi-currency-eur",title:"Suivi du règlement",onClick:y[1]||(y[1]=H=>ee.value=!0)})]),_:1})]),_:1})]),_:1})]),default:l(()=>[e(T,{class:"mt-4"},{default:l(()=>[i.value?(f(),x(qe,{key:0,type:"table"})):(f(),j("div",wa,[e(oe),s.value.length?J("",!0):(f(),j("div",ka," Aucun participant n'est encore inscrit sur ce séjour. ")),(f(!0),j(Z,null,ne(s.value,(H,ue)=>(f(),x(_e,{participant:H,index:ue},{actions:l(()=>[e(me,{density:"comfortable"},{default:l(()=>[e(L,{title:"Modifier","prepend-icon":"mdi-pencil",onClick:X=>o.value=H},null,8,["onClick"]),e(h),e(L,{title:"Changer de camp...","prepend-icon":"mdi-file-move",onClick:X=>k.value={Id:H.Participant.Id,Target:0}},null,8,["onClick"]),e(L,{title:"Notifier d'une place disponible.",subtitle:"Envoi un email","prepend-icon":"mdi-email-alert",disabled:H.Participant.Statut==I(Qe).Inscrit||H.Participant.Statut==I(Qe).EnAttenteReponse,onClick:X=>A.value=H},null,8,["disabled","onClick"]),e(h),e(L,{title:"Aller à la personne",subtitle:`(ID : ${H.Personne.Id})`,onClick:X=>I(Ne)(H.Personne.Id)},null,8,["subtitle","onClick"]),e(L,{title:"Aller au dossier",subtitle:`(ID : ${H.Participant.IdDossier})`,onClick:X=>I(rl)(H.Participant.IdDossier)},null,8,["subtitle","onClick"]),e(h),e(L,{title:"Supprimer","prepend-icon":"mdi-delete",onClick:X=>g.value=H},null,8,["onClick"])]),_:2},1024)]),_:2},1032,["participant","index"]))),256))]))]),_:1}),n.value!=null?(f(),x(Y,{key:0,"model-value":n.value!=null,"onUpdate:modelValue":y[4]||(y[4]=H=>n.value=null),"max-width":"600px"},{default:l(()=>[e(E,{title:"Créer un participant"},{default:l(()=>[e(T,null,{default:l(()=>[e($,null,{default:l(()=>[e(V,{cols:"12"},{default:l(()=>[e(Ie,{label:"Participant",modelValue:n.value.IdPersonne,"onUpdate:modelValue":y[2]||(y[2]=H=>n.value.IdPersonne=H),"initial-personne":"",api:{SelectPersonne:I(C).SelectPersonne.bind(I(C))}},null,8,["modelValue","api"])]),_:1}),e(V,{cols:"12"},{default:l(()=>[e(U,{modelValue:n.value.IdDossier,"onUpdate:modelValue":y[3]||(y[3]=H=>n.value.IdDossier=H)},null,8,["modelValue"])]),_:1})]),_:1})]),_:1}),e(le,null,{default:l(()=>[e(te),e(F,{color:"green",onClick:r,disabled:!(n.value.IdDossier&&n.value.IdPersonne)},{default:l(()=>[...y[13]||(y[13]=[b("Créer",-1)])]),_:1},8,["disabled"])]),_:1})]),_:1})]),_:1},8,["model-value"])):J("",!0),o.value!=null?(f(),x(Y,{key:1,"model-value":o.value!=null,"onUpdate:modelValue":y[5]||(y[5]=H=>o.value=null),"max-width":"800px"},{default:l(()=>[e(xe,{participant:o.value.Participant,personne:o.value.Personne,api:{SelectPersonne:I(C).SelectPersonne.bind(I(C))},onSave:c},null,8,["participant","personne","api"])]),_:1},8,["model-value"])):J("",!0),g.value!=null?(f(),x(Y,{key:2,"model-value":g.value!=null,"onUpdate:modelValue":y[6]||(y[6]=H=>g.value=null),"max-width":"600px"},{default:l(()=>[e(E,{title:"Supprimer le participant"},{default:l(()=>[e(T,null,{default:l(()=>[y[14]||(y[14]=b(" Confirmez-vous la suppression du participant ",-1)),z("b",null,S(I(Me).label(g.value.Personne)),1),y[15]||(y[15]=b(" ? ",-1)),y[16]||(y[16]=z("br",null,null,-1)),y[17]||(y[17]=z("br",null,null,-1)),y[18]||(y[18]=b(" Attention, cette opération est irréversible. ",-1))]),_:1}),e(le,null,{default:l(()=>[e(te),e(F,{color:"red",onClick:M},{default:l(()=>[...y[19]||(y[19]=[b("Supprimer",-1)])]),_:1})]),_:1})]),_:1})]),_:1},8,["model-value"])):J("",!0),k.value!=null?(f(),x(Y,{key:3,"model-value":k.value!=null,"onUpdate:modelValue":y[8]||(y[8]=H=>k.value=null),"max-width":"500px"},{default:l(()=>[e(E,{title:"Déplacer le participant"},{default:l(()=>[e(T,null,{default:l(()=>[e(pe,{label:"Nouveau séjour",camps:p.value,modelValue:k.value.Target,"onUpdate:modelValue":y[7]||(y[7]=H=>k.value.Target=H)},null,8,["camps","modelValue"])]),_:1}),e(le,null,{default:l(()=>[e(te),e(F,{onClick:w,disabled:k.value.Target==v.id||!k.value.Target},{default:l(()=>[...y[20]||(y[20]=[b("Déplacer",-1)])]),_:1},8,["disabled"])]),_:1})]),_:1})]),_:1},8,["model-value"])):J("",!0),A.value!=null?(f(),x(Y,{key:4,"model-value":A.value!=null,"onUpdate:modelValue":y[9]||(y[9]=H=>A.value=null),"max-width":"500px"},{default:l(()=>[e(E,{title:"Notifier d'une place disponible"},{default:l(()=>[e(T,null,{default:l(()=>[b(" Confirmez-vous l'envoi d'une notification au responsable de "+S(I(Me).label(A.value.Personne))+" indiquant qu'une place est disponible ? ",1),y[21]||(y[21]=z("br",null,null,-1)),y[22]||(y[22]=z("br",null,null,-1)),b(" Le nouveau statut de "+S(A.value.Personne.Prenom)+" sera : ",1),z("i",null,S(I(mt)[I(Qe).EnAttenteReponse]),1),y[23]||(y[23]=b(". ",-1))]),_:1}),e(le,null,{default:l(()=>[e(te),e(F,{onClick:G},{default:l(()=>[...y[24]||(y[24]=[b("Notifier",-1)])]),_:1})]),_:1})]),_:1})]),_:1},8,["model-value"])):J("",!0),e(Y,{modelValue:ee.value,"onUpdate:modelValue":y[10]||(y[10]=H=>ee.value=H),"max-width":"700px"},{default:l(()=>[e(q,{data:d.value},null,8,["data"])]),_:1},8,["modelValue"])]),_:1},8,["subtitle"])):(f(),x(qe,{key:1,type:"card"}))}}}),Sa=W({__name:"camps",setup(u){const v=Je(),i=Q(()=>kn(v.currentRoute.value.query)),p=Q(()=>i.value.idCamp);function t(d){const a=v.currentRoute.value;v.push({path:a.path,query:{idCamp:d.Camp.Camp.Id}})}function s(){const d=v.currentRoute.value;v.push({path:d.path,query:{}})}return(d,a)=>(f(),j(Z,null,[e(ll,{title:"Gestion des séjours"},{default:l(()=>[p.value!==null?(f(),x(F,{key:0,onClick:s,"prepend-icon":"mdi-view-list"},{default:l(()=>[...a[0]||(a[0]=[b(" Retour à la liste",-1)])]),_:1})):J("",!0)]),_:1}),p.value===void 0?(f(),x(Pa,{key:0,onShowParticipants:t})):(f(),x(Da,{key:1,id:p.value,"id-participant":i.value.idParticipant},null,8,["id","id-participant"]))],64))}}),Ql=W({__name:"MergeCard",props:{from:{}},emits:["merge"],setup(u,{emit:v}){const i=u,p=v,t=P(0),s=P(!0);return(d,a)=>{const m=Tl;return f(),x(E,{title:"Fusionner le dossier vers",subtitle:"Les participants, paiements et messages seront copiés vers le dossier cible."},{default:l(()=>[e(T,null,{default:l(()=>[e($,null,{default:l(()=>[e(V,{cols:"12"},{default:l(()=>[e(m,{modelValue:t.value,"onUpdate:modelValue":a[0]||(a[0]=n=>t.value=n)},null,8,["modelValue"])]),_:1}),e(V,{cols:"12"},{default:l(()=>[e(Le,{density:"compact",label:"Notifier par email",hint:"Le reponsable du dossier absorbé sera averti du changement d'espace personnel.","persistent-hint":"",modelValue:s.value,"onUpdate:modelValue":a[1]||(a[1]=n=>s.value=n)},null,8,["modelValue"])]),_:1})]),_:1})]),_:1}),e(le,null,{default:l(()=>[e(te),e(F,{disabled:t.value==0||t.value==i.from,onClick:a[2]||(a[2]=n=>p("merge",{From:i.from,To:t.value,Notifie:s.value}))},{default:l(()=>[...a[3]||(a[3]=[b("Fusionner",-1)])]),_:1},8,["disabled"])]),_:1})]),_:1})}}}),Ia={key:1,class:"text-center font-italic"},Aa={key:2},Ua=W({__name:"PannelInscriptions",emits:["goTo","empty"],setup(u,{emit:v}){const i=v,p=P(!1);$e(async()=>{await s(),t.value.length||i("empty")});const t=P([]);async function s(){p.value=!0;const k=await C.InscriptionsGet();p.value=!1,k!==void 0&&(t.value=k||[])}const d=P(""),a=Q(()=>{const k=Ml(d.value);return t.value.filter(w=>Me.match(w.Responsable,k)||w.Participants?.some(A=>Me.match(A.Personne,k)||ce.match(A.Camp,k)))});async function m(k,w){const A=await C.InscriptionsIdentifiePersonne({IdDossier:k,Target:w});if(A===void 0)return;C.showMessage("Profil identifié avec succès.");const G=t.value.findIndex(ee=>ee.Dossier.Id==k);t.value[G]=A}const n=P(null);async function r(k,w){if(!n.value)return;const A=n.value.inscription.Dossier.Id;n.value=null;const G=await C.InscriptionsValide({IdDossier:A,Statuts:k,SendMail:w});if(G!==void 0)if(G.Dossier.IsValidated)C.showMessage("Inscription validée avec succès.","",{title:"Aller au dossier",action:()=>i("goTo",A)}),t.value=t.value.filter(ee=>ee.Dossier.Id!=A);else{C.showMessage("Participant validé avec succès.");const ee=t.value.findIndex(B=>B.Dossier.Id==A);t.value[ee]=G}}async function o(k){await C.DossiersDelete({id:k.Dossier.Id})!==void 0&&(C.showMessage("Inscription supprimée avec succès."),t.value=t.value.filter(A=>A.Dossier.Id!=k.Dossier.Id))}async function c(k,w){if(await C.ParticipantsDelete({id:w})===void 0)return;C.showMessage("Participant supprimé avec succès.");const G=t.value.find(ee=>ee.Dossier.Id==k);G.Participants=(G.Participants||[]).filter(ee=>ee.Participant.Id!=w)}const g=P(null);async function M(k){g.value=null,await C.DossiersMerge(k)!==void 0&&(C.showMessage("Inscriptions fusionnées avec succès."),s())}return(k,w)=>{const A=jt;return f(),x(E,{title:"Inscriptions",subtitle:"En attente de validation",class:"ma-2"},{append:l(()=>[e(se,{width:"300","append-inner-icon":"mdi-magnify",label:"Rechercher","hide-details":"",modelValue:d.value,"onUpdate:modelValue":w[0]||(w[0]=G=>d.value=G)},null,8,["modelValue"])]),default:l(()=>[e(T,null,{default:l(()=>[p.value?(f(),x(qe,{key:0})):t.value.length?(f(),j("div",Aa,[(f(!0),j(Z,null,ne(a.value,(G,ee)=>(f(),x(qt,{class:"my-1",user:null,key:ee,inscription:G,onIdentifie:B=>m(G.Dossier.Id,B),onValide:B=>n.value={inscription:G,participants:B===void 0?void 0:[B]},onMerge:B=>g.value=G.Dossier.Id,onDelete:B=>o(G),onDeleteParticipant:B=>c(G.Dossier.Id,B),api:{SearchSimilaires:I(C).InscriptionsSearchSimilaires.bind(I(C)),SelectPersonne:I(C).SelectPersonne.bind(I(C))}},null,8,["inscription","onIdentifie","onValide","onMerge","onDelete","onDeleteParticipant","api"]))),128))])):(f(),j("div",Ia," Il n'y a aucune inscription à valider. "))]),_:1}),e(Y,{"model-value":g.value!=null,"onUpdate:modelValue":w[1]||(w[1]=G=>g.value=null),"max-width":"600px"},{default:l(()=>[g.value!=null?(f(),x(Ql,{key:0,from:g.value,onMerge:M},null,8,["from"])):J("",!0)]),_:1},8,["model-value"]),e(Y,{"model-value":n.value!=null,"onUpdate:modelValue":w[2]||(w[2]=G=>n.value=null),"max-width":"800px"},{default:l(()=>[n.value?(f(),x(A,{key:0,inscription:n.value.inscription,"id-participants":n.value.participants,onValide:r},null,8,["inscription","id-participants"])):J("",!0)]),_:1},8,["model-value"])]),_:1})}}}),$a={class:"text-grey"},Ma={class:"text-grey"},Fa={key:0},Ea=W({__name:"FactureCard",props:{dossier:{}},setup(u){const v=u,i=Q(()=>(v.dossier.Participants||[]).filter(a=>a.Participant.Statut!=Qe.Inscrit).map(a=>Me.label(a.Personne))),p=Q(()=>(v.dossier.Participants||[]).filter(a=>a.Participant.Statut==Qe.Inscrit).map(a=>({Label:Me.label(a.Personne),Camp:ce.label(a.Camp),Prix:ve.montant(a.Camp.Prix),Bilan:v.dossier.Bilan.Inscrits[a.Participant.Id]})));function t(a){return!!(a.Remises.Famille||a.Remises.Equipiers||a.Remises.Speciale.Cent)}function s(a){const m=[];return a.Famille&&m.push(`Enfants : ${a.Famille}%`),a.Equipiers&&m.push(`Enfants : ${a.Equipiers}%`),a.Speciale.Cent&&m.push(`Remise : ${ve.montant(a.Speciale)}`),m.join("  ;  ")}const d=Q(()=>{const a=Object.values(v.dossier.Paiements||{});return a.sort((m,n)=>new Date(m.Time).valueOf()-new Date(n.Time).valueOf()),a});return(a,m)=>(f(),x(E,{title:"Suivi financier",subtitle:i.value.length?`Les participants en liste d'attente (${i.value.join(", ")}) ne sont pas pris en compte.`:"","min-width":"900px"},{default:l(()=>[e(T,null,{default:l(()=>[e($,null,{default:l(()=>[e(V,{cols:"3"},{default:l(()=>[...m[0]||(m[0]=[b("Participant",-1)])]),_:1}),e(V,{cols:"2",class:"text-center"},{default:l(()=>[...m[1]||(m[1]=[b("Prix du séjour",-1)])]),_:1}),e(V,{cols:"2",class:"text-center"},{default:l(()=>[...m[2]||(m[2]=[b("Prix avec option",-1)])]),_:1}),e(V,{cols:"3",class:"text-center"},{default:l(()=>[...m[3]||(m[3]=[b("Aides extérieures",-1)])]),_:1}),e(V,{cols:"2",class:"text-right"},{default:l(()=>[...m[4]||(m[4]=[b("Sous-total",-1)])]),_:1})]),_:1}),e(h,{thickness:"1",class:"my-2"}),(f(!0),j(Z,null,ne(p.value,n=>(f(),j(Z,null,[e($,null,{default:l(()=>[e(V,{"align-self":"center",cols:"3"},{default:l(()=>[b(S(n.Label)+" ",1),m[5]||(m[5]=z("br",null,null,-1)),z("span",$a,S(n.Camp),1)]),_:2},1024),e(V,{"align-self":"center",cols:"2",class:"text-center"},{default:l(()=>[b(S(n.Prix),1)]),_:2},1024),e(V,{"align-self":"center",cols:"2",class:"text-center"},{default:l(()=>[b(S(I(ve).montant(n.Bilan.AvecOption))+" ",1),m[6]||(m[6]=z("br",null,null,-1)),z("span",Ma,S(n.Bilan.AvecOptionDescription),1)]),_:2},1024),e(V,{"align-self":"center",cols:"3",class:"text-center"},{default:l(()=>[n.Bilan.Aides?.length?J("",!0):(f(),j("span",Fa,"-")),(f(!0),j(Z,null,ne(n.Bilan.Aides,r=>(f(),x(de,null,{default:l(()=>[b(S(r.Structure)+" : "+S(I(ve).montant(r.Montant)),1)]),_:2},1024))),256))]),_:2},1024),e(V,{"align-self":"center",cols:"2",class:"text-right"},{default:l(()=>[b(S(n.Bilan.AvecAides),1)]),_:2},1024)]),_:2},1024),t(n.Bilan)?(f(),x($,{key:0,"no-gutters":""},{default:l(()=>[e(V,{cols:"10",class:"text-right"},{default:l(()=>[z("i",null,S(s(n.Bilan.Remises)),1)]),_:2},1024),e(V,{cols:"2",class:"text-right"},{default:l(()=>[b(S(n.Bilan.Net),1)]),_:2},1024)]),_:2},1024)):J("",!0)],64))),256)),e(h,{thickness:"1",class:"my-2"}),e($,null,{default:l(()=>[e(V,{cols:"10",class:"text-right"},{default:l(()=>[...m[7]||(m[7]=[b("Total demandé",-1)])]),_:1}),e(V,{cols:"2",class:"text-right"},{default:l(()=>[b(S(v.dossier.Bilan.Demande),1)]),_:1})]),_:1}),e(h,{thickness:"1",class:"my-2"}),(f(!0),j(Z,null,ne(d.value,n=>(f(),x($,null,{default:l(()=>[e(V,null,{default:l(()=>[b(" Paiement de "+S(n.Payeur)+", le "+S(I(ve).date(n.Time)),1)]),_:2},1024),e(V,{cols:"2",class:"text-right"},{default:l(()=>[b(S(n.IsRemboursement?"+":"-")+S(I(ve).montant(n.Montant)),1)]),_:2},1024)]),_:2},1024))),256)),e($,null,{default:l(()=>[e(V,{cols:"10",class:"text-right"},{default:l(()=>[...m[8]||(m[8]=[b("Solde",-1)])]),_:1}),e(V,{cols:"2",class:"text-right"},{default:l(()=>[z("b",null,S(v.dossier.Bilan.Restant),1)]),_:1})]),_:1})]),_:1})]),_:1},8,["subtitle"]))}});function Ee(u){let v=arguments.length>1&&arguments[1]!==void 0?arguments[1]:2;return String(u).padStart(v,"0")}const Ta=ml({allowedValues:Function,ampm:Boolean,color:String,disabled:Boolean,displayedValue:null,double:Boolean,format:{type:Function,default:u=>u},max:{type:Number,required:!0},min:{type:Number,required:!0},scrollable:Boolean,readonly:Boolean,rotate:{type:Number,default:0},step:{type:Number,default:1},modelValue:{type:Number}},"VTimePickerClock"),Al=dl()({name:"VTimePickerClock",props:Ta(),emits:{change:u=>!0,input:u=>!0},setup(u,v){let{emit:i}=v;const p=P(null),t=P(null),s=P(void 0),d=P(!1),a=P(null),m=P(null),n=pt(D=>i("change",D),750),{textColorClasses:r,textColorStyles:o}=vt(()=>u.color),{backgroundColorClasses:c,backgroundColorStyles:g}=ct(()=>u.color),M=Q(()=>u.max-u.min+1),k=Q(()=>u.double?M.value/2:M.value),w=Q(()=>360/k.value),A=Q(()=>w.value*Math.PI/180),G=Q(()=>u.modelValue==null?u.min:u.modelValue),ee=Q(()=>.62),B=Q(()=>{const D=[];for(let _=u.min;_<=u.max;_=_+u.step)D.push(_);return D});Ue(()=>u.modelValue,D=>{s.value=D});function y(D){s.value!==D&&(s.value=D),i("input",D)}function oe(D){return!u.allowedValues||u.allowedValues(D)}function _e(D){if(!u.scrollable||u.disabled)return;D.preventDefault();const _=Math.sign(-D.deltaY||1);let K=G.value;do K=K+_,K=(K-u.min+M.value)%M.value+u.min;while(!oe(K)&&K!==G.value);K!==u.displayedValue&&y(K),n(K)}function Ie(D){return u.double&&D-u.min>=k.value}function U(D){return Ie(D)?ee.value:1}function xe(D){const _=u.rotate*Math.PI/180;return{x:Math.sin((D-u.min)*A.value+_)*U(D),y:-Math.cos((D-u.min)*A.value+_)*U(D)}}function pe(D,_){const K=(Math.round(D/w.value)+(_?k.value:0))%M.value+u.min;return D<360-w.value/2?K:_?u.max-k.value+1:u.min}function q(D){const{x:_,y:K}=xe(D);return{left:`${Math.round(50+_*50)}%`,top:`${Math.round(50+K*50)}%`}}function H(D,_){const K=_.x-D.x,O=_.y-D.y;return Math.sqrt(K*K+O*O)}function ue(D,_){const K=2*Math.atan2(_.y-D.y-H(D,_),_.x-D.x);return Math.abs(K*180/Math.PI)}function X(D){a.value===null&&(a.value=D),m.value=D,y(D)}function Ve(D){if(D.preventDefault(),!d.value&&D.type!=="click"||!p.value)return;const{width:_,top:K,left:O}=p.value?.getBoundingClientRect(),{width:re}=t.value?.getBoundingClientRect()??{width:0},{clientX:be,clientY:ze}="touches"in D?D.touches[0]:D,R={x:_/2,y:-_/2},N={x:be-O,y:K-ze},ae=Math.round(ue(R,N)-u.rotate+360)%360,ie=u.double&&H(R,N)<(re+re*ee.value)/4,Kl=Math.ceil(15/w.value);let Re;for(let Ye=0;Ye<Kl;Ye++)if(Re=pe(ae+Ye*w.value,ie),oe(Re)||(Re=pe(ae-Ye*w.value,ie),oe(Re)))return X(Re)}function Pe(D){u.disabled||(D.preventDefault(),window.addEventListener("mousemove",Ve),window.addEventListener("touchmove",Ve),window.addEventListener("mouseup",ge),window.addEventListener("touchend",ge),a.value=null,m.value=null,d.value=!0,Ve(D))}function ge(D){D.stopPropagation(),window.removeEventListener("mousemove",Ve),window.removeEventListener("touchmove",Ve),window.removeEventListener("mouseup",ge),window.removeEventListener("touchend",ge),d.value=!1,m.value!==null&&oe(m.value)&&i("change",m.value)}pl(()=>z("div",{class:Ae([{"v-time-picker-clock":!0,"v-time-picker-clock--indeterminate":u.modelValue==null,"v-time-picker-clock--readonly":u.readonly}]),onMousedown:Pe,onTouchstart:Pe,onWheel:_e,ref:p},[z("div",{class:"v-time-picker-clock__inner",ref:t},[z("div",{class:Ae([{"v-time-picker-clock__hand":!0,"v-time-picker-clock__hand--inner":Ie(u.modelValue)},r.value]),style:al([{transform:`rotate(${u.rotate+w.value*(G.value-u.min)}deg) scaleY(${U(G.value)})`},o.value])},null),B.value.map(D=>{const _=D===G.value;return z("div",{class:Ae([{"v-time-picker-clock__item":!0,"v-time-picker-clock__item--active":_,"v-time-picker-clock__item--disabled":u.disabled||!oe(D)},_&&c.value]),style:al([q(D),_&&g.value])},[z("span",null,[u.format(D)])])})])]))}}),La=ml({ampm:Boolean,color:String,disabled:Boolean,hour:Number,minute:Number,second:Number,period:String,readonly:Boolean,useSeconds:Boolean,value:Number,viewMode:String},"VTimePickerControls"),Ul=dl()({name:"VTimePickerControls",props:La(),emits:{"update:period":u=>!0,"update:viewMode":u=>!0},setup(u,v){let{emit:i,slots:p}=v;const{t}=Fl();return pl(()=>{let s=u.hour;return u.ampm&&(s=s?(s-1)%12+1:12),z("div",{class:"v-time-picker-controls"},[z("div",{class:Ae({"v-time-picker-controls__time":!0,"v-time-picker-controls__time--with-seconds":u.useSeconds})},[e(F,{active:u.viewMode==="hour",color:u.viewMode==="hour"?u.color:void 0,disabled:u.disabled,variant:"tonal",class:Ae({"v-time-picker-controls__time__btn":!0,"v-time-picker-controls__time--with-ampm__btn":u.ampm,"v-time-picker-controls__time--with-seconds__btn":u.useSeconds}),text:u.hour==null?"--":Ee(`${s}`),onClick:()=>i("update:viewMode","hour")},null),z("span",{class:Ae(["v-time-picker-controls__time__separator",{"v-time-picker-controls--with-seconds__time__separator":u.useSeconds}])},[b(":")]),e(F,{active:u.viewMode==="minute",color:u.viewMode==="minute"?u.color:void 0,class:Ae({"v-time-picker-controls__time__btn":!0,"v-time-picker-controls__time__btn__active":u.viewMode==="minute","v-time-picker-controls__time--with-ampm__btn":u.ampm,"v-time-picker-controls__time--with-seconds__btn":u.useSeconds}),disabled:u.disabled,variant:"tonal",text:u.minute==null?"--":Ee(u.minute),onClick:()=>i("update:viewMode","minute")},null),u.useSeconds&&z("span",{class:Ae(["v-time-picker-controls__time__separator",{"v-time-picker-controls--with-seconds__time__separator":u.useSeconds}]),key:"secondsDivider"},[b(":")]),u.useSeconds&&e(F,{key:"secondsVal",active:u.viewMode==="second",color:u.viewMode==="second"?u.color:void 0,variant:"tonal",onClick:()=>i("update:viewMode","second"),class:Ae({"v-time-picker-controls__time__btn":!0,"v-time-picker-controls__time__btn__active":u.viewMode==="second","v-time-picker-controls__time--with-seconds__btn":u.useSeconds}),disabled:u.disabled,text:u.second==null?"--":Ee(u.second)},null),u.ampm&&z("div",{class:"v-time-picker-controls__ampm"},[e(F,{active:u.period==="am",color:u.period==="am"?u.color:void 0,class:Ae({"v-time-picker-controls__ampm__am":!0,"v-time-picker-controls__ampm__btn":!0,"v-time-picker-controls__ampm__btn__active":u.period==="am"}),disabled:u.disabled,text:t("$vuetify.timePicker.am"),variant:u.disabled&&u.period==="am"?"elevated":"tonal",onClick:()=>u.period!=="am"?i("update:period","am"):null},null),e(F,{active:u.period==="pm",color:u.period==="pm"?u.color:void 0,class:Ae({"v-time-picker-controls__ampm__pm":!0,"v-time-picker-controls__ampm__btn":!0,"v-time-picker-controls__ampm__btn__active":u.period==="pm"}),disabled:u.disabled,text:t("$vuetify.timePicker.pm"),variant:u.disabled&&u.period==="pm"?"elevated":"tonal",onClick:()=>u.period!=="pm"?i("update:period","pm"):null},null)])])])}),{}}}),Ra=vl(24),Jl=vl(12),Na=Jl.map(u=>u+12);vl(60);const Oa=ml({allowedHours:[Function,Array],allowedMinutes:[Function,Array],allowedSeconds:[Function,Array],disabled:Boolean,format:{type:String,default:"ampm"},max:String,min:String,viewMode:{type:String,default:"hour"},period:{type:String,default:"am",validator:u=>["am","pm"].includes(u)},modelValue:null,readonly:Boolean,scrollable:Boolean,useSeconds:Boolean,...El(Xt({title:"$vuetify.timePicker.title"}),["landscape"])},"VTimePicker"),qa=dl()({name:"VTimePicker",props:Oa(),emits:{"update:hour":u=>!0,"update:minute":u=>!0,"update:period":u=>!0,"update:second":u=>!0,"update:modelValue":u=>!0,"update:viewMode":u=>!0},setup(u,v){let{emit:i,slots:p}=v;const{t}=Fl(),s=P(null),d=P(null),a=P(null),m=P(null),n=P(null),r=P(null),o=Vl(u,"period","am"),c=Vl(u,"viewMode","hour"),g=P(null),M=P(null),k=Q(()=>{let q;if(u.allowedHours instanceof Array?q=X=>u.allowedHours.includes(X):q=u.allowedHours,!u.min&&!u.max)return q;const H=u.min?Number(u.min.split(":")[0]):0,ue=u.max?Number(u.max.split(":")[0]):23;return X=>X>=Number(H)&&X<=Number(ue)&&(!q||q(X))}),w=Q(()=>{let q;const H=!k.value||s.value===null||k.value(s.value);if(u.allowedMinutes instanceof Array?q=_=>u.allowedMinutes.includes(_):q=u.allowedMinutes,!u.min&&!u.max)return H?q:()=>!1;const[ue,X]=u.min?u.min.split(":").map(Number):[0,0],[Ve,Pe]=u.max?u.max.split(":").map(Number):[23,59],ge=ue*60+Number(X),D=Ve*60+Number(Pe);return _=>{const K=60*s.value+_;return K>=ge&&K<=D&&H&&(!q||q(_))}}),A=Q(()=>{let q;const ue=(!k.value||s.value===null||k.value(s.value))&&(!w.value||d.value===null||w.value(d.value));if(u.allowedSeconds instanceof Array?q=re=>u.allowedSeconds.includes(re):q=u.allowedSeconds,!u.min&&!u.max)return ue?q:()=>!1;const[X,Ve,Pe]=u.min?u.min.split(":").map(Number):[0,0,0],[ge,D,_]=u.max?u.max.split(":").map(Number):[23,59,59],K=X*3600+Ve*60+Number(Pe||0),O=ge*3600+D*60+Number(_||0);return re=>{const be=3600*s.value+60*d.value+re;return be>=K&&be<=O&&ue&&(!q||q(re))}}),G=Q(()=>u.format==="ampm");Ue(()=>u.period,q=>U(q)),Ue(()=>u.modelValue,q=>_e(q)),$e(()=>{_e(u.modelValue)});function ee(){return s.value!=null&&d.value!=null&&(!u.useSeconds||a.value!=null)?`${Ee(s.value)}:${Ee(d.value)}`+(u.useSeconds?`:${Ee(a.value)}`:""):null}function B(){const q=ee();q!==null&&i("update:modelValue",q)}function y(q){return q?(q-1)%12+1:12}function oe(q,H){return q%12+(H==="pm"?12:0)}function _e(q){if(q==null||q==="")s.value=null,d.value=null,a.value=null;else if(q instanceof Date)s.value=q.getHours(),d.value=q.getMinutes(),a.value=q.getSeconds();else{const[H,,ue,,X,Ve]=q.trim().toLowerCase().match(/^(\d+):(\d+)(:(\d+))?([ap]m)?$/)||new Array(6);s.value=Ve?oe(parseInt(H,10),Ve):parseInt(H,10),d.value=parseInt(ue,10),a.value=parseInt(X||0,10)}o.value=s.value==null||s.value<12?"am":"pm"}function Ie(q,H){const ue=k.value;if(!ue)return H;const X=G.value?H<12?Jl:Na:Ra;return((X.find(Pe=>ue((Pe+H)%X.length+X[0]))||0)+H)%X.length+X[0]}function U(q){if(o.value=q,s.value!=null){const H=s.value+(o.value==="am"?-12:12);s.value=Ie("hour",H)}return i("update:period",q),B(),!0}function xe(q){c.value==="hour"?s.value=G.value?oe(q,o.value):q:c.value==="minute"?d.value=q:a.value=q}function pe(q){switch(c.value||"hour"){case"hour":i("update:hour",q);break;case"minute":i("update:minute",q);break;case"second":i("update:second",q);break}const H=s.value!==null&&d.value!==null&&(u.useSeconds?a.value!==null:!0);c.value==="hour"?c.value="minute":u.useSeconds&&c.value==="minute"&&(c.value="second"),!(s.value===m.value&&d.value===n.value&&(!u.useSeconds||a.value===r.value)||ee()===null)&&(m.value=s.value,n.value=d.value,u.useSeconds&&(r.value=a.value),H&&B())}pl(()=>{const q=Sl.filterProps(u),H=Ul.filterProps(u),ue=Al.filterProps(El(u,["format","modelValue","min","max"]));return e(Sl,fe(q,{color:void 0,class:["v-time-picker",u.class],style:u.style}),{title:()=>p.title?.()??z("div",{class:"v-time-picker__title"},[t(u.title)]),header:()=>e(Ul,fe(H,{ampm:G.value,hour:s.value,minute:d.value,period:o.value,second:a.value,viewMode:c.value,"onUpdate:period":X=>U(X),"onUpdate:viewMode":X=>c.value=X,ref:g}),null),default:()=>e(Al,fe(ue,{allowedValues:c.value==="hour"?k.value:c.value==="minute"?w.value:A.value,double:c.value==="hour"&&!G.value,format:c.value==="hour"?G.value?y:X=>X:X=>Ee(X,2),max:c.value==="hour"?G.value&&o.value==="am"?11:23:59,min:c.value==="hour"&&G.value&&o.value==="pm"?12:0,size:20,step:c.value==="hour"?1:5,modelValue:c.value==="hour"?s.value:c.value==="minute"?d.value:a.value,onChange:pe,onInput:xe,ref:M}),null),actions:p.actions})})}}),ja=W({__name:"TimeField",props:Se({hideDetails:{type:Boolean},readonly:{type:Boolean}},{modelValue:{required:!0},modelModifiers:{}}),emits:["update:modelValue"],setup(u){const v=u,i=we(u,"modelValue"),p=Q(()=>new Date(i.value).toLocaleTimeString(void 0,{hour:"numeric",minute:"numeric"}));function t(a){const[m,n]=a.split(":"),r=new Date(i.value);r.setHours(Number(m),Number(n)),i.value=r.toISOString()}function s(a){const m=new Date(a),n=new Date(i.value);m.setHours(n.getHours(),n.getMinutes(),n.getSeconds()),i.value=m.toISOString()}const d=P(!1);return(a,m)=>{const n=jl;return f(),x($,{"no-gutters":""},{default:l(()=>[e(V,null,{default:l(()=>[e(n,{class:"mr-2",label:"Date","model-value":I(ft)(new Date(i.value)),"onUpdate:modelValue":s,"hide-details":v.hideDetails,readonly:v.readonly},null,8,["model-value","hide-details","readonly"])]),_:1}),e(V,{cols:"auto"},{default:l(()=>[...m[1]||(m[1]=[z("div",{class:"ma-2"},null,-1)])]),_:1}),e(V,null,{default:l(()=>[e(ke,{"close-on-content-click":!1,modelValue:d.value,"onUpdate:modelValue":m[0]||(m[0]=r=>d.value=r)},{activator:l(({props:r})=>[e(se,fe({class:"center-text"},r,{variant:"outlined",density:"compact","hide-details":v.hideDetails,label:"Moment","model-value":p.value}),null,16,["hide-details","model-value"])]),default:l(()=>[e(qa,{"model-value":new Date(i.value),"onUpdate:modelValue":t,format:"24hr"},null,8,["model-value"])]),_:1},8,["modelValue"])]),_:1})]),_:1})}}}),Ba=Bl(ja,[["__scopeId","data-v-32955f86"]]),Ha=W({__name:"PaiementEditCard",props:{paiement:{}},emits:["update","delete"],setup(u,{emit:v}){const i=u,p=v,t=P(Ce(i.paiement)),s=Q(()=>!0),d=P(!1);return(a,m)=>{const n=Kt,r=Be,o=Ba;return f(),x(E,{title:"Modifier le paiement"},{default:l(()=>[e(Y,{modelValue:d.value,"onUpdate:modelValue":m[1]||(m[1]=c=>d.value=c),"max-width":"400px"},{default:l(()=>[e(E,{title:"Confirmation"},{default:l(()=>[e(T,null,{default:l(()=>[...m[11]||(m[11]=[b(" Confirmez-vous la suppression de ce paiement ? ",-1),z("br",null,null,-1),z("br",null,null,-1),b(" Attention, cette opération est irréversible. ",-1)])]),_:1}),e(le,null,{default:l(()=>[e(te),e(F,{color:"red",onClick:m[0]||(m[0]=c=>{d.value=!1,p("delete")})},{default:l(()=>[...m[12]||(m[12]=[b("Supprimer",-1)])]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"]),e(T,null,{default:l(()=>[e($,null,{default:l(()=>[e(V,null,{default:l(()=>[e(se,{density:"compact",variant:"outlined","hide-details":"",label:"Payé par",modelValue:t.value.Payeur,"onUpdate:modelValue":m[2]||(m[2]=c=>t.value.Payeur=c)},null,8,["modelValue"])]),_:1}),e(V,null,{default:l(()=>[e(se,{density:"compact",variant:"outlined","hide-details":"",label:"Description (optionelle)",modelValue:t.value.Label,"onUpdate:modelValue":m[3]||(m[3]=c=>t.value.Label=c)},null,8,["modelValue"])]),_:1})]),_:1}),e($,null,{default:l(()=>[e(V,null,{default:l(()=>[e(n,{modelValue:t.value.Mode,"onUpdate:modelValue":m[4]||(m[4]=c=>t.value.Mode=c),"hide-details":""},null,8,["modelValue"])]),_:1}),e(V,null,{default:l(()=>[e(r,{label:"Montant",modelValue:t.value.Montant,"onUpdate:modelValue":m[5]||(m[5]=c=>t.value.Montant=c),"hide-details":""},null,8,["modelValue"])]),_:1})]),_:1}),e($,null,{default:l(()=>[e(V,null,{default:l(()=>[e(Le,{"hide-details":"",density:"compact",label:"Remboursement ?",modelValue:t.value.IsRemboursement,"onUpdate:modelValue":m[6]||(m[6]=c=>t.value.IsRemboursement=c)},null,8,["modelValue"])]),_:1})]),_:1}),e($,null,{default:l(()=>[e(V,null,{default:l(()=>[e(o,{modelValue:t.value.Time,"onUpdate:modelValue":m[7]||(m[7]=c=>t.value.Time=c),"hide-details":""},null,8,["modelValue"])]),_:1})]),_:1}),e($,null,{default:l(()=>[e(V,null,{default:l(()=>[e(se,{density:"compact",variant:"outlined",label:"Détails (optionnel)",modelValue:t.value.Details,"onUpdate:modelValue":m[8]||(m[8]=c=>t.value.Details=c)},null,8,["modelValue"])]),_:1})]),_:1})]),_:1}),e(le,null,{default:l(()=>[e(F,{color:"red",onClick:m[9]||(m[9]=c=>d.value=!0)},{default:l(()=>[...m[13]||(m[13]=[b("Supprimer le paiement",-1)])]),_:1}),e(te),e(F,{onClick:m[10]||(m[10]=c=>p("update",t.value)),disabled:!s.value},{default:l(()=>[...m[14]||(m[14]=[b("Enregistrer",-1)])]),_:1},8,["disabled"])]),_:1})]),_:1})}}}),za=W({__name:"DossierEditCard",props:{responsable:{},dossier:{}},emits:["save"],setup(u,{emit:v}){const i=u,p=v,t=P(Ce(i.dossier));return(s,d)=>{const a=Ge,m=Hl,n=cl;return f(),x(E,null,{default:l(()=>[e(T,null,{default:l(()=>[e($,null,{default:l(()=>[e(V,null,{default:l(()=>[e(a,{label:"Responsable","initial-personne":i.responsable,"model-value":t.value.IdResponsable,"onUpdate:modelValue":d[0]||(d[0]=r=>r?t.value.IdResponsable=r:void 0),api:{SelectPersonne:I(C).SelectPersonne.bind(I(C))}},null,8,["initial-personne","model-value","api"])]),_:1})]),_:1}),e($,null,{default:l(()=>[e(V,null,{default:l(()=>[e(m,{label:"Adresses mail en copie",modelValue:t.value.CopiesMails,"onUpdate:modelValue":d[1]||(d[1]=r=>t.value.CopiesMails=r),rule:I(Vt).validMails()},null,8,["modelValue","rule"])]),_:1})]),_:1}),e($,null,{default:l(()=>[e(V,null,{default:l(()=>[e(n,{"hide-details":"",modelValue:t.value.PartageAdressesOK,"onUpdate:modelValue":d[2]||(d[2]=r=>t.value.PartageAdressesOK=r),label:"Partage des coordonnées"},null,8,["modelValue"])]),_:1})]),_:1}),e($,null,{default:l(()=>[e(V,null,{default:l(()=>[e(n,{"hide-details":"",modelValue:t.value.DemandeFondSoutien,"onUpdate:modelValue":d[3]||(d[3]=r=>t.value.DemandeFondSoutien=r),label:"Demande le fonds de soutien"},null,8,["modelValue"])]),_:1})]),_:1})]),_:1}),e(le,null,{default:l(()=>[e(te),e(F,{onClick:d[4]||(d[4]=r=>p("save",t.value))},{default:l(()=>[...d[5]||(d[5]=[b("Enregistrer",-1)])]),_:1})]),_:1})]),_:1})}}}),Qa=W({__name:"OptionJournee",props:Se({camp:{}},{modelValue:{required:!0},modelModifiers:{}}),emits:["update:modelValue"],setup(u){const v=u,i=we(u,"modelValue"),p=Q(()=>(v.camp.OptionPrix.Jours||[]).map((t,s)=>s));return(t,s)=>(f(),x(E,null,{default:l(()=>[e(T,null,{default:l(()=>[s[1]||(s[1]=z("div",{class:"text-grey mb-2"}," Le prix est variable en fonction des jours de participation au camp. ",-1)),e(bt,{class:"overflow-x-auto",color:"secondary",multiple:"","model-value":i.value?.length?i.value:p.value,"onUpdate:modelValue":s[0]||(s[0]=d=>i.value=d.length==p.value.length?[]:d)},{default:l(()=>[(f(!0),j(Z,null,ne(v.camp.OptionPrix.Jours,(d,a)=>(f(),x(F,null,{default:l(()=>[b("J "+S(a+1),1)]),_:2},1024))),256))]),_:1},8,["model-value"])]),_:1})]),_:1}))}}),Ja=W({__name:"OptionStatut",props:Se({camp:{}},{modelValue:{required:!0},modelModifiers:{}}),emits:["update:modelValue"],setup(u){const v=u,i=we(u,"modelValue"),p=Q(()=>(v.camp.OptionPrix.Statuts||[]).map(s=>({value:s.Id,title:s.Label,subtitle:s.Description}))),t=Q(()=>p.value.map(s=>s.value).includes(i.value));return(s,d)=>(f(),x(E,null,{default:l(()=>[e(T,null,{default:l(()=>[d[1]||(d[1]=z("div",{class:"text-grey mb-4"},"Le prix dépend du statut du participant.",-1)),e(Fe,{clearable:"",items:p.value,label:"Statut","model-value":t.value?i.value:null,"onUpdate:modelValue":d[0]||(d[0]=a=>i.value=a??0),variant:"outlined",density:"comfortable","hide-details":""},{item:l(({item:a,props:m})=>[e(L,fe(m,{title:a.title,subtitle:a.raw.subtitle}),null,16,["title","subtitle"])]),_:1},8,["items","model-value"])]),_:1})]),_:1}))}}),Ga={key:2},Ka=W({__name:"ParticipantOptionPrix",props:{camp:{},optionAndQf:{}},emits:["update"],setup(u,{emit:v}){const i=u,p=v,t=P(Ce(i.optionAndQf));return Ue(()=>i.optionAndQf,()=>t.value=Ce(i.optionAndQf)),(s,d)=>{const a=je;return f(),x(E,{title:"Prix variable",width:"800px"},{default:l(()=>[e(T,null,{default:l(()=>[e($,{justify:"space-evenly"},{default:l(()=>[e(V,{"align-self":"center",cols:"3"},{default:l(()=>[e(a,{modelValue:t.value.quotientFamilial,"onUpdate:modelValue":d[0]||(d[0]=m=>t.value.quotientFamilial=m),label:"Quotient familial","hide-details":""},null,8,["modelValue"])]),_:1}),e(h,{thickness:"2",vertical:""}),e(V,{"align-self":"center",cols:"8"},{default:l(()=>[i.camp.OptionPrix.Active==I(De).PrixJour?(f(),x(Qa,{key:0,camp:i.camp,modelValue:t.value.options.Jour,"onUpdate:modelValue":d[1]||(d[1]=m=>t.value.options.Jour=m)},null,8,["camp","modelValue"])):i.camp.OptionPrix.Active==I(De).PrixStatut?(f(),x(Ja,{key:1,camp:i.camp,modelValue:t.value.options.IdStatut,"onUpdate:modelValue":d[2]||(d[2]=m=>t.value.options.IdStatut=m)},null,8,["camp","modelValue"])):(f(),j("div",Ga,"Le camp ne propose pas d'option sur le prix."))]),_:1})]),_:1})]),_:1}),e(le,null,{default:l(()=>[e(te),e(F,{onClick:d[3]||(d[3]=m=>p("update",t.value))},{default:l(()=>[...d[4]||(d[4]=[b("Enregistrer",-1)])]),_:1})]),_:1})]),_:1})}}}),Ya={key:1,class:"mx-1"},Wa={key:2,class:"mx-1"},Za={key:3},Xa={key:4,class:"mx-1"},ha=W({__name:"RemisesChip",props:{remises:{}},emits:["update"],setup(u,{emit:v}){const i=u,p=v,t=Q(()=>s.value.Famille!=0||s.value.Equipiers!=0||s.value.Speciale.Cent!=0),s=P(Ce(i.remises));Ue(()=>i.remises,()=>s.value=Ce(i.remises));const d=P(!1);return(a,m)=>{const n=je,r=Be;return f(),x(ke,{"close-on-content-click":!1,location:"bottom",modelValue:d.value,"onUpdate:modelValue":m[4]||(m[4]=o=>d.value=o)},{activator:l(({props:o})=>[e(E,fe(o,{elevation:"1",color:"grey-lighten-2"}),{default:l(()=>[e(T,{class:"py-1 px-1"},{default:l(()=>[t.value?J("",!0):(f(),j(Z,{key:0},[b(" Pas de remises ")],64)),s.value.Famille?(f(),j("span",Ya," Inscrits : "+S(s.value.Famille)+"% ",1)):J("",!0),s.value.Equipiers?(f(),j("span",Wa," Equipiers : "+S(s.value.Equipiers)+"% ",1)):J("",!0),(s.value.Famille||s.value.Equipiers)&&s.value.Speciale.Cent?(f(),j("br",Za)):J("",!0),s.value.Speciale.Cent?(f(),j("span",Xa," Remise : "+S(I(ve).montant(s.value.Speciale)),1)):J("",!0)]),_:1})]),_:1},16)]),default:l(()=>[e(E,{title:"Modifier les remises",width:"400px"},{default:l(()=>[e(T,null,{default:l(()=>[e($,null,{default:l(()=>[e(V,null,{default:l(()=>[e(n,{modelValue:s.value.Famille,"onUpdate:modelValue":m[0]||(m[0]=o=>s.value.Famille=o),label:"Remise inscrits","hide-details":"",suffix:"%"},null,8,["modelValue"])]),_:1}),e(V,null,{default:l(()=>[e(n,{modelValue:s.value.Equipiers,"onUpdate:modelValue":m[1]||(m[1]=o=>s.value.Equipiers=o),label:"Remise équipiers","hide-details":"",suffix:"%"},null,8,["modelValue"])]),_:1})]),_:1}),e($,null,{default:l(()=>[e(V,null,{default:l(()=>[e(r,{class:"mt-2",modelValue:s.value.Speciale,"onUpdate:modelValue":m[2]||(m[2]=o=>s.value.Speciale=o),label:"Remise spéciale","hide-details":""},null,8,["modelValue"])]),_:1})]),_:1})]),_:1}),e(le,null,{default:l(()=>[e(te),e(F,{onClick:m[3]||(m[3]=o=>{p("update",s.value),d.value=!1})},{default:l(()=>[...m[5]||(m[5]=[b("Enregistrer",-1)])]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"])}}}),en=Bl(ha,[["__scopeId","data-v-06eacfe8"]]),ln=W({__name:"AideEditCard",props:{aide:{},file:{},structures:{},participant:{}},emits:["save","deleteFile","uploadFile","showStructureaides"],setup(u,{emit:v}){const i=u,p=v,t=P(Ce(i.aide)),s=Q(()=>Object.values(i.structures).map(d=>({value:d.Id,title:d.Nom})));return(d,a)=>{const m=cl,n=Be,r=je,o=ta;return f(),x(E,{title:"Modifier l'aide extérieure",subtitle:`pour ${I(Me).label(i.participant.Personne)} - ${I(ce).label(i.participant.Camp)}`},{append:l(()=>[e(F,{onClick:a[0]||(a[0]=c=>p("showStructureaides"))},{default:l(()=>[e(ye,null,{default:l(()=>[...a[9]||(a[9]=[b("mdi-view-list",-1)])]),_:1}),a[10]||(a[10]=b(" Structures",-1))]),_:1})]),default:l(()=>[e(T,null,{default:l(()=>[e($,null,{default:l(()=>[e(V,null,{default:l(()=>[e(Fe,{variant:"outlined",density:"comfortable",label:"Structure",items:s.value,modelValue:t.value.IdStructureaide,"onUpdate:modelValue":a[1]||(a[1]=c=>t.value.IdStructureaide=c)},null,8,["items","modelValue"])]),_:1}),e(V,null,{default:l(()=>[e(m,{modelValue:t.value.Valide,"onUpdate:modelValue":a[2]||(a[2]=c=>t.value.Valide=c),label:"Aide validée","hide-details":""},null,8,["modelValue"])]),_:1})]),_:1}),e($,null,{default:l(()=>[e(V,{"align-self":"center"},{default:l(()=>[e(n,{modelValue:t.value.Valeur,"onUpdate:modelValue":a[3]||(a[3]=c=>t.value.Valeur=c),label:"Montant","hide-details":""},null,8,["modelValue"])]),_:1}),e(V,{"align-self":"center",cols:"auto"},{default:l(()=>[e(m,{"hide-details":"",label:"Par jour",modelValue:t.value.ParJour,"onUpdate:modelValue":a[4]||(a[4]=c=>t.value.ParJour=c)},null,8,["modelValue"])]),_:1}),e(V,{"align-self":"center"},{default:l(()=>[e(r,{label:"Limite",suffix:"jours",modelValue:t.value.NbJoursMax,"onUpdate:modelValue":a[5]||(a[5]=c=>t.value.NbJoursMax=c),disabled:!t.value.ParJour,hint:"0 pour ne pas limiter",min:0,"persistent-hint":""},null,8,["modelValue","disabled"])]),_:1})]),_:1}),e(o,{class:"mt-4",files:i.file?[i.file]:[],title:"Document justificatif","max-docs":1,"in-upload":!1,onDelete:a[6]||(a[6]=c=>p("deleteFile")),onUpload:a[7]||(a[7]=c=>p("uploadFile",c))},null,8,["files"])]),_:1}),e(le,null,{default:l(()=>[e(te),e(F,{onClick:a[8]||(a[8]=c=>p("save",t.value))},{default:l(()=>[...a[11]||(a[11]=[b("Enregistrer",-1)])]),_:1})]),_:1})]),_:1},8,["subtitle"])}}}),tn=W({__name:"StructuresPannel",props:{modelValue:{required:!0},modelModifiers:{}},emits:["update:modelValue"],setup(u){const v=we(u,"modelValue"),i=Q(()=>Object.values(v.value||{}).sort((m,n)=>m.Nom.localeCompare(n.Nom)));async function p(){const m=await C.StructureaideCreate();if(m===void 0)return;C.showMessage("Structure créée avec succès.");const n=v.value||{};n[m.Id]=m,v.value=n,t.value=m}const t=P(null);async function s(){const m=t.value;if(m==null||(t.value=null,await C.StructureaideUpdate(m)===void 0))return;C.showMessage("Structure modifiée avec succès.");const r=v.value||{};r[m.Id]=m,v.value=r}const d=P(null);async function a(){const m=d.value;if(m==null||(d.value=null,await C.StructureaideDelete({id:m.Id})===void 0))return;const r=v.value||{};delete r[m.Id],v.value=r,C.showMessage("Structure supprimée avec succès.")}return(m,n)=>(f(),x(E,{title:"Structures d'aide",subtitle:"Organismes pouvant distribuer une aide extérieure"},{append:l(()=>[e(F,{onClick:p},{prepend:l(()=>[e(ye,{color:"green"},{default:l(()=>[...n[5]||(n[5]=[b("mdi-plus",-1)])]),_:1})]),default:l(()=>[n[6]||(n[6]=b(" Ajouter une structure ",-1))]),_:1})]),default:l(()=>[e(T,{class:"overflow-y-auto"},{default:l(()=>[(f(!0),j(Z,null,ne(i.value,r=>(f(),x($,null,{default:l(()=>[e(V,{"align-self":"center"},{default:l(()=>[e(Rl,null,{default:l(()=>[b(S(r.Nom),1)]),_:2},1024),e(Nl,null,{default:l(()=>[b(S(r.Immatriculation),1)]),_:2},1024)]),_:2},1024),e(V,{"align-self":"center",style:{"font-size":"smaller"}},{default:l(()=>[(f(!0),j(Z,null,ne(r.Info.split(`
`),o=>(f(),j("div",null,S(o),1))),256))]),_:2},1024),e(V,{"align-self":"center",cols:"auto"},{default:l(()=>[e(ke,null,{activator:l(({props:o})=>[e(F,fe({icon:"mdi-dots-vertical"},{ref_for:!0},o,{size:"x-small"}),null,16)]),default:l(()=>[e(me,null,{default:l(()=>[e(L,{title:"Modifier","prepend-icon":"mdi-pencil",onClick:o=>t.value=I(Ce)(r)},null,8,["onClick"]),e(L,{title:"Supprimer","prepend-icon":"mdi-delete",onClick:o=>d.value=r},null,8,["onClick"])]),_:2},1024)]),_:2},1024)]),_:2},1024)]),_:2},1024))),256))]),_:1}),e(Y,{"model-value":t.value!=null,"onUpdate:modelValue":n[3]||(n[3]=r=>t.value=null),"max-width":"600px"},{default:l(()=>[t.value!=null?(f(),x(E,{key:0,title:"Modifier la structure"},{default:l(()=>[e(T,null,{default:l(()=>[e($,null,{default:l(()=>[e(V,null,{default:l(()=>[e(se,{variant:"outlined",density:"compact",label:"Nom",modelValue:t.value.Nom,"onUpdate:modelValue":n[0]||(n[0]=r=>t.value.Nom=r),"hide-details":""},null,8,["modelValue"])]),_:1}),e(V,null,{default:l(()=>[e(se,{variant:"outlined",density:"compact",label:"Immatriculation",modelValue:t.value.Immatriculation,"onUpdate:modelValue":n[1]||(n[1]=r=>t.value.Immatriculation=r),"hide-details":""},null,8,["modelValue"])]),_:1})]),_:1}),e($,null,{default:l(()=>[e(V,null,{default:l(()=>[e(Xe,{variant:"outlined",density:"compact",label:"Informations",modelValue:t.value.Info,"onUpdate:modelValue":n[2]||(n[2]=r=>t.value.Info=r),"hide-details":""},null,8,["modelValue"])]),_:1})]),_:1})]),_:1}),e(le,null,{default:l(()=>[e(te),e(F,{onClick:s},{default:l(()=>[...n[7]||(n[7]=[b("Enregistrer",-1)])]),_:1})]),_:1})]),_:1})):J("",!0)]),_:1},8,["model-value"]),e(Y,{"model-value":d.value!=null,"onUpdate:modelValue":n[4]||(n[4]=r=>d.value=null),"max-width":"450px"},{default:l(()=>[d.value!=null?(f(),x(E,{key:0,title:"Confirmation"},{default:l(()=>[e(T,null,{default:l(()=>[b(" Confirmez-vous la suppression de la structure "+S(d.value.Nom)+" ? ",1),n[8]||(n[8]=z("br",null,null,-1)),n[9]||(n[9]=z("br",null,null,-1)),n[10]||(n[10]=b(" Attention, cette opération est irréversible. ",-1))]),_:1}),e(le,null,{default:l(()=>[e(te),e(F,{color:"red",onClick:a},{default:l(()=>[...n[11]||(n[11]=[b("Supprimer",-1)])]),_:1})]),_:1})]),_:1})):J("",!0)]),_:1},8,["model-value"])]),_:1}))}}),an={key:0},nn={key:1},un=W({__name:"DossierParticipantRow",props:Se({participant:{},aides:{},aidesFiles:{},hasManyParticipants:{type:Boolean}},{structures:{required:!0},structuresModifiers:{}}),emits:Se(["update","delete","createAide","updateAide","deleteAide","deleteFileAide","uploadFileAide","expand"],["update:structures"]),setup(u,{emit:v}){const i=u,p=we(u,"structures"),t=v,s=Q(()=>{const k=Object.values(i.aides||{});return k.sort((w,A)=>w.Id-A.Id),k}),d=Q(()=>i.participant.Camp.OptionPrix.Active==De.NoOption&&!ce.isQuotientFamilialActive(i.participant.Camp.OptionQuotientFamilial));function a(k){switch(i.participant.Camp.OptionPrix.Active){case De.NoOption:return"Séjour sans option";case De.PrixJour:const w=k.Jour?.length||0;return w==0?"Présent tous les jours":`Présent ${w} jour${w>1?"s":""}`;case De.PrixStatut:const A=i.participant.Camp.OptionPrix.Statuts?.find(G=>G.Id==k.IdStatut);return A?`Statut ${A.Label}`:"Pas d'option."}}const m=P(!1),n=P(!1),r=Q(()=>Object.values(p.value).map(k=>({value:k.Id,title:k.Nom})).sort((k,w)=>k.title.localeCompare(w.title))),o=P(null),c=P(null),g=P(null),M=P(!1);return(k,w)=>(f(),x($,null,{default:l(()=>[e(V,{"align-self":"center",cols:"3"},{default:l(()=>[e(Rl,null,{default:l(()=>[z("a",{href:"/camps",onClick:w[0]||(w[0]=Oe(A=>I(fl)(i.participant.Participant),["prevent"]))},S(I(Me).label(i.participant.Personne)),1)]),_:1}),e(Nl,null,{default:l(()=>[b(S(I(ce).label(i.participant.Camp)),1)]),_:1})]),_:1}),e(V,{"align-self":"center",cols:"2",class:"text-center"},{default:l(()=>[e(ke,{disabled:d.value,"close-on-content-click":!1,modelValue:m.value,"onUpdate:modelValue":w[2]||(w[2]=A=>m.value=A)},{activator:l(({props:A})=>[e(E,fe(A,{elevation:d.value?0:1,color:"grey-lighten-2"}),{default:l(()=>[e(T,{class:"py-1 px-1"},{default:l(()=>[d.value?(f(),j("div",an,"Camp sans option")):(f(),j("div",nn,[b(S(i.participant.Participant.QuotientFamilial?`QF ${i.participant.Participant.QuotientFamilial}.`:"Pas de QF.")+" ",1),w[22]||(w[22]=z("br",null,null,-1)),b(" "+S(a(i.participant.Participant.OptionPrix)),1)]))]),_:1})]),_:1},16,["elevation"])]),default:l(()=>[e(Ka,{camp:i.participant.Camp,"option-and-qf":{options:i.participant.Participant.OptionPrix,quotientFamilial:i.participant.Participant.QuotientFamilial},onUpdate:w[1]||(w[1]=A=>{i.participant.Participant.OptionPrix=A.options,i.participant.Participant.QuotientFamilial=A.quotientFamilial,m.value=!1,t("update",i.participant.Participant)})},null,8,["camp","option-and-qf"])]),_:1},8,["disabled","modelValue"])]),_:1}),e(V,{"align-self":"center",class:"text-center"},{default:l(()=>[s.value.length?J("",!0):(f(),x(de,{key:0,label:""},{default:l(()=>[...w[23]||(w[23]=[b("Aucune aide",-1)])]),_:1})),(f(!0),j(Z,null,ne(s.value,A=>(f(),x(de,{class:"my-1","prepend-icon":"mdi-cash-plus",color:A.Valide?"green":"orange",onClick:G=>c.value=A},{close:l(()=>[e(ye,{icon:"mdi-close-circle",onClick:Oe(G=>g.value=A,["stop"])},null,8,["onClick"])]),default:l(()=>[b(" "+S(p.value[A.IdStructureaide].Nom)+" : "+S(I(ve).montant(A.Valeur)),1)]),_:2},1032,["color","onClick"]))),256))]),_:1}),e(V,{"align-self":"center",class:"text-center",cols:"3"},{default:l(()=>[e(en,{remises:i.participant.Participant.Remises,onUpdate:w[3]||(w[3]=A=>{i.participant.Participant.Remises=A,t("update",i.participant.Participant)})},null,8,["remises"])]),_:1}),e(V,{"align-self":"center",cols:"auto"},{default:l(()=>[e(ke,{location:"left"},{activator:l(({props:A})=>[e(F,fe(A,{icon:"mdi-dots-vertical",size:"small"}),null,16)]),default:l(()=>[e(me,{density:"comfortable"},{default:l(()=>[e(L,{title:"Ajouter une aide","prepend-icon":"mdi-cash-plus",onClick:w[4]||(w[4]=A=>o.value={IdParticipant:i.participant.Participant.Id,IdStructure:0})}),e(h),i.hasManyParticipants?(f(),x(L,{key:0,"prepend-icon":"mdi-arrow-expand",title:"Étendre les options et remises",subtitle:"... au reste du dossier",onClick:w[5]||(w[5]=A=>t("expand"))})):J("",!0),e(h),e(L,{title:"Supprimer","prepend-icon":"mdi-delete",onClick:w[6]||(w[6]=A=>n.value=!0)})]),_:1})]),_:1})]),_:1}),e(Y,{modelValue:n.value,"onUpdate:modelValue":w[8]||(w[8]=A=>n.value=A),"max-width":"600px"},{default:l(()=>[e(E,{title:"Supprimer le participant"},{default:l(()=>[e(T,null,{default:l(()=>[...w[24]||(w[24]=[b(" Confirmez-vous la suppression de ce participant ? ",-1),z("br",null,null,-1),b(" Attention, cette opération est irréversible. ",-1)])]),_:1}),e(le,null,{default:l(()=>[e(te),e(F,{color:"red",onClick:w[7]||(w[7]=A=>{t("delete"),n.value=!1})},{default:l(()=>[...w[25]||(w[25]=[b("Supprimer",-1)])]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"]),e(Y,{modelValue:M.value,"onUpdate:modelValue":w[10]||(w[10]=A=>M.value=A),"max-width":"650px"},{default:l(()=>[e(tn,{modelValue:p.value,"onUpdate:modelValue":w[9]||(w[9]=A=>p.value=A)},null,8,["modelValue"])]),_:1},8,["modelValue"]),o.value!=null?(f(),x(Y,{key:0,"model-value":o.value!=null,"onUpdate:modelValue":w[14]||(w[14]=A=>o.value=null),width:"600px"},{default:l(()=>[e(E,{title:"Ajouter une aide extérieure"},{append:l(()=>[e(F,{onClick:w[11]||(w[11]=A=>M.value=!0),"prepend-icon":"mdi-view-list"},{default:l(()=>[...w[26]||(w[26]=[b(" Structures",-1)])]),_:1})]),default:l(()=>[e(T,null,{default:l(()=>[e(Fe,{variant:"outlined",density:"comfortable",label:"Structure",items:r.value,"model-value":o.value.IdStructure==0?null:o.value.IdStructure,"onUpdate:modelValue":w[12]||(w[12]=A=>o.value.IdStructure=A)},null,8,["items","model-value"])]),_:1}),e(le,null,{default:l(()=>[e(te),e(F,{color:"green",onClick:w[13]||(w[13]=A=>{t("createAide",o.value),o.value=null}),disabled:o.value.IdStructure==0},{default:l(()=>[...w[27]||(w[27]=[b("Créer",-1)])]),_:1},8,["disabled"])]),_:1})]),_:1})]),_:1},8,["model-value"])):J("",!0),c.value!=null?(f(),x(Y,{key:1,"model-value":c.value!=null,"onUpdate:modelValue":w[19]||(w[19]=A=>c.value=null),"max-width":"800px"},{default:l(()=>[e(ln,{aide:c.value,file:u.aidesFiles[c.value.Id],structures:p.value,participant:i.participant,onShowStructureaides:w[15]||(w[15]=A=>M.value=!0),onSave:w[16]||(w[16]=A=>{t("updateAide",A),c.value=null}),onDeleteFile:w[17]||(w[17]=A=>t("deleteFileAide",c.value.Id)),onUploadFile:w[18]||(w[18]=A=>t("uploadFileAide",A,c.value.Id))},null,8,["aide","file","structures","participant"])]),_:1},8,["model-value"])):J("",!0),g.value!=null?(f(),x(Y,{key:2,"model-value":g.value!=null,"onUpdate:modelValue":w[21]||(w[21]=A=>g.value=null),"max-width":"600px"},{default:l(()=>[e(E,{title:"Supprimer l'aide"},{default:l(()=>[e(T,null,{default:l(()=>[...w[28]||(w[28]=[b(" Confirmez-vous la suppression de l'aide extérieure ? ",-1),z("br",null,null,-1),b(" Attention, cette opération est irréversible. ",-1)])]),_:1}),e(le,null,{default:l(()=>[e(te),e(F,{color:"red",onClick:w[20]||(w[20]=A=>{t("deleteAide",g.value.Id),g.value=null})},{default:l(()=>[...w[29]||(w[29]=[b("Supprimer",-1)])]),_:1})]),_:1})]),_:1})]),_:1},8,["model-value"])):J("",!0)]),_:1}))}}),sn=W({__name:"DossierEditor",props:{dossier:{},camps:{}},emits:["updateDossier","createParticipant","updateParticipant","deleteParticipant","expandParticipant","createAide","updateAide","deleteAide","deleteFileAide","uploadFileAide"],setup(u,{emit:v}){const i=u,p=v,t=P(null);$e(a);const s=P(!0),d=P({});async function a(){const m=await C.StructureaidesGet();m!==void 0&&(s.value=!1,d.value=m||{})}return(m,n)=>(f(),x(E,{title:"Modifier le dossier"},{append:l(()=>[e(F,{onClick:n[0]||(n[0]=r=>t.value={IdCamp:0,IdPersonne:0,IdDossier:i.dossier.Dossier.Dossier.Id})},{prepend:l(()=>[e(ye,{color:"green"},{default:l(()=>[...n[9]||(n[9]=[b("mdi-plus",-1)])]),_:1})]),default:l(()=>[n[10]||(n[10]=b(" Ajouter un participant",-1))]),_:1})]),default:l(()=>[e(T,null,{default:l(()=>[e($,null,{default:l(()=>[e(V,{cols:"3"},{default:l(()=>[e(za,{responsable:i.dossier.Dossier.Responsable,dossier:i.dossier.Dossier.Dossier,onSave:n[1]||(n[1]=r=>p("updateDossier",r))},null,8,["responsable","dossier"])]),_:1}),e(h,{thickness:"2",vertical:""}),s.value?J("",!0):(f(),x(V,{key:0},{default:l(()=>[n[11]||(n[11]=z("div",{class:"my-1"},null,-1)),(f(!0),j(Z,null,ne(i.dossier.Dossier.Participants,r=>(f(),x(un,{participant:r,aides:(i.dossier.Dossier.Aides||{})[r.Participant.Id],"aides-files":i.dossier.Dossier.AidesFiles||{},"has-many-participants":(i.dossier.Dossier.Participants?.length||0)>1,structures:d.value,"onUpdate:structures":n[2]||(n[2]=o=>d.value=o),onCreateAide:n[3]||(n[3]=o=>p("createAide",o)),onDeleteAide:n[4]||(n[4]=o=>p("deleteAide",o)),onUpdateAide:n[5]||(n[5]=o=>p("updateAide",o)),onDeleteFileAide:n[6]||(n[6]=o=>p("deleteFileAide",o)),onUploadFileAide:n[7]||(n[7]=(o,c)=>p("uploadFileAide",o,c)),onUpdate:n[8]||(n[8]=o=>p("updateParticipant",o)),onDelete:o=>p("deleteParticipant",r.Participant.Id),onExpand:o=>p("expandParticipant",r.Participant)},null,8,["participant","aides","aides-files","has-many-participants","structures","onDelete","onExpand"]))),256))]),_:1}))]),_:1})]),_:1})]),_:1}))}}),on={class:"mr-1"},rn=["onClick"],dn={class:"overflow-y-auto",style:{"max-height":"65vh"}},mn=["href"],pn=W({__name:"DossierDetailsPannel",props:{dossier:{},camps:{}},emits:["updateDossier","deleteDossier","mergeDossier","createParticipant","updateParticipant","deleteParticipant","expandParticipant","createAide","updateAide","deleteAide","deleteFileAide","uploadFileAide","createPaiement","updatePaiement","deletePaiement","sendMessage","deleteMessage","sendFacture"],setup(u,{expose:v,emit:i}){const p=u,t=i;v({showEditPaiement:o,showEditDossier:m});const s=Q(()=>yt(p.dossier.Dossier,C.isFondsSoutien?bl.FondSoutien:bl.Backoffice)),d=P(!1),a=P(!1);function m(){a.value=!0}const n=P(null),r=P(null);function o(B){r.value=B}const c="Repère",g=P(!1);async function M(){await We(p.dossier.EspacepersoURL),C.showMessage("Lien vers l'espace personnel copié.")}async function k(){await We(p.dossier.VirementCode),C.showMessage("Identifiant de virement copié.")}async function w(B){await We(B),C.showMessage("IBAN copié.")}const A=P(!1),G=P(!1),ee=P("");return(B,y)=>{const oe=Zt,_e=Ke,Ie=Ge;return f(),x(E,{class:"ml-2"},{title:l(()=>[y[36]||(y[36]=b(" Responsable ",-1)),z("a",{href:"/annuaire",onClick:y[0]||(y[0]=Oe(U=>I(Ne)(p.dossier.Dossier.IdResponsable),["prevent"]))},S(p.dossier.Dossier.Responsable),1)]),subtitle:l(()=>[y[37]||(y[37]=b(" Participants ",-1)),(f(!0),j(Z,null,ne(p.dossier.Dossier.Participants,U=>(f(),j("span",on,[z("a",{href:"/camps",onClick:Oe(xe=>I(fl)(U.Participant),["prevent"])},S(I(Me).prenomN(U.Personne)),9,rn)]))),256))]),append:l(()=>[e(F,{icon:"mdi-pencil",onClick:y[1]||(y[1]=U=>a.value=!0),class:"mx-1"}),e(ke,null,{activator:l(({props:U})=>[e(F,fe(U,{icon:"mdi-dots-vertical",size:"small",class:"mx-1"}),null,16)]),default:l(()=>[e(me,{density:"compact"},{default:l(()=>[e(L,{"prepend-icon":"mdi-email",onClick:y[2]||(y[2]=U=>G.value=!0),title:"Envoyer un message",subtitle:"Notification par email"}),e(L,{"prepend-icon":"mdi-invoice-send",onClick:y[3]||(y[3]=U=>t("sendFacture")),title:"Envoyer une demande de règlement",subtitle:"Notification par email"}),e(h),e(L,{"prepend-icon":"mdi-cash-plus",onClick:y[4]||(y[4]=U=>t("createPaiement")),title:"Ajouter un paiement"}),e(h),e(L,{"prepend-icon":"mdi-link",onClick:y[5]||(y[5]=U=>g.value=!0),title:"Afficher les identifiants"}),e(h),e(L,{"prepend-icon":"mdi-file-move",onClick:y[6]||(y[6]=U=>A.value=!0),title:"Fusionner vers ..."}),e(h),e(L,{onClick:y[7]||(y[7]=U=>d.value=!0),title:"Supprimer"},{prepend:l(()=>[e(ye,{color:"red"},{default:l(()=>[...y[38]||(y[38]=[b("mdi-delete",-1)])]),_:1})]),_:1})]),_:1})]),_:1})]),default:l(()=>[e(T,null,{default:l(()=>[e($,null,{default:l(()=>[e(V,{class:"ml-2 mb-1 text-center"},{default:l(()=>[e(ke,null,{activator:l(({props:U})=>[e(de,fe(U,{"prepend-icon":"mdi-currency-eur",color:I(ve).colorStatutPaiement(p.dossier.Dossier.Bilan.Statut)}),{default:l(()=>[b(S(p.dossier.Dossier.Bilan.Recu)+" payé sur "+S(p.dossier.Dossier.Bilan.Demande),1)]),_:1},16,["color"])]),default:l(()=>[e(Ea,{dossier:p.dossier.Dossier},null,8,["dossier"])]),_:1})]),_:1})]),_:1}),z("div",dn,[e(Wt,{side:"end",class:"mt-4",density:"compact"},{default:l(()=>[(f(!0),j(Z,null,ne(s.value,(U,xe)=>(f(),x(oe,{event:U,key:xe,onEditPaiement:y[8]||(y[8]=pe=>r.value=pe),onDeleteMessage:y[9]||(y[9]=pe=>t("deleteMessage",pe))},null,8,["event"]))),128))]),_:1})])]),_:1}),e(Y,{modelValue:d.value,"onUpdate:modelValue":y[11]||(y[11]=U=>d.value=U),"max-width":"600px"},{default:l(()=>[e(E,{title:"Supprimer le dossier"},{default:l(()=>[e(T,null,{default:l(()=>[...y[39]||(y[39]=[b(" Confirmez-vous la suppression du dossier et de ses participants ? ",-1),z("br",null,null,-1),z("br",null,null,-1),b(" Attention, cette opération est irréversible. ",-1)])]),_:1}),e(le,null,{default:l(()=>[e(te),e(F,{color:"red",onClick:y[10]||(y[10]=U=>{t("deleteDossier"),d.value=!1})},{default:l(()=>[...y[40]||(y[40]=[b("Supprimer",-1)])]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"]),n.value!=null?(f(),x(Y,{key:0,"model-value":n.value!=null,"onUpdate:modelValue":y[15]||(y[15]=U=>n.value=null),"max-width":"600px"},{default:l(()=>[e(E,{title:"Ajouter un participant"},{default:l(()=>[e(T,null,{default:l(()=>[e($,null,{default:l(()=>[e(V,{cols:"12"},{default:l(()=>[e(_e,{label:"Camp",camps:p.camps,modelValue:n.value.IdCamp,"onUpdate:modelValue":y[12]||(y[12]=U=>n.value.IdCamp=U)},null,8,["camps","modelValue"])]),_:1}),e(V,{cols:"12"},{default:l(()=>[e(Ie,{label:"Personne","initial-personne":"",modelValue:n.value.IdPersonne,"onUpdate:modelValue":y[13]||(y[13]=U=>n.value.IdPersonne=U),api:{SelectPersonne:I(C).SelectPersonne.bind(I(C))}},null,8,["modelValue","api"])]),_:1})]),_:1})]),_:1}),e(le,null,{default:l(()=>[e(te),e(F,{color:"green",disabled:n.value.IdPersonne==0||n.value.IdCamp==0,onClick:y[14]||(y[14]=U=>{t("createParticipant",n.value),n.value=null})},{default:l(()=>[...y[41]||(y[41]=[b("Ajouter",-1)])]),_:1},8,["disabled"])]),_:1})]),_:1})]),_:1},8,["model-value"])):J("",!0),e(Y,{modelValue:a.value,"onUpdate:modelValue":y[26]||(y[26]=U=>a.value=U)},{default:l(()=>[e(sn,{dossier:p.dossier,camps:p.camps,onUpdateDossier:y[16]||(y[16]=U=>t("updateDossier",U)),onCreateParticipant:y[17]||(y[17]=U=>t("createParticipant",U)),onUpdateParticipant:y[18]||(y[18]=U=>t("updateParticipant",U)),onDeleteParticipant:y[19]||(y[19]=U=>t("deleteParticipant",U)),onExpandParticipant:y[20]||(y[20]=U=>t("expandParticipant",U)),onCreateAide:y[21]||(y[21]=U=>t("createAide",U)),onUpdateAide:y[22]||(y[22]=U=>t("updateAide",U)),onDeleteAide:y[23]||(y[23]=U=>t("deleteAide",U)),onDeleteFileAide:y[24]||(y[24]=U=>t("deleteFileAide",U)),onUploadFileAide:y[25]||(y[25]=(U,xe)=>t("uploadFileAide",U,xe))},null,8,["dossier","camps"])]),_:1},8,["modelValue"]),r.value!=null?(f(),x(Y,{key:1,"model-value":r.value!=null,"onUpdate:modelValue":y[29]||(y[29]=U=>r.value=null),"max-width":"600px"},{default:l(()=>[e(Ha,{paiement:r.value,onUpdate:y[27]||(y[27]=U=>{t("updatePaiement",U),r.value=null}),onDelete:y[28]||(y[28]=U=>{t("deletePaiement",r.value),r.value=null})},null,8,["paiement"])]),_:1},8,["model-value"])):J("",!0),e(Y,{modelValue:g.value,"onUpdate:modelValue":y[30]||(y[30]=U=>g.value=U),"max-width":"800px"},{default:l(()=>[e(E,{title:"Liens et identifiants"},{default:l(()=>[e(T,null,{default:l(()=>[e($,null,{default:l(()=>[e(V,{cols:"3"},{default:l(()=>[...y[42]||(y[42]=[b("Espace personnel",-1)])]),_:1}),e(V,{class:"text-truncate"},{default:l(()=>[z("a",{href:p.dossier.EspacepersoURL,target:"_blank"},S(p.dossier.EspacepersoURL),9,mn)]),_:1}),e(V,{"align-self":"center",cols:"auto"},{default:l(()=>[e(F,{size:"small",icon:"mdi-content-copy",onClick:M})]),_:1})]),_:1}),(f(!0),j(Z,null,ne(p.dossier.BankAccounts,U=>(f(),x($,null,{default:l(()=>[e(V,{cols:"3"},{default:l(()=>[b("RIB ("+S(I(c))+")",1)]),_:1}),e(V,{cols:"3"},{default:l(()=>[b(S(U[0]),1)]),_:2},1024),e(V,null,{default:l(()=>[b(S(U[1]),1)]),_:2},1024),e(V,{"align-self":"center",cols:"auto"},{default:l(()=>[e(F,{size:"small",icon:"mdi-content-copy",onClick:()=>w(U[1])},null,8,["onClick"])]),_:2},1024)]),_:2},1024))),256)),e($,null,{default:l(()=>[e(V,{cols:"3"},{default:l(()=>[...y[43]||(y[43]=[b("Identification de virement",-1)])]),_:1}),e(V,null,{default:l(()=>[b(S(p.dossier.VirementCode),1)]),_:1}),e(V,{"align-self":"center",cols:"auto"},{default:l(()=>[e(F,{size:"small",icon:"mdi-content-copy",onClick:k})]),_:1})]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"]),e(Y,{modelValue:A.value,"onUpdate:modelValue":y[32]||(y[32]=U=>A.value=U),"max-width":"600px"},{default:l(()=>[e(Ql,{from:p.dossier.Dossier.Dossier.Id,onMerge:y[31]||(y[31]=U=>{t("mergeDossier",U),A.value=!1})},null,8,["from"])]),_:1},8,["modelValue"]),e(Y,{modelValue:G.value,"onUpdate:modelValue":y[35]||(y[35]=U=>G.value=U),"max-width":"600px"},{default:l(()=>[e(E,{title:"Nouveau message",subtitle:"Envoie un message sur le fil de suivi et une notification par mail."},{default:l(()=>[e(T,null,{default:l(()=>[e($,null,{default:l(()=>[e(V,null,{default:l(()=>[e(Xe,{rows:"5",variant:"outlined",modelValue:ee.value,"onUpdate:modelValue":y[33]||(y[33]=U=>ee.value=U)},null,8,["modelValue"])]),_:1})]),_:1})]),_:1}),e(le,null,{default:l(()=>[e(te),e(F,{disabled:!ee.value.length,onClickOnce:y[34]||(y[34]=U=>{t("sendMessage",ee.value),G.value=!1})},{default:l(()=>[...y[44]||(y[44]=[b("Envoyer",-1)])]),_:1},8,["disabled"])]),_:1})]),_:1})]),_:1},8,["modelValue"])]),_:1})}}}),vn=W({__name:"CreateDossierCard",emits:["create"],setup(u,{emit:v}){const i=v,p=P(0);return(t,s)=>{const d=Ge;return f(),x(E,{title:"Créer un dossier"},{default:l(()=>[e(T,null,{default:l(()=>[e($,null,{default:l(()=>[e(V,null,{default:l(()=>[e(d,{label:"Responsable légal",modelValue:p.value,"onUpdate:modelValue":s[0]||(s[0]=a=>p.value=a),"initial-personne":"",api:{SelectPersonne:I(C).SelectPersonne.bind(I(C))}},null,8,["modelValue","api"])]),_:1})]),_:1})]),_:1}),e(le,null,{default:l(()=>[e(te),e(F,{color:"green",disabled:p.value==0,onClick:s[1]||(s[1]=a=>i("create",p.value))},{default:l(()=>[...s[2]||(s[2]=[b("Créer",-1)])]),_:1},8,["disabled"])]),_:1})]),_:1})}}}),cn=W({__name:"DossierList",props:Se({camps:{},allowFondsSoutien:{type:Boolean},selected:{}},{query:{required:!0},queryModifiers:{}}),emits:Se(["click","update"],["update:query"]),setup(u,{expose:v,emit:i}){const p=u,t=i,s=we(u,"query");v({searchDossiers:a}),Ue(()=>s.value,a,{immediate:!0});const d=P(null);async function a(){const m=await C.DossiersSearch(s.value);m!==void 0&&(d.value=m,t("update",m))}return(m,n)=>{const r=Ke,o=Ll;return f(),j("div",null,[e($,null,{default:l(()=>[e(V,{"align-self":"center"},{default:l(()=>[e(o,{density:"compact",variant:"outlined","prepend-inner-icon":"mdi-magnify",label:"Rechercher un dossier","hide-details":"",clearable:"",modelValue:s.value.Pattern,"onUpdate:modelValue":[n[5]||(n[5]=c=>s.value.Pattern=c),a]},{"append-inner":l(()=>[s.value.IdCamp.Valid?(f(),x(de,{key:0,class:"ml-1",size:"small","prepend-icon":"mdi-bed"},{default:l(()=>[b(S(p.camps.find(c=>c.Id==s.value.IdCamp.Id)?.Label),1)]),_:1})):J("",!0),s.value.Attente!=I(Pt).EmptyQA?(f(),x(de,{key:1,class:"ml-1",size:"small","prepend-icon":"mdi-clock"},{default:l(()=>[b(S(I(yl)[s.value.Attente]),1)]),_:1})):J("",!0),s.value.Reglement!=I(wt).EmptyQR?(f(),x(de,{key:2,class:"ml-1",size:"small","prepend-icon":"mdi-currency-eur"},{default:l(()=>[b(S(I(gl)[s.value.Reglement]),1)]),_:1})):J("",!0),s.value.OnlyFondSoutien?(f(),x(de,{key:3,class:"ml-1",size:"small"},{default:l(()=>[...n[6]||(n[6]=[b(" Fonds de soutien ",-1)])]),_:1})):J("",!0)]),append:l(()=>[e(ke,{location:"left top","close-on-content-click":!1},{activator:l(({props:c})=>[e(F,fe(c,{size:"small",variant:"flat",icon:""}),{default:l(()=>[e(ye,null,{default:l(()=>[...n[7]||(n[7]=[b("mdi-filter-cog",-1)])]),_:1}),e(Te,{activator:"parent",text:"Autres critères de recherche"})]),_:1},16)]),default:l(()=>[e(E,{"min-width":"400px",title:"Filtrer les dossiers"},{default:l(()=>[e(T,null,{default:l(()=>[e($,null,{default:l(()=>[e(V,null,{default:l(()=>[e(r,{label:"Camp",camps:p.camps,"model-value":I(_t)(I(xt)(s.value.IdCamp)),"onUpdate:modelValue":n[0]||(n[0]=c=>{s.value.IdCamp=I(gt)(I(Ct)(c)),a()})},null,8,["camps","model-value"])]),_:1})]),_:1}),e($,null,{default:l(()=>[e(V,null,{default:l(()=>[e(Fe,{density:"compact",variant:"outlined",label:"Liste d'attente",modelValue:s.value.Attente,"onUpdate:modelValue":[n[1]||(n[1]=c=>s.value.Attente=c),a],items:I(Ze)(I(yl)),"hide-details":""},null,8,["modelValue","items"])]),_:1})]),_:1}),e($,null,{default:l(()=>[e(V,null,{default:l(()=>[e(Fe,{density:"compact",variant:"outlined",label:"Réglement",modelValue:s.value.Reglement,"onUpdate:modelValue":[n[2]||(n[2]=c=>s.value.Reglement=c),a],items:I(Ze)(I(gl)),"hide-details":""},null,8,["modelValue","items"])]),_:1})]),_:1}),e($,null,{default:l(()=>[e(V,null,{default:l(()=>[e(sl,{label:"Trier selon les nouveaux messages",hint:"Affiche les nouveaux messages en premier.","persistent-hint":"",density:"compact",color:"light-blue-darken-3",modelValue:s.value.SortByNewMessages,"onUpdate:modelValue":[n[3]||(n[3]=c=>s.value.SortByNewMessages=c),a]},null,8,["modelValue"])]),_:1})]),_:1}),p.allowFondsSoutien?(f(),x($,{key:0},{default:l(()=>[e(V,null,{default:l(()=>[e(sl,{label:"Fonds de soutien",hint:"N'affiche que les dossiers demandant le fonds de soutien.","persistent-hint":"",density:"compact",color:"orange",modelValue:s.value.OnlyFondSoutien,"onUpdate:modelValue":[n[4]||(n[4]=c=>s.value.OnlyFondSoutien=c),a]},null,8,["modelValue"])]),_:1})]),_:1})):J("",!0)]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"])]),_:1})]),_:1}),d.value!=null?(f(),x(me,{key:0,class:"mt-2",selected:p.selected?[p.selected]:void 0},{default:l(()=>[d.value.Dossiers?.length?J("",!0):(f(),x(L,{key:0,class:"text-center"},{default:l(()=>[...n[8]||(n[8]=[z("i",null,"Aucun dossier ne correspond à votre recherche.",-1)])]),_:1})),(f(!0),j(Z,null,ne(d.value.Dossiers,(c,g)=>(f(),x(L,{rounded:"",key:g,title:c.Responsable,subtitle:c.Participants,value:c.Id,onClick:M=>t("click",c),class:"my-1"},el({_:2},[c.NewMessages?{name:"append",fn:l(()=>[e(ql,{color:"light-blue-darken-3",content:c.NewMessages},null,8,["content"])]),key:"0"}:void 0]),1032,["title","subtitle","value","onClick"]))),128))]),_:1},8,["selected"])):J("",!0)])}}}),fn=W({__name:"SendDocumentsCampCard",props:{camps:{}},emits:["send"],setup(u,{emit:v}){const i=u,p=v,t=P(0),s=P(null);async function d(){const n=await C.EventsSendDocumentsCampPreview({idCamp:t.value});n!==void 0&&(s.value=n,a.value=(n.Dossiers||[]).filter(r=>!r.DocumentsSent).map(r=>r.Id))}const a=P([]),m=Q(()=>a.value.length==(s.value?.Dossiers||[]).length);return(n,r)=>{const o=Ke;return f(),x(E,{title:"Envoyer les documents d'un séjour"},{default:l(()=>[e(T,null,{default:l(()=>[e($,null,{default:l(()=>[e(V,{"align-self":"center",cols:"5"},{default:l(()=>[e(o,{camps:i.camps,label:"Séjour",modelValue:t.value,"onUpdate:modelValue":[r[0]||(r[0]=c=>t.value=c),d]},null,8,["camps","modelValue"])]),_:1}),e(V,{"align-self":"center"},{default:l(()=>[s.value?(f(),x(E,{key:0,subtitle:"Dossiers à contacter"},el({default:l(()=>[e(T,null,{default:l(()=>[e(me,{selectable:"",selected:a.value,"onUpdate:selected":r[2]||(r[2]=c=>a.value=c),"select-strategy":"leaf"},{default:l(()=>[(f(!0),j(Z,null,ne(s.value.Dossiers,c=>(f(),x(L,{title:c.Responsable,subtitle:c.Participants,value:c.Id,rounded:"",class:"my-1"},{append:l(({isSelected:g,select:M})=>[e($,null,{default:l(()=>[e(V,null,{default:l(()=>[c.DocumentsSent?(f(),x(de,{key:0,color:"green",class:"mr-2"},{default:l(()=>[...r[4]||(r[4]=[b("Envoyés",-1)])]),_:1})):J("",!0)]),_:2},1024),e(V,null,{default:l(()=>[e(Ol,{density:"compact","hide-details":"","model-value":g,"onUpdate:modelValue":M},null,8,["model-value","onUpdate:modelValue"])]),_:2},1024)]),_:2},1024)]),_:2},1032,["title","subtitle","value"]))),256))]),_:1},8,["selected"])]),_:1})]),_:2},[s.value.Dossiers?.length?{name:"append",fn:l(()=>[e(Le,{label:"Tout sélectionner",density:"compact","hide-details":"",indeterminate:!!a.value.length&&a.value.length!=(s.value.Dossiers||[]).length,"model-value":a.value.length==(s.value.Dossiers||[]).length,"onUpdate:modelValue":r[1]||(r[1]=c=>a.value=m.value?[]:(s.value.Dossiers||[]).map(g=>g.Id))},null,8,["indeterminate","model-value"])]),key:"0"}:void 0]),1024)):J("",!0)]),_:1})]),_:1})]),_:1}),e(le,null,{default:l(()=>[e(te),e(F,{disabled:!t.value||!a.value.length,onClick:r[3]||(r[3]=c=>p("send",t.value,a.value)),"prepend-icon":"mdi-send"},{default:l(()=>[...r[5]||(r[5]=[b(" Envoyer ",-1)])]),_:1},8,["disabled"])]),_:1})]),_:1})}}}),Vn=W({__name:"SendRelancePaiementCard",props:{camps:{}},emits:["send"],setup(u,{emit:v}){const i=u,p=v,t=P(0),s=P([]);async function d(){const n=await C.EventsSendRelancePaiementPreview({idCamp:t.value});n!==void 0&&(s.value=n||[],a.value=(n||[]).map(r=>r.Id))}const a=P([]),m=Q(()=>a.value.length==s.value.length);return(n,r)=>{const o=Ke;return f(),x(E,{title:"Envoyer une relance de paiement"},{default:l(()=>[e(T,null,{default:l(()=>[e($,null,{default:l(()=>[e(V,{"align-self":"center",cols:"5"},{default:l(()=>[e(o,{camps:i.camps,label:"Séjour",modelValue:t.value,"onUpdate:modelValue":[r[0]||(r[0]=c=>t.value=c),d]},null,8,["camps","modelValue"])]),_:1}),e(V,{"align-self":"center"},{default:l(()=>[s.value?(f(),x(E,{key:0,subtitle:"Dossiers à relancer"},el({default:l(()=>[e(T,null,{default:l(()=>[e(me,{selectable:"",selected:a.value,"onUpdate:selected":r[2]||(r[2]=c=>a.value=c),"select-strategy":"leaf",density:"comfortable"},{default:l(()=>[(f(!0),j(Z,null,ne(s.value,(c,g)=>(f(),x(L,{key:c.Id,title:c.Responsable,subtitle:I(kt)(c.LastEventFacture)?"":`Dernière demande : ${I(ve).time(c.LastEventFacture)}`,value:c.Id,rounded:"",class:"my-1"},{append:l(({isSelected:M,select:k})=>[e($,null,{default:l(()=>[e(V,{"align-self":"center"},{default:l(()=>[e(de,{class:"mr-2",color:I(ve).colorStatutPaiement(c.Bilan.Statut)},{default:l(()=>[b(S(c.Bilan.Recu)+" / "+S(c.Bilan.Demande),1)]),_:2},1032,["color"])]),_:2},1024),e(V,{"align-self":"center"},{default:l(()=>[e(Ol,{density:"compact","hide-details":"","model-value":M,"onUpdate:modelValue":k},null,8,["model-value","onUpdate:modelValue"])]),_:2},1024)]),_:2},1024)]),_:2},1032,["title","subtitle","value"]))),128))]),_:1},8,["selected"])]),_:1})]),_:2},[s.value.length?{name:"append",fn:l(()=>[e(Le,{label:"Tout sélectionner",density:"compact","hide-details":"",indeterminate:!!a.value.length&&a.value.length!=s.value.length,"model-value":a.value.length==s.value.length,"onUpdate:modelValue":r[1]||(r[1]=c=>a.value=m.value?[]:s.value.map(g=>g.Id))},null,8,["indeterminate","model-value"])]),key:"0"}:void 0]),1024)):J("",!0)]),_:1})]),_:1})]),_:1}),e(le,null,{default:l(()=>[e(te),e(F,{disabled:!t.value||!a.value.length,onClick:r[3]||(r[3]=c=>p("send",t.value,a.value)),"prepend-icon":"mdi-send"},{default:l(()=>[...r[4]||(r[4]=[b(" Envoyer ",-1)])]),_:1},8,["disabled"])]),_:1})]),_:1})}}}),bn=W({__name:"RemisesHintsCard",props:{allCamps:{}},setup(u){const v=u;$e(()=>{t.value=v.allCamps.filter(n=>!n.IsOld).map(n=>n.Id),d()});const i=P([]),p=P(!1),t=P([]),s=P(null);async function d(){const n=await C.DossiersRemisesHint({IdCamps:t.value});n!==void 0&&(s.value=n||[])}const a=P([]);async function m(){const n=s.value;if(!a.value.length||!n)return;const r=a.value.map(c=>n[c]),o=await C.DossiersApplyRemisesHints(r);a.value=[],o!==void 0&&(C.showMessage("Remises appliquées avec succès."),d())}return(n,r)=>(f(),x(E,{title:"Estimer les remises",subtitle:"Seules les nouvelles remises sont affichées."},{append:l(()=>[e(F,{onClick:r[0]||(r[0]=o=>{i.value=t.value,p.value=!0}),"prepend-icon":"mdi-cog"},{default:l(()=>[...r[5]||(r[5]=[b(" Séjours ",-1)])]),_:1}),e(h,{vertical:"",thickness:"1",class:"mx-2"}),e(F,{disabled:!a.value.length,onClick:m},{default:l(()=>[...r[6]||(r[6]=[b("Appliquer les remises",-1)])]),_:1},8,["disabled"])]),default:l(()=>[e(T,null,{default:l(()=>[s.value==null?(f(),x(qe,{key:0})):(f(),x(me,{key:1,"select-strategy":"leaf",selected:a.value,"onUpdate:selected":r[1]||(r[1]=o=>a.value=o),color:"primary"},{default:l(()=>[s.value.length?J("",!0):(f(),x(L,{key:0,class:"font-italic"},{default:l(()=>[...r[7]||(r[7]=[b(" Aucune nouvelle remise à appliquer. ",-1)])]),_:1})),(f(!0),j(Z,null,ne(s.value,(o,c)=>(f(),x(L,{title:o.Personne,subtitle:o.Camp,value:c,rounded:"",class:"my-1"},{append:l(()=>[e($,{style:{width:"200px"}},{default:l(()=>[e(V,{cols:"6"},{default:l(()=>[o.Hint.Famille?(f(),x(de,{key:0,"prepend-icon":"mdi-account-multiple",class:"mx-1",elevation:"1"},{default:l(()=>[b(S(o.Hint.Famille)+" % ",1),e(Te,{activator:"parent","content-class":"ma-0 pa-0"},{default:l(()=>[e(E,{subtitle:"Autres inscrits de la même famille"},{default:l(()=>[e(T,null,{default:l(()=>[(f(!0),j(Z,null,ne(o.AutresInscrits,g=>(f(),x(de,{class:"mx-1"},{default:l(()=>[b(S(g.Personne)+" ("+S(g.Camp)+")",1)]),_:2},1024))),256))]),_:2},1024)]),_:2},1024)]),_:2},1024)]),_:2},1024)):J("",!0)]),_:2},1024),e(V,{cols:"6"},{default:l(()=>[o.Hint.Equipiers?(f(),x(de,{key:0,"prepend-icon":"mdi-account-hard-hat",class:"mx-1",elevation:"1"},{default:l(()=>[b(S(o.Hint.Equipiers)+" % ",1),e(Te,{activator:"parent","content-class":"ma-0 pa-0"},{default:l(()=>[e(E,{subtitle:"Equipiers de la même famille"},{default:l(()=>[e(T,null,{default:l(()=>[(f(!0),j(Z,null,ne(o.Equipiers,g=>(f(),x(de,{class:"mx-1"},{default:l(()=>[b(S(g.Personne)+" ("+S(g.Camp)+")",1)]),_:2},1024))),256))]),_:2},1024)]),_:2},1024)]),_:2},1024)]),_:2},1024)):J("",!0)]),_:2},1024)]),_:2},1024)]),_:2},1032,["title","subtitle","value"]))),256))]),_:1},8,["selected"]))]),_:1}),e(Y,{modelValue:p.value,"onUpdate:modelValue":r[4]||(r[4]=o=>p.value=o),"max-width":"600px"},{default:l(()=>[e(E,{title:"Choix des séjours"},{default:l(()=>[e(T,null,{default:l(()=>[e(zl,{"all-camps":v.allCamps,modelValue:i.value,"onUpdate:modelValue":r[2]||(r[2]=o=>i.value=o)},null,8,["all-camps","modelValue"])]),_:1}),e(le,null,{default:l(()=>[e(te),e(F,{onClick:r[3]||(r[3]=o=>{t.value=i.value,p.value=!1,d()})},{default:l(()=>[...r[8]||(r[8]=[b("Appliquer",-1)])]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"])]),_:1}))}}),yn={key:1,class:"text-center font-italic my-6"},gn=W({__name:"PannelDossiers",props:{initialDossier:{}},setup(u){const v=u;$e(()=>{d(),v.initialDossier!==void 0&&r(v.initialDossier)}),Ue(()=>v.initialDossier,()=>{v.initialDossier!==void 0&&r(v.initialDossier)});const i=Cl("detailsPannel"),p=P(null),t=P(Bt()),s=P([]);async function d(){const R=await C.GetCamps();R!==void 0&&(s.value=R||[])}function a(R){p.value={length:R.Dossiers?.length||0,total:R.Total}}const m=Cl("dossierList");function n(){m.value?.searchDossiers()}async function r(R){await c(R),t.value=Ht(R)}const o=P(null);async function c(R){const N=await C.DossiersLoad({id:R});N!==void 0&&(o.value=N)}async function g(R){c(R.Id),await C.EventsMarkMessagesSeen({idDossier:R.Id})!==void 0&&n()}async function M(){o.value!=null&&c(o.value.Dossier.Dossier.Id)}const k=P(!1);async function w(R){k.value=!1;const N=await C.DossiersCreate({idResponsable:R});N!==void 0&&(C.showMessage("Dossier créé avec succès."),await r(N.Id),i.value?.showEditDossier())}async function A(R){const N=await C.DossiersUpdate(R);N!==void 0&&(C.showMessage("Dossier mis à jour avec succès."),o.value!=null&&(o.value.Dossier.Dossier=R,o.value.Dossier.Responsable=N.Responsable),n())}async function G(){if(o.value==null)return;const R=o.value.Dossier.Dossier.Id;await C.DossiersDelete({id:R})!==void 0&&(C.showMessage("Dossier supprimé avec succès."),o.value=null,n())}async function ee(R){await C.DossiersMerge(R)!==void 0&&(C.showMessage("Dossier fusionné avec succès."),n(),c(R.To))}async function B(R){await C.ParticipantsCreate(R)!==void 0&&(C.showMessage("Participant ajouté avec succès."),M())}async function y(R){await C.ParticipantsUpdate(R)!==void 0&&(C.showMessage("Réglages du participant modifiés avec succès."),M())}async function oe(R){await C.ParticipantsDelete({id:R})!==void 0&&(C.showMessage("Participant supprimé avec succès."),M())}async function _e(R){if(o.value==null)return;const N=o.value.Dossier.Participants?.map(ie=>ie.Participant).filter(ie=>ie.Id!=R.Id)||[];!N.length||(N.forEach(ie=>{ie.Remises=R.Remises,ie.QuotientFamilial=R.QuotientFamilial,ie.IdCamp==R.IdCamp&&(ie.OptionPrix=R.OptionPrix)}),(await Promise.all(N.map(ie=>C.ParticipantsUpdate(ie)))).includes(void 0))||(C.showMessage("Réglages des participants modifiés avec succès."),M())}async function Ie(R){const N=await C.AidesCreate(R);if(N===void 0||(C.showMessage("Aide ajoutée avec succès."),o.value==null))return;const ae=o.value.Dossier.Aides||{},ie=ae[R.IdParticipant]||{};ie[N.Id]=N,ae[R.IdParticipant]=ie,o.value.Dossier.Aides=ae}async function U(R){await C.AidesUpdate(R)!==void 0&&(C.showMessage("Aide modifiée avec succès."),M())}async function xe(R){await C.AidesJustificatifDelete({idAide:R})!==void 0&&(C.showMessage("Justificatif supprimé avec succès."),o.value!=null&&o.value.Dossier.AidesFiles&&delete o.value.Dossier.AidesFiles[R])}async function pe(R,N){const ae=await C.AidesJustificatifUpload(R,{idAide:N});if(ae!==void 0&&(C.showMessage("Justificatif téléversé avec succès."),o.value!=null)){const ie=o.value.Dossier.AidesFiles||{};ie[N]=ae,o.value.Dossier.AidesFiles=ie}}async function q(R){await C.AidesDelete({id:R})!==void 0&&(C.showMessage("Aide supprimée avec succès."),M())}async function H(){if(o.value==null)return;const R=await C.PaiementsCreate({idDossier:o.value.Dossier.Dossier.Id});R!==void 0&&(C.showMessage("Paiement créé avec succès."),M(),i.value?.showEditPaiement(R))}async function ue(R){await C.PaiementsUpdate(R)!==void 0&&(C.showMessage("Paiement modifié avec succès."),M())}async function X(R){await C.PaiementsDelete({id:R.Id})!==void 0&&(C.showMessage("Paiement supprimé avec succès."),M())}async function Ve(R){o.value==null||await C.EventsSendMessage({IdDossier:o.value.Dossier.Dossier.Id,Contenu:R})===void 0||(C.showMessage("Message envoyé avec succès."),M())}async function Pe(R){await C.EventsDelete({id:R.Id})!==void 0&&(C.showMessage("Message supprimé avec succès."),M())}async function ge(){o.value==null||await C.EventsSendFacture({idDossier:o.value.Dossier.Dossier.Id})===void 0||(C.showMessage("Demande de règlement envoyé avec succès."),M())}const D=P(!1),_=P(null);async function K(R,N){_.value={Current:0,Total:N.length};const ae=await C.EventsSendDocumentsCamp({IdCamp:R,IdDossiers:N});if(ae===void 0){_.value=null;return}await il(ae,ie=>_.value=ie,ie=>C.onError("Envoi des documents",ie)),_.value=null,M(),C.showMessage("Documents du séjour envoyés avec succès.")}const O=P(!1),re=P(null);async function be(R,N){re.value={Current:0,Total:N.length};const ae=await C.EventsSendRelancePaiement({IdDossiers:N});if(ae===void 0){re.value=null;return}await il(ae,ie=>re.value=ie,ie=>C.onError("Envoi de la relance",ie)),re.value=null,M(),C.showMessage("Toutes les relances ont été envoyées avec succès.")}const ze=P(!1);return(R,N)=>(f(),x($,{"no-gutters":"",class:"ma-2"},{default:l(()=>[e(V,{cols:"6"},{default:l(()=>[e(E,{title:"Dossiers",subtitle:p.value==null?"-":`${p.value.length} affiché(s) / ${p.value.total}`},{append:l(()=>[e(F,{icon:"",size:"small",onClick:N[0]||(N[0]=ae=>k.value=!0)},{default:l(()=>[e(ye,{color:"green"},{default:l(()=>[...N[9]||(N[9]=[b("mdi-plus",-1)])]),_:1})]),_:1}),e(h,{thickness:"1",vertical:"",class:"mx-2"}),e(F,{size:"small","prepend-icon":"mdi-send-circle-outline"},{default:l(()=>[N[10]||(N[10]=b(" Actions ",-1)),e(ke,{activator:"parent"},{default:l(()=>[e(me,{density:"compact"},{default:l(()=>[e(L,{title:"Estimation des remises","prepend-icon":"mdi-finance",onClick:N[1]||(N[1]=ae=>ze.value=!0)}),e(h),e(L,{title:"Documents...",subtitle:"Paramétrer et envoyer les documents d'un séjour","prepend-icon":"mdi-mail",onClick:N[2]||(N[2]=ae=>D.value=!0)}),e(h),e(L,{title:"Relance de paiement...",subtitle:"Paramétrer et envoyer une relance, pour un séjour","prepend-icon":"mdi-invoice-send",onClick:N[3]||(N[3]=ae=>O.value=!0)})]),_:1})]),_:1})]),_:1})]),default:l(()=>[e(T,null,{default:l(()=>[e(cn,{camps:s.value,"allow-fonds-soutien":I(C).isFondsSoutien,selected:o.value?.Dossier.Dossier.Id,query:t.value,"onUpdate:query":N[4]||(N[4]=ae=>t.value=ae),onClick:g,onUpdate:a,ref_key:"dossierList",ref:m},null,8,["camps","allow-fonds-soutien","selected","query"])]),_:1})]),_:1},8,["subtitle"])]),_:1}),e(V,{cols:"6"},{default:l(()=>[o.value!=null?(f(),x(pn,{key:0,dossier:o.value,camps:s.value,onUpdateDossier:A,onDeleteDossier:G,onMergeDossier:ee,onCreateParticipant:B,onUpdateParticipant:y,onDeleteParticipant:oe,onExpandParticipant:_e,onCreateAide:Ie,onDeleteAide:q,onUpdateAide:U,onDeleteFileAide:xe,onUploadFileAide:pe,onCreatePaiement:H,onUpdatePaiement:ue,onDeletePaiement:X,onSendMessage:Ve,onDeleteMessage:Pe,onSendFacture:ge,ref_key:"detailsPannel",ref:i},null,8,["dossier","camps"])):(f(),j("div",yn," Sélectionner un dossier... "))]),_:1}),e(Y,{modelValue:k.value,"onUpdate:modelValue":N[5]||(N[5]=ae=>k.value=ae),"max-width":"400px"},{default:l(()=>[e(vn,{onCreate:w})]),_:1},8,["modelValue"]),e(Y,{modelValue:D.value,"onUpdate:modelValue":N[6]||(N[6]=ae=>D.value=ae),"max-width":"1000px"},{default:l(()=>[e(fn,{camps:s.value,onSend:K},null,8,["camps"])]),_:1},8,["modelValue"]),e(Y,{modelValue:O.value,"onUpdate:modelValue":N[7]||(N[7]=ae=>O.value=ae),"max-width":"1000px"},{default:l(()=>[e(Vn,{camps:s.value,onSend:be},null,8,["camps"])]),_:1},8,["modelValue"]),e(Y,{"model-value":_.value!=null,"max-width":"400px",persistent:""},{default:l(()=>[_.value?(f(),x(ol,{key:0,title:"Envoi des documents en cours",current:_.value.Current,total:_.value.Total},null,8,["current","total"])):J("",!0)]),_:1},8,["model-value"]),e(Y,{"model-value":re.value!=null,"max-width":"400px",persistent:""},{default:l(()=>[re.value?(f(),x(ol,{key:0,title:"Envoi des relances en cours",current:re.value.Current,total:re.value.Total},null,8,["current","total"])):J("",!0)]),_:1},8,["model-value"]),e(Y,{modelValue:ze.value,"onUpdate:modelValue":N[8]||(N[8]=ae=>ze.value=ae),"max-width":"800px"},{default:l(()=>[e(bn,{"all-camps":s.value},null,8,["all-camps"])]),_:1},8,["modelValue"])]),_:1}))}}),Cn=W({__name:"inscriptions",setup(u){const v=Je(),i=Q(()=>Dn(v.currentRoute.value.query)),p=Q(()=>i.value.tab||"insc"),t=Q(()=>i.value.idDossier);function s(d){const a=v.currentRoute.value;v.push({path:a.path,query:{tab:d}})}return(d,a)=>(f(),j(Z,null,[e(ll,{title:"Suivi des inscriptions"},{default:l(()=>[e(Jt,{"model-value":p.value,"onUpdate:modelValue":a[0]||(a[0]=m=>s(m))},{default:l(()=>[e(wl,{value:"insc"},{default:l(()=>[...a[2]||(a[2]=[b("Inscriptions en attente",-1)])]),_:1}),e(wl,{value:"doss"},{default:l(()=>[...a[3]||(a[3]=[b("Suivi des dossiers",-1)])]),_:1})]),_:1},8,["model-value"])]),_:1}),e(Qt,{"model-value":p.value},{default:l(()=>[e(kl,{value:"insc"},{default:l(()=>[e(Ua,{onGoTo:I(rl),onEmpty:a[1]||(a[1]=m=>I(rl)())},null,8,["onGoTo"])]),_:1}),e(kl,{value:"doss"},{default:l(()=>[e(gn,{"initial-dossier":t.value},null,8,["initial-dossier"])]),_:1})]),_:1},8,["model-value"])],64))}}),_n=W({__name:"PersonneEdit",props:{personne:{}},emits:["save"],setup(u,{emit:v}){const i=u,p=v,t=P(Ce(i.personne)),s=Q(()=>!!(t.value.Nom&&t.value.Prenom));return(d,a)=>{const m=ht,n=ea,r=na,o=aa,c=la;return f(),x(E,{title:"Editer le profil"},{default:l(()=>[e(T,null,{default:l(()=>[e(ua,null,{default:l(()=>[e($,null,{default:l(()=>[e(V,null,{default:l(()=>[e(se,{autofocus:"","hide-details":"",label:"Nom",density:"compact",variant:"outlined",modelValue:t.value.Nom,"onUpdate:modelValue":a[0]||(a[0]=g=>t.value.Nom=g)},null,8,["modelValue"])]),_:1}),e(V,null,{default:l(()=>[e(se,{"hide-details":"",label:"Prénom",density:"compact",variant:"outlined",modelValue:t.value.Prenom,"onUpdate:modelValue":a[1]||(a[1]=g=>t.value.Prenom=g)},null,8,["modelValue"])]),_:1}),e(V,{cols:"3"},{default:l(()=>[e(m,{modelValue:t.value.Sexe,"onUpdate:modelValue":a[2]||(a[2]=g=>t.value.Sexe=g)},null,8,["modelValue"])]),_:1})]),_:1}),e($,null,{default:l(()=>[e(V,null,{default:l(()=>[e(n,{modelValue:t.value.DateNaissance,"onUpdate:modelValue":a[3]||(a[3]=g=>t.value.DateNaissance=g)},null,8,["modelValue"])]),_:1}),e(V,null,{default:l(()=>[e(se,{"hide-details":"",label:"Ville de naissance",density:"compact",variant:"outlined",modelValue:t.value.VilleNaissance,"onUpdate:modelValue":a[4]||(a[4]=g=>t.value.VilleNaissance=g)},null,8,["modelValue"])]),_:1}),e(V,null,{default:l(()=>[e(r,{label:"Département de naissance",modelValue:t.value.DepartementNaissance,"onUpdate:modelValue":a[5]||(a[5]=g=>t.value.DepartementNaissance=g)},null,8,["modelValue"])]),_:1}),e(V,null,{default:l(()=>[e(o,{modelValue:t.value.Nationnalite,"onUpdate:modelValue":a[6]||(a[6]=g=>t.value.Nationnalite=g)},null,8,["modelValue"])]),_:1})]),_:1}),e($,null,{default:l(()=>[e(V,null,{default:l(()=>[e(se,{"hide-details":"",label:"Adresse",density:"compact",variant:"outlined",modelValue:t.value.Adresse,"onUpdate:modelValue":a[7]||(a[7]=g=>t.value.Adresse=g)},null,8,["modelValue"])]),_:1}),e(V,null,{default:l(()=>[e(se,{"hide-details":"",label:"Code postal",density:"compact",variant:"outlined",modelValue:t.value.CodePostal,"onUpdate:modelValue":a[8]||(a[8]=g=>t.value.CodePostal=g)},null,8,["modelValue"])]),_:1}),e(V,null,{default:l(()=>[e(se,{"hide-details":"",label:"Ville",density:"compact",variant:"outlined",modelValue:t.value.Ville,"onUpdate:modelValue":a[9]||(a[9]=g=>t.value.Ville=g)},null,8,["modelValue"])]),_:1}),e(V,null,{default:l(()=>[e(c,{modelValue:t.value.Pays,"onUpdate:modelValue":a[10]||(a[10]=g=>t.value.Pays=g)},null,8,["modelValue"])]),_:1})]),_:1}),e($,null,{default:l(()=>[e(V,null,{default:l(()=>[e(se,{"hide-details":"",label:"Mail",density:"compact",variant:"outlined",modelValue:t.value.Mail,"onUpdate:modelValue":a[11]||(a[11]=g=>t.value.Mail=g)},null,8,["modelValue"])]),_:1}),e(V,null,{default:l(()=>[e(Hl,{label:"Téléphone",modelValue:t.value.Tels,"onUpdate:modelValue":a[12]||(a[12]=g=>t.value.Tels=g),formatter:t.value.Pays=="CH"?I(ve).telCh:I(ve).telFr},null,8,["modelValue","formatter"])]),_:1})]),_:1})]),_:1})]),_:1}),e(le,null,{default:l(()=>[e(te),e(F,{disabled:!s.value,onClick:a[13]||(a[13]=g=>p("save",t.value))},{default:l(()=>[...a[14]||(a[14]=[b("Enregistrer",-1)])]),_:1},8,["disabled"])]),_:1})]),_:1})}}}),xn=W({__name:"annuaire",setup(u){const v=Je(),i=Q(()=>Sn(v.currentRoute.value.query)),p=Q(()=>i.value.idPersonne);Ue(()=>p.value,()=>p.value!==void 0?r(p.value):null,{immediate:!0});const t=P([]),s=P("");async function d(){if(!s.value)return;const o=await C.PersonnesGet({search:s.value});o!==void 0&&(t.value=o||[])}async function a(){const o=await C.PersonnesCreate();o!==void 0&&(C.showMessage("Profil créé avec succès."),t.value.push(o),Ne(o.Id))}const m=P(null);async function n(o){m.value=null;const c=await C.PersonnesUpdate(o);if(c===void 0)return;C.showMessage("Profil modifié avec succès."),Ne();const g=t.value.findIndex(M=>M.Id==o.Id);t.value[g]=c}async function r(o){const c=await C.PersonnesLoad({id:o});c!==void 0&&(m.value=c)}return(o,c)=>{const g=Ll;return f(),j(Z,null,[e(ll,{title:"Annuaire : personnes et organismes"}),e(E,{class:"my-2 mx-auto","max-width":"600px"},{append:l(()=>[e(F,{color:"green",onClick:a},{default:l(()=>[...c[2]||(c[2]=[b("Créer un nouveau profil",-1)])]),_:1})]),default:l(()=>[e(T,null,{default:l(()=>[e($,null,{default:l(()=>[e(V,null,{default:l(()=>[e(g,{"prepend-inner-icon":"mdi-magnify",label:"Recherche",modelValue:s.value,"onUpdate:modelValue":[c[0]||(c[0]=M=>s.value=M),d]},null,8,["modelValue"]),e(me,null,{default:l(()=>[(f(!0),j(Z,null,ne(t.value,M=>(f(),x(L,{title:M.Label,subtitle:I(ve).dateNaissance(M.DateNaissance),"prepend-icon":I(ve).sexeIcon(M.Sexe),onClick:k=>I(Ne)(M.Id)},el({_:2},[M.IsTemp?{name:"append",fn:l(()=>[e(de,{"prepend-icon":"mdi-alert",color:"warning"},{default:l(()=>[...c[3]||(c[3]=[b(" Ce profil est temporaire et devrait être identifié. ",-1)])]),_:1})]),key:"0"}:void 0]),1032,["title","subtitle","prepend-icon","onClick"]))),256))]),_:1})]),_:1}),e(V)]),_:1})]),_:1}),m.value!=null?(f(),x(Y,{key:0,"model-value":m.value!=null,"onUpdate:modelValue":c[1]||(c[1]=M=>{m.value=null,I(Ne)(void 0)}),"max-width":"1000px"},{default:l(()=>[e(_n,{personne:m.value,onSave:n},null,8,["personne"])]),_:1},8,["model-value"])):J("",!0)]),_:1})],64)}}}),Pn=[{path:"/",component:ia},{path:"/camps",component:Sa},{path:"/inscriptions",component:Cn},{path:"/annuaire",component:xn}],wn="/backoffice",He=$t({history:Mt(wn),routes:Pn});He.onError((u,v)=>{u?.message?.includes?.("Failed to fetch dynamically imported module")?localStorage.getItem("vuetify:dynamic-reload")?console.error("Dynamic import error, reloading page did not fix it",u):(console.log("Reloading page to fix dynamic import error"),localStorage.setItem("vuetify:dynamic-reload","true"),location.assign(v.fullPath)):console.error(u)});He.isReady().then(()=>{localStorage.removeItem("vuetify:dynamic-reload")});function he(u){return u?Number(u):void 0}function kn(u){const v=u;return{idCamp:he(v.idCamp),idParticipant:he(v.idParticipant)}}function fl(u){He.push({path:"/camps",query:{idCamp:u.IdCamp,idParticipant:u.Id}})}function Dn(u){const v=u;return{tab:v.tab,idDossier:he(v.idDossier)}}function rl(u){He.push({path:"/inscriptions",query:{tab:"doss",idDossier:u}})}function Sn(u){return{idPersonne:he(u.idPersonne)}}function Ne(u){He.push({path:"/annuaire",query:{idPersonne:u}})}const In=["innerHTML"],An=W({__name:"App",setup(u){const v=ul({text:"",color:"secondary",action:void 0,timeout:4e3}),i=P(""),p=P("");return C.onError=(s,d)=>{i.value=s,p.value=d},C.showMessage=(s,d,a)=>{v.text=s,v.color=d||"success",v.action=a,v.timeout=1e4,v.timeout=4e3},Je().beforeEach(async(s,d)=>{if(!C.hasToken()&&s.path!=="/")return{path:"/"}}),(s,d)=>{const a=Dt("router-view");return f(),x(It,null,{default:l(()=>[e(St,null,{default:l(()=>[e(a),e(_l,{style:{"z-index":"10000"},app:"","model-value":v.text!="","onUpdate:modelValue":d[1]||(d[1]=m=>v.text=""),timeout:v.timeout,color:v.color,location:"bottom left","close-on-content-click":""},{default:l(()=>[b(S(v.text)+" ",1),v.action?(f(),x(F,{key:0,onClick:d[0]||(d[0]=m=>v.action.action()),class:"ml-2"},{default:l(()=>[b(S(v.action.title),1)]),_:1})):J("",!0)]),_:1},8,["model-value","timeout","color"]),e(_l,{app:"","model-value":i.value!="","onUpdate:modelValue":d[2]||(d[2]=m=>i.value=""),timeout:4e3,color:"red"},{default:l(()=>[z("b",null,S(i.value),1),z("div",{innerHTML:p.value},null,8,In)]),_:1},8,["model-value"])]),_:1})]),_:1})}}}),Gl=At(An);Gl.use(Ut).use(He);Gl.mount("#app");
