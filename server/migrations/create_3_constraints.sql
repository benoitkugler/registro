-- generated by make_sql.go DO NOT EDIT.

ALTER TABLE personnes
    ADD UNIQUE (Id, IsTemp);

ALTER TABLE fichesanitaires
    ADD UNIQUE (IdPersonne);

ALTER TABLE fichesanitaires
    ADD FOREIGN KEY (IdPersonne, guard) REFERENCES personnes (Id, IsTemp);

ALTER TABLE fichesanitaires
    ADD FOREIGN KEY (IdPersonne) REFERENCES personnes ON DELETE CASCADE;

ALTER TABLE fichesanitaires
    ALTER COLUMN guard SET DEFAULT FALSE;

ALTER TABLE fichesanitaires
    ADD CHECK (guard = FALSE);

ALTER TABLE fichesanitaires
    ADD CONSTRAINT Allergies_gomacro CHECK (gomacro_validate_json_pers_Allergies (Allergies));

ALTER TABLE fichesanitaires
    ADD CONSTRAINT Maladies_gomacro CHECK (gomacro_validate_json_pers_Maladies (Maladies));

ALTER TABLE fichesanitaires
    ADD CONSTRAINT Medecin_gomacro CHECK (gomacro_validate_json_pers_Medecin (Medecin));

ALTER TABLE personnes
    ADD CONSTRAINT Publicite_gomacro CHECK (gomacro_validate_json_pers_Publicite (Publicite));

ALTER TABLE tauxs
    ADD UNIQUE (Label);

ALTER TABLE tauxs
    ADD CHECK (Euros = 1000);

ALTER TABLE dossiers
    ADD UNIQUE (Id, IdTaux);

ALTER TABLE dossiers
    ADD FOREIGN KEY (IdTaux) REFERENCES tauxs;

ALTER TABLE dossiers
    ADD FOREIGN KEY (IdResponsable) REFERENCES personnes;

ALTER TABLE paiements
    ADD FOREIGN KEY (IdDossier) REFERENCES dossiers ON DELETE CASCADE;

ALTER TABLE camps
    ADD UNIQUE (Id, IdTaux);

ALTER TABLE camps
    ADD FOREIGN KEY (IdTaux) REFERENCES tauxs;

ALTER TABLE lettredirecteurs
    ADD UNIQUE (IdCamp);

ALTER TABLE lettredirecteurs
    ADD FOREIGN KEY (IdCamp) REFERENCES camps ON DELETE CASCADE;

ALTER TABLE participants
    ADD FOREIGN KEY (IdCamp, IdTaux) REFERENCES camps (Id, IdTaux);

ALTER TABLE participants
    ADD FOREIGN KEY (IdDossier, IdTaux) REFERENCES dossiers (Id, IdTaux) ON DELETE CASCADE;

ALTER TABLE participants
    ADD UNIQUE (IdCamp, IdPersonne);

ALTER TABLE participants
    ADD UNIQUE (Id, IdCamp);

ALTER TABLE participants
    ADD FOREIGN KEY (IdCamp) REFERENCES camps;

ALTER TABLE participants
    ADD FOREIGN KEY (IdPersonne) REFERENCES personnes;

ALTER TABLE participants
    ADD FOREIGN KEY (IdDossier) REFERENCES dossiers ON DELETE CASCADE;

ALTER TABLE participants
    ADD FOREIGN KEY (IdTaux) REFERENCES tauxs;

ALTER TABLE groupes
    ADD UNIQUE (IdCamp, Nom);

ALTER TABLE groupes
    ADD UNIQUE (Id, IdCamp);

ALTER TABLE groupes
    ADD FOREIGN KEY (IdCamp) REFERENCES camps ON DELETE CASCADE;

ALTER TABLE groupe_participants
    ADD UNIQUE (IdParticipant);

ALTER TABLE groupe_participants
    ADD UNIQUE (IdParticipant, IdCamp);

ALTER TABLE groupe_participants
    ADD FOREIGN KEY (IdParticipant, IdCamp) REFERENCES participants (Id, IdCamp) ON DELETE CASCADE;

ALTER TABLE groupe_participants
    ADD FOREIGN KEY (IdGroupe, IdCamp) REFERENCES groupes (Id, IdCamp) ON DELETE CASCADE;

ALTER TABLE groupe_participants
    ADD FOREIGN KEY (IdParticipant) REFERENCES participants ON DELETE CASCADE;

ALTER TABLE groupe_participants
    ADD FOREIGN KEY (IdGroupe) REFERENCES groupes ON DELETE CASCADE;

ALTER TABLE groupe_participants
    ADD FOREIGN KEY (IdCamp) REFERENCES camps;

ALTER TABLE sondages
    ADD UNIQUE (IdCamp, IdDossier);

ALTER TABLE sondages
    ADD FOREIGN KEY (IdCamp) REFERENCES camps ON DELETE CASCADE;

ALTER TABLE sondages
    ADD FOREIGN KEY (IdDossier) REFERENCES dossiers ON DELETE CASCADE;

ALTER TABLE aides
    ADD FOREIGN KEY (IdStructureaide) REFERENCES structureaides;

ALTER TABLE aides
    ADD FOREIGN KEY (IdParticipant) REFERENCES participants ON DELETE CASCADE;

ALTER TABLE equipiers
    ADD UNIQUE (IdCamp, IdPersonne);

CREATE UNIQUE INDEX ON equipiers (IdCamp)
WHERE
    0
    /* Role.Direction */
    = ANY (Roles);

ALTER TABLE equipiers
    ADD FOREIGN KEY (IdCamp) REFERENCES camps ON DELETE CASCADE;

ALTER TABLE equipiers
    ADD FOREIGN KEY (IdPersonne) REFERENCES personnes ON DELETE CASCADE;

ALTER TABLE camps
    ADD CONSTRAINT DocumentsToShow_gomacro CHECK (gomacro_validate_json_camp_DocumentsToShow (DocumentsToShow));

ALTER TABLE camps
    ADD CONSTRAINT Vetements_gomacro CHECK (gomacro_validate_json_camp_ListeVetements (Vetements));

ALTER TABLE camps
    ADD CONSTRAINT Navette_gomacro CHECK (gomacro_validate_json_camp_OptionNavette (Navette));

ALTER TABLE camps
    ADD CONSTRAINT OptionPrix_gomacro CHECK (gomacro_validate_json_camp_OptionPrixCamp (OptionPrix));

ALTER TABLE participants
    ADD CONSTRAINT OptionPrix_gomacro CHECK (gomacro_validate_json_camp_OptionPrixParticipant (OptionPrix));

ALTER TABLE participants
    ADD CONSTRAINT Remises_gomacro CHECK (gomacro_validate_json_camp_Remises (Remises));

ALTER TABLE groupes
    ADD CONSTRAINT Plage_gomacro CHECK (gomacro_validate_json_shar_Plage (Plage));

ALTER TABLE demandes
    ADD CONSTRAINT constraint_categorie CHECK (Categorie = 0 OR IdDirecteur IS NULL);

ALTER TABLE demandes
    ADD CONSTRAINT constraint_maxdocs CHECK (MaxDocs >= 1);

CREATE UNIQUE INDEX ON demandes (Categorie)
WHERE
    Categorie <> 0;

ALTER TABLE demandes
    ADD FOREIGN KEY (IdFile) REFERENCES files ON DELETE SET NULL;

ALTER TABLE demandes
    ADD FOREIGN KEY (IdDirecteur) REFERENCES personnes ON DELETE CASCADE;

ALTER TABLE demande_equipiers
    ADD UNIQUE (IdEquipier, IdDemande);

ALTER TABLE demande_equipiers
    ADD FOREIGN KEY (IdEquipier) REFERENCES equipiers ON DELETE CASCADE;

ALTER TABLE demande_equipiers
    ADD FOREIGN KEY (IdDemande) REFERENCES demandes ON DELETE CASCADE;

ALTER TABLE demande_camps
    ADD UNIQUE (IdCamp, IdDemande);

ALTER TABLE demande_camps
    ADD FOREIGN KEY (IdCamp) REFERENCES camps ON DELETE CASCADE;

ALTER TABLE demande_camps
    ADD FOREIGN KEY (IdDemande) REFERENCES demandes ON DELETE CASCADE;

ALTER TABLE file_camps
    ADD UNIQUE (IdFile);

CREATE UNIQUE INDEX ON file_camps (IdCamp)
WHERE
    IsLettre IS TRUE;

ALTER TABLE file_camps
    ADD FOREIGN KEY (IdFile) REFERENCES files ON DELETE CASCADE;

ALTER TABLE file_camps
    ADD FOREIGN KEY (IdCamp) REFERENCES camps;

ALTER TABLE file_personnes
    ADD UNIQUE (IdFile);

ALTER TABLE file_personnes
    ADD FOREIGN KEY (IdPersonne, guard) REFERENCES personnes (Id, IsTemp);

ALTER TABLE file_personnes
    ADD FOREIGN KEY (IdFile) REFERENCES files ON DELETE CASCADE;

ALTER TABLE file_personnes
    ADD FOREIGN KEY (IdPersonne) REFERENCES personnes;

ALTER TABLE file_personnes
    ADD FOREIGN KEY (IdDemande) REFERENCES demandes;

ALTER TABLE file_personnes
    ALTER COLUMN guard SET DEFAULT FALSE;

ALTER TABLE file_personnes
    ADD CHECK (guard = FALSE);

ALTER TABLE file_aides
    ADD UNIQUE (IdFile);

ALTER TABLE file_aides
    ADD UNIQUE (IdAide);

ALTER TABLE file_aides
    ADD FOREIGN KEY (IdFile) REFERENCES files ON DELETE CASCADE;

ALTER TABLE file_aides
    ADD FOREIGN KEY (IdAide) REFERENCES aides;

ALTER TABLE inscriptions
    ADD UNIQUE (Id, IdTaux);

ALTER TABLE inscriptions
    ADD FOREIGN KEY (IdTaux) REFERENCES tauxs;

ALTER TABLE inscription_participants
    ADD FOREIGN KEY (IdCamp, IdTaux) REFERENCES camps (Id, IdTaux) ON DELETE CASCADE;

ALTER TABLE inscription_participants
    ADD FOREIGN KEY (IdInscription, IdTaux) REFERENCES inscriptions (Id, IdTaux) ON DELETE CASCADE;

ALTER TABLE inscription_participants
    ADD FOREIGN KEY (IdInscription) REFERENCES inscriptions ON DELETE CASCADE;

ALTER TABLE inscription_participants
    ADD FOREIGN KEY (IdCamp) REFERENCES camps ON DELETE CASCADE;

ALTER TABLE inscription_participants
    ADD FOREIGN KEY (IdTaux) REFERENCES tauxs;

ALTER TABLE inscriptions
    ADD CONSTRAINT Responsable_gomacro CHECK (gomacro_validate_json_insc_ResponsableLegal (Responsable));

ALTER TABLE events
    ADD UNIQUE (Id, Kind);

ALTER TABLE events
    ADD FOREIGN KEY (IdDossier) REFERENCES dossiers ON DELETE CASCADE;

ALTER TABLE event_validations
    ADD UNIQUE (IdEvent);

ALTER TABLE event_validations
    ADD FOREIGN KEY (IdEvent, guard) REFERENCES events (Id, Kind) ON DELETE CASCADE;

ALTER TABLE event_validations
    ADD FOREIGN KEY (IdEvent) REFERENCES events;

ALTER TABLE event_validations
    ALTER COLUMN guard SET DEFAULT 1
    /* EventKind.Validation */
;

ALTER TABLE event_validations
    ADD CHECK (guard = 1
    /* EventKind.Validation */);

ALTER TABLE event_messages
    ADD UNIQUE (IdEvent);

ALTER TABLE event_messages
    ADD FOREIGN KEY (IdEvent, guard) REFERENCES events (Id, Kind) ON DELETE CASCADE;

ALTER TABLE event_messages
    ADD CHECK (Origine <> 2
    /* MessageOrigine.FromDirecteur */
        OR OrigineCamp IS NOT NULL);

ALTER TABLE event_messages
    ADD CHECK (Origine = 2
    /* MessageOrigine.FromDirecteur */
        OR OrigineCamp IS NULL);

ALTER TABLE event_messages
    ADD FOREIGN KEY (IdEvent) REFERENCES events ON DELETE CASCADE;

ALTER TABLE event_messages
    ADD FOREIGN KEY (OrigineCamp) REFERENCES camps;

ALTER TABLE event_messages
    ALTER COLUMN guard SET DEFAULT 2
    /* EventKind.Message */
;

ALTER TABLE event_messages
    ADD CHECK (guard = 2
    /* EventKind.Message */);

ALTER TABLE event_message_vus
    ADD FOREIGN KEY (IdEvent, guard) REFERENCES events (Id, Kind) ON DELETE CASCADE;

ALTER TABLE event_message_vus
    ADD UNIQUE (IdEvent, IdCamp);

ALTER TABLE event_message_vus
    ADD FOREIGN KEY (IdEvent) REFERENCES events ON DELETE CASCADE;

ALTER TABLE event_message_vus
    ADD FOREIGN KEY (IdCamp) REFERENCES camps ON DELETE CASCADE;

ALTER TABLE event_message_vus
    ALTER COLUMN guard SET DEFAULT 2
    /* EventKind.Message */
;

ALTER TABLE event_message_vus
    ADD CHECK (guard = 2
    /* EventKind.Message */);

ALTER TABLE event_camp_docss
    ADD UNIQUE (IdEvent);

ALTER TABLE event_camp_docss
    ADD FOREIGN KEY (IdEvent, guard) REFERENCES events (Id, Kind) ON DELETE CASCADE;

ALTER TABLE event_camp_docss
    ADD FOREIGN KEY (IdEvent) REFERENCES events ON DELETE CASCADE;

ALTER TABLE event_camp_docss
    ADD FOREIGN KEY (IdCamp) REFERENCES camps;

ALTER TABLE event_camp_docss
    ALTER COLUMN guard SET DEFAULT 5
    /* EventKind.CampDocs */
;

ALTER TABLE event_camp_docss
    ADD CHECK (guard = 5
    /* EventKind.CampDocs */);

ALTER TABLE event_sondages
    ADD UNIQUE (IdEvent);

ALTER TABLE event_sondages
    ADD FOREIGN KEY (IdEvent, guard) REFERENCES events (Id, Kind) ON DELETE CASCADE;

ALTER TABLE event_sondages
    ADD FOREIGN KEY (IdEvent) REFERENCES events ON DELETE CASCADE;

ALTER TABLE event_sondages
    ADD FOREIGN KEY (IdCamp) REFERENCES camps;

ALTER TABLE event_sondages
    ALTER COLUMN guard SET DEFAULT 7
    /* EventKind.Sondage */
;

ALTER TABLE event_sondages
    ADD CHECK (guard = 7
    /* EventKind.Sondage */);

ALTER TABLE event_place_liberees
    ADD UNIQUE (IdEvent);

ALTER TABLE event_place_liberees
    ADD FOREIGN KEY (IdEvent, guard) REFERENCES events (Id, Kind) ON DELETE CASCADE;

ALTER TABLE event_place_liberees
    ADD FOREIGN KEY (IdEvent) REFERENCES events ON DELETE CASCADE;

ALTER TABLE event_place_liberees
    ADD FOREIGN KEY (IdParticipant) REFERENCES participants;

ALTER TABLE event_place_liberees
    ALTER COLUMN guard SET DEFAULT 3
    /* EventKind.PlaceLiberee */
;

ALTER TABLE event_place_liberees
    ADD CHECK (guard = 3
    /* EventKind.PlaceLiberee */);

ALTER TABLE event_attestations
    ADD UNIQUE (IdEvent);

ALTER TABLE event_attestations
    ADD FOREIGN KEY (IdEvent, guard) REFERENCES events (Id, Kind) ON DELETE CASCADE;

ALTER TABLE event_attestations
    ADD FOREIGN KEY (IdEvent) REFERENCES events ON DELETE CASCADE;

ALTER TABLE event_attestations
    ALTER COLUMN guard SET DEFAULT 6
    /* EventKind.Attestation */
;

ALTER TABLE event_attestations
    ADD CHECK (guard = 6
    /* EventKind.Attestation */);

